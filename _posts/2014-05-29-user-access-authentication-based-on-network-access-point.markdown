---

title: User access authentication based on network access point
abstract: Systems and methods of authenticating user access based on an access point to a secure data network include a secure data network having a plurality of a network access points serving as entry points for a user to access the secure data network using a user device. The user is associated with a user identity, each network access point with a network access point identity. The user uses a user device to send an access request, requesting access to the secure data network, to the network access point, which then sends an authentication request to an identity server. The identity server processes the authentication request, by validating the combination of the user identity and the network access point identity, and responds with an authentication response, granting or denying access, as communicated to the user device via an access response.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09344421&OS=09344421&RS=09344421
owner: A10 Networks, Inc.
number: 09344421
owner_city: San Jose
owner_country: US
publication_date: 20140529
---
This application is a continuation and claims the priority benefit of U.S. patent application Ser. No. 13 423 953 filed on Mar. 19 2012 now U.S. Pat. No. 8 782 751 issued on Jul. 15 2014 and entitled Systems and Methods for User Access Authentication Based on Network Access Point which in turn is a continuation of U.S. patent application Ser. No. 11 435 043 filed May 16 2006 now U.S. Pat. No. 8 151 322 issued on Apr. 3 2012 and entitled Systems and Methods for User Access Authentication Based on Network Access Point. The disclosures of the above referenced applications are incorporated herein by reference.

This invention relates generally to data networking more specifically to systems and methods of authenticating user access based on an access point to a secure data network.

The secure data network of a company is a critical component of day to day functioning of company business activities. One of the crucial operations of a secure data network is proper access control for a user.

Existing methods for access control to a secure data network are based on a user identity such as a user name or an employee number or based on a role associated with the user identity. For example Roger Singleton s user identity C12756013 associates with a role of a field support engineer. In another example Verna Simpson s user identity verna.simpson associates with a role of a marketing manager. In one more example Kimberly Nguyen s user identity DC201319N associates with a role of a human resources representative.

With the growing complexity of secure data networks the variety of business activities conducted via the secure data networks and particularly the diversity of locations for a user to access the secure data networks access control based on user identity or its associated role is no longer adequate. For example a user can access the secure data network of a company from within the company from home via a public data network such as the Internet or from a vacation resort via a cellular data network such as a General Packet Radio Service GPRS network.

In one scenario Kimberly uses her desktop computer in her office to access confidential salary information from the company s secure data network. During lunch time she takes her laptop computer to a patio outside the company building and has lunch with several co workers. As she continues her work during lunch her co workers walking past her accidentally see the salary information. Although the patio is a much less secure environment physically compared to her office Kimberly is nonetheless able to access the same sensitive information from the secure data network.

In another scenario Verna of Company A visits Company B. She uses her laptop computer to access Company A s secure data network via a network of Company B. She accesses a confidential competitive marketing analysis to prepare for a meeting. In this scenario the confidential information passes through the network of Company B increasing the risk of leaking important marketing information of Company A to Company B. Likewise although the network of Company B is a much less secure environment strategically and electronically as viewed by and in comparison to that of Company A Verna is nonetheless able to access the same sensitive information from the secure data network.

The above examples represent a security problem for a secure data network of a company and they indicate the need for providing a solution for differential secure data network access control based on the network access point. Some work arounds have been created to address related scenarios but such work arounds typically address only narrow aspects of the issue. For instance one such work around involves the use of wireless text pagers such as Blackberry devices that receive and send email from the user s company email account. Assuming that Company A provides Verna with a Blackberry to receive and send email using her Company A email account Company A may still not want Verna to receive or send information confidential to Company A via email on her Blackberry device.

To help achieve Company A s desired result Company A may implement a policy instructing its employees to electronically designate their emails as Normal Confidential Private or Personal as is possible using many email applications such as MS Outlook . In addition Company A may configure its Blackberry email re routing software so that emails electronically designated as Confidential are not sent pushed to Verna s Blackberry device while nonetheless pushing all Verna s other emails to her device. Likewise Verna may be prevented from sending an email from her device that she designates as Confidential. Emails designated as Confidential will as usual be available from Company A s secure data network irrespective of where Verna may log on with her laptop. However such a work around is only as good as the implementation of the underlying policy placing significant reliance on the cooperation of Company A employees to properly designate emails not to mention Company A s inability to police emails from business partners that may send mutually confidential information to Verna without electronically designating it as Confidential. 

Systems and methods of authenticating user access based on an access point to a secure data network are described herein. A secure data network includes a network access point. The network access point serves as an entry point for a user to access the secure data network using a user device. The network access point may connect directly or indirectly to an identity server. The user is associated with a user identity. The association between the user and the user identity may be for a fixed or indefinite period of time. Any user controlling the user device is deemed to be associated with the user identity used to gain such control. The network access point associates with a network access point identity. The user uses a user device to send an access request to the network access point requesting access to the secure data network. The access request may include the user identity in which case the network access point obtains the user identity from the access request. Alternatively the network access point obtains the user identity from other means. The network access point sends the identity server an authentication request. The authentication request includes the user identity. The identity server obtains the user identity from the authentication request. The authentication request may include the network access point identity in which case the identity server obtains the network access point identity from the authentication request. Alternatively the identity server may obtain the network access point identity from other means.

The identity server processes the authentication request by validating the combination of the user identity and the network access point identity. The identity server may include a datastore that includes information for a plurality of user identities and a plurality of network access point identities. The identity server may attempt to match the combination of user identity and network access point identity with information in the datastore which may correspond to a plurality of valid pairs of user identity and network access point identity entries. In such a situation the identity server may attempt to match the user identity and the network access point identity with one of the plurality of valid pairs of user identity and network access point identity. Based on the outcome of the matching attempt the identity server responds with an authentication response to the authentication request. Furthermore based on the authentication response the secure network may grant access or deny access as communicated to the user device via an access response.

The identity server may determine that there is a match between a valid pair in datastore and the combination of user identity and network access point identity. Thus the identity server determines that the combination of user identity and network access point identity is valid in which case the identity server responds positively to the authentication request and the user device is granted access to the secure data network via the network access point.

Examples of the secure data network may include an Internet Protocol IP network a Local Area Network LAN a Wide Area Network WAN a wireless network such as a WiFi network or a General Packet Radio Service GPRS network a public IP network such as the Internet a private IP network such as a home network or a company network.

Examples of the user device may include a desktop personal computer a laptop personal computer a personal data assistance PDA a cellular phone a smart phone or a device that includes a computing unit connectable to a network.

Examples of the user identity may include a user name an identity of user device such as a Media Access Control MAC address an Internet Protocol IP address and port number a device serial number or subscriber information in a subscriber identity module SIM card or Universal Subscriber Identity Module USIM card a telephone number security information such as a password a security code or a secret answer to a security question and or biometric characteristics such as fingerprints fingerprints eye retinas eyes irises voice or signature.

Examples of the network access point may include a firewall a wireless access point a Dynamic Host Configuration Protocol DHCP server a Remote Access Server RAS a Broadband Remote Access Server BRAS a web server a secure web server or a virtual private network VPN server and or a termination point of an access tunnel such as a virtual private network VPN tunnel a Generic Routing Encapsulation GRE tunnel or a Layer 2 Tunnel Protocol L2TP tunnel.

Examples of the network access point identity may include a network access point name an IP address or a port number security information such as a password or a security code a device name or a machine identity such as a serial number and or other access information. In the event that the user device connects to network access point via an access tunnel such as a VPN tunnel an L2TP tunnel or a GRE tunnel the network access point identity may include an identity of the access tunnel termination point. In the event that the user device connects to network access point via a General Packet Radio Service GPRS network the network access point identity may include an Access Point Name APN .

The present invention likewise may apply where the secure data network comprises an application level secure data network. The user uses the user device to request access via an access request to an application level secure data network for a network application. When the network access point receives the access request the network access point may determine that access to a specific network application is requested. The network access point then may send an authentication request to the identity server. After receiving the authentication request the identity server processes the authentication request and responds with an authentication response the consequences of which are communicated to the user device via an access response.

Examples of the network application may be depending on the context an enterprise application an employee benefit application a human resources salary administration application or an inventory information application a library system a conference workshop application a live concert webcast or a hotel television over IP application and or a web application.

To portray possible scenarios for a single user using a single user device seeking access to a single desired network application in which access may be granted and others in which it may not the application level secure data network may include a first network access point and a second network access point. The first network access point is associated with a first network access point identity the second network access point is associated with second network access point identity.

In one scenario the user employs the user device to send a first application access request to the first network access point requesting access to an application level secure data network for a desired network application. The first network access point sends the identity server a first authentication request. The identity server processes the first authentication request by validating the combination of the user identity and the first network access point identity. After processing the first authentication request the identity server sends a first authentication response to the network which communicates a first access response to the user device. If the identity server determines that the combined user identity and first network access point identity is valid the user is granted access to access application level secure data network for the desired network application via use of user device at the first network access point.

In a different scenario the user employs the user device to send a second application access request to the second network access point requesting access to the application level secure data network for the desired network application as above. The second network access point sends the identity server a second authentication request. The identity server processes the second authentication request by validating the combined user identity and second network access point identity. After processing the second authentication request the identity server sends a second authentication response to the network which communicates a second access response to the user device. If the identity server determines that the combined user identity and second network access point identity pair is not valid then user is not granted access to access application level secure data network for the desired network application via use of the user device at second network access point.

Examples of the possible pairs of first and second network access points vis vis exemplary applications include 1 an office area of the company and an outdoor patio area of the company wherein the user may use the user device to access an enterprise application from the office area but not from the outdoor patio area 2 a company intranet and an external data network such as the Internet wherein the user may use the user device to access a human resources salary administration application from inside the company intranet but not via the Internet at a downtown cafe that provides hotspot Internet access.

Variations on the basic concept of are also within the scope of the present invention. For instance the identity server may validate the combined user identity and network access point identity in conjunction with time information access allowance data and or traffic volume data.

In the following description for the purposes of explanation specific numbers materials and configurations are set forth in order to provide a thorough understanding of the invention. It will be apparent however to a person of ordinary skill in the art that these specific details are merely exemplary embodiments of the invention. In some instances well known features may be omitted or simplified so as not to obscure the present invention. Furthermore reference in the specification to one embodiment or an embodiment is not meant to limit the scope of the invention but instead merely provides an example of a particular feature structure or characteristic of the invention described in connection with the embodiment. Insofar as various embodiments are described herein the appearances of the phase in an embodiment in various places in the specification are not meant to refer to a single or same embodiment.

In one embodiment secure data network is an Internet Protocol IP network. In various embodiments secure data network includes a Local Area Network LAN a Wide Area Network WAN a wireless network such as a WiFi network or a General Packet Radio Service GPRS network. In one embodiment secure data network includes a public IP network such as the Internet. In one embodiment secure data network includes a private IP network such as a home network or a company network.

In one embodiment user device is a desktop personal computer a laptop personal computer a personal data assistance PDA a cellular phone a smartphone or a device that includes a computing unit connectable to a network. A user may control the user device directly as in personal configuration or physical operation or indirectly as in the vicarious use through remotely configured or operated systems.

User is associated with user identity . For purposes of this invention it is irrelevant whether user is the intended user of user identity i.e. even if user is borrowing the user identity of another user user is nonetheless associated with user identity during such use. In one embodiment user identity includes a user name. In one embodiment user identity includes an identity of user device such as a Media Access Control MAC address an Internet Protocol IP address and port number a device serial number or subscriber information in a subscriber identity module SIM card or Universal Subscriber Identity Module USIM card. In one embodiment user identity includes a telephone number. In one embodiment user identity includes security information such as a password a security code or a secret answer to a security question. In one embodiment user identity includes biometric characteristics such as fingerprints fingerprints eye retinas eyes irises voice or signature.

In one embodiment a network access point includes a firewall a wireless access point a Dynamic Host Configuration Protocol DHCP server a Remote Access Server RAS a Broadband Remote Access Server BRAS a web server a secure web server or a virtual private network VPN server. In on embodiment network access point includes a termination point of an access tunnel such as a virtual private network VPN tunnel a Generic Routing Encapsulation GRE tunnel or a Layer 2 Tunnel Protocol L2TP tunnel.

Network access point associates with network access point identity . In various embodiments network access point identity includes a network access point name an IP address or a port number security information such as a password or a security code a device name or a machine identity such as a serial number or other access information. In one embodiment user device connects to network access point via an access tunnel such as a VPN tunnel an L2TP tunnel or a GRE tunnel in which case network access point identity includes an identity of the access tunnel termination point. In one embodiment user device connects to network access point via a General Packet Radio Service GPRS network in which case network access point identity includes an Access Point Name APN .

User uses user device to send an access request to network access point requesting access to secure data network . In one embodiment access request includes user identity in which case network access point obtains user identity from access request . In another embodiment network access point obtains user identity from other means. In one embodiment access request is an IP packet user identity includes an IP address and the network access point extracts the IP address from the source address field in the IP header of access request .

Network access point sends identity server an authentication request . Network access point may generate the authentication request using an authentication request engine not shown within network access point . Authentication request includes user identity . Identity server obtains user identity from authentication request . In one embodiment authentication request includes network access point identity and identity server obtains network access point identity from authentication request . In another embodiment identity server obtains network access point identity from other means. In one embodiment authentication request is an IP packet and network access point identity includes an IP address in which case identity server extracts the IP address from the source address field in the IP header of authentication request .

Identity server processes authentication request by validating the combined user identity and network access point identity . In one embodiment identity server determines that the combined user identity and network access point identity is valid in which case user can use user device to access secure data network .

In preparation of an authentication request the user identity and network access point identity are collected as in steps A and . In step the authentication request is sent from the network access point and identity server receives an authentication request in step . In step identity server obtains user identity from authentication request .

In one embodiment identity server obtains network access point identity from authentication request . In one embodiment authentication request is an Access Request packet based on Remote Authentication Dial In User Service RADIUS authentication protocol described in IETF RFC 2865 Remote Authentication Dial In User Service RADIUS . In this case identity server extracts or parses user identity from the RADIUS Access Request packet. For example user identity may include a user name in which case identity server extracts the user name from User Name attribute in the RADIUS Access Request packet. Likewise user identity may include a password which identity server would extract from the RADIUS Access Request packet in the User Password attribute. In another embodiment identity server might extract the password from CHAP Password attribute in the RADIUS Access Request packet. In a further embodiment user identity may include a telephone number leading identity server to extract the telephone number from Calling Station Id in the RADIUS Access Request packet. In other embodiments user identity may include other information such as subscriber information or biometric characteristics in which cases identity server extracts the other information from Vendor Specific attribute in the RADIUS Access Request packet.

In step identity server parses the network access point identity data such as by extracting the network access point identity from the RADIUS AccessRequest packet. In one embodiment network access point identity includes an IP address and identity server may extract the IP address from NAS IP Address attribute in the RADIUS Access Request packet. In another embodiment network access point identity may include a physical port number wherein identity server extracts the physical port number from NAS Port attribute in the RADIUS Access Request packet. In another embodiment network access point identity may include a physical port type and identity server may extract the physical port type from NASPort Type attribute in the RADIUS Access Request packet. In other embodiments network access point identity may include other information such as an identity of a terminating point of an L2TP tunnel a GRE tunnel or a VPN tunnel in which cases identity server may extract the other information from Vendor Specific attribute in the RADIUS Access Request packet.

In step identity server processes authentication request by validating the combined user identity and network access point identity . In one embodiment identity server includes a datastore that includes information for a plurality of user identities and a plurality of network access point identities . Identity server may attempt to match the combination of user identity and network access point identity with information in datastore using a validation matching engine not shown associated with identity server .

In one embodiment datastore includes a plurality of valid pairs A of user identity A and network access point identity A entries. In such a situation identity server may attempt to match user identity and network access point identity with one of the plurality of user identity A and network access point identity A of the valid pairs A. Based on the outcome of the matching attempt identity server responds in step with an authentication response to the authentication request . The authentication response may be generated using an authentication response engine not shown associated with identity server . Furthermore based on the authentication response the secure network may grant access as in step A or deny access as in step B as communicated to the user device via an access response . The access response may be generated using an access response engine not shown associated with network access point .

While the identity server may perform all its steps in a single server the identity server may comprise in fact more than one server wherein the sequential steps associated with identity server may be performed by separate servers. For instance the processing step may queue the authentication requests and prepare them for the validation matching engine. This processing step may occur outside a firewall of the secure data network whereas the validation matching engine and the datastore may be on a separate server inside the firewall of the secure data network . Once the attempt to match is complete the validation matching engine may communicate to the authentication response engine which may be outside the firewall that a match or no match exists for creation of the authentication response .

In one embodiment identity server determines that there is a match between a valid pair A in datastore and the combination of user identity and network access point identity . Thus identity server determines that the combination of user identity and network access point identity is valid. In one embodiment identity server responds positively to authentication request such as in step A. In one embodiment identity server responds positively via authentication response by sending a RADIUS Access Accept packet indicating that the attributes in the RADIUS Access Request packet are acceptable.

In a different embodiment authentication request is based on a different authentication protocol such as DIAMETER described in IETF RFC 3588 Diameter Base Protocol. In such a situation identity server may extract user identity and network access point identity according to the different authentication protocol. In yet another embodiment authentication request may be based on a proprietary Application Programming Interface API . Identity server likewise would extract user identity and network access point identity according to the API.

In one embodiment network access point may communicate to identity server over an IP network in which case authentication request may be an IP packet. Network access point identity likewise may include an IP address. Identity server may then extract the IP address from the source address field in the IP header of authentication request .

In an additional embodiment authentication request is a User Datagram Protocol UDP packet in which case network access point identity may include a port number and the identity server may extract the port number from the source port field in the UDP header of authentication request .

In another embodiment authentication request may be a Transport Control Protocol TCP packet in which case network access point identity may include a port number and identity server may extract the port number from the source port field in the TCP header of authentication request .

In a further embodiment authentication request may be a VPN tunnel mode packet in which case network access point identity may include an IP address of the VPN tunnel in which case identity server may extract the VPN tunnel IP address from the source address field in the outer IP header of authentication request . An example of a tunnel mode header is described in section 5.1.2 Header Construction for Tunnel Mode in IETF RFC 4301 Security Architecture for the Internet Protocol .

In one embodiment the network application uses TCP protocol for communication. User device may send an application access request . Application access request may be a TCP SYN packet. The TCP SYN packet may include a TCP header and an IP header.

When network access point receives the TCP SYN packet network access point may determine that access to a specific network application is requested. In particular network access point may extract the port number from the destination port field in the TCP header of the TCP SYN packet and then network access point may determine that the port number matches the specific network application. Network access point then may send an authentication request to identity server .

In one embodiment network access point may extract the IP address from the source address field in the IP header of the TCP SYN packet in which case network access point may include the IP address in user identity . In another embodiment network access point may determine the user identity based on the IP address.

Network access point may include user identity in authentication request which the network access point then send to identity server . In one embodiment network access point may include in authentication request the network access point identity that is associated with network access point .

In another embodiment the network application may use Hypertext Transfer Protocol HTTP for communication in which case when the user device sends an application access request the application access request may be an HTTP packet that for instance may include a header. When network access point receives the HTTP packet network access point may determine based on the header that access to a specific network application is requested. For example the header may include a URL and the network application may be determined by a sub string in the URL. In another embodiment the header may include an HTML tag that identifies the network application. In a further embodiment the HTTP packet may be a GET request and the network application may be determined by a sub string in the GET request.

In one embodiment network access point may extract the IP address from the source address field in the IP header of the HTTP packet. Network access point may include the IP address in user identity . In another embodiment network access point may determine user identity based on the IP address. In another embodiment network access point may extract information from an HTTP header which for example may include user information and the network access point may extract this user information from the HTTP header. The network access point may include the user information in user identity . For instance network access point may determine user identity based on the user information.

Network access point includes user identity in authentication request and sends authentication request to identity server . In one embodiment network access point includes network access point identity that is associated with network access point in authentication request . After receiving the authentication request identity server processes the authentication request and responds with an authentication response the consequences of which are communicated to the user device via an access response .

An application level secure data network includes a first network access point and a second network access point . The first network access point is associated with first network access point identity the second network access point is associated with second network access point identity . User is associated with user identity .

In one embodiment user employs user device to send a first application access request to the first network access point requesting access to application level secure data network for a network application. The first network access point sends identity server a first authentication request . Identity server processes first authentication request by validating the combined user identity and first network access point identity as illustrated in . After processing the first authentication request identity server sends a first authentication response to the application level secure data network which communicates a first access response to user device . If identity server determines that the combined user identity and first network access point identity is valid user is granted access to access application level secure data network for the network application via user device at first network access point .

In a different scenario user employs user device to send a second application access request to the second network access point requesting access to application level secure data network for the same network application as above. The second network access point sends identity server a second authentication request . Identity server processes second authentication request by validating the combined user identity and second network access point identity as illustrated in . After processing the second authentication request identity server sends a second authentication response to the network which communicates a second access response to user device . If identity server determines that the combined user identity and second network access point identity is not valid then user is not granted access to access application level secure data network for the same network application via user device at second network access point .

Given the interconnecting nature of a secure data network and an application level secure data network it is possible that the second authentication request may not travel directly to the identity server . It may pass through various network components such as hubs switching stations base stations hosting servers etc. before reaching the identity server . Authentication request may pass also through first network access point on its way to identity server . However even if authentication request passes through first network access point it is clear that the authentication request should reflect that the user is attempting to access the secure data network via second network access point . Thus the reality of the attempted access is preserved and user device is not granted access due to passing through first network access point if access would be denied based on sending the access request to second network access point .

As with other network communications the first authentication request may keep a log of its communication path tracking the identities of network nodes in reaching its destination. The communication path of the authentication request and that of the possible access if granted likewise may be the subject of scrutiny for potential security weaknesses and the identity server may deny access if the path itself contains a weak link in the chain of communication. The identity server may treat the network node identities tracked in the communication log of the first authentication request as network access point identities . In such a case the identity server may be configured to determine that access should be granted only where all network access point identities along the communication path combine as valid pairs A with the user identity .

According to one exemplary embodiment of the present invention application level secure data network is a company data network. The first network access point serves as an entry point for accessing application level secure data network from an office area of the company. The second network access point serves as an entry point for accessing application level secure data network from an outdoor patio area of the company. The application level secure data network may be configured so that user can use user device to access application level secure data network for an enterprise application from the office area but cannot access application level secure data network for the same enterprise application from the outdoor patio area.

According to an additional embodiment the first network access point serves as an entry point for accessing application level secure data network via a company intranet. The second network access point serves as an entry point for accessing application level secure data network via an external data network such as the Internet. The application level secure data network may be configured so that user can use user device to access application level secure data network for a human resources salary administration application from inside the company intranet but cannot access application level secure data network for the same human resources salary administration application at a downtown cafe that provides hotspot Internet access.

In some cases the network application may use a different protocol for communication in which cases the first network access point may need to obtain user identity based on this different protocol. For instance the different protocol may be User Datagram Protocol UDP File Transfer Protocol FTP Session Initiation Protocol SIP or Real Time Streaming Protocol RTSP . In other instances the network application may use an Extensible Markup Language XML document for communication in which case the first network access point may obtain user identity based on the Document Type Definition DTD for the XML document. Moreover the network application may use a Web service interface and the first network access point may rely on the Web service interface to obtain user identity .

Variations on the basic concept of are also within the scope of the present invention. For instance identity server may validate the combined user identity and first network access point identity in conjunction with time information. In one embodiment the validity of the combined user identity and first network access point identity may depend on the time of day when identity server conducts the validation. In another embodiment identity server validates the combined user identity and first network access point identity in conjunction with access allowance. Access allowance may be measured in various ways such time duration download volume network traffic volume etc. or combinations thereof. For example the validity of the combined user identity and first network access point identity may depend on the access allowance as measured in access time duration in light of access traffic volume associated with the user identity and the first network access point identity such as limits of 2 hours or 2 gigabytes of data transfer which occurs sooner.

In yet further embodiments the application level secure data network may be deployed in a high school campus a college campus a hospital a warehouse a hotel an airport a stadium an amphitheater or a cruise ship to provide for differential network access control based on the point of access. Moreover the application level secure data networks may be deployed for differential charging based the access point to the application level secure data network.

Although the invention herein has been described with reference to particular embodiments it is to be understood that these embodiments are merely illustrative of the principles and applications of the present invention. It is therefore to be understood that numerous modifications may be made to the illustrative embodiments and that other arrangements may be devised without departing from the spirit and scope of the present invention as defined by the appended claims.

