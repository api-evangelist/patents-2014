---

title: Binaural rendering of spherical harmonic coefficients
abstract: A device comprises one or more processors configured to apply a binaural room impulse response filter to spherical harmonic coefficients representative of a sound field in three dimensions so as to render the sound field.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09420393&OS=09420393&RS=09420393
owner: QUALCOMM Incorporated
number: 09420393
owner_city: San Diego
owner_country: US
publication_date: 20140527
---
This application claims the benefit of U.S. Provisional Patent Application No. 61 828 620 filed May 29 2013 U.S. Provisional Patent Application No. 61 847 543 filed Jul. 17 2013 U.S. Provisional Application No. 61 886 593 filed Oct. 3 2013 and U.S. Provisional Application No. 61 886 620 filed Oct. 3 2013.

In general techniques are described for binaural audio rendering of spherical harmonic coefficients having an order greater than one which may be referred to as higher order ambisonics HOA coefficients .

As one example a method of binaural audio rendering comprises applying a binaural room impulse response filter to spherical harmonic coefficients representative of a sound field in three dimensions so as to render the sound field.

In another example a device comprises one or more processors configured to apply a binaural room impulse response filter to spherical harmonic coefficients representative of a sound field in three dimensions so as to render the sound field.

In another example a device comprises means for determining spherical harmonic coefficients representative of a sound field in three dimensions and means for applying a binaural room impulse response filter to spherical harmonic coefficients representative of a sound field so as to render the sound field.

In another example a non transitory computer readable storage medium having stored thereon instructions that when executed cause one or more processors to apply a binaural room impulse response filter to spherical harmonic coefficients representative of a sound field in three dimensions so as to render the sound field.

The details of one or more aspects of the techniques are set forth in the accompanying drawings and the description below. Other features objects and advantages of these techniques will be apparent from the description and drawings and from the claims.

The evolution of surround sound has made available many output formats for entertainment nowadays. Examples of such surround sound formats include the popular 5.1 format which includes the following six channels front left FL front right FR center or front center back left or surround left back right or surround right and low frequency effects LFE the growing 7.1 format and the upcoming 22.2 format e.g. for use with the Ultra High Definition Television standard . Another example of spatial audio format are the Spherical Harmonic coefficients also known as Higher Order Ambisonics .

The input to a future standardized audio encoder a device which converts PCM audio representations to an bitstream conserving the number of bits required per time sample could optionally be one of three possible formats i traditional channel based audio which is meant to be played through loudspeakers at pre specified positions ii object based audio which involves discrete pulse code modulation PCM data for single audio objects with associated metadata containing their location coordinates amongst other information and iii scene based audio which involves representing the sound field using spherical harmonic coefficients SHC where the coefficients represent weights of a linear summation of spherical harmonic basis functions. The SHC in this context may include Higher Order Ambisonics HoA signals according to an HoA model. Spherical harmonic coefficients may alternatively or additionally include planar models and spherical models.

There are various surround sound formats in the market. They range for example from the 5.1 home theatre system which has been the most successful in terms of making inroads into living rooms beyond stereo to the 22.2 system developed by NHK Nippon Hoso Kyokai or Japan Broadcasting Corporation . Content creators e.g. Hollywood studios would like to produce the soundtrack for a movie once and not spend the efforts to remix it for each speaker configuration. Recently standard committees have been considering ways in which to provide an encoding into a standardized bitstream and a subsequent decoding that is adaptable and agnostic to the speaker geometry and acoustic conditions at the location of the renderer.

To provide such flexibility for content creators a hierarchical set of elements may be used to represent a sound field. The hierarchical set of elements may refer to a set of elements in which the elements are ordered such that a basic set of lower ordered elements provides a full representation of the modeled sound field. As the set is extended to include higher order elements the representation becomes more detailed.

One example of a hierarchical set of elements is a set of spherical harmonic coefficients SHC . The following expression demonstrates a description or representation of a sound field using SHC 

In any event the SHC A k can either be physically acquired e.g. recorded by various microphone array configurations or alternatively they can be derived from channel based or object based descriptions of the sound field. The SHC represents scene based audio. For example a fourth order SHC representation involves 1 4 25 coefficients per time sample.

To illustrate how these SHCs may be derived from an object based description consider the following equation. The coefficients A k for the sound field corresponding to an individual audio object may be expressed as 4 where i is square root over 1 h is the spherical Hankel function of the second kind of order n and r is the location of the object. Knowing the source energy g as a function of frequency e.g. using time frequency analysis techniques such as performing a fast Fourier transform on the PCM stream allows us to convert each PCM object and its location into the SHC A k . Further it can be shown since the above is a linear and orthogonal decomposition that the A k coefficients for each object are additive. In this manner a multitude of PCM objects can be represented by the A k coefficients e.g. as a sum of the coefficient vectors for the individual objects . Essentially these coefficients contain information about the sound field the pressure as a function of 3D coordinates and the above represents the transformation from individual objects to a representation of the overall sound field in the vicinity of the observation point r .

The SHCs may also be derived from a microphone array recording as follows where a t are the time domain equivalent of A k the SHC the represents a convolution operation the represents an inner product b r t represents a time domain filter function dependent on r m t are the imicrophone signal where the imicrophone transducer is located at radius r elevation angle and azimuth angle . Thus if there are 32 transducers in the microphone array and each microphone is positioned on a sphere such that r a is a constant such as those on an Eigenmike EM32 device from mhAcoustics the 25 SHCs may be derived using a matrix operation as follows 

The content creator may represent a movie studio or other entity that may generate multi channel audio content for consumption by content consumers such as the content consumer . Often this content creator generates audio content in conjunction with video content. The content consumer may represent an individual that owns or has access to an audio playback system which may refer to any form of audio playback system capable of playing back multi channel audio content. In the example of the content consumer owns or has access to audio playback system for rendering hierarchical elements that define a hierarchical representation of a sound field.

The content creator includes an audio renderer and an audio editing system . The audio renderer may represent an audio processing unit that renders or otherwise generates speaker feeds which may also be referred to as loudspeaker feeds speaker signals or loudspeaker signals . Each speaker feed may correspond to a speaker feed that reproduces sound for a particular channel of a multi channel audio system or to a virtual loudspeaker feed that are intended for convolution with a head related transfer function HRTF filters matching the speaker position. Each speaker feed may correspond to a channel of spherical harmonic coefficients where a channel may be denoted by an order and or suborder of associated spherical basis functions to which the spherical harmonic coefficients correspond which uses multiple channels of SHCs to represent a directional sound field.

In the example of the audio renderer may render speaker feeds for conventional 5.1 7.1 or 22.2 surround sound formats generating a speaker feed for each of the 5 7 or 22 speakers in the 5.1 7.1 or 22.2 surround sound speaker systems. Alternatively the audio renderer may be configured to render speaker feeds from source spherical harmonic coefficients for any speaker configuration having any number of speakers given the properties of source spherical harmonic coefficients discussed above. The audio renderer may in this manner generate a number of speaker feeds which are denoted in as speaker feeds .

The content creator may during the editing process render spherical harmonic coefficients SHCs listening to the rendered speaker feeds in an attempt to identify aspects of the sound field that do not have high fidelity or that do not provide a convincing surround sound experience. The content creator may then edit source spherical harmonic coefficients often indirectly through manipulation of different objects from which the source spherical harmonic coefficients may be derived in the manner described above . The content creator may employ the audio editing system to edit the spherical harmonic coefficients . The audio editing system represents any system capable of editing audio data and outputting this audio data as one or more source spherical harmonic coefficients.

When the editing process is complete the content creator may generate bitstream based on the spherical harmonic coefficients . That is the content creator includes a bitstream generation device which may represent any device capable of generating the bitstream . In some instances the bitstream generation device may represent an encoder that bandwidth compresses through as one example entropy encoding the spherical harmonic coefficients and that arranges the entropy encoded version of the spherical harmonic coefficients in an accepted format to form the bitstream . In other instances the bitstream generation device may represent an audio encoder possibly one that complies with a known audio coding standard such as MPEG surround or a derivative thereof that encodes the multi channel audio content using as one example processes similar to those of conventional audio surround sound encoding processes to compress the multi channel audio content or derivatives thereof. The compressed multi channel audio content may then be entropy encoded or coded in some other way to bandwidth compress the content and arranged in accordance with an agreed upon format to form the bitstream . Whether directly compressed to form the bitstream or rendered and then compressed to form the bitstream the content creator may transmit the bitstream to the content consumer .

While shown in as being directly transmitted to the content consumer the content creator may output the bitstream to an intermediate device positioned between the content creator and the content consumer . This intermediate device may store the bitstream for later delivery to the content consumer which may request this bitstream. The intermediate device may comprise a file server a web server a desktop computer a laptop computer a tablet computer a mobile phone a smart phone or any other device capable of storing the bitstream for later retrieval by an audio decoder. This intermediate device may reside in a content delivery network capable of streaming the bitstream and possibly in conjunction with transmitting a corresponding video data bitstream to subscribers such as the content consumer requesting the bitstream . Alternatively the content creator may store the bitstream to a storage medium such as a compact disc a digital video disc a high definition video disc or other storage media most of which are capable of being read by a computer and therefore may be referred to as computer readable storage media or non transitory computer readable storage media. In this context the transmission channel may refer to those channels by which content stored to these mediums are transmitted and may include retail stores and other store based delivery mechanism . In any event the techniques of this disclosure should not therefore be limited in this respect to the example of .

As further shown in the example of the content consumer owns or otherwise has access to the audio playback system . The audio playback system may represent any audio playback system capable of playing back multi channel audio data. The audio playback system includes a binaural audio renderer that renders SHCs for output as binaural speaker feeds A B collectively speaker feeds . Binaural audio renderer may provide for different forms of rendering such as one or more of the various ways of performing vector base amplitude panning VBAP and or one or more of the various ways of performing sound field synthesis.

The audio playback system may further include an extraction device . The extraction device may represent any device capable of extracting spherical harmonic coefficients SHCs which may represent a modified form of or a duplicate of spherical harmonic coefficients through a process that may generally be reciprocal to that of the bitstream generation device . In any event the audio playback system may receive the spherical harmonic coefficients and uses binaural audio renderer to render spherical harmonic coefficients and thereby generate speaker feeds corresponding to the number of loudspeakers electrically or possibly wirelessly coupled to the audio playback system which are not shown in the example of for ease of illustration purposes . The number of speaker feeds may be two and audio playback system may wirelessly couple to a pair of headphones that includes the two corresponding loudspeakers. However in various instances binaural audio renderer may output more or fewer speaker feeds than is illustrated and primarily described with respect to .

Binary room impulse response BRIR filters of audio playback system that each represents a response at a location to an impulse generated at an impulse location. BRIR filters are binaural in that they are each generated to be representative of the impulse response as would be experienced by a human ear at the location. Accordingly BRIR filters for an impulse are often generated and used for sound rendering in pairs with one element of the pair for the left ear and another for the right ear. In the illustrated example binaural audio renderer uses left BRIR filters A and right BRIR filters B to render respective binaural audio outputs A and B.

For example BRIR filters may be generated by convolving a sound source signal with head related transfer functions HRTFs measured as impulses responses IRs . The impulse location corresponding to each of the BRIR filters may represent a position of a virtual loudspeaker in a virtual space. In some examples binaural audio renderer convolves SHCs with BRIR filters corresponding to the virtual loudspeakers then accumulates i.e. sums the resulting convolutions to render the sound field defined by SHCs for output as speaker feeds . As described herein binaural audio renderer may apply techniques for reducing rendering computation by manipulating BRIR filters while rendering SHCs as speaker feeds .

In some instances the techniques include segmenting BRIR filters into a number of segments that represent different stages of an impulse response at a location within a room. These segments correspond to different physical phenomena that generate the pressure or lack thereof at any point on the sound field. For example because each of BRIR filters is timed coincident with the impulse the first or initial segment may represent a time until the pressure wave from the impulse location reaches the location at which the impulse response is measured. With the exception of the timing information BRIR filters values for respective initial segments may be insignificant and may be excluded from a convolution with the hierarchical elements that describe the sound field. Similarly each of BRIR filters may include a last or tail segment that include impulse response signals attenuated to below the dynamic range of human hearing or attenuated to below a designated threshold for instance. BRIR filters values for respective tails segments may also be insignificant and may be excluded from a convolution with the hierarchical elements that describe the sound field. In some examples the techniques may include determining a tail segment by performing a Schroeder backward integration with a designated threshold and discarding elements from the tail segment where backward integration exceeds the designated threshold. In some examples the designated threshold is 60 dB for reverberation time RT.

An additional segment of each of BRIR filters may represent the impulse response caused by the impulse generated pressure wave without the inclusion of echo effects from the room. These segments may be represented and described as a head related transfer functions HRTFs for BRIR filters where HRTFs capture the impulse response due to the diffraction and reflection of pressure waves about the head shoulders torso and outer ear as the pressure wave travels toward the ear drum. HRTF impulse responses are the result of a linear and time invariant system LTI and may be modeled as minimum phase filters. The techniques to reduce HRTF segment computation during rendering may in some examples include minimum phase reconstruction and using infinite impulse response IIR filters to reduce an order of the original finite impulse response FIR filter e.g. the HRTF filter segment .

Minimum phase filters implemented as IIR filters may be used to approximate the HRTF filters for BRIR filters with a reduced filter order. Reducing the order leads to a concomitant reduction in the number of calculations for a time step in the frequency domain. In addition the residual excess filter resulting from the construction of minimum phase filters may be used to estimate the interaural time difference ITD that represents the time or phase distance caused by the distance a sound pressure wave travels from a source to each ear. The ITD can then be used to model sound localization for one or both ears after computing a convolution of one or more BRIR filters with the hierarchical elements that describe the sound field i.e. determine binauralization .

A still further segment of each of BRIR filters is subsequent to the HRTF segment and may account for effects of the room on the impulse response. This room segment may be further decomposed into an early echoes or early reflection segment and a late reverberation segment that is early echoes and late reverberation may each be represented by separate segments of each of BRIR filters . Where HRTF data is available for BRIR filters onset of the early echo segment may be identified by deconvoluting the BRIR filters with the HRTF to identify the HRTF segment. Subsequent to the HRTF segment is the early echo segment. Unlike the residual room response the HRTF and early echo segments are direction dependent in that location of the corresponding virtual speaker determines the signal in a significant respect.

In some examples binaural audio renderer uses BRIR filters prepared for the spherical harmonics domain or other domain for the hierarchical elements that describe the sound field. That is BRIR filters may be defined in the spherical harmonics domain SHD as transformed BRIR filters to allow binaural audio renderer to perform fast convolution while taking advantage of certain properties of the data set including the symmetry of BRIR filters e.g. left right and of SHCs . In such examples transformed BRIR filters may be generated by multiplying or convolving in the time domain the SHC rendering matrix and the original BRIR filters. Mathematically this can be expressed according to the following equations 1 5 

Here 3 depicts either 1 or 2 in matrix form for fourth order spherical harmonic coefficients which may be an alternative way to refer to those of the spherical harmonic coefficients associated with spherical basis functions of the fourth order or less . Equation 3 may of course be modified for higher or lower order spherical harmonic coefficients. Equations 4 5 depict the summation of the transformed left and right BRIR filters over the loudspeaker dimension L to generate summed SHC binaural rendering matrices BRIR . In combination the summed SHC binaural rendering matrices have dimensionality N 1 Length where Length is a length of the impulse response vectors to which any combination of equations 1 5 may be applied. In some instances of equations 1 and 2 the rendering matrix SHC may be binauralized such that equation 1 may be modified to BRIR SHC BRIRand equation 2 may be modified to BRIR SHC BRIR.

The SHC rendering matrix presented in the above equations 1 3 SHC includes elements for each order sub order combination of SHCs which effectively define a separate SHC channel where the element values are set for a position for the speaker L in the spherical harmonic domain. BRIRrepresents the BRIR response at the left ear or position for an impulse produced at the location for the speaker L and is depicted in 3 using impulse response vectors Bfor i i 0 L . BRIR represents one half of a SHC binaural rendering matrix i.e. the SHC binaural rendering matrix at the left ear or position for an impulse produced at the location for speakers L transformed to the spherical harmonics domain. BRIR represents the other half of the SHC binaural rendering matrix.

In some examples the techniques may include applying the SHC rendering matrix only to the HRTF and early reflection segments of respective original BRIR filters to generate transformed BRIR filters and an SHC binaural rendering matrix. This may reduce a length of convolutions with SHCs .

In some examples as depicted in equations 4 5 the SHC binaural rendering matrices having dimensionality that incorporates the various loudspeakers in the spherical harmonics domain may be summed to generate a N 1 Length filter matrix that combines SHC rendering and BRIR rendering mixing. That is SHC binaural rendering matrices for each of the L loudspeakers may be combined by e.g. summing the coefficients over the L dimension. For SHC binaural rendering matrices of length Length this produces a N 1 Length summed SHC binaural rendering matrix that may be applied to an audio signal of spherical harmonics coefficients to binauralize the signal. Length may be a length of a segment of the BRIR filters segmented in accordance with techniques described herein.

Techniques for model reduction may also be applied to the altered rendering filters which allows SHCs e.g. the SHC contents to be directly filtered with the new filter matrix a summed SHC binaural rendering matrix . Binaural audio renderer may then convert to binaural audio by summing the filtered arrays to obtain the binaural output signals A B.

In some examples BRIR filters of audio playback system represent transformed BRIR filters in the spherical harmonics domain previously computed according to any one or more of the above described techniques. In some examples transformation of original BRIR filters may be performed at run time.

In some examples because the BRIR filters are typically symmetric the techniques may promote further reduction of the computation of binaural outputs A B by using only the SHC binaural rendering matrix for either the left or right ear. When summing SHCs filtered by a filter matrix binaural audio renderer may make conditional decisions for either outputs signal A or B as a second channel when rendering the final output. As described herein reference to processing content or to modifying rendering matrices described with respect to either the left or right ear should be understood to be similarly applicable to the other ear.

In this way the techniques may provide multiple approaches to reduce a length of BRIR filters in order to potentially avoid direct convolution of the excluded BRIR filter samples with multiple channels. As a result binaural audio renderer may provide efficient rendering of binaural output signals A B from SHCs .

Early echoes B includes more discrete echoes than residual room C. Accordingly early echoes B may vary per virtual speaker channel while residual room C having a longer tail may be synthesized as a single stereo copy. For some measurement mannequins used to obtain a BRIR HRTF data may be available as measured in an anechoic chamber. Early echoes B may be determined by deconvoluting the BRIR and the HRTF data to identify the location of early echoes which may be referred to as reflections . In some examples HRTF data is not readily available and the techniques for identifying early echoes B include blind estimation. However a straightforward approach may include regarding the first few milliseconds e.g. the first 5 10 15 or 20 ms as direct impulse filtered by the HRTF. As noted above the techniques may include computing the mixing time using statistical data and estimation from the room volume.

In some examples the techniques may include synthesizing one or more BRIR filters for residual room C. After the mixing time BRIR reverb tails represented as system residual room C in can be interchanged in some instances without perceptual punishments. Further the BRIR reverb tails can be synthesized with Gaussian white noise that matches the Energy Decay Relief EDR and Frequency Dependent Interaural Coherence FDIC . In some examples a common synthetic BRIR reverb tail may be generated for BRIR filters. In some examples the common EDR may be an average of the EDRs of all speakers or may be the front zero degree EDR with energy matching to the average energy. In some examples the FDIC may be an average FDIC across all speakers or may be the minimum value across all speakers for a maximally decorrelated measure for spaciousness. In some examples reverb tails can also be simulated with artificial reverb with Feedback Delay Networks FDN .

With a common reverb tail the later portion of a corresponding BRIR filter may be excluded from separate convolution with each speaker feed but instead may be applied once onto the mix of all speaker feeds. As described above and in further detail below the mixing of all speaker feeds can be further simplified with spherical harmonic coefficients signal rendering.

As shown in the example of audio playback device may include an extraction unit and a binaural rendering unit . The extraction unit may represent a unit configured to extract encoded audio data from bitstream . The extraction unit may forward the extracted encoded audio data in the form of spherical harmonic coefficients SHCs which may also be referred to a higher order ambisonics HOA in that the SHCs may include at least one coefficient associated with an order greater than one to the binaural rendering unit .

In some examples audio playback device includes an audio decoding unit configured to decode the encoded audio data so as to generate the SHCs . The audio decoding unit may perform an audio decoding process that is in some aspects reciprocal to the audio encoding process used to encode SHCs . The audio decoding unit may include a time frequency analysis unit configured to transform SHCs of encoded audio data from the time domain to the frequency domain thereby generating the SHCs . That is when the encoded audio data represents a compressed form of the SHC that is not converted from the time domain to the frequency domain the audio decoding unit may invoke the time frequency analysis unit to convert the SHCs from the time domain to the frequency domain so as to generate SHCs specified in the frequency domain . The time frequency analysis unit may apply any form of Fourier based transform including a fast Fourier transform FFT a discrete cosine transform DCT a modified discrete cosine transform MDCT and a discrete sine transform DST to provide a few examples to transform the SHCs from the time domain to SHCs in the frequency domain. In some instances SHCs may already be specified in the frequency domain in bitstream . In these instances the time frequency analysis unit may pass SHCs to the binaural rendering unit without applying a transform or otherwise transforming the received SHCs . While described with respect to SHCs specified in the frequency domain the techniques may be performed with respect to SHCs specified in the time domain.

Binaural rendering unit represents a unit configured to binauralize SHCs . Binaural rendering unit may in other words represent a unit configured to render the SHCs to a left and right channel which may feature spatialization to model how the left and right channel would be heard by a listener in a room in which the SHCs were recorded. The binaural rendering unit may render SHCs to generate a left channel A and a right channel B which may collectively be referred to as channels suitable for playback via a headset such as headphones. As shown in the example of the binaural rendering unit includes BRIR filters a BRIR conditioning unit a residual room response unit a BRIR SHC domain conversion unit a convolution unit and a combination unit .

BRIR filters include one or more BRIR filters and may represent an example of BRIR filters of . BRIR filters may include separate BRIR filters A B representing the effect of the left and right HRTF on the respective BRIRs.

BRIR conditioning unit receives L instances of BRIR filters A B one for each virtual loudspeaker L and with each BRIR filter having length N. BRIR filters A B may already be conditioned to remove quiet samples. BRIR conditioning unit may apply techniques described above to segment BRIR filters A B to identify respective HRTF early reflection and residual room segments. BRIR conditioning unit provides the HRTF and early reflection segments to BRIR SHC domain conversion unit as matrices A B representing left and right matrices of size a L where a is a length of the concatenation of the HRTF and early reflection segments and L is a number of loudspeakers virtual or real . BRIR conditioning unit provides the residual room segments of BRIR filters A B to residual room response unit as left and right residual room matrices A B of size b L where b is a length of the residual room segments and L is a number of loudspeakers virtual or real .

Residual room response unit may apply techniques describe above to compute or otherwise determine left and right common residual room response segments for convolution with at least some portion of the hierarchical elements e.g. spherical harmonic coefficients describing the sound field as represented in by SHCs . That is residual room response unit may receive left and right residual room matrices A B and combine respective left and right residual room matrices A B over L to generate left and right common residual room response segments. Residual room response unit may perform the combination by in some instances averaging the left and right residual room matrices A B over L.

Residual room response unit may then compute a fast convolution of the left and right common residual room response segments with at least one channel of SHCs illustrated in as channel s B. In some examples because left and right common residual room response segments represent ambient non directional sound channel s B is the W channel i.e. 0order of the SHCs channels which encodes the non directional portion of a sound field. In such examples for a W channel sample of length Length fast convolution by residual room response unit with left and right common residual room response segments produces left and right output signals A B of length Length.

As used herein the terms fast convolution and convolution may refer to a convolution operation in the time domain as well as to a point wise multiplication operation in the frequency domain. In other words and as is well known to those skilled in the art of signal processing convolution in the time domain is equivalent to point wise multiplication in the frequency domain where the time and frequency domains are transforms of one another. The output transform is the point wise product of the input transform with the transfer function. Accordingly convolution and point wise multiplication or simply multiplication can refer to conceptually similar operations made with respect to the respective domains time and frequency herein . Convolution units residual room response units filters and reverb may alternatively apply multiplication in the frequency domain where the inputs to these components is provided in the frequency domain rather than the time domain. Other operations described herein as fast convolution or convolution may similarly also refer to multiplication in the frequency domain where the inputs to these operations is provided in the frequency domain rather than the time domain.

In some examples residual room response unit may receive from BRIR conditioning unit a value for an onset time of the common residual room response segments. Residual room response unit may zero pad or otherwise delay the outputs signals A B in anticipation of combination with earlier segments for the BRIR filters .

BRIR SHC domain conversion unit hereinafter domain conversion unit applies an SHC rendering matrix to BRIR matrices to potentially convert the left and right BRIR filters A B to the spherical harmonic domain and then to potentially sum the filters over L. Domain conversion unit outputs the conversion result as left and right SHC binaural rendering matrices A B respectively. Where matrices A B are of size a L each of SHC binaural rendering matrices A B is of size N 1 a after summing the filters over L see equations 4 5 for example . In some examples SHC binaural rendering matrices A B are configured in audio playback device rather than being computed at run time or a setup time. In some examples multiple instances of SHC binaural rendering matrices A B are configured in audio playback device and audio playback device selects a left right pair of the multiple instances to apply to SHCs A.

Convolution unit convolves left and right binaural rendering matrices A B with SHCs A which may in some examples be reduced in order from the order of SHCs . For SHCs A in the frequency e.g. SHC domain convolution unit may compute respective point wise multiplications of SHCs A with left and right binaural rendering matrices A B. For an SHC signal of length Length the convolution results in left and right filtered SHC channels A B of size Length N 1 there typically being a row for each output signals matrix for each order sub order combination of the spherical harmonics domain.

Combination unit may combine left and right filtered SHC channels A B with output signals A B to produce binaural output signals A B. Combination unit may then separately sum each left and right filtered SHC channels A B over L to produce left and right binaural output signals for the HRTF and early echoes reflection segments prior to combining the left and right binaural output signals with left and right output signals A B to produce binaural output signals A B.

Audio playback device may include an optional SHCs order reduction unit that processes inbound SHCs from bitstream to reduce an order of the SHCs . Optional SHCs order reduction provides the highest order e.g. 0order channel of SHCs e.g. the W channel to residual room response unit and provides reduced order SHCs to convolution unit . In instances in which SHCs order reduction unit does not reduce an order of SHCs convolution unit receives SHCs that are identical to SHCs . In either case SHCs have dimensions Length N 1 where N is the order of SHCs .

BRIR conditioning unit and BRIR filters may represent example instances of BRIR conditioning unit and BRIR filters of . Convolution unit of residual response unit receives common left and right residual room segments A B conditioned by BRIR condition unit using techniques described above and convolution unit convolves the common left and right residual room segments A B with highest order channel to produce left and right residual room signals A B. Delay unit may zero pad the left and right residual room signals A B with the onset number of samples to the common left and right residual room segments A B to produce left and right residual room output signals A B.

BRIR SHC domain conversion unit hereinafter domain conversion unit may represent an example instance of domain conversion unit of . In the illustrated example transform unit applies an SHC rendering matrix of N 1 dimensionality to matrices A B representing left and right matrices of size a L where a is a length of the concatenation of the HRTF and early reflection segments and L is a number of loudspeakers e.g. virtual loudspeakers . Transform unit outputs left and right matrices A B in the SHC domain having dimensions N 1 a L . Summation unit may sum each of left and right matrices A B over L to produce left and right intermediate SHC rendering matrices A B having dimensions N 1 a . Reduction unit may apply techniques described above to further reduce computation complexity of applying SHC rendering matrices to SHCs such as minimum phase reduction and using Balanced Model Truncation methods to design IIR filters to approximate the frequency response of the respective minimum phase portions of intermediate SHC rendering matrices A B that have had minimum phase reduction applied. Reduction unit outputs left and right SHC rendering matrices A B.

Convolution unit filters the SHC contents in the form of SHCs to produce intermediate signals A B which summation unit sums to produce left and right signals A B. Combination unit combines left and right residual room output signals A B and left and right signals A B to produce left and right binaural output signals A B.

In some examples binaural rendering unit may implement further reductions to computation by using only one of the SHC binaural rendering matrices A B generated by transform unit . As a result convolution unit may operate on just one of the left or right signals reducing convolution operations by half. Summation unit in such examples makes conditional decisions for the second channel when rendering the outputs A B.

BRIR SHC domain conversion unit applies an HOA rendering matrix to transform left and right filter matrices A B including the extracted head related transfer function and early echoes segments to generate left and right filter matrices A B in the spherical harmonic e.g. HOA domain . In some examples audio playback device may be configured with left and right filter matrices A B. In some examples audio playback device receives BRIR filters in an out of band or in band signal of bitstream in which case audio playback device generates left and right filter matrices A B. Summation unit sums the respective left and right filter matrices A B over the loudspeaker dimension to generate a binaural rendering matrix in the SHC domain that includes left and right intermediate SHC rendering matrices A B . A reduction unit may further reduce the intermediate SHC rendering matrices A B to generate left and right SHC rendering matrices A B.

A convolution unit of binaural rendering unit applies the left and right intermediate SHC rendering matrices A B to SHC content such as spherical harmonic coefficients to produce left and right filtered SHC e.g. HOA channels A B .

Summation unit sums each of the left and right filtered SHC channels A B over the SHC dimension N 1 to produce left and right signals A B for the direction dependent segments . Combination unit may then combine the left and right signals A B with left and right residual room output signals A B to generate a binaural output signal including left and right binaural output signals A B.

BRIR conditioning unit of audio playback device may condition the BRIR data by applying segmentation and combination operations. Specifically in the example mode of operation BRIR conditioning unit segments each of the L filters according to techniques described herein into HRTF plus early echo segments of combined length a to produce matrix dimensionality a 2 L and into residual room response segments to produce residual matrix dimensionality b 2 L . The length K of the L filters of BRIR data is approximately the sum of a and b. Transform unit may apply HOA SHC rendering matrix of N 1 dimensionality to the L filters of matrix to produce matrix which may be an example instance of a combination of left and right matrices A B of dimensionality N 1 a 2 L . Summation unit may sum each of left and right matrices A B over L to produce intermediate SHC rendering matrix having dimensionality N 1 a 2 the third dimension having value 2 representing left and right components intermediate SHC rendering matrix may represent as an example instance of both left and right intermediate SHC rendering matrices A B . In some examples audio playback device may be configured with intermediate SHC rendering matrix for application to the HOA content or reduced version thereof e.g. HOA content . In some examples reduction unit may apply further reductions to computation by using only one of the left or right components of matrix .

Audio playback device receives HOA content of order Nand length Length and in some aspects applies an order reduction operation to reduce the order of the spherical harmonic coefficients SHCs therein to N . Nindicates the order of the I nput HOA content . The HOA content of order reduction operation is like HOA content in the SHC domain. The optional order reduction operation also generates and provides the highest order e.g. the 0order signal to residual response unit for a fast convolution operation . In instances in which HOA order reduction unit does not reduce an order of HOA content the apply fast convolution operation operates on input that does not have a reduced order. In either case HOA content input to the fast convolution operation has dimensions Length N 1 where N is the order.

Audio playback device may apply fast convolution of HOA content with matrix to produce HOA signal having left and right components thus dimensions Length N 1 2 . Again fast convolution may refer to point wise multiplication of the HOA content and matrix in the frequency domain or convolution in the time domain. Audio playback device may further sum HOA signal over N 1 to produce a summed signal having dimensions Length 2 .

Returning now to residual matrix audio playback device may combine the L residual room response segments in accordance with techniques herein described to generate a common residual room response matrix having dimensions b 2 . Audio playback device may apply fast convolution of the 0order HOA signal with the common residual room response matrix to produce room response signal having dimensions Length . Because to generate the L residual response room response segments of residual matrix audio playback device obtained the residual response room response segments starting at the a 1 samples of the L filters of BRIR data audio playback device accounts for the initial a samples by delaying e.g. padding a samples to generate room response signal having dimensions Length .

Audio playback device combines summed signal with room response signal by adding the elements to produce output signal having dimensions Length . In this way audio playback device may avoid applying fast convolution for each of the L residual room response segments. For a 22 channel input for conversion to binaural audio output signal this may reduce the number of fast convolutions for generating the residual room response from 22 to 2.

Audio playback device then applies fast convolution of multichannel audio signal with matrix to produce multichannel audio signal having dimensions Length L with left and right components . Audio playback device may then sum the multichannel audio signal by the L channels speakers to produce signal having dimensions Length .

Moreover while generally described above with respect to the examples of as being applied in the spherical harmonics domain the techniques may also be implemented with respect to any form of audio signals including channel based signals that conform to the above noted surround sound formats such as the 5.1 surround sound format the 7.1 surround sound format and or the 22.2 surround sound format. The techniques should therefore also not be limited to audio signals specified in the spherical harmonic domain but may be applied with respect to any form of audio signal.

As shown in the example of the audio playback device may be similar to the audio playback device shown in the example of . However the audio playback device may operate or otherwise perform the techniques with respect to general channel based audio signals that as one example conform to the 22.2 surround sound format. The extraction unit may extract audio channels where audio channels may generally include n channels and is assumed to include in this example 22 channels that conform to the 22.2 surround sound format. These channels are provided to both residual room response unit and per channel truncated filter unit of the binaural rendering unit .

As described above the BRIR filters include one or more BRIR filters and may represent an example of the BRIR filters of . The BRIR filters may include the separate BRIR filters A B representing the effect of the left and right HRTF on the respective BRIRs.

The BRIR conditioning unit receives n instances of the BRIR filters A B one for each channel n and with each BRIR filter having length N. The BRIR filters A B may already be conditioned to remove quiet samples. The BRIR conditioning unit may apply techniques described above to segment the BRIR filters A B to identify respective HRTF early reflection and residual room segments. The BRIR conditioning unit provides the HRTF and early reflection segments to the per channel truncated filter unit as matrices A B representing left and right matrices of size a L where a is a length of the concatenation of the HRTF and early reflection segments and n is a number of loudspeakers virtual or real . The BRIR conditioning unit provides the residual room segments of BRIR filters A B to residual room response unit as left and right residual room matrices A B of size b L where b is a length of the residual room segments and n is a number of loudspeakers virtual or real .

The residual room response unit may apply techniques describe above to compute or otherwise determine left and right common residual room response segments for convolution with the audio channels . That is residual room response unit may receive the left and right residual room matrices A B and combine the respective left and right residual room matrices A B over n to generate left and right common residual room response segments. The residual room response unit may perform the combination by in some instances averaging the left and right residual room matrices A B over n.

The residual room response unit may then compute a fast convolution of the left and right common residual room response segments with at least one of audio channel . In some examples the residual room response unit may receive from the BRIR conditioning unit a value for an onset time of the common residual room response segments. Residual room response unit may zero pad or otherwise delay the output signals A B in anticipation of combination with earlier segments for the BRIR filters . The output signals A may represent left audio signals while the output signals B may represent right audio signals.

The per channel truncated filter unit hereinafter truncated filter unit may apply the HRTF and early reflection segments of the BRIR filters to the channels . More specifically the per channel truncated filter unit may apply the matrixes A and B representative of the HRTF and early reflection segments of the BRIR filters to each one of the channels . In some instances the matrixes A and B may be combined to form a single matrix . Moreover typically there is a left one of each of the HRTF and early reflection matrices A and B and a right one of each of the HRTF and early reflection matrices A and B. That is there is typically an HRTF and early reflection matrix for the left ear and the right ear. The per channel direction unit may apply each of the left and right matrixes A B to output left and right filtered channels A and B. The combination unit may combine or in other words mix the left filtered channels A with the output signals A while combining or in other words mixing the right filtered channels B with the output signals B to produce binaural output signals A B. The binaural output signal A may correspond to a left audio channel and the binaural output signal B may correspond to a right audio channel.

In some examples the binaural rendering unit may invoke the residual room response unit and the per channel truncated filter unit concurrent to one another such that the residual room response unit operates concurrent to the operation of the per channel truncated filter unit . That is in some examples the residual room response unit may operate in parallel but often not simultaneously with the per channel truncated filter unit often to improve the speed with which the binaural output signals A B may be generated. While shown in various FIGS. above as potentially operating in a cascaded fashion the techniques may provide for concurrent or parallel operation of any of the units or modules described in this disclosure unless specifically indicated otherwise.

The process performs this decomposition by analyzing the BRIRs to eliminate inaudible components and determine components which comprise the HRTF early reflections and components due to late reflections diffusion. This results in an FIR filter of length as one example 2704 taps for part a and an FIR filter of length as another example 15232 taps for part b . According to the process the audio playback device may apply only the shorter FIR filters to each of the individual n channels which is assumed to be 22 for purposes of illustration in operation . The complexity of this operation may be represented in the first part of computation using a 4096 point FFT in Equation 8 reproduced below. In the process the audio playback device may apply the common reverb tail not to each of the 22 channels but rather to an additive mix of them all in operation . This complexity is represented in the second half of the complexity calculation in Equation 8 again which is shown in the attached Appendix.

In this respect the process may represent a method of binaural audio rendering that generates a composite audio signal based on mixing audio content from a plurality of N channels. In addition process may further align the composite audio signal by a delay with the output of N channel filters wherein each channel filter includes a truncated BRIR filter. Moreover in process the audio playback device may then filter the aligned composite audio signal with a common synthetic residual room impulse response in operation and mix the output of each channel filter with the filtered aligned composite audio signal in operations L and R for the left and right components of binaural audio output L R.

In some examples the truncated BRIR filter and the common synthetic residual impulse response are pre loaded in a memory.

In some examples the filtering of the aligned composite audio signal is performed in a temporal frequency domain.

In some examples the filtering of the aligned composite audio signal is performed in a time domain through a convolution.

In some examples the truncated BRIR filter and common synthetic residual impulse response is based on a decomposition analysis.

In some examples the decomposition analysis is performed on each of N room impulse responses and results in N truncated room impulse responses and N residual impulse responses where N may be denoted as n or n above .

In some examples the truncated impulse response represents less than forty percent of the total length of each room impulse response.

In some examples each of the N residual impulse responses is combined into a common synthetic residual room response that reduces complexity.

In some examples mixing the output of each channel filter with the filtered aligned composite audio signal includes a first set of mixing for a left speaker output and a second set of mixing for a right speaker output.

In various examples the method of the various examples of process described above or any combination thereof may be performed by a device comprising a memory and one or more processors an apparatus comprising means for performing each step of the method and one or more processors that perform each step of the method by executing instructions stored on a non transitory computer readable storage medium.

Moreover any of the specific features set forth in any of the examples described above may be combined into a beneficial example of the described techniques. That is any of the specific features are generally applicable to all examples of the techniques. Various examples of the techniques have been described.

The techniques described in this disclosure may in some instances identify only samples 111 to 17830 across BRIR set that are audible. Calculating a mixing time Tfrom the volume of an example room the techniques may then let all BRIRs share a common reverb tail after 53.6 ms resulting in a 15232 sample long common reverb tail and remaining 2704 sample HRTF reflection impulses with 3 ms crossfade between them. In terms of a computational cost break down the following may be arrived at

As a result a final figure of Merit may therefore approximately equal C max 100 C C C 0 88.0 where max 100 0 6 where C is an estimate of an unoptimized implementation 22 2 10 6 log 2 48000 10 7 C is some aspect may be determined by two additive factors 

A BRIR filter denoted as B z may be decomposed into two functions BT z and BR z which denote the truncated BRIR filter and the reverb BRIR filter respectively. Part a noted above may refer to this truncated BRIR filter while part b above may refer to the reverb BRIR filter. Bn z may then equal BT z z BR z where m denotes the delay. The output signal Y z may therefore be computed as 9 

The process may analyze the BR z to derive a common synthetic reverb tail segment where this common BR z may be applied instead of the channel specific BR z . When this common or channel general synthetic BR z is used Y z may be computed as 10 

As shown in the example of audio playback device may include an extraction unit a BRIR selection unit and a binaural rendering unit . The extraction unit may represent a unit configured to extract encoded audio data from bitstream . The extraction unit may forward the extracted encoded audio data in the form of spherical harmonic coefficients SHCs which may also be referred to a higher order ambisonics HOA in that the SHCs may include at least one coefficient associated with an order greater than one to the binaural rendering unit . The BRIR selection unit represents an interface by which a user user agent or other external entity may provide user input to select whether a regular or irregular set of BRIRs is to be used to binauralize SHCs in accordance with techniques described herein. BRIR selection unit may include a command line or graphical user interface an application programming interface a network interface an application interface such as Simple Object Access Protocol a Remote Procedure Call or any other interface by which an external entity may configure whether a regular or irregular set of BRIRs is to be used. Signal represents a control signal or user configuration data directing or configuring binaural rendering unit to user either a regular or irregular set of BRIRs for binauralizing SHCs . Signal may represent a flag a function parameter a signal or any other means by which audio playback device may direct binaural rendering unit to select either a regular or irregular set of BRIRs to be used for binauralizing SHCs .

In some examples audio playback device includes an audio decoding unit configured to decode the encoded audio data so as to generate the SHCs . The audio decoding unit may perform an audio decoding process that is in some aspects reciprocal to the audio encoding process used to encode SHCs . The audio decoding unit may include a time frequency analysis unit configured to transform SHCs of encoded audio data from the time domain to the frequency domain thereby generating the SHCs . That is when the encoded audio data represents a compressed form of the SHC that is not converted from the time domain to the frequency domain the audio decoding unit may invoke the time frequency analysis unit to convert the SHCs from the time domain to the frequency domain so as to generate SHCs specified in the frequency domain .

The time frequency analysis unit may apply any form of Fourier based transform including a fast Fourier transform FFT a discrete cosine transform DCT a modified discrete cosine transform MDCT and a discrete sine transform DST to provide a few examples to transform the SHCs from the time domain to SHCs in the frequency domain. In some instances SHCs may already be specified in the frequency domain in bitstream . In these instances the time frequency analysis unit may pass SHCs to the binaural rendering unit without applying a transform or otherwise transforming the received SHCs . While described with respect to SHCs specified in the frequency domain the techniques may be performed with respect to SHCs specified in the time domain.

Binaural rendering unit represents a unit configured to binauralize SHCs . Binaural rendering unit may in other words represent a unit configured to render the SHCs to a left and right channel which may feature spatialization to model how the left and right channel would be heard by a listener in a room in which the SHCs were recorded. The binaural rendering unit may render SHCs to generate a left channel A and a right channel B which may collectively be referred to as channels suitable for playback via a headset such as headphones. As shown in the example of the binaural rendering unit includes an interpolation unit a time frequency analysis unit a complex BRIR unit a summation unit a complex multiplication unit a symmetric optimization unit a non symmetric optimization unit and an inverse time frequency analysis unit .

The binaural rendering unit may invoke the interpolation unit to interpolate irregular BRIR filters A so as to generate interpolated regular BRIR filters C where reference to regular or irregular in the context of BRIR filters may denote a regularity or irregularity of the spacing of speakers relative to one another. The irregular BRIR filters A may be of size equal to L 2 where L denotes a number of loudspeakers . The regular BRIR filters A may comprise L loudspeakers 2 given that these are regularly arranged as pairs . A user or other operator of the audio playback device may indicate or otherwise configure whether the irregular BRIR filters A or the regular BRIR filters B are to be used during binauralization of the SHC .

Moreover the user or other operator of the audio playback device may indicate or otherwise configure whether when the irregular BRIR filters A are to be used during binauralization of the SHC interpolation is to be performed with respect to the irregular BRIR filters A to generate the regular BRIR filters C. The interpolation unit may interpolate the irregular BRIR filters B using vector based amplitude panning or other panning techniques to form B number of loudspeaker pairs resulting in the regular BRIR filters C having a size of L 2 again given that this is regular and therefore symmetric about an axis . Although not shown in the example of the user or other operator may interface with the audio playback device via a user interface whether graphically presented via a graphical user interface or physically presented e.g. as a series of buttons or other inputs to select whether irregular BRIR filters A regular BRIR filters B and or regular BRIR filters C are to be used when binauralizing SHC .

In any event when the BRIR filters A C depending on which is selected to binauralize the SHC are presented in the time domain the binaural rendering unit may invoke time frequency analysis unit to transform the selected one of BRIR filters A C BRIR filters from the time domain to the frequency domain resulting in transformed BRIR filters A C BRIR filters respectively. The complex BRIR unit represents a unit configured to perform an element by element complex multiplication and summation with respect to one of an irregular renderer A having a of size L N 1 or a regular renderer B having a of size L N 1 and one or more BRIR filter to generate two BRIR rendering vectors A and B each of size L N 1 where N again denotes the highest order of the spherical basis functions to which one or more of the SHC correspond.

Depending on whether the selected one of BRIR filters is regular or irregular the complex BRIR unit may select either the irregular renderer A or the regular renderer B. That is as one example when the selected one of BRIR filters is regular e.g. BRIR filter B or C the complex BRIR unit selects regular renderer B. When the selected one of BRIR filters is irregular e.g. BRIR filter A the complex BRIR unit selects irregular renderer A. In some examples the user or other operator of the audio playback device may indicate or otherwise select whether to use irregular renderer A or regular renderer B. In some examples the user or other operator of the audio playback device may indicate or otherwise select whether to use irregular renderer A or regular renderer B rather than select to use one of the BRIR filters where selection of the renderer A or B enables the selection of the one of BRIR filters e.g. selecting the regular renderer B results in the selection of BRIR filters B and or C and selecting the irregular renderer A results in the selection of BRIR filters A .

Summation unit may represent a unit that sums each of BRIR rendering vectors A and B over L to generate summed BRIR rendering vectors A and B. The windowing unit may represent a unit that applies a windowing function to each of summed BRIR rendering vectors A and B to generate windowed BRIR rendering vectors A and B. Examples of windowing functions may include a maxRE windowing function an in phase windowing function and a Kaiser windowing function. The complex multiplication unit represents a unit that performs an element by element complex multiplication of the SHC by each of vectors A and B to generate left modified SHC A and right modified SHC B.

The binaural rendering unit may then invoke either of the symmetric optimization unit or the non symmetric optimization unit potentially based on configuration data entered by the user or other operator of the audio playback device . That is when the user specifies that the irregular BRIR filters A are to be used during binauralization of the SHC the binaural rendering unit may determine whether the irregular BRIR filters A are symmetric or non symmetric. That is not all irregular BRIR filters A are non symmetric but may be symmetric. When the irregular BRIR filters A is symmetric but not regularly spaced the binaural rendering unit invokes the symmetric optimization unit to optimize rendering of the left and right modified SHC A and B. When the irregular BRIR filters A are non symmetric the binaural rendering unit invokes the non symmetric optimization unit to optimize the rendering of the left and right modified SHC A and B. When the regular BRIR filters B or C are selected the binaural rendering unit invokes the symmetric optimization unit to optimize the rendering of the left and right modified SHC A and B.

The symmetric optimization unit when invoked may sum only one of the left or right modified SHC A and B over the n orders and m sub orders. That is the symmetric optimization unit may sum SHC A over the n orders and m sub orders to generate frequency domain left speaker feed A. The symmetric optimization unit may then invert those of SHC A associated with a spherical basis function having a negative sub order and then sum over this inverted version of SHC A over the n orders and m sub orders to generate the frequency domain right speaker feed B. The non symmetric optimization unit when invoked sums each of the left modified SHC A and the right modified SHC B over the n orders and m sub orders to generate the frequency domain left speaker feed A and the frequency domain right speaker feed B respectively. The inverse time frequency analysis unit may represent a unit to transform either the frequency domain left speaker feed A or A and either the corresponding frequency domain right speaker feed B or A from the frequency domain to the time domain so as to generate the left speaker feed A and the right speaker feed B.

In this way the techniques enable a device comprising one or more processors to apply a binaural room impulse response filter to spherical harmonic coefficients representative of a sound field in three dimensions so as to render the sound field.

In some examples the one or more processors are further configured to when applying the binaural room impulse response filter apply an irregular binaural room impulse response filter to the spherical harmonic coefficients so as to render the sound field wherein the irregular binaural room impulse response filters comprises one or more binaural room impulse response filters for an irregular arrangement of speakers.

In some examples the one or more processors are further configured to when applying the binaural room impulse response filter apply a regular binaural room impulse response filter to the spherical harmonic coefficients so as to render the sound field wherein the regular binaural room impulse response filters comprises one or more binaural room impulse response filters for a regular arrangement of speakers.

In some examples the one or more processors are further configured to interpolate an irregular binaural room impulse response filter to generate a regular binaural room impulse response filter. In these and other examples the irregular binaural room impulse response filters comprises one or more binaural room impulse response filters for an irregular arrangement of speakers and the regular binaural room impulse response filters comprises one or more binaural room impulse response filters for a regular arrangement of speakers. In these and other examples the one or more processors are further configured to when applying the binaural room impulse response filter apply the regular binaural room impulse response filter to the spherical harmonic coefficients so as to render the sound field.

In some examples the one or more processors are further configured to apply a windowing function to the binaural room impulse response filter to generate a windowed binaural room impulse response filter. In these and other examples the one or more processors are further configured to when applying the binaural room impulse response filter apply the windowed binaural room impulse response filter to the spherical harmonic coefficients so as to render the sound field.

In some examples the one or more processors are further configured to transform the binaural room impulse response filter from a time domain to a frequency domain so as to generate a transformed binaural room impulse response filter. In these and other examples the one or more processors are further configured to when applying the binaural room impulse response filter apply the transformed binaural room impulse response filter to the spherical harmonic coefficients so as to render the sound field.

In some examples the one or more processors are further configured to transform the binaural room impulse response filter from a time domain to a frequency domain so as to generate a transformed binaural room impulse response filter and transform the spherical harmonic coefficients from the time domain to the frequency domain so as to generate a transformed spherical harmonic coefficients. In these and other examples the one or more processors are further configured to when applying the binaural room impulse response filter apply the transformed binaural room impulse response filter to the transformed spherical harmonic coefficients so as to render a frequency domain representation of the sound field. In these and other examples the one or more processors are further configured to apply an inverse transform to the frequency domain representation of the sound field to render the sound field.

However audio playback device may also include an order reduction unit that processes inbound SHCs to reduce an order or sub order of the SHCs to generate order reduced SHCs . The order reduction unit may perform this order reduction based on an analysis such as an energy analysis a directionality analysis and other forms of analysis or combinations thereof of the SHC to remove one or more sub orders m or orders n from the SHC . The energy analysis may involve performing a singular value decomposition with respect to the SHC . The directionality analysis may also involve performing a singular value decomposition with respect to the SHC . The SHC may therefore include less orders and or sub orders than SHC .

The order reduction unit may also generate order reduction data identifying the orders and or sub orders of the SHC that were removed to generate the SHC . The order reduction unit may provide this order reduction data and the order reduced SHC to the binaural rendering unit . The binaural rendering unit of the audio playback device may function substantially similar to the binaural rendering unit of the audio playback device except that the binaural rendering unit of the audio playback device may alter various ones of the renderers based on the order reduced SHC while also operating with respect to the order reduced SHC rather than the non order reduced SHC . The binaural rendering unit of the audio playback device may alter modify or determine the renderers based on the order reduction data by at least in part removing those portions of the renderers responsible for rendering the removed orders and or sub orders of the SHC . Performing order reduction may reduce computational complexity in terms of processor cycles and or memory consumption associated with binauralization of the SHC generally without significantly impacting audio playback in terms of introducing noticeable artifacts or otherwise distorting playback of the sound field as intended .

The techniques described in this disclosure and shown in the example of may provide an efficient way by which to binauralize 3D sound fields through a set of regular or irregular BRIRs in the frequency domain. If an irregular set of BRIRs A is to be used by binaural rendering unit to render SHCs e.g. the binaural rendering unit may in some cases interpolate the BRIR set to a regular spaced set of BRIRs C. This interpolation may be done via linear interpolation Vector Base Amplitude Panning VBAP etc. If not already in the frequency domain the BRIR set to be used or selected BRIR set may be transformed into the frequency domain using a fast Fourier transform FFT discrete Fourier transform DFT discrete cosine transform DCT modified DCT MDCT and decimated signal diagonalization DSD for instance. Binaural rendering unit may then complex multiply the BRIR set to be used with a regular renderer B or irregular renderer A dependent on the previous choice of either regular BRIR filters B or irregular BRIR filters A respectively. The order N of the regular renderer B or irregular renderer A may be determined by the choice to use the full order of the incoming HOA signal e.g. SHCs such that N

After the complex multiplication of the appropriate renderer of renderers A B with the BRIR set to be used the outputted signals A B may be summed over the L dimension to produce binauralized HOA renderer signals A B. To further enhance the rendering a window block may be included so that the weighting of n m where m is an HOA sub order over frequency can be changed using windowing functions such as maxRe in phase or Kaiser. Those windows may help meet traditional Ambisonics criteria set out by Gerzon that gives objective measures to meet psychoacoustic criteria. After this optional window the binaural rendering unit complex multiples the HOA signal with the binauralized HOA renderer signals A B to produce binaural HOA signals A B these are examples of what are described elsewhere in this disclosure as left right modified SHCs A B . The techniques may also allow for Symmetrical BRIR Optimization in some instances. If binaural rendering unit applies non symmetrical optimization the binaural rendering unit sums the n m HOA coefficients for the left and right channels. If however binaural rendering unit applies symmetrical optimization binaural rendering unit sums and outputs n m HOA coefficients for the left channel. But due to symmetry of the spherical harmonic basis functions the values for m

In this way the techniques may a include 3D not just 2D b binauralization of higher order Ambisonics not just first order Ambisonics c application of regular or irregular BRIR sets d interpolation of BRIRs from irregular to regular BRIR sets e windowing of the BRIR signal to better match Ambisonics reproduction criteria and f potentially improve computationally efficiency by at least in part taking advantage of frequency domain computation rather than time domain computation.

The extraction unit may extract encoded audio data from bitstream . The extraction unit may forward the extracted encoded audio data in the form of spherical harmonic coefficients SHCs which may also be referred to a higher order ambisonics HOA in that the SHCs may include at least one coefficient associated with an order greater than one to the binaural rendering unit . Assuming that the SHCs are already be specified in the frequency domain in bitstream the time frequency analysis unit may pass SHCs to the binaural rendering unit without applying a transform or otherwise transforming the received SHCs . While described with respect to SHCs specified in the frequency domain the techniques may be performed with respect to SHCs specified in the time domain.

In any event the binaural rendering unit may in other words represent a unit configured to render the SHCs to a left and right channel which may feature spatialization to model how the left and right channel would be heard by a listener in a room in which the SHCs were recorded. The binaural rendering unit may render SHCs to generate a left channel A and a right channel B which may collectively be referred to as channels suitable for playback via a headset such as headphones.

The binaural rendering unit may receive user configuration data to determine whether to perform binaural rendering with respect to irregular BRIR filter A regular BRIR filter B and or interpolated BRIR filter C. In other words the binaural rendering unit may receive the user configuration data selecting which of filters should be used when performing binauralization of the SHC . User configuration data may represent an example of signal of FIGS. . When the user configuration data specifies that the regular BRIR filter B is to be used YES the binaural rendering unit selects the regular BRIR filter B and the regular renderer B . When the user configuration data indicates that the irregular BRIR filter A is to be used NO without interpolating this filter A NO the binaural rendering unit selects the irregular BRIR filter A and the irregular renderer A . When the user configuration data indicates that the irregular BRIR filter A is to be used NO but that this filter A is to be interpolated YES the binaural rendering unit selects the interpolated BRIR filter C after invoking interpolation unit to interpolate the selected filter A to generate the filter C and the regular renderer B .

In any event when the BRIR filters A C depending on which is selected to binauralize the SHC are presented in the time domain the binaural rendering unit may invoke time frequency analysis unit to transform the selected one of BRIR filters A C BRIR filters from the time domain to the frequency domain resulting in transformed BRIR filters A C BRIR filters respectively. The complex BRIR unit may perform an element by element complex multiplication and summation with respect to the selected one of renderers and the selected one of BRIR filter to generate two BRIR rendering vectors A and B .

Summation unit may sum each of BRIR rendering vectors A and B over L to generate summed BRIR rendering vectors A and B . The windowing unit may apply a windowing function to each of summed BRIR rendering vectors A and B to generate windowed BRIR rendering vectors A and B . The complex multiplication unit may then perform an element by element complex multiplication of the SHC by each of vectors A and B to generate left modified SHC A and right modified SHC B .

The binaural rendering unit may then invoke either of the symmetric optimization unit or the non symmetric optimization unit potentially based on configuration data entered by the user or other operator of the audio playback device as described above.

The symmetric optimization unit when invoked may sum only one of the left or right modified SHC A and B over the n orders and m sub orders. That is the symmetric optimization unit may sum SHC A over the n orders and m sub orders to generate frequency domain left speaker feed A. The symmetric optimization unit may then invert those of SHC A associated with a spherical basis function having a negative sub order and then sum over this version of SHC A over the n orders and m sub orders to generate the frequency domain right speaker feed A.

The non symmetric optimization unit when invoked sums each of the left modified SHC A and the right modified SHC B over the n orders and m sub orders to generate the frequency domain left speaker feed A and the frequency domain right speaker feed B respectively. The inverse time frequency analysis unit may represent a unit to transform either the frequency domain left speaker feed A or A and either the corresponding frequency domain right speaker feed B or A from the frequency domain to the time domain so as to generate the left speaker feed A and the right speaker feed B. In this way the binaural rendering unit may perform optimization with respect to one or more of the left and right SHC A and B to generate the left and right speaker feeds A and B . The audio playback device may continue to operate in the manner described above extracting and binauralizing the SHC to render the left speaker feed A and the right speaker feed B .

The techniques described in this disclosure and shown in the example of may provide an efficient way by which to binauralize 3D sound fields through a set of regular or irregular BRIRs in the frequency domain. If an irregular set of BRIRs are used there may be a choice to interpolate the BRIR set to a regular spaced set of BRIRs. This interpolation may be done via linear interpolation Vector Base Amplitude Panning VBAP etc. As depicted in if not already in the frequency domain the BRIR set to be used may in some examples be transformed into the frequency domain using a fast Fourier transform FFT discrete Fourier transform DFT discrete cosine transform DCT MDCT and DSD to provide a few examples. The BRIR set may then be complex multiplied with a regular or irregular renderer dependent on the previous regular irregular choice. The order N of the regular or irregular renderer may be governed by the choice to use the full order of the incoming HOA signal such that N

After the complex multiplication of the correct renderer with the correct BRIR signal set the outputted signals may be summed over the L dimension to produce binauralized HOA renderer signals. To further enhance the rendering a window block may be included so that the weighting of n m over frequency can be changed using windowing functions such as maxRe in phase or Kaiser. Those windows may help meet traditional Ambisonics criteria set out by Gerzon that gives objective measures to meet psychoacoustic criteria. After this optional window the HOA if in the frequency domain as depicted in is complex multiplied with the binauralized HOA renderer signals. If the HOA are in the time domain the HOA may be fast convoluted with the binauralized HOA rendered signals as depicted in .

The techniques may also allow for Symmetrical BRIR Optimization in some instances. If the non optimized route is performed then the n m HOA coefficients may be summed for the left and right channels. If the symmetrical path is selected the outputted signal for left is the sum of the n m values but due to symmetry of the spherical harmonic basis functions the value of m

The techniques may a include 3D not just 2D b binauralize higher order Ambisonics not just first order Ambisonics c apply regular or irregular BRIR sets d perform interpolation of BRIRs from irregular to regular BRIR sets e performing windowing of the BRIR signal to better match Ambisonics reproduction criteria and f potentially improve computationally efficiency by at least in part taking advantage of frequency domain computation rather than time domain computation again as depicted in .

In addition to or as an alternative to the above the following examples are described. The features described in any of the following examples may be utilized with any of the other examples described herein.

One example is directed to a method of binaural audio rendering comprising applying a binaural room impulse response filter to spherical harmonic coefficients representative of a sound field in three dimensions so as to render the sound field.

In some examples applying the binaural room impulse response filter comprises applying an irregular binaural room impulse response filter to the spherical harmonic coefficients so as to render the sound field wherein the irregular binaural room impulse response filters comprises one or more binaural room impulse response filters for an irregular arrangement of speakers.

In some examples applying the binaural room impulse response filter comprises applying a regular binaural room impulse response filter to the spherical harmonic coefficients so as to render the sound field wherein the regular binaural room impulse response filters comprises one or more binaural room impulse response filters for a regular arrangement of speakers.

In some examples an order of spherical basis functions to which the spherical harmonic coefficients correspond is greater than one.

In some examples the method further comprises interpolating an irregular binaural room impulse response filter to generate a regular binaural room impulse response filter wherein the irregular binaural room impulse response filters comprises one or more binaural room impulse response filters for an irregular arrangement of speakers and the regular binaural room impulse response filters comprises one or more binaural room impulse response filters for a regular arrangement of speakers and applying the binaural room impulse response filter comprises applying the regular binaural room impulse response filter to the spherical harmonic coefficients so as to render the sound field.

In some examples the method further comprises applying a windowing function to the binaural room impulse response filter to generate a windowed binaural room impulse response filter and applying the binaural room impulse response filter comprises applying the windowed binaural room impulse response filter to the spherical harmonic coefficients so as to render the sound field.

In some examples the method further comprises transforming the binaural room impulse response filter from a time domain to a frequency domain so as to generate a transformed binaural room impulse response filter and applying the binaural room impulse response filter comprises applying the transformed binaural room impulse response filter to the spherical harmonic coefficients so as to render the sound field.

In some examples the method further comprises transforming the binaural room impulse response filter from a time domain to a frequency domain so as to generate a transformed binaural room impulse response filter and transforming the spherical harmonic coefficients from the time domain to the frequency domain so as to generate a transformed spherical harmonic coefficients wherein applying the binaural room impulse response filter comprises applying the transformed binaural room impulse response filter to the transformed spherical harmonic coefficients so as to render a frequency domain representation of the sound field and wherein the method further comprises applying an inverse transform to the frequency domain representation of the sound field to render the sound field.

One example is directed to a device comprising one or more processors configured to apply a binaural room impulse response filter to spherical harmonic coefficients representative of a sound field in three dimensions so as to render the sound field.

In some examples the one or more processors are further configured to when applying the binaural room impulse response filter apply an irregular binaural room impulse response filter to the spherical harmonic coefficients so as to render the sound field wherein the irregular binaural room impulse response filters comprises one or more binaural room impulse response filters for an irregular arrangement of speakers.

In some examples the one or more processors are further configured to when applying the binaural room impulse response filter apply a regular binaural room impulse response filter to the spherical harmonic coefficients so as to render the sound field wherein the regular binaural room impulse response filters comprises one or more binaural room impulse response filters for a regular arrangement of speakers.

In some examples an order of spherical basis functions to which the spherical harmonic coefficients correspond is greater than one.

In some examples the one or more processors are further configured to interpolate an irregular binaural room impulse response filter to generate a regular binaural room impulse response filter wherein the irregular binaural room impulse response filters comprises one or more binaural room impulse response filters for an irregular arrangement of speakers and the regular binaural room impulse response filters comprises one or more binaural room impulse response filters for a regular arrangement of speakers and the one or more processors are further configured to when applying the binaural room impulse response filter apply the regular binaural room impulse response filter to the spherical harmonic coefficients so as to render the sound field.

In some examples the one or more processors are further configured to apply a windowing function to the binaural room impulse response filter to generate a windowed binaural room impulse response filter and the one or more processors are further configured to when applying the binaural room impulse response filter apply the windowed binaural room impulse response filter to the spherical harmonic coefficients so as to render the sound field.

In some examples the one or more processors are further configured to transform the binaural room impulse response filter from a time domain to a frequency domain so as to generate a transformed binaural room impulse response filter and the one or more processors are further configured to when applying the binaural room impulse response filter apply the transformed binaural room impulse response filter to the spherical harmonic coefficients so as to render the sound field.

In some examples the one or more processors are further configured to transform the binaural room impulse response filter from a time domain to a frequency domain so as to generate a transformed binaural room impulse response filter and transform the spherical harmonic coefficients from the time domain to the frequency domain so as to generate a transformed spherical harmonic coefficients the one or more processors are further configured to when applying the binaural room impulse response filter apply the transformed binaural room impulse response filter to the transformed spherical harmonic coefficients so as to render a frequency domain representation of the sound field and the one or more processors are further configured to apply an inverse transform to the frequency domain representation of the sound field to render the sound field.

One example is directed to a device comprising means for determining spherical harmonic coefficients representative of a sound field in three dimensions and means for applying a binaural room impulse response filter to spherical harmonic coefficients representative of a sound field so as to render the sound field.

In some examples the means for applying the binaural room impulse response filter comprises means for applying an irregular binaural room impulse response filter to the spherical harmonic coefficients so as to render the sound field and the irregular binaural room impulse response filters comprises one or more binaural room impulse response filters for an irregular arrangement of speakers.

In some examples the means for applying the binaural room impulse response filter comprises means for applying a regular binaural room impulse response filter to the spherical harmonic coefficients so as to render the sound field and the regular binaural room impulse response filters comprises one or more binaural room impulse response filters for a regular arrangement of speakers.

In some examples an order of spherical basis functions to which the spherical harmonic coefficients correspond is greater than one.

In some examples the device further comprises means for interpolating an irregular binaural room impulse response filter to generate a regular binaural room impulse response filter the irregular binaural room impulse response filters comprises one or more binaural room impulse response filters for an irregular arrangement of speakers and the regular binaural room impulse response filters comprises one or more binaural room impulse response filters for a regular arrangement of speakers and the means for applying the binaural room impulse response filter comprises means for applying the regular binaural room impulse response filter to the spherical harmonic coefficients so as to render the sound field.

In some examples the device further comprises means for applying a windowing function to the binaural room impulse response filter to generate a windowed binaural room impulse response filter and the means for applying the binaural room impulse response filter comprises means for applying the windowed binaural room impulse response filter to the spherical harmonic coefficients so as to render the sound field.

In some examples the device further comprises means for transforming the binaural room impulse response filter from a time domain to a frequency domain so as to generate a transformed binaural room impulse response filter and the means for applying the binaural room impulse response filter comprises means for applying the transformed binaural room impulse response filter to the spherical harmonic coefficients so as to render the sound field.

In some examples the device further comprises means for transforming the binaural room impulse response filter from a time domain to a frequency domain so as to generate a transformed binaural room impulse response filter and means for transforming the spherical harmonic coefficients from the time domain to the frequency domain so as to generate a transformed spherical harmonic coefficients and the means for applying the binaural room impulse response filter comprises means for applying the transformed binaural room impulse response filter to the transformed spherical harmonic coefficients so as to render a frequency domain representation of the sound field and the device further comprises means for applying an inverse transform to the frequency domain representation of the sound field to render the sound field.

One example is directed to a non transitory computer readable storage medium having stored thereon instructions that when executed cause one or more processors to apply a binaural room impulse response filter to spherical harmonic coefficients representative of a sound field in three dimensions so as to render the sound field.

Moreover any of the specific features set forth in any of the examples described above may be combined into a beneficial example of the described techniques. That is any of the specific features are generally applicable to all examples of the invention. Various examples of the invention have been described.

It should be understood that depending on the example certain acts or events of any of the methods described herein can be performed in a different sequence may be added merged or left out altogether e.g. not all described acts or events are necessary for the practice of the method . Moreover in certain examples acts or events may be performed concurrently e.g. through multi threaded processing interrupt processing or multiple processors rather than sequentially. In addition while certain aspects of this disclosure are described as being performed by a single device module or unit for purposes of clarity it should be understood that the techniques of this disclosure may be performed by a combination of devices units or modules.

In one or more examples the functions described may be implemented in hardware software firmware or any combination thereof. If implemented in software the functions may be stored on or transmitted over as one or more instructions or code on a computer readable medium and executed by a hardware based processing unit. Computer readable media may include computer readable storage media which corresponds to a tangible medium such as data storage media or communication media including any medium that facilitates transfer of a computer program from one place to another e.g. according to a communication protocol.

In this manner computer readable media generally may correspond to 1 tangible computer readable storage media which is non transitory or 2 a communication medium such as a signal or carrier wave. Data storage media may be any available media that can be accessed by one or more computers or one or more processors to retrieve instructions code and or data structures for implementation of the techniques described in this disclosure. A computer program product may include a computer readable medium.

By way of example and not limitation such computer readable storage media can comprise RAM ROM EEPROM CD ROM or other optical disk storage magnetic disk storage or other magnetic storage devices flash memory or any other medium that can be used to store desired program code in the form of instructions or data structures and that can be accessed by a computer. Also any connection is properly termed a computer readable medium. For example if instructions are transmitted from a website server or other remote source using a coaxial cable fiber optic cable twisted pair digital subscriber line DSL or wireless technologies such as infrared radio and microwave then the coaxial cable fiber optic cable twisted pair DSL or wireless technologies such as infrared radio and microwave are included in the definition of medium.

It should be understood however that computer readable storage media and data storage media do not include connections carrier waves signals or other transient media but are instead directed to non transient tangible storage media. Disk and disc as used herein includes compact disc CD laser disc optical disc digital versatile disc DVD floppy disk and Blu ray disc where disks usually reproduce data magnetically while discs reproduce data optically with lasers. Combinations of the above should also be included within the scope of computer readable media.

Instructions may be executed by one or more processors such as one or more digital signal processors DSPs general purpose microprocessors application specific integrated circuits ASICs field programmable logic arrays FPGAs or other equivalent integrated or discrete logic circuitry. Accordingly the term processor as used herein may refer to any of the foregoing structure or any other structure suitable for implementation of the techniques described herein. In addition in some aspects the functionality described herein may be provided within dedicated hardware and or software modules configured for encoding and decoding or incorporated in a combined codec. Also the techniques could be fully implemented in one or more circuits or logic elements.

The techniques of this disclosure may be implemented in a wide variety of devices or apparatuses including a wireless handset an integrated circuit IC or a set of ICs e.g. a chip set . Various components modules or units are described in this disclosure to emphasize functional aspects of devices configured to perform the disclosed techniques but do not necessarily require realization by different hardware units. Rather as described above various units may be combined in a codec hardware unit or provided by a collection of interoperative hardware units including one or more processors as described above in conjunction with suitable software and or firmware.

Various embodiments of the techniques have been described. These and other embodiments are within the scope of the following claims.

