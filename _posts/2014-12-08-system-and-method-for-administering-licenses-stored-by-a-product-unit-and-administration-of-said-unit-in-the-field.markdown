---

title: System and method for administering licenses stored by a product unit, and administration of said unit in the field
abstract: The product unit disclosed herein has identification data that are stored internally in memory. This stored identification data can be viewed as the product unit's “digital nameplate,” in that the data can represent the product unit's identifier, brand, and so on. Each data set is digitally signed while on the production line by using an encryption technique. The digitally signed data set is then written into the product unit's memory where it can be used for verification. A first digitally-signed data set can be used to control the use of one or more software modules that are provided by a software owner. The data that are undergoing signature contain at least one globally-unique identifier, which can be used to identify cloning attempts. Additionally, more than one digital signature can be used, in order to protect and control the use of features other than the software, such as the product brand.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09471948&OS=09471948&RS=09471948
owner: Seed Labs Sp. z o.o.
number: 09471948
owner_city: 
owner_country: PL
publication_date: 20141208
---
The following case is incorporated herein by reference U.S. Patent Application Ser. No. 61 981 068 filed Apr. 17 2014. If there are any contradictions or inconsistencies in language between this application and the case that has been incorporated by reference that might affect the interpretation of the claims in this application the claims in this application should be interpreted to be consistent with the language in this application.

The present invention relates to telecommunications in general and more particularly to administering one or more licenses associated with a product unit that comprises an electronic module with storage capability and also to monitoring and controlling the product unit in the field.

A license is an agreement that permits the use of something. In the area of intellectual property such permission might include for example the copying of software the use of a patented invention or the distribution of products under a trademark or particular name.

Without a license any use or exploitation of an owner s intellectual property by another would amount to illegal copying or infringement. Such copying would be improper and could be stopped through legal intervention if the intellectual property owner wanted to take such action.

Unscrupulous individuals and businesses such as counterfeiters often attempt to use one s intellectual property without permission. Such exploitation on the part of these individuals and businesses is often difficult to detect and to trace. Moreover the exploitation of an owner s intellectual property might occur alongside an apparent authorized use of the property and such exploitation can also be difficult to detect.

The present invention enables the administration of one or more licenses associated with a product unit and also the monitoring and control of the product unit in the field. The product unit disclosed herein has identification data that are stored internally. This stored identification data can be viewed as the product unit s digital nameplate in that the data represents among other things one or more of the product unit s identifier brand function and so on. In order to prevent a manufacturer from creating illegal copies of the product unit or manufacturing a greater number of product units than was ordered each data set is digitally signed while on the production line by using an encryption technique such as while not being limited to asymmetric cryptography. The digitally signed data set is then written into the product unit s memory where it can be used for verification and for other purposes as disclosed herein. In particular a first digitally signed data set can be used to control the use of one or more software modules that are provided by the software owner.

In accordance with an illustrative embodiment of the present invention a crucial part of the nameplate signing is that data that are undergoing signature contain at least one globally unique identifier which can be used to identify cloning attempts. In some embodiments of the present invention a media access control MAC address can serve as this identifier for Bluetooth Low Energy BLE communications and for communications based on other protocols. As this address is used to address the product unit devices on the data link layer any duplications of a MAC address or other globally unique identifier for that matter in a single network can be detected and cause communications to malfunction. In some other embodiments of the present invention a globally unique identifier that is different from a MAC address can be used e.g. IPv6 address etc. .

The product unit s globally unique communication address or identifier with or without some additional information that is important from a business perspective is used for a digital signature which can be subsequently used to verify the authenticity of the product unit. Consequently if one wants to counterfeit or clone the device the counterfeiter must clone the communications address as well in order to keep the digital signature valid. This can be detected effectively by a technique disclosed herein.

More than one digital signature can be used in accordance with an illustrative embodiment of the present invention in order to protect and control the use of intellectual property other than the software. As already described a first digital signature is used by the software owner of a software module to be licensed for use in the product unit. A second digital signature can be used by the brand owner of a brand to be licensed for use in the product unit for example and without limitation. As those who are skilled in the art will appreciate after reading this specification a different number of independent signatures than two is possible. Furthermore any combination of signatures can be used.

A physical world analogue to the digital nameplate herein is a hologram that is affixed to a compact disc CD case. In theory the CD hologram is proof of genuineness and enables copyright owners to verify the number of disks manufactured. In reality however a perfect copy of the CD product including the hologram can be indistinguishable from the original. In contrast if the data stored in the disclosed product unit were signed using the MAC address or other unique identifier a perfect copy of the product unit and stored data would indeed have a valid digital signature. This is because all of the signed data would be the same as in the original. But advantageously such a clone would have impaired functionality because two or more identical MAC addresses would be unable to work within the same computer network. Additionally a digitally signed nameplate can also be used to protect business critical information from being tampered with.

An illustrative method for controlling a device comprises transmitting by a first wireless device a first message comprising a first identifier wherein the first message requests a first digitally signed document from a second wireless device wherein the second wireless device is identified by the first identifier receiving by the first wireless device a second message from the second wireless device in response to the transmitting of the first message wherein the second message comprises the requested first digitally signed document wherein first digitally signed document comprises a first digital signature verifying that the first digital signature received from the second wireless device is valid based on a first public key and presenting to a user by the first wireless device a first indicium that represents the second wireless device only if the first digital signature is verified as being valid.

An illustrative first wireless device for controlling another device comprises a transmitter configured to transmit a first message comprising a first identifier wherein the first message requests a first digitally signed document from a second wireless device wherein the second wireless device is identified by the first identifier a receiver configured to receive a second message from the second wireless device in response to the transmitting of the first message wherein the second message comprises the requested first digitally signed document wherein first digitally signed document comprises a first digital signature a processor configured to verify that the first digital signature received from the second wireless device is valid based on a first public key and a display configured to present a first indicium that represents the second wireless device only if the first digital signature is verified as being valid.

An illustrative method for monitoring a device comprises receiving by a server computer i first message comprising a a first identifier that identifies a first wireless device and b a first datum and ii a second message comprising a a second identifier that identifies a second wireless device and b a second datum comparing by the server computer the first datum and the second datum based on the first identifier and the second identifier matching each other inferring by the server computer a characteristic of the manufacture of the first wireless device based on the comparing and transmitting by the server computer a third message based on the inferred characteristic.

For the purposes of the present specification the following terms and their inflected forms are defined as follows 

To facilitate explanation and understanding of the present invention the following description sets forth several details. However it will be clear to those having ordinary skill in the art after reading the present disclosure that the present invention may be practiced without these specific details or with an equivalent solution or configuration. Furthermore some structures devices and operations that are well known in the art are depicted in block diagram form in the accompanying figures in order to keep salient aspects of the present invention from being unnecessarily obscured.

Manufacturer system is a collection of software and hardware that is used to manufacture product unit by interacting with software owner system and brand owner system in addition to product unit as described in detail below. System comprises one or more computers having non transitory memory processing components and communication components including server computer computer network and test rig . Server computer and test rig are described below and in respectively. Computer network enables communication between server computer test rig product unit and telecommunications network . Network comprises one or more of wired Ethernet WiFi and Bluetooth Low Energy BLE networks. However as those who are skilled in the art will appreciate after reading this specification computer network can be based on one or more different types of wired and or wireless network technology standards in addition to or instead of those mentioned above such as Z Wave ZigBee Bluetooth Classic or Thread for example and without limitation. Furthermore as those who are skilled in the art will appreciate after reading this specification test rig and product unit in some embodiments can be connected directly to each other at least for some purposes and or for some portion of time such as through Universal Serial Bus USB FireWire or Thunderbolt for example and without limitation.

Software owner system is a collection of software and hardware that is used to administer licenses that are relevant to product unit including software licenses by interacting with manufacturer system and brand owner system as described in detail below. System comprises one or more computers having non transitory memory processing components and communication components including server computer computer network and digital signature system or signature system . Server computer is a collection of software and hardware similar to server computer . Signature system is a collection of software and hardware that provides a digital signature and information from a database as described below. In some embodiments system comprises a server computer similar to server computer . Computer network enables communication between server computer signature system and telecommunications network . Network comprises one or more of wired Ethernet and WiFi networks however as those who are skilled in the art will appreciate after reading this specification a different combination of wired and or wireless networks can be used within network in order to enable communication.

Brand owner system is a collection of software and hardware that is used to administer licenses that are relevant to product unit including brand licenses by interacting with manufacturer system and software owner system as described in detail below. System comprises one or more computers having non transitory memory processing components and communication components including server computer computer network and digital signature system or signature system . Server computer is a collection of software and hardware similar to server computer . Signature system is a collection of software and hardware that provides a digital signature and information from a database as described below. In some embodiments system comprises a server computer similar to server computer . Computer network enables communication between server computer signature system and telecommunications network . Network comprises one or more of wired Ethernet and WiFi networks however as those who are skilled in the art will appreciate after reading this specification a different combination of wired and or wireless networks can be used within network in order to enable communication.

In accordance with an illustrative embodiment of the present invention systems and are controlled by separate business entities. For example and without limitation manufacturer system is controlled by a manufacturer entity software owner system is controlled by a software owner entity and brand owner system is controlled by a brand owner entity each having separate control with respect to one another at least at some level. As those who are skilled in the art will appreciate after reading this specification however two or more of systems and might be controlled by the same business entity in some alternative embodiments of the present invention.

Telecommunications network comprises a collection of links and nodes that enable telecommunication between devices in well known fashion. Telecommunications network provides at least some of the elements of system with connectivity to one other. In some embodiments of the present invention telecommunications network is the Internet in some other embodiments of the present invention network is the Public Switched Telephone Network PSTN in still some other embodiments of the present invention network is a private data network. It will be clear to those with ordinary skill in the art after reading this disclosure that in some embodiments of the present invention network can comprise one or more of the above mentioned networks and or other telecommunications networks without limitation. Furthermore it will be clear to those will ordinary skill in the art after reading this disclosure that telecommunications network can comprise elements that are capable of wired and or wireless communication without limitation.

Product unit is an apparatus that comprises memory processing components and communication components. In accordance with an illustrative embodiment of the present invention unit is a smart appliance. For example and without limitation unit can be a sound system a kitchen appliance a home appliance used outside the kitchen an electrical plug a thermostat a coffeemaker a kettle or a dispenser. However as those who are skilled in the art will appreciate after reading this specification the product unit can be another type of smart appliance or even another type of apparatus entirely. Unit is manufactured by manufacturer system based on one or more licenses provided from software owner system or brand owner system or both. Product unit is described in detail below and in .

Mobile station is a wireless telecommunications terminal that is configured to transmit and or receive communications wirelessly. It is an apparatus that comprises memory processing components telecommunication components and user interface components e.g. display speaker keyboard microphone etc. . Mobile station comprises the hardware and software necessary to be compliant with the protocol standards used in the wireless network or networks e.g. network network etc. in which it operates and to perform the processes described below and in the accompanying figures. For example and without limitation mobile station is capable of 

Furthermore mobile station is illustratively a smartphone with at least packet data capability provided and supported by the network in which it operates and that is configured to execute a software application e.g. an app for controlling one or more product units . In some alternative embodiments of the present invention mobile station can be referred to by a variety of alternative names such as while not being limited to a wireless transmit receive unit WTRU a user equipment UE a wireless terminal a cell phone or a fixed or mobile subscriber unit. For that matter mobile station can be any other type of device that is capable of operating in a wireless network environment mobility oriented or otherwise and of i connecting to product unit ii fetching its identification data and signature and iii validating it either internally by using a public key that device possesses or by calling a cloud service of the software owner or the manufacturer. In at least some embodiments of the present invention these functions are executed in the background by the controlling application.

Computer network enables communication between mobile station and product unit . Network comprises a Bluetooth Low Energy BLE network. However as those who are skilled in the art will appreciate after reading this specification computer network can be based on one or more different types of wireless network technology standards in addition to or instead of BLE such as Z Wave ZigBee Wi Fi Bluetooth Classic or Thread for example and without limitation in order to enable communication between the mobile station and product unit. Furthermore as those who are skilled in the art will appreciate after reading this specification mobile station and product unit in some embodiments can be connected directly and non wirelessly to each other at least for some purposes and or for some portion of time such as through Universal Serial Bus USB FireWire or Thunderbolt for example and without limitation.

Certification authority is a collection of software and hardware that is used to issue digital certificates as are known in the art. The digital certificate certifies the ownership of public key by the named subject of the certificate in well known fashion. This allows other entities such as but not limited to system system system product unit and mobile station to rely upon signatures or assertions made by the private key that corresponds to the public key that is certified as described in detail below.

Processor is a general purpose processor that is configured to execute operating system and application software and to populate amend use and manage database as described in detail below and in the accompanying figures. For the purposes of this specification a processor is defined as one or more computational elements whether co located or not and whether networked together or not. It will be clear to those skilled in the art how to make and use processor .

Memory is non transitory and non volatile computer storage memory technology that is well known in the art e.g. flash memory etc. . Memory is configured to store operating system application software and database . The operating system is a collection of software that manages in well known fashion server computer s hardware resources and provides common services for computer programs such as those that constitute the application software. The application software that is executed by processor enables server computer to perform the functions disclosed herein. Database comprises information about one or more product units while in the process of manufacturing.

It will be clear to those having ordinary skill in the art how to make and use alternative embodiments that comprise more than one memory or comprise subdivided segments of memory or comprise a plurality of memory technologies that collectively store the operating system application software and database.

Network interface module comprises a network adapter configured to enable server computer to transmit information to and receive information from test rig via computer network . In addition network interface module enables server computer to transmit information to and receive information from systems and via telecommunications network . It will be clear to those skilled in the art how to make and use network interface module .

As mentioned previously server computers and are similar to server computer . Each server computer comprises one or more processors memory and network interface modules. It will be clear to those skilled in the art after reading this specification how to make and use servers and in part by following the description of server .

Processor is a general purpose processor that is configured to execute operating system and application software and to populate amend use and manage database including storing measurement results for production quality monitoring as described in detail below and in the accompanying figures. It will be clear to those skilled in the art how to make and use processor .

Memory is non transitory and non volatile computer storage memory technology that is well known in the art e.g. flash memory etc. . Memory is configured to store operating system application software and database . The operating system is a collection of software that manages in well known fashion test rig s hardware resources and provides common services for computer programs such as those that constitute the application software. The application software that is executed by processor enables test rig to perform the functions disclosed herein. Database comprises information about one or more product units while in the process of manufacturing.

It will be clear to those having ordinary skill in the art how to make and use alternative embodiments that comprise more than one memory or comprise subdivided segments of memory or comprise a plurality of memory technologies that collectively store the operating system application software and database.

First network interface module comprises a network adapter that is configured to enable test rig to transmit information to and receive information from server computer e.g. by WiFi etc. via computer network . It will be clear to those skilled in the art how to make and use first network interface module .

Second network interface module comprises a network adapter that is configured to enable test rig to transmit information to and receive information from product unit via Bluetooth Low Energy BLE enabled via radio receiver part and radio transmitter part in accordance with an illustrative embodiment of the present invention. In some other embodiments of the present invention second network interface module can communicate via a different type of wireless network technology standard such as Z Wave ZigBee Wi Fi Bluetooth Classic or Thread for example and without limitation. In still some other embodiments of the present invention second network interface module might be combined with first network interface module . In any event it will be clear to those skilled in the art after reading this specification how to make and use second network interface module .

Product unit comprises the components that are depicted in and described below in accordance with an illustrative embodiment of the present invention. However it will be clear to those skilled in the art after reading this specification how to make and use embodiments of the present invention in which product unit is a device that at a minimum comprises an electronic module that is configured to store a digitally signed nameplate as described below.

Sensor component wherein j has a value between 1 and J inclusive is an apparatus that comprises memory processing components and communication components and is configured to transmit signals providing sensor related information as described in detail below. In accordance with an illustrative embodiment each sensor component comprises a sensor wherein the sensor gathers information about the environment that is accessible by the sensor component.

Each sensor is configured to monitor a particular physical condition in well known fashion. A sensor senses a change in the condition being monitored and is configured to report a state of the condition by providing input signals to processor wherein the values of the input signals are representative of the states being reported. A given sensor component can report discrete input signal values and or a continuum of states and can report states at particular times and or continuously. For example and without limitation sensor component can comprise one or more of the following sensors with respective functions 

As those who are skilled in the art will appreciate after reading this disclosure sensor component can provide a different function or functions than those described above. Furthermore product unit can comprise any combination of and any number of sensor components and sensor functions possibly including none some or all of those listed above. The tasks performed by product unit that correspond to these sensor components can be performed within manufacturing system e.g. for testing purposes etc. or can be performed outside of the manufacturing system e.g. within a home automation environment etc. or both.

Actor component wherein k is equal to 1 through K inclusive is an apparatus that comprises memory processing components and communication components and is capable of doing something in the course of being affected by signals originating externally to the actor component possibly from mobile station or possibly from one or more sensor components i.e. in the product unit or a different one and processed by processor . In accordance with an illustrative embodiment of the present invention each actor component takes decisions that are based on signals from one or more sources and performs appropriate actions upon the actor s environment. Each actor component acts upon its environment in well known fashion. In some embodiments an actor component is or comprises an actuator as is known in the art.

Actor component is configured to receive transmit process and or relay signals conveying data as well as being configured to affect a condition physical or otherwise in its environment. For example and without limitation the condition being affected can be 

As those who are skilled in the art will appreciate after reading this disclosure actor component can provide a different function than those described above. Furthermore product unit can comprise any combination of and any number of actor components possibly including none some or all of those corresponding to the affected conditions listed above. The tasks performed by product unit that correspond to these actor components can be performed within manufacturing system e.g. for testing purposes etc. or can be performed outside of the manufacturing system e.g. within a home automation environment etc. or both.

As those who are skilled in the art will appreciate after reading this disclosure product unit comprising one or more actor functions can be in a variety of forms. For example and without limitation such forms include a light bulb as part of a lighting system a media player as part of an audio video system a heater as part of an environment control system an outgoing email server as part of a messaging system an actor in a water sprinkler system a robot or robotic arm a pan tilt camera a switch a motor a servo mechanism a kettle for boiling liquids and so on.

Processor is a processing device such as a microprocessor that is well known in the art. Processor is configured such that when operating in conjunction with the other components of product unit processor executes software processes data and telecommunicates according to the operations described herein.

Memory is non transitory and non volatile computer storage memory technology that is well known in the art e.g. flash memory etc. . Memory is configured to store operating system application software and database . The operating system is a collection of software that manages in well known fashion product unit s hardware resources and provides common services for computer programs such as those that constitute the application software. The application software that is executed by processor according to an illustrative embodiment enables product unit to perform the functions disclosed herein. Database comprises information about each sensor component and about each actor component information about product unit in general and information that is digitally signed as described herein. For example and without limitation database stores a digitally signed document when received by the product unit from another device e.g. test rig etc. .

It will be clear to those having ordinary skill in the art how to make and use alternative embodiments that comprise more than one memory or comprise subdivided segments of memory or comprise a plurality of memory technologies that collectively store the operating system application software and database.

Network interface module comprises a network adapter configured to enable product unit to telecommunicate with other devices and systems by receiving signals therefrom and or transmitting signals thereto via radio receiver and radio transmitter respectively via Bluetooth Low Energy BLE in accordance with an illustrative embodiment of a present invention. For example network interface module communicates with one or both of test rig and mobile station . In some other embodiments of the present invention network interface module can communicate via one or more different types of wireless network technology standards in addition to or instead of BLE such as Z Wave ZigBee Wi Fi Bluetooth Classic or Thread for example and without limitation. In a multiple protocol configuration a first network adapter can support a first standard e.g. BLE etc. a second network adapter can support a second standard e.g. WiFi etc. and so on for example and without limitation.

Module is based on an LSR TiWi uB1 BLE module according to an illustrative embodiment of the present invention. In some other embodiments of the present invention module can be based on another type of module. As those who are skilled in the art will appreciate after reading this specification module can comprise one or more of the elements that are depicted in as being separate from module such as processor and or memory .

In accordance with an illustrative embodiment product unit uses network interface module in order to telecommunicate wirelessly with external devices. It will be clear to those skilled in the art however after reading the present disclosure how to make use and use various embodiments of the present invention in which product unit communicates via a different type of wireless network e.g. personal area network local area network etc. or via a wired protocol e.g. X10 KNX etc. over physical media e.g. cable wire etc. with one or more external devices either in addition to or instead of the wireless capability provided by module . In any event it will be clear to those skilled in the art after reading this specification how to make and use network interface module .

Each manufactured product unit has identification data that are stored internally. This is referred to herein as a digital nameplate. This data represents among other things one or more of the product unit s i unique identifier e.g. MAC address serial number etc. ii brand iii function and so on. In order to prevent a manufacturer from creating illegal copies of the product unit or manufacturing a greater number of product units than was ordered each data set is digitally signed while on the production line by using asymmetric cryptography. As those who are skilled in the art will appreciate after reading this specification a different encryption technique can be used. The digitally signed data set is then written into product unit s memory where it can be used for verification and for other purposes as disclosed herein. In particular a first digitally signed data set can be used to control the use of one or more software modules that are provided by the software owner.

In accordance with an illustrative embodiment of the present invention a crucial part of the nameplate signing is that data that are undergoing signature contain at least one globally unique identifier which can be used to identify cloning attempts. In some embodiments of the present invention a media access control MAC address can serve as this identifier for BLE communications and for communications based on other protocols. As this address is used to address the devices on the data link layer any duplications of a MAC address or other globally unique identifier for that matter in a single network can be detected and cause communications to malfunction. As those who are skilled in the art will appreciate after reading this specification a globally unique identifier that is different from a MAC address can be used e.g. IPv6 address etc. .

As described above product unit s globally unique communication address or identifier with or without some additional information that is important from a business perspective is used for a digital signature which is subsequently used to verify the authenticity of the product unit. Consequently if one wants to counterfeit or clone the device the counterfeiter must clone the communications address as well in order to keep the digital signature valid. In some cases address cloning by itself may render product unit useless in that a given computer network will inherently be unable to handle communications properly when multiple units with the same address are present in the same computer network. When cloned units are present across multiple and distinct computer networks or even within the same network for that matter such cloning can be detected effectively by a technique disclosed herein.

According to an illustrative embodiment more than one digital signature can be used in order to control and protect the use of different intellectual property items by product unit . As already described a first digital signature is used by the software owner of a software module to be licensed for use in the product unit. A second digital signature can be used by the brand owner of a brand to be licensed for use in the product unit for example and without limitation. As those who are skilled in the art will appreciate after reading this specification a different number of independent signatures is possible than the two in the foregoing example. Furthermore any combination of signatures can be used in order to protect different features that constitute product unit .

The brand owner s involvement in nameplate signing might be considered optional. For example with original equipment manufacturer OEM products there is no third party involved so a signing process that occurs only between the software owner and the manufacturer might be considered adequate.

In regard to method as well as to the methods depicted in the other flowcharts and message flow diagrams contained herein it will be clear to those having ordinary skill in the art after reading the present disclosure how to make and use alternative embodiments of the disclosed methods wherein the recited operations sub operations and messages are differently sequenced grouped or sub divided all within the scope of the present invention. Also it will be further clear to those skilled in the art after reading the present disclosure how to make and use alternative embodiments of the disclosed methods wherein at least some of the described operations sub operations and messages are optional are omitted or are performed by other elements and or systems.

As depicted in brand owner system provides manufacturer system with a product order via message including an order identifier order ID . In some alternative embodiments of the present invention the order can originate elsewhere instead.

Server computer of system receives message and as a result initiates in accordance with operation further depicted in a sequence of transactions with product unit via test rig . As part of transaction sequence test rig tests the product unit e.g. assesses performance etc. . Also as part of transactions legally manufactured product unit has a license tag programmed in a non volatile memory as part of a personalization process. Contingent upon a successful test e.g. a semi automatic test etc. once the product unit is considered valid and ready to be packaged test rig initiates the personalization process and in doing so performs the following actions 

As those who are skilled in the art will appreciate after reading this specification the same test rig or other tester or testing device can perform both the testing and personalization processes or different test rigs can perform the testing and personalization processes for one or more product units.

After one or more of the operations depicted in have occurred one or more billing account statements can be issued to the affected parties. In some embodiments software owner system can issue such a statement to manufacturer system and or brand owner system indicating the number of manufactured and or licensed units. For example brand owner system can verify the statement against their brand licensing agreement and choose to accept or reject the invoice.

In some embodiments test rig identifies a product unit that it should connect to by using data that are broadcast by the particular product unit. This can be used for example and without limitation to avoid interference between workstations that are concurrently working with different product units while eliminating the need for a Faraday cage at least during some stages of manufacture. In some embodiments the data that can be used to assign the product unit to a specific test rig comprises i a Line identifier which can be a hardcoded identifier of the test rig to be used and ii the Phase which depends on the current stage of manufacturing e.g. a sub state of a state machine etc. . Identification of the phase enables process separation for example four different test rigs concurrently can be conducting i some testing ii remaining tests iii personalization without PIN setup and iv PIN programming and labeling.

In accordance with operation server computer has received order message comprising an order ID from brand owner system . In some other embodiments of the present invention message is received from another entity. Server computer passes the order ID to test rig in message .

In accordance with operation test rig recognizes product unit at least in part because of boot sequence and reads the order ID received in message . Based on one or both of the foregoing actions test rig requests unit s identifier via message if not already known. Product unit provides the identifier in accordance with operation via message .

In accordance with operation test rig transmits the product unit identifier ID via message to server computer . The server computer then requests one or more license tags from software owner system in accordance with operation and via message which contains the product unit s ID.

In accordance with operation server computer of system receives message which contains the order ID and the product unit ID. Based on having received the order ID or the product unit ID or both server transmits the order identifier and product unit identifier to signature system via message . In some embodiments the two types of identifiers are transmitted to signature system via separate messages. For example and without limitation the order ID can be provided in a first message and all of the product IDs in a second the order ID can be provided in a first message and each product ID in its own message etc.

In accordance with operation signature system receives the order ID looks it up in its database and recognizes that this particular order is for a particular number of units e.g. ten thousand units etc. to be licensed to use a particular software module. In response to this signature system digitally signs each product unit ID in the order by using a hash function and the private key of the software owner as part of a public key cryptography scheme as is known in the art in which the signed ID is determined mathematically. As those who are skilled in the art will appreciate after reading this specification signature system can sign a product unit ID via a different scheme than described. Signature system passes each signed product unit ID i.e. the digital signature of the product unit ID back to server computer via one or more messages .

In some embodiments signature system also recognizes that the units are also to be licensed with a particular brand in mind and indicates this to server computer . Alternatively server computer instead of signature system can determine that this brand related licensing is to be performed. In the embodiments in which brand related licensing is to be performed server computer also communicates with brand owner system for the purpose of obtaining a signed brand ID. In accordance with operation and based on having received the order ID or the product unit ID or message or some combination thereof server transmits a brand identifier brand ID to signature system via message . The brand ID indicates the brand that is to be licensed. Server computer obtains the brand ID from a database e.g. from signature system etc. . In some embodiments server computer instead transmits a different indicium e.g. order ID etc. to brand owner system which then determines the applicable brand ID.

In accordance with operation server computer receives message and forwards the received brand ID to signature system via message . In accordance with operation signature system receives the brand ID looks it up in its database and verifies that this particular brand is valid for use. In response to this signature system digitally signs the brand ID by using a hash function and the private key of the brand owner as part of a public key cryptography scheme as is known in the art in which the signed ID is determined mathematically. As those who are skilled in the art will appreciate after reading this specification signature system can sign a brand ID via a different scheme than described. Signature system passes each signed brand ID back to server computer via message i.e. the digital signature of the brand ID . Server computer receives message and in accordance with operation forwards the signed brand ID to server computer via message .

In accordance with operation and in response to having received the signed product unit ID or IDs in message and if applicable the signed brand ID in message server computer transmits the received signed ID or IDs to manufacturer system via message .

In accordance with operation server computer receives the signed IDs in message and forwards the received IDs to test rig .

In accordance with operation test rig transmits via message the signed product unit ID to the corresponding product unit for each digitally signed product unit ID received. In this process of burning into memory one or more signed identifiers more than one message might actually be exchanged between test rig and each product unit . In some embodiments test rig also transmits to the product unit the data comprising that product unit identifier that were actually signed by signature system .

Test rig also transmits the signed brand ID if available to product unit . In some embodiments test rig also transmits to the product unit the data comprising the brand identifier that were actually signed by signature system .

In some embodiments test rig also transmits to the product unit one or more digital certificates that can be used to verify the digitally signed data. A digital certificate which is known in the art is also known as a public key certificate. Such a digital certificate can be obtained from a third party source such as certificate authority and each digital certificate can be established at the time that the corresponding private key for the software owner or the brand owner is established.

In accordance with operation product unit stores its signed product unit ID as part of a first digitally signed document. In some embodiments the first digitally signed document might also comprise the original data that was signed or the corresponding digital certificate or both. If a brand license is also in effect product unit stores the signed brand ID as part of a second digitally signed document. In some embodiments the second digitally signed document might also comprise the original data that was signed or the corresponding digital certificate or both.

Product unit then transmits an acknowledgment via message back to test rig which acknowledgment can then be transmitted to server computer and to other systems e.g. systems and or etc. if needed.

In some embodiments of the present invention unless properly tested and licensed product unit remains in a manufacturing state and is not usable by the end user. Once properly licensed unit is put in a usable state.

In accordance with operation and through the downloaded app mobile station recognizes the product unit and requests via message i the stored software license signed with the software license tag and ii the stored brand identifier or license signed with the brand license tag.

In accordance with operation product unit responds by transmitting via message the requested information.

In accordance with operation mobile station receives the requested information and in response requests via message i the digital certificate associated with the public key for verifying the signed software license signed with the software license tag and ii the digital certificate associated with the public key for verifying the signed brand license signed with the brand license tag for the purpose of verifying the signatures. Mobile station makes the request for each digital certificate to the certification authority that is responsible for each public key in well known fashion. Although a single certification authority is depicted in some embodiments different certification authorities can be used for the different public keys.

In accordance with operation certification authority in response provides the digital certificates back to mobile station via one or more messages .

In accordance with operation mobile station via the controlling app verifies the signatures using the software owner public key and the brand owner public key received the one or more messages in well known fashion.

In accordance with operation if the software license has been verified to be valid the app being executed by mobile station enables the licensed software embedded in product unit to be used. In some embodiments mobile station enables the software embedded in product unit to be used only if the license is verified to be valid.

In accordance with operation if the brand license has been verified to be valid the app being executed by mobile station displays an indicium of the licensed brand e.g. displays a branded icon on the phone screen etc. . In some embodiments mobile station displays an indicium of the brand only if the license is verified to be valid.

With regard to verifying the brand license to be valid in some embodiments additional features can be enabled if the license is determined to be valid.

In some alternative embodiments of the present invention instead of mobile station performing the check of the signature to determine whether the signature is valid or invalid product unit performs a self check of the signature. In such embodiments product unit is treated as being in a trusted execution environment in which no third party or attacker can inject or run any non authorized code in the unit s processor. The trusted public keys corresponding to software owner system and or brand owner system are contained within the firmware of product unit . As a result neither mobile station nor certification authority are required for the self check. In some other embodiments however product unit independently of mobile station can interact with certification authority for the purpose of performing the check of the signature e.g. in accordance with one or more of tasks or messages through etc. . Product unit can perform the self check as part of a boot up sequence or whenever there is a predetermined task or other function executed by the product unit e.g. pairing with mobile station etc. . When product unit performs the check the only trusted execution environment that is needed is its processor running the software owner s code in the product unit.

Regardless of which device checks the signature i.e. the mobile station or the product unit one or more actions can be performed or denied based on the outcome of the verification. The mobile station app serving as the checker for example and without limitation can decline to communicate with the product unit can prompt its user to purchase on line a valid license and then writes it to the module as described below or can transmit a disable command to the product unit whereupon the product unit deactivates one or more of the functions that it is otherwise able to perform either temporarily or permanently. Product unit serving as the checker for example and without limitation can decline to perform one or more functions can enter a limited functionality mode such as operating with a reduced radio range or performing only basic functions e.g. providing on off lamp switching but not lamp dimming etc. or can provide error state information and the error reason to a connected application in order to explain to a user what is happening.

In accordance with operation in mobile station reports via message product unit s communications address to server computer which processes the received report as described here and in accordance with operation . In some embodiments of the present invention the software owner entity or some other authorized entity for that matter can monitor for duplicates of the unique identifier globally for example by making the controlling applications executing on multiple mobile stations report periodically or sporadically the visible MAC addresses to a central server computer e.g. server computer etc. . Alternatively a device or system different than station can report the visible address e.g. a home gateway etc. . If two or more systems report the same address the cloning event can be proven by tracing back to one or more events occurring at a particular manufacturing line or lines. Each device that executes the user application can perform this for one or more product units that it controls. An algorithm working on the server computer can then compare the incoming reports from the different devices in order to determine additional details.

By comparing the data from the incoming reports the server computer in accordance with operation can determine not only that a MAC address has been spoofed but also details such as the particular origin and or circumstances of the spoofing or manufacture of a device e.g. the particular manufacturer the particular manufacturing location the time and date of a particular manufacturing event etc. . For example and without limitation the comparing and the resulting details can be based on one or more of the following 

In some embodiments the server computer can take resulting action such as transmitting a message to report the cloning to another system e.g. brand owner system manufacturer system etc. or to direct mobile station to disable one or more product units for example and without limitation.

The operations depicted in can be used to provide intellectual property owners with traceability and to block any potential counterfeiting. For example a manufacturer either the one controlling manufacturer system or someone else might have decided not to stop the manufacturing line after producing an ordered 10 000 units and went on to manufacture another 50 000 units for other markets. The unscrupulous manufacturer would not be able to get away with profiting from the unlicensed units. This is because after issuing the 10 000 licenses for a particular order represented by an order ID software owner system would refuse to issue any more licenses and brand owner system would refuse to digitally sign any more brand identifiers. Although the manufacturer kept the production line running to produce the extra 50 000 units those product units would not have a valid software license or brand license. This means that mobile station s software app would verify them negatively and it would not allow them to be presented or controlled. Thus the products would be of diminished value to their users if not valueless.

A key difference between product units having licensed software and those that do not is in the set of intellectual property rights obtained through software owner system . Accordingly telecommunications system enables obtaining a license on the retail level in addition to enabling licensing to manufacturers and brand owners on the wholesale level. Therefore the field of the digital nameplate that contains or represents the software license information can be remotely updatable in the field by a user.

The user decides to make an in app purchase of the software owner s license. Correspondingly and in accordance with operation mobile station processes in well known fashion a sequence of transactions with purchasing system which handles the transactions in accordance with operation . For example and without limitation system can correspond to Google Checkout PayPal station s wireless carrier s billing service and so on.

Mobile station then initiates in accordance with operation a sequence of transactions with product unit . The sequence of transactions is analogous to the sequence depicted in for operation except that Server Computer and Test Rig as part of Manufacturer System as depicted in can be interpreted in the present context as corresponding to mobile station . As part of transaction sequence product unit has a license tag programmed in a non volatile memory as part of an updating process. Mobile station initiates the updating process and in doing so performs the following actions 

Optionally product unit s firmware validates the digital signature before storing it in its memory in accordance with operation .

Notably the signature can cover the information that is updated in the field by the user such as the license level of the purchased license. The signature can cover other information such as the owner s name email address and so on. The software app can allow the owner to provide such information whereupon the software licensing server verifies it and signs the updated nameplate.

It is to be understood that the disclosure teaches just one example of the illustrative embodiment and that many variations of the invention can easily be devised by those skilled in the art after reading this disclosure and that the scope of the present invention is to be determined by the following claims.

