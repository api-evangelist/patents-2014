---

title: Peer to peer (P2P) operation by integrating with content delivery networks (CDN)
abstract: A method and apparatus for use in a network storage control peer (NSCP) supporting peer to peer (P2P) operation are disclosed. The method includes receiving a content map request message and transmitting a content map response message including an indication that a CDN-stored content piece is available from the NSCP; and, receiving a content fetch request message for the content piece and transmitting a response message including a redirection command and the CDN URI for the content piece.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09398088&OS=09398088&RS=09398088
owner: InterDigital Patent Holdings, Inc.
number: 09398088
owner_city: Wilmington
owner_country: US
publication_date: 20140930
---
This application is a continuation application of U.S. application Ser. No. 13 490 045 filed Jun. 6 2012 which is a non provisional filing of U.S. provisional application No. 61 494 283 filed Jun. 7 2011 the contents of both of which are hereby incorporated by reference herein.

Content delivery networks CDN may host third party content for fast delivery of static content streaming media and other services. Common methods exist for CDNs to perform user redirection. The most common methods may include using special dynamic name servers DNS application layer redirection and content modification. For example content modification may be uniform resource identifier URI rewriting. In addition CDN interconnection CDNI for a CDN interworking model may enable request routing to cross CDN boundaries. Existing CDNs may redirect end users towards surrogate servers using DNS based redirection.

There may be two or more ways for a P2P system to interwork with a CDN. One way may include the CDN used as the content source server. In another the CDN edge servers may be enhanced to perform the functionalities of network peers.

A method and apparatus for use in a network storage control peer NSCP supporting peer to peer P2P operation are disclosed. The method includes receiving information from a tracker wherein the information includes swarm stats selecting and joining a swarm based on the received information receiving a first stat report from the tracker wherein the stat report includes additional swarm stats determining whether to upload information to an ingestion gateway based on the received first stat report transmitting an upload request message to the ingestion gateway receiving an upload response from the ingestion gateway and transmitting a second stat report to the tracker wherein the second stat report includes a uniform resource identifier URI for the uploaded information.

As shown in the communications system may include wireless transmit receive units WTRUs a radio access network RAN a core network a public switched telephone network PSTN the Internet and other networks though it will be appreciated that the disclosed embodiments contemplate any number of WTRUs base stations networks and or network elements. Each of the WTRUs may be any type of device configured to operate and or communicate in a wireless environment. By way of example the WTRUs may be configured to transmit and or receive wireless signals and may include user equipment UE a mobile station a fixed or mobile subscriber unit a pager a cellular telephone a personal digital assistant PDA a smartphone a laptop a netbook a personal computer a wireless sensor consumer electronics and the like.

The communications systems may also include a base station and a base station . Each of the base stations may be any type of device configured to wirelessly interface with at least one of the WTRUs to facilitate access to one or more communication networks such as the core network the Internet and or the networks . By way of example the base stations may be a base transceiver station BTS a Node B an eNode B a Home Node B a Home eNode B a site controller an access point AP a wireless router and the like. While the base stations are each depicted as a single element it will be appreciated that the base stations may include any number of interconnected base stations and or network elements.

The base station may be part of the RAN which may also include other base stations and or network elements not shown such as a base station controller BSC a radio network controller RNC relay nodes etc. The base station and or the base station may be configured to transmit and or receive wireless signals within a particular geographic region which may be referred to as a cell not shown . The cell may further be divided into cell sectors. For example the cell associated with the base station may be divided into three sectors. Thus in one embodiment the base station may include three transceivers i.e. one for each sector of the cell. In another embodiment the base station may employ multiple input multiple output MIMO technology and therefore may utilize multiple transceivers for each sector of the cell.

The base stations may communicate with one or more of the WTRUs over an air interface which may be any suitable wireless communication link e.g. radio frequency RF microwave infrared IR ultraviolet UV visible light etc. . The air interface may be established using any suitable radio access technology RAT .

More specifically as noted above the communications system may be a multiple access system and may employ one or more channel access schemes such as CDMA TDMA FDMA OFDMA SC FDMA and the like. For example the base station in the RAN and the WTRUs may implement a radio technology such as Universal Mobile Telecommunications System UMTS Terrestrial Radio Access UTRA which may establish the air interface using wideband CDMA WCDMA . WCDMA may include communication protocols such as High Speed Packet Access HSPA and or Evolved HSPA HSPA . HSPA may include High Speed Downlink Packet Access HSDPA and or High Speed Uplink Packet Access HSUPA .

In another embodiment the base station and the WTRUs may implement a radio technology such as Evolved UMTS Terrestrial Radio Access E UTRA which may establish the air interface using Long Term Evolution LTE and or LTE Advanced LTE A .

In other embodiments the base station and the WTRUs may implement radio technologies such as IEEE 802.16 i.e. Worldwide Interoperability for Microwave Access WiMAX CDMA2000 CDMA2000 1 CDMA2000 EV DO Interim Standard 2000 IS 2000 Interim Standard 95 IS 95 Interim Standard 856 IS 856 Global System for Mobile communications GSM Enhanced Data rates for GSM Evolution EDGE GSM EDGE GERAN and the like.

The base station in may be a wireless router Home Node B Home eNode B or access point for example and may utilize any suitable RAT for facilitating wireless connectivity in a localized area such as a place of business a home a vehicle a campus and the like. In one embodiment the base station and the WTRUs may implement a radio technology such as IEEE 802.11 to establish a wireless local area network WLAN . In another embodiment the base station and the WTRUs may implement a radio technology such as IEEE 802.15 to establish a wireless personal area network WPAN . In yet another embodiment the base station and the WTRUs may utilize a cellular based RAT e.g. WCDMA CDMA2000 GSM LTE LTE A etc. to establish a picocell or femtocell. As shown in the base station may have a direct connection to the Internet . Thus the base station may not be required to access the Internet via the core network .

The RAN may be in communication with the core network which may be any type of network configured to provide voice data applications and or voice over internet protocol VoIP services to one or more of the WTRUs . For example the core network may provide call control billing services mobile location based services pre paid calling Internet connectivity video distribution etc. and or perform high level security functions such as user authentication. Although not shown in it will be appreciated that the RAN and or the core network may be in direct or indirect communication with other RANs that employ the same RAT as the RAN or a different RAT. For example in addition to being connected to the RAN which may be utilizing an E UTRA radio technology the core network may also be in communication with another RAN not shown employing a GSM radio technology.

The core network may also serve as a gateway for the WTRUs to access the PSTN the Internet and or other networks . The PSTN may include circuit switched telephone networks that provide plain old telephone service POTS . The Internet may include a global system of interconnected computer networks and devices that use common communication protocols such as the transmission control protocol TCP user datagram protocol UDP and the internet protocol IP in the TCP IP internet protocol suite. The networks may include wired or wireless communications networks owned and or operated by other service providers. For example the networks may include another core network connected to one or more RANs which may employ the same RAT as the RAN or a different RAT.

Some or all of the WTRUs in the communications system may include multi mode capabilities i.e. the WTRUs may include multiple transceivers for communicating with different wireless networks over different wireless links. For example the WTRUs shown in may be configured to communicate with the base station which may employ a cellular based radio technology and with the base station which may employ an IEEE 802 radio technology.

The processor may be a general purpose processor a special purpose processor a conventional processor a digital signal processor DSP a plurality of microprocessors one or more microprocessors in association with a DSP core a controller a microcontroller Application Specific Integrated Circuits ASICs Field Programmable Gate Array FPGAs circuits any other type of integrated circuit IC a state machine and the like. The processor may perform signal coding data processing power control input output processing and or any other functionality that enables the WTRU to operate in a wireless environment. The processor may be coupled to the transceiver which may be coupled to the transmit receive element . While depicts the processor and the transceiver as separate components it will be appreciated that the processor and the transceiver may be integrated together in an electronic package or chip.

The transmit receive element may be configured to transmit signals to or receive signals from a base station e.g. the base station over the air interface . For example in one embodiment the transmit receive element may be an antenna configured to transmit and or receive RF signals. In another embodiment the transmit receive element may be an emitter detector configured to transmit and or receive IR UV or visible light signals for example. In yet another embodiment the transmit receive element may be configured to transmit and receive both RF and light signals. It will be appreciated that the transmit receive element may be configured to transmit and or receive any combination of wireless signals.

In addition although the transmit receive element is depicted in as a single element the WTRU may include any number of transmit receive elements . More specifically the WTRU may employ MIMO technology. Thus in one embodiment the WTRU may include two or more transmit receive elements e.g. multiple antennas for transmitting and receiving wireless signals over the air interface .

The transceiver may be configured to modulate the signals that are to be transmitted by the transmit receive element and to demodulate the signals that are received by the transmit receive element . As noted above the WTRU may have multi mode capabilities. Thus the transceiver may include multiple transceivers for enabling the WTRU to communicate via multiple RATs such as UTRA and IEEE 802.11 for example.

The processor of the WTRU may be coupled to and may receive user input data from the speaker microphone the keypad and or the display touchpad e.g. a liquid crystal display LCD display unit or organic light emitting diode OLED display unit . The processor may also output user data to the speaker microphone the keypad and or the display touchpad . In addition the processor may access information from and store data in any type of suitable memory such as the non removable memory and or the removable memory . The non removable memory may include random access memory RAM read only memory ROM a hard disk or any other type of memory storage device. The removable memory may include a subscriber identity module SIM card a memory stick a secure digital SD memory card and the like. In other embodiments the processor may access information from and store data in memory that is not physically located on the WTRU such as on a server or a home computer not shown .

The processor may receive power from the power source and may be configured to distribute and or control the power to the other components in the WTRU . The power source may be any suitable device for powering the WTRU . For example the power source may include one or more dry cell batteries e.g. nickel cadmium NiCd nickel zinc NiZn nickel metal hydride NiMH lithium ion Li ion etc. solar cells fuel cells and the like.

The processor may also be coupled to the GPS chipset which may be configured to provide location information e.g. longitude and latitude regarding the current location of the WTRU . In addition to or in lieu of the information from the GPS chipset the WTRU may receive location information over the air interface from a base station e.g. base stations and or determine its location based on the timing of the signals being received from two or more nearby base stations. It will be appreciated that the WTRU may acquire location information by way of any suitable location determination method while remaining consistent with an embodiment.

The processor may further be coupled to other peripherals which may include one or more software and or hardware modules that provide additional features functionality and or wired or wireless connectivity. For example the peripherals may include an accelerometer an e compass a satellite transceiver a digital camera for photographs or video a universal serial bus USB port a vibration device a television transceiver a hands free headset a Bluetooth module a frequency modulated FM radio unit a digital music player a media player a video game player module an Internet browser and the like.

As shown in the RAN may include base stations and an ASN gateway though it will be appreciated that the RAN may include any number of base stations and ASN gateways while remaining consistent with an embodiment. The base stations may each be associated with a particular cell not shown in the RAN and may each include one or more transceivers for communicating with the WTRUs over the air interface . In one embodiment the base stations may implement MIMO technology. Thus the base stations for example may use multiple antennas to transmit wireless signals to and receive wireless signals from the WTRUs . The base stations may also provide mobility management functions such as handoff triggering tunnel establishment radio resource management traffic classification quality of service QoS policy enforcement and the like. The ASN gateway may serve as a traffic aggregation point and may be responsible for paging caching of subscriber profiles routing to the core network and the like.

The air interface between the WTRUs and the RAN may be defined as an R1 reference point that implements the IEEE 802.16 specification. In addition each of the WTRUs may establish a logical interface not shown with the core network . The logical interface between the WTRUs and the core network may be defined as an R2 reference point which may be used for authentication authorization IP host configuration management and or mobility management.

The communication link between each of the base stations may be defined as an R8 reference point that includes protocols for facilitating WTRU handovers and the transfer of data between base stations. The communication link between the base stations and the ASN gateway may be defined as an R6 reference point. The R6 reference point may include protocols for facilitating mobility management based on mobility events associated with each of the WTRUs 

As shown in the RAN may be connected to the core network . The communication link between the RAN and the core network may defined as an R3 reference point that includes protocols for facilitating data transfer and mobility management capabilities for example. The core network may include a mobile IP home agent MIP HA an authentication authorization accounting AAA server and a gateway . While each of the foregoing elements are depicted as part of the core network it will be appreciated that any one of these elements may be owned and or operated by an entity other than the core network operator.

The MIP HA may be responsible for IP address management and may enable the WTRUs to roam between different ASNs and or different core networks. The MIP HA may provide the WTRUs with access to packet switched networks such as the Internet to facilitate communications between the WTRUs and IP enabled devices. The AAA server may be responsible for user authentication and for supporting user services. The gateway may facilitate interworking with other networks. For example the gateway may provide the WTRUs with access to circuit switched networks such as the PSTN to facilitate communications between the WTRUs and traditional land line communications devices. In addition the gateway may provide the WTRUs with access to the networks which may include other wired or wireless networks that are owned and or operated by other service providers.

Although not shown in it will be appreciated that the RAN may be connected to other ASNs and the core network may be connected to other core networks. The communication link between the RAN the other ASNs may be defined as an R4 reference point which may include protocols for coordinating the mobility of the WTRUs between the RAN and the other ASNs. The communication link between the core network and the other core networks may be defined as an R5 reference which may include protocols for facilitating interworking between home core networks and visited core networks.

Other network may further be connected to an IEEE 802.11 based wireless local area network WLAN . The WLAN 160 may include an access router . The access router may contain gateway functionality. The access router may be in communication with a plurality of access points APs . The communication between access router and APs may be via wired Ethernet IEEE 802.3 standards or any type of wireless communication protocol. AP is in wireless communication over an air interface with WTRUs . Although the system is described with reference to 802.11 any other wireless communications system may be used. For example other wireless communications systems may be Global System for Mobile Communications GSM Wireless Local Area Network WLAN Long Term Evolution LTE Wideband Code Division Multiple Access WCDMA Universal Mobile Telecommunications System UMTS etc.

The HCDN may use a surrogate server as a tracker which may also be acting as a seed. In one example a hybrid peer to peer CDN model may be used to help reduce the load on CDNs for large scale distribution of software updates. In another example CDN distribution may be used to push content to edge servers which may be both P2P index servers and content servers. For example a P2P index server may be a tracker in peer to peer streaming protocol PPSP terminology. In particular the CDN edge nodes may be involved in the P2P protocol.

There may be two or more ways for a P2P system to interwork with a CDN. One way may include the CDN used as the content source server. In another the CDN edge servers may be enhanced to perform the functionalities of network peers.

In one example the content piece requests may directly reach the edge server which may be registered in IMS. In another example the content piece requests may go to a CDN controller which may be registered in IMS and may then forward the request internally to the proper surrogate. illustrate both of these examples.

Both Bittorent and eMule which may be associated with PPSP signaling may be performed by the internet engineering task force IETF PPSP WG. Using a Bittorent approach may include using a server side active component and processing a uniform resource locator URL request using a specially crafted URL. For example a server side active component may be a personal home page PHP script. An example of a URL in the Bittorent enhancement approach may be http www.example.com source1.php info hash hash piece piece ranges start end start end . . . . This Bittorent enhancement approach may place hypertext transfer protocol HTTP seeding information in the metadata file which may be a static piece of information obtained prior to joining a P2P swarm. For example a metadata file may be a torrent file.

A HTTP GET command may be suggested as a Peer CDN HTTP message. The HTTP GET command may be used in relation to the Bittorent enhancement approach in the context of a static seeding using an HTTP server.

An extension of HTTP may be used to transform the client server protocol into a P2P protocol where the clients may serve content when accessing a crowded web server and benefit from a tit for tat policy since a crowded web server may throttle first non participating clients. For example the client may be a browser. While HTTP P2P may propose an interesting application of P2P to solve a flash crowd problem HTTP may not be integrated within a full blown P2P protocol. Within the context of a CDN HTTP P2P may be implemented by surrogate servers which may also occur by using the hybrid CDN model.

The peer to peer streaming protocol PPSP IETF Working Group WG may define a peer to peer protocol and a peer to tracker protocol. In addition DECADE may be integrated with PPSP. Also within the PPSP WG RELOAD e.g. itself developed by P2PSIP WG may have been proposed implementing a distributed tracker. For example a client may use RELOAD to locate a tracker within the RELOAD tracker overlay and then may connect to the tracker using the PPSP tracker protocol.

While PPSP may be designed to build a P2P network using a centralized tracker and distributing streaming content P2P session initiation protocol P2PSIP may be designed to build a P2P overlay network. Combinations of CDNs and P2P protocols may be classified in two categories tight integration and static loose integration.

In tight integration the CDN edge servers may use a P2P protocol. The CDN mechanisms may be used to push content at the edge where a P2P protocol may be used to distribute the content. The hybrid CDN is an example of this type of combination.

In static loose integration the content may be pushed on a CDN or the content may instead be stored on a single web server without using a CDN. A P2P swarm may then be started containing information about the location of the pieces as HTTP uniform resource identifiers URIs . The Bittorent approach may be an example.

In CDN and P2P integration either loose or tight the CDN edge servers may obtain the contents through a content acquisition and ingestion procedure from an external source. The CDN edge servers may act as the content sources for the P2P network. The CDN edge servers may not obtain content from peers in the P2P network.

A more dynamic loose integration may be disclosed. This more dynamic loose integration may allow nodes in the P2P network to dynamically advertise content pieces available in the CDN directly upload content pieces to the CDN redirect a peer to get content from the CDN and use the CDN for more efficient content distribution may occur. The content pieces in a dynamic loose integration may be dynamically added to and removed from the CDN which may not have been done in static loose integration. This may efficiently adapt CDN usage to help content delivery in the P2P network when it is most needed. Any currently deployed CDN may be interworked with any P2P protocol which may not have been done in tight integration.

A new P2P node using a CDN backend for storage may be introduced. The P2P node may be called a Network Storage Control Peer NSCP . A NSCP may use P2P protocols to join and participate in the swarm. For example P2P protocols may be peer to tracker and peer to peer in PPSP. In one example PPSP may be chosen as an example of P2P protocol. Other P2P protocols may also be used.

The NSCP advertised content pieces may be stored in the CDN using the peer to tracker or the peer to peer protocol. Depending on the solution selected other peers may learn the URIs of the pieces on the CDN directly through the tracker or through a redirection from the NSCP.

WTRU 1 joins a swarm receives a peer list from tracker and finds chunks . The peer list may include a CDN chunk list. WTRU 2 joins a swarm receives a peer list from tracker and finds chunks . The peer list may include a CDN chunk list. WTRU 1 transmits a GET message to WTRU 2 . In response to the GET message WTRU 2 transmits a chunk to WTRU 1 . WTRU 2 transmits a GET message to CDN . In response to the GET message CDN transmits an HTTP GET chunk to WTRU 2 . The NSCP may interface with more than one CDN. CDN ingests content from ingestion gateway . The tracker may communicate using peer to tracker protocol. WTRU 1 may communicate with WTRU 2 using peer to peer protocol.

The NSCP may be used to initially seed a swarm or it may be used to boost an existing swarm. The tracker may provide the NSCP with a list of swarms to join and additional swarm information using the tracker protocol or another protocol such as a web service or SIP. An example of additional swarm information may include the content source location URIs and whether the NSCP may be the primary seed of the swarm. The NSCP may use the peer to tracker protocol to join a swarm.

The tracker may implement an optional access control for NSCP to prevent issues such as peers using third party resources in an unauthorized fashion. For example the NSCP may be provisioned with a peer ID and a certificate including a property granting NSCP status. Upon receipt of the certificate from the NSCP the tracker may accept the NSCP. Other authorization methods may be used instead including NSCP peer ID provisioning in the tracker.

On a regular basis or on demand the tracker may provide swarm statistics to the NSCP. For example swarm statistics may be peer population level or how many pieces are popular unpopular not present. The NSCP may use this information to decide to upload rare pieces to the CDN or delete popular pieces from the CDN. Other algorithms may be used to decide which piece to upload or delete.

In an example the NSCP may use a CDN based storage backend accessible by peers using HTTP. However another network storage technology may also be used. IETF protocols DECADE and WebDAV may also be used. The NSCP may be implemented with a non CDN backend. For example the NSCP may use a third party DECADE or WebDAV account to externalize the storage and may eliminate the burden and risk of maintaining large storage nodes. In another example the NSCP may use a cloud storage service or virtualization service using a web service interface to upload and delete the pieces. For example the web service interface may be SOAP or REST interface. The pieces may be retrieved by peers using for example HTTP GET or simple object access protocol SOAP requests.

The NSCP may also use its own storage as a normal peer. In this hybrid example the NSCP may interact with the system as a normal peer for all content it stores locally and as an NSCP for content stored in a CDN. For example this hybrid example may be used to supplement a regular P2P seed with additional flexible storage capacity provided by a CDN or other remote storage backend.

Whenever the NSCP may need to put or delete a piece from a CDN the NSCP may use the CDN ingestion interface either directly or through a gateway. Using a gateway may be useful to adapt to changing CDNs since CDNs may provide their own proprietary ingestion interfaces. Using the gateway may also be useful to adapt to multiple CDNs used in parallel. Alternatively the NSCP or gateway may use a standard compliant protocol to interface with the CDN. Such a protocol may be provided by the CDN interconnection CDNI IETF working group. In particular the CDNI metadata application programming interface API and the acquisition API may be used together to implement an interface in a standard compliant fashion without requiring additional features from a CDNI compliant CDN. A gateway may be useful to insulate the NSCP from the identity and multiplicity of CDNs used. The protocol between NSCP and the CDN ingestion gateway may be a new standard interface such as an HTTP based RESTful interface or may be based on the CDNI metadata and acquisition APIs.

As part of the initial signaling process with the tracker the NSCP may advertise itself as an HTTP based NSCP. For example the initial signaling process with the tracker may be in the PPSP peer to tracker CONNECT message. The NSCP may also advertise to the tracker which content pieces are stored in the CDN and the URIs where they may be retrieved. For example the URIs may be retrieved in a PPSP STAT REPORT message to the tracker.

When other peers in the swarm query the tracker for a peer list the tracker response may include CDN URIs along with a list of regular peers. The peers may not retrieve a content bitmap from the NSCP. For example a content bit map may be a bitmap indicating which piece is held by a peer. The peers may retrieve CDN URIs only from the tracker. Whether a piece is retrieved in priority from a CDN or from a regular peer is a policy decision which may be taken in the client in the tracker or both. For example if the policy decision is taken in the tracker this may be done by the tracker selectively providing CDN URIs.

Peer authentication or authorization information may be added in various messages. For example peer authentication or authorization may result in peers using an HTTP authentication method to retrieve a content piece using a token obtained from the tracker. The token may have been originally provided to the tracker by NSCP.

Tracker transmits SWARM STATS to NSCP using PPSP or another protocol . Peer 1 transmits a PPSP CONNECT message to tracker . Peer 1 transmits a PPSP JOIN message to tracker . The NSCP may decide to join swarm S for example and may obtain external source URIs directly or indirectly from the tracker information. Peer 2 transmits a PPSP CONNECT message to tracker . Peer 2 transmits a PPSP JOIN message to tracker . NSCP transmits a PPSP CONNECT message to tracker . Tracker identifies a peer as NSCP from the received CONNECT message . NSCP transmits a PPSP JOIN message to tracker . Tracker transmits a PPSP STAT REPORT message to NSCP including swarm stats from tracker .

NSCP decides to upload piece 12 . NSCP transmits a REST UPLOAD message to ingest gateway including swarm S and piece 12 Ingest gateway transmits an HTTP GET piece 12 message to external source . Ingest gateway transmits a REST UPLOAD piece 12 message to CDN . Ingest gateway transmits a REST UPLOAD response to NSCP including a CDN URI . NSCP transmits a PPSP STAT REPORT to tracker including URI for piece 12 . Peer 2 transmits a PPSP FIND piece 12 message to tracker . Tracker transmits a PPSP FIND response to peer 2 including CDN URI . Peer 2 selects CDN URI among possible sources .

Peer 2 transmits an HTTP GET piece 12 URI to CDN . Peer 2 transmits a PPSP STAT REPORT to tracker including piece 12 . Peer 1 transmits a PPSP FIND piece 12 message to tracker . Tracker transmits PPSP FIND response to peer 1 including CDN URI and peer 2 . Peer 1 selects peer 2 among possible sources . Peer 1 transmits a PPSP Fetch piece 12 message to peer 2 using peer to tracker protocol . Peer 1 transmits a PPSP STAT REPORT to tracker including piece 12 .

Tracker transmits a PPSP STAT REPORT to NSCP including swarm stats from tracker . NSCP deletes piece 12 . NSCP transmits a REST DELETE message to ingest gateway including swarm S and piece 12 . Ingest gateway transmits a REST DELETE piece 12 message to CDN . NSCP transmits a PPSP STAT REPORT to tracker including URI for piece 12 .

WTRU 1 joins a swarm receives a peer list from tracker and finds chunks . Peers in the peer list may be associated with Network Storage Type. WTRU 2 joins a swarm receives a peer list from tracker and finds chunks . Peers in the peer list may be associated with Network Storage Type. NSCP transmits a reference to CDN chunk to WTRU 2 .

WTRU 2 transmits a GET message to CDN . In response to the GET message CDN transmits an HTTP GET chunk to WTRU 2 . WTRU 1 transmits a GET message to WTRU 2 . In response to the GET message WTRU 2 transmits chunk to WTRU 1 . The NSCP may interface with more than one CDN . CDN ingests content from ingestion gateway . The tracker may communicate using peer to tracker protocol. WTRU 1 and NSCP may communicate with WTRU 2 using peer to peer protocol.

As part of the joining process the NSCP may advertise itself as an HTTP based NSCP. For example the joining process may be in the PPSP peer to tracker CONNECT message. The NSCP may not advertise to the tracker which content pieces are stored in the CDN and where the URIs may be retrieved. When the tracker includes the NSCP in a peer list the tracker may mention that the NSCP is a CDN based peer. For example the tracker may include the NSCP in a peer list in a FIND response to a peer. For example the tracker may mention that the NSCP is a CDN based peer by using a network storage type parameter and setting its value to HTTP. This information may be used by peers to influence their choice when selecting a peer.

The NSCP may contact the tracker as a regular peer. In this example the tracker may not be able to associate a Network Storage Type associated with the NSCP in the peer lists provided to other peers. This limitation may be desirable because it may naturally limit the NSCP usage to a fraction of the peers. In another example the NSCP may advertise its network storage type to the tracker and the tracker may not include this information in the peer list.

Peers may obtain a content bitmap from the NSCP directly using a peer to peer protocol. The bitmap may indicate which content pieces are available from the NSCP. When a peer uses a peer to peer message to get a given content piece from the NSCP the NSCP may reply with a redirection towards the URI of the piece stored on the CDN instead of replying with the content piece itself. The requesting peer may use HTTP to retrieve the piece from the CDN.

In an access control scheme the tracker may accept only an authenticated NSCP in the swarm and peers may accept redirections to URIs only from nodes that were advertised as NSCP by the tracker. This may eliminate the risk of a regular peer abusing a tit for tat reward system commonly implemented in P2P peers or using third party resources in an unauthorized fashion.

Tracker transmits SWARM STATS to NSCP using PPSP or another protocol . Peer 1 transmits a PPSP CONNECT message to tracker . Peer 1 transmits a PPSP JOIN message to tracker . The NSCP may decide to join swarm S for example and may obtain external source URIs directly or indirectly from the tracker information. Peer 2 transmits a PPSP CONNECT message to tracker . Peer 2 transmits a PPSP JOIN message to tracker . NSCP transmits a PPSP CONNECT message to tracker . Tracker identifies a peer as NSCP from the received CONNECT message . NSCP transmits a PPSP JOIN message to tracker . Tracker transmits a PPSP STAT REPORT message to NSCP including swarm stats from tracker .

NSCP decides to upload piece 12 . NSCP transmits a REST UPLOAD message to ingest gateway including swarm S and piece 12 Ingest gateway transmits an HTTP GET piece 12 message to external source . Ingest gateway transmits a REST UPLOAD piece 12 message to CDN . Ingest gateway transmits a REST UPLOAD response to NSCP including a CDN URI . Peer 2 transmits a PPSP FIND piece 12 message to tracker . Tracker transmits a PPSP FIND response to peer 2 including NSCP . NSCP may include an HTTP Network Storage Type.

Peer 2 transmits a PPSP get content bitmap message using peer to peer protocol to NSCP . NSCP transmits a PPSP response including piece 12 in bitmap . Peer 2 selects NSCP among possible sources . Peer 2 transmits a PPSP fetch pieces 12 message using peer to peer protocol to NSCP . NSCP transmits a PPSP response redirecting to CDN URI to peer 2 . Peer 2 transmits an HTTP GET piece 12 URI to CDN .

Mechanisms may exist to prohibit the misuse of the CDN account managed by the NSCP. For example if all peers are programmed to use NSCP in priority the P2P swarm may become centralized as the NSCP becomes known by more peers. On the other hand if peers are programmed to obtain pieces from regular peers in priority the effect of CDN seeding may be very limited. This may be similar to problems faced by P2P streaming systems to balance usage of the cache servers seeding P2P swarms. For example using P2P traffic to offload cache servers while at the same time using cache servers as needed to maintain the necessary throughput to peers.

In addition to algorithms implemented in P2P systems the NSCP may be able to upload and delete pieces to from the network storage based on the swarm information provided by the tracker. For example if a piece becomes popular its presence on the CDN may not be necessary any longer and it may be removed. In another example if the CDN seeding no longer contributes to the swarm after 1 hour an uploaded piece may be associated with a lifetime of 1 hour after which the CDN may delete it and the NSCP may remove it from its content bitmap.

The NSCP together with the gateway may aim at globally optimizing its contribution to all swarms while staying within a given budget in terms of storage space and bandwidth utilization. If the CDN account maintained by the NSCP is full the NSCP may make the decision to delete a piece of content from swarm S1 from the CDN because the NSCP may judge that a new piece will contribute more to swarm S2. In another example the NSCP may delete a piece because a swarm is overusing it in order to limit the CDN bandwidth contribution to a particular swarm. Examples of parameters the NSCP may use to ensure fairness between swarms within CDN account constraints include but are not limited to per swarm soft or hard limits on CDN bandwidth storage space and quality of experience QoE . For example QoE may be average playback buffer size number and length of buffer starvations.

In another example an update to the IMS P2P content delivery system architecture is made to integrate CDN in a dynamic fashion into the swarm. This may include a new type of Content Cache Server CCS function which may be called a CDN based Content Cache Server CDN based CCS . The CDN based CCS may comprise three sub functions which may include but are not limited to the NSCP an unmodified third party CDN and a gateway in between. Interfaces may be introduced or extended to support the new CDN based CCS. There may not be a modification for the CDN.

CDN based cache server may include NSCP CDN Ingestion Gateway and Internal or 3Party CDN . NSCP may transmit signaling with WTRU1 Tracker AS CSS and CDN Ingestion Gateway . CDN Ingestion Gateway may transmit media with both CSS and Internal or 3Party CDN . Internal or 3Party CDN may transmit media with both WTRU1 and CSS . WTRU1 may transmit media and signaling with WTRU2 . WTRU may transmit signaling with P CSCF . P CSCF may transmit signaling with I S CSCF . I S CSCF may transmit signaling with both HSS and Tracker AS . HSS may transmit signaling with Tracker AS . Tracker AS may transmit signaling with both CCS and CSS . WTRU1 may transmit both media and signaling with CCS . CCS may transmit both media and signaling with CSS .

For a Network Storage Control Peer function the tracker protocol may be extended to support the additional functionality. For example the Network Storage Control function may include a new message SWARM STATS the extension of a STAT REPORT message transmitted from tracker to peer and the extension of a FIND message to support storage type information. Interface Tc 2 may represent this extended interface in .

A CDN Ingestion Gateway may translate between a common ingestion interface Ingest and an ingestion interface provided by third party CDN operators CDNIngest . For example if the NSCP determines to upload a particular piece of content the gateway may obtain it from CSS using SC m or from the NSCP over an Ingest interface and may upload it to a third party CDN using an HTTP PUT or POST command. This may be a push over a proprietary API. In another example the NSCP may determine to upload a piece of content. The gateway may provide the content URI to the CDN which may obtain it using an HTTP GET. This may be a pull over a CDNI acquisition interface. Content pieces uploaded to the CDN may be received from a non P2P content source but may also be received from other peers through the NSCP. For example a non P2P content source may be a CSS.

The CDN may be located within the IMS operator domain or within a third party domain. The CDN may support the PP m3 interface which is typically HTTP though other protocols such as DECADE and WebDAV may be used. For example the HTTP may be a GET.

There may be three different deployment options possible. In a first deployment option the NSCP and CDN Ingestion gateway may be a single node or in two dedicated nodes. This may be similar to a regular CCS but with only a minimal amount of attached storage capacity.

In a second deployment option the NSCP with or without the CDN Ingestion gateway may be implemented within a regular CCS node. This may be useful to augment a regular CCS on demand. For example in peak hours the CCS may be able to use a CDN to complement its own storage capacity.

In a third deployment option a CDN Ingestion Gateway with or without the NSCP may be implemented within a Session Border Controller SBC node. An example of SBC may be the IMS Border Control Function composed of Interconnect Border Control Function IBCF on the signaling plane and Translation Gateway TrGW on the media plane. For example the CDN Ingestion Gateway may be located in the TrGW and the NSCP may be located in the TrGW IBCF or a distributed between both.

There may be other options to deploy NSCP including within a Media Resource Function MRF or as an application server.

Although features and elements are described above in particular combinations one of ordinary skill in the art will appreciate that each feature or element can be used alone or in any combination with the other features and elements. In addition the methods described herein may be implemented in a computer program software or firmware incorporated in a computer readable medium for execution by a computer or processor. Examples of computer readable media include electronic signals transmitted over wired or wireless connections and computer readable storage media. Examples of computer readable storage media include but are not limited to a read only memory ROM a random access memory RAM a register cache memory semiconductor memory devices magnetic media such as internal hard disks and removable disks magneto optical media and optical media such as CD ROM disks and digital versatile disks DVDs . A processor in association with software may be used to implement a radio frequency transceiver for use in a WTRU UE terminal base station RNC or any host computer.

