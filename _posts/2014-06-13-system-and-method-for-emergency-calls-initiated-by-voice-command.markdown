---

title: System and method for emergency calls initiated by voice command
abstract: A method of operating a digital assistant to provide emergency call functionality is provided. In some embodiments, the method is performed at a device including one or more processors and memory storing instructions for execution by the one or more processors. The method includes receiving a speech input from a user, determining whether the speech input expresses a user request for making an emergency call, and determining a local emergency dispatcher telephone number based on a geographic location of the device. The method also includes, in response to determining or obtaining a determination that the speech input expresses a user request for making an emergency call, calling the local emergency dispatcher telephone number using the emergency call functionality.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09300784&OS=09300784&RS=09300784
owner: Apple Inc.
number: 09300784
owner_city: Cupertino
owner_country: US
publication_date: 20140613
---
This application claims priority from U.S. Provisional Ser. No. 61 834 823 filed on Jun. 13 2013 entitled SYSTEM AND METHOD FOR EMERGENCY CALLS INITIATED BY VOICE COMMAND which is hereby incorporated by reference in its entirety for all purposes.

The disclosed embodiments relate generally to digital assistants. More specifically to a method and system for operating a digital assistant to provide emergency call functionality.

Recently voice based digital assistants such as Apple s SIRI have been introduced into the marketplace to handle various tasks such as web searching and navigation. Recent advances in natural language processing have enabled users to interact with digital assistants using natural language in spoken or textual forms rather than employing a conventional user interface e.g. menus or programmed commands . Such digital assistants can interpret the user s input to deduce the user s intent translate the deduced intent into actionable tasks and parameters execute operations or deploy services to perform the tasks and produce outputs that are intelligible to the user.

Embodiments disclosed herein provide methods devices systems and computer readable storage mediums for operating a digital assistant to provide emergency call functionality.

Some embodiments provide a method for operating a digital assistant to provide emergency call functionality. The method is performed at a device having memory and one or more processors. The method includes receiving a speech input from a user determining or obtaining a determination of whether the speech input expresses a user request for making an emergency call and determining or obtaining a determination of a local emergency dispatcher telephone number based on a geographic location of the device. The method further includes in response to determining or obtaining a determination that the speech input expresses a user request for making an emergency call calling the local emergency dispatcher telephone number using emergency call functionality.

In some embodiments determining whether the speech input expresses a user request for making an emergency call is performed at a remote server distinct from the device. In some embodiments determining a local emergency dispatcher telephone number based on a geographic location of the device is performed at a remote server distinct from the device. In some embodiments the method further includes receiving a text input from the user.

In various circumstances the method is performed while the device has an active data connection or the device does not have an active connection to a subscribed telephone service but does have access to a baseband telephone service or the device does not have an operating SIM card or the device does not have a SIM card that is compatible with any telephony service available at the device s current location.

In some embodiments the method further includes prior to determining or obtaining a determination of the local emergency dispatcher telephone number ascertaining the geographic location of the device.

In some embodiments the emergency dispatcher telephone number is one of a plurality of emergency dispatcher telephone numbers stored on the device.

In some embodiments determining or obtaining a determination of whether the speech input expresses a user request for making an emergency call comprises determining or obtaining a determination of whether the speech input unambiguously expresses a user request for making an emergency call. In these embodiments the method further includes in response to a determination that the speech input unambiguously expresses a user request for an emergency call without further user input calling the local emergency dispatcher telephone number using the emergency call functionality and in response to a determination that the speech input does not unambiguously express a user request for an emergency call prior to calling the local emergency dispatcher telephone number using the emergency call functionality providing the user with a notification and an affordance for confirming the user s request for making an emergency call.

In some embodiments determining or obtaining a determination of whether the speech input expresses a user request for making an emergency call comprises determining or obtaining a determination that the speech input is a user request for calling a first emergency number. In these embodiments determining or obtaining a determination of a local emergency dispatcher telephone number based on a geographic location of the device comprises determining or obtaining a determination of a second emergency number and when the first emergency number is distinct from the second emergency number calling the local emergency dispatcher telephone number using the emergency call functionality comprises calling the second emergency number.

In some embodiments the method further includes prior to calling the local emergency dispatcher telephone number providing a notification to the user that the device will promptly call the local emergency dispatcher telephone number and while providing the notification providing an affordance for the user to cancel the request for making an emergency call.

In some embodiments the method further includes providing a limited natural language processing module within the digital assistant wherein the limited natural language processing module differs from a primary natural language processing module used by the digital assistant during normal operation and wherein the limited natural language processing module is tailored to recognize speech inputs for invoking the emergency call functionality.

In some embodiments the method further includes determining whether the device is currently authorized to make non emergency telephone calls using a cellular service available at the current geographic location of the device and in response to determining that the device is not currently authorized to make non emergency telephone calls using a cellular service available at the current geographic location of the device invoking the limited natural language processing module to process the speech input.

Using a digital assistant in accordance with the methods described herein is more efficient and convenient than conventional user interfaces for providing emergency call functionality.

In accordance with some embodiments a device includes one or more processors memory and one or more programs where the one or more programs are stored in the memory and configured to be executed by the one or more processors. The one or more programs including instructions to receive a speech input from a user determine or obtain a determination of whether the speech input expresses a user request for making an emergency call and determine or obtain a determination of a local emergency dispatcher telephone number based on a geographic location of the device. The one or more programs further including instructions to in response to determining or obtaining a determination that the speech input expresses a user request for making an emergency call call the local emergency dispatcher telephone number. In some embodiments the device does not have an active connection to a subscribed telephone service but does have access to a baseband telephone service.

In accordance with some embodiments a system includes one or more processors memory and one or more programs where the one or more programs are stored in the memory and configured to be executed by the one or more processors. The one or more programs including instructions to at a device receive a speech input from a user. The one or more programs further including instructions to determine whether the speech input expresses a user request for making an emergency call determine a local emergency dispatcher telephone number based on a geographic location of the device and in response to determining that the speech input expresses a user request for making an emergency call call the local emergency dispatcher telephone number.

In accordance with some embodiments a computer readable storage medium e.g. a non transitory computer readable storage medium is provided the computer readable storage medium storing one or more programs for execution by one or more processors of an electronic device. The one or more programs when executed by an electronic device cause the device to receive a speech input from a user determine or obtain a determination of whether the speech input expresses a user request for making an emergency call and determine or obtain a determination of a local emergency dispatcher telephone number based on a geographic location of the device. The one or more programs further including instructions to in response to determining or obtaining a determination that the speech input expresses a user request for making an emergency call call the local emergency dispatcher telephone number.

In accordance with some embodiments an information processing apparatus for use in an electronic device is provided the information processing apparatus comprising means for performing any of the methods described herein.

In accordance with some embodiments an electronic device comprises memory and a processing unit coupled to the memory. The processing unit configured to receive a speech input from a user determine or obtain a determination of whether the speech input expresses a user request for making an emergency call and determine or obtain a determination of a local emergency dispatcher telephone number based on a geographic location of the device. The processing unit is further configured to in response to determining or obtaining a determination that the speech input expresses a user request for making an emergency call call the local emergency dispatcher telephone number.

Reference will now be made in detail to embodiments examples of which are illustrated in the accompanying drawings. In the following detailed description numerous specific details are set forth in order to provide a thorough understanding of the present invention. However it will be apparent to one of ordinary skill in the art that the present invention may be practiced without these specific details. In other instances well known methods procedures components circuits and networks have not been described in detail so as not to unnecessarily obscure aspects of the embodiments.

It will also be understood that although the terms first second etc. may be used herein to describe various elements these elements should not be limited by these terms. These terms are only used to distinguish one element from another. For example a first contact could be termed a second contact and similarly a second contact could be termed a first contact without departing from the scope of the present invention. The first contact and the second contact are both contacts but they are not the same contact.

The terminology used in the description of the invention herein is for the purpose of describing particular embodiments only and is not intended to be limiting of the invention. As used in the description of the invention and the appended claims the singular forms a an and the are intended to include the plural forms as well unless the context clearly indicates otherwise. It will also be understood that the term and or as used herein refers to and encompasses any and all possible combinations of one or more of the associated listed items. It will be further understood that the terms includes including comprises and or comprising when used in this specification specify the presence of stated features integers steps operations elements and or components but do not preclude the presence or addition of one or more other features integers steps operations elements components and or groups thereof.

As used herein the term if may be construed to mean when or upon or in response to determining or in response to detecting depending on the context. Similarly the phrase if it is determined or if a stated condition or event is detected may be construed to mean upon determining or in response to determining or upon detecting the stated condition or event or in response to detecting the stated condition or event depending on the context.

Specifically a digital assistant is capable of accepting a user request at least partially in the form of a natural language command request statement narrative and or inquiry. Typically the user request seeks either an informational answer or performance of a task by the digital assistant. A satisfactory response to the user request is either provision of the requested informational answer performance of the requested task or a combination of the two. For example a user may ask the digital assistant a question such as Where am I right now Based on the user s current location the digital assistant may answer You are in Central Park near the west gate. The user may also request the performance of a task for example Please invite my friends to my girlfriend s birthday party next week. In response the digital assistant may acknowledge the request by saying Yes right away and then send a suitable calendar invite on behalf of the user to each of the user friends listed in the user s electronic address book. During performance of a requested task the digital assistant sometimes interacts with the user in a continuous dialogue involving multiple exchanges of information over an extended period of time. There are numerous other ways of interacting with a digital assistant to request information or performance of various tasks. In addition to providing verbal responses and taking programmed actions the digital assistant also provides responses in other visual or audio forms e.g. as text alerts music videos animations etc.

An example of a digital assistant is described in Applicant s U.S. Utility application Ser. No. 12 987 982 for Intelligent Automated Assistant filed Jan. 10 2011 the entire disclosure of which is incorporated herein by reference.

As shown in in some embodiments a digital assistant is implemented according to a client server model. The digital assistant includes a client side portion hereafter DA client executed on a user device and a server side portion hereafter DA server executed on a server system . The DA client communicates with the DA server through one or more networks . The DA client provides client side functionalities such as user facing input and output processing and communications with the DA server . The DA server provides server side functionalities for any number of DA clients each residing on a respective user device .

In some embodiments the DA server includes a client facing I O interface one or more processing modules data and models and an I O interface to external services . The client facing I O interface facilitates the client facing input and output processing for the digital assistant server . The one or more processing modules utilize the data and models to determine the user s intent based on natural language input and perform task execution based on deduced user intent. In some embodiments the DA server communicates with external services through the network s for task completion or information acquisition. The I O interface to external services facilitates such communications.

Examples of the user device include but are not limited to a handheld computer a personal digital assistant PDA a tablet computer a laptop computer a desktop computer a cellular telephone a smart phone an enhanced general packet radio service EGPRS mobile phone a media player a navigation device a game console a television a remote control a portable multifunction device or a combination of any two or more of these data processing devices or other data processing devices. More details on the user device are provided in reference to an exemplary user device shown in .

Examples of the communication network s include local area networks LAN and wide area networks WAN e.g. the Internet. The communication network s may be implemented using any known network protocol including various wired or wireless protocols such as e.g. Ethernet Universal Serial Bus USB FIREWIRE Global System for Mobile Communications GSM Enhanced Data GSM Environment EDGE code division multiple access CDMA time division multiple access TDMA Bluetooth Wi Fi voice over Internet Protocol VoIP Wi MAX or any other suitable communication protocol.

The server system is implemented on one or more standalone data processing apparatus or a distributed network of computers. In some embodiments the server system also employs various virtual devices and or services of third party service providers e.g. third party cloud service providers to provide the underlying computing resources and or infrastructure resources of the server system .

Although the digital assistant shown in includes both a client side portion e.g. the DA client and a server side portion e.g. the DA server in some embodiments the functions of a digital assistant is implemented as a standalone application installed on a user device. In addition the divisions of functionalities between the client and server portions of the digital assistant can vary in different embodiments. For example in some embodiments the DA client is a thin client that provides only user facing input and output processing functions and delegates all other functionalities of the digital assistant to a backend server. In some embodiments a digital assistant includes a limited natural language processing module implemented on the device. In some of these embodiments the limited natural language processing module is used when the device is not authorized to make non emergency telephone calls. In some of these embodiments the limited natural language processing module is tailored to recognize speech inputs for invoking emergency call functionality.

For example a motion sensor a light sensor and a proximity sensor are coupled to the peripherals interface to facilitate orientation light and proximity sensing functions. One or more other sensors such as a positioning system e.g. GPS receiver a temperature sensor a biometric sensor a gyro a compass an accelerometer and the like are also connected to the peripherals interface to facilitate related functionalities.

In some embodiments a camera subsystem and an optical sensor are utilized to facilitate camera functions such as taking photographs and recording video clips. An audio subsystem is coupled to speakers and a microphone to facilitate voice enabled functions such as voice recognition voice replication digital recording and telephony functions.

In some embodiments communication functions are facilitated through one or more wired and or wireless communication subsystem s which can include various communication ports radio frequency receivers and transmitters and or optical e.g. infrared receivers and transmitters. In some embodiments communication subsystem s includes a baseband module for providing baseband telephony services. In some embodiments baseband telephony services comprise telephony services available to users of the device even when a user is not subscribed to and or authorized to use any available cellular telephony services.

In some embodiments an I O subsystem is also coupled to the peripheral interface . The I O subsystem includes a touch screen controller and or other input controller s . The touch screen controller is coupled to a touch screen . The touch screen and the touch screen controller can for example detect contact and movement or break thereof using any of a plurality of touch sensitivity technologies such as capacitive resistive infrared surface acoustic wave technologies proximity sensor arrays and the like. The other input controller s can be coupled to other input control devices such as one or more buttons rocker switches thumb wheel infrared port USB port and or a pointer device such as a stylus.

In some embodiments the memory interface is coupled to memory . The memory can include high speed random access memory and or non volatile memory such as one or more magnetic disk storage devices one or more optical storage devices and or flash memory e.g. NAND NOR .

In some embodiments the memory stores an operating system a communication module a user interface module a sensor processing module a phone module and applications . The operating system includes instructions for handling basic system services and for performing hardware dependent tasks. The communication module facilitates communicating with one or more additional devices one or more computers and or one or more servers. The user interface module facilitates graphic user interface processing and output processing using other output channels e.g. speakers . The sensor processing module facilitates sensor related processing and functions. The phone module facilitates phone related processes and functions. The application module facilitates various functionalities of user applications such as electronic messaging web browsing media processing Navigation imaging and or other processes and functions. In some embodiments the memory also stores an emergency call module . The emergency call module provides data related to emergency calls e.g. emergency dispatcher telephone numbers emergency baseband connection protocols etc. .

As described in this specification the memory also stores client side digital assistant instructions e.g. in a digital assistant client module and various user data e.g. user specific vocabulary data preference data and or other data such as the user s electronic address book to do lists shopping lists etc. to provide the client side functionalities of the digital assistant. In some embodiments the memory also includes a limited language module to provide limited digital assistant functionality e.g. tailored to emergency call functionalities at the device .

In various embodiments the digital assistant client module is capable of accepting voice input e.g. speech input text input touch input and or gestural input through various user interfaces e.g. the I O subsystem of the user device . The digital assistant client module is also capable of providing output in audio e.g. speech output visual and or tactile forms. For example output can be provided as voice sound alerts text messages menus graphics videos animations vibrations and or combinations of two or more of the above. During operation the digital assistant client module communicates with the digital assistant server using the communication subsystems .

In some embodiments the digital assistant client module utilizes the various sensors subsystems and peripheral devices to gather additional information from the surrounding environment of the user device to establish a context associated with a user the current user interaction and or the current user input. In some embodiments the digital assistant client module provides the context information or a subset thereof with the user input to the digital assistant server to help deduce the user s intent. In some embodiments the digital assistant also uses the context information to determine how to prepare and deliver outputs to the user.

In some embodiments the context information that accompanies the user input includes sensor information e.g. lighting ambient noise ambient temperature images or videos of the surrounding environment etc. In some embodiments the context information also includes the physical state of the device e.g. device orientation device location device temperature power level speed acceleration motion patterns cellular signals strength etc. In some embodiments information related to the software state of the user device e.g. running processes installed programs past and present network activities background services error logs resources usage etc. of the user device are provided to the digital assistant server as context information associated with a user input.

In some embodiments the DA client module selectively provides information e.g. user data stored on the user device in response to requests from the digital assistant server. In some embodiments the digital assistant client module also elicits additional input from the user via a natural language dialogue or other user interfaces upon request by the digital assistant server . The digital assistant client module passes the additional input to the digital assistant server to help the digital assistant server in intent deduction and or fulfillment of the user s intent expressed in the user request.

In various embodiments the memory includes additional instructions or fewer instructions. Furthermore various functions of the user device may be implemented in hardware and or in firmware including in one or more signal processing and or application specific integrated circuits.

The digital assistant system includes memory one or more processors an input output I O interface and a network communications interface . These components communicate with one another over one or more communication buses or signal lines .

In some embodiments the memory includes a non transitory computer readable medium such as high speed random access memory and or a non volatile computer readable storage medium e.g. one or more magnetic disk storage devices flash memory devices or other non volatile solid state memory devices .

In some embodiments the I O interface couples input output devices of the digital assistant system such as displays a keyboards touch screens and microphones to the user interface module . The I O interface in conjunction with the user interface module receive user inputs e.g. voice input keyboard inputs touch inputs etc. and process them accordingly. In some embodiments e.g. when the digital assistant is implemented on a standalone user device the digital assistant system includes any of the components and I O and communication interfaces described with respect to the user device in . In some embodiments the digital assistant system represents the server portion of a digital assistant implementation and interacts with the user through a client side portion residing on a user device e.g. the user device shown in .

In some embodiments the network communications interface includes wired communication port s and or wireless transmission and reception circuitry . The wired communication port s receive and send communication signals via one or more wired interfaces e.g. Ethernet Universal Serial Bus USB FIREWIRE etc. The wireless circuitry receives and sends RF signals and or optical signals from to communications networks and other communications devices. The wireless communications may use any of a plurality of communications standards protocols and technologies such as GSM EDGE CDMA TDMA Bluetooth Wi Fi VoIP Wi MAX or any other suitable communication protocol. The network communications interface enables communication between the digital assistant system with networks such as the Internet an intranet and or a wireless network such as a cellular telephone network a wireless local area network LAN and or a metropolitan area network MAN and other devices.

In some embodiments memory or the computer readable storage media of memory stores programs modules instructions and data structures including all or a subset of an operating system a communications module a user interface module one or more applications and a digital assistant module . The one or more processors execute these programs modules and instructions and reads writes from to the data structures.

The operating system e.g. Darwin RTXC LINUX UNIX OS X WINDOWS or an embedded operating system such as VxWorks includes various software components and or drivers for controlling and managing general system tasks e.g. memory management storage device control power management etc. and facilitates communications between various hardware firmware and software components.

The communications module facilitates communications between the digital assistant system with other devices over the network communications interface . For example the communication module may communicate with the communication interface of the device shown in . The communications module also includes various components for handling data received by the wireless circuitry and or wired communications port .

The user interface module receives commands and or inputs from a user via the I O interface e.g. from a keyboard touch screen pointing device controller and or microphone and generates user interface objects on a display. The user interface module also prepares and delivers outputs e.g. speech sound animation text icons vibrations haptic feedback and light etc. to the user via the I O interface e.g. through displays audio channels speakers and touch pads etc. .

The applications include programs and or modules that are configured to be executed by the one or more processors . For example if the digital assistant system is implemented on a standalone user device the applications may include user applications such as games a calendar application a navigation application or an email application. If the digital assistant system is implemented on a server farm the applications may include resource management applications diagnostic applications or scheduling applications for example.

The memory also stores the digital assistant module or the server portion of a digital assistant . In some embodiments the digital assistant module includes the following sub modules or a subset or superset thereof an input output processing module a speech to text STT processing module a natural language processing module a dialogue flow processing module a task flow processing module a service processing module and an interruption handling module . Each of these modules has access to one or more of the following data and models of the digital assistant or a subset or superset thereof ontology vocabulary index user data task flow models service models and priority parameters database . In some embodiments the memory also stores a limited language processing module . In some embodiments the limited language processing module has access to a subset of ontology vocabulary index user data task flow models service models and priority parameters database . In some embodiments the limited language processing module is tailored to recognize speech inputs for invoking the emergency call functionality e.g. include a limited vocabulary index primarily containing vocabulary related to emergency situations .

In some embodiments the limited language processing module is utilized by digital assistant system when the natural language processing module or a part thereof is unavailable e.g. due to the lack of an active data connection and or inoperable.

In some embodiments using the processing modules data and models implemented in the digital assistant module the digital assistant performs at least some of the following identifying a user s intent expressed in a natural language input received from the user actively eliciting and obtaining information needed to fully deduce the user s intent e.g. by disambiguating words names intentions etc. determining the task flow for fulfilling the deduced intent and executing the task flow to fulfill the deduced intent.

In some embodiments as shown in the I O processing module interacts with the user through the I O devices in or with a user device e.g. a user device in through the network communications interface in to obtain user input e.g. a speech input and to provide responses e.g. as speech outputs to the user input. The I O processing module optionally obtains context information associated with the user input from the user device along with or shortly after the receipt of the user input. The context information includes user specific data vocabulary and or preferences relevant to the user input. In some embodiments the context information also includes software and hardware states of the device e.g. the user device in at the time the user request is received and or information related to the surrounding environment of the user at the time that the user request was received. In some embodiments the I O processing module also sends follow up questions to and receives answers from the user regarding the user request. When a user request is received by the I O processing module and the user request contains a speech input the I O processing module forwards the speech input to the speech to text STT processing module for speech to text conversions.

The speech to text processing module receives speech input e.g. a user utterance captured in a voice recording through the I O processing module . In some embodiments the speech to text processing module uses various acoustic and language models to recognize the speech input as a sequence of phonemes and ultimately a sequence of words or tokens written in one or more languages. The speech to text processing module can be implemented using any suitable speech recognition techniques acoustic models and language models such as Hidden Markov Models Dynamic Time Warping DTW based speech recognition and other statistical and or analytical techniques. In some embodiments the speech to text processing can be performed at least partially by a third party service or on the user s device. Once the speech to text processing module obtains the result of the speech to text processing e.g. a sequence of words or tokens it passes the result to the natural language processing module for intent deduction.

More details on the speech to text processing are described in U.S. Utility application Ser. No. 13 236 942 for Consolidating Speech Recognition Results filed on Sep. 20 2011 the entire disclosure of which is incorporated herein by reference.

The natural language processing module natural language processor of the digital assistant takes the sequence of words or tokens token sequence generated by the speech to text processing module and attempts to associate the token sequence with one or more actionable intents recognized by the digital assistant. An actionable intent represents a task that can be performed by the digital assistant and has an associated task flow implemented in the task flow models . The associated task flow is a series of programmed actions and steps that the digital assistant takes in order to perform the task. The scope of a digital assistant s capabilities is dependent on the number and variety of task flows that have been implemented and stored in the task flow models or in other words on the number and variety of actionable intents that the digital assistant recognizes. The effectiveness of the digital assistant however is also dependent on the assistant s ability to deduce the correct actionable intent s from the user request expressed in natural language.

In some embodiments in addition to the sequence of words or tokens obtained from the speech to text processing module the natural language processor also receives context information associated with the user request e.g. from the I O processing module . The natural language processor optionally uses the context information to clarify supplement and or further define the information contained in the token sequence received from the speech to text processing module . The context information includes for example user preferences hardware and or software states of the user device sensor information collected before during or shortly after the user request prior interactions e.g. dialogue between the digital assistant and the user and the like. As described in this specification context information is dynamic and can change with time location content of the dialogue and other factors.

In some embodiments the natural language processing is based on ontology . The ontology is a hierarchical structure containing many nodes each node representing either an actionable intent or a property relevant to one or more of the actionable intents or other properties . As noted above an actionable intent represents a task that the digital assistant is capable of performing i.e. it is actionable or can be acted on. A property represents a parameter associated with an actionable intent or a sub aspect of another property. A linkage between an actionable intent node and a property node in the ontology defines how a parameter represented by the property node pertains to the task represented by the actionable intent node.

In some embodiments the ontology is made up of actionable intent nodes and property nodes. Within the ontology each actionable intent node is linked to one or more property nodes either directly or through one or more intermediate property nodes. Similarly each property node is linked to one or more actionable intent nodes either directly or through one or more intermediate property nodes. For example as shown in the ontology may include a restaurant reservation node i.e. an actionable intent node . Property nodes restaurant date time for the reservation and party size are each directly linked to the actionable intent node i.e. the restaurant reservation node . In addition property nodes cuisine price range phone number and location are sub nodes of the property node restaurant and are each linked to the restaurant reservation node i.e. the actionable intent node through the intermediate property node restaurant. For another example as shown in the ontology may also include a set reminder node i.e. another actionable intent node . Property nodes date time for the setting the reminder and subject for the reminder are each linked to the set reminder node. Since the property date time is relevant to both the task of making a restaurant reservation and the task of setting a reminder the property node date time is linked to both the restaurant reservation node and the set reminder node in the ontology .

An actionable intent node along with its linked concept nodes may be described as a domain. In the present discussion each domain is associated with a respective actionable intent and refers to the group of nodes and the relationships between the nodes associated with the particular actionable intent. For example the ontology shown in includes an example of a restaurant reservation domain and an example of a reminder domain within the ontology . The restaurant reservation domain includes the actionable intent node restaurant reservation property nodes restaurant date time and party size and sub property nodes cuisine price range phone number and location. The reminder domain includes the actionable intent node set reminder and property nodes subject and date time. In some embodiments the ontology is made up of many domains. Each domain may share one or more property nodes with one or more other domains. For example the date time property node may be associated with many different domains e.g. a scheduling domain a travel reservation domain a movie ticket domain etc. in addition to the restaurant reservation domain and the reminder domain .

While illustrates two example domains within the ontology other domains or actionable intents include for example initiate a phone call find directions schedule a meeting send a message and provide an answer to a question read a list providing navigation instructions provide instructions for a task and so on. A send a message domain is associated with a send a message actionable intent node and may further include property nodes such as recipient s message type and message body. The property node recipient may be further defined for example by the sub property nodes such as recipient name and message address. 

In some embodiments the ontology includes all the domains and hence actionable intents that the digital assistant is capable of understanding and acting upon. In some embodiments the ontology may be modified such as by adding or removing entire domains or nodes or by modifying relationships between the nodes within the ontology .

In some embodiments nodes associated with multiple related actionable intents may be clustered under a super domain in the ontology . For example a travel super domain may include a cluster of property nodes and actionable intent nodes related to travels. The actionable intent nodes related to travels may include airline reservation hotel reservation car rental get directions find points of interest and so on. The actionable intent nodes under the same super domain e.g. the travels super domain may have many property nodes in common. For example the actionable intent nodes for airline reservation hotel reservation car rental get directions find points of interest may share one or more of the property nodes start location destination departure date time arrival date time and party size. 

In some embodiments each node in the ontology is associated with a set of words and or phrases that are relevant to the property or actionable intent represented by the node. The respective set of words and or phrases associated with each node is the so called vocabulary associated with the node. The respective set of words and or phrases associated with each node can be stored in the vocabulary index in association with the property or actionable intent represented by the node. For example returning to the vocabulary associated with the node for the property of restaurant may include words such as food drinks cuisine hungry eat pizza fast food meal and so on. For another example the vocabulary associated with the node for the actionable intent of initiate a phone call may include words and phrases such as call phone dial ring call this number make a call to and so on. The vocabulary index optionally includes words and phrases in different languages.

The natural language processor receives the token sequence e.g. a text string from the speech to text processing module and determines what nodes are implicated by the words in the token sequence. In some embodiments if a word or phrase in the token sequence is found to be associated with one or more nodes in the ontology via the vocabulary index the word or phrase will trigger or activate those nodes. Based on the quantity and or relative importance of the activated nodes the natural language processor will select one of the actionable intents as the task that the user intended the digital assistant to perform. In some embodiments the domain that has the most triggered nodes is selected. In some embodiments the domain having the highest confidence value e.g. based on the relative importance of its various triggered nodes is selected. In some embodiments the domain is selected based on a combination of the number and the importance of the triggered nodes. In some embodiments additional factors are considered in selecting the node as well such as whether the digital assistant has previously correctly interpreted a similar request from a user.

In some embodiments the digital assistant also stores names of specific entities in the vocabulary index so that when one of these names is detected in the user request the natural language processor will be able to recognize that the name refers to a specific instance of a property or sub property in the ontology. In some embodiments the names of specific entities are names of businesses restaurants people movies and the like. In some embodiments the digital assistant searches and identifies specific entity names from other data sources such as the user s address book a movies database a musicians database and or a restaurant database. In some embodiments when the natural language processor identifies that a word in the token sequence is a name of a specific entity such as a name in the user s address book that word is given additional significance in selecting the actionable intent within the ontology for the user request.

For example when the words Mr. Santo are recognized from the user request and the last name Santo is found in the vocabulary index as one of the contacts in the user s contact list then it is likely that the user request corresponds to a send a message or initiate a phone call domain. For another example when the words ABC Caf are found in the user request and the term ABC Cafe is found in the vocabulary index as the name of a particular restaurant in the user s city then it is likely that the user request corresponds to a restaurant reservation domain.

User data includes user specific information such as user specific vocabulary user preferences user address user s default and secondary languages user s contact list and other short term or long term information for each user. In some embodiments the natural language processor uses the user specific information to supplement the information contained in the user input to further define the user intent. For example for a user request invite my friends to my birthday party the natural language processor is able to access user data to determine who the friends are and when and where the birthday party would be held rather than requiring the user to provide such information explicitly in his her request.

Other details of searching an ontology based on a token string is described in U.S. Utility application Ser. No. 12 341 743 for Method and Apparatus for Searching Using An Active Ontology filed Dec. 22 2008 the entire disclosure of which is incorporated herein by reference.

In some embodiments once the natural language processor identifies an actionable intent or domain based on the user request the natural language processor generates a structured query to represent the identified actionable intent. In some embodiments the structured query includes parameters for one or more nodes within the domain for the actionable intent and at least some of the parameters are populated with the specific information and requirements specified in the user request. For example the user may say Make me a dinner reservation at a sushi place at 7. In this case the natural language processor may be able to correctly identify the actionable intent to be restaurant reservation based on the user input. According to the ontology a structured query for a restaurant reservation domain may include parameters such as Cuisine Time Date Party Size and the like. In some embodiments based on the information contained in the user s utterance the natural language processor generates a partial structured query for the restaurant reservation domain where the partial structured query includes the parameters Cuisine Sushi and Time 7 pm . However in this example the user s utterance contains insufficient information to complete the structured query associated with the domain. Therefore other necessary parameters such as Party Size and Date are not specified in the structured query based on the information currently available. In some embodiments the natural language processor populates some parameters of the structured query with received context information. For example in some embodiments if the user requested a sushi restaurant near me the natural language processor populates a location parameter in the structured query with GPS coordinates from the user device .

In some embodiments the natural language processor passes the structured query including any completed parameters to the task flow processing module task flow processor . The task flow processor is configured to receive the structured query from the natural language processor complete the structured query if necessary and perform the actions required to complete the user s ultimate request. In some embodiments the various procedures necessary to complete these tasks are provided in task flow models . In some embodiments the task flow models include procedures for obtaining additional information from the user and task flows for performing actions associated with the actionable intent.

As described above in order to complete a structured query the task flow processor may need to initiate additional dialogue with the user in order to obtain additional information and or disambiguate potentially ambiguous utterances. When such interactions are necessary the task flow processor invokes the dialogue processing module dialogue processor to engage in a dialogue with the user. In some embodiments the dialogue processor determines how and or when to ask the user for the additional information and receives and processes the user responses. The questions are provided to and answers are received from the users through the I O processing module . In some embodiments the dialogue processor presents dialogue output to the user via audio and or visual output and receives input from the user via spoken or physical e.g. clicking responses. Continuing with the example above when the task flow processor invokes the dialogue flow processor to determine the party size and date information for the structured query associated with the domain restaurant reservation the dialogue flow processor generates questions such as For how many people and On which day to pass to the user. Once answers are received from the user the dialogue flow processor can then populate the structured query with the missing information or pass the information to the task flow processor to complete the missing information from the structured query.

In some cases the task flow processor may receive a structured query that has one or more ambiguous properties. For example a structured query for the send a message domain may indicate that the intended recipient is Bob and the user may have multiple contacts named Bob. The task flow processor will request that the dialogue processor disambiguate this property of the structured query. In turn the dialogue processor may ask the user Which Bob and display or read a list of contacts named Bob from which the user may choose.

Once the task flow processor has completed the structured query for an actionable intent the task flow processor proceeds to perform the ultimate task associated with the actionable intent. Accordingly the task flow processor executes the steps and instructions in the task flow model according to the specific parameters contained in the structured query. For example the task flow model for the actionable intent of restaurant reservation may include steps and instructions for contacting a restaurant and actually requesting a reservation for a particular party size at a particular time. For example using a structured query such as restaurant reservation restaurant ABC Caf date 3 12 2012 time 7 pm party size 5 the task flow processor may perform the steps of 1 logging onto a server of the ABC Cafe or a restaurant reservation system such as OPENTABLE 2 entering the date time and party size information in a form on the website 3 submitting the form and 4 making a calendar entry for the reservation in the user s calendar.

In some embodiments the task flow processor employs the assistance of a service processing module service processor to complete a task requested in the user input or to provide an informational answer requested in the user input. For example the service processor can act on behalf of the task flow processor to make a phone call set a calendar entry invoke a map search invoke or interact with other user applications installed on the user device and invoke or interact with third party services e.g. a restaurant reservation portal a social networking website a banking portal etc. . In some embodiments the protocols and application programming interfaces API required by each service can be specified by a respective service model among the services models . The service processor accesses the appropriate service model for a service and generates requests for the service in accordance with the protocols and APIs required by the service according to the service model.

For example if a restaurant has enabled an online reservation service the restaurant can submit a service model specifying the necessary parameters for making a reservation and the APIs for communicating the values of the necessary parameter to the online reservation service. When requested by the task flow processor the service processor can establish a network connection with the online reservation service using the web address stored in the service model and send the necessary parameters of the reservation e.g. time date party size to the online reservation interface in a format according to the API of the online reservation service.

In some embodiments the natural language processor dialogue processor and task flow processor are used collectively and iteratively to deduce and define the user s intent obtain information to further clarify and refine the user intent and finally generate a response i.e. an output to the user or the completion of a task to fulfill the user s intent.

In some embodiments after all of the tasks needed to fulfill the user s request have been performed the digital assistant formulates a confirmation response and sends the response back to the user through the I O processing module . If the user request seeks an informational answer the confirmation response presents the requested information to the user. In some embodiments the digital assistant also requests the user to indicate whether the user is satisfied with the response produced by the digital assistant .

More details on the digital assistant can be found in the U.S. Utility application Ser. No. 12 987 982 entitled Intelligent Automated Assistant filed Jan. 18 2010 U.S. Utility Application No. 61 493 201 entitled Generating and Processing Data Items That Represent Tasks to Perform filed Jun. 3 2011 the entire disclosures of which are incorporated herein by reference.

Attention is now directed to showing portable multifunction device e.g. user device having touch screen in accordance with some embodiments. In some embodiments the touch screen displays one or more graphics within a user interface UI . In these embodiments as well as others described below a user selects one or more of the graphics by making contact or touching the graphics for example with one or more fingers not drawn to scale in the figure or one or more styluses not drawn to scale in the figure . In some embodiments selection of one or more graphics occurs when the user breaks contact with the one or more graphics. In some embodiments the contact includes a gesture such as one or more taps one or more swipes from left to right right to left upward and or downward and or a rolling of a finger from right to left left to right upward and or downward that has made contact with device . In some embodiments inadvertent contact with a graphic will not select the graphic. For example a swipe gesture that sweeps over an application icon will not select the corresponding application when the gesture corresponding to selection is a tap.

In some embodiments device also includes one or more physical buttons such as menu e.g. Home button . Menu button is used to navigate to any application in a set of applications that may be executed on device . Alternatively in some embodiments the menu button is implemented as a soft key in a GUI displayed on touch screen .

In some embodiments device includes touch screen menu button push button for powering the device on off and locking the device volume adjustment button s Subscriber Identity Module SIM card slot head set jack and docking charging external port . Push button may be used to turn the power on off on the device by depressing the button and holding the button in the depressed state for a predefined time interval to lock the device by depressing the button and releasing the button before the predefined time interval has elapsed and or to unlock the device or initiate an unlock process. In an alternative embodiment device also may accept verbal input for activation or deactivation of some functions through microphone .

In some embodiments or circumstances a server e.g. server system determines whether the speech input expresses a user request for making an emergency call. In these embodiments the device obtains the determination from the server. However in some embodiments or circumstances the device determines whether the speech input expresses a user request for making or alternatively expresses a user intent to make an emergency call. Examples of speech input that expresses a request or an intent to make an emergency call include call 911 and call the police as well as various expressions we need the police right away of a user s intent to make an emergency call even if the speech input does not include an explicit request or command to make such a call.

In some embodiments or circumstances the server determines whether the speech input unambiguously expresses a user request for making an emergency call. In these embodiments or circumstances the device obtains the determination from the server. In some embodiments or circumstances the device determines whether the speech input unambiguously expresses a user request for making an emergency call.

In some embodiments the server determines a local emergency dispatcher telephone number based on a geographic location of the device. In these embodiments the device obtains the determination from the server. In some embodiments the device determines a local emergency dispatcher telephone number based on a geographic location of the device.

In some embodiments in response to determining that the speech input expresses a user request for making an emergency call the device calls the local emergency dispatcher telephone number using the emergency call functionality e.g. emergency call module in .

In some embodiments the device provides a limited natural language processing module within the digital assistant e.g. limited language module . The limited natural language processing module differs from a primary natural language processing module used by the digital assistant during normal operation and in particular the limited natural language processing module is tailored to recognize speech inputs for invoking the emergency call functionality.

In some embodiments or circumstances the device has an active data connection e.g. a 2G 3G 4G 4G LTE and or Wi Fi connection . For example device has an active data connection as denoted by data service connection indicator and or Wi Fi connection and signal strength indicator in . In some embodiments or circumstances the device does not have an active connection to a subscribed telephone service but does have access to a baseband telephone service. For example in accordance with these embodiments in baseband telephony service indicator on device indicates that device has access to a baseband telephone service.

In some embodiments or circumstances the device does not have an operating SIM card e.g. does not have an operating SIM card in SIM Card Slot in . For example in some implementations the device calls the local emergency dispatcher telephone number using a baseband telephone service when e.g. in accordance with a determination that the device does not have an operating SIM card. In some embodiments or circumstances the device does not have a SIM card that is compatible with any telephony service available at the device s current location. For example in some implementations the device calls the local emergency dispatcher telephone number using a baseband telephone service when e.g. in accordance with a determination that the device does not have a SIM card that is compatible with any telephony service available at the device s current location.

In some embodiments the device determines whether the device is currently authorized to make non emergency telephone calls using a cellular service available at the current geographic location of the device. In response to determining that the device is not currently authorized to make non emergency telephone calls using a telephony service e.g. a cellular service available at the current geographic location of the device and determining that the user input comprises speech input the device invokes the limited natural language processing module to process the speech input.

The device determines or obtains a determination of whether the user input e.g. speech input expresses a user request for making an emergency call. For example in some embodiments determining of whether the user input expresses a user request for making an emergency call includes obtaining from a remote server via an active data connection a determination of whether the user input expresses a user request for making an emergency call. In some embodiments or circumstances the device locally determines whether the user input expresses a user request for making an emergency call.

In some embodiments prior to determining or obtaining a determination of a local emergency dispatcher telephone number the device ascertains the geographic location of the device. For example in some embodiments or circumstances the device ascertains the geographic location of the device via a GPS sensor e.g. a sensor . In some embodiments or circumstances the device ascertains the geographic location of the device based on the location of the nearest telephony service tower. In some embodiments or circumstances the device ascertains the geographic location of the device based on the location of a Wi Fi service provider.

The device determines or obtains a determination of the local emergency dispatcher telephone number based on the geographic location of the device. For example in some embodiments the device utilizes an emergency number look up table stored on a remote server. In some embodiments the emergency dispatcher telephone number is one of a plurality of emergency dispatcher telephone numbers stored on the device.

In response to determining or obtaining a determination that the user input expresses a user request for making an emergency call the device calls the local emergency dispatcher telephone number using the emergency call functionality e.g. via a baseband telephone service .

In some embodiments prior to calling the local emergency dispatcher telephone number the device provides a notification to the user that the device will promptly call the local emergency dispatcher telephone number. While providing the notification the device provides an affordance for the user to cancel the request for making an emergency call. For example in some embodiments the device displays a five second countdown notification e.g. notification in and an affordance to cancel the pending emergency call e.g. cancel button and or Home button in . In some implementations the device will provide verbal notification and or utilize verbal cancellation from the user.

In some embodiments determining or obtaining a determination of whether the user input expresses a user request for making an emergency call comprises determining or obtaining a determination of whether the user input unambiguously expresses a user request for making an emergency call.

In some embodiments in response to a determination that the user input unambiguously expresses a user request for an emergency call without further user input the device calls the local emergency dispatcher telephone number using the emergency call functionality. For example the user input is a speech input saying call 911 and without further user input the device determines that 911 is the appropriate emergency dispatcher number and the device calls .

In some embodiments in response to a determination that the user input does not unambiguously express a user request for an emergency call prior to calling the local emergency dispatcher telephone number using the emergency call functionality the device provides the user with a notification and an affordance for confirming the user s request for making an emergency call. For example the user input is find fire departments near here and the device provides a emergency inquiry e.g. confirmation inquiry in and an affordance for confirming e.g. confirm button in . In some implementations the device will provide verbal notification and or utilize verbal confirmation from the user.

In some embodiments determining or obtaining a determination of whether the user input expresses a user request for making an emergency call comprises determining or obtaining a determination that the user input is a user request for calling a first emergency number. For example the user input is call 911 and the device determines that 911 is the first emergency number.

In some embodiments determining or obtaining a determination of the local emergency dispatcher telephone number based on a geographic location of the device comprises determining or obtaining a determination of a second emergency number. When the first emergency number is distinct from the second emergency number the device calls the local emergency dispatcher telephone number using the emergency call functionality comprises calling the second emergency number. For example the device determines it is currently located in Singapore and that the appropriate emergency dispatch number is . In this example the device then calls .

Using a digital assistant in accordance with the methods described above is more efficient and convenient than conventional user interfaces for providing emergency call functionality.

As shown in device includes sound receiving unit configured to receive sound input. Device also includes processing unit coupled to sound receiving unit . In some embodiments obtaining unit is coupled to sound receiving unit and processing unit . In some embodiments processing unit includes speech determining unit number determining unit calling unit ascertaining unit ambiguity determining unit affordance providing unit notification providing unit and language providing unit . In some embodiments number determining unit corresponds to emergency call module . In some embodiments ambiguity determining unit corresponds to natural language processing module . In some embodiments ambiguity determining unit corresponds to limited language processing module . In some embodiments obtaining unit corresponds to I O subsystem . In some embodiments affordance providing unit is or includes notification providing unit . In some embodiments speech determining unit is or includes ambiguity determining unit .

Processing unit is configured to receive e.g. with sound receiving unit a speech input from a user determine e.g. with speech determining unit or obtain a determination e.g. with obtaining unit of whether the speech input expresses a user request for making an emergency call and determine e.g. with number determining unit or obtain a determination e.g. with obtaining unit of a local emergency dispatcher telephone number based on a geographic location of device . Processing unit is further configured to in response to determining or obtaining a determination that the speech input expresses a user request for making an emergency call call e.g. with calling unit the local emergency dispatcher telephone number.

In some embodiments prior to determining or obtaining a determination of the local emergency dispatcher telephone number device ascertains e.g. with ascertaining unit the geographic location of device .

In some embodiments determining or obtaining a determination of whether the speech input expresses a user request for making an emergency call comprises determining e.g. with ambiguity determining unit or obtaining a determination e.g. with obtaining unit of whether the speech input unambiguously expresses a user request for making an emergency call. In some embodiments in response to a determination that the speech input unambiguously expresses a user request for an emergency call without further user input device calls e.g. with calling unit the local emergency dispatcher telephone number using the emergency call functionality. In response to a determination that the speech input does not unambiguously express a user request for an emergency call prior to calling the local emergency dispatcher telephone number using the emergency call functionality device provides the user with a notification e.g. with notification providing unit and an affordance e.g. with affordance providing unit for confirming the user s request for making an emergency call.

In some embodiments determining or obtaining a determination of whether the speech input expresses a user request for making an emergency call comprises determining e.g. with number determining unit or obtaining a determination e.g. with obtaining unit that the speech input is a user request for calling a first emergency number. In some embodiments determining or obtaining a determination of a local emergency dispatcher telephone number based on a geographic location of device comprises determining e.g. with number determining unit or obtaining a determination e.g. with obtaining unit of a second emergency number. In some embodiments when the first emergency number is distinct from the second emergency number calling the local emergency dispatcher telephone number using the emergency call functionality comprises calling e.g. with calling unit the second emergency number.

In some embodiments prior to calling the local emergency dispatcher telephone number device provides a notification e.g. with notification providing unit to the user that device will promptly call the local emergency dispatcher telephone number and while providing the notification device provides an affordance e.g. with affordance providing unit for the user to cancel the request for making an emergency call.

The foregoing description for purpose of explanation has been described with reference to specific embodiments. However the illustrative discussions above are not intended to be exhaustive or to limit the disclosed embodiments to the precise forms disclosed. Many modifications and variations are possible in view of the above teachings. The embodiments were chosen and described in order to best explain the principles and practical applications of the disclosed ideas to thereby enable others skilled in the art to best utilize them with various modifications as are suited to the particular use contemplated.

