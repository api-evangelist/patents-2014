---

title: System and method for hybrid off-board navigation
abstract: A system, method and apparatus for hybrid off-board vehicle navigation are disclosed. In the system, a multi-stop route package is created and sent from a route server to a navigation device. The route package can include a collection of vehicle attributes and corresponding road restrictions for guiding the vehicle towards its destination. The server can optionally push the route package to the vehicle in an email message or other stored communication. When an off-route condition is detected, the navigation device can send a route request to the server that includes the vehicle attributes and the corresponding road restrictions. The server can respond with a partial route correction that is determined based on the vehicle attributes and road restrictions.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09310212&OS=09310212&RS=09310212
owner: Environmental Systems Research Institute, Inc.
number: 09310212
owner_city: Redlands
owner_country: US
publication_date: 20141107
---
This application is a Divisional of U.S. patent application Ser. No. 12 533 987 filed on Jul. 31 2009 which claims the benefit of and is a non provisional of U.S. Provisional Application No. 61 137 832 filed Aug. 1 2008 entitled System and Method for Hybrid Off Board Navigation and U.S. Provisional Application No. 61 198 450 filed on Nov. 6 2008 entitled System and Method for Selective Transfer of Navigation Settings all of which are herein incorporated by reference in their entirety for all purposes.

Vehicle and personal navigation devices are widely available and provide many useful features. With a navigation device for example a user can determine his or her location and be guided towards a destination. Navigation devices typically calculate a route and present it to the user on a display. This local route calculation is commonly referred to as on board navigation. In addition to its navigation functions the device may also provide information about nearby points of interest.

Unfortunately on board navigation systems do not scale well to accommodate a large number of users and vehicles. With on board navigation for example each driver at a trucking company might need to manually enter information into his or her navigation device in order to calculate a route. Depending on the size of the company this process might be repeated hundreds or even thousands of times. This repetition in turn increases the chance of error and makes it difficult to implement company wide policies relating to vehicle operation.

A system method and apparatus for hybrid off board vehicle navigation are disclosed. In the system a multi stop route package is created and sent from a route server to a navigation device. The route package can include a collection of vehicle attributes and corresponding road restrictions for guiding the vehicle towards its destination. The server can optionally push the route package to the vehicle in an email message or other stored communication. When an off route condition is detected the navigation device can send a route request to the server that includes the vehicle attributes and the corresponding road restrictions. The server can respond with a partial route correction that is determined based on the vehicle attributes and road restrictions.

In one embodiment a method of off board navigation is disclosed. According to the method a navigation device receives routing information relating to a route from a starting point to a destination. The routing information is determined externally to the navigation device and includes vehicle attributes and optionally road restrictions corresponding to the vehicle attributes. The method includes storing the routing information at the navigation device and guiding the vehicle towards the destination based on the routing information. The method also includes detecting an off route condition in which the vehicle departs from the route. When the off route condition is detected the method includes sending a route request message containing the vehicle attributes and the road restrictions from the navigation device to a server.

As part of the method the navigation device detects the availability of a response from the server obtains a route correction and updates a portion of the routing information based on the route correction. Optionally the method includes detecting at the server the availability of a stored communication containing the routing information downloading the stored communication from the server to the navigation device and obtaining the route from the stored communication at the navigation device. According to the method if a response from the server is not available the navigation device can determine a local route correction and can guide the vehicle temporarily based on the local route correction. The navigation device can detect when the vehicle has returned to the route and can guide the vehicle towards the destination based on the routing information.

In another embodiment a vehicle navigation device is disclosed. The device includes a network interface that can receive route data with vehicle attributes and road restrictions corresponding to the vehicle attributes from a source external to the navigation device. The device includes a memory that can store the route data and a positioning module that can determine a current position of the vehicle in relation to the route. In addition the device includes a display that can provide route guidance to a user. A routing engine of the device is configured to determine the route guidance according to the route data and to detect an off route condition based on the current location of the vehicle. The routing engine can send a route request message including the vehicle attributes and the road restrictions from the navigation device to a server via the network interface. Also the routing engine can detect the availability of a response from the server to the route request message obtain route correction information from the response when it is available and update the route data at the vehicle navigation device based on the route correction information.

In yet another embodiment a computer readable storage medium encoded with program instructions is disclosed. When executed by a processor the program instructions carry out steps of receiving route data at a navigation device. The route data can include a pre calculated route from a starting point to a destination having route geometry stops vehicle attributes and road restrictions corresponding to the vehicle attributes. The instructions perform steps of storing the vehicle attributes and road restrictions in a memory of the navigation device guiding the vehicle based on the pre calculated route towards the destination and detecting an off route condition in which the vehicle has departed from the pre calculated route. When executed by the processor the instructions encoded on the computer readable storage medium also perform steps of sending a route request message with the stored vehicle attributes and the road restrictions to a server over a network detecting the availability of a response from the server to the route request message obtaining route correction information from the response and updating a portion of the pre calculated route based on the route correction information.

In another embodiment a route server is disclosed. The route server includes a network interface in data communication with a plurality of vehicles wherein each of the vehicles is associated with a collection of attributes and corresponding road restrictions. The route server includes a map database with routing information and road restrictions. The route server also includes a processor which can receive route data for a first vehicle including attributes of the first vehicle and road restrictions corresponding to the attributes of the first vehicle. The processor can send the route data to a navigation device associated with the first vehicle via the network interface absent a request from the navigation device. The route server can also respond to route requests from the vehicles. In one embodiment the processor is configured to receive a route request from the first vehicle to determine a route correction based on vehicle attributes and road restrictions obtained from the route request and to transmit via the network interface a data file including the route correction to the navigation device associated with the first vehicle.

In the figures similar components and or features may have the same reference label. Also various components of the same type may be distinguished by following the reference label with a dash and a second label. If only the first reference label is used the description is applicable to any of the similar components designated by the first reference label.

Route generator can be any computing device capable of producing a vehicle specific route. In some embodiments route generator creates highly optimized routes according to business rules and operational constraints. For example in a fleet vehicle context route generator can create efficient multi stop routes based on vehicle capabilities load requirements road restrictions operating costs and other constraints. Advantageously routes optimized for specific vehicles can improve the performance of fleet operations by saving fuel increasing safety reducing drive times and lowering maintenance costs.

Route generator sends route data to a server over communications network . This can take many forms. Route generator and server can be commonly owned and operated. For example a trucking company can provide routes and navigation support to all of its vehicles from a central location. Alternatively route generator and server can be operated by different entities such as when the trucking company supplies initial routes and a separate dispatch service provides support for vehicles navigating the routes.

Server distributes vehicle specific route data created by route generator to navigation devices associated with each vehicle. The route data can include vehicle attributes and corresponding road restrictions. Vehicle specific attributes can include vehicle height vehicle length vehicle weight number of axles per axle weight limits load restrictions etc. Road restrictions can be based on the vehicle specific attributes and can aid in determining a suitable route. For example road restrictions can be used to avoid tunnels that are not accessible to vehicles exceeding predetermined height criteria bridges that are not accessible to vehicles exceeding predetermined weight criteria or transporting hazardous materials in close proximity to highly populated areas.

Route data can also include a detailed stops list and route geometry for use in guiding the vehicle from a starting point to its destination. The stops list can include information for each stop on a multi stop route. This information can include a delivery location a delivery time a contact person special instructions etc. Route geometry on the other hand can assist in providing visual or audible navigation cues such as text to speech or route highlighting. Because server provides a complete route package it is not necessary for the vehicle operator to enter information into navigation device which in turn reduces the likelihood of errors.

Navigation devices receive the route data and can send messages to server over communications network . Navigation devices can include various types of mobile communication devices capable of wireless communications with server . Preferably navigation devices include a Global Position System GPS receiver or other position location capability. For example navigation devices can be personal digital assistants PDAs smartphones notebook computers and various other portable computing and communication devices. In an exemplary embodiment navigation devices support a version of the Windows operating system such as the Windows XP Windows XP Embedded Windows CE or the Windows Mobile platform from Microsoft Corporation.

When the route data is received each navigation device stores a copy of the vehicle attributes and road restrictions for the vehicle with which it is associated. For example the route data for navigation device may include vehicle attributes and road restrictions appropriate for hazardous materials transport the route data for navigation device may include vehicle attributes and road restrictions appropriate for wide loads and or excessive weight and the route data for navigation device may include vehicle attributes and road restrictions relating to vehicle height among other possibilities.

Based on the route data navigation devices guide each vehicle towards its destination. Navigation devices can provide turn by turn driving directions and related map data for each stop on a multi stop route. Additionally each navigation device can track the current location of its vehicle and can determine when the vehicle has deviated from its route. When an off route condition is detected navigation devices can send a route request message that contains the vehicle specific attributes and road restrictions to the server .

Because navigation devices store and transmit vehicle specific attributes and corresponding road restriction data it is not necessary for server to separately maintain such information. Instead server can simply calculate a route correction based on the content of the route request message. Server therefore can provide off board navigation services to virtually any type of vehicle without the burden of tracking the vehicles attributes road restrictions business rules etc.

Server can send a route data message to navigation device via its communications interface . The route data message can be attached to an email and addressed to the navigation device . Alternatively server can maintain the route data in memory and route data message can be sent in response to communications initiated by a navigation device . For example communications interface can support SOAP simple object access protocol REST representational state transfer or some other messaging protocol for providing the route data as a network service.

Navigation device can receive the route data message at its communication interface . Route processor can extract the route and use it to provide driving directions maneuvers and map data for guiding the vehicle to each stop along the route. Additionally route processor can extract and store vehicle specific attributes and road restrictions from the route data message in a memory of the navigation device. Route processor stores the vehicle attribute information and road restrictions from the route data message so that it is available for on board navigation in the event that communication with server is interrupted. In addition when route processor detects an off route condition it can send a route request message containing the vehicle attributes and road restrictions to server .

At the server processor can parse the route request message to obtain the data items and can calculate a partial route from the vehicle s current location to the point on the route. To determine the route processor can retrieve routing information from map database . Map database can include information about one or more geographic regions such as cities states metropolitan areas rural areas etc. Preferably server includes comprehensive map data covering all of the regions in which it provides navigation services.

Based on information from map database and the vehicle attributes and road restrictions from route request message server can determine a partial route for returning navigation device to the original route from its current location. Route request message can include all of the information needed to determine a partial route that is suitable for the particular vehicle and its load characteristics. For example if the vehicle attributes indicate the presence of hazardous materials server can calculate a partial route which avoids densely populated areas or travel by ferry.

The partial route can be stored in memory and communicated to navigation device in a route correction message . The route correction message can have a format similar to route data message . However it can be much smaller in size because it typically contains only partial route data. Navigation device can receive the route correction message at its communications interface . At the navigation device route processor can obtain the partial route from the route correction message and insert it into the original route data. The insertion of partial route data enables off board navigation to be performed efficiently since it reduces the amount of data that is exchanged over the communication channel while taking advantage of the server s greater processing power. Server can also send vehicle attribute updates as discussed herein.

Route processor controls the operation of navigation device by executing program instructions stored in memory or mass storage . Route processor can include one or more programmable processors which can be any combination of general purpose and special purpose devices. For example route processor can include microprocessors microcontrollers application specific integrated circuits ASIC field programmable gate arrays FPGAs complex programmable logic devices CPLDs and the like. In one embodiment route processor executes a version of the Windows operating system and can interact with the various parts of navigation device using device drivers and other operating system resources.

Memory can include one or more random access memory RAM read only memory ROM and other volatile or non volatile memory elements. Mass storage can be a high capacity data store and may include one or more flash memory elements solid state drives SSD hard disk drives optical drives and magneto optical drives. In one embodiment mass storage stores a map database used for on board navigation. The map database can include streets and points of interest for a particular geographic region such as a city or state. In addition the map database can include road restrictions such as information about bridge clearances weight limits ferry restrictions regulations for transporting hazardous materials etc.

Navigation device also includes a GPS receiver or other positioning module. GPS receiver enables navigation device to determine its current location in conjunction with information from the map database. In some embodiments GPS receiver processes a combination of ground based and satellite based signals to determine its location. For example GPS receiver can augment its positioning with information from cell towers such as with assisted GPS A GPS or enhanced GPS E GPS cellular network systems.

A network interface is included as part of route messaging subsystem . Navigation device communicates with route server and other devices via the network interface. In various embodiments network interface includes cellular telephone transmit and receive circuits a satellite transceiver a WiMAX Worldwide Interoperability for Microwave Access adaptor or other mobile communications technology hardware. For example network interface can enable navigation device to access the internet via a privately owned access network.

A route monitor and a messaging interface are coupled to network interface . In one embodiment route monitor checks for the availability of route data and update messages from server . For example route monitor may periodically check an email account for route data and updated vehicle attributes. The email account can be associated with the vehicle for which the route was created. Route monitor can detect the availability of route data messages and can automatically initiate a download to the navigation device via network interface without having to request a route from server . In this way server can push route data to a large number of navigation devices without handshaking and other communications overhead.

Messaging interface can exchange route request and route correction messages with server . For example route processor can determine that the vehicle has deviated from its route based on information from GPS receiver and can cause messaging interface to send a route request to server . Since it is desirable to obtain a route correction quickly a connection oriented protocol may be used to communicate with server . In some embodiments messaging interface supports HTTP based protocols such as SOAP Simple Object Access Protocol or REST Representational State Transfer for sending the route request and receiving a route correction from server . Additional aspects of route messaging are discussed below.

I O subsystem includes an input system a display controller and a text to speech engine . The I O subsystem also includes a speaker coupled to and controlled by text to speech engine and a display device coupled to and controlled by display controller . Input system receives input from a user of the navigation device and can include a keyboard touchpad mouse microphone and the like. Speaker provides audible cues for guiding the vehicle on its route. For example with speaker text to speech engine can provide audible turn by turn directions for each stop on the route. Display device can display the route in relation to street and map information from the map database maintained in mass storage and can provide a user interface for controlling the various functions of navigation device .

The process starts at block . For example the start of process can represent the start of a work day at a trucking company delivery service or other fleet vehicle operations center at which a driver is assigned to a specific vehicle and utilizes a navigation device to provide driving directions map data and stops along a route.

At block route data is received at the navigation device. The availability of the route data can be detected by route monitor . When available the route data can be downloaded from a server via network interface . For example the delivery service can generate daily routes and distribute route data to each of its drivers by emailing an account associated with their vehicles. Route monitor can monitor the vehicle s email account and can automatically download the route data. Alternatively route monitor can periodically check a server for a route data file or other stored communication.

At block the navigation device processes the route data received from the server. Processing the route data can include parsing the XML message and converting its content to an internal format that can be used with the map database. For example data from stops list can be combined with route geometry to produce turn by turn driving directions and maneuvers for guiding the vehicle to each point on the route.

The route data also includes vehicle attributes and road restrictions . shows that among others vehicle specific attributes can include vehicle height vehicle width vehicle length and vehicle weight. Road restrictions can correspond to the vehicle attributes and may reflect business rules and other considerations. A road restriction may be set for example when the corresponding vehicle height attribute exceeds certain limits. Similarly restrictions may be set when the vehicle carries hazardous materials or when it cannot travel on unpaved roads. Route processor can store a copy of the vehicle attributes and road restrictions obtained from the route data in memory .

When the route data is processed at block the navigation device can provide driving directions and map data for guiding the vehicle along the route. For example GPS receiver can determine the vehicle s current location and display device can display the current location in relation to the route. Audible driving directions and maneuvers can also be provided at speaker with text to speech engine .

At block an off route condition is detected when the vehicle deviates from the route. For example the vehicle s current position can be compared to points along the route. If the current position exceeds an off route threshold route processor generates a route request for a partial route correction. The request can be similar to route request and can include vehicle attributes and road restrictions stored in memory . When the request is ready at block it is sent to the route server via messaging interface . Because the route request includes vehicle attributes and road restrictions the route server does not need to track this information for each vehicle.

Depending upon conditions the navigation device may or may not receive a response to the route request message. For example the vehicle may be outside of the coverage area of its network provider. Alternatively the route server may be temporarily down or there may be other network failures which prevent it from communicating with the navigation device. If a response from the route server is not received within a predetermined time at block the navigation device can perform a local on board route calculation based on information from the map database. Preferably the navigation device determines the best option for rejoining the original route based on the vehicle attributes and road restrictions stored in its memory.

If the route server is available the navigation device can receive and process a route correction message. In some embodiments the navigation device receives a SOAP REST route correction message from the server at its messaging interface. The route correction message can be a simplified version of the original route data as shown in . For example the route correction message can include updated route geometry and stops for only that portion of the route which has changed.

At block the original route data is updated based upon the local route data or the route correction message. This can be accomplished quickly since in most cases only part of the original route is affected by the off route condition. Thus the route processor can provide driving directions based on the local route data until the original route is rejoined whereupon it can resume navigating based on the original route data. Or the route processor can extract and process the updated route geometry and stops from the route correction message and insert the results into the original route data. At block the navigation device determines whether to continue at block or to end the process at block . The process can be terminated for example in response to operator input or when the vehicle has reached its destination.

Based on the foregoing persons of skill in the art will recognize that the inventive hybrid off board navigation system provides several advantages. Because an entire route package is downloaded to the navigation device it is not necessary for vehicle operator to supply additional information such as attributes restrictions policies etc. applicable to his or her vehicle. This can reduce errors increase safety ensure adherence to business rules and reduce the burden on vehicle operators. Additionally the inventive route messaging effectively decouples the route generator from the route server. In other words a single route server can provide vehicle specific routes and route corrections to almost any vehicle or fleet without separately tracking applicable attributes restrictions and business rules.

On the other hand some vehicle attributes may change as the route progresses. For example vehicle weight can change when a delivery is made or hazardous materials restrictions may change when a load reaches its destination. Still other attributes and restrictions may relate to business rules. These attributes and restrictions may represent policy which can change based on a variety of factors. For example policy may require avoiding toll roads to reduce costs or using them when necessary to expedite a delivery.

In one embodiment the vehicle attributes and road restrictions are classified into strict and relaxed categories based on the route data message. Strict attributes and restrictions may not be changed at the navigation device. These attributes for example can represent the fixed properties of a vehicle or business rules that are applied without exception. The values of the strict attributes and road restriction are displayed in the full listing but are grey to indicate that they are read only. In the example the values of vehicle weight and vehicle height cannot be changed by a user of the navigation device. Relaxed attributes are shown in white to indicate that they are changeable. In the example restrictions relating to toll roads are relaxed and can be changed by the vehicle operator.

An update button is provided to commit changes to the vehicle attributes and restrictions. When the update button is pressed the navigation device can send a route request message including any remaining stops and the updated vehicle attribute restriction values. In response to the route request the route server can determine new route data optimized for the changed values and can push the new route data to the navigation device. The new route data can be received by the route message subsystem processed by the route processor and stored in device memory as previously described.

When the update button is pressed the navigation device can send a route request message including the reordered remaining stops the vehicle attributes and the road restrictions. In response to the route request the route server can determine new route data optimized for the changed stops and can push the new route data to the navigation device. The new route data can be received by the route message subsystem processed by the route processor and stored in device memory as previously described.

The process begins at block . This can correspond to server receiving initial route data from route generator . For example the route server can receive a highly optimized multi stop route for each vehicle in a fleet. At block the route server pushes the route data including vehicle attributes and road restrictions to the navigation devices associated with the vehicles. Note that pushing the route data out from the route server is done absent a request from the navigation devices. Instead each navigation device can be responsible for monitoring the availability of its own route data.

When the initial route data is distributed at block the route server monitors the communication channel for route requests and updates. Updates can result from changes in the vehicle attributes and or road restrictions. For example a driver may be unable to pick up a load at a scheduled stop. Alternatively the load that is available for pick up may differ from what was expected. When attribute changes are detected block restrictions relating to vehicle height weight hazardous materials etc. can be changed mid route.

The route server can calculate new route data based on the updated attributes. At block the new route data can be pushed out over the communication channel in an attribute update message . The attribute update message can contain new route data optimized for the changed conditions and can have a format similar to that of the route data message described in connection with . As with distribution of the original route data distribution of the attribute update can be initiated by the route server without having first received a request from the navigation device. The navigation device can then receive process and store the attribute update message in the same manner as with new route data.

At block the route server can detect a route request message. For example a navigation device can request a route correction by sending an XML message to the route server using a SOAP REST protocol. When the route request message is received at block the route server extracts vehicle attributes and road restrictions from the request message and determines a route correction. At block the route server sends the route correction to the navigation device. The route server continues to monitor the communications channel blocks until the process ends at block .

Specific details are given in the above description to provide a thorough understanding of the embodiments. However it is understood that the embodiments may be practiced without these specific details. For example some circuits may be omitted from block diagrams in order not to obscure the embodiments with unnecessary detail. In other instances well known circuits processes algorithms structures and techniques may be shown without unnecessary detail in order to avoid obscuring the embodiments.

Also it is noted that the embodiments may be described as a process which is depicted as a flowchart a flow diagram a data flow diagram a structure diagram or a block diagram. Although a flowchart may describe the operations as a sequential process many of the operations can be performed in parallel or concurrently. In addition the order of the operations may be re arranged. A process is terminated when its operations are completed but could have additional steps not included in the figure. A process may correspond to a method a function a procedure a subroutine a subprogram etc. When a process corresponds to a function its termination corresponds to a return of the function to the calling function or the main function.

Implementation of the techniques blocks steps and means described above may be done in various ways. For example these techniques blocks steps and means may be implemented in hardware or a combination of hardware and software. For a hardware implementation processing units may be implemented with one or more application specific integrated circuits ASICs digital signal processors DSPs digital signal processing devices DSPDs programmable logic devices PLDs field programmable gate arrays FPGAs processors controllers micro controllers microprocessors other electronic units designed to perform the functions described above and or a combination thereof.

As described herein the term storage medium may represent one or more memories for storing data including read only memory ROM random access memory RAM magnetic RAM core memory magnetic disk storage mediums optical storage mediums flash memory devices and or other machine readable mediums for storing information. The term machine readable medium includes but is not limited to portable or fixed storage devices optical storage devices wireless channels and or various other storage mediums capable of storing that contain or carry instruction s and or data.

While the principles of the disclosure have been described above in connection with specific apparatuses and methods it is to be clearly understood that this description is made only by way of example and not as limitation on the scope of the disclosure.

