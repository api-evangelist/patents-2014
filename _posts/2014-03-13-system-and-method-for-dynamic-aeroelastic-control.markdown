---

title: System and method for dynamic aeroelastic control
abstract: The present invention proposes a hardware and software architecture for dynamic modal structural monitoring that uses a robust modal filter to monitor a potentially very large-scale array of sensors in real time, and tolerant of asymmetric sensor noise and sensor failures, to achieve aircraft performance optimization such as minimizing aircraft flutter, drag and maximizing fuel efficiency.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09073623&OS=09073623&RS=09073623
owner: The United States of America as Represented by the Administrator of the National Aeronautics and Space Administration
number: 09073623
owner_city: Washington
owner_country: US
publication_date: 20140313
---
The present application derives priority from U.S. provisional application Nos. 61 798 078 filed 15 Mar. 2013 and 61 905 698 filed Nov. 18 2013.

The invention described hereunder was made in the performance of work under a NASA contract and is subject to the provisions of Public Law 96 517 35 U.S.C. 202 in which the Contractor has elected not to retain title.

The invention relates to structural monitoring and more particularly to a hardware and software architecture for dynamic modal structural monitoring and control that monitors the dynamics of a structure such as an aircraft in the presence of complex loading patterns using a robust modal filtering architecture with integrated distributed shape and accelerometer sensing.

Monitoring the states of a structure is useful for safety control and performance optimization in a wide variety of applications. For example fuel efficiency and safety are of paramount importance to the aviation industry. Toward this end lightweight composite material use in aircraft is now a common practice. However increased flexibility leads to an aircraft which is more susceptible to dynamic phenomena such as gusts flutter and buffeting which negatively affect safety and performance and can be potentially destructive. Consequently demand has grown in the aviation industry for aircraft that are capable of monitoring and managing such dynamics. Typical aeroelastic control methods identify optimal control surface settings for minimum drag from indirect sensory data such as wing root load balances engine RPM or thrust fuel but such parameters do not give an accurate reflection of the true structural state of an aircraft.

Several approaches have been proposed for more reliable real time estimation of structural states. However most are frequency based methods which utilize conventional sensors to monitor a structure s natural frequency response. These methods are suitable for single mode vibration suppression but have limited effectiveness for the multi mode vibration suppression. Flexible aircraft are highly complex structures with multiple vibration modes and active control of such large flexible structures is more readily achieved with multiple input multiple output MIMO control algorithms.

An estimator which supports a MIMO type control algorithm is the spatial filter or modal filter. Modal filtering is a known spatial filtering technique which transforms physical coordinates to modal coordinates. The modal coordinates can be used to capture the contribution of both static and dynamic deformation in the structure. Modal filtering methods are generally well known in the art and are disclosed in numerous publications including Shelley S. J. Investigation of Discrete Modal Filters for Structural Dynamics Applications Department of Mechanical and Industrial Engineering University of Cincinnati 1990. Discrete continuous modal filters and dynamic state estimators have typically been used for sensing modal coordinates in trusses and bridges.

A pseudo inverse modal filter developed by Zhang was implemented by Shelley et al. on a five meter truss structure showing promise for real time monitoring of the structure. Shelley S. Freudinger L Allemang R. J. and Zhang Q. Implementation of a Modal Filter on a Five Meter Truss Structure. IMAC IX Conference Florence Italy Proceeding Volume 2. p. 1036 1044. Unfortunately the pseudo inverse modal filter is not fault tolerant and fails as soon as one sensor fails.

Shelley et al. later proposed an adaptive modal filter technique to compensate for small sensor failure or calibration drift. Shelley S. J. Allemang R. J. Slater G. L. Shultze J. F. Active Vibration Control Utilizing an Adaptive Modal Filter Based Modal Control Method 11International Modal Analysis Conference Kissimmee Fla. Feb. 1 4 1993. However the Shelley et al. adaptive modal filter must be programmed with the natural frequency modal damping and modal residue of the structure. While these parameters can be initially calculated they will tend to drift over time. Shelly s algorithm is also based upon least mean squares LMS which has similarly bad resistance to gross outliers large sensor bias as least squares. In flight the strain can be very high. If a sensor failure occurs and the sensor reading is near zero while the rest are at normal values the sensor reading near zero is characterized as a gross outlier. This could completely bias a modal filter estimate using either least mean squares or ordinary least squares.

Nevertheless if these past deficits can be overcome the modal filter has the potential to benefit the aerospace field significantly. What is needed is a system and method for dynamic modal structural monitoring and control that integrates a very large scale array of sensors including distributed strain and acceleration sensing for the purposes of robust modal filtering in lieu of the pseudo inverse modal filter in real time while being completely tolerant to multiple sensor failures and asymmetric sensor error.

The present invention provides such a system and in so doing offers more reliable estimates of the modal displacements and velocities for flexible aircraft structural feedback control than the current state of the art especially in the presence of uncertainty and multiple sensor failures.

It is therefore an object of the present invention to provide a robust and fault tolerant system for dynamic modal structural monitoring and control.

It is another object to provide a method and system for improved aeroelastic control suitable for flight safety critical aircraft operation.

It is another object to implement a real time spatial modal filtering system in a robust manner that is insensitive to asymmetric sensor noise and sensor failures.

It is yet another object to implement a practical aeroelastic control where modal frequencies and modal shapes change with air speed that employs real time spatial modal filtering for active flutter suppression AFS aircraft performance improvement and loads alleviation.

According to the present invention the above described and other objects are accomplished by providing a hardware and software architecture for dynamic modal structural monitoring that uses a robust modal filter to monitor a potentially very large scale array of sensors in real time and tolerant of asymmetric sensor noise and sensor failures to achieve aircraft performance optimization such as suppressing aircraft flutter minimizing drag and maximizing fuel efficiency.

The present invention is a hardware and software architecture for dynamic modal structural monitoring that integrates modal filtering to monitor an array of sensors using a robust modal filter in real time immune to asymmetric sensor noise and sensor failures. The invention provides a practical real time approach to monitor the complex dynamics of a flexible aircraft using a robust modal filtering algorithm based on the hybridization of a computationally efficient concentration based estimator and M estimation.

An embodiment of the present system architecture for aeroelastic control is shown in . The plant is a mathematical model used to represent the aircraft to be controlled which in this case is illustrated as a wing model. The wing is equipped with a sensor array for measuring shape deflection or strain at multiple locations on the wing structure.

Sensor array preferably comprises a fiber optic sensor FOSS array which is used to measure strain or shape. The individual sensors in array can be used by way of modal filtering to determine the modal displacement states of aeroservoelastic state space models. A distributed array of Fiber Bragg Grating sensors is well suited as FOSS array as explained in B. Childers et al. Use Of 3000 Bragg Grating Strain Sensors Distributed On Four Eight Meter Optical Fibers During Static Load Tests Of A Composite Structure Proc. of SPIE 4332 133 142 2001 . FOSS array includes numerous FBG sensors placed at regular intervals along multi core three or more channels in a single fiber optical fibers. A multi core FOSS array is able to capture deformation x y z from its un deflected position in real time with good accuracy without any knowledge whatsoever of the structure to which it is adhered to. The strain measurements from each fiber core indicate the direction and amount of bend in the fiber. The amount of strain in each core is proportional to the bend radius and to the position of each core relative to the bend. Alternatively FOSS array may employ a photogrammetric technique to measure shape at all x y z locations.

The aircraft carries a computerized feedback loop capable of executing the various feedback software modules of the present invention including plant model 10 modal filter assembler software robust modal filter and function approximator . Suitable computing devices include a processor memory e.g. RAM a bus which couples the processor and the memory a mass storage device e.g. a magnetic hard disk or an optical storage disk coupled to the processor and the memory through an I O controller. It is envisioned that at least a 2.8 GHz processor will suffice to provide the necessary computation rate of 1 830 Hzm for real time operation though parallel processing may be preferred in some cases. The aircraft also carries a flight controller which also has various control software modules for developing and executing the various aeroeleastic control commands as a result of the feedback software .

The modal filter assembler software described herein computes the components necessary for the robust modal filter . Assembler software comprises either of two variations. If strain measurements exist in Sensor array then the strain is computed at each x y z location of the FBG sensors in real time. Assembler software also assembles the strain mode matrix corresponding to the same x y z locations. The measurements and strain mode matrix are passed to the robust modal filter . Note that the strain mode matrix must only be computed once.

The second variation of software is provided when shape at all x y z locations is estimated from a measurement technique such as photogrammetry in real time. During processing of Assembler software the shape modal matrix is computed at the same x y z locations. The measurements and shape modal matrix are passed to the robust modal filter . Again the shape modal matrix must only be computed once.

Getting these distributed measurements and a modal matrix either shape or strain as per above is all that the robust modal filter requires.

Aircraft aeroelastic behavior is a function of the modal coordinates. By controlling modal coordinates one may control the shape of the vehicle. The shape of the vehicle is intrinsically related to the aerodynamic performance of the vehicle. Thus control of the modal coordinates can lead to control of aeroservoelastic performance of the vehicle. The robust modal filter software robustly computes the required modal coordinates for aeroservoelastic control through the computed modal matrices and on line real time distributed sensor preferably strain measurements.

The data from software are input to a robust modal filter software module which manages the contribution of the thousands of sensors in the system and converts the information through concentration and M estimation into the modal coordinates of the system. Thus the modal filter performs a multiple degree of freedom modal coordinate transformation. In accordance with the present invention the robust modal filter performs online robust regression rather than a least squares regression to significantly reduce sensitivity to outlier data. Ordinary least squares can give misleading results if the error variation of each sensor is not normal thus ordinary least squares is highly susceptible to asymmetric sensor noise and or sensor failure. The present robust regression method to be described is designed to be not overly affected by violations of assumptions by the underlying data generating process. A concentration algorithm is proposed as a basis for the robust modal filter derivation as they are applicable to large data sets. E. A. Fox Q. F. Chen and L. S. Heath. A Faster Algorithm For Constructing Minimal Perfect Hash Functions Proc. 15th Annual Int l ACM SIGIR Conf. on Research and Development in Information Retrieval pp 266 273 1992 . Typically robust regression methods for 1 000s of measurements are not computable in real time. The robust modal filter solves this with a careful mix of M estimation and concentration principles and introduces a new trim criterion.

The modal coordinates output from the robust modal filter are input to a Function Approximator . Other inputs to the Function Approximator may include distributed aerodynamic sensors and optionally fuel gauge information. With this information a functional relationship between the modal coordinates and the aerodynamic sensors can be generated. The relationship is passed to a flight controller which includes a diagnostics and performance analyzer module . The diagnostics and performance analyzer module estimates performance optimization stability and control measures needed to command the shape of the aircraft to an optimal shape while staying within constraint boundaries. These functional parameters are then sent to a command optimizer which confirms the optimal flight system commands to implement the optimal shape. Finally the optimal commands are assembled in a command shaping module which gives the actual command setpoint to the active control system. All the foregoing components are described below in more detail.

The present invention employs a fiber optic sensing system FOSS comprising a plurality of parallel optical fibers running along each wing and each having numerous Fiber Bragg gratings 5 FBGs interposed along the length an optical fiber spaced at approximately every .

Light from a tunable laser source TLS is split between reference and measurement arms of an interferometer. In the measurement path the light is further split to interrogate each single mode optical fiber and return the reflected light. The laser is swept so that back reflections from points at different distances along the fiber under test correspond to different beat frequencies. The reflection positions along the fiber can be distinguished by their different beat. The software processes the strain measurements from sensors to derive a highly accurate depiction of how each fiber is positioned and smooths the data so that derivatives of the modal displacements can be taken to achieve modal velocities. The assembler software calculates a modal matrix representing spatial or strain information at each sensor using the finite element method. The assembler software then reduces the modal matrix according to which sensors are used. The distributed measurements from sensors and reduced modal matrix either shape or strain as per above are then sent to the robust modal filter for computation of the modal coordinates.

The design of modal filter from an array of sensors requires the output signals of each sensor to be weighted based on their estimated variance. The measured strain is approximately a linear combination of the sensor strain data matrix and so the measured strain is asymmetrically distributed. Importantly wing loading varies with aerodynamic condition and so the underlying strain distribution is difficult to predict. Without a known symmetrical distribution application of most computationally efficient robust outlier detection methods is challenging. This strain mode filter problem is herein solved using the derived concentrated modal estimator CME for robust modal filter .

The CME modal filter operates by a recursive sequence of steps to provide modal coordinate estimates from data which is closest to the computed in the algorithm step statistical multivariate center of the data. The derivation of the robust modal filter is comprised of an M step and concentration step. The M steps occur within each concentration step. The CME modal filter concentration step trims outliers and then within this concentration step there are multiple M estimation steps. As described below during M estimation the weights are computed based on the computed variance of the sensors . The weights used in M estimation downweight or upweight a particular sensor s importance when estimating the modal displacements. Importantly the M step requires the concentration step trimming of gross outliers based on trim criterion or it will fall into a local minimum and become biased. Therefore the M estimator and concentration estimator of CME modal filter work synergistically. These substeps are described in more detail below and the M step derivation is given first 

The CME modal filter utilizes M estimates within each concentration step. M estimators are well known gradient descent algorithms. They are computationally efficient affine equivariant robust to masking effects. The strain at measurement locations may be expanded as a summation of an infinite number of orthogonal strain mode shapes Eq. 0.33 .

Define the influence function x x as the differential of the objective function x . The influence function characterizes the proportional impact of the residuals on the estimate. The impact of an OLS residual on the estimate is directly proportional to the size of the residual which is why OLS is not robust. To find circumflex over q the summation given in 0.3 is differentiated by circumflex over q and is set equal to zero. By completing this the following equality is achieved See Eq. 0.4 .

Therefore the method of iteratively reweighted least squares IRLS is used to solve the optimization problem. This proceeds by solving for an initial least squares estimate circumflex over q and computing the residuals and weights. Using the weighted observations a new feature estimate circumflex over q is computed and the residuals and weights are recalculated. The features or modal displacements circumflex over q of the hyperplane approximately satisfying for all sensors Eq. 0.5 appears within a few iterations.

The solution of Eq. 0.5 must be computed within each concentration step c for the proposed concentrated estimator. To improve the convergence to the unbiased solution of circumflex over q sensors which are most outlying are completely removed. For the new group of sensors M estimation is used to find improved feature estimates. Selection of the influence function is critical to the M estimator s performance. For its gross outlier rejection capability Tukey s bisquare also known as biweight function is the preferred choice. The function is chosen to compute the weights with the residuals of the data. The bisquare weighting function w x x is defined for the ksensor as in Eq. 0.6 

The MAD for the kobservation is calculated as in Eq. 0.7 MED MED 0.6745 0.7 where the constant scaling 0.6745 is required to achieve a 37 Gaussian efficient consistent estimator of the standard absolute deviation. While relatively low efficiency the purpose of using MAD instead of using the true scale is to resist outliers. This it achieves remarkably well since the median is high breakdown. However The MAD is developed for symmetric distributions and does not address distribution skewness. This may be of concern since the explanatory data is multivariate skewed. Improvements of the MAD approximation for asymmetric long tailed distributions are available if necessary. Given the weights wthe linear system of equations is solved for circumflex over q given sensors in subset Sas in Eq. 0.8 .

The purpose of concentration is to iteratively remove poor observations and asymptotically approach the true statistical center of the data distribution. Utilizing sensors nearest to this centroid are assumed to give the best feature estimates. A best estimate of this center is the multivariate location T and dispersion V of the data. A redescending M estimator is a robust estimator of multivariate location and dispersion for theoretical asymmetric distributions.

Sensors furthest from this centroid are downweighted in Eq. 0.8 . However it is proposed to not just down weight sensors but to completely remove some gross outliers from consideration. The redescending M estimator does in fact equate weights to 0 for gross outliers. The weighted sensor removal methodology to improve gross outlier rejection is developed here. Let the k sensor data vector be defined as in Eq. 0.9 

For the estimated location and variance the squared Mahalanobis distance D a descriptive statistic that provides a relative measure of a data point s residual distance from a common point. is computed for every sensor data point k as in Eq. 0.12 . 0.12 This multivariate distance differs only from the Euclidean distance only in that it accounts for correlations between data points and is scale invariant. If the population has a multivariate normal distribution the Dis asymptotically approximated by a chi square distribution. With this knowledge statistical cutoff points from the inverse cumulative distribution can be determined. The initial distribution of Dmay be computed from the fixed modal matrix and time varying set of strain data with Gaussian noise. The maximum of the computed Dmay be used as an upper bound for removing gross outliers using iterative concentration. During each concentration step gross outliers are removed and the location and dispersion are re estimated. The sample location and dispersion more closely resemble the population location and dispersion. Therefore the small outliers become more pronounced. As the D x increases the sensor can be identified as an outlier and removed. Outliers missed by this trim procedure will more likely be down weighted in the M estimate See Eq. 0.8 . Finding the upper bound Dis time consuming to implement requiring 1 000s of simulations since the strain is time varying. Since most of the data is described by the constant strain data matrix an approximation can be used for the upper bound. It can be assumed that the distribution of D x k 1 . . . S is equal to or greater than the distribution of D x y z k 1 . . . S if the sensor data has a Gaussian error distribution. With this assumption the impact of an additional feature may be assumed to change the distribution of Dby the additional degree of freedom DOF impact in a chi square distribution. Recall that Dis given in units of variance. This implies that the variance will increase with the additional DOF. Therefore it can be assumed that D x y z n D x k 1 . . . S. Assuming the adjustment of n is due to the noise of the strain data the scalar upper bound is defined as in Eq. 0.13 

Robustness for multi stage estimators tends to come from good starts initial feature estimates . An initial feature estimate from a high breakdown estimator is used to start the M estimator for MM estimates. The median ball algorithm proposed by Olive 2004 uses feature estimates from sensors closest to the median as a robust start and is a good choice inasmuch as it works reasonably well for nominally skewed distributions. The first estimate of the system when is 0 i.e. when the sensor system is first operational is calculated with a non robust least squares estimate. Since the first estimate is assumed to come from a working sensor system it is a robust estimate. The initial robust feature estimate circumflex over q 0 is found by solving the least squares problem presented in Eq. 0.14 

During operation a robust start is paramount. A significant advantage of a time based sensor system is that previous close estimates are available. The most robust start will therefore be the estimate from the previous time step. This is because the strain change is assumed to be small between discrete time steps. Thus the robust starts between discrete time steps are implemented as in Eq. 0.15 1 0.15 where bis the total number of M steps chosen and cis the total number of concentration steps.

The importance of starts carries over into the concentration steps themselves. In order to be high breakdown each concentration step requires a robust start. Since the initial start circumflex over q 0 is robust the final estimates at the end of each of the concentration steps 

circumflex over q circumflex over q . . . circumflex over q are robust. This mean that the estimates of corresponding concentration steps are robust starts for respective next concentration steps 

circumflex over q circumflex over q . . . circumflex over q . Therefore the following inheritance rule See Eq. 0.16 is used to generate robust starts between concentration steps 0.16 

The full steps of the CME modal filter for any discrete time step are summarized in Algorithm 1 assuming that an initial OLS feature estimate has already been computed with Eq. 0.14 at time 0. 1 Algorithm 1

For each time step the M step iteration count bmay be initialized to be large so that a robust redescending M estimate initializes the CME modal filter . This improves the algorithm s stability during the concentration steps. Afterwards single M steps where bis equal to 1 may be utilized. This has the effect of improving computational efficiency.

The CME modal filter given by Algorithm 1 is robust estimator with more than 0.5 breakdown point given the use of robust starts which are estimates from previous time steps. By assuming that the initial estimate at time 0 occurs when the sensor system is operating normally the OLS estimate at time 0 is robust. This robust estimate is used as a robust start to the next time step the corresponding robust estimate is used for the start in the next time step and so on. Therefore robustness is guaranteed between time steps. Robustness is also guaranteed between concentration steps. Therefore iterative application of the robustness inheritance concept guarantees robustness through all concentration operations.

The CME modal filter outputs the modal coordinate estimates as an input to the Function Generator . The aircraft must also provide the network with local aerodynamic information and possibly fuel gauge information. The Function Generator takes the modal coordinates from CME modal filter and aerodynamic information and iteratively updates a functional relationship between the two.

The function generator approximates an unknown function of the modal coordinates F modal coordinates based on aerodynamic data such that the aerodynamic state F modal coordinates . Of course in order to determine what F is local aerodynamic data must be provided and so some measurement of aerodynamic state is necessary. Consequently aerodynamic state sensor s such as hot film strips or leading edge sensors for monitoring pressures over the wing surface for optimal drag configuration fuel rate sensors for fuel efficiency or any other suitable sensor s for measuring aerodynamic state are provided. For example given fuel rate sensors it is possible to form the functional relationship fuel rate F modal coordinates . Once the function generator approximates the function F it becomes possible to know where to command the modal coordinates to in order to achieve the optimal aerodynamic state e.g. optimal drag efficient shape .

The function generator is passed to the flight controller for analysis. From the analysis a minimum drag aircraft control surface configuration for fuel savings can be attained or flutter suppression etc. In effect aircraft inflight shape optimization becomes possible given the structural states measured. The function approximator may comprise a neural network that employs on line learning and computes functional relationship changes in the plant . The Flight Controller computes the required control surface deflections for an optimal drag configuration. An example of a aeroelastic control neural network is presented in U.S. Pat. No. 7 617 166 to Haudrich et al.

The function generator is input to a Flight Controller in the vehicle which may be an existing flight controller programmed with the requisite control modules of the present invention. Specifically Flight Controller includes a diagnostics and performance analyzer module which analyzes the function output from function generator and estimates the optimal modal coordinates to correct to as necessary to achieve performance optimization stability control measures needed to command the shape of the aircraft to an optimal shape. The optimal modal coordinates from performance analyzer module are sent to an Optimizer which is a function approximator similar to and can be interrogated to find the optimal control surface settings. Optimizer may likewise be a neural network or a less complex function solver such as a genetic algorithm. A genetic algorithm is a known method for finding globally optimal solutions for a given function. See e.g. Mitchell An Introduction to Genetic Algorithms Cambridge Mass. MIT Press 1996 . Finally the optimal control surface settings from Optimizer are sent to Command Shaping Module which computes the optimal flight system commands to implement the optimal shape and compiles the command set for input to the existing active control system.

The above described system has been verified with a simple FEM model of a wing developed using MATLAB Simulink . The wing model allowed the user to input aspects such as wing span and chord as well as number and location of control surfaces. The finite element model was coupled with an unsteady aerodynamics model and gust model captured by Rational Function Approximations RFAs of the generalized forces found through frequency based linear aerodynamic methods. Fighter aircraft type actuators were utilized for dynamic control surface simulation. State space models were formed and a simulated modal filtering system was designed. The state space models were also utilized for control design. The system was implemented with an array of fiber optics with FBG sensors. The wing model was structurally simple.

The above described system has been verified with a complex X 56A aircraft model as shown in . The design of the Command Shaping Module from is shown in . This architecture assumes a virtual deformation control architecture with modal reference tracking. Since deformation is directly related to modal displacements the significant modal displacements are commanded directly thereby leading to deformation changes in the vehicle. This is what is referred to by virtual deformation control architecture. Note that the FOS simulation and FOS Noice Simulations at right would be replaced by the FOSS Sensing System of in a real aircraft implementation.

Identification of significant modes in an aircraft structure is similar to that for a wing model. V g and V f plots or equivalent may be used to determine interacting modal coordinates and modal coordinates must be selected for feedback which contribute to flutter modal vibration and are within the actuator bandwidth. Selection of these modes can be an iterative process. Once feedback modes have been decided upon the state space matrices are updated. The matrix equation of motion of the aeroelastic system in discrete coordinates is given as in Eq. 0.17 . 0.17 Analogous to Euler s first law F ma or in this case ma F the left side of the aeroelastic system equation represents the structure s mass properties and applied motion while the right side represents the aerodynamics forces. The aero module includes several components such as aero paneling aero modes and gust modes as well as GAF calculation and RFA design. Points between the FE model and aero model are selected that accurately represent the force transferal from the aerodynamic control points to the structural grid points. This allows calculation of the GAFs from modal deformation at structural grid points. It is necessary to convert the frequency domain GAF to the Laplace domain. However the Laplace domain unsteady aerodynamics must be in a rational function form to be incorporated into the time domain state space equations of the aeroelastic system. Therefore the unsteady aerodynamic forces are approximated through the following RFA as in Eq. 0.18 .

Roger s method was chosen to compute the RFA. Constraints are applied at specific reduced frequencies such as at zero and aerodynamic derivatives may be matched using the ZAERO software system by Zona Technologies Inc. a software tool for advanced aeroelastic design and analysis by running open loop ASE analysis in frequency domain first e.g. normal flutter analysis and then comparing with open loop analysis in the time domain using state space models to ensure the RFA is accurate . The state vector is shown in Eq. 0.21 

where x t is a vector of airframe states x t is a vector of modal displacements x t is a vector of modal velocities x t is a vector of aerodynamic lag states and x t is formed from a vector of actuator accelerations velocities and displacements.

Trim conditions were applied to the nonlinear equations of motion to develop the state space models. The trim analysis ensures gravity is included into the model to provide more accurate flight responses for rigid body motion. In addition a 1G gravitational force was applied and the only free variable was the angle of attack. These conditions lead to a trim angle of attack and a trimmed elastic solution. Therefore all the state space models states are considered to be perturbations about this point.

The state space models must also model actuator dynamics. A third order transfer function of the actuators is formulated for each control surface to incorporate the actuator dynamics into the system. The actuator transfer function is represented in Eq. 0.22 .

Sensors which measure strain were also defined from modal matrix computations in NASTRAN a finite element analysis FEA program originally developed for NASA in the late 1960s . The shape modal matrices were converted to strain modal matrices. The known simulation modal coordinates are used to back out strain measurements assuming superposition for small strain. This was done in lieu of using actual fiber optic sensor strain measurements which would replace the above methodology.

The modification of the state space matrices for modal coordinate feedback is very similar to how the wing model state space matrices are modified. Consider the relationship of the strain based modal filter to the modal displacement state vector x t as in Eq. 0.24 0.24 where S x y z i 1 . . . N is a N N strain matrix with N strain modes s x y z is the measured strain and is a normal error. This represents the modal filter in its pseudo inverse form. Since the modal filter gives a partial state estimate of the full state vector x t as defined in Eq. 0.21 the form of the output matrix is simply identity for measured modes. The sensor output matrix C is a matrix of row vectors relating the sensory information to the state vector x t . The output matrix is adjusted for rigid body state feedback concurrent with modal deformation state feedback. It is assumed that m modes are retained for measurement. The output matrix is formed assuming all modal displacements x and airframe states x are measured as shown in Eq. 0.25 .

After selecting and modeling modal coordinates the state space matrices can be reduced in order and used to design the control laws. Similar to the wing model Example 1 control design can proceed with any desired control methodology. For the wing model the Optimal design methodology was chosen. See S. Skogestad and I. Postlethwaite West Sussex England John Wiley Sons Inc 2005. Once the controller has been designed which meets requirements the modal coordinates are also fixed. They can be used in the modal filter design.

The modal filter for the X 56A is in units of strain measured directly from the FOSS sensors . To utilize a strain mode matrix for modal filter the axial strain modes must be computed. The close proximity of the sensors of approximately one half inch along the SFOS gives a unique opportunity to calculate axial strain modes directly from the deformation at the sensor locations. An approximation of the strain mode matrix was made using the computed deformations for each mode shape at the sensor locations. This relies upon a simple strain to displacement relationship which is a derivative. This can also be done by fitting a shape polynomial to the surface and taking a derivative at the desired points.

The transformed mode shapes defined at sensor locations are collected to form the modal matrix. These mode shapes are pure elastic and thus are used to form a proper modal reference transformation. The modal reference command is shown in Eq. 0.26 0.26 where d x y z t is a vector of deformations from the un deformed aircraft corresponding to the index vector l in the pure elastic deformation modal matrix O.

Recall that each row of the modal matrix corresponds to a physical location on the aircraft x y z . The index of modes m corresponds to the index of modes within the modal matrix which the controller is designed to track. The selection of lis a research topic within itself. However here it is recommended to select points with high deformation in the commanded mode shapes. A better technique would also select points which minimized residual mode amplitudes. This completes the modal filter design methodology. The following sections put the presented modal filter design methodology into practice on the X 56A vehicle.

Once strain estimator has captured the modal displacements of sensors the Modal Filter computes the modal matrix or transformation matrix which is expressed as a sum of modal vectors.

The X56A is intentionally designed to encounter three flutter instabilities within its operating flight envelope body freedom flutter BFF symmetric wing bending torsion flutter SWBT and antisymmetric wing bending torsion flutter AWBT . BFF is a phenomenon where the rigid body mode of pitch and plunge couples with the elastic mode of first wing bending. The other two modes are traditional elastic flutter modes.

The BFF mode is demonstrated by the interaction of the scaled states rigid body heave state z and modal displacement SWB1. The flutter characteristics of the BFF mode are divergent oscillations of contributing modes at the same frequency out of phase.

The SWBT mode also illustrates the unfavorable coupling of modal displacements SW1B and SW1T. The nature of the coupling is difficult to discern because it appears random in nature. This means that there is an interaction with another mode likely the BFF mode.

The AWBT mode shows an in phase interaction of modal displacements AW1B and AW1T. The scaled modal amplitudes are small but clearly grow in time verifying that this flutter mode also exists at the design flight condition. Without control the aircraft will experience strong flutter instability and will require AFS at this speed.

The flutter modes indicate that four flexible modal displacements should be used for control feedback including SW1B SW1T AW1B and AW1T. However the frequencies of the anti symmetric modes are prohibitively high and close to the actuator bandwidth. Therefore only the symmetric 1bending and 1torsional modal displacements are selected for feedback. The requirements of the vehicle controller are now overviewed and a optimal controller is designed which can track both rigid body states and the first two modal displacements.

Since flutter is a potentially destructive phenomenon the modal controller must be robust to uncertainty. To reduce these uncertainties the following uncertainty requirements were defined 10 percent multiplicative uncertainty on the inputs and outputs and 10 percent additive uncertainty on the scaled plant. In addition the controller must be robust to a 3 percent speed variation. The controller must also achieve robust performance despite the aforementioned uncertainty conditions. The uncertain plant and required control system may be tested using the construct summarized in . This represents the requirements which the controller must meet and not necessarily how it is designed. Note that for other aircraft these requirements may change.

The robust stability condition which must be met for the p optimal controller is given as in Eq. 0.27 . 

To improve rejection of control input uncertainty the controller was designed around the plant construct shown in .

The design plant G at the design speed V was of order . To improve controller synthesis Gwas scaled by the full range of actuator movement and expected sensor output changes. The translational states x y and z and the velocity state were removed from the model. With the resulting 126th order model balanced reduction was performed to bring the model order to 90 states. The selected states to be tracked were SW1B and SW1T modal displacements pitch angle and bank angle . The angle of attack angle of sideslip and yaw angle were also sensed but were chosen to be suppressed.

Traditional proper weights from a mixed H synthesis were utilized along with multiplicative uncertainty at the plant inputs. The input uncertainty weight W was adjusted to achieve maximum amplitude near the actuator break frequency. Sensitivity weight W was adjusted for integral tracking on tracking states and for suppression on suppression states.

It was found that the break frequencies of the modal displacement performance weights had to be increased 10 rad s relative to the airframe state weight break frequencies of 1 rad s. The break frequency of the control weight W was adjusted to 5 rad s for reduced control surface movement. The break frequency of the complementary sensitivity weight W was set to 30 rad s to improve high frequency noise rejection. The uncertainty transfer function N was calculated to be as shown in Eq. 0.31 

For this control design architecture the optimal controller was computed using MATLAB s Robust Control Tool Box. To find the controller a DK iteration was performed as per S. Skogestad and I. Postlethwaite West Sussex England John Wiley Sons Inc. 2005 which solves the iterative optimization problem shown in Eq. 0.32 .

The DK iteration resulted in a 162th order controller after some trial and error with the weights in . The controller was then internally balanced and truncated to 44 states without a substantial loss of robustness or performance. This resulted in an H norm of 3.29.

A concentrated modal estimator CME was then developed to form the basis for CME Modal Filter . The CME is primarily a concentration algorithm with re descending M estimates used in place of OLS within the concentration steps. The CME utilizes a fixed trim criterion and a more robust start to address asymmetry of the strain mode matrix data. For the X 56A sensor system fourteen modal displacement features are included in the strain mode matrix corresponding to 1 530 sensor entries. Therefore the problem is computationally burdensome and also multivariate. The strain at measurement locations may be expanded as a summation of an infinite number of orthogonal strain mode shapes See Eq. 0.33 .

Define the influence function x x as the differential of the objective function x . The influence function characterizes the proportional impact of the residuals on the estimate. To find circumflex over q the summation given in 0.3 is differentiated bye circumflex over q and is set equal to zero. By completing this the following equality is achieved See Eq. 0.4 .

The solution of Eq. 0.5 must be computed within each concentration step c for the proposed CME estimator. To improve the convergence to the unbiased solution of circumflex over q sensors which are most outlying are completely removed. For the new group of sensors M estimation is used to find improved feature estimates. Selection of the influence function is critical to the CME estimator s performance.

For its gross outlier rejection capability Tukey s bisquare function is chosen to compute the weights with the residuals of the data. The bisquare weighting function w x x is defined for the ksensor as in Eq. 0.6 

The MAD for the kobservation is calculated as in Eq. 0.7 MED MED 0.6745 0.40 where the constant scaling 0.6745 is required to achieve a 37 Gaussian efficient consistent estimator of the standard absolute deviation 249 . While relatively low efficiency the purpose of using MAD instead of using the true scale is to resist outliers. This it achieves remarkably well since the median is high breakdown.

However The MAD is developed for symmetric distributions and does not address distribution skewness. This may be of concern since the explanatory data is multivariate skewed. Improvements of the MAD approximation for asymmetric long tailed distributions are available if necessary. Given the weights wthe linear system of equations is solved for circumflex over q given sensors in subset Sas in Eq. 0.8 .

The purpose of concentration is to iteratively remove poor observations and asymptotically approach the true statistical center of the data distribution. The foregoing estimate is used to trim data through concentration before reapplying M estimation. Utilizing sensors nearest to this centroid are assumed to give the best feature estimates. A best estimate of this center is the multivariate location T and dispersion V of the data. Sensors furthest from this centroid are downweighted in Eq. 0.8 . However it is proposed to not just down weight sensors but to completely remove gross outliers from consideration. The redescending M estimator does in fact equate weights to 0 for gross outliers. Let the ksensor data vector be defined as in Eq. 0.9 

Defining the data vector in this way ensures that outliers which depend on sensor readings shall not occur in the explanatory data. Only fixed outliers can occur in the explanatory data which are to be addressed with a fixed trim criterion. From any sample sensor set SS a location vector See Eq. 0.10 

For the estimated location and variance the squared Mahalanobis distance D is computed for every sensor data point k as in Eq. 0.12 . 0.45 

This multivariate distance differs only from the Euclidean distance only in that it accounts for correlations between data points and is scale invariant. If the population has a multivariate normal distribution the Dis approximated and statistical cutoff points can be determined. The initial distribution of Dmay be computed from the fixed modal matrix and time varying set of strain data with Gaussian noise. The maximum of the computed Dmay be used as a upper bound for removing gross outliers. During each concentration step gross outliers are removed and the location and dispersion are re estimated. The sample location and dispersion more closely resemble the population location and dispersion. Therefore the small outliers become more pronounced. As the D x increases the sensor can be identified as an outlier and removed. Outliers missed by this trim procedure will more likely be down weighted in the M estimate See Eq. 0.8 . An approximation is used for the upper bound D. It can be assumed that the distribution of D x k 1 . . . S is equal to or greater than the distribution of D x y z k 1 . . . S if the sensor data has a Gaussian error distribution. Recall that Dis given in units of variance. This implies that the variance will increase with the additional DOF. Therefore it can be assumed that D x y z n D x k 1 . . . S. Assuming the adjustment of n is due to the noise of the strain data the scalar upper bound is defined as in Eq. 0.13 

Robustness for multi stage estimators tends to come from good starts initial feature estimates . The first estimate of the system when is 0 i.e. when the sensor system is first operational is calculated with a non robust least squares estimate. Since the first estimate is assumed to come from a working sensor system it is a robust estimate. The initial robust feature estimate circumflex over q 0 is found by solving the least squares problem presented in Eq. 0.14 

During operation a robust start is paramount. A significant advantage of a time based sensor system is that previous close estimates are available. The most robust start will therefore be the estimate from the previous time step. This is because the strain change is assumed to be small between discrete time steps. Thus the robust starts between discrete time steps are implemented as in Eq. 0.15 1 0.48 where bis the total number of M steps chosen and cis the total number of concentration steps.

The importance of starts carries over into the concentration steps themselves. In order to be high breakdown each concentration step requires a robust start. Since the initial start circumflex over q 0 is robust the final estimates at the end of each of the concentration steps circumflex over q circumflex over q . . . circumflex over q are robust 205 .

This mean that the estimates of corresponding concentration steps are robust starts for respective next concentration steps circumflex over q circumflex over q . . . circumflex over q . Therefore the following inheritance rule See Eq. 0.16 is used to generate robust starts between concentration steps 0.48 The full steps of the CME for any discrete time step are summarized in Algorithm 1 assuming that an initial OLS feature estimate has already been computed with Eq. 0.14 at time 0. 1 Algorithm 1

It should now be apparent that the above described system integrates modal filtering and distributed sensing to monitor an array of sensors using a robust modal filter in real time immune to asymmetric sensor noise and sensor failures. The invention provides a practical real time approach to monitor the complex dynamics of a flexible aircraft using a robust modal filtering architecture and a computationally efficient concentration based and M estimator based robust algorithm.

It should be understood that various changes may be made in the form details arrangement and proportions of the components. Such changes do not depart from the scope of the invention which comprises the matter shown and described herein and set forth in the appended claims.

