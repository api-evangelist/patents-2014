---

title: Surface and image integration for model evaluation and landmark determination
abstract: Embodiments of the present disclosure provide a software program that displays both a volume as images and segmentation results as surface models in 3D. Multiple 2D slices are extracted from the 3D volume. The 2D slices may be interactively rotated by the user to best follow an oblique structure. The 2D slices can “cut” the surface models from the segmentation so that only half of the models are displayed. The border curves resulting from the cuts are displayed in the 2D slices. The user may click a point on the surface model to designate a landmark point. The corresponding location of the point is highlighted in the 2D slices. A 2D slice can be reoriented such that the line lies in the slice. The user can then further evaluate or refine the landmark points based on both surface and image information.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09454643&OS=09454643&RS=09454643
owner: Smith & Nephew, Inc.
number: 09454643
owner_city: Memphis
owner_country: US
publication_date: 20140505
---
This application claims the benefit of U.S. Provisional Application No. 61 818 541 filed on May 2 2013 which is hereby incorporated herein by reference in its entirety.

Patient specific modeling is used in connection with surgical and orthopedic procedures to plan a surgery or to design instruments and implants for the surgery. A patient specific model allows a surgeon to account for variation in anatomy between patients by first modeling the portion of the body at which the surgery is carried out. The surgical procedure can be precisely planned by tailoring the approach and instruments to particular variations in the patient s anatomy that may otherwise cause difficulties during a standard procedure. As a first step in the process the patient s anatomy is imaged by standard medical technology for example using an MRI or a CT scanning machine in order to obtain a data set that is representative of the patient s anatomy. The data set that is obtained indicates any particular variations or nuances in the patient s anatomy and processing that data can provide a surgeon with a detailed map of the relevant body portion ahead of time.

The imaging data obtained from the patient s anatomy is processed to create a model of the patient s anatomy that is used to plan the procedure. The raw data set can be processed in a number of different ways including filtering interpolation sampling and other data processing procedures that turn the data into a digital anatomy model for the surgeon s use. One particular processing approach is image segmentation in which the full data set is analyzed in blocks with each block representing a different area of the relevant anatomy. These processing techniques including segmentation can introduce errors into the model as a result of the estimation that compresses and otherwise processes the data. For example there may be rounding or smoothing effects that create a smooth surface in the model that does not account for the deviations from that smooth surface that are actually present in the patient s anatomy.

For some procedures patient implants and instrumentation such as surgical guides are designed to match a specific patient s bone anatomy. In these cases accurate models can be helpful to create an implant or surgical guide that will closely interface with the patient s bone. Any deviations or variations between the model and the actual anatomy particularly in areas where the implant or surgical guide interfaces with the bone may reduce the effectiveness of the surgical procedure. For such applications it would be helpful to have an indication not only of the patient s estimated anatomy but also an indication of how closely the modeled anatomy maps to the real anatomy.

Disclosed herein are systems devices and methods for surface and image integration for model evaluation and landmark determination. Embodiments of the present disclosure provide a software program that displays both a volume as images and segmentation results as surface models in 3D together as an integrated image. Multiple 2D slices can be extracted from the 3D volume. The 2D slices can cut the surface models from the segmentation so that only a portion e.g. half of the models are displayed. The border curves resulting from the cuts are displayed in the 2D slices enabling evaluation of surface accuracy against the raw image data in any plane. Additionally the systems devices and methods may allow a user to select a point on a surface model to designate a landmark point.

According to one aspect a method for determining the accuracy of image segmentation includes receiving raw image data representative of a patient s joint processing the image data to create a three dimensional surface model of a portion of the patient s joint displaying the raw image data and the surface model together on a monitor as an integrated image intersecting the integrated image with a plane oblique to the raw image data and comparing the intersection of the raw image data and the plane with the intersection of the surface model and the plane. The raw image data may be captured along a patient s transverse plane sagittal plane or coronal plane. The raw image data and the surface model may be displayed using different respective colors. In certain implementations the processing includes image filtering or enhancement followed by image segmentation followed by surface triangulation.

In certain implementations the method includes selectively removing the three dimensional surface model from the display. In certain implementations processing the image data includes deriving image data by interpolating between image slices. In certain implementations the method also includes re segmenting the raw image data and recreating a three dimensional surface model of a portion of the patient s joint. In certain implementations the method includes placing a marker or line on the surface model of the patient s joint. In certain implementations the marker is placed on a visual representation of the patient s distal femoral epicondyles and a line is drawn through the condyles. In certain implementations after the line is drawn a plane oblique to the raw image data is reoriented such that the line lies within the plane. In certain implementations the method includes identifying anatomic landmarks on the surface model. In certain implementations the method includes identifying ligament attachment points on the surface model.

According to another aspect a system for determining the accuracy of image segmentation includes a processor configured to receive raw image data representative of a patient s joint process the image data to create a three dimensional surface model of a portion of the patient s joint intersect the integrated image with a plane oblique to the raw image data and compare the intersection of the raw image data and the plane with the intersection of the surface model and the plane and a monitor configured to display the raw image data and the surface model together on a monitor as an integrated image. In certain implementations the raw image data is captured along a patient s transverse plane sagittal plane or coronal plane. In certain implementations the raw image data and the surface model are displayed using different respective colors. In certain implementations processing the image data comprises image filtering or enhancement followed by image segmentation followed by surface triangulation.

In certain implementations the processor is further configured to selectively remove the three dimensional surface model from the display. In certain implementations processing the image data includes deriving image data by interpolating between image slices. In certain implementations the processor is further configured to re segment the raw image data and recreate a three dimensional surface model of a portion of the patient s joint.

In certain implementations the processor is further configured to place a marker or line on the surface model of the patient s joint. The marker may be placed on a visual representation of the patient s distal femoral epicondyles and a line may be drawn through the condyles. After the line is drawn a plane oblique to the raw image data may be reoriented such that the line lies within the plane. In certain implementations the processor is further configured to identify anatomic landmarks on the surface model. In certain implementations the processor is further configured to identify ligament attachment points on the surface model.

According to another aspect a system for determining the accuracy of image segmentation includes means for receiving raw image data representative of a patient s joint means for processing the image data to create a three dimensional surface model of a portion of the patient s joint means for displaying the raw image data and the surface model together on a monitor as an integrated image means for intersecting the integrated image with a plane oblique to the raw image data and means for comparing the intersection of the raw image data and the plane with the intersection of the surface model and the plane. The received raw image data may be captured along a patient s transverse plane sagittal plane or coronal plane. The raw image data and the surface model are displayed using different respective colors. In certain implementations processing the image data comprises image filtering or enhancement followed by image segmentation followed by surface triangulation.

In certain implementations the system includes means for selectively removing the three dimensional surface model from the display. Processing the image data may include deriving image data by interpolating between image slices. In certain implementations the system includes means for re segmenting the raw image data and recreating a three dimensional surface model of a portion of the patient s joint. In certain implementations the system includes means for placing a marker or line on the surface model of the patient s joint. The marker may be placed on a visual representation of the patient s distal femoral epicondyles and a line may be drawn through the condyles. After the line is drawn a plane oblique to the raw image data may be reoriented such that the line lies within the plane. In certain implementations the system includes means for identifying anatomic landmarks on the surface model. In certain implementations the system includes means for identifying ligament attachment points on the surface model.

Variations and modifications will occur to those of skill in the art after reviewing this disclosure. The disclosed features may be implemented in any combination and subcombination including multiple dependent combinations and subcombinations with one or more other features described herein. The various features described or illustrated above including any components thereof may be combined or integrated in other systems. Moreover certain features may be omitted or not implemented.

To provide an overall understanding of the systems devices and methods described herein certain illustrative embodiments will be described. Although the embodiments and features described herein are specifically described for use in connection with identifying anatomical landmarks in image data for a patient s knee joint it will be understood that the approaches disclosed are applicable to other anatomical joints as well. Moreover the approaches outlined below may be applied to preparing patient matched medical devices and implants to be used in surgical procedures including but not limited to knee acetabular spine arthroplasty cranio maxillofacial surgical procedures shoulder arthroplasty as well as foot ankle hand and other extremity procedures. The following description of the depicted embodiment s is merely exemplary in nature and is in no way intended as limiting.

Embodiments of the present invention provide a software program that displays both a volume as images and segmentation results as surface models in 3D together as an integrated image. Multiple 2D slices can be extracted from the 3D volume. The 2D slices may have different locations and orientations and also may be moved using a mouse touchscreen and or keyboard by a user. The 2D slices may be interactively rotated by the user to best follow an oblique structure. The 2D slices can cut the surface models from the segmentation so that only half of the models are displayed. The border curves resulting from the cuts are displayed in the 2D slices enabling evaluation of surface accuracy against the raw image data in any plane. The user may click a point on the surface model to designate a landmark point. The corresponding location of the point is highlighted in the 2D slices. A user may pick two landmark points to determine a line and a 2D slice is reoriented such that the line lies in the slice. The user can then further evaluate refine the landmark points based on both surface and image information. Alternatively a user may draw a line by hand and a 2D slice is reoriented such that the line lies in the slice. For example a user may trace Whiteside s line by hand.

In some embodiments the software program may be used to determine the best landmarks for implant positioning. For example if the posterior most point of the condyles has cartilage damage it might be difficult to determine the original surface of the cartilage and the plane orthogonal to the mechanical axis. The 2D slices may be moved using a mouse touchscreen and or keyboard by a user. The 2D slices may be interactively rotated by the user to view different landmarks. The 2D slices can cut the surface models from the segmentation so that only half of the models are displayed relative to different landmarks. The border curves resulting from the cuts are displayed in the 2D slices enabling evaluation of surface accuracy in the area of different landmarks against the raw image data in any plane.

In one particular embodiment displaying both the volume data and the surface model allows for the evaluation of osteophytes. The evaluation of osteophytes may be used in the area of patient matched instruments and or patient matched implants. A patient matched instrument such as a femoral custom cutting block may accommodate bone osteophytes. The implant however whether standard or patient matched should not be mounted on an osteophyte. Thus the patient matched instrument may be designed to fit any osteophytes but the osteophyte may be removed or the implant may be reshaped for fit of the implant. The 2D slices can cut the surface models from the segmentation so that only half of the models are displayed relative to bone and or bone osteophytes. The border curves resulting from the cuts are displayed in the 2D slices enabling evaluation of surface accuracy in the area of potential bone osteophytes against the raw image data in any plane.

In the particular embodiment illustrated the information received at step includes one or both of DICOM raw data as well as processed data obtained from an MRI. In this particular embodiment this data includes sufficient information to identify and characterize in three dimensions relevant surfaces and other features of the patient s anatomy. Non limiting examples of such surfaces and other features include articular surfaces of the femur tibia and patella e.g. medial and lateral condylar surfaces on the femur and corresponding articular surfaces on the tibia the trochlear groove on the femur and corresponding articular surfaces on the patella non articular surfaces of such anatomy and other features of such anatomy e.g. tibial tubercle tibial eminence . In some embodiments the MRI data may be sufficient to identify bone surfaces cartilage surfaces bone cartilage interfaces or other interfaces between different tissues and structures of the anatomy.

In this particular embodiment the DICOM raw data and or processed data obtained from the MRI also includes sufficient detail to distinguish and locate in three dimensions locations e.g. points or areas where soft tissues e.g. ligaments and or tendons attach to the bony anatomy. Such attachment locations may include in embodiments related to knee arthroplasty without limitation attachment locations of the anterior and posterior cruciate ligaments deep and superficial attachment locations of the medial collateral ligament attachment locations of the lateral collateral ligament insertion locations of the popliteal tendon muscle the iliotibial band insertion location the patellar ligament attachment locations and the quad tendon insertion location on the patella.

In some embodiments an MRI scan protocol with specific scan parameters e.g. the field of view FOV slice thickness matrix field strength scan plane scan time bandwidth etc. is utilized to accurately produce detailed images of biological structures of interest tendons ligaments muscles cartilage and bones . The MRI scan may be performed with the patient lying supine feet first with his or her leg in full extension and knee joint straight. In some embodiments any leg movement will be restricted as much as possible using padding and immobilization devices. The knee joint may be centered in a knee MRI coil and the coil may be positioned as close to isocenter as possible.

In some embodiments the information received at step may include data sufficient to correlate a position and orientation of a mechanical axis of the patient s leg to the imaging data of the patient s joint of interest. This additional data may be obtained by an x ray of the patient s full leg including the hip and ankle joints or in other manners such as a full length MRI or CT.

In the particular embodiment shown the information received at step also may include other information about the patient and or the surgeon s preferences about the orthopedic procedure. Such additional information may include information identifying the patient identifying the surgeon acceptable tolerances to the surgeon e.g. amount of overhang underhang permissible for implant coverage fit relative importance of various orthopedic responses to the surgeon discussed further below surgeon preferences regarding varus valgus alignment femoral rotation implant position and orientation resections sizing upsize downsize soft and hard tissues analysis bone strength DXA scores hormone blood markers levels demographic information including age sex gender race ethnicity past medical history and comorbidities smoking allergies hormonal status hormone medications genetics family history etc.

The enhanced patient data set may be part of the same step as step or a separate step. The data received may reflect information that is not included in the standard patient data received at step but that is used in the processes of . This enhanced data may include without limitation data reflecting the patient s gait foot mechanics patient anthropometrics patient lifestyle e.g. level of activity types of common activities etc. physiological attributes e.g. collagen levels in tissue as indicator of ligament strength presence and characterization of previous injuries co morbidity data concerning other joint functionality or lack thereof or other types of data about the patient.

In some embodiments the standard and enhanced data sets received in steps may be collected using a web or other computer based interface allowing a user such as a surgeon doctor s assistant or other user to input and or upload this data. Other data collection methods may also be utilized. In some embodiments the types of data collected may change. For instance in some embodiments algorithms used for the biomechanic and anatomic fit optimizers may be updated such that different types of enhanced data are required for inputs to the optimizers which again are discussed in further detail below. In such instances the data collection interface whether web based or otherwise may be quickly and easily updated to reflect the different information needed.

Step is an optional step and may be omitted in some embodiments. In step the raw image data is filtered and enhanced. As examples the raw image data may be smoothed edges may be enhanced the data may be filtered according to gray scale gradient or combinations thereof.

Returning to in step the image data may be processed to create a three dimensional model e.g. a CAD model of the patient s joint or at least portions thereof. The three dimensional model may be created by segmenting or otherwise processing the imaging data to reconstruct the geometry and shape or otherwise define the relevant surfaces and other morphological aspects of the patient s anatomy. Such segmenting may be accomplished by manual automated or semi automated processes. In some embodiments segmentation may be facilitated by software packages available from for instance Able Software Corp of Lexington Mass. 3D doctor Materialise of Leuven Belgium Mimics Boykov Kolmogorov Max Flow algorithm or other software. In some embodiments other techniques may be used to process imaging data such as threshold based image processing probabilistic atlas based statistical shape modeling based or other techniques. Some embodiments may at least partially utilize Matlab based processes of MathWorks Inc. Natick Mass. as part of such techniques.

In step the volume data is converted to surface data to create the polygonal representation. As examples the conversion may occur using the CRUST algorithm or MARCHING CUBES algorithm.

Step is an optional step and may be omitted in some embodiments. In step the surface model may be post processed. Post processing typically includes surface editing hole filling decimation and smoothing. Due to the voxelated nature of the model creation some artifacts appear in the initial geometry. Smoothing removes these artifacts while preserving volume to allow for a more realistic appearance and to facilitate downstream processes that rely on smooth surfaces. Decimation is the process by which the overall number of triangles is reduced to allow for faster processing. As an example all or part of the post processing step may be accomplished using the software GEOMAGIC STUDIO. GEOMAGIC STUDIO is a registered trademark of Geomagic Inc. of Research Triangle Park N.C.

In some embodiments a model of the patient s joint may be created by identifying a set of points and or dimensions in or from the image data rather than segmenting the joint surfaces in detail. For instance in some embodiments only certain key reference points and or dimensions are necessary inputs to the optimization sub processes described below and thus only these reference points and dimensions need to be identified from the patient specific data whether image or other types of data .

In some embodiments the imaging data or other information concerning the patient may be processed to identify additional qualitative or quantitative information for incorporation into or other use with the three dimensional model such as but not limited to a position and or orientation of the mechanical axis of the patient s leg relative to the three dimensional joint model and other reference frame information e.g. identification of particular reference points axes or other constructs with respect to the three dimensional anatomic model . In some embodiments the mechanical axis of the leg and its relationship to the model of the patient s knee can be determined by overlaying a full leg x ray of the patient on the three dimensional model.

At step the imaging data may also be processed to identify ligamentous tissue ligament attachment locations and or other soft tissue attachment locations relative to the three dimensional model. In some embodiments step may be performed simultaneously or otherwise in conjunction with other processing done to the MRI data. Moreover as with the segmentation processes identification of the ligament attachment locations may be done manually semi automatically or using fully automated functionality.

In some embodiments the image data and other information received concerning the particular patient may be further processed such that the three dimensional model incorporates or otherwise reflects other information such as information relating to mechanical properties of bone e.g. bone density cartilage and soft tissues.

In portion the volume data and surface data is manipulated to create intersections or cuts for displaying only portions of the surface data . The orthogonal slice cuts the smoothed data and the unsmoothed data . Further the oblique slice cuts the smoothed data and the unsmoothed data . The portion is then used to create the half surfaces and the border curves .

A user manipulates the display environment . The user has the option to display one or more of the original slice an interpolated parallel slice an interpolated orthogonal slice an interpolated oblique slice a half surface a border curve unsmoothed surface data and smoothed surface data. For example each part of the display environment may be on a layer and the user may turn on or off selected layers. By turning on key layers a user may visualize key portions of anatomy or landmarks. As the surface model is created from the volume data both data sets have the same coordinated system and are therefore automatically registered with one another. The volume data and the surface model can thus be displayed together as an integrated image.

Additional details of the API are illustrated in . The API is used to intersect the created slice with a portion of the surface data such as a model . In the depicted embodiment the VTK algorithm executes the cutter operation. This results in a model with two parts Model and Model . The models are sent to program which selects one of them based on user view orientation to display .

As shown in the API also creates border curves to highlight edges of the model after intersection according to certain embodiments. The API computes the intersection of the created slice with the model to create border curves . In the depicted embodiment the VTK algorithm executes the stripper operation. The API sends the border curves to the program .

In an alternative embodiment the same software program is extended to allow the users to segment structures from any of the orthogonal oblique slices. The same software program is used to evaluate the effect of smoothing the surface using a third party tool.

The foregoing is merely illustrative of the principles of the disclosure and the systems devices and methods can be practiced by other than the described embodiments which are presented for purposes of illustration and not of limitation. It is to be understood that the systems devices and methods disclosed herein while shown for use in knee arthroplasty may be applied to systems devices and methods to be used in other surgical procedures including but not limited to spine arthroplasty cranio maxillofacial surgical procedures acetabular systems shoulder arthroplasty as well as foot ankle hand and extremities procedures.

Variations and modifications will occur to those of skill in the art after reviewing this disclosure. The disclosed features may be implemented in any combination and subcombination including multiple dependent combinations and subcombinations with one or more other features described herein. The various features described or illustrated above including any components thereof may be combined or integrated in other systems. Moreover certain features may be omitted or not implemented.

Examples of changes substitutions and alterations are ascertainable by one skilled in the art and could be made without departing from the scope of the information disclosed herein. All references cited herein are incorporated by reference in their entirety and made part of this application.

