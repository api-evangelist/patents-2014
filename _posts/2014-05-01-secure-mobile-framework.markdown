---

title: Secure mobile framework
abstract: Systems and methods for a secure mobile framework to securely connect applications running on mobile devices to services within an enterprise are provided. Various embodiments provide mechanisms of securitizing data and communication between mobile devices and end point services accessed from a gateway of responsible authorization, authentication, anomaly detection, fraud detection, and policy management. Some embodiments provide for the integration of server and client side security mechanisms, binding of a user/application/device to an endpoint service along with multiple encryption mechanisms. For example, the secure mobile framework provides a secure container on the mobile device, secure files, a virtual file system partition, a multiple level authentication approach (e.g., to access a secure container on the mobile device and to access enterprise services), and a server side fraud detection system.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09473533&OS=09473533&RS=09473533
owner: SNCR, LLC
number: 09473533
owner_city: Bridgewater
owner_country: US
publication_date: 20140501
---
This application is a divisional of U.S. patent application Ser. No. 13 854 837 filed Apr. 1 2014 which claims priority to U.S. Provisional Application Ser. No. 61 618 511 filed Mar. 30 2012 and U.S. Provisional Application Ser. No. 61 806 763 filed Mar. 29 2013. The entire contents of the above applications are incorporated herein by reference for all purposes.

Various embodiments of the present invention generally relate to mobile devices. More specifically some embodiments of the present invention relate to a secure mobile framework for securely connecting applications running on mobile devices to services within an enterprise.

Many companies or enterprises are either providing mobile devices e.g. smartphones tablets etc. to employees or allowing employees to bring their own mobile device. However allowing employees to access services within the company through a mobile device has increased the company s exposure to potential security breaches. For example if an employee lost their mobile device an unauthorized party could retrieve any unsecured data on the phone and potentially access services within the company. As another example if the employee leaves the company and does not give back the mobile device the former employee could still potentially access sensitive data stored on the device or within the company.

In order to mitigate this type of unauthorized access many companies use mobile device management MDM policies to restrict control of the mobile devices and thereby reduce potential security risks for mobile devices that are capable of connecting to services within the enterprise. The MDM policies that are set by the enterprise control and protect data through management of the configuration settings of the mobile devices. In order to manage the configuration settings over the air programming OTA capabilities are often used. The use of OTA capabilities allows the enterprise to remotely configure a single mobile device or an entire fleet of mobile devices to send software and OS updates and to remotely lock and wipe a device in order to protect the data stored on the device when it is lost or stolen etc.

However the restrictions imposed by the MDM polices can be cumbersome to the user who may also be using the device in a personal capacity. For example an MDM policy may require the mobile device to auto lock and prompt the user to provide a password with a particular set of characteristics before the mobile device is unlocked. The user may find these restrictions annoying. As such there are a number of challenges and inefficiencies created in traditional mobile device management.

Systems and methods are described for a secure mobile framework capable of securely connecting applications running on mobile devices to services e.g. an e mail service a trading service or a reservation service within an enterprise. In some embodiments an authentication request from a remote device to access a service provided by an enterprise can be received at a gateway associated with the enterprise. The request can originate from an enterprise managed application running on the remote device. A framework authentication token and security policy e.g. password structure password duration access controls for an application and or secure container of data etc. can be generated.

The security policy can be based on the service provided by the enterprise that the remote device is requesting to access. The framework authentication token and the security policy can then be transmitted to the remote device which ensures compliance with the security policy before generating a connection request to connect to the service within the enterprise. The connection request can be based on the framework authentication token and the security policy. A service authenticator determines if the application running on the remote device is authorized to access the service. Some embodiments monitor interactions between the enterprise managed application and the service. Upon detecting a violation of one or more fraud policies at the mobile device and or gateway an elevated authentication request can be generated.

In some embodiments a request can be received from an initiating device to establish a service connection between an enterprise managed application running on the initiating device and an enterprise service. The request includes authentication credentials associated with an end user. A framework authentication token can be generated and transmitted to the initiating device wherein upon receipt the initiating device initiates a service connection request based on the authentication token. A secure connection can be created between the enterprise service and the initiating device upon successful validation e.g. authorization and authentication of the service connection request. Any data transmitted to the initiating device using the stored connection can be stored within a secure container that is only accessible by the enterprise managed application.

Embodiments of the present invention also include computer readable storage media containing sets of instructions to cause one or more processors to perform the methods variations of the methods and other operations described herein.

In various embodiments a system can include a gateway an authenticator a token generator a communications module a discovery service and or a fraud detection module. The gateway can be configured to provide remote devices access to services of an enterprise. In some embodiments the gateway can include multiple levels each of which provides isolated authentication protocols and activity logging. The remote devices can have stored thereon one or more applications managed by the enterprise. The authenticator can be configured to determine if a user is authorized to access the enterprise and to construct policies regarding the management of the one or more applications.

The token generator can be configured to generate one or more tokens e.g. authentication token a user binding token and or a framework authentication token for creating secure connections between one or more applications managed by the enterprise and servers. The tokens can be based on various identifiers such as but not limited to the following user identifier device identifiers device type identifiers application family identifiers etc. Some tokens may include a binding of other tokens. For example in one embodiment a framework authentication token can be based on an enterprise authentication token a user binding token and or a framework authentication token expiration date. In some embodiments one or more of the tokens may be cryptographically secured e.g. digitally signed that allow for the system to detect if the tokens have been tampered with or altered.

The communications module can be configured to communicate the policies to the remote devices. The discovery service can be configured to determine which of the services of the enterprise to connect with the one or more applications. The anomaly detector can be configured to monitor activity between the remote devices and the servers and generate an indicator of anomalies in activity. For example the anomaly detector may monitor the IP velocity of the user failed log in attempts etc.

While multiple embodiments are disclosed still other embodiments of the present invention will become apparent to those skilled in the art from the following detailed description which shows and describes illustrative embodiments of the invention. As will be realized the invention is capable of modifications in various aspects all without departing from the scope of the present invention. Accordingly the drawings and detailed description are to be regarded as illustrative in nature and not restrictive.

The drawings have not necessarily been drawn to scale. For example the dimensions of some of the elements in the figures may be expanded or reduced to help improve the understanding of the embodiments of the present invention. Similarly some components and or operations may be separated into different blocks or combined into a single block for the purposes of discussion of some of the embodiments of the present invention. Moreover while the invention is amenable to various modifications and alternative forms specific embodiments have been shown by way of example in the drawings and are described in detail below. The intention however is not to limit the invention to the particular embodiments described. On the contrary the invention is intended to cover all modifications equivalents and alternatives falling within the scope of the invention as defined by the appended claims.

Various embodiments of the present invention relate generally to a secure mobile framework capable of securely connecting applications running on mobile devices to services within an enterprise. Some examples of services provided by an enterprise include but are not limited to an e mail service a trading service a payment processing service a customer relationship management service an inventory system service a business intelligence service a healthcare service a student information service a reservation service secure services and or other services containing sensitive information. In accordance with some embodiments the secure mobile framework provides a collection of software libraries and service components which provide software developers the ability to build secure applications on non enterprise mobile devices. The secure mobile framework can be used in conjunction by enterprises that have firewalled content services and network from the public network through means of a DMZ type architecture. As a result much of the enterprise s existing authentication and authorization systems can be utilized. Client and server libraries can be utilized or extended to provide secure storage and communication in both the client and server applications.

There are a number of enterprises which through internal policy or regulation need to ensure that enterprise content and communication is protected managed and monitored. Normally for devices managed by the enterprise the aforementioned control requirements are directly implemented through device and operating system OS management. However for devices which are not managed by the enterprise and cannot connect directly to the enterprise network there is a need to ensure that the same controls are applied to enterprise applications running on these unmanaged devices.

In accordance with various embodiments the secure mobile framework can provide one or more of the following features to connect and utilize services within the enterprise 1 mechanisms to store enterprise content on device in a protected manner whereby the enterprise content can only be accessed by authorized users possibly offline and be managed through enterprise policy 2 mechanisms to provide multiple authentications against the gateway i.e. framework authentication and against the enterprise services i.e. enterprise authentication provide secure connection to those enterprise services where authorized and manage per service access through enterprise policy 3 mechanism to manage and support connected applications and their dependent services and 4 mechanisms to dynamically detect an undesirable or unsafe operating system environment and manage through a multi step process e.g. evaluating the policy interrogation of the program interrogation of the OS and or performing other checks in the client and or server environments .

The gateway can generate one or more tokens which can be used for authentication. For example in some embodiments an enterprise authentication token EAT can be generated representing a single or multi factor credentials that can be used to authenticate with a given company as if single or multi factor credentials were presented for a finite period of time. A user binding token UBT can also be used in one or more embodiments. The UBT can be an amalgamated unique representation of a user id device id type of device and app family. In addition a framework authentication token FAT can be used in various embodiments. The FAT can be created by binding an EAT UBT and an expiration date used to authenticate with the framework. One advantage of this construction of the FAT is that the details cannot be tampered with by an unauthorized party.

In some embodiments secure mobile framework client and server components can be used to detect the integrity of the operational environment for the client application. Given the client application is executing within an unmanaged operating system environment it may need to ascertain as best it can if the environment is considered to be unsafe.

In the following description for the purposes of explanation numerous specific details are set forth in order to provide a thorough understanding of embodiments of the present invention. It will be apparent however to one skilled in the art that embodiments of the present invention may be practiced without some of these specific details.

While for convenience embodiments of the present invention are described with reference to dedicated enterprise based setups embodiments of the present invention are equally applicable to various other operational models such as cloud based models. Moreover the techniques introduced here can be embodied as special purpose hardware e.g. circuitry as programmable circuitry appropriately programmed with software and or firmware or as a combination of special purpose and programmable circuitry. Hence embodiments may include a machine readable medium having stored thereon instructions that may be used to program a computer or other electronic devices to perform a process. The machine readable medium may include but is not limited to floppy diskettes optical disks compact disc read only memories CD ROMs magneto optical disks ROMs random access memories RAMs erasable programmable read only memories EPROMs electrically erasable programmable read only memories EEPROMs application specific integrated circuits ASICs magnetic or optical cards flash memory or other type of media machine readable medium suitable for storing electronic instructions.

Brief definitions of terms abbreviations and phrases used throughout this application are given below.

The terms connected or coupled and related terms are used in an operational sense and are not necessarily limited to a direct physical connection or coupling. Thus for example two devices may be coupled directly or via one or more intermediary media or devices. As another example devices e.g. mobile devices server machines etc. may be coupled in such a way that information can be passed therebetween while not sharing any physical connection with one another. Based on the disclosure provided herein one of ordinary skill in the art will appreciate a variety of ways in which connection or coupling exists in accordance with the aforementioned definition.

The phrases in some embodiments according to some embodiments in the embodiments shown in other embodiments and the like generally mean the particular feature structure or characteristic following the phrase is included in at least one implementation of the present invention and may be included in more than one implementation. In addition such phrases do not necessarily refer to the same embodiments or different embodiments.

If the specification states a component or feature may can could or might be included or have a characteristic that particular component or feature is not required to be included or have the characteristic.

The term module refers broadly to a software hardware firmware or service or any combination thereof component. Modules are typically functional components that can generate useful data or other output using specified input s . A module may or may not be self contained. An application program also called an application may include one or more modules or a module can include one or more application programs.

Gateway manages the access of enterprise managed applications A N and user devices A N. Gateway can be used to verify and establish a trust relationship between the enterprise managed applications A N and business specific services provided by the enterprise. For example in some embodiments the data and requests initially submitted by enterprise managed applications A N are transferred between the device and gateway via network . Once gateway is satisfied with the security of the device then gateway can open up a channel to some business specific service within the application management platform and enterprise services . Gateway and services within the application management platform can have multiple independent layers of security and checks.

User devices A N can be any computing device capable of receiving user input as well as transmitting and or receiving data via the network . In one embodiment user devices A N can be any device having computer functionality such as a personal digital assistant PDA mobile telephone smartphone tablet wearable types of mobile computers body mounted computers or similar device. User devices A N can be configured to communicate via network which may comprise any combination of local area and or wide area networks using wired and or wireless communication systems. In one embodiment network uses standard communications technologies and or protocols. Thus network may include links using technologies such as Ethernet 802.11 worldwide interoperability for microwave access WiMAX 3G 4G CDMA digital subscriber line DSL etc.

Similarly the networking protocols used within the various layers of network may include multiprotocol label switching MPLS transmission control protocol Internet protocol TCP IP User Datagram Protocol UDP hypertext transport protocol HTTP hypertext transport protocol secure HTTPs simple mail transfer protocol SMTP file transfer protocol FTP secure file transfer protocol SFTP and or other networking protocols. Data exchanged over network may be represented using technologies and or formats including hypertext markup language HTML or extensible markup language XML . In addition all or some links can be encrypted using conventional encryption technologies such as secure sockets layer SSL transport layer security TLS and Internet Protocol security IPsec .

A variety of authentication and security checks are performed at the enterprise during authentication operation . In some embodiments for example once the set of credentials are received from the user an authorization request can be sent from the remote device i.e. the client to the gateway server. The gateway server can determine a current policy which should be applied at the remote device and send policy information from the gateway server to the remote device. Then the device characteristics can be checked and new container credentials can be acquired if necessary. If the gateway determines that the application should have access to one or more servers within the enterprise creation operation can be used to create a binding between the application and an enterprise service.

Secure storage can securely store enterprise data locally on mobile device . Secure storage can include a group of protected files managed as single unit through policy . In some embodiments enterprise content can be stored in encrypted files and accessed via random access methods. In addition various mechanisms can be used to set encryption block sizes on a per file basis and simultaneously maintain a sidecar index file used to aid with the synchronization content between client and service. The protected files are held within a secure partition which uses a single encrypted master file to hold per file encryption keys and a translation between applications file names and obfuscate file names. This secure file partition mechanism can be used to securitize not only application content directly but also used as a virtual file system for database servers hosted on the device logging and telemetry data for customer support.

Policy can be an application specific or application family security policy set by the enterprise with which application should comply. An application family generally refers to a grouping of applications governed by a common policy that share access to authorization and authentication information on a given device for a given user. Policy can include the value of security variables used in authorization authentication and securitizing data on the device. For example policy can include password structure how long the device can remain disconnected from the gateway how many times the user can fail to enter in a correct password and other security variables.

A further instance of a secure file partition is authentication store which can contain authentication credentials e.g. tokens and assertions policy details and a master encryption key used to encrypt all other secure file partitions master files. An authentication store master file store can be encrypted with an ephemeral key generated based on a user password or phrase. Furthermore authentication store can be shared among multiple applications on the device to form a common store for enterprise access and sharing encrypted content.

Once application and corresponding components are installed on mobile device application can request access to one or more internal services within an enterprise running on servers or virtual machines after passing one or more device security checks. The request from application is first received at a perimeter gateway where a first round of authentication is established before allowing application access to an intermediate layer . Intermediate layer authenticates the user and ensures that the policy being enforced by application is up to date. In addition mobile device telemetry and configuration settings can be gathered processed analyzed evaluated and or recorded within database . This information can be useful in creating e.g. in real time or in near real time various indicators of fraud or anomaly detection. Intermediate layer also allows application to log into mobile application store . In addition proxy can be used as an intermediary between application and the servers .

If the policy and user are successfully validated then validation operation validates the user s authentication credentials at the gateway. Enterprise credentials are then passed to the destination service during submission operation where authentication and authorization take place during verification operation . Upon successful authentication binding operation creates a binding between the application and the named service.

The enterprise managed application can use a framework authentication token FAT to authenticate with the gateway and an enterprise authentication token EAT to authenticate with a service. Validation operation determines e.g. using a framework authentication system the validity of the FAT. A server authorizer can then construct one or more tokens for creating a secure connection to the enterprise service. For example in some embodiments the server authorizer can create a User Binding Token UBT consisting of the user id the application id and the device id. In addition the FAT can be created by binding the UBT EAT and an expiration date. In addition the server authorizer may determine if the user is authorized to access the enterprise. A secure mobile framework server can construct a policy based on the enterprise services the user can interact with. The information in the policy can include the FAT expiration date a type of enterprise authentication the user must perform when the FAT expires and other policy information used to secure data on the mobile device. The secure mobile framework server gateway can then respond to the mobile device with the FAT and the policy.

The calling client e.g. the mobile device can use an authentication store to save the FAT and policy content. The application can then use generation operation to generate a connection request upon verification of the policy enforcement. Then creation operation creates a secure channel between the enterprise managed application and the enterprise service. For example the application can ask the client secure mobile framework to connect to a particular enterprise service using some canonical name. Then the framework can send the service name along with the UBT to the secure mobile framework server service authenticator over the same connection. The service authenticator determines if the UBT is allowed to connect to that destination.

The secure mobile framework server service router can then map the canonical name to the real address of the service and establish a connection. The mobile application can now communicate freely over a secured channel once the enterprise authentication is successfully completed. On subsequent requests for connections the application may ask the secure mobile framework to connect to a particular service using some canonical name. The secure mobile framework can then send the service name along with the UBT and EAT to the secure mobile framework gateway. In some embodiments the next time the application attempts to connect with the service this information can be used rather than the user entered enterprise credentials at least until the FAT expires.

Communications API obtains the user s raw credentials or stored token FAT to establish a connection with an enterprise gateway using secure key store . For example upon receiving the user s credentials a secure key can be retrieved from secure key store . This key can be used to access a key chain after which subcomponents of the framework can be initialized. System management can receive from the device application an identification of a current policy associated with the application. Using policy management a determination can be made as to whether the policy associated with the application is up to date or needs to be updated. System management can ensure that proper logging virtual file system management and page caching occur.

Upon successful authorization and authentication the gateway requests policy and device information from communications API . Upon successful validation the gateway can bind a connection to a web browser proxy service capable of making HTTP S calls within the enterprise. Web browser can then transmit the wrapped HTTP S requests through this channel.

Upon launching application a request is sent to far mobile content gateway . Within the main stack of far mobile content gateway validation and authentication of the user and device can be confirmed. For example in some embodiments an enterprise authentication system e.g. RSA or Kerberos can be used. In some embodiments the authentication process can include a username a whitelist check a policy check and or a destination check. In addition device telemetry and configurations can be monitored and transmitted to a second intermediate authentication layer. These allow for the user device and application to be authenticated.

Once the user device and application have been authenticated a connection can be established with server . Many embodiments use the various tokens created during the authentication of the user device and application for establishing a connection with server . Far mobile content gateway can connect with mobile gateway services for additional authentication services for access to servers within the enterprise. For example in some embodiments a user can enter a password or other authentication credentials within application that can be used to decrypt data stored locally on the device. Then the user could present a FAT to a gateway process running on a remote environment. The gateway process uses the FAT to authorize and authenticate the user and the device. Then to access any particular service the user would present an EAT to the remote service. In some embodiments the FAT and EAT can be stored locally on the device after preforming one or more pluggable forms of authentication e.g. time codes pin biometrics passwords etc. .

In some embodiments the form of authentication can be rotated on a predefined schedule e.g. periodic or upon detection of one or more events. For example the gateway can securely transmit the current authentication form to the mobile device which can be stored in the secure store. While illustrates examples such as HTTPS and TLS of secure connections which can be used other embodiments of the present invention can use different protocols for creating connections for messaging and transferring data between system components.

Mobile authorization service can authorize access generate a UBT and store the device identifier the user name application family and the UBT. Mobile authorization service signs the UBT and authentication token before returning a policy a UBT and a digital signature to far content gateway . Far content gateway then generates a FAT which is returned along with the policy UBT and digital signature to device application . In some cases the policy may require device application to request a new password for secure container . The FAT UBT and digital signature can then be stored in secure container which can be locked with the password.

Device application submits the canonical name of the enterprise service to which the device application wants to connect. Far content gateway uses destination service to determine if the UBT is allowed to connect to that service. If the UBT is allowed to connect far content gateway binds a connection to the enterprise service or proxy or intermediate destination to that service . A success code is returned from far content gateway to device application along with the latest policy version. Device application checks to see if the policy version just returned is greater than the policy retrieved form the secure container . If the policy version is greater then the new policy is applied. The FAT can then be retrieved form secure container and the conversation with far content gateway can be initiated.

Embodiments of the present invention include various steps and operations which have been described above. A variety of these steps and operations may be performed by hardware components which are part of a mobile device server or other computer system used within embodiments of the present invention. In some embodiments these steps and operations may be embodied in machine executable instructions which may be used to cause a general purpose or special purpose processor programmed with the instructions to perform the steps. Alternatively the steps may be performed by a combination of hardware software and or firmware. As such illustrates some components which may be used as part of a computer system with which embodiments of the present invention may be utilized. As illustrated in the computer system may include a bus at least one processor at least one communication port a main memory a removable storage media a read only memory and a mass storage . In some cases computer system may not include any local storage such as removable storage media mass storage and the like.

Processor s can be any known processor such as but not limited to an Intel Itanium or Itanium 2 processor s AMD Opteron or Athlon MP processor s ARM based processors or Motorola lines of processors. Communication port s can be any of an RS 232 port for use with a modem based dialup connection a 10 100 Ethernet port or a Gigabit port using copper or fiber. Communication port s may be chosen depending on a network such as a Local Area Network LAN Wide Area Network WAN or any network to which the computer system connects.

Main memory can be Random Access Memory RAM or any other dynamic storage device s commonly known in the art. Read only memory can be any static storage device s such as Programmable Read Only Memory PROM chips for storing static information such as instructions for processor .

Mass storage can be used to store information and instructions. For example hard disks such as the Adaptec family of SCSI drives an optical disc an array of disks such as RAID such as the Adaptec family of RAID drives or any other mass storage devices may be used.

Bus communicatively couples processor s with the other memory storage and communication blocks. Bus can be a PCI PCI X or SCSI based system bus depending on the storage devices used.

Removable storage media can be any kind of external hard drives floppy drives IOMEGA Zip Drives Compact Disc Read Only Memory CD ROM Compact Disc Re Writable CD RW and or Digital Video Disk Read Only Memory DVD ROM .

The components described above are meant to exemplify some types of possibilities. In no way should the aforementioned examples limit the scope of the invention as they are only exemplary embodiments. Moreover some of the computer systems e.g. servers clients mobile devices etc. contemplated by embodiments of the present invention may not include all of these components. In addition some of the computer systems may include different configurations and or additional components from those illustrated in . For example some computer systems e.g. mobile devices may include a GPS unit and various types of I O devices e.g. touchscreens eye tracking modules natural language processors LCD keyboards etc. .

In conclusion the present invention provides novel systems methods and arrangements for a secure mobile framework for enterprise managed applications. While detailed descriptions of one or more embodiments of the invention have been given above various alternatives modifications and equivalents will be apparent to those skilled in the art without varying from the spirit of the invention. For example while the embodiments described above refer to particular features the scope of this invention also includes embodiments having different combinations of features and embodiments that do not include all of the described features.

