---

title: System and method for secure cloud service delivery with prioritized services in a network environment
abstract: An example method includes receiving a request for a cloud capability set during an Internet Key Exchange negotiation associated with a virtual private network (VPN) tunnel between a subscriber and a cloud, wherein the cloud capability set comprises one or more cloud capabilities, mapping the request to one or more cryptographic modules that can support the cloud capability set, and offloading the VPN tunnel to the one or more cryptographic modules. The request can be an Internet Security Association and Key Management Protocol (ISAKMP) packet listing the one or more cloud capabilities in a private payload. The method may further include splitting the VPN tunnel between the cryptographic modules if no single cryptographic module can support substantially all the cloud capabilities in the cloud capability set. In some embodiments, the request is compared with a service catalog comprising authorized cloud capabilities.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09444789&OS=09444789&RS=09444789
owner: CISCO TECHNOLOGY, INC.
number: 09444789
owner_city: San Jose
owner_country: US
publication_date: 20140827
---
This Application is a continuation and claims the benefit of priority under 35 U.S.C. 120 of U.S. application Ser. No. 13 473 418 filed May 16 2012 entitled SYSTEM AND METHOD FOR SECURE CLOUD SERVICE DELIVERY WITH PRIORITIZED SERVICES IN A NETWORK ENVIRONMENT to inventors Sunil Cherukuri et al. The disclosure of the prior application is considered part of and is incorporated by reference in its entirety in the disclosure of this application.

This disclosure relates in general to the field of communications and more particularly to a system and a method for secure cloud service delivery with prioritized services in a network environment.

Recent advances in networking technology have enabled delivery of information technology IT as a service ITaaS . Features like cloud computing and virtualization have enabled enterprises to provide on demand computing resources in a shared self serve model with a catalog of standardized service options. Policy based controls and orchestration to manage internal and external computing resources have enabled a seamless delivery of ITaaS. In such network environments operating models and architecture can closely resemble a service provider environment even within an enterprise network. Thus on demand cloud computing can provide service providers and enterprises the ability to provision new services in minutes instead of weeks rapidly scale infrastructure and meter usage resulting in enhanced IT service delivery while driving down both operational and capital costs.

An example method includes receiving a request for a cloud capability set during an Internet Key Exchange IKE negotiation associated with a virtual private network VPN tunnel between a subscriber and a cloud mapping the request to one or more cryptographic modules that can support the cloud capability set and offloading the VPN tunnel to the one or more cryptographic modules. The cloud capability set may include one or more cloud capabilities. In more specific embodiments the method may further include receiving another request for another cloud capability set during another IKE negotiation associated with another VPN tunnel between another subscriber and the cloud. This cloud capability set can be different from the previous cloud capability set. The method may include mapping that request to other cryptographic modules and offloading the other VPN tunnel to the other cryptographic modules.

Turning to is a simplified block diagram of a communication system for providing secure cloud service delivery with prioritized services in a network environment in accordance with one embodiment of the present disclosure. illustrates a cloud which can provide services through an orchestration engine to one or more subscribers N over a network connection . The general term cloud can include any type of network infrastructure or set of systems that may be associated with the delivery of computing and storage capacity for any number of end users or for network devices. For example an end user or a network device can access a cloud based application through a web browser a mobile app a tunnel etc. while the business software and data can be stored on servers at a remote location.

Subscribers N may connect to cloud through respective virtual private network VPN tunnels N . An Internet Key Exchange IKE processing node may offload VPN tunnels N to one or more cryptographic modules M based on respective cloud capability sets N of VPN tunnels N . IKE processing node may enable secure delivery of services to subscribers N in a prioritized manner according to the subscribers service options in respective service catalogs N .

Cloud can include a collection of hardware and software that forms a shared pool of configurable computing resources e.g. networks servers storage applications services etc. which can be suitably provisioned to provide on demand self service network access resource pooling elasticity and measured service among other features. Cloud may be deployed as a private cloud e.g. infrastructure operated by a single enterprise organization community cloud e.g. infrastructure shared by several organizations to support a specific community that has shared concerns public cloud e.g. infrastructure made available to the general public or a suitable combination of two or more disparate types of clouds. Cloud may be managed by a cloud service provider who can provide subscribers N with at least access to cloud and authorization to set up respective VPN tunnels N in accordance with predetermined service level agreements SLAs .

Services which include computing capabilities e.g. processors memory server time network storage etc. may be delivered to subscribers N by orchestration engine which is an application deployed on cloud . Orchestration engine can enable automation of order to delivery service management and assurance instantiation among other features. Any number and variety of subscribers N may connect to cloud to access services within the broad scope of the present disclosure. Subscribers N may include enterprises departments remote offices mobile individual users with appropriate networking software clients installed on their mobile devices such as laptops remote teleworkers home office etc.

Subscribers N can connect to cloud over respective VPN tunnels N . As used herein a VPN tunnel is a communications channel between two nodes that transports data by encapsulating the data s Internet Protocol IP packets according to any suitable cryptographic tunneling protocol. A node can be any electronic device client server peer service application or other object capable of sending receiving or forwarding information over communications channels in a network. Cryptographic tunneling protocols may include without limitation Internet Protocol security IPsec Secure Socket Layer Transport Layer Security SSL TLS Datagram Transport Layer Security DTLS Microsoft Point to Point Encryption MPPE and Secure Shell SSH .

In various embodiments cloud capability sets N may be associated with corresponding VPN tunnels N in accordance with the SLA negotiated between respective subscribers N and cloud service provider . As used herein cloud capabilities include a capability to support different multicast encryption schemes b capability to encrypt Layer 2 tunneling protocol L2TP version 2 or L2TPv3 tunnels c capability to encrypt Generic Routing Encapsulation GRE tunnels d capability to encrypt IPv6 traffic e capability to provide different quality of service QoS for IPsec f capability to support different VPN technologies including EzVPN dynamic multipoint VPN DMVPN and group encrypted transport VPN GETVPN g capability to support IKEv2 h capability to support mobility including mobile VPN client and home agent foreign agent HA FA i capability to support Lempel Ziv Stac LZS compression before encryption j capability to support data encryption standards DES Triple DES 3DES Advanced Encryption Standard AES 256 h capability to support hot standby routing protocol HSRP k capability to support IPsec with network port address translation NAT PAT etc. In particular embodiments cloud capabilities may also include functions that may be performed within a network to provide value to a manager or user of the network including functions such as encryption decryption specialized routing intrusion management accounting and other layer 3 through layer 7 applications that may reside on top of layer 2 switching and or layer 3 routing services. In various embodiments cloud capabilities may be differentiated into various tiers e.g. Level 1 Level 2 etc. Gold tier Silver tier etc. .

Likewise services may be offered to subscribers N with multiple feature tiers and pricing levels depending on certain service characteristics such as compute network and storage for example to tailor workload or application requirements to specific customer needs. Services may be offered to each subscriber according to service catalogs N . As used herein the term service catalog encompasses a list of services offered by cloud service provider . Service catalogs N may include a listing of services corresponding to respective subscribers N . Infrastructure within cloud may be configured for multi tiered service and quality of service QoS settings so that subscribers N can add or expand cloud capabilities and services .

According to example embodiments of communication system IKE processing node may offload VPN tunnels N to one or more cryptographic modules M based on cloud capability sets N of respective VPN tunnels N . As used herein the term offload includes transferring data from one network element e.g. IKE processing node to another network element e.g. cryptographic modules M . More specifically the offloading can include transferring or distributing processing responsibilities between devices or across multiple processors of a single device. This could allow for example one network device to receive and to accommodate additional flows as the processing cycles that the network device would otherwise be responsible for are being performed by another network device. The offloading can further include transferring certain VPN tunnels to a different network device which may be more capable of processing certain types of flows. For example a certain legacy network device may benefit from offloading particular flows to a more capable network device which is configured to handle such flows. Any such example activities are included within the broad scope of such offloading.

Cryptographic modules M include hardware and associated software firmware to support cloud capabilities including providing cryptographic functions such as IPsec processing encryption decryption key generation and hashing among others. In various embodiments each cryptographic module may support separate cloud capabilities. For example cryptographic module may provide DES and AES encryption cryptographic module may provide LZS compression and so on. Each VPN tunnel may be supported by one or more cryptographic modules M .

For purposes of illustrating certain example techniques of communication system it is important to understand the communications that may be traversing the network. The following foundational information may be viewed as a basis from which the present disclosure may be properly explained. Such information is offered earnestly for purposes of explanation only and accordingly should not be construed in any way to limit the broad scope of the present disclosure and its potential applications.

Cloud computing is a style of computing in which dynamically scalable and often virtualized resources are provided as a service over the Internet. Users need not have knowledge of expertise in or control over the technology infrastructure in the cloud that supports them. The concept incorporates infrastructure as a service platform as a service software as a service and other recent technology trends that have the common theme of reliance on the Internet for satisfying the computing needs of the users. A typical cloud deployment such as in a private cloud e.g. enterprise network or a data center DC in a public cloud e.g. Internet can consist of thousands of servers or alternatively VMs hundreds of Ethernet Fiber Channel or Fiber Channel over Ethernet FCoE ports switching and storage infrastructure etc. The cloud can also consist of network services infrastructure like IPsec VPN hubs firewalls load balancers wide area network WAN optimizers etc. Remote subscribers can access the cloud applications and services securely by connecting via a VPN tunnel such as an IPsec VPN tunnel.

IPsec based VPN protocol is made up by two parts i IKE protocol and ii IPsec protocols. The first part IKE is the initial negotiation phase where two VPN peers e.g. routers agree on which methods may be used to provide security for the underlying IP traffic and define the security associations SAs for the connection. When the IKE negotiation begins the peer e.g. router at the subscriber that initiates the negotiation sends all its IKE policies i.e. combination of security parameters to be used during the negotiation to the remote peer e.g. gateway at the cloud . An IKE processing node at the remote peer looks for a policy match by comparing its own IKE policies against the IKE policies received from the initiating peer. A match is found when IKE policies on both sides contain the same encryption hash authentication and Diffie Hellman DH parameter values. If there is more than one IKE policy match the IKE policy with the highest priority is used. If no acceptable match is found IKE refuses negotiation and IPsec communication will not be established. If a match is found IKE will complete negotiation and IPsec SAs will be created.

IPsec SAs are negotiated using the Internet Security Association and Key Management Protocol ISAKMP as defined by Request for Comments RFC 2408 promulgated by the Internet Engineering Task Force IETF . ISAKMP format provides a consistent framework for transferring key and authentication data independent of any key generation technique encryption algorithm and authentication mechanism. An ISAKMP message has a fixed header format followed by a variable number of payloads. The fixed header contains fields carrying information required by the protocol to maintain state process payloads and possibly prevent denial of service or replay attacks. In particular a next payload field in the header defines values for predetermined payloads with a value from 128 255 set aside for private use e.g. any arbitrary use not otherwise specified in the standards definition . The security parameters for establishing the VPN tunnels between the VPN peers are negotiated using such ISAKMP messages.

In general the security parameters required for communication depends on the individual network configurations and environments of the respective peers connecting on the VPN tunnel. Different types of VPN devices implement different standards and features to support VPN tunnel set up and the different devices may support different security parameters IKE policies. Examples of VPN devices include Cisco ASR1000 XR12000 7600 6500 7200 ISR ASA PIX etc. For example ASR1000 supports DMVPN GETVPN IPv6 DES 3DES and AES XR12000 supports AES DES 3DES and GRE but not DMVPN. Even on a single VPN device there could be different generations of IPsec VPN hardware modules with different feature sets and capabilities. For example Cisco 6500 switches include VPN services module VPNSM IPsec shared port adapter SPA and VPN services port adapter VSPA . VPNSM supports 3DES DMVPN and GRE IPsec SPA supports AES DES 3DES GRE and DMVPN and VSPA supports AES 128 192 256 bit key sizes DES and 3DES but not DMVPN and so on.

Because different devices support correspondingly different IKE policies and other security parameters when subscribers connect to the cloud using disparate IKE policies each subscriber may have to be supported by a different device in the cloud. For example subscribers in the United States may connect via IPsec VPN while subscribers in Europe may typically use L2TP IPsec. Financial customers may require encrypting multicast traffic to access financial application on the cloud s hosting servers. Some subscribers may additionally require QoS services on top of IPsec VPN for example if the subscribers host voice over IP VoIP or video services in the cloud. To support such varied IKE policies and other services the cloud service provider would have to deploy different types of IPsec VPN devices and modules in the cloud resulting in increased operational costs and complexity.

Moreover certain clouds such as data center clouds are typically planned for large scale traffic capabilities and terminating thousands of endpoints e.g. branch routers for enterprise or software clients for consumers and as such require many VPN devices. The VPN devices may not always be of the same type. Different VPN devices could be used for different feature sets and as platforms evolve there could be a mix of newer and older VPN devices deployed in the cloud. Currently there is no mechanism to dynamically map customer requirement to a specific VPN service in the cloud easily. It is possible to deploy different IKE processing nodes for each service e.g. mapping to a specific platform but no mechanism exists currently to use a single IKE processing node and map to different VPN devices services. Moreover currently there are no mechanisms that can host network services like IPsec VPN services in a private cloud and transparently offload the IPsec VPN services to a public cloud during peak times.

A system for secure cloud service delivery with prioritized services in a network environment illustrated in can resolve many of these issues. Embodiments of communication system can facilitate ease of deployment and use by providing a single IKE endpoint e.g. IKE processing node for subscribers N to connect to and then dynamically mapping subscribers N to appropriate cryptographic modules M which can support cloud capabilities of cloud capability sets N . In various embodiments subscribers N may request cloud capabilities using a Cloud Request in the IKE negotiation. For example each subscriber can ask for a different cloud capability set through a suitable cloud request. In one embodiment the cloud request from each subscriber may include an ISAKMP packet listing the requested cloud capabilities in a private payload for example the ISAKMP payload reserved for private use e.g. with next payload values 128 255 . Such cloud services payload can convey the cloud request and may be sent in an authenticated IKE message.

In various embodiments IKE processing node may receive a request for cloud capability set during the IKE negotiation associated with VPN tunnel between subscriber and cloud where cloud capability set may include one or more cloud capabilities. IKE processing node may map the request to one or more cryptographic modules M that can support cloud capability set and offload VPN tunnel to appropriate cryptographic modules M . Assume merely for the sake of illustration that cryptographic modules and can support the cloud capabilities in cloud capability set . Therefore IKE processing node may offload VPN tunnel to cryptographic modules and e.g. split VPN tunnel between cryptographic modules and . IKE processing node may thereafter provide the cloud capabilities in cloud capability set to subscriber through cryptographic modules and .

IKE processing node may further receive another request for cloud capability set during the IKE negotiation associated with VPN tunnel between subscriber and cloud where cloud capability set may be different from cloud capability set . IKE processing node may map cloud capability set to one or more cryptographic modules M that can support cloud capability set and offload VPN tunnel to cryptographic modules M . Assume merely for the sake of illustration that cryptographic module can support substantially all the cloud capabilities in cloud capability set . Therefore IKE processing node may offload VPN tunnel to cryptographic module . IKE processing node may thereafter provide the cloud capabilities in cloud capability set to subscriber through cryptographic module .

According to some embodiments cloud capabilities may be differentiated into any suitable number of tiers according to any suitable criteria. For example tiers may be differentiated into four levels Gold Silver Bronze and Palladium based on demand e.g. cloud capabilities with higher demand may be on a Gold tier cloud capabilities with lower demand may be on a Bronze tier etc. . In another example tiers may be differentiated based on cloud infrastructure costs e.g. cloud capabilities requiring higher cost routers may be on a Gold tier cloud capabilities requiring lower cost routers may be on a Bronze tier etc. . In yet another example tiers may be differentiated arbitrarily. In some embodiments some cloud capabilities may overlap between one or more tiers e.g. Gold Silver and Bronze tiers may support EZVPN while other cloud capabilities may not overlap between two tiers e.g. only Gold tier offers support for LZS compression while Silver and Bronze do not . Any suitable scheme may be used to separate the cloud capabilities into various tiers within the broad scope of the present disclosure.

In some embodiments each cloud capability set may correspond to a tier e.g. cloud capability set may correspond to substantially all cloud capabilities of a Gold tier cloud capability set may correspond to substantially all cloud capabilities of a Bronze tier etc. . In other embodiments each cloud capability set may include cloud capabilities that form a subset of substantially all cloud capabilities of a tier e.g. cloud capability set may include two cloud capabilities of a Gold tier cloud capability set may include five cloud capabilities of a Gold tier etc. In yet other embodiments each cloud capability set may include cloud capabilities from one or more tiers e.g. cloud capability set may include two cloud capabilities of a Gold tier and one cloud capability of a Silver tier etc. In some cases cloud capabilities may be purchased by subscribers N under a variable pricing model.

Likewise any number of differentiated tiers for services may be offered in cloud . For example services can be differentiated into pre defined service tiers by varying support of features such as virtual machine resources storage features application tiers stateful services QoS agreements etc. In one example a Gold tier could consist of secure VPN access firewall load balancing intrusion prevention better QoS virtual machines VMs of four virtual central processing units vCPUs and 16G memory and 200G storage disks with cloning for data protection. A Bronze tier could consist of VPN access firewall VMs of 1 vCPU and 2G memory and 50 GB disk with snapshots for data protection.

Service tiers can vary based on storage features such as redundant array of independent disks RAID levels disk types and speeds and backup and snapshot capabilities. For example a Gold tier could offer three tiers of RAID 10 storage using 15K rpm Fibre Channel FC 10K rpm FC and Serial Advanced Technology Attachment SATA drives. A Bronze tier might offer a single RAID 5 storage tier using SATA drives. Service tiers can also vary based on differentiated support for application hosting. In some instances applications may require several application tiers of VMs. Each tier may be placed on separate virtual local area networks VLANs . For example a Gold tier could have three application tiers on three separate VLANs to host web application and database DB services on different VMs with each tier providing five VMs for redundancy and load balancing. A Silver tier could also have three tiers for web application and DB services and each tier may have two VMs for redundancy and load balancing. A Bronze tier could have three tiers but in a less differentiated manner with the web application and DB services residing on the same VLAN or potentially on the same VM.

Customer workloads can also be differentiated by services applied to each tier for example firewalls encryption load balancers protocol optimization application firewalls wide area network WAN optimization advanced routing redundancy disaster recovery etc. Within a service like firewall further differentiation among tiers may be possible for example inter VLAN intra VLAN or intra host inspections. For example a Gold tier might include firewall inspection SSL offloading IPsec encryption server load balancing and WAN optimization. A Silver tier might offer firewall inspection and server load balancing.

Bandwidth control during periods of network congestion can be another differentiator of services . QoS policies can prioritize bandwidth by service tier. Traffic classification prioritization and queuing and scheduling mechanisms can identify and offer minimum bandwidth guarantees to tenant traffic flows during periods of congestion. For example a Gold service tier might be given the highest priority and a minimum network bandwidth guarantee of 50 . A Bronze service tier might receive best effort treatment only and no minimum bandwidth guarantees. Any suitable scheme may be used to separate services into various tiers within the broad scope of the present disclosure. The tiers of cloud capabilities and services described herein are merely representative and are not intended as limitations. Virtually any number of tiers and types of differentiation of cloud capabilities and or services may be implemented within the broad scope of the present disclosure.

In operation IKE processing node may receive a cloud request as part of the IKE negotiation with subscriber . In one embodiment the cloud requests may be received from respective subscribers N . The cloud capability information can be configured within an ISAKMP profile e.g. enabling modularity of ISAKMP configurations for IKE negotiations EzVPN profile or Crypto Map e.g. Cisco 105 software configuration entity that selects data flows needing security processing and defining the policy for these flows and the crypto peer that traffic needs to go to or other suitable configuration element e.g. depending on the type of IPsec VPN tunnel being used . Assume merely for illustrative purposes that subscriber negotiates VPN tunnel with cloud capability set including 3DES encryption DMVPN and LZS compression and subscriber negotiates VPN tunnel with cloud capability set including DES and mobility with HA FA support. Assume also for illustrative purposes only that cryptographic module can support 3DES encryption and DMVPN cryptographic module can support LZS compression and cryptographic module can support DES and mobility with HA FA.

Subscribers and may send respective cloud requests in appropriate ISAKMP payloads including the requested cloud capabilities. IKE processing node may analyze the ISAKMP payloads determine the cloud capabilities map the cloud capabilities to appropriate cryptographic modules e.g. one or more of cryptographic modules M that support such capabilities and offload VPN tunnels and appropriately. For example VPN tunnel A may be split and offloaded to cryptographic module for providing 3DES encryption and DMVPN and to cryptographic module for LZS compression. VPN tunnel may be offloaded to cryptographic module for DES and mobility with HA FA.

Alternately it may be also possible for IKE processing node to assign cloud capabilities locally or from authentication authorization accounting AAA services for subscribers for example based on the IKE ID e.g. identifier of a particular IKE negotiation . For example the cloud request may be received from service catalogs N which contain authorized cloud capabilities derived from respective SLAs between corresponding subscribers N and cloud service provider managing cloud . Thus service catalogs N may be tailored for respective subscribers N . For example subscriber may have a corresponding service catalog which may be different from service catalog for subscriber .

Each service catalog may include a description of the respective subscriber s account level information such as specific customer pricing under the respective SLA description of products and services that can be ordered from cloud service provider a description of products and services used by the subscriber pricing of various products and services invoices and payment status technical and billing administrators etc. Each service catalog may include an application programming interface API with suitable actions such as create catalog create cloud request add service etc. Each service catalog may comprise suitable data models e.g. in a self describing format such as XML holding the requisite information structures e.g. to describe the products and services and API to interact therewith. Orchestration engine may use information in service catalogs N to process order provision and operate services for respective subscribers N .

Assume merely for illustrative purposes that subscriber s SLA with cloud service provider specifies that subscriber may have signed up for a Gold tier service including certain cloud capabilities such as 3DES encryption DMVPN and LZS compression. The cloud capabilities for subscriber may be included in service catalog . Likewise subscriber may have signed up for a Bronze tier service including certain cloud capabilities such as DES and mobility with HA FA. The cloud capabilities for subscriber may be included in service catalog . When subscribers and initiate respective VPN tunnels and with IKE processing node e.g. using standard ISAKMP payloads respective service catalogs and may forward appropriate cloud requests including the appropriate cloud capabilities to IKE processing node . In some embodiments the cloud request may be in suitable ISAKMP cloud payloads as described earlier.

IKE processing node may analyze the cloud requests determine the cloud capabilities map the cloud capabilities to appropriate cryptographic modules M that support such cloud capabilities and offload tunnels and appropriately. For example VPN tunnel may be split and offloaded to i cryptographic module for providing 3DES encryption and DMVPN and ii cryptographic module for providing LZS compression. VPN tunnel may be offloaded to cryptographic module for providing DES and mobility with HA FA.

In yet another embodiment IKE processing node may receive the cloud requests from subscribers N and verify the cloud capabilities with the respective subscribers SLAs as described in respective service catalogs N . Assume merely for illustrative purposes that subscriber s SLA with cloud service provider specifies that subscriber has signed up for a Gold tier service including certain cloud capabilities such as 3DES encryption DMVPN and LZS compression. Likewise subscriber has signed up for a Bronze tier service including certain cloud capabilities such as DES and mobility with HA FA but no LZS compression.

Assume that subscriber sends a cloud request for cloud capability set including 3DES encryption DMVPN and LZS compression. IKE processing node may receive the cloud request poll service catalog and determine that the cloud request matches the Gold tier service for which subscriber has signed up. IKE processing node may thereupon map the cloud capabilities to the respective cryptographic modules e.g. and that support the requested cloud capabilities and offload VPN tunnel appropriately.

Assume in the above example embodiment that subscriber sends a cloud request for cloud capability set comprising DES mobility with HA FA and LZS compression. IKE processing node may receive the cloud request compare with service catalog and determine that the request does not match the Bronze tier service for which subscriber has signed up. In one embodiment if at least one cloud capability in cloud capability set does not match any of the authorized cloud capabilities in service catalog the IKE negotiation may fail and the request may be consequently denied. In another embodiment IKE processing node may allow only those cloud capabilities in cloud capability set that match with the authorized cloud capabilities in service catalog while denying requests for any other cloud capabilities. In the example such cloud capabilities would include DES and mobility with HA FA. IKE processing node may then off load VPN tunnel to cryptographic module that can support DES and mobility with HA FA.

Turning to the infrastructure of elements of communication system may represent a series of points or nodes of interconnected communication paths for receiving and transmitting packets of information which propagate through communication system . Elements of communication system may include network elements not shown that offer a communicative interface between servers and or users and may be any local area network LAN a wireless LAN WLAN a metropolitan area network MAN a virtual LAN VLAN VPN a wide area network WAN or any other appropriate architecture or system that facilitates communications in a network environment.

Elements of may be coupled to one another through one or more interfaces employing any suitable connection wired or wireless which provides a viable pathway for electronic communications. Additionally any one or more of these elements of may be combined or removed from the architecture based on particular configuration needs. Communication system may include a configuration capable of transmission control protocol Internet protocol TCP IP communications for the electronic transmission or reception of packets in a network. Communication system may also operate in conjunction with a user datagram protocol IP UDP IP or any other suitable protocol where appropriate and based on particular needs.

Network connection may include any suitable equipment infrastructure or communication link to IKE processing node such as wireless technologies e.g. IEEE 802.11 802.16 WiFi WiMax etc. satellite cellular technologies e.g. 3G 4G etc. etc. or any combination thereof. Embodiments of elements in communication system may include one or more distinct network interfaces to facilitate communication via the various networks including both internal and external networks described herein. Such network interfaces may be inclusive of multiple wireless interfaces e.g. WiFi WiMax 3G 4G white space 802.11x satellite Bluetooth near field communication NFC LTE GSM WCDMA HSPA CDMA1x EVDO DSRC CAN GPS etc. . Other interfaces represented by network interfaces may include physical ports e.g. Ethernet USB HDMI etc. interfaces for wired and wireless internal subsystems and the like.

Subscribers N include any suitable infrastructure such as VPN gateways user terminals laptops computers and other network elements to facilitate the activities described herein. As used herein the term network element is meant to encompass computers network appliances servers routers switches gateways bridges loadbalancers firewalls processors modules or any other suitable device component element or object operable to exchange information in a network environment. Moreover the network elements may include any suitable hardware software components modules interfaces or objects that facilitate the operations thereof. This may be inclusive of appropriate algorithms and communication protocols that allow for the effective exchange of data or information.

Services may be delivered to subscribers N according to various service models including software as a service e.g. allowing subscribers N to use applications running on cloud platform as a service e.g. allowing subscribers N to deploy onto cloud applications created using programming languages and tools supported by cloud infrastructure as a service e.g. allowing subscribers N to provision processing storage networks and other computing resources to enable deployment and running of arbitrary software including operating systems and applications etc.

According to embodiments of communication system IKE processing node and each cryptographic module may be suitably configured network elements or parts thereof that can facilitate the activities discussed herein. In some embodiments IKE processing node and cryptographic modules M may be implemented on the same network element. For example an advanced network switch e.g. Cisco 6500 switch may include hardware and software to perform IKE processing as well as cryptographic modules such as VPNSM IPsec SPA VSPA etc. In other embodiments IKE processing node and cryptographic modules M may be implemented on separate network elements. For example IKE negotiation may be performed on a dedicated device and cryptographic functions may be offloaded to separate devices including old generation VPN devices that have limited functionality and latest generation advanced routers with several cryptographic functionalities. Each cryptographic module may be further configured to handle data plane IPsec traffic whereas IKE processing node may be further configured to handle control plane traffic.

In addition embodiments of communication system may provide cloud capabilities and services to different subscribers e.g. N for securely accessing cloud . For example embodiments of communication system may provide different cloud capabilities in cloud capability sets N to different subscribers N utilizing a single IKE endpoint e.g. IKE processing node thereby making deployments simple. New control messaging can be leveraged to take care of control plane messaging between IKE processing node and cryptographic modules M for example for syncing up security associations information and other related messaging for rekeys etc. Requests for cloud capabilities and services can be dynamically signaled from subscribers N to cloud via suitable payloads e.g. ISAKMP cloud payloads . Existing hardware in cloud may be maintained for supporting basic IPsec VPN services for no frills subscribers whereas newer platforms can be provisioned for supporting newly available services for subscribers requiring such new services.

Separately embodiments of communication system can support mix and match of cryptographic modules M and pay as you grow deployments in cloud and further provide for dynamically offloading cloud capabilities e.g. IPsec VPN services from private cloud to public clouds thereby enabling true on demand elastic cloud services. Embodiments of communication system may enable offloading crypto processing to cloud for example by re directing subscriber to directly send encrypted traffic to cloud or by simply forwarding encrypted traffic to cloud for crypto processing.

Turning to is a simplified block diagram illustrating additional details of communication system . A self service portal may be enabled with a service orchestration framework solution including options for cloud capability selection order fulfillment SLA reporting and customer care . A business service management portal includes a configuration management database CMDB service catalog an accounting and chargeback application and an SLA management module .

Orchestration engine in cloud may orchestrate subscriber service requests back and forth from resources e.g. VMs networks NW and storage with appropriate management tools including server configuration management tool network configuration management tool and storage configuration management tool . VMs NW and storage may enable provision of services from cloud . Orchestration engine can facilitate provisioning of separate subscriber resources and efficient mapping of interdependent cloud services in addition to other features. Orchestration engine can facilitate aligning a request for services with applications data and infrastructure in cloud . Orchestration engine may define policies and service levels through automated workflows provisioning change management and other suitable management features for example to create an application aligned infrastructure that can be scaled up or down based on the needs of each application or subscriber . Orchestration engine can also provide centralized management of resources e.g. VMs networks NW and storage including billing metering and chargeback for consumption. In various embodiments orchestration engine can manage complex cross domain e.g. system firewall enterprise etc. processes and handle exceptions.

Each subscriber may view self service portal on respective devices e.g. computer laptop mobile phone etc. In some embodiments self service portal may be tailored for each subscriber thus self service portal visible to subscriber may different from self service portal visible to subscriber . Self service portal may be implemented via a graphical user interface GUI for example to facilitate selection of various options querying etc. Through self service portal subscriber may select cloud capabilities through cloud capability selection . For example a VPN gateway e.g. router of subscriber s local network may provide a cloud capability set according to a Gold tier. In such a case cloud capability selection may display a list of Gold tier cloud capabilities. In another example subscriber may choose certain cloud capabilities from a list of options e.g. drop down menu list that may be a sub set of VPN services offered by the respective VNP gateway of the subscriber s local network. Various schemes may be used by subscriber to select cloud capabilities within the broad scope of the present disclosure.

In an example embodiment IKE processing node may offload VPN tunnel to cryptographic modules M and convey the offload information to orchestration engine . Orchestration engine may then suitably configure infrastructure and network resources so that services are channeled through appropriate cryptographic modules M . In another example embodiment IKE processing node may receive a VPN tunnel request e.g. request to set up a VPN tunnel from subscriber and convey the VPN tunnel request to orchestration engine . Orchestration engine may respond with information from service catalog . IKE processing node may provision cloud capabilities across various cryptographic modules M accordingly. In yet another example embodiment subscriber may send a cloud request for cloud capabilities to IKE processing node . IKE processing node may poll orchestration engine for service catalog . IKE processing node may compare the cloud capabilities in the cloud request to service catalog and allow the cloud request if a match is found. Otherwise the cloud request may be denied.

Turning to is a simplified block diagram showing additional details of communication system . Example tiers may comprise a gold tier a silver tier and a bronze tier . The tiers shown and described herein are for example purposes only. Any number of tiers with virtually any type of differentiated cloud capabilities network services applications and computing resources and storage resources may be implemented in communication system within the broad scope of the present disclosure.

In one example gold tier may include differentiated cloud capabilities having high priority bandwidth traffic. Cloud capabilities may include HSRP GRE and DES 3DES encryption and other features. Network services may include one virtual routing and forwarding VRF instance and multiple VLANs per customer VPN offload firewall and server load balancing SLB and secure sockets layer SSL offload. Applications and computing resources may include multiple VMs provisioned with respective applications and operating systems for each of application database and web resources. Storage resources may include virtual machine file system VMFS data store and 100 data protection with recovery with cloning. VMFS logical unit number LUN and data store may include virtual machine disks VMDK as appropriate. Ratio of virtual machines to physical machines may be 1 1 40 of the bandwidth may be reserved for gold tier . Disaster recovery may be an automatically preselected option and backup retention may be for a long duration such as 1 year.

Silver tier may include cloud capabilities having medium priority bandwidth traffic. Differentiated cloud capabilities may include GRE and DES AES encryption and other features. Network services may include one VRF instance and multiple VLANs per customer similar to Gold tier and SLB and SSL offload but no firewall as in gold tier . Applications and computing resources may include multiple VMs provisioned with respective applications and operating systems for each of application database and web resources. Storage resources may include VMFS data store and data protection with recovery with snap shots. VMFS LUN and data store may include a lower number of VMDKs as appropriate. Ratio of virtual machines to physical machines may be 2 1 30 of the bandwidth may be reserved for silver tier . Disaster recovery may be an automatically preselected option and backup retention may be for a shorter duration such as 6 months.

Bronze tier may include cloud capabilities having low priority bandwidth traffic. Differentiated cloud capabilities may include DES AES encryption and other features. Network services may include one VRF instance and VLAN per customer but no SLB SSL offload or firewall. Applications and computing resources may include one VM per customer e.g. one VM each for web database and application . Storage resources may include a shared VMFS data store and no data protection. Ratio of virtual machines to physical machines may be 3 1 20 of the bandwidth may be reserved for bronze tier . There may be no disaster recovery or backup retention.

Turning to is a simplified block diagram showing an example packet format according to an embodiment of the present disclosure. An ISAKMP packet may include a next payload field consisting of 8 bits i.e. 1 octet . Next payload field can indicate the type of the first payload in the message. For example a value of 0 may indicate no payload i.e. the current payload is the last message a value of 1 may indicate that the payload is a SA a value of 6 may indicate that the payload is a certificate etc. According to ISAKMP standards values up to 13 have been predefined values from 14 127 may be reserved values 128 255 may be set aside for private use. According to embodiments of communication system next payload field may use values 128 255 to indicate the cloud request payload. The next 8 bits may be a reserved field . It may be unused e.g. set to 0. Reserved field may be followed by a payload length field of 2 octets. A payload cloud field may include a cloud request payload.

According to various embodiments based on the generic ISAKMP payload header format data attribute fields in the header may be used to convey the cloud request. There can be multiple data attributes within a payload. Data attributes may include cloud capabilities. The data attribute values can be a 3 bit value indicating a pre determined capability. In one example some possible data attribute values could be 1 Multicast traffic 2 Compression 3 L2TP traffic 4 IPv6 traffic 5 GRE traffic 6 AES 7 Mobility etc. An attribute format bit indicates whether the data attributes follow the Type Length Value TLV format or a shortened Type Value TV format. If attribute format bit is a zero 0 then the data attributes are of TLV form. If attribute format bit is a one 1 then the data attributes are of the TV form. According to embodiments of the present disclosure attribute format bit may be set to 1 indicating that the data attributes to follow are of the TV form.

An attribute type field can be a unique identifier for each type of attribute. An attribute value field may be of variable length depending on the value of attribute format bit . If attribute format bit is 1 as in some embodiments attribute value field may have a length of 2 octets. Attribute value field may include the data attribute values e.g. 1 multicast traffic 2 compression etc. . These cloud codes may be used to convey the cloud capabilities required by subscriber and thus the underlying VPN service required from cloud .

Turning to is a simplified block diagram showing details of communication system . Subscriber may send a cloud request to a VPN gateway . In some embodiments cloud request may be a back end request not part of any IKE negotiation. VPN gateway may be a router or suitable network element configured with appropriate software to facilitate the activities described herein. In various embodiments cloud request may comprise ISAKMP packet with cloud capabilities listed in attribute value field . VPN gateway may include IKE processing node comprising a processor and a memory element . VPN gateway may also include one or more cryptographic modules M .

IKE processing node may receive cloud request comprising a request for cloud capability set . Based on the data attributes of the cloud payload IKE processing node may assign VPN tunnel and IPsec SA s to available cryptographic modules M that can support the requested capabilities. Data plane IPsec traffic may then be handled by cryptographic modules M to which VPN tunnel has been offloaded. The information regarding offloading of VPN tunnel may then be communicated to orchestration engine to coordinate delivery of services according to cloud request .

In an example embodiment VPN gateway may be a router e.g. Cisco 6500 platform with multiple cryptographic modules M embedded therein. Processor may include a route processor that can set up VPN tunnel . In some embodiments DH cryptographic calculations can be offloaded to any of available cryptographic modules M and VPN tunnel may or may not be processed by the same cryptographic module. For example if DH cryptographic calculations for the IKE negotiation are offloaded to cryptographic module VPN tunnel may be processed by any of cryptographic modules M .

In another example embodiment cryptographic module may be a VSPA with a carrier card e.g. SSC600 that can support good QoS and multicast replication capabilities. If a VPN tunnel request from subscriber comes in with cloud request for QoS or multicast IKE processing node can associate the VPN tunnel with cryptographic module e.g. VSPA . If subscriber requests compression the VPN tunnel can be offloaded to a compression capable cryptographic module e.g. . In example embodiments differences in capabilities between cryptographic modules M can be taken advantage of by splitting VPN tunnels between cryptographic modules M based on their respective capabilities.

Turning to is a simplified block diagram showing details of communication system . Subscriber may send cloud request to IKE processing node comprising processor and memory element . In various embodiments cloud request may comprise ISAKMP cloud packet with cloud capabilities listed in attribute value field . IKE processing node may inspect cloud request determine cloud capabilities from the IKASMP message and offload VPN tunnel to an appropriate group of cryptographic modules M . In example embodiments one or more cryptographic modules M may be provisioned in a single network element or alternatively each cryptographic module may be provisioned on separate network elements. For example if subscriber requests IPSec L2TP cloud capability IKE processing node which may be provisioned on a router e.g. Cisco 6500 that does not support broadband encryption can assign VPN tunnel to another suitable network element e.g. ASR1000 which can support broadband encryption. The information regarding offloading of VPN tunnel may then be communicated to orchestration engine to coordinate delivery of services according to cloud request .

In some embodiments IKE processing node may provisioned with a Service Insertion Architecture SIA and its service broker can be leveraged to handle control plane messaging between IKE processing node and cryptographic modules M for example to sync up SA information and other related messaging for rekeys etc. In various embodiments cryptographic modules M can contact the service broker to register cloud capabilities.

Turning to is a simplified block diagram illustrating another example embodiment of communication system . Service catalog may be used to create cloud request . In one embodiment service catalog may include a suitable API to enable automatic creation of cloud request when subscriber sends a VPN tunnel request to IKE processing node . For example when subscriber sends the VPN tunnel request IKE processing node may forward the information to orchestration engine which may interact with service catalog to generate cloud request . Cloud request may then be forwarded by orchestration engine to IKE processing node appropriately. In one embodiment cloud request may comprise ISAKMP packet with cloud capabilities listed in attribute value field . In another embodiment cloud request may be a back end communication and not part of any IKE negotiation. For example cloud request may be created with a suitable application programming interface API or other appropriate mechanisms. IKE processing node may inspect cloud request determine cloud capabilities from the IKASMP message and offload VPN tunnel to appropriate cryptographic modules M .

Turning to is a simplified block diagram illustrating another example embodiment of communication system . Subscriber may send cloud request A including request for cloud capability set . In various embodiments cloud request A may comprise ISAKMP packet with cloud capabilities listed in attribute value field . IKE processing node may inform orchestration engine that subscriber has initiated VPN tunnel . In one embodiment orchestration engine may interact with service catalog to generate cloud request B which may list authorized cloud capabilities in its respective attribute value field. The authorized cloud capabilities may be derived from subscriber s SLA with cloud service provider .

In various embodiments IKE processing node may compare the cloud capabilities in cloud request A with the authorized list of cloud capabilities in cloud request B. A match may be found if the cloud capabilities in cloud request A are a subset of the authorized list of cloud capabilities in cloud request B. The subset may include substantially all cloud capabilities listed in cloud request B. If a match is found IKE processing node may offload VPN tunnel to one or more cryptographic modules M . Otherwise the request may be denied altogether. In some embodiments if a match is not found IKE processing node may create VPN tunnel but provide only those cloud capabilities that match with one or more of the authorized list of cloud capabilities in cloud request B.

Turning to is a simplified flow diagram illustrating example operational activities that may be associated with embodiments of communication system . Operations begin at when communication system is activated. At cloud request is received by IKE processing node . In various embodiments cloud request may comprise ISAKMP packet with cloud capabilities listed in attribute value field . At IKE processing node may analyze the ISAKMP payload e.g. cloud services payload . At IKE processing node may determine the requested cloud capabilities from the ISAKMP payload.

At service catalog may be accessed. In some embodiments IKE processing node may directly access service catalog . In other embodiments IKE processing node may access service catalog through orchestration engine . In yet other embodiments orchestration engine may access service catalog and identify authorized cloud capabilities. At cloud capabilities in cloud request may be matched with authorized cloud capabilities from service catalog .

If a match is not found e.g. cloud capabilities in cloud request are not listed in service catalog IKE processing node may deny cloud request at . In some embodiments IKE processing node may deny only those cloud capabilities that are not listed in service catalog and allow the rest. The operations may thereupon end at . If a match is found e.g. cloud capabilities in cloud request is a subset of authorized cloud capabilities from service catalog IKE processing node may map VPN tunnel to appropriate cryptographic modules M at .

At cryptographic modules M may offload VPN tunnel to appropriate cryptographic modules M . Thereafter requested cloud capabilities may be provided by appropriate M over offloaded VPN tunnel . In some embodiments VPN tunnel may be split across more than one cryptographic module M . The operations may end at for example when VPN tunnel is terminated. In some embodiments operations and may be bypassed and service catalog may not be checked. For example cloud request may be received from service catalog in which case it need not be checked again.

Turning to are simplified block diagrams illustrating another embodiment of communication system . Embodiments of communication system may dynamically offload cloud capabilities e.g. VPN IPsec services from an enterprise hub in cloud to cloud in the network to enable elastic services. In various embodiments cloud may be an enterprise network a private cloud a community cloud or other similar types of networks or clouds. According to embodiments of communication system enterprise hub may be a gateway to cloud . In various embodiments cloud may be a public cloud managed by a cloud service provider.

Enterprise hub may maintain a common data and infrastructure available to clients N . In various embodiments enterprise hub may include suitable network elements e.g. routers switches IKE processing nodes cryptographic modules etc. to facilitate the operations described herein. In one example embodiment enterprise hub may deploy IPsec services in a private enterprise cloud. Remote clients e.g. branch offices N may securely connect to enterprise hub via respective VPN tunnels N .

In specific embodiments enterprise hub may be configured to monitor traffic load from clients N . At any instance in time enterprise hub may have packets from clients N awaiting transmission storage processing e.g. encrypting decrypting etc. multiple VPN tunnels N may be connected to enterprise hub and communicating packets back and forth from respective clients N and a certain amount e.g. 50 80 etc. of infrastructure and bandwidth of enterprise hub may be utilized by communications from and to clients N . Enterprise hub may utilize appropriate processors and suitable memory elements to enable handling processing of such communications. As used herein the term traffic load encompasses all such communications handled e.g. forwarded transmitted processed etc. by enterprise hub .

Enterprise hub may include suitable components for monitoring the traffic load for example sensors network monitors probes servers etc. Enterprise hub may implement any suitable sensor types to monitor traffic load including Ping hypertext transfer protocol HTTP Windows Management Instrumentation WMI Simple Mail Transfer Protocol SMTP Post Office Protocol POP3 Domain Name System DNS etc. Enterprise hub may analyze traffic load using any suitable analysis method including Simple Network Management Protocol SNMP NetFlow packet sniffing etc. In addition enterprise hub may include terminals computers display monitors and other peripheral interfaces to enable management of communication therethrough.

According to embodiments of the present disclosure enterprise hub may be configured to detect instances when traffic load exceeds or falls below predetermined thresholds. In one embodiment a first threshold e.g. predetermined number of tunnels or predetermined encrypt decrypt throughput etc. may be set for excessive traffic loads. A second threshold may be set for moderate or low traffic loads. The first and second thresholds may be set by a network administrator according to suitable policy rules applicable to the enterprise. In other cases the first and second thresholds may be set by the operational configuration settings and or limitations of the various components included in enterprise hub . Any suitable scheme may be used to set the first and second thresholds.

In some embodiments enterprise hub may be configured to handle typical e.g. moderate traffic loads. The cloud service provider of cloud may be contracted e.g. through an appropriate SLA to enable cloud to handle peak traffic load or spikes in traffic loads. Enterprise hub may thereby become a subscriber of services from cloud using VPN tunnel to a service provider hub . Service provider hub may be a counterpart of enterprise hub . In various embodiments service provider hub may comprise components that are identical to substantially similar to or somewhat similar to enterprise hub . In addition service provider hub may be configured to handle similar communication with multiple enterprises through corresponding VPN tunnels. For example service provider hub may include suitable network elements e.g. routers switches IKE processing nodes cryptographic modules orchestration engine etc. to facilitate the operations described herein.

When the first threshold is reached at enterprise hub e.g. excessive traffic loads detected enterprise hub may offload tunnels N to service provider hub as illustrated in . In various embodiments such offload may be implemented through suitable notifications to one or more clients N . Each notification may comprise an ISAKMP packet listing certain information in a notification payload. The information in the notification payload may include group security associations SAs to enable connecting to cloud securely the identity of service provider hub and a directive to connect to service provider hub using the group SAs. Subsequently when the traffic load drops lower than the second threshold enterprise hub may send another notification to clients N including a directive to resume traffic with enterprise hub via respective VPN tunnels N . Service provider hub can decrypt the traffic into a VRF and route clear traffic back to enterprise hub via a back channel.

In some embodiments enterprise hub may set up VPN tunnel to service provider hub in cloud when the traffic load exceeds the first threshold. Enterprise hub may exchange group SA information and setup group keys suitably with service provider hub . Enterprise hub may then send the group SA s and identity of service provider hub to clients N in the notification payload. Clients N may connect directly to service provider hub through separate tunnels N using the group SA information. Service provider hub may associate clients N with the SLA for enterprise hub to enable appropriate billing and accounting. In various scenarios the cloud service provider may charge the enterprise subscriber on a usage basis. Thus enterprise hub can offload some of its service load to service provider hub .

In some embodiments VPN tunnels N may continue to be operational even when tunnels N are operational however there may be no traffic or substantially reduced traffic on VPN tunnels N . When the traffic load on enterprise hub drops below the second threshold enterprise hub can signal clients N to stop encrypting the traffic to service provider hub and instead re use tunnels N to enterprise hub .

Enterprise hub service provider hub and clients N can include suitably configured routers switches terminals servers and other network elements to facilitate the operations described herein. Enterprise hub service provider hub and clients N may further be equipped with suitable software firmware as appropriate and other network management tools to permit network administrators to configure them as desired.

Turning to is a simplified block diagram illustrating yet another embodiment of communication system . When the service load on enterprise hub in the network crosses a predetermined threshold enterprise hub can setup VPN tunnel to service provider hub and exchange a portion of a SA Database SADB with service provider hub . SADB may comprise SA information pertaining to VPN tunnels N between enterprise hub and respective clients N .

To decide what protection is to be provided for an outgoing packet enterprise hub may use a Security Parameter Index SPI and an index to SADB along with the destination address in the packet header to uniquely identify an appropriate SA for that packet. A similar procedure may be performed for an incoming packet where decryption and verification keys may be gathered from SADB . Each VPN tunnel N may be associated with corresponding indices in SADB . For example SADB may hold SPIs keys encryption algorithms and sequence numbers for each VPN tunnel N . SADB may comprise any suitable database format based on particular needs.

After service provider hub obtains a copy of SADB or portion thereof enterprise hub may offload the cryptographic processing for some of VPN tunnels N to cryptographic modules in cloud via service provider hub . Cryptographic modules may be identical or substantially similar to cryptographic modules M discussed in connection with . When enterprise hub receives encapsulated traffic e.g. Encapsulating Security Payload ESP traffic IPsec traffic etc. from clients N through respective VPN tunnels N enterprise hub may not decrypt them instead it may simply forward the encapsulated packets to service provider hub over VPN tunnel .

Because service provider hub already has relevant SA information from SADB service provider hub can decrypt encapsulated packets e.g. using appropriate cryptographic modules and information from SADB and forward clear e.g. decrypted packets back to enterprise hub over VPN tunnel . Likewise the operations described herein can be applied in reverse for the traffic to be encrypted back to clients N . For example decrypted traffic may be routed from clients N through enterprise hub to cryptographic modules via service provider hub . Cryptographic modules may encrypt the traffic and forward them on to enterprise hub over VPN tunnel . Thus enterprise hub can offload some of its cryptographic processing load to cloud during peak load times. Clients N may not be aware of any changes to the traffic processing and may simply continue to send encrypted e.g. IPsec traffic to enterprise hub over respective VPN tunnels N .

Turning to is a simplified diagram of an example packet according to embodiments of the present disclosure. Notification packet can include a next payload field a reserved field a payload length field a domain of interpretation DOI field a protocol ID field a security parameter index SPI size field a notify message type field a security parameter index and notification data . Notification Packet can contain various informational data such as error conditions. More than one notification packet may be sent in a single ISAKMP message.

Next payload field indicates the payload type of the next payload in the message and has a length of 1 octet. If the current payload is the last in the message then next payload field can be 0. Reserved field which is 1 octet long is unused and may be set to 0. Payload length field may be 2 octets long and can indicate the length of the current payload including the generic payload header.

DOI field may be 4 octets long and may identify the domain of interpretation under which the notification is taking place. In general for ISAKMP DOI field may be set to 0 and for IPsec DOI field may be set to 1. Protocol ID field may specify the protocol identifier for the current notification. Examples include ISAKMP IPSEC ESP IPSEC AH etc. SPI size field may specify the length in octets of the SPI defined by the protocol ID.

Notify message type field may specify the type of notification message. Notification information can be error messages specifying why an SA could not be established or status data that a process managing an SA database wishes to communicate with a peer process etc. Some values e.g. 1 8191 for notify message type field may be predefined and or reserved. Some other values e.g. 8192 16383 are set aside for private use by the ISAKMP standards. According to various embodiments values set aside for private use may be utilized to exchange cloud notification messages. Example values and corresponding information include 9001 Group SA information 9002 service provider hub information 9002 Send traffic to service provide hub 9003 Resume traffic to enterprise hub etc.

In various embodiments enterprise hub and or service provider hub may send appropriate notification packets to each other and to clients N to establish respective tunnels N or N as the case may be. Information about the action to be taken and or other SA group information etc. may be provided in notify message type field as appropriate. Network elements at clients N and enterprise hub may be suitably configured to interpret analyze notification packet and take action appropriately.

Turning to is a simplified flow diagram illustrating example operational steps that may be associated with embodiments of the present disclosure. Operations start at when communication system is activated. At enterprise hub may communicate with client over VPN tunnel . At enterprise hub may monitor its traffic load. At enterprise hub may determine if the traffic load is higher than the first threshold e.g. excessive traffic load . If the traffic load is higher than the first threshold enterprise hub may send a cloud request to service provider hub over VPN tunnel requesting certain cloud capabilities at . Enterprise hub may also send a notification to client with directive to connect with service provider hub . Thereafter enterprise hub may continue to monitor the traffic load at .

If the traffic load is not higher than the first threshold at enterprise hub may check if the traffic load is lower than the second threshold e.g. moderate traffic at . If the traffic load is lower than the second threshold enterprise hub may send another notification to client with a directive to resume traffic with enterprise hub at . If the traffic load is not lower than the second threshold e.g. the traffic load continues to be high but not higher than the first threshold enterprise hub may continue to service some clients and not others and monitor traffic at .

At enterprise hub may determine whether client is seeking to terminate VPN tunnel . If not enterprise hub continues to monitor the traffic at . Otherwise enterprise hub may terminate VPN tunnel with client at . In some embodiments enterprise hub may also terminate VPN tunnel with service provider . The operations may end at .

Turning to is a simplified flow diagram illustrating example operational steps that may be associated with embodiments of the present disclosure. Operations may start at when communication system is activated. At enterprise hub may receive a cloud request over a VPN tunnel e.g. from client . At enterprise hub may analyze the ISAKMP payload. At enterprise hub may determine the requested cloud capabilities from the ISAKMP payload. At enterprise hub may exchange a copy of SADB with service provider hub . At enterprise hub may map the requested cloud capabilities to appropriate cryptographic modules over another VPN tunnel e.g. through service provider hub . At enterprise hub may offload VPN tunnel to cryptographic modules . At enterprise hub may communicate with cryptographic modules over VPN tunnel .

For example enterprise hub may forward encrypted packets from client to cryptographic modules . Using information from SADB service provider hub may facilitate decrypting the packets with cryptographic modules . Service provider hub may forward the decrypted packets to enterprise hub over VPN tunnel . Similarly enterprise hub may forward clear packets from client to cryptographic modules . Using information from SADB service provider hub may facilitate encrypting the packets with cryptographic modules . Service provider hub may forward the encrypted packets to enterprise hub over VPN tunnel . Enterprise hub may thus offload cryptographic capabilities to cloud . The operations may end at .

In example embodiments at least some portions of the activities outlined herein may be implemented in non transitory logic i.e. software provisioned in for example nodes embodying various elements of communication system . This can include one or more instances of IKE processing node and or cryptographic modules M being provisioned in various locations of the network. In some embodiments one or more of these features may be implemented in hardware provided external to these elements or consolidated in any appropriate manner to achieve the intended functionality. IKE processing node and or cryptographic modules M may include software or reciprocating software that can coordinate in order to achieve the operations as outlined herein. In still other embodiments these elements may include any suitable algorithms hardware software components modules interfaces or objects that facilitate the operations thereof.

Furthermore components of communication system described and shown herein may also include suitable interfaces for receiving transmitting and or otherwise communicating data or information in a network environment. Additionally some of the processors and memory associated with the various nodes may be removed or otherwise consolidated such that a single processor and a single memory location are responsible for certain activities. In a general sense the arrangements depicted in the FIGURES may be more logical in their representations whereas a physical architecture may include various permutations combinations and or hybrids of these elements. It is imperative to note that countless possible design configurations can be used to achieve the operational objectives outlined here. Accordingly the associated infrastructure has a myriad of substitute arrangements design choices device possibilities hardware configurations software implementations equipment options etc.

In some of example embodiments one or more memory elements e.g. memory element can store data used for the operations described herein. This includes the memory element being able to store instructions e.g. software logic code etc. that are executed to carry out the activities described in this Specification. A processor can execute any type of instructions associated with the data to achieve the operations detailed herein in this Specification. In one example one or more processors e.g. processor could transform an element or an article e.g. data from one state or thing to another state or thing. In another example the activities outlined herein may be implemented with fixed logic or programmable logic e.g. software computer instructions executed by a processor and the elements identified herein could be some type of a programmable processor programmable digital logic e.g. a field programmable gate array FPGA an erasable programmable read only memory EPROM an electrically erasable programmable read only memory EEPROM an ASIC that includes digital logic software code electronic instructions flash memory optical disks CD ROMs DVD ROMs magnetic or optical cards other types of machine readable mediums suitable for storing electronic instructions or any suitable combination thereof.

Components in communication system can include one or more memory elements e.g. memory element for storing information to be used in achieving operations as outlined herein. These devices may further keep information in any suitable type of memory element e.g. random access memory RAM read only memory ROM field programmable gate array FPGA erasable programmable read only memory EPROM electrically erasable programmable ROM EEPROM etc. software hardware or in any other suitable component device element or object where appropriate and based on particular needs. The information being tracked sent received or stored in communication system could be provided in any database register table cache queue control list or storage structure based on particular needs and implementations all of which could be referenced in any suitable timeframe. Any of the memory items discussed herein should be construed as being encompassed within the broad term memory element. Similarly any of the potential processing elements modules and machines described in this Specification should be construed as being encompassed within the broad term processor. 

Note that with the numerous examples provided herein interaction may be described in terms of two three four or more nodes. However this has been done for purposes of clarity and example only. It should be appreciated that the system can be consolidated in any suitable manner. Along similar design alternatives any of the illustrated computers modules components and elements of the FIGURES may be combined in various possible configurations all of which are clearly within the broad scope of this Specification. In certain cases it may be easier to describe one or more of the functionalities of a given set of flows by only referencing a limited number of nodes. It should be appreciated that communication system of the FIGURES and its teachings are readily scalable and can accommodate a large number of components as well as more complicated sophisticated arrangements and configurations. Accordingly the examples provided should not limit the scope or inhibit the broad teachings of communication system as potentially applied to a myriad of other architectures.

Note that in this Specification references to various features e.g. elements structures modules components steps operations characteristics etc. included in one embodiment example embodiment an embodiment another embodiment some embodiments various embodiments other embodiments alternative embodiment and the like are intended to mean that any such features are included in one or more embodiments of the present disclosure but may or may not necessarily be combined in the same embodiments.

It is also important to note that the operations and steps described with reference to the preceding FIGURES illustrate only some of the possible scenarios that may be executed by or within the system. Some of these operations may be deleted or removed where appropriate or these steps may be modified or changed considerably without departing from the scope of the discussed concepts. In addition the timing of these operations may be altered considerably and still achieve the results taught in this disclosure. The preceding operational flows have been offered for purposes of example and discussion. Substantial flexibility is provided by the system in that any suitable arrangements chronologies configurations and timing mechanisms may be provided without departing from the teachings of the discussed concepts.

Although the present disclosure has been described in detail with reference to particular arrangements and configurations these example configurations and arrangements may be changed significantly without departing from the scope of the present disclosure. For example although the present disclosure has been described with reference to particular communication exchanges involving certain network access and protocols communication system may be applicable to other exchanges or routing protocols in which packets are exchanged in order to provide mobility data connectivity parameters access management etc. Moreover although communication system has been illustrated with reference to particular elements and operations that facilitate the communication process these elements and operations may be replaced by any suitable architecture or process that achieves the intended functionality of communication system .

Numerous other changes substitutions variations alterations and modifications may be ascertained to one skilled in the art and it is intended that the present disclosure encompass all such changes substitutions variations alterations and modifications as falling within the scope of the appended claims. In order to assist the United States Patent and Trademark Office USPTO and additionally any readers of any patent issued on this application in interpreting the claims appended hereto Applicant wishes to note that the Applicant a does not intend any of the appended claims to invoke paragraph six 6 of 35 U.S.C. section 112 as it exists on the date of the filing hereof unless the words means for or step for are specifically used in the particular claims and b does not intend by any statement in the specification to limit this disclosure in any way that is not otherwise reflected in the appended claims.

