---

title: Controlling a packet flow from a user equipment
abstract: A method and User Equipment (UE) for limiting excessive packet flow from the UE to a communication network. The UE receives from the network, an instruction to activate a logic parameter for controlling the packet flow from the UE to the network. In response to receiving the instruction, the UE requests configuration of a network connection for transmitting packets to the network according to the logic parameter. The UE then requests deactivation of all other network connections upon successful configuration of the network connection for transmitting packets to the network according to the logic parameter.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09467391&OS=09467391&RS=09467391
owner: Telefonaktiebolaget LM Ericsson (publ)
number: 09467391
owner_city: Stockholm
owner_country: SE
publication_date: 20141117
---
This application is a continuation of co pending U.S. patent application Ser. No. 13 608 484 filed on Sep. 10 2012 which is a continuation of U.S. patent application Ser. No. 12 694 378 filed on Jan. 27 2010 now U.S. Pat. No. 8 289 848 which claims the benefit of U.S. Provisional Application No. 61 149 183 filed Feb. 2 2009 the contents of which are incorporated by reference herein in their entireties.

The present invention relates to radio telecommunication systems. More particularly and not by way of limitation the present invention is directed to a method device and node for controlling a packet flow from a User Equipment UE in a radio telecommunication system.

Today several actors are involved in managing the software and hardware of a UE such as a mobile telephone or other communication device in a wireless communication system. The software can be applications services and modules including the operating system stored in and used by the UE. The UE s manufacturer typically installs a collection of software in the UE at the time the device is manufactured. Later an end user may modify the UE s software by downloading to the UE applications and the like from different sources via for example the Internet. The UE s manufacturer the operator of the communication system to which the UE is subscribed or in which the UE is visiting and or an authorized third party depending on business agreements may also remotely modify part or all of the UE s software.

After such modifications and in other instances the UE may behave improperly. From a system operator s point of view for example improper behavior may include the UE s diminishing the capacity of the communication system by increasing the number of control or other messages exchanged with the system. Improper UE behavior can arise in a number of ways such as unexpected interactions between software modules in the UE malicious software modules and the like. A user might download a malicious or malformed application such as a Java application which interacts with the network protocol stack through open Application Programming Interfaces APIs in the UE. As a result the UE may repeatedly send service requests to an operator s network.

Techniques for dealing with improper UE behavior by disabling services to a UE have been discussed in standardization organizations such as the Third Generation Partnership Project 3GPP . The 3GPP promulgates specifications for the GSM telecommunications system and its enhancements such as Enhanced Data Rates for GSM Evolution EDGE the universal mobile telecommunications system UMTS the Long Term Evolution LTE access network and systems employing wideband code division multiple access WCDMA .

The Third Generation Partnership Project Technical Specification 3GPP TS 24.305 describes procedures for managing settings of the UE for remotely disabling selected UE capabilities used over a 3GPP access i.e. a circuit switched CS and packet switched PS domain over GERAN UTRAN radio access.

The Open Mobile Alliance OMA has developed specifications for Device Management DM of communication devices and versions 1.1.2 and 1.2 of those specifications define a protocol for managing configuration data and settings in communication devices. OMA standards and other information are publicly available through the OMA organization. OMA DM can be used to manage the configuration and Management Objects MOs of UEs from the point of view of different DM Authorities including setting initial configuration information in UEs subsequently updating persistent information in UEs retrieving management information from UEs and processing events and alarms generated by UEs. An MO is generally a software object that may be written for example according to SyncML which is a mark up language specification of an XML based representation protocol synchronization protocol and DM protocol transport bindings for the protocols and a device description framework for DM. Using OMA DM third parties can configure UEs on behalf of end users. A third party such as a network operator service provider and corporate information management department can remotely set UE parameters and install or upgrade software through suitable MOs in the UE.

The Evolved Packet System EPS has been defined since 3GPP release 8 as a system for mobile communication using packet data over an evolved GPRS network. The core network is an evolved UMTS packet core network and the radio access network may be an evolved UTRAN E UTRAN a non 3GPP access network for example WLAN or a combination of both. The 3GPP Technical Specifications 3GPP TS 23.401 and 3GPP TS 24.301 describe the GPRS enhancements for E UTRAN access.

To stay registered in the EPS an EPS bearer must be retained as otherwise the EPS mobility procedures will be rejected by the EPS network as described in 3GPP TS 23.401. Also as described in 3GPP TS 24.305 the OMA DM server controlling the Selective Disabling of a 3GPP UE Capabilities Management Object SDoUE MO needs to be able to push down updates of the MO to the UE. The push of MO updates using SMS cannot always be assumed to be available unless both the UE and the network support SMS using CS Fallback capabilities described in 3GPP TS 23.272 and even then a PS access is required to be open. Thus the MO update may need to be sent over the PS access. Therefore the PS access open in the UE needs to be accessible by the OMA DM server. Consequently an EPS bearer towards a Packet Data Network PDN needs to be retained until the software in the UE has been updated. This may imply a risk of flooding the network with malicious traffic if the UE has been hacked.

The present invention solves or at least mitigates the risk of flooding the radio access network and core network with malicious UE initiated traffic. The invention enables the UE to retain a PDN connection with an EPS bearer open that enables the OMA DM server to communicate with the UE and ensure the EPS mobility procedure works. In one embodiment the invention provides the operator with the ability to provision an Access Point Name APN and a Traffic Flow Template TFT to be used until the operator has enabled UE initiated EPS services again.

Thus in one embodiment the present invention is directed to a method in a UE for limiting packet flow from the UE to a communication network. The method includes the steps of receiving from the network an instruction to activate a logic parameter for controlling the packet flow from the UE to the network requesting configuration of a network connection for transmitting packets to the network according to the logic parameter and requesting deactivation of all other network connections. The logic parameter may be in a management object and may be pre stored in the UE or may accompany the instruction.

In another embodiment the present invention is directed to a UE that includes means for receiving from a communication network an instruction to activate a logic parameter for controlling a packet flow from the UE to the network means for requesting configuration of a network connection for transmitting packets to the network according to the logic parameter and means for requesting deactivation of all other network connections.

In another embodiment the present invention is directed to a device management server in a communication network for remotely controlling a packet flow from a mobile communication device. The server includes means for storing a management object that includes at least one of a flag a defined Access Point Name APN and a logic parameter for controlling the packet flow from the mobile communication device to the network and means for downloading the management object to the mobile communication device. The flag when downloaded to the mobile communication device causes the device to activate the logic parameter in the management object or to activate a stored logic parameter in the device. The defined APN when downloaded to the mobile communication device causes the device to send a request to establish a new connection to the network on which packet flow from the device is controlled according to the logic parameter.

In another embodiment the present invention is directed to a Packet Data Network PDN Gateway. The PDN Gateway includes means for receiving from a UE a PDN connectivity request to establish a new PDN connection and means for limiting a packet flow from the UE on the new PDN connection according to defined parameters.

For economy of explanation this application focuses on wireless communication systems that comply with specifications promulgated by the 3GPP but it should be understood that the principles described in this application can be implemented in other communication systems. It will also be understood that this description is written in terms of OMA DM but this description should not be interpreted as being limited to OMA DM. Independent of the mechanism used to disable or enable services in a UE it is advantageous for the UE to be selectively controllable in a standardized way.

The present invention updates 3GPP TS 24.305 procedures to handle the difference between EPS 3GPP TS 24.301 and GPRS 3GPP TS 24.008 . The disabling of EPS is different than for GPRS. In EPS the UE can request procedures for EPS contexts but only the network can initiate them this in normal cases includes the case of deactivation . Therefore in exemplary embodiments of the present invention the operator is provided with the ability to disable mobile requested EPS Session Management SM procedures. In one embodiment a logic parameter is downloaded to the UE causing the UE to request a new PDN connection towards the network with either a defined APN or no APN if the defined APN is not available for the UE. The UE requests deactivation of all previously existing PDN connections and utilizes a particular traffic flow mapping for an EPS context that provides the network operator with control of packet access from UE applications.

In another embodiment the logic parameter causes the UE to send the defined APN in the request for a new PDN connection. The defined APN causes the network to establish the new PDN connection with a particular PDN GW configured to control the traffic flow from the UE in accordance with the particular traffic flow mapping. Optionally the PDN GW may push traffic flow mapping parameters to the UE.

It should be noted that in different configurations of the 3GPP network architecture the gateway may utilize either the GPRS Tunneling Protocol GTP or the Proxy Mobile IP PMIP protocol as a network mobility protocol. When GTP is utilized it is the PDN GW that may push traffic flow mapping parameters to the UE. When PMIP is utilized the Serving GW may provide this part of the PDN GW functionality. Thus when the PDN GW is referred to herein the term is intended to include the functionality of pushing traffic flow mapping parameters to the UE whether the push is made by the PDN GW or by the Serving GW.

In another embodiment the logic parameter causes the UE to utilize an existing PDN connection towards the network rather than establishing a new connection. Again the UE requests deactivation of other PDN connections if any and utilizes a particular traffic flow mapping for an EPS context that provides the network operator with control of packet access from UE applications.

In another embodiment the OMA DM server may know that the UE includes an internal application to ensure that only the application s controlling the connection towards the OMA DM server and potentially emergency calls are allowed access to use the PS connection. In such case the OMA DM server does not have to download any APN or logic parameter to the UE. Instead the OMA DM server may send only a flag instructing the UE to activate the internal application.

Once the network operator has control of packet access from UE applications the operator can prevent a misbehaving UE from flooding the network with malicious or erroneous traffic. As part of the correction process a device management server such as an OMA DM server can push corrective software to the UE to correct or replace a corrupted application causing the misbehavior. In addition the logic parameter may also limit the packet flow to a maximum data rate or a maximum packet size.

In an exemplary embodiment of the present invention the existing SDoUE MO is enhanced to support the case of EPS with the addition of the following new nodes EPS SM EPS APN TrafficMappingInfo NumberOfPacketFilters and PacketFilterList. When downloaded to the UE the enhanced SDoUE MO adds at least the following capabilities to a device management server such as an OMA DM server 

1. The capability to separately disable UE initiated EPS procedures such as UE requested PDN connectivity UE requested bearer resource modification and UE requested PDN disconnect as well as to provide restriction to EPS services.

2. The capability to provision a special APN to which the UE can set up a PDN connection. This enables the PDN Gateway PDN GW to restrict the UE traffic to only traffic necessary for communication with the OMA DM server and potentially IP Multimedia Subsystem IMS emergency calls.

3. The capability to locally install the essential Uplink Traffic Flow Template UL TFT parameters in the UE to restrict the UE s ability to send IP packets other than those allowed by the operator for example those required towards the OMA DM server.

If an APN is provided in the SDoUE MO the PDN connection may be established with a PDN GW that is pre configured with TFT type information that can be set on the EPS bearer. However if no APN is provided the operator may establish the PDN connection to another PDN GW utilizing a default APN.

With continuing reference to the following paragraphs describe additions required to the indicated sections of 3GPP TS 24.305 in order to describe the new nodes and leaf objects of the enhanced SDoUE MO management object 

The EPS Session Management SM procedures for EPS contexts EPS SM EPS interior node is a flag indicating an operator s preference to enable or disable mobile requested EPS SM procedures for EPS contexts i.e. UE requested PDN connectivity UE requested bearer resource modification and UE requested PDN disconnect as well as to provide restriction to EPS services.

0 Indicates that mobile requested EPS SM procedures for EPS contexts are enabled and no restriction to EPS services applies.

1 Indicates that mobile requested EPS SM procedures for EPS contexts are disabled and restriction to EPS services applies.

The TrafficMappingInfo interior node is used to enable configuring the minimum acceptable traffic flow template TFT parameters packet filters for EPS context according to the operator s preference.

The information provided by the TrafficMappingInfo interior node is used by the UE only when the EPS SM EPS leaf value is set to 1 .

The NumberOfPacketFilters leaf object indicates the number of traffic filters contained in the PacketFilterList leaf .

The NumberOfPacketFilters is an unsigned 8 bit integer and the value range is defined as the number of packet filters parameter in the traffic flow template information element see subclause 10.5.6.12 in 3GPP TS 24.008 3 .

The PacketFilterList is an unsigned 64 bit integer. The bit pattern shall be encoded as the packet filter list parameter in the traffic flow template information element see subclause 10.5.6.12 in 3GPP TS 24.008 3 with the least significant bit in the rightmost position of the integer. For example if the parameter is encoded into bits and in 3GPP TS 24.008 3 then it must be encoded into bits and in this leaf.

At step the OMA DM server sends the modified SDoUE MO to the UE. At step the UE initiates a new UE requested PDN connectivity procedure toward the network as described in 3GPP TS 24.301 6A . At step it is determined whether the APN leaf exists in the modified SDoUE MO . If the APN leaf does not exist the method moves to step where the UE sends a PDN CONNECTIVITY REQUEST message without including any APN in the message and the network utilizes a default APN for establishing an EPS context with a PDN GW at step . However if the APN leaf exists the method moves instead to step where the UE sends the PDN CONNECTIVITY REQUEST message and includes the value defined in the APN leaf as the APN in the message. At step the network utilizes the defined APN for establishing an EPS context with a PDN GW associated with the defined APN.

After successful completion of the UE requested PDN connectivity procedure at step it is determined at step whether the TrafficMappingInfo interior node exists in the modified SDoUE MO . The TrafficMappingInfo interior node as shown in provides at least one logic parameter for controlling the packet flow from the UE. If the TrafficMappingInfo node does not exist the method moves to step where the UE transmits packets on the new PDN connection without filtering the packets. At step the PDN GW associated with the defined APN may optionally be configured to control the traffic flow from the UE or to download to the UE a logic parameter for controlling the traffic flow from the UE. At step the UE utilizes the logic parameter i.e. traffic mapping information filters to limit packet transmissions on the EPS context established by the UE requested PDN connectivity procedure. Returning to step if it is determined that the TrafficMappingInfo interior node does exist in the SDoUE MO the method moves directly to step .

Furthermore the UE continues to limit packet transmissions on the EPS context in accordance with the logic parameter until the EPS SM EPS leaf value is reset to 0 . The UE is however allowed to temporarily stop using the traffic mapping information in the following cases 

At step the UE initiates the signaling procedure for UE requested PDN disconnection as described in 3GPP TS 24.301 6A of all previously existing PDN connections thus leaving only the new one which was established by the successful completion of the UE requested PDN connectivity procedure. At step the EPS context provides the network operator with control of packet access from UE applications. As noted above in EPS the UE can request procedures for EPS contexts but only the network can initiate them for normal cases this includes the case of deactivation . Therefore in this exemplary embodiment of the present invention the operator is provided with the ability to disable mobile requested EPS Session Management SM procedures.

It should be noted that the invention is not restricted to a specific order of the PDN connectivity request procedure and the deactivation of existing bearers the only restriction is that the UE always need to keep at least one PDN connection to avoid getting detached from the EPS. A different order may be required in case the UE and or EPS is currently using the maximum number of EPS bearers supported by the UE and or the EPS e.g. Mobility Management Entity MME Serving GW or PDN GW . For example the UE may receive a rejection of an initial PDN connectivity request and in response first deactivate one of the available PDN connections to free up resources before initiating the PDN connectivity procedure for the PDN connection to be used towards the OMA DM server.

Receipt of the SDoUE MO in the UE causes a PDN connectivity request unit to initiate a new PDN connectivity procedure by sending a PDN CONNECTIVITY REQUEST message to the network . The network establishes a new EPS Context between the UE and a PDN GW . Upon establishment of the new EPS Context a previous PDN connections deactivation unit sends a PDN disconnection request to the network to disconnect any previously established PDN connections. This leaves only the new EPS Context in place between the UE and the network and packet transmissions from the UE over this context are controlled by the logic parameter packet filters in the SDoUE MO F. Thus the network has control of packet access through a packet filtering unit as controlled by a processor and applications .

In this manner the present invention solves or at least mitigates the risk of flooding the radio access network and core network with malicious UE initiated traffic. The invention enables the UE to retain a PDN connection with an EPS bearer open until the software in the UE has been updated.

As will be recognized by those skilled in the art the innovative concepts described in the present application can be modified and varied over a wide range of applications. Accordingly the scope of patented subject matter should not be limited to any of the specific exemplary teachings discussed above but is instead defined by the following claims.

