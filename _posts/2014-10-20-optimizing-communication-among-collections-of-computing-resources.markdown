---

title: Optimizing communication among collections of computing resources
abstract: Techniques for provisioning computing resources utilize colorings of collections of resources. The collections may be networks of resources hosted by a computing resource provider that are operated under the direction of one or more customers of the resource provider. Colors may be applied to the collections of resources, such as by a customer of the resource provider. The same customer or another customer may request that resources be provisioned according to at least one relationship with one or more collections of resources having one or more colors. Resources may then be provisioned according to the request.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09444763&OS=09444763&RS=09444763
owner: Amazon Technologies, Inc.
number: 09444763
owner_city: Reno
owner_country: US
publication_date: 20141020
---
This patent application is a Continuation of U.S. Non Provisional patent application Ser. No. 13 074 982 filed Mar. 29 2011 granted as U.S. Pat. No. 8 868 766 on Oct. 21 2014 and entitled Optimizing Communication Among Collections of Computing Resources the content of which is herein incorporated by reference in its entirety. Further this application incorporates by reference for all purposes the full disclosure of application Ser. No. 12 973 746 entitled Virtual Resource Provisioning with Capacity Coloring filed on Dec. 20 2010.

It has become common for individuals and organizations to use computers and networks of computers to perform and assist in a wide variety of activities. Rather than owning and maintaining physical computers and associated facilities it is becoming more and more common to provision virtual computer systems and other virtual computing resources with a specialized provider of such virtual resources. Such virtual resource provisioning can provide a number of advantages such as reduced cost of desired services and or rapid response to changing service needs. However conventional virtual resource provisioning has a number of shortcomings.

Virtual resource providers may operate large fleets of computer hardware and other resources used to implement the virtual resources provisioned to customers. It is not uncommon for there to be a deliberate layer of abstraction between the virtual computing resources and the underlying implementation resources that decouples the two from a user s point of view. Such decoupling can enable a virtual resource provider to engage in sophisticated allocation and re allocation of the underlying implementation resources for purposes including efficient implementation resource utilization load balancing and fault tolerance without requiring the user to be concerned with implementation details. However at times users can become concerned about particular implementation details for example due to security concerns performance concerns and regulatory requirements. Some conventional virtual resource providers attempts to address such concerns can have significant negative impacts on implementation resource allocation efficiency and or effectiveness including increased computational and or financial cost and reduced fault tolerance.

Same numbers are used throughout the disclosure and figures to reference like components and features but such repetition of number is for purposes of simplicity of explanation and understanding and should not be viewed as a limitation on the various embodiments.

In the following description various embodiments will be described. For purposes of explanation specific configurations and details are set forth in order to provide a thorough understanding of the embodiments. However it will also be apparent to one skilled in the art that the embodiments may be practiced without the specific details. Furthermore well known features may be omitted or simplified in order not to obscure the embodiment being described.

Virtual resource provisioning may be enhanced by coloring virtual resource instances and or underlying implementation resources. Particular resource colors may be associated with particular treatments during allocation of implementation resources to virtual resources. The term color is used herein in a graph theoretic sense. For example a color may correspond to an alphanumeric string or other suitable distinguishing identifier specified by a user. Association with the identifier may be said to color a resource. In at least one embodiment there may be different types of colors corresponding to different types of allocation treatment. For example the types of colors may include an exclusory color type an inclusive color type and or a proximity color type as described in application Ser. No. 12 973 746 entitled Virtual Resource Provisioning with Capacity Coloring referenced above.

In at least one embodiment collections of computing resources are able to be colored. A collection may be for example a network of resources hosted by a virtual resource provider where the network of resources is operated under the direction of a customer of the virtual resource provider. Such a collection is sometimes referred to as a virtual private cloud. Other types of collections are also possible such as groupings of resources having a common characteristics user constructed groupings of resources collections of networks and generally any collection of resources that may be constructed. The coloring of the resources may be performed by various users involved in the use of the resources. Customers of the virtual resource provider may for example color their own and others resources. As another example the virtual resource provider may color resources.

In an embodiment resource colorings are used in processes for provisioning or otherwise allocating resources. In one example a customer of a virtual resource provider is able to request resources and specify conditions that involve one or more colors of one or more other resources. The one or more other resources may be resources of the customer of another customer or of the virtual resource provider. The conditions may be specified in various ways. For example the specification of a color of a particular color type for a set of requested resources may indicate a condition that is required to be fulfilled or preferably fulfilled. In this manner the color type itself indicates the condition.

As another example a request to provision resources may specify a condition that involves one or more resources that have been colored with one or more colors. In this manner a color type of a color of one or more colored resources does not necessarily indicate any conditions of the request. A customer may for instance have colored a network of resources with a particular color and may have made a request for new resources that specifies one or more conditions based on the particular color. The customer may specify that the requested resources should be provisioned in a location such as a different data center different from the resources of the particular color. In this manner the customer may attempt to ensure that a failure of one or more of the resources of the particular color is unlikely to affect the requested resources and vice versa. Similarly the customer may specify that the requested resources should be provisioned in the same location such as the same data center as the requested resources. The customer may for example be attempting to locate the requested resources as close as possible to ensure that communications between the set of resources of the particular color and the requested resources are as fast as possible. The virtual resource provider may then attempt to provision the requested resources for the customer according to the conditions specified by the customer.

Conditions placed on colors of collections of resources may include notions of proximity. Users may specify for example that resources should be provisioned close to or far from resources colored with a particular color. Distance may be measured in various ways. For example distance may mean geographic distance. Distance may also be measured in a way that takes into account characteristics of a network. Distance may be measured for example in terms of latency bandwidth and or network hop counts between resources. For any definition of distance distance to collection of resources may be determined as the minimum distance to any of the resources that are accessible from outside of the collection. The distance may also be determined in other ways such as by determining a maximum value which may be an upper bound for a measure of a network characteristic such as latency . The collection may be accessible for example through one or more Internet protocol IP addresses and the distance to the collection may be determined as the minimum distance to any of the one or more IP addresses of the collection. As another example proximity may be determined based at least in part on network usage or other costs connected with the transfer of information among resources. For instance a user of resources may have to pay different charges for network traffic traveling through different provider networks. Generally the cost of transferring information in one manner may be different than in other manners. Proximity may be determined such that the distance between a resource and at least one other resource is lower when the cost of transmitting information between the resources is lower. Generally distance and other values used in one or more conditions may be measured in any manner suitable in particular circumstances.

As noted above attempts to provision resources in accordance with one or more conditions on colored resources may be made. Such attempts may not always be successful. A virtual resource provider may for instance not have any available resources that satisfy a customer s request. As another example conditions may be provided that are impossible to satisfy. For instance a customer may require or prefer that resources be provisioned both close to and far from a collection of resources of a particular color. In some instances conditions may not be structured in a manner that allows for a straightforward determination whether the conditions are satisfied. As an example a request that resources be provisioned close to resources with a particular color may not specify a definition that allows a binary definition of whether resources are close or not close. A customer may for example specify that requested resources should be provisioned as close as possible to resources of a particular color. In such instances attempts may be made to provision resources in a manner that confirms with the conditions as best as possible. For example a request to provision resources close to resources of a particular color for some definition of distance may be completed by provisioning the requested resources as close as possible to the resources of the particular color.

In various embodiments information may be provided that indicates how well requests to provision resources were or can be completed. A customer of a virtual resource provider may for example request provisioning of a virtual machine instance as close as possible to a set of resources colored with a particular color. The virtual resource provider may provision the virtual machine instance and indicate to the customer how close the virtual machine instance was provisioned to the resources of the particular color. For example the virtual resource provider may indicate that the virtual machine instance has been provisioned within a certain number of network hops from the resources of the particular color. As another example a customer of the virtual resource provider may request resources with one or more conditions and the virtual resource provider may provide a general indication of whether the conditions were met when fulfilling the request. In other words the virtual resource provider may simply indicate whether it was able to fulfill the request according to the one or more conditions.

In some instances conditions that take resource coloring into account may be used to improve the provisioning of resources over time. A virtual resource provider for example may provision resources for a customer. As the customer uses its provisioned resources the virtual resource provider may measure the customer s use of other resources determine whether performance for the customer may improve by re provisioning the customer s resources and if applicable re provision the customer s resources as applicable. As a specific example if the virtual resource provider detects that the customer s provisioned resources often access a service of the customer of another customer or of the virtual resource provider implemented using resources colored with a color the virtual resource provider may then determine whether the customer s resources would perform better if moved closer to the resources of the color and if applicable migrate the customer s resources closer to the resources of the color thereby decreasing latency increasing bandwidth and or otherwise improving performance for the customer.

The above and other approaches discussed herein and variations thereof may be implemented in various environments for various applications. For example illustrates aspects of an example environment for implementing aspects in accordance with various embodiments. As will be appreciated although a Web based environment may be utilized for purposes of explanation different environments may be utilized as appropriate to implement various embodiments. The environment shown includes both a testing or a development portion or side and a production portion. The production portion includes an electronic client device which may include any appropriate device operable to send and receive requests messages or information over an appropriate network and convey information back to a user of the device . Examples of such client devices include personal computers cell phones handheld messaging devices laptop computers tablet computers set top boxes personal data assistants electronic book readers and the like.

The network may include any appropriate network including an intranet the Internet a cellular network a local area network a wide area network a wireless data network or any other such network or combination thereof. Components utilized for such a system may depend at least in part upon the type of network and or environment selected. Protocols and components for communicating via such a network are well known and will not be discussed herein in detail. Communication over the network may be enabled by wired or wireless connections and combinations thereof. In this example the network includes the Internet as the environment includes a Web server for receiving requests and serving content in response thereto although for other networks an alternative device serving a similar purpose could be utilized as would be apparent to one of ordinary skill in the art.

The illustrative environment includes at least one application server and a data store . It should be understood that there may be several application servers layers or other elements processes or components which may be chained or otherwise configured which may interact to perform tasks such as obtaining data from an appropriate data store. As used herein the term data store refers to any device or combination of devices capable of storing accessing and or retrieving data which may include any combination and number of data servers databases data storage devices and data storage media in any standard distributed or clustered environment.

The application server may include any appropriate hardware and software for integrating with the data store as needed to execute aspects of one or more applications for the client device and may even handle a majority of the data access and business logic for an application. The application server provides access control services in cooperation with the data store and is able to generate content such as text graphics audio and or video to be transferred to the user which may be served to the user by the Web server in the form of HTML XML or another appropriate structured language in this example.

The handling of all requests and responses as well as the delivery of content between the client device and the application server may be handled by the Web server . It should be understood that the Web and application servers are not required and are merely example components as structured code discussed herein may be executed on any appropriate device or host machine as discussed elsewhere herein. Further the environment may be architected in such a way that a test automation framework may be provided as a service to which a user or application may subscribe. A test automation framework may be provided as an implementation of any of the various testing patterns discussed herein although various other implementations may be utilized as well as discussed or suggested herein.

The environment may also include a development and or testing side which includes a user device allowing a user such as a developer data administrator or tester to access the system. The user device may be any appropriate device or machine such as is described above with respect to the client device . The environment may also include a development server which functions similar to the application server but typically runs code during development and testing before the code is deployed and executed on the production side and becomes accessible to outside users for example. In some embodiments an application server may function as a development server and separate production and testing storage may not be utilized.

The data store may include several separate data tables databases or other data storage mechanisms and media for storing data relating to a particular aspect. For example the data store illustrated includes mechanisms for storing production data and user information which may be utilized to serve content for the production side. The data store also is shown to include a mechanism for storing testing data which may be utilized with the user information for the testing side. It should be understood that there may be many other aspects that are stored in the data store such as for page image information and access right information which may be stored in any of the above listed mechanisms as appropriate or in additional mechanisms in the data store .

The data store is operable through logic associated therewith to receive instructions from the application server or development server and obtain update or otherwise process data in response thereto. In one example a user might submit a search request for a certain type of item. In this case the data store might access the user information to verify the identity of the user and may access the catalog detail information to obtain information about items of that type. The information then may be returned to the user such as in a results listing on a Web page that the user is able to view via a browser on the user device . Information for a particular item of interest may be viewed in a dedicated page or window of the browser.

Each server typically will include an operating system that provides executable program instructions for the general administration and operation of that server and typically will include a computer readable medium storing instructions that when executed by a processor of the server allow the server to perform its intended functions. Suitable implementations for the operating system and general functionality of the servers are known or commercially available and are readily implemented by persons having ordinary skill in the art particularly in light of the disclosure herein.

The environment in one embodiment is a distributed computing environment utilizing several computer systems and components that are interconnected via communication links using one or more computer networks or direct connections. However it will be appreciated by those of ordinary skill in the art that such a system could operate equally well in a system having fewer or a greater number of components than are illustrated in . Thus the depiction of the system in should be taken as being illustrative in nature and not limiting to the scope of the disclosure.

In at least one embodiment one or more aspects of the environment may incorporate and or be incorporated into a virtual resource provisioning architecture. depicts aspects of an example virtual resource provisioning architecture in accordance with at least one embodiment. The example virtual resource provisioning architecture includes multiple clients communicatively connected to a virtual resource provider over a network . For example the clients may correspond to computing devices such as the computing device of and or client programs incorporated into such computing devices. The ellipsis between the client and the client indicates that the virtual resource provisioning architecture may include any suitable number of clients although for clarity only two are shown in . Ellipses are used similarly throughout the drawings.

One or more of the clients may be utilized by one or more customers of the virtual resource provider to interact with a control plane of the virtual resource provider and thereby provision one or more virtual resources . Alternatively or in addition one or more of the clients may be utilized not necessarily by virtual resource provider customers to interact with provisioned virtual resources . The provisioned virtual resources may include any suitable type and or number of virtual resources . Examples of suitable virtual resources include virtual computer systems virtual network connections virtual data stores specialized data processing agents media streaming agents including audio and video streaming agents message queues publish subscribe topics configured to notify subscribers having subscriptions that match events published to the publish subscribe topics monitoring agents load balancing agents and suitable combinations thereof.

The virtual resource provider may include any suitable type and or number of implementation resources . Each of the virtual resources may be implemented by a set of the implementation resources . In at least one embodiment various implementation resources of the implementation resources may be configured to participate in implementing at least in part multiple virtual resources of the virtual resources . Examples of suitable implementation resources include virtual computer system VCS servers data store servers computers server racks networking hardware including switches routers gateways bridges hubs repeaters firewalls and wireless transceivers power supplies generators data centers rooms in data centers mobile data centers as well as non volatile storage devices including hard drives processing units such as central processing units CPUs caches in processing units processing cores in multi core processing units volatile storage devices such as memory modules including random access memory RAM modules and RAM chips of multi chip memory modules network interface hardware and suitable combinations thereof. The control plane may process virtual resource provisioning requests manage allocation of virtual resources to implementation resources and or manage allocation of implementation resources to virtual resources . An example virtual resource provider control plane in accordance with at least one embodiment is described below in more detail with reference to .

Particular implementation resources and or particular sets of implementation resources may correspond to points of failure and or to failure risk domains associated with a failure probability and or an annualized failure rate AFR . For example a particular type of hard drive may have an AFR of 1 . A data center may correspond to a risk domain capable of operating within specifications 99.8 of the time. At least a subset of such implementation resources and or risk domains may be colorable. That is the control plane may associate such implementation resources and or risk domains with a color for provisioning and or allocation purposes. Further examples of colorable risk domains include geographical regions including earthquake risk zones and flood risk zones domains defined by regulatory boundaries including political boundaries and organizational boundaries domains corresponding to independent virtual resource providers and domains corresponding to any suitable set of implementation resources.

At least a subset of the implementation resources may implement at least in part multiple virtual resources that is may be multi instance implementation resources. Multi instance implementation resources may have a capacity measurable in implementation resource allocation units allocation units or slots corresponding to minimum allocable portions of the multi instance implementation resources. Some virtual resources may require no more than one allocation unit from a multi instance implementation resource while other virtual resources may require multiple allocation units. For example a VCS server may have a capacity of sixteen allocation units and a small type virtual computer system may require a single allocation unit at the VCS server whereas a large type virtual computer system may require four allocation units at the VCS server. The virtual resource provider may maintain virtual resources for multiple customers. When a multi instance implementation resource is capable of participating in an implementation e.g. a secure and or private implementation of multiple virtual resources for multiple customers it is called a multi tenant implementation resource.

The virtual resource provider may maintain a general implementation resource pool containing a significant portion of the implementation resources that is the default implementation resource pool from which to allocate implementation resources to satisfy virtual resource provisioning requests. Alternatively or in addition the virtual resource provider may maintain one or more implementation resource pools containing different subsets of the implementation resources . For example different implementation resource pools may be established for different customers and or sets of customers. In at least one embodiment particular implementation resource pools may be dedicated to particular customers e.g. contain implementation resources that are not shared with other customers of the virtual resource provider . Particular implementation resource pools may be special purpose and or contain implementation resources of particular types. Particular transition procedures may be associated with entry to and exit from particular implementation resource pools. In at least one embodiment an implementation resource pool is an example of a colorable subset of the implementation resources of the virtual resource provider .

Provisioning configuration re configuration and or de provisioning collectively provisioning of virtual resources may be controlled by the control plane of the virtual resource provider . depicts aspects of an example control plane in accordance with at least one embodiment. The control plane of is an example of the control plane of . The control plane may include a provisioning interface configured at least to receive virtual resource provisioning requests from one or more of the clients a workflow component configured at least to guide responses to provisioning requests in accordance with one or more provisioning workflows and a resource allocation component configured at least to manage allocation of implementation resources to virtual resources .

The provisioning interface may include any suitable provisioning interface elements. Examples of suitable provisioning interface elements include interface elements that correspond to requests to provision the virtual resources interface elements that provide access to virtual resource configuration information and one or more interface elements enabling authentication to establish authority for such provisioning related operations. The provisioning interface may incorporate and or be incorporated in a user interface UI such as a graphical user interface GUI a Web based interface a programmatic interface such as an application programming interface API and or a set of remote procedure calls RPCs corresponding to provisioning interface elements a messaging interface such as a messaging interface in which the interface elements of the provisioning interface correspond to messages of a communication protocol and or any suitable combination thereof. Web based interfaces may include Web services interfaces such as Representational State Transfer REST compliant RESTful Web services interfaces or Simple Object Access Protocol SOAP compliant Web services interfaces or other non RESTful Web services interfaces.

In at least one embodiment the provisioning interface and the resource allocation component may create and or cause the workflow component to create one or more workflows that are then maintained by the workflow component . Workflows such as provisioning workflows and policy enforcement workflows may include one or more sequences of tasks to be executed to perform a job such as provisioning or policy enforcement. A workflow as the term is used herein is not the tasks themselves but a task control structure that may control flow of information to and from tasks as well as the order of execution of the tasks it controls. For example a workflow may be considered a state machine that can manage and return the state of a process at any time during execution. Workflows may be created from workflow templates. For example a provisioning workflow may be created from a provisioning workflow template configured with parameters by the resource allocation component .

The workflow component may modify further specify and or further configure established workflows. For example the workflow component may select particular implementation resources of the virtual resource provider to execute and or be assigned to particular tasks. Such selection may be based at least in part on the computing resource needs of the particular task as assessed by the workflow component . As another example the workflow component may add additional and or duplicate tasks to an established workflow and or reconfigure information flow between tasks in the established workflow. Such modification of established workflows may be based at least in part on an execution efficiency analysis by the workflow component . For example some tasks may be efficiently performed in parallel while other tasks depend on the successful completion of previous tasks.

As part of provisioning a virtual resource the provisioning interface and or the workflow component may request that the resource allocation component determine the appropriate set of the implementation resources required to implement the virtual resource determine whether the required implementation resources are available and or in accordance with virtual resource provider allocation policies and or allocate the required implementation resources. The resource allocation component may incorporate any suitable resource allocation and or resource scheduling algorithm. Various aspects of such algorithms are well known to those of skill in art so only some details are described herein. The resource allocation component may include a resource coloring component configured at least to establish and maintain resource color definitions and color associations with respect to the virtual resources and or the implementation resources of the virtual resource provider .

The resource coloring component may include a color specifications component configured at least to establish and maintain specifications and or definitions collectively specifications of resource colors of a variety of types. The types of resource color maintained by the color specification component may include resource color types corresponding to exclusory color specifications inclusive color specifications and proximity color specifications . Such specifications may include a name of a corresponding resource color and a scope of the corresponding resource color. For example a resource color name may correspond to a string of alphanumeric and or Unicode characters or other suitable distinguishing resource color identifier. The resource color scope may correspond to a specification domain with respect to the virtual resource provider within which the resource color identifier is required to be unique. Examples of resource color specification scopes include scoping to a customer or set of customers scoping to an implementation resource pool or set of implementation resource pools scoping to an implementation resource type or set of implementation resource types and scoping to the virtual resource provider as a whole.

Proximity color specifications may be associated with one or more sets of proximity criteria specifications . For example each proximity color defined by one of the proximity color specifications may be associated with one of the sets of proximity criteria specifications . Proximity criteria may specify criteria for determining a proximity of implementation resources in the implementation resource network. For example the proximity criteria may include a specification of a proximity metric based at least in part on communication connection capacity communication connection bandwidth and or communication connection one way or round trip latency. Alternatively or in addition the proximity criteria may include one or more sets of proximity thresholds corresponding to proximity regions in the implementation resource network. Such proximity regions may corresponding to levels of oversubscription to communication connection resources in the implementation resource network. As another alternative or further in addition the proximity criteria may be based at least in part on oversubscription ratios with respect to communication connection resources. The specifications maintained by the color specification component may be specified by an authorized user with the provisioning interface and or a suitable administrative interface not shown in .

The resource coloring component may further include a color index . The color index may track current associations between particular resource colors and particular sets of virtual resources and or implementation resources . For example the color index may track which of the implementation resources are currently painted with particular resource colors. An index maintenance component may maintain the color index responsive to resource allocations by the resource allocation component and or updates to resource color specifications and or proximity criteria specifications . A color filtering component may filter a set of candidate implementation resources e.g. being considered by the resource allocation component with respect to the resource color specifications and or proximity criteria specifications .

In an embodiment the process includes receiving information specifying the coloring of one or more resource containers. A user for example of a customer of a virtual resource provider may through a user interface provide information about one or more colors to be applied to a resource container. A resource container may be a set of virtual and or implementation resources. The set may be defined by one or more characteristics. An example resource container is a network of resources hosted by a virtual resource provider and operated under the direction of a customer of the virtual resource provider. In other words a container may be a network of a customer s resources that are hosted by a virtual resource provider. As discussed above containers of resources may be defined in various ways.

In an embodiment a request to take a provisioning action based on the information specifying the coloring is received . The requested action may be as an example a request to provision one or more virtual machine instances. The request may specify that the virtual machine instances are required to and or are preferred to be proximate to another container of resources painted with another color. As noted the requests may specify other conditions instead of or in addition to conditions based on proximity. Generally the request may include any information specifying one or more conditions that are required and or preferred to be fulfilled.

In an embodiment a determination is made whether the requested action is possible. For example if the request was to provision one or more virtual machine instances close to resources having a particular color and such a provisioning is possible a determination may be positive. Similarly if no resources are available for provisioning then the determination may be negative. In an embodiment if the determination is made that the requested action is possible then the request action is performed . For example virtual machine instances that have been requested to be provisioned in an embodiment are then provisioned.

Similarly if the determination is made that the requested action is not possible the requested action may be performed nonetheless although not exactly as requested. Continuing the example where the request is a request to provision one or more virtual machine instances close to a container of resources having a particular color and no resources close to the resources colored with a particular color are available the virtual machine instances may nonetheless be provisioned but utilizing resources that are not close to the resources having the particular color. Of course other actions may be taken instead of performing the requested action. For example a message to a user that a requested action could not be performed may be provided and no resources may be provisioned unless the user changes or otherwise updates his or her request or otherwise authorizes the requested action to be completed in a manner different from that originally requested.

In an embodiment as shown in the resources of the customer are arranged according to a plurality of containers. Containers may be for example networks of the customer that are hosted by the virtual resource provider . Each of the containers may be used for a different purpose. For example one resource container may be used for management related activities such as operating accounting human resources and other software whereas another resource container may be used to provide a service to one or more third parties. The various containers of the customer may be hosted by the virtual resource provider in the same data center or among several data centers. In addition resources in one container may be located in the same data center or spread out among a plurality of data centers depending on how the containers are defined.

As illustrated in resource containers of the customer may also include resource sub containers . A resource sub container may be for example a sub network subnet of a virtual private cloud. A sub container may also be merely a subset of the resources of a container. The members of the subset may share a common characteristic that defines the subset or may be otherwise selected. A user of the customer may for instance manually define the members of the subset. While not shown in the figures a customer may also include sub containers of sub containers and generally any collection of containers that is useful for the customer s purposes.

As noted however this particular example the customer has colored its resource containers . For example as shown in the figure the customer has a resource container colored green a resource container colored yellow and a resource container colored red. The customer may have selected or otherwise specified these labels designations through an interface used to communicate with the virtual resource provider. The virtual resource provider may have also applied one or more of the colors to one or more of the resource containers by for example detecting a set of resources having a common characteristic and applying a color to the set of resources.

Also shown in the customer has sub containers of the container colored red. As illustrated the sub containers have been colored by the customer by the virtual resource provider or otherwise. As shown the customer has one resource sub container colored orange and another resource sub container colored blue. In this manner it may be considered for example that resources of the resource sub container labeled orange are also labeled red because the resource sub container labeled orange is a sub container of the resource container labeled red. However not all resources in the resource container colored red would also be colored orange since not all resources of the resource container colored red are also in the resource sub container colored orange. 

In accordance with various embodiments of the present disclosure customers of the virtual resource provider are able to utilize colorings of resources in order to provision or otherwise manage resources. For example shows an illustrative example of an environment in which resources are provisioned according to a resource coloring. The environment may be the environment discussed above in connection with . For instance in this particular example the environment includes a virtual resource provider that provides use of implementation resources for at least one customer . The customer in this example also has resources allocated according to a plurality of resource containers that the customer has painted. Thus in this example as with the customer has a resource container colored green a resource container colored yellow and a resource container colored red. In addition the resource container colored red may include a plurality of resource sub containers that are also colored. In this example for instance as with the resource container colored red includes a resource sub container colored orange and another resource sub container colored blue. 

In the environment shown in a request to provision additional resources close to resources colored green has been received by the virtual resource provider . A workflow of a virtual resource provider has provisioned requested additional resources close to the resource container colored green. While shows the additional resources being physically close to the resource container colored green and while the word close may refer to geographic proximity the word close may be used in other contexts. For example proximity may be measured in other ways that may be meaningful to users of the environment shown in . Proximity may be measured for example according to latency bandwidth network hops and or in other ways. Generally proximity may be measured according to any metric which may be useful to one or more users of an environment such as the environment shown in .

Multiple colors may be used in requests in connection with provisioning virtual resources. For example a customer of a virtual resource provider may find it desirable to provision a virtual machine instance that is close to two different services such as services that provide information from corresponding different databases. Accordingly shows an illustrative example of an illustrative example in which multiple colors may be used. The environment may be the environment described above in connection with . The environment in this example therefore includes a virtual resource provider and a customer which may interact as described above. The customer utilizes resources of the virtual resource provider and these resources may be allocated according to a plurality of resource containers . These resource containers may be colored by the customer or in any manner. For example in this example as with the customer has a resource container colored green and resource container colored yellow and a resource container colored red. The resource container colored red has a resource sub container colored orange and a resource sub container colored blue. 

In this particular example however the customer makes a request to the virtual resource provider to provision additional resources that are close to both resources colored green and resources colored yellow. The customer for example may wish to have the requested additional resources be able to access resources of the container colored green and resources of the resource container colored yellow quickly. Thus in this manner the virtual resource provider in response has provisioned additional resources in a manner that is close to both to the resource container colored green and the resource container colored yellow. As shown in the availability of resources may determine how close resources are able to be provisioned to other resources. Thus in this particular example to illustrate this point the requested additional resources are shown to be provisioned closer to the resource container colored green than to the resource container colored yellow. This may be due to for instance an inability to provision the requested resources closer to the resources colored yellow. 

Input from the customer may be received that aids the virtual resource provider in determining how to provisional virtual resources. For example the customer may indicate that it is more important to have the additional resources provisioned close to the resource container colored green than to the resource container colored yellow. Similarly the customer may indicate that resources must be within a certain distance to resources of one color and as close as possible to resources of another color. In this manner a workflow utilized to provision the requested additional resources may take this into account when provisioning resources.

As noted above different customers of a virtual resource provider may each color their resource containers. Also resources of one customer may be accessible to one or more other customers. Accordingly shows an illustrative example of an environment which may be used to implement various aspects of the present disclosure. The environment shown in may be an environment similar to one of the environments described above. In this example however different aspects of environment are illustrated in the figure. In particular in a virtual resource provider is shown as having a plurality of customers . Each of the customers may utilize various resources of the virtual resource provider for various reasons. As with the figures described above in each of the customers of the virtual resource provider has resources of the virtual resource provider allocated according to various resource containers. In this example each customer has a corresponding resource container. While shows each customer of the virtual resource provider having one resource container any of the customers of the virtual resource provider may have more than one resource container. In addition the resource containers may be different types of containers for various customers. A resource container for one customer for example may be a network of resources while a resource container of another customer may simply refer to all of the resources allocated to the customer or a set of resources defined by one or more characteristics of the resources. Further while not illustrated each of the customers may have more than one resource container and one or more of each customer s resource containers may include one or more sub containers.

As shown in one or more of the customers may color resources of the virtual resource provider . A customer labeled Customer 1 for example is shown in to have colored a resource container green. Similarly a customer labeled as Customer 2 has colored a corresponding resource container green as well. In an embodiment colorings made by customers are not global with respect to the virtual resource provider. For example the customer resource container colored green by the customer labeled Customer 1 may not be labeled green for other customers. In other words the other customers may not be able to identify the resources of Customer 1 simply by specifying green. The resources in the resource container for example may not be accessible by the other customers. Thus while shows two customers Customer 1 and Customer 2 having labeled respective customer resource containers green that does not necessarily mean that the resources in resource container of Customer 1 are labeled identically as the resource container labeled green by Customer 2.

In some instances however colors may be global. A customer of the virtual resource provider may for example want to allow a certain amount of access to other customers. One customer for example may provide a service that may be utilized by other customers in offering their own services. The customer then may charge the other customers for use of that service. In this manner a customer may label his or her resources in a manner that is publicly available. The customers who make their coloring publicly available may publish the names in a domain name service or other registry so that other customers are able to determine those names. In this manner a customer such as Customer 3 who wishes the utilize a service offered by Customer 1 may make a request to have one or more resources provisioned close to the resources of Customer 1 that are labeled green. Because multiple customers may use the label green the request may specify an identifier of Customer 1 in addition to the color. The request may refer to for instance Customer 1.Green. In this manner the request is indifferent to any resources of Customer 2 that also happen to be labeled green and any provisioning of the resources of Customer 3 close to the resources of Customer 2 labeled green may be purely coincidental.

In some instances it may be desirable to color resources according to various fault boundaries. A fault boundary may be an abstract division of resources based on the possibility of resource failure. As an example two resources may be considered to be on opposite sides of a fault boundary if a particular failure would affect one resource but not the other. For example if a certain type of failure such as a power outage or hardware failure would affect one resource but not the other the two resources may be considered to be on opposite sites of a fault boundary. Therefore two resources powerable by separate backup generators may be for instance considered to be on opposite sides of a fault boundary that corresponds to a division. Fault boundaries may also be determined based on other factors. Two computing devices on separate racks may be considered to be on different sides of a failure boundary because the failure of one rack would only affect one of the computing devices. As yet another example resources implemented in one data center may be considered to be on a side of a fault boundary different from resources implemented in another data center. Thus fault boundaries may correspond roughly to geographical boundaries.

Using as an example coloring of resource containers defined by fault boundaries and or other boundaries may be used to provision resources in a manner consistent with customer needs. A customer may for example operate a service in Region I of . For backup purposes the customer may wish to operate a duplicate service so that the duplicate service is available if the other service becomes inoperable. The customer may then request resources to be provisioned in another region. For instance continuing the illustrative example where the fault boundaries in correspond to different generators and racks by requesting that resources be provisioned in Region II the customer is requesting resources that are backed up by a different generator thereby making it likely that the customer s service would still be available should the generator corresponding to Region I stop working. Similarly by requesting that resources be provisioned in Region III the customer is requesting resources on a rack different from the rack corresponding to Region I thereby making it likely that the customer s service will be available should the rack corresponding to Region I fail. By requesting that resources be provisioned in Region IV therefore the customer is requesting resources that are both on a rack and powered by a generator different from the resources corresponding to Region I thereby making it likely that the customer s service will be available in the event both the rack and generator corresponding to Region I fail.

As noted above various embodiments of the present disclosure allow multiple colors to be used when provisioning resources. shows an illustrative example of a process that may be used to implement various aspects of the present disclosure in contexts where one or more colors are utilized. In this particular example shows a process for provisioning resources in a manner that utilizes multiple conditions in connection with multiple colors. In an embodiment the process includes receiving information specifying color conditions in connection with a provisioning request. As noted above for example a customer may request one or more resources to be provisioned in a manner that is close to resources colored green and close to resources colored blue. As will be described more fully below implementation resources may be located in a manner that attempts to locate implementation resources that are both close to resources colored green and close to resources colored blue. As another example the color conditions may specify that resources should be provisioned close to resources labeled green and far away from resources labeled red. Far away may refer to a location that is on an opposite side of a fault boundary. The reason for this may be that a customer does not want a failure of the resources colored red to affect operation of the resources to be provisioned upon making the request.

Generally the conditions can be any conditions that may be used in order to provision resources based on color. In an embodiment a set of resources satisfying a first color condition is identified . For example if the first condition is that resources should be close to resources colored green available resources that are considered to be close to resources that are colored green are identified. The available resources may be for example resources that are not currently allocated to any user. In an embodiment a determination is make whether there are additional color conditions received in connection with the provisioning request. If there are additional color conditions then in an embodiment a set of resources satisfying the next color condition are identified and a determination is again made whether there are additional color conditions. In this manner for each color condition a set of resources that satisfy the color condition is identified.

Once all the sets of resources satisfying each color condition are identified that is when there are no additional color conditions in an embodiment an intersection of the identified sets of resources is identified . As an example if the color conditions were that the provisioned resources should be close to resources colored green and close to resources colored red then available resources that are both close to resources colored green and close to resources colored red are identified. However available resources that are close to resources colored green but not to resources colored red would not be identified in this particular example. Once the intersection of the identified sets of resources are identified a determination is made whether the intersection is empty. In an embodiment the intersection being empty may signify that there are no available resources that satisfy all of the color conditions. In such an instance the requested resources may be provisioned in another manner. For example the requested resources may be provisioned in a manner that satisfies most but not all of the specified color conditions. As another example the requested resources may be provisioned in a manner that satisfies one or more conditions that have additionally been specified as being more important than other conditions. Generally the requested resources may be provisioned in any suitable manner and additional or alternative actions may be taken. For instance an error message that the requested resources were unable to be provisioned according to the request may be provided. A user may then decide whether or not to relax the specified conditions.

If however determination is made that the intersection is not empty then the resources are provisioned in the intersection of the identified sets of resources. The resources may be provisioned for example using any of the resources in the intersection. Further analysis may be performed in order to optimize the selection of available resources to be used for provisioning.

As noted however it may not be possible to satisfy all conditions that a customer may specify. for example shows circles which may be circles that represent resources in the manner described above in connection with . For example the largest circle shown in has a circle in the center labeled orange an interior of which corresponds to available resources satisfying some conditions involving the color orange. Such are resources that are considered to be close to the center labeled orange. As with has circles with centers labeled orange blue yellow and green. If a request was made to provision resources with conditions utilizing the colors orange yellow green and blue the process described in will first attempt to identify a set of resources in the intersection of the set represented by each of the circles in . However as shown in the intersection of each set would be empty. The resources corresponding to the circle having a center labeled blue for example does not intersect with circles having a center labeled green. Therefore as shown in there are no available resources that satisfy both the conditions on resources colored blue and the conditions on resources colored green. 

Thus an attempt may be made to provision resources in another manner. For example as labeled in the intersection of the circle inside the center labeled orange yellow and green is nonempty. The resources corresponding to this intersection may be used to provision resources in a manner that satisfies the most conditions possible but not all of the conditions. However in some instances it may be desirable to provision the resources using other available resources. For example the request to provision resources may have indicated that it is desirable to satisfy conditions on orange yellow and green about various portions to have a condition on resources colored blue. Thus the set of available resources corresponding to the intersection of the interior of the circles having centers labeled orange and blue may be used to provision resources in such a case.

In some instances efforts may be made to attempt to provision resources in the best manner possible. A virtual resource provider may for instance attempt to optimally select resources from a set of resources that satisfy one or more color conditions. As noted in some instances customer conditions may not be able to be satisfied with available resources and therefore it may be desirable to identify available resources that come as close to satisfying one or more conditions as possible. Also in some instances conditions may be structured in a manner that precludes a binary determination whether the conditions are satisfied or not. A request for example may specify that resources should be provisioned as close as possible to a container of resources colored with a particular container. Accordingly provides an illustrative example of a process which may be used to provision resources. In general as will be described below the process includes relaxing a color condition until available resources are found. In this manner for example if a request for provisioning resources includes a connection with a condition to be as close as possible to resources colored green for some definition of close the process may be used to identify available resources that are as close as possible.

In an embodiment information specifying a color condition in connection with the provisioning request is received . The information may be received in any suitable manner such as described above. In an embodiment a determination is made whether there are resources available in a default proximity radius. As used herein a resource is available in a proximity radius when the resource satisfies a condition that is based at least in part on the proximity radius value. For example if the condition is to be as close as possible to the resources colored green and its proximity is measured in terms of network hops a determination may be made whether there are any available resources within a certain number of network hops of any resources that are colored green. Similarly if the condition is to be as close as possible to the resources colored green and its proximity is measured in terms of latency a determination may be made whether there are any available resources with latency between any resources that are colored green being less than or equal to some default value. The proximity radius may be any value that may be used to determine whether resources satisfy any condition that is based at least in part on the value.

In an embodiment if there are no resources available in the default proximity radius then the proximity radius is enlarged . In other words a condition that is based on the proximity radius is relaxed. Continuing with the examples of the previous paragraph a maximum number of network hops or a latency value may be increased. In an embodiment once the proximity radius is enlarged a determination is made whether there are available resources in the enlarged proximity radius. Thus with the example with network hops the number of network costs may be increased and a determination may be made whether there are any resources within the increased number of hops to resources colored green. In an embodiment when a determination is made that there are available resources within the default or a larger proximity radius then resources are provisioned if in the proximity radius.

Various combinations and variations of the processes described herein are considered as being within the scope of the present disclosure. For example as discussed shows a process in which conditions on resources colored with a particular color are relaxed until suitable resources are identified. This process or variations thereof may be used in connection with the process described in connection with . For example when multiple conditions are specified one or more of the conditions may be relaxed in order to identify available resources that satisfy the conditions. Looking to for example one or more conditions corresponding to one or more of the circles may be relaxed thereby enlarging one or more of the circles until the interiors of the circles have a nonempty intersection. Further customers may specify which conditions may be relaxed or may otherwise influence performance of such a process.

In many instances it is desirable for a user to know how well the provision resources have been fulfilled. A customer may make a request knowing that the request may or may not be fulfilled according to any specified conditions depending on resource availability. However it may be desirable to the customer to know whether any specified conditions have been fulfilled in order to accurately gauge the performance of its resources and generally to have more information about its resources. shows an example of a process that may be used to notify users how all the sets within the resources were made. In an embodiment information specifying one or more color conditions in connection with the provisioning request are received .

In an embodiment the process includes receiving information that defines one or more color conditions in connection with the provisioning request. The information specifying one or more color conditions may be received in the manner such as that described above. In an embodiment an attempt is made to satisfy the color conditions that have been specified. Any way of attempting to satisfy the color conditions may be used such as those described above. In an embodiment upon attempting to satisfy the color conditions information is provided regarding success of the attempt to satisfy the color conditions. Information may be provided in any suitable manner. For example a message may be sent to a user saying that the attempt to satisfy the color conditions was successful. More detailed information may also be provided. For example in a provisioning request having a condition regarding proximity to resources of a particular color information may be provided regarding how close the newly provisioned resources are to the resources colored with a particular color. The information may be in terms of a unit of measurement corresponding to a metric for measuring proximity or may be a relative number. A relative number may for example say that on a scale from one to ten the resources were provisioned in a manner corresponding to a score somewhere in the scale. Generally any suitable information may be provided.

In some instances it may be desirable to include the provisioning of resources from one or more customers over time. When customers initially make a request for resources as an example the customers may not appreciate the various options they have in provisioning resources. A user for example may not realize that his or her application may execute better if executed on a virtual machine instance that is provisioned close to a particular resource container. therefore provides an illustrative example of a process that may be used to include provisioning of resources over time for a customer. In an embodiment the resources for a customer are provisioned . The provisioning of resources may be done in any suitable manner such as by associating one or more virtual machine instances. As applications of the customer are executed over time the customer s use of the provisioned resources is monitored . Measured quantities may be for example network requests and generally any aspects of network operation that may be measured.

In an embodiment upon monitoring the customer s use of the provisioned resources the placement of resources based on the monitoring is improved if applicable. Placement of resources based on the monitoring may be performed in any suitable manner. As one example existing provisioned resources may be left as is but future resources may be provisioned in a manner that would improve performance. If a customer for example scales up in response to increased demand newly requested resources may be provided and is provisioned in the manner that is more optimal for the customer. The customers resources may also be migrated to another location host data center rack and the like that is more optimal. Generally any manner of improving the provisioning for the customer may be used.

In some instances it may be desirable for customers to know before having resources provisioned how well a virtual resource provider is able to provision resources. Such information for example may be useful in planning the design of one s resources. accordingly provides an illustrative example of a process which may be used to provide such information and provisioned resources if applicable. In an embodiment the process includes receiving a request for the ability to provision resources according to one or more color conditions. The customer may inquire for example whether it is possible to provision a certain number of virtual machine instances close to a container of resources colored green. In an embodiment the ability to provision according to color conditions is determined . In determining whether there are available resources that satisfy the ability to provision according to color conditions may be made by determining whether there are resources available that satisfy the color conditions such as in a manner described above.

In an embodiment a determination is made whether it is possible to provision the requested resources according to the one or more color conditions. In instances where there are multiple customers the availability of resources may change rapidly as customers utilize resources for their own use. Accordingly in an embodiment if a determination is made that it is possible to provision the resources according to the color conditions resources are reserved for a time period. The time period may be for example one hour or similarly any time period if it is sufficient to provide a user enough time to decide whether to in fact provision the requested resources. If however a determination is made that it is not possible to provision the requested resources according to the one or more color conditions then a determination of the ability is provided . For example a message may be sent to a user specifying that it is not possible to fulfill such a request. Other information may be provided such as alternate ways in which resources may be provisioned. If the resources have been reserved because it was determined that it was possible to provision the resources then if that provisioning is requested the resources may be provisioned in a manner that satisfies the one or more color conditions.

The various embodiments further can be implemented in a wide variety of operating environments which in some cases can include one or more user computers computing devices or processing devices which can be used to operate any of a number of applications. User or client devices can include any of a number of general purpose personal computers such as desktop or laptop computers running a standard operating system as well as cellular wireless and handheld devices running mobile software and capable of supporting a number of networking and messaging protocols. Such a system also can include a number of workstations running any of a variety of commercially available operating systems and other known applications for purposes such as development and database management. These devices also can include other electronic devices such as dummy terminals thin clients gaming systems and other devices capable of communicating via a network.

Most embodiments utilize at least one network that would be familiar to those skilled in the art for supporting communications using any of a variety of commercially available protocols such as TCP IP OSI FTP UPnP NFS CIFS and AppleTalk. The network can be for example a local area network a wide area network a virtual private network the Internet an intranet an extranet a public switched telephone network an infrared network a wireless network and any combination thereof.

In embodiments utilizing a Web server the Web server can run any of a variety of server or mid tier applications including HTTP servers FTP servers CGI servers data servers Java servers and business application servers. The server s also may be capable of executing programs or scripts in response requests from user devices such as by executing one or more Web applications that may be implemented as one or more scripts or programs written in any programming language such as Java C C or C or any scripting language such as Perl Python or TCL as well as combinations thereof. The server s may also include database servers including without limitation those commercially available from Oracle Microsoft Sybase and IBM .

The environment can include a variety of data stores and other memory and storage media as discussed above. These can reside in a variety of locations such as on a storage medium local to and or resident in one or more of the computers or remote from any or all of the computers across the network. In a particular set of embodiments the information may reside in a storage area network SAN familiar to those skilled in the art. Similarly any necessary files for performing the functions attributed to the computers servers or other network devices may be stored locally and or remotely as appropriate. Where a system includes computerized devices each such device can include hardware elements that may be electrically coupled via a bus the elements including for example at least one central processing unit CPU at least one input device e.g. a mouse keyboard controller touch screen or keypad and at least one output device e.g. a display device printer or speaker . Such a system may also include one or more storage devices such as disk drives optical storage devices and solid state storage devices such as random access memory RAM or read only memory ROM as well as removable media devices memory cards flash cards etc.

Such devices also can include a computer readable storage media reader a communications device e.g. a modem a network card wireless or wired an infrared communication device etc. and working memory as described above. The computer readable storage media reader can be connected with or configured to receive a computer readable storage medium representing remote local fixed and or removable storage devices as well as storage media for temporarily and or more permanently containing storing transmitting and retrieving computer readable information. The system and various devices also typically will include a number of software applications modules services or other elements located within at least one working memory device including an operating system and application programs such as a client application or Web browser. It should be appreciated that alternate embodiments may have numerous variations from that described above. For example customized hardware might also be used and or particular elements might be implemented in hardware software including portable software such as applets or both. Further connection to other computing devices such as network input output devices may be employed.

Storage media and computer readable media for containing code or portions of code can include any appropriate media known or used in the art including storage media and communication media such as but not limited to volatile and non volatile removable and non removable media implemented in any method or technology for storage and or transmission of information such as computer readable instructions data structures program modules or other data including RAM ROM EEPROM flash memory or other memory technology CD ROM digital versatile disk DVD or other optical storage magnetic cassettes magnetic tape magnetic disk storage or other magnetic storage devices or any other medium which can be used to store the desired information and which can be accessed by the a system device. Based on the disclosure and teachings provided herein a person of ordinary skill in the art will appreciate other ways and or methods to implement the various embodiments.

The specification and drawings are accordingly to be regarded in an illustrative rather than a restrictive sense. It will however be evident that various modifications and changes may be made thereunto without departing from the broader spirit and scope of the invention as set forth in the claims.

Other variations are within the spirit of the present disclosure. Thus while the disclosed techniques are susceptible to various modifications and alternative constructions certain illustrated embodiments thereof are shown in the drawings and have been described above in detail. It should be understood however that there is no intention to limit the invention to the specific form or forms disclosed but on the contrary the intention is to cover all modifications alternative constructions and equivalents falling within the spirit and scope of the invention as defined in the appended claims.

The use of the terms a and an and the and similar referents in the context of describing the disclosed embodiments especially in the context of the following claims are to be construed to cover both the singular and the plural unless otherwise indicated herein or clearly contradicted by context. The terms comprising having including and containing are to be construed as open ended terms i.e. meaning including but not limited to unless otherwise noted. The term connected is to be construed as partly or wholly contained within attached to or joined together even if there is something intervening. Recitation of ranges of values herein are merely intended to serve as a shorthand method of referring individually to each separate value falling within the range unless otherwise indicated herein and each separate value is incorporated into the specification as if it were individually recited herein. All methods described herein can be performed in any suitable order unless otherwise indicated herein or otherwise clearly contradicted by context. The use of any and all examples or exemplary language e.g. such as provided herein is intended merely to better illuminate embodiments of the invention and does not pose a limitation on the scope of the invention unless otherwise claimed. No language in the specification should be construed as indicating any non claimed element as essential to the practice of the invention.

Preferred embodiments of this disclosure are described herein including the best mode known to the inventors for carrying out the invention. Variations of those preferred embodiments may become apparent to those of ordinary skill in the art upon reading the foregoing description. The inventors expect skilled artisans to employ such variations as appropriate and the inventors intend for the invention to be practiced otherwise than as specifically described herein. Accordingly this invention includes all modifications and equivalents of the subject matter recited in the claims appended hereto as permitted by applicable law. Moreover any combination of the above described elements in all possible variations thereof is encompassed by the invention unless otherwise indicated herein or otherwise clearly contradicted by context.

All references including publications patent applications and patents cited herein are hereby incorporated by reference to the same extent as if each reference were individually and specifically indicated to be incorporated by reference and were set forth in its entirety herein.

