---

title: Systems, methods, and computer program products for managing states
abstract: System, methods, and computer program products are provided for managing mobile entity states. A first notification is received over a communications network, the first notification including data indicating that a first service associated with a mobile device has been suspended. State information stored in a memory is updated based on the data included in the first notification. A second notification is transmitted over a communications network, the second notification indicating that the state information has been updated.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09544759&OS=09544759&RS=09544759
owner: GOOGLE INC.
number: 09544759
owner_city: Mountain View
owner_country: US
publication_date: 20140218
---
This application is a continuation in part of U.S. patent application Ser. No. 13 653 160 filed Oct. 16 2012 which claims priority to U.S. Provisional Application Nos. 61 702 653 filed Sep. 18 2012 and 61 554 393 filed Nov. 1 2011 the contents of which are incorporated herein by reference. This application also claims priority to U.S. Provisional Application No. 61 825 867 filed May 21 2013 the contents of which are incorporated herein by reference.

The present invention relates to managing states and more particularly to systems methods and computer program products for managing states relating to mobile commerce transactions including mobile subscription states and or mobile wallet states.

A service provider SP is a company organization entity or the like that provides services to customers or consumers. Examples of service providers include account issuing entities such as merchants card associations banks marketing companies and transit authorities. A service may be an activity capability functionality work or use that is permitted or provided by a service provider such as a payment service a gift offer or loyalty service transit pass service and the like.

In a mobile environment that involves contactless transactions between a mobile device and a service provider information relating to the accounts and applications issued by the service providers are downloaded onto mobile devices in order to enable them to perform the contactless transactions.

A trusted service manager TSM is typically an independent entity serving mobile network operators MNOs and account issuing service providers by provisioning applications such as contactless applications associated with the service providers to mobile devices. Typical TSMs can distribute and manage the contactless applications remotely because they have access to secure elements SEs in a near field communication NFC enabled mobile device.

A central TSM typically performs the functions of configuring the mobile device and or the secure element such as the provisioning of applications or the updating of data stored on the mobile device or the secure element. The central TSM usually communicates with the mobile device across a mobile network that provides network connectivity to the mobile device. That is a mobile device generally subscribes to a particular MNO and the MNO manages the network connectivity of the mobile device while the mobile subscription is maintained. The network connection across the MNO associated with the mobile device is generally known as a mobile line.

However if a mobile subscription associated with the mobile device is not active the central TSM may be unable to perform various functions such as provisioning and updating operations as data transmitted by the central TSM cannot be received by the mobile device. A mobile subscription may be inactive due to for instance suspension by the MNO upon reporting of a lost or stolen mobile device. Typically after initially failing to connect with the mobile device due to an inactive mobile subscription the central TSM may again attempt to connect with the mobile device at periodic intervals despite the mobile subscription remaining inactive. These unsuccessful attempts result in wasted expenditure of computing and network resources by the central TSM.

In addition a customer may wish to temporarily suspend service provider services associated with a mobile device which may require information updates on multiple components such as the mobile device the central TSM and service providers.

As such one technical challenge involves ensuring the proper storage and management of states to reduce the unnecessary expenditure of resources.

The present invention provides systems methods and computer program products for managing states relating to mobile commerce transactions including mobile subscription states and or mobile wallet states.

In one embodiment a system includes at least one memory and at least one processor coupled to the at least one memory. The at least one processor is operable to receive over a communications network a first notification including data indicating that a first service associated with a mobile device has been suspended update state information stored in said at least one memory based on the data included in the first notification and transmit over a communications network a second notification that the state information has been updated.

In another embodiment a method is executed on a first system including at least one processor and at least one memory. A first notification is received with the at least one processor over a communications network the first notification including data indicating that a first service associated with a mobile device has been suspended. State information stored in the at least one memory is updated with the at least one processor based on the data included in the first notification. A second notification that the state information has been updated is transmitted with the at least one processor over a communications network.

In another embodiment a non transitory computer readable medium has stored thereon instructions which when executed by a system including at least one processor and at least one memory cause the system to perform the steps of receiving with the at least one processor over a communications network a first notification including data indicating that a first service associated with a mobile device has been suspended updating with the at least one processor state information stored in the at least one memory based on the data included in the first notification and transmitting with the at least one processor over a communications network a second notification that the state information has been updated.

Further features and advantages of the present invention will become more apparent from the detailed description set forth below when taken in conjunction with the following drawings.

The example embodiments of the invention presented herein are directed to systems methods and computer program products for managing states. This is for convenience only and is not intended to limit the application of the present invention. In fact after reading the following description it will be apparent to one skilled in the relevant art s how to implement the following invention in alternative embodiments such as the management of a variety of states in a mobile commerce environment.

Generally the exemplary embodiments described herein perform management of states including mobile subscription states and or mobile wallet states.

As shown in each of the mobile devices are respectively coupled to the central sub system and in particular the central TSM via a respective mobile network . The mobile networks are used and managed by MNOs to provide wireless communications services. The mobile networks may be mobile phone cellular networks radio networks or the like. Each MNO may control the access and restriction of data across a mobile network and may itself communicate with the central TSM .

Mobile devices and are associated with secure elements . . . collectively respectively. The secure elements may be communicatively coupled to one or more processors and one or more memories. A secure element permits identification and authentication of a customer associated with the secure element and the mobile device such that the customer may conduct a transaction with a service provider via the secure element . Examples of such transactions include a payment service a gift offer or loyalty service transit pass service and the like. The secure element may be implemented as hardware software or a combination of hardware or software. In one embodiment the secure element is implemented as a combination of hardware and software embodied in one or more of a universal integrated circuit card UICC e.g. SIM card removable data storage e.g. microSD card or circuitry integrated within the hardware of the respective mobile device . The secure element may also be capable of performing NFC transactions and may wirelessly communicate with an NFC terminal.

During manufacture of a secure element e.g. secure element the secure element is pre loaded with content including for example a wallet companion applet a mobile wallet companion applet WCAp a proximity payment system environment PPSE and a payment package. The WCAp may be used by a mobile wallet in order to conduct transactions and the PPSE is an application that assists in the process of making contactless payment transactions. The secure element may also include various partitions or security domains SDs such as an MNO SD and a central SD. The MNO SD is a security domain that is managed by an MNO and includes security keys and applications. The central SD is managed by the central TSM .

The secure elements may include security domains code applets applications and packages. The packages may include uninstantiated applets and or applications and may be loaded on a secure element for example over the air OTA . Applets and or applications on the secure element may be in uninstantiated or instantiated form and uninstantiated applets and or applications may be preloaded on a secure element during manufacture of the secure element. Alternatively applets and or applications may be loaded for example OTA after a secure element has been manufactured e.g. upon delivering the secure element to a user . Applets and or applications may be generic or non generic. Non generic applets and or applications may include couponing and loyalty applications and or any application that is not generic to multiple service providers. That is a non generic application may correspond to a single service provider. Data that may be used and or associated with a non generic application e.g. offers coupons may be stored in the secure element or in memory outside of the secure element e.g. non volatile memory of a mobile device .

Generic applets and or applications may include applets and or applications that when instantiated can be used by multiple service providers. For example a generic application of a payment network e.g. MasterCard may be instantiated for multiple service providers by a central TSM and therefore may be used by more than one service provider.

Packages including uninstantiated and or generic applets and or applications may be owned or controlled by a single entity controlling a central TSM and or a central SD. Uninstantiated and or generic applets and or applications may be created under i.e. directly associated with a central SD on a secure element and may be exclusively managed on the secure element by the central TSM using the central SD. In particular the central SD maintains exclusive access to the WCAp PPSE packages and SP SDs. However service providers may transmit requests to the central TSM for example to rotate i.e. exchange security keys. After security keys of an SP SD have been rotated the corresponding service provider can continue to send requests to the central TSM to execute commands on the corresponding SP SD. After key rotation the central TSM has limited access to the SP SD. In particular the central TSM can for example stop execution of an application or instantiate applications under the SP SD but may not access the security keys or personalized content of the SP SD.

Exclusive ownership control and or management of uninstantiated applets or applications allows a single entity to efficiently and cost effectively supervise the applets and or applications. Further exclusive ownership control and or management increases security and minimizes the complexities caused by multiple service providers loading and controlling different applets and or applications on a secure element. For example a service provider may utilize an instance of an uninstantiated applet and or application instead of certifying and installing an independent applet and or application on the secure element.

Additionally uninstantiated applets and or applications may be instantiated and each instance may then be extradited to a corresponding security domain. Instantiation may include personalizing applets and or applications using data corresponding to the entity for which the instance is being created.

For example multiple instances of an uninstantiated applet or application may be created for different entities e.g. service providers and each instance may be extradited to a different security domain for use by a different entity.

An applet or application on a secure element may function pursuant to requirements established by Global Platform Europay MasterCard Visa EMVCo. MNOs and payment networks e.g. MasterCard Visa Discover American Express . Applets or applications may be for example Expresspay payWave PayPass Zip and the like.

As shown in each of the SP TSMs are communicatively coupled to the ESB via a communications network . Communications network may be a virtual private network VPN a network using Hypertext Transfer Protocol HTTP standards or the like. In turn the ESB is communicatively coupled to the central TSM and a wallet server . These connections may be implemented as wired or wireless LAN connections VPN connections or any other network configuration and may be secured using security protocols such as Secure Socket Layer SSL Transport Layer Security TLS or the like. In an exemplary embodiment the ESB is an architecture model for implementing the interactions and communications between entities e.g. secure elements SP TSMs central TSM .

In an exemplary embodiment the central TSM is hardware and or software that is implemented to serve as an intermediary between the SP TSMs and secure elements . Specifically the central TSM allows each of the SP TSMs to for example request pre personalization of a secure element generate and install new or temporary security domain keysets personalize a payment service and or have a service activated. That is the central TSM manages the communications between the SP TSMs and the secure elements

The central TSM is communicatively coupled to the secure elements via corresponding mobile networks used and or managed by corresponding MNOs. The central TSM may communicate with the secure elements via the mobile networks using security protocols such as Global Platform secure channel protocol SSL TLS or the like.

In an alternative embodiment the central TSM can directly perform operations without requiring an ESB as an intermediary. In such an embodiment it will be understood that any discussions herein referring to an ESB should instead refer to the central TSM and discussions herein referring to a communication between an ESB and a central TSM would be understood to be redundant or be otherwise communicated or transferred internally within the central TSM .

In one exemplary embodiment the wallet server is hardware and or software that is implemented to perform mobile wallet functions and facilitate transactions between a secure element and a service provider . In particular the wallet server is a remote server allowing managing remotely a wallet client on a secure element . The wallet server may modify the content of the wallet client on the secure element and install new modules known as widgets in relation with the services e.g. NFC services installed on the secure element

As shown in each of the SP TSMs corresponds to a service provider also generally known as an issuer . Each SP TSM serves as an intermediary between the service providers and other entities including secure elements MNOs and the central TSM .

As previously mentioned each of the SP TSMs is communicatively coupled to the ESB via a communications network . Using this connection an SP TSM is thus communicatively coupled via the communications network and the ESB to the central TSM .

Each of the SP TSMs and the ESB may also secure these communications by using security protocols such as SSL TLS or the like. Each of the SP TSMs may also communicate with the ESB and the central TSM by using an application programming interface API such as a web service API.

The central TSM therefore can communicate with a plurality of service providers and SP TSMs and with a plurality of secure elements over the plurality of mobile networks .

For example the SP TSM sends a request to the central TSM via the communications network and the central TSM sends a response back to the SP TSM via the communications network . The SP TSM sends a request intended for the secure element to the central TSM via the communications network . In turn the central TSM sends that request to the secure element via the respective mobile network .

In another alternative embodiment a plurality of mobile networks communicate with a plurality of SP TSMs.

A service provider may communicate with the central TSM in order to access or control a corresponding security domain and or application on a secure element . In particular the service provider by communicating with the central TSM may pre personalize a secure element personalize a service on a security domain in a secure element or activate a service on the secure element . For example the service provider may transmit a request to the central TSM to pre personalize a secure element . In response the central TSM may pre personalize the secure element including creating at least one service provider security domain including corresponding temporary security keys if required and or instantiating an application on the secure element . Instantiation of the application includes creating an instance of an uninstantiated application.

The service provider may also transmit a request to personalize a service to the central TSM . The request may include data and scripts. The scripts may include commands to be executed by an application on a security domain corresponding to the service provider in the secure element . For example the scripts may include commands to personalize an instantiated application rotate keys in the corresponding security domain and or execute service provider commands in the service provider s security domain and or instantiated application in the secure element . The central TSM receives the request and securely transmits the scripts and or data in the request to the secure element. In turn the secure element receives and executes the scripts and data.

In an example embodiment of the invention the memory of the central TSM stores information relating to mobile subscription states. A mobile subscription state indicates a condition of a subscription of a mobile device to an MNO the condition impacting whether a secure element of a corresponding mobile device successfully communicates with the central TSM . That is since the central TSM may rely on the mobile network to communicate with a secure element a disruption within the mobile network may affect the reception of such communications. A disruption may be network wide within a mobile network or may be specific to a particular mobile subscription associated with a specific mobile device . Embodiments herein will be described with respect to the latter type of disruption in a circumstance where a particular mobile subscription is intentionally deactivated by the MNO. As will be described this may occur for a number of reasons such as for instance a lost or stolen mobile device being reported. However it will be appreciated that the example embodiment of the invention is similarly applicable towards the circumstance of a network wide disruption within a mobile network e.g. network outage .

Database contains a number of entries . . . collectively each storing fields of information . . . collectively . The fields of information may include a customer reference identifier a corresponding secure element identifier a corresponding mobile subscription identifier a mobile device number a mobile subscription state a mobile wallet state in addition to any other corresponding information . The customer reference identifier identifies a customer operating a mobile device and conducting transactions within system the secure element identifier identifies a specific secure element associated with the mobile device of a customer the mobile subscription identifier identifies a mobile subscription associated with the mobile device of a customer and the mobile device number identifies the telephone number of the mobile device.

The mobile subscription state identifies a state of the mobile subscription corresponding to the mobile device associated with the customer. The potential mobile subscription states may include at least ACTIVATED RESTRICTED SUSPENDED and TERMINATED as discussed in greater detail below but may also include other states.

The mobile wallet state identifies a state of a mobile wallet used for conducting transactions within the system . The potential mobile wallet states may include at least ACTIVATED and SUSPENDED but may also include other states.

As shown in the state diagram the system may incorporate at least four mobile subscription states an activated state ACTIVATED a restricted state RESTRICTED a suspended state SUSPENDED and a terminated state TERMINATED . The activated and restricted states may indicate that the mobile subscription is active so communications with the mobile device over the mobile network is possible. The suspended and terminated states may indicate that the mobile subscription is inactive so the mobile device is incapable of receiving communications transmitted across the mobile network.

The activated state may differ from the restricted state in that the activated state does not include any access restrictions for the mobile subscription. On the other hand a restricted state may impose certain restrictions for the mobile subscription such that only certain forms or quantities of data transmission speeds or other restrictions are permitted across the mobile network.

The suspended state may indicate that the mobile subscription is only temporarily inactive but may potentially be reactivated back into one of the active states. The terminated state may indicate that mobile subscription is permanently inactive and cannot be reactivated.

At step the service provider transmits a request to the ESB over a communications network. The request may be a request to modify content stored on the secure element . The request may identify a specific secure element to be modified according to a secure element identifier a mobile subscription identifier a mobile device number and or any other identifying information.

At step the ESB forwards the request over a communications network to the central TSM to be processed. The request may be directly forwarded from the ESB to the central TSM in its original form if the central TSM is capable of directly processing the request or otherwise may be modified by the ESB in a data format recognized by the central TSM . It will also be appreciated that the requests may be generated internally within the central TSM e.g. software updates to be transmitted to secure element in which case steps and are not required.

At step the central TSM checks the mobile subscription state associated with the secure element identified in the request. As described with respect to mobile subscription states corresponding to secure elements are stored in the memory within the central TSM . The central TSM retrieves from the memory the mobile subscription state that corresponds to the identified secure element . The mobile subscription state includes information indicating a state of a mobile device associated with the identified secure element particularly a state of a mobile subscription associated with such mobile device. As discussed above the mobile subscription state may be one of at least ACTIVATED RESTRICTED SUSPENDED and TERMINATED . The ACTIVATED and RESTRICTED states may indicate that the mobile subscription is active so communications with the mobile device over the mobile network are possible. The SUSPENDED and TERMINATED states may indicate that the mobile subscription is inactive so the mobile device is incapable of receiving communications transmitted across the mobile network.

In step the central TSM checks whether the mobile subscription state is in an active state e.g. ACTIVATED or RESTRICTED state or whether the mobile subscription state is in an inactive state e.g. SUSPENDED or TERMINATED state . If the mobile subscription is in an active state the mobile device is capable of receiving transmissions over the mobile network. If the mobile subscription is in an inactive state the mobile subscription is inactive and transmissions sent over the mobile network will not be received by the mobile device.

In the scenario depicted in the mobile subscription associated with the mobile device of the secure element is in an ACTIVATED or RESTRICTED state. As such at step the central TSM concludes that reception by the mobile device of transmissions over the mobile subscription is possible.

At step the central TSM sends a command across the mobile network to the mobile device associated with the secure element . The command includes instructions that when executed by the secure element modify content within the secure element in accordance with the content modification request sent by the service provider in step . The command may also include identifier information passcodes setting information flags arguments and or any other information relating to the command for execution by the secure element .

At step the secure element executes the command which modifies content stored on the secure element in accordance with the content modification request.

At step the secure element transmits a response over the mobile network to the central TSM . The response indicates whether the secure element successfully executed the command in step such that the appropriate content has been modified on the secure element .

At step the central TSM forwards the response over a communications network to the ESB . Similar to the request sent in step the response may be directly forwarded from the central TSM to the ESB in its original form if the ESB is capable of directly processing the response or otherwise may be modified by the central TSM in a data format recognized by the ESB .

At step the ESB forwards the response over a communications network to the service provider . As with the response in step the response may be directly forwarded from the ESB to the service provider in its original form if the service provider is capable of directly processing the response or otherwise may be modified by the ESB in a data format recognized by the service provider .

In the circumstance that the request was generated internally by the central TSM steps and may be skipped.

At step the service provider transmits a request over a communications network to the ESB over a communications network similar to step . As with step the request may be a request to modify content stored on the secure element and may identify a specific secure element to be modified according to a secure element identifier a mobile subscription identifier a mobile device number and or any other identifying information.

At step the ESB forwards the request over a communications network to the central TSM to be processed similar to step . As with step the request may be directly forwarded from the ESB to the central TSM in its original form if the central TSM is capable of directly processing the request or otherwise may be modified by the ESB in a data format recognized by the central TSM . It will also be appreciated that the requests may be generated internally within the central TSM e.g. software updates to be transmitted to secure element in which case steps and are not required.

At step the central TSM checks the mobile subscription state associated with the secure element identified in the request similar to step . However while the mobile subscription state of the corresponding mobile subscription in the scenario of is ACTIVATED or RESTRICTED the mobile subscription state in the scenario of is SUSPENDED or TERMINATED .

As such at step the central TSM concludes that reception by the mobile device of transmissions over the mobile network is not possible since the mobile subscription is inactive.

At step the central TSM transmits a response over a communications network to the ESB . The response indicates an error associated with processing the request. The response may include a code e.g. error code or string that corresponds to this error. For instance the response may include the error code that indicates Mobile Subscription State not compliant with the requested operation . Of course it will be appreciated that the error data may be encoded according to any other format as long as the error data is capable of ultimately being decoded.

At step the ESB forwards the response over a communications network to the service provider . As with the response in step the response may be directly forwarded from the ESB to the service provider in its original form if the service provider is capable of directly processing the response or otherwise may be modified by the ESB in a data format recognized by the service provider .

In an exemplary embodiment of the invention a mobile subscription state is updated. The mobile subscription state is described above with respect to .

At step the MNO transmits a notification over a communications network to the ESB that a mobile subscription has been suspended. The notification includes information to identify a specific mobile subscription such as a mobile subscription identifier mobile device number secure element identifier or any identifier corresponding to a mobile subscription.

The mobile subscription may have been suspended for any number of reasons. In certain scenarios the MNO may suspend the mobile subscription on the initiative of a mobile device owner. For instance a mobile device owner may report a lost or stolen mobile device to the MNO and the MNO suspends the corresponding mobile subscription to prevent fraudulent use of the mobile device. Or the mobile device owner may have disabled roaming capabilities and the MNO suspends the mobile subscription when the mobile device connects outside a home network.

Alternatively the MNO may suspend the mobile subscription on its own initiative e.g. for delinquency of bill payment for the mobile subscription account .

At step the ESB forwards the notification to the central TSM . The request may be directly forwarded from the ESB to the central TSM in its original form if the central TSM is capable of directly processing the request or otherwise may be modified by ESB in a data format recognized by the central TSM .

At step the central TSM updates a memory to reflect that the mobile subscription state for the mobile subscription associated with the notification is in a suspended state.

At step the central TSM transmits a response to the notification forwarded in step . The response indicates that the mobile subscription state corresponding to the respective mobile subscription has been updated to reflect a suspended mobile subscription.

At step upon receiving the response in step the central ESB transmits an event notification to the wallet server notifying the wallet server that the mobile network service corresponding to the respective mobile subscription has been suspended. The event notification may be constructed according to any particular format recognized by the wallet server including an event notification according to the string MNO Service Suspended and an identifier such as a secure element identifier a mobile subscription identifier a mobile device number and or any other identifying information.

At step the central ESB transmits an event notification to one or more service providers . The event notification informs a service provider that the mobile network service corresponding to the respective mobile subscription has been suspended. The event notification may be identical to the notification transmitted in step or may be constructed according to a different format. If multiple service providers are being notified an event notification may be individually transmitted to each service provider or a single event notification may be multicast to the multiple service providers. In one embodiment the event notification is formatted according to an established API definition such as event Notification MNO SERVICE SUSPENDED . However as with the notification in step the event notification may be constructed according to any particular format recognized by the service provider s and may include an identifier such as a secure element identifier a mobile subscription identifier a mobile device number and or any other identifying information.

At step the service provider s suspend the services on their respective computing systems that correspond to the suspended mobile subscription. That is the service provider s configure their computing systems such that transactions corresponding to the secure element within the mobile device of the suspended mobile subscription will not be processed.

It will be appreciated that sequence diagram is applicable for updating other changes in the state of a mobile subscription beyond the depicted scenario of changing the mobile subscription state to SUSPENDED . For instance the mobile subscription state may be changed to TERMINATED or any other state indicating that the mobile subscription is inactive.

At step the MNO transmits a notification over a communications network to the ESB that a mobile subscription has been reactivated. The notification includes information to identify a specific mobile subscription such as a mobile subscription identifier mobile device number secure element identifier or any identifier corresponding to a mobile subscription. The notification may be similar to the notification transmitted in step except that a different parameter is provided indicating the reactivation of the mobile subscription. Alternatively the notification may be in an entirely different format from the one in step .

The mobile subscription may have been reactivated for any number of reasons. In certain scenarios the MNO may reactivate the mobile subscription on the initiative of a mobile device owner. For instance a mobile device owner may report to the MNO that a previously lost or stolen mobile device has been recovered and the MNO reactivates the corresponding mobile subscription to restart use of the mobile device. Or where the mobile device owner disabled roaming capabilities and the mobile device was previously outside of the home network the MNO may reactivate the mobile subscription when the mobile device reconnects within a home network.

Alternatively the MNO may reactivate the mobile subscription on its own initiative e.g. to lift a mobile subscription suspension resulting from nonpayment of mobile subscription bills when the payment is finally made .

At step the ESB forwards the notification to a central TSM . As with step the request may be directly forwarded from the ESB to the central TSM in its original form if the central TSM is capable of directly processing the request or otherwise may be modified by ESB in a data format recognized by the central TSM .

At step the central TSM updates its memory to reflect that the mobile subscription state for the mobile subscription associated with the notification is in an activated state.

At step the central TSM transmits a response to the notification forwarded in step . The response indicates that the mobile subscription state corresponding to the respective mobile subscription has been updated to reflect an activated mobile subscription. The response may be similar to the response transmitted in step except that a different parameter is provided indicating the reactivation of the mobile subscription. Alternatively the response may be in an entirely different format from the one in step .

At step upon receiving the response in step the central ESB transmits an event notification to a wallet server notifying the wallet server that the mobile network service corresponding to the respective mobile subscription has been reactivated. The event notification may be constructed according to any particular format recognized by the wallet server including an event notification according to the string MNO Service Reactivated and an identifier such as a secure element identifier a mobile subscription identifier a mobile device number and or any other identifying information. The event notification may be similar to the notification transmitted in step except that a different parameter is provided indicating reactivation. Alternatively the notification may be in an entirely different format from the one in step .

At step the central ESB transmits an event notification to one or more service providers . The event notification informs the service provider that the mobile network service corresponding to the respective mobile subscription has been reactivated. The event notification may be identical to the notification transmitted in step or may be constructed according to a different format. If multiple service providers are being notified an event notification may be individually transmitted to each service provider or a single event notification may be multicast to the multiple service providers. In one embodiment the event notification is formatted according to an established API definition such as event Notification MNO SERVICE REACTIVATED . However as with the notification in step the event notification may be constructed according to any particular format recognized by the service provider s and may include an identifier such as a secure element identifier a mobile subscription identifier a mobile device number and or any other identifying information. The event notification may be similar to the notification transmitted in step except that a different parameter is provided indicating reactivation. Alternatively the notification may be in an entirely different format from the one in step .

At step the service provider s reactivate the services on their respective computing systems that correspond to the reactivated mobile subscription. That is the service provider s configure their computing systems such that transactions corresponding to the secure element within the mobile device of the suspended mobile subscription will be processed. In some cases a service may have been blacklisted such that the instance of the service has been permanently disabled and cannot be reactivated. In this case the service provider may request a complete reinstallation of the service to re enable usage of the service.

It will be appreciated that sequence diagram is applicable for updating other changes in the state of a mobile subscription beyond the depicted scenario of changing the mobile subscription state to ACTIVATED . For instance the mobile subscription state may be changed to RESTRICTED or any other state indicating that the mobile subscription is active.

In an exemplary embodiment of the invention a mobile wallet state is updated. The mobile wallet state is described above with respect to . In one embodiment the mobile wallet state is updated independently from the mobile subscription state. In an alternative embodiment the mobile wallet state may be updated concurrently with the mobile subscription state.

At step the ESB receives a request over a communications network to suspend a mobile wallet. The request may have been transmitted from one of any number of sources including from the web server hosting a web site step from the MNO step or from the secure element within a mobile device step . In the case of step where the web server transmits the request the web server may have generated the request upon instructions from a customer a system administrator an automated script or any other source. In the case of step where the MNO transmits the request the request may simply constitute the notification of mobile subscription suspension as described in step or may be a separate request to suspend the mobile wallet. It will also be appreciated that the request may originate from any other source. The requests transmitted from the web server the MNO and the secure element may be identical in data format or may be different as long as the ESB is capable of processing the request.

At step the ESB transmits a request over a communications network to a central TSM to reflect a suspended mobile wallet state. In one embodiment the request is formatted according to an established API definition such as WalletSuspended and includes at least parameters for identifying the specific mobile wallet being suspended. In that embodiment the mobile wallet is identified according to a customer reference identifier but may also be identified according to a secure element identifier a mobile subscription identifier a mobile device number and or any other identifying information.

At step the central TSM updates a memory to reflect that the mobile wallet state for the identified mobile wallet is a suspended state.

At step the central TSM transmits a response over a communications network to the ESB responding to the request transmitted in step . The response contains data indicating whether the mobile wallet state was successfully changed in step .

At step the ESB transmits an event notification over a communications network to one or more service providers . The notification informs a service provider that a specific mobile wallet has been suspended. If multiple service providers are being notified an event notification may be individually transmitted to each service provider or a single event notification may be multicast to the multiple service providers. In one embodiment the event notification is formatted according to an established API definition such as Event Notification SUSPEND WALLET . However the event notification may be constructed according to any particular format recognized by the service provider s and may include an identifier such as a customer reference identifier secure element identifier a mobile subscription identifier a mobile device number and or any other identifying information.

At step the service provider s suspend the services on their computing systems that correspond to the suspended mobile wallet. That is the service provider s configure their computing systems such that transactions corresponding to the suspended mobile wallet will not be processed.

At step the ESB transmits a request over a communications network to the central TSM to lock the secure element that corresponds to the suspended mobile wallet. In one embodiment the locking of the secure element includes at least the locking of a security domain on the secure element such as a security domain TSD of the central TSM . In another embodiment the request is formatted according to an established API definition such as Lock TSD with at least a parameter that identifies a secure element. In an exemplary embodiment such parameter is a customer reference identifier but may consist or include other identifier s such as a secure element identifier a mobile subscription identifier a mobile device number and or any other identifying information.

At step the central TSM transmits a command over a communications network to the mobile device corresponding to the secure element to lock the TSD within the secure element . In one embodiment the command is transmitted over the mobile network connecting the mobile device and is formatted according to an established API definition such as SET STATUS . In addition the command is formatted as SET STATUS AID P1 60 P2 b8 1 where AID is an application identifier of the TSD. In one embodiment SET STATUS is defined in the API to be used for changing a life cycle state of the TSD. In an alternative embodiment the command is transmitted via a secure channel protocol across the mobile network. It is recognized that the specific secure channel protocol may vary in accordance with a specific profile or type of the secure element . For instance if the secure element is integrated within a SIM card of the mobile device a first secure channel protocol may be used. If the secure element is integrated within a removable microSD card or is integrated into the mobile device hardware a second different secure channel protocol may be used. The secure element receives the command upon reception by the mobile device.

At step the secure element locks the TSD. The locking operation may be accomplished via an execution of functions a hardware change a software change or a combination of all. If the locking operation is processed successfully at least some of the associated applications and service provider security domains within the secure element are no longer selectable.

At step the secure element transmits a response over a communications network to the central TSM . The response informs the central TSM of whether the locking process at step is successful. The response may include a parameter indicating Locking Successful which may be integrated in the response as either a flag parameter or as a string.

At step the central TSM transmits a response over a communications network to the ESB responding to the request transmitted in step . The response contains data indicating whether the TSD has been successfully locked or whether the TSD locking operation failed.

At step the ESB transmits an event notification over a communications network to one or more service providers . The notification informs a service provider that the secure element has been locked. As with the notification in step if multiple service providers are being notified an event notification may be individually transmitted to each service provider or a single event notification may be multicast to the multiple service providers. In one embodiment the event notification is formatted according to an established API definition such as Event Notification LOCK SECURE ELEMENT . However the event notification may be constructed according to any particular format recognized by the service provider s and may include an identifier such as a customer reference identifier secure element identifier a mobile subscription identifier a mobile device number and or any other identifying information.

At step the ESB receives a request over a communications network to unlock a mobile wallet. The request may be transmitted from one of any number of sources including from the web server hosting a web site step from the MNO step or from the secure element within a mobile device step . In the case of step where the web server transmits the request the web server may have generated the request upon instructions from a customer a system administrator an automated script or any other source. In the case of step where the MNO transmits the request the request may include the notification of mobile subscription reactivation as described in step or may be a separate request to unlock the mobile wallet. It will also be appreciated that the request may originate from any other source than the MNO . The requests transmitted from the web server the MNO and the secure element may be identical in data format or may be different as long as the ESB is capable of processing the request.

At step the ESB transmits a request over a communications network to the central TSM to unlock the secure element that corresponds to the mobile wallet to be reactivated. In one embodiment the unlocking of the secure element includes at least the unlocking of a security domain on the secure element with such security domain being a security domain i.e. TSD of the central TSM . In one embodiment the request is formatted according to an established API definition such as Unlock TSD with at least a parameter that identifies a secure element. In an alternative embodiment such parameter is a customer reference identifier but may consist or include other identifier s such as a secure element identifier a mobile subscription identifier a mobile device number and or any other identifying information.

At step the central TSM transmits a command over a communications network to the mobile device corresponding to the secure element to unlock the TSD within the secure element . According to an exemplary embodiment the command is transmitted over the mobile network connecting the mobile device and is formatted according to an established API definition such as SET STATUS as discussed with respect to step . In an alternative embodiment the command is formatted as SET STATUS AID P1 60 P2 b8 0 where AID is an application identifier of the TSD. In an exemplary embodiment as discussed above SET STATUS is defined in the API to be used for changing a life cycle state of the TSD. As discussed above with respect to step the SET STATUS command is transmitted via a secure channel protocol across the mobile network and may involve different e.g. first and second secure channel protocols depending on a specific profile or type of the secure element e.g. SIM card microSD or integrated within mobile device hardware . The secure element receives the command upon reception by the mobile device.

At step the secure element unlocks the TSD. The unlocking operation may be accomplished according via a hardware change a software change or a combination of both hardware and software. In one embodiment the unlocking process operates according to the same methodology used to lock the TSD in step . If the unlocking operation is processed successfully some or all of the associated applications within the secure element and some or all of the service provider security domains are set to be accessible. Thus all of the associated applications and the service provider security domains can be again selectable.

At step the central TSM transmits a rules refresh command over a communications network to the mobile device corresponding to the secure element . The command instructs the secure element to call a refresh tag within its master application access rule. This instruction forces a rules enforcer application to request a rules update. A rules update ensures that the secure element is properly updated according to present parameters as established by the central TSM .

At step the secure element sets its refresh tag as instructed which initiates a rules update for the secure element .

At step the secure element transmits a response over a communications network to the central TSM . The response informs the central TSM of whether the unlocking operation of the secure element was successful. The response may include a parameter indicating Unlocking Successful which may be integrated in the response as either a flag parameter or as a string.

At step the central TSM transmits a response over a communications network to the ESB responding to the request transmitted in step . The response contains data indicating whether the TSD has been successfully unlocked or whether the TSD unlocking operation failed.

At step the ESB transmits an event notification over a communications network to one or more service providers . The notification informs a service provider that the secure element has been unlocked. If multiple service providers are being notified an event notification may be individually transmitted to each service provider or a single event notification may be multicast to the multiple service providers. In one embodiment the event notification is preferably formatted according to an established API definition such as Event Notification UNLOCK SECURE ELEMENT . However the event notification may be constructed according to any particular format recognized by the service provider s and may include an identifier such as a customer reference identifier secure element identifier a mobile subscription identifier a mobile device number and or any other identifying information.

At step the ESB transmits a request over a communications network to the central TSM to reflect an activated mobile wallet state. In one embodiment the request is formatted according to an established API definition such as WalletActivated and includes at least parameters for identifying the specific mobile wallet being suspended. In an exemplary embodiment the mobile wallet is identified according to a customer reference identifier but may also be identified according to a secure element identifier a mobile subscription identifier a mobile device number and or any other identifying information.

At step the central TSM updates a memory to reflect that the mobile wallet state for the identified mobile wallet is an activated state.

At step the central TSM transmits a response over a communications network to the ESB responding to the request transmitted in step . The response contains data indicating whether the mobile wallet state was successfully changed in step .

At step the ESB transmits an event notification over a communications network to one or more service providers . The notification informs a service provider that a specific mobile wallet has been resumed. As with the notification in step if multiple service providers are being notified an event notification may be individually transmitted to each service provider or a single event notification may be multicast to the multiple service providers. In one embodiment the event notification is formatted according to an established API definition such as Event Notification RESUME WALLET . However the event notification may be constructed according to any particular format recognized by the service provider s and may include an identifier such as a customer reference identifier secure element identifier a mobile subscription identifier a mobile device number and or any other identifying information.

At step the service provider s resume the services on their computing systems that correspond to the reactivated mobile wallet. That is the service provider s configure their computing systems such that transactions corresponding to the reactivated mobile wallet will be processed.

The example embodiments described above such as for example the systems and procedures depicted in or discussed in connection with or any part or function thereof may be implemented by using hardware software or a combination of the two. The implementation may be in one or more computers or other processing systems. While manipulations performed by these example embodiments may have been referred to in terms commonly associated with mental operations performed by a human operator no human operator is needed to perform any of the operations described herein. In other words the operations may be completely implemented with machine operations. Useful machines for performing the operation of the example embodiments presented herein include general purpose digital computers or similar devices.

Portions of the example embodiments of the invention may be conveniently implemented by using a conventional general purpose computer a specialized digital computer and or a microprocessor programmed according to the teachings of the present disclosure as is apparent to those skilled in the computer art. Appropriate software coding may readily be prepared by skilled programmers based on the teachings of the present disclosure.

Some embodiments may also be implemented by the preparation of application specific integrated circuits field programmable gate arrays or by interconnecting an appropriate network of conventional component circuits.

Some embodiments include a computer program product. The computer program product may be a non transitory storage medium or media having instructions stored thereon or therein which can be used to control or cause a computer to perform any of the procedures of the example embodiments of the invention. The storage medium may include without limitation a floppy disk a mini disk an optical disc a Blu ray Disc a DVD a CD or CD ROM a micro drive a magneto optical disk a ROM a RAM an EPROM an EEPROM a DRAM a VRAM a flash memory a flash card a magnetic card an optical card nanosystems a molecular memory integrated circuit a RAID remote data storage archive warehousing and or any other type of device suitable for storing instructions and or data.

Stored on any one of the non transitory computer readable medium or media some implementations include software for controlling both the hardware of the general and or special computer or microprocessor and for enabling the computer or microprocessor to interact with a human user or other mechanism utilizing the results of the example embodiments of the invention. Such software may include without limitation device drivers operating systems and user applications. Ultimately such computer readable media further includes software for performing example aspects of the invention as described above.

Included in the programming and or software of the general and or special purpose computer or microprocessor are software modules for implementing the procedures described above.

While various example embodiments of the invention have been described above it should be understood that they have been presented by way of example and not limitation. It is apparent to persons skilled in the relevant art s that various changes in form and detail can be made therein. Thus the disclosure should not be limited by any of the above described example embodiments but should be defined only in accordance with the following claims and their equivalents.

In addition it should be understood that the figures are presented for example purposes only. The architecture of the example embodiments presented herein is sufficiently flexible and configurable such that it may be utilized and navigated in ways other than that shown in the accompanying figures.

Further the purpose of the Abstract is to enable the U.S. Patent and Trademark Office and the public generally and especially the scientists engineers and practitioners in the art who are not familiar with patent or legal terms or phraseology to determine quickly from a cursory inspection the nature and essence of the technical disclosure of the application. The Abstract is not intended to be limiting as to the scope of the example embodiments presented herein in any way. It is also to be understood that the procedures recited in the claims need not be performed in the order presented.

