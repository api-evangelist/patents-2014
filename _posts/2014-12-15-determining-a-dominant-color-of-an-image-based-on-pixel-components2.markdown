---

title: Determining a dominant color of an image based on pixel components
abstract: A digital magazine server determines a dominant color present in an image using a clustering algorithm. Color components of each pixel in the image are identified used to generate vectors associated with each pixel. Based on the vectors associated with the pixels, clusters including one or more pixels are generated using a clustering algorithm (e.g., k-means). The digital magazine server generates a characteristic vector for each cluster based on the vectors included in the cluster and selects a set of clusters based on their characteristic vectors. A centroid identifying the dominant color of the image is determined from the characteristic vectors of clusters in the set.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09576554&OS=09576554&RS=09576554
owner: Flipboard, Inc.
number: 09576554
owner_city: Palo Alto
owner_country: US
publication_date: 20141215
---
This invention relates generally to image analysis and more specifically to determining a dominant color of an image.

A digital magazine server provides digital content to its users via a digital magazine having various pages that each includes content items and information describing positioning of content items relative to each other. Digital content included in a digital magazine frequently includes images. To enhance user interaction with content items presented in a page of the digital magazine the digital magazine server often includes text providing additional information about an image in the image itself. Additionally including text in an image may allow the digital magazine server to reduce an image s size by using the text to describe content associated with the image which may increase the number of content items presented in a page of the digital magazine. However conventional methods for including text in an image often result in the text being illegible or obscured based on colors of the image.

A digital magazine server obtains an image for presentation to a user that includes a set of pixels. For example the image is received from a source providing content items to the digital magazine server e.g. another user of the digital magazine server . The image is represented using a color model such as red green blue RGB or cyan magenta yellow black CMYK . Based on the color model each pixel in the image is represented by a number of color components that each correspond to a color and have a color value specifying an intensity of the color corresponding to a color component.

To identify a dominant color of the image the digital magazine server identifies one or more of the color components associated with each pixel in the set of pixels. For example one or more color components specified by a color model associated with the image and their associated color values for various pixels of the image are identified by the digital magazine server. The one or more color components may be extracted from the image may be identified based on data associated with the image by the digital magazine server or may be identified based on additional information received from a source associated with the image.

Based at least in part on the identified one or more color components associated with a pixel the digital magazine server generates a vector for the pixel. The digital magazine server generates a vector for each pixel in the image in some embodiments. Thus a vector associated with a pixel is determined based on a vector space having a number of dimensions defined by a number of the identified color components. The vector associated with a pixel is then based on coordinates in the vector space corresponding to color values of identified color components corresponding to each dimension in the vector space. In some embodiments color components associated with one or more pixels having less than a threshold distance to a pixel are used when generating the vector associated with the pixel. For example identified color components associated with pixels adjacent to a pixel are used when determining the vector associated with the pixel or identified color components associated with additional pixels within a threshold number of pixels from the pixel are used when generating the vector associated with the pixel. Identified color components associated with the pixel and with additional pixels within the threshold distance of the pixel may be differently weighted when generating the vector associated with the pixel. Similarly identified color components associated with different pixels within the threshold distance of the pixel may be differently weighted for example identified color components associated with a pixel having a greater distance from the pixel may be associated with a lower weight than identified color components associated with a pixel having a smaller distance from the pixel.

Using the generated vectors the digital magazine server generates one or more clusters with each cluster including one or more pixels. In one embodiment K means clustering is used to generate the one or more clusters based on the generated vectors associated with various pixels. Using K means clustering determines whether a pixel is included in a cluster based on the distance between a vector associated with the pixel and a mean value associated with the cluster. For example a pixel associated with a vector having less than a threshold distance between the vector and a mean value associated with the cluster is included in the cluster. A cluster may also be associated with a threshold number of pixels associated with the cluster a threshold magnitude i.e. a sum of magnitudes of vectors associated with pixels included in the cluster is less than or equal to the threshold magnitude a threshold distance from a mean value of the cluster or any combination thereof. In other embodiments alternative clustering methods may be used to generate the clusters. Examples of alternative clustering methods include a balanced iterative reducing and clustering using hierarchies BIRCH method a hierarchical method an expectation maximization EM method a density based spatial clustering of applications with noise DBSCAN method an ordering points to identify the clustering structure OPTICS method or a mean shift clustering method.

Based on the generated vectors associated with pixels included in each cluster the digital magazine server generates characteristic vectors for each cluster. A characteristic vector for a cluster represents a color associated with the cluster based on dimensions of the characteristic vector. The characteristic vector for the cluster is based on combinations of one or more dimensions of the generated vectors associated with pixels included in the cluster. For example the characteristic vector for the cluster is a sum or a weighted sum of dimensions of vectors associated with pixels included in the cluster.

The digital magazine server selects a set of the clusters based at least in part on the characteristic vectors. In one embodiment the digital magazine server ranks clusters based on magnitudes of their characteristic vectors and selects the set of clusters as clusters having at least a threshold position in the ranking. Alternatively the digital magazine server selects clusters having characteristic vectors having at least a threshold magnitude. In other embodiments a score is generated for each cluster based on a magnitude of a cluster s characteristic vector a dimension of the cluster s characteristic vector a number of pixels in the cluster or any combination thereof. The digital magazine server selects clusters having at least a threshold score or ranks clusters based on their scores and selects clusters having at least a threshold position in the ranking.

Based on the characteristic vectors for each cluster in the selected set of clusters the digital magazine server determines a centroid that identifies a dominant color associated with the image. Alternatively the digital magazine server selects a cluster based at least in part on the characteristic vector of the cluster identifies the characteristic vector of the selected cluster as identifying the dominant color associated with the image. For example the digital magazine server selects a cluster from the set of clusters including a maximum number of pixels and identifies the characteristic vector of the selected color as identifying the dominant color associated with the image.

The digital magazine server stores information associating the dominant color with the image. In some embodiments the digital magazine server modifies the image based at least in part on the dominant color. For example the digital magazine server modifies the image to include elements based on the dominant color of the image. As an example when overlaying a text element in an image associated with a dominant color of red the digital magazine server selects a color of the text element different than the dominant color of red such as a color that is a complementary color of red or any other suitable color. The digital magazine server may also select additional content items for presentation to the user along with the image based on the dominant color associated with the image.

The figures depict various embodiments of the present invention for purposes of illustration only. One skilled in the art will readily recognize from the following discussion that alternative embodiments of the structures and methods illustrated herein may be employed without departing from the principles of the invention described herein.

A digital magazine server retrieves content from one or more sources and generates a personalized customizable digital magazine for a user based on the retrieved content. The generated digital magazine is retrieved by a digital magazine application executing on a computing device such as a mobile communication device tablet computer or any other suitable computing system and presented to the user. For example based on selections made by the user and or on behalf of the user the digital server application generates a digital magazine including one or more sections including content items retrieved from a number of sources and personalized for the user. The generated digital magazine allows the user to more easily consume content that interests and inspires the user by presenting content items in an easily navigable interface via a computing device.

The digital magazine may be organized into a number of sections that each include content having a common characteristic e.g. content obtained from a particular source . For example a section of the digital magazine includes articles from an online news source such as a website for a news organization another section includes articles from a third party curated collection of content associated with a particular topic e.g. a technology compilation and an additional section includes content obtained from one or more accounts associated with the user and maintained by one or more social networking systems. For purposes of illustration content included in a section is referred to herein as content items or articles which may include textual articles pictures videos products for sale user generated content e.g. content posted on a social networking system advertisements and any other types of content capable of display within the context of a digital magazine.

A source is a computing system capable of providing various types of content to a client device . Examples of content provided by a source include text images video or audio on web pages web feeds social networking information messages or other suitable data. Additional examples of content include user generated content such as blogs tweets shared images video or audio social networking posts and social networking status updates. Content provided by a source may be received from a publisher e.g. stories about news events product information entertainment or educational material and distributed by the source or a source may be a publisher of content it generates. For convenience content from a source regardless of its composition may be referred to herein as an article a content item or as content. A content item may include various types of content such as text images and video.

The sources communicate with the client device and the digital magazine server via the network which may comprise any combination of local area and or wide area networks using both wired and or wireless communication systems. In one embodiment the network uses standard communications technologies and or protocols. For example the network includes communication links using technologies such as Ethernet 802.11 worldwide interoperability for microwave access WiMAX 3G 4G code division multiple access CDMA digital subscriber line DSL etc. Examples of networking protocols used for communicating via the network include multiprotocol label switching MPLS transmission control protocol Internet protocol TCP IP hypertext transport protocol HTTP simple mail transfer protocol SMTP and file transfer protocol FTP . Data exchanged over the network may be represented using any suitable format such as hypertext markup language HTML or extensible markup language XML . In some embodiments all or some of the communication links of the network may be encrypted using any suitable technique or techniques.

The client device is one or more computing devices capable of receiving user input as well as transmitting and or receiving data via the network . In one embodiment the client device is a conventional computer system such as a desktop or a laptop computer. Alternatively the client device may be a device having computer functionality such as a personal digital assistant PDA a mobile telephone a smartphone or another suitable device. In one embodiment the client device executes an application allowing a user of the client device to interact with the digital magazine server . For example an application executing on the client device communicates instructions or requests for content items to the digital magazine server to modify content presented to a user of the client device . As another example the client device executes a browser that receives pages from the digital magazine server and presents the pages to a user of the client device . In another embodiment the client device interacts with the digital magazine server through an application programming interface API running on a native operating system of the client device such as IOS or ANDROID . While shows a single client device in various embodiments any number of client devices may communicate with the digital magazine server .

A display device included in the client device presents content items to a user of the client device . Examples of the display device include a liquid crystal display LCD an organic light emitting diode OLED display an active matrix liquid crystal display AMLCD or any other suitable device. Different client devices may have display devices with different characteristics. For example different client devices have display devices with different display areas different resolutions or differences in other characteristics.

One or more input devices included in the client device receive input from the user. Different input devices may be included in the client device . For example the client device includes a touch sensitive display for receiving input data commands or information from a user. Using a touch sensitive display allows the client device to combine the display device and an input device simplifying user interaction with presented content items. In other embodiments the client device may include a keyboard a trackpad a mouse or any other device capable of receiving input from a user. In another example the input device is configured to receive information from a user of the client device through a touchless interface. Examples of a touchless interface include sensors such as an image capture device to receive gestures from a client device user without the user physically contacting the display device or the client device . Additionally the client device may include multiple input devices in some embodiments. Inputs received via the input device may be processed by a digital magazine application associated with the digital magazine server and executing on the client device to allow a client device user to interact with content items presented by the digital magazine server .

The digital magazine server receives content items from one or more sources generates pages in a digital magazine by processing the received content and provides the pages to the client device . As further described below in conjunction with the digital magazine server generates one or more pages for presentation to a user based on content items obtained from one or more sources and information describing organization and presentation of content items. For example the digital magazine server determines a page layout specifying positioning of content items relative to each other based on information associated with a user and generates a page including the content items arranged according to the determined layout for presentation to the user via the client device . This allows the user to access content items via the client device in a format that enhances the user s interaction with and consumption of the content items. For example the digital magazine server provides a user with content items in a format similar to the format used by print magazines. By presenting content items in a format similar to a print magazine the digital magazine server allows a user to interact with content items from multiple sources via the client device with less inconvenience from horizontally or vertically scrolling to access various content items.

Each user of the digital magazine server is associated with a user profile which is stored in the user profile store . A user profile includes declarative information about the user that was explicitly shared by the user and may also include profile information inferred by the digital magazine server . In one embodiment a user profile includes multiple data fields each describing one or more attributes of the corresponding social networking system user. Examples of information stored in a user profile include biographic demographic and other types of descriptive information such as gender hobbies or preferences location or other suitable information. A user profile in the user profile store also includes data describing interactions by a corresponding user with content items presented by the digital magazine server . For example a user profile includes a content item identifier a description of an interaction with the content item corresponding to the content item identifier and a time when the interaction occurred.

While user profiles in the user profile store are frequently associated with individuals allowing individuals to provide and receive content items via the digital magazine server user profiles may also be stored for entities such as businesses or organizations. This allows an entity to provide or access content items via the digital magazine server . An entity may post information about itself about its products or provide other content items associated with the entity to users of the digital magazine server . For example users of the digital magazine server may receive a digital magazine or section including content items associated with an entity via the digital magazine server .

The template store includes page templates each describing a spatial arrangement layout of content items relative to each other on a page for presentation by a client device . A page template includes one or more slots each configured to present one or more content items. In some embodiments slots in a page template may be configured to present a particular type of content item or to present a content item having one or more specified characteristics. For example a slot in a page template is configured to present an image while another slot in the page template is configured to present text data. Each slot has a size e.g. small medium or large and an aspect ratio. One or more page templates may be associated with types of client devices allowing content items to be presented in different relative locations and with different sizes when the content items are viewed using different client devices . Additionally page templates may be associated with sources allowing a source to specify the format of pages presenting content items received from the source . For example an online retailer is associated with a page template to allow the online retailer to present content items via the digital magazine server with a specific organization. Examples of page templates are further described in U.S. patent application Ser. No. 13 187 840 filed on Jul. 21 2011 and U.S. patent application Ser. No. 13 938 227 filed on Jul. 9 2103 each of which is hereby incorporated by reference in its entirety.

The content store stores objects that each represent various types of content. For example the content store stores content items received from one or more sources within a threshold time of a current time. Examples of content items stored by the content store include a page post an image a status update a photograph a video a link an article video data audio data a check in event at a location or any other type of content. A user may specify a section including content items having a common characteristic and the common characteristic is stored in the content store along with an association with the user profile or the user specifying the section.

The layout engine retrieves content items from one or more sources or from the content store and generates a page including the content items based on a page template from the template store . Based on the retrieved content items the layout engine may identify candidate page templates from the template store score the candidate page templates based on characteristics of the slots in different candidate page templates and based on characteristics of the content items. Based on the scores associated with candidate page templates the layout engine selects a page template and associates the retrieved content items with one or more slots to generate a page where the retrieved content items are presented relative to each other and sized based on their associated slots. When associating a content item with a slot the layout engine may associate the content item with a slot configured to present a specific type of content item or to present content items having one or more specified characteristics. Examples of using a page template to present content items are further described in U.S. patent application Ser. No. 13 187 840 filed on Jul. 21 2011 U.S. patent application Ser. No. 13 938 223 filed on Jul. 9 2013 and U.S. patent application Ser. No. 13 938 226 filed on Jul. 9 2013 each of which is hereby incorporated by reference in its entirety.

In some embodiments the layout engine also determines a dominant color associated with images or sections of those images obtained from one or more sources or from the content store . The images may be included in content items or may be individual images. For each pixel in an image or for each of a subset of pixels sampled from the image the layout engine identifies one or more color components and generates a vector associated with a pixel based on the color components. Clusters including one or more of the pixels are generated based on the vectors associated with each pixel and a characteristic vector is generated for each cluster based on the vectors associated with pixels in a cluster. The characteristic vector for a cluster specifies a color associated with the cluster. Based on the characteristic vectors the layout engine selects a set of clusters and determines a centroid based on the characteristic vectors of the clusters in the set. The centroid identifies a dominant color associated with the image. Determination of a dominant color of an image is further described below in conjunction with .

The connection generator monitors interactions between users and content items presented by the digital magazine server . Based on the interactions the connection generator determines connections between various content items connections between users and content items or connections between users of the digital magazine server . For example the connection generator identifies when users of the digital magazine server provide feedback about a content item access a content item share a content item with other users or perform other actions with content items. In some embodiments the connection generator retrieves data describing user interaction with content items from the user s user profile in the user profile store . Alternatively user interactions with content items are communicated to the connection generator when the interactions are received by the digital magazine server . The connection generator may account for temporal information associated with user interactions with content items. For example the connection generator identifies user interactions with a content item within a specified time interval or applies a decay factor to identified user interactions based on times associated with interactions. The connection generator generates a connection between a user and a content item if the user s interactions with the content item satisfy one or more criteria. In one embodiment the connection generator determines one or more weights specifying a strength of the connection between the user and the content item based on user interactions with the content item that satisfy one or more criteria. Generation of connections between a user and a content item is further described in U.S. patent application Ser. No. 13 905 016 filed on May 29 2013 which is hereby incorporated by reference in its entirety.

If multiple content items are connected to a user the connection generator establishes implicit connections between each of the content items connected to the user. In one embodiment the connection generator maintains a user content graph identifying the implicit connections between content items connected to a user. In one embodiment weights associated with connections between a user and content items are used to determine weights associated with various implicit connections between content items. User content graphs for multiple users of the digital magazine server are combined to generate a global content graph describing connections between various content items provided by the digital magazine server based on user interactions with various content items. For example the global content graph is generated by combining user content graphs based on mutual connections between various content items in user content graphs.

In one embodiment the connection generator generates an adjacency matrix from the global content graph or from multiple user content graphs and stores the adjacency matrix in the connection store . The adjacency matrix describes connections between content items. For example the adjacency matrix includes identifiers of content items and weights representing the strength or closeness of connections between content items based on the global content graph. As an example the weights indicate a degree of similarity in subject matter or similarity of other characteristics associated with various content items. In other embodiments the connection store includes various adjacency matrices determined from various user content graphs the adjacency matrices may be analyzed to generate an overall adjacency matrix for content items provided by the digital magazine server . Graph analysis techniques may be applied to the adjacency matrix to rank content items to recommend content items to a user or to otherwise analyze relationships between content items. An example of the adjacency matrix is further described in U.S. patent application Ser. No. 13 905 016 filed on May 29 2013 which is hereby incorporated by reference in its entirety.

In addition to identifying connections between content items the connection generator may also determine a social proximity between users of the digital magazine server based on interactions between users and content items. The digital magazine server determines social proximity or social distance between users using a variety of techniques. For example the digital magazine server analyzes additional users connected to each of two users of the digital magazine server within a social networking system to determine the social proximity of the two users. In another example the digital magazine server determines social proximity between a user and an additional user by analyzing the user s interactions with content items posted by the additional user whether the content items are presented using the digital magazine server or using another social networking system. Additional examples for determining social proximity between users of the digital magazine server are described in U.S. patent application Ser. No. 13 905 016 filed on May 29 2013 which is incorporated by reference in its entirety. In one embodiment the connection generator determines a connection confidence value between a user and an additional user of the digital magazine server based on the user s and the additional user s common interactions with particular content items. The connection confidence value may be a numerical score representing a measure of closeness between the user and the additional user. For example a larger connection confidence value indicates a greater similarity between the user and the additional user. In one embodiment if a user has at least a threshold connection confidence value with another user the digital magazine server stores a connection between the user and the additional user in the connection store .

Using data from the connection store the recommendation engine identifies content items from one or more sources for recommending to a digital magazine server user. Hence the recommendation engine identifies content items potentially relevant to a user. In one embodiment the recommendation engine retrieves data describing interactions between a user and content items from the user s user profile and data describing connections between content items and or connections between users from the connection store . In one embodiment the recommendation engine uses stored information describing content items e.g. topic sections subsections and interactions between users and various content items e.g. views shares saved links topics read or recent activities to identify content items that may be relevant to a digital magazine server user. For example content items having an implicit connection of at least a threshold weight to a content item with which the user interacted are recommended to the user. As another example the recommendation engine presents a user with content items having one or more attributes in common with a content item with which an additional user having a threshold connection confidence score with the user interacted. Recommendations for additional content items may be presented to a user when the user views a content item using the digital magazine may be presented as a notification to the user by the digital magazine server or may be presented to the user through any suitable communication channel.

In one embodiment the recommendation engine applies various filters to content items received from one or more sources or from the content store to efficiently provide a user with recommended content items. For example the recommendation engine analyzes attributes of content items in view of characteristics of a user retrieved from the user s user profile. Examples of attributes of content items include a type e.g. image story link video audio etc. a source from which a content item was received time when a content item was retrieved and subject matter of a content item. Example characteristics of a user include biographic information about the user users connected to the user and interactions between the user and content items. In one embodiment the recommendation engine analyzes attributes of content items in view of a user s characteristics for a specified time period to generate a set of recommended content items. The set of recommended content items may be presented to the user or may be further analyzed based on user characteristics and on content item attributes to generate more refined set of recommended content items. A setting included in a user s user profile may specify a length of time that content items are analyzed before identifying recommended content items to the user allowing a user to balance refinement of recommended content items with time used to identify recommended content items.

The search module receives a search query from a user and retrieves content items from one or more sources based on the search query. For example content items having at least a portion of an attribute matching at least a portion search query are retrieved from one or more sources . The user may specify sources from which content items are received through settings maintained by the user s user profile or by identifying one or more sources in the search query. In one embodiment the search module generates a section of the digital magazine including the content items identified based on the search query as the identified content items have a common attribute of their association with the search query. Presenting identified content items identified from a search query allows a user to more easily identify additional content items at least partially matching the search query when additional content items are provided by sources .

To more efficiently identify content items based on search queries the search module may index content items groups or sections of content items and user profile information. In one embodiment the index includes information about various content items such as author source topic creation data time user interaction information document title or other information capable of uniquely identifying the content item. Search queries are compared to information maintained in the index to identify content items for presentation to a user. The search module may present identified content items based on a ranking. One or more factors associated with the content items may be used to generate the ranking Examples of factors include global popularity of a content item among users of the digital magazine server connections between users interacting with a content item and the user providing the search query and information from a source . Additionally the search module may assign a weight to the index information associated with each content item selected based on similarity between the index information and a search query and rank the content items based on their weights. For example content items identified based on a search query are presented in a section of the digital magazine in an order based in part on the ranking of the content items.

To increase user interaction with the digital magazine the interface generator maintains instructions associating received input with actions performed by the digital magazine server or by a digital magazine application executing on a client device . For example instructions maintained by the interface generator associate types of inputs or specific inputs received via an input device of a client device with modifications to content presented by a digital magazine. As an example if the input device is a touch sensitive display the interface generator includes instructions associating different gestures with navigation through content items or presented via a digital magazine. Instructions from the interface generator are communicated to a digital magazine application or other application executing on a client device on which content from the digital magazine server is presented. Inputs received via an input device of the client device are processed based on the instructions when content items are presented via the digital magazine server is presented to simplify user interaction with content presented by the digital magazine server .

The web server links the digital magazine server via the network to the one or more client devices as well as to the one or more sources . The web server serves web pages as well as other content such as JAVA FLASH JSON XML and so forth. The web server may retrieve content item from one or more sources . Additionally the web server communicates instructions for generating pages of content items from the layout engine and instructions for processing received input from the interface generator to a client device for presentation to a user. The web server also receives requests for content or other information from a client device and communicates the request or information to components of the digital magazine server to perform corresponding actions. Additionally the web server may provide application programming interface API functionality to send data directly to native client device operating systems such as IOS ANDROID WEBOS or BlackberryOS.

For purposes of illustration describes various functionalities provided by the digital magazine server . However in other embodiments the above described functionality may be provided by a digital magazine application executing on a client device or may be provided by a combination of the digital magazine server and a digital magazine application executing on a client device . In one embodiment the digital magazine server determines a dominant color in an image of a content item based on color components of pixels in the image. For example the layout engine determines a dominant color in an image based on clusters of pixels in the image determined from color components of pixels in the image. In another embodiment a digital magazine application executing on the client device determines a dominant color in an image of a content item based on color components of pixels in the image. Alternatively the digital magazine server and the client device operate in conjunction with each other to determine a dominant color in an image of a content item based on color components of pixels in the image. For example certain functionality e.g. determining the dominant color is performed by the digital magazine server while other functionality e.g. presenting an image modified based on the dominant color is performed by a digital magazine application executing on the client device .

In the example of when a digital magazine server generates a page for presentation to a user the digital magazine server populates slots in a page template with content items. Information identifying the page template and associations between content items and slots in the page template is stored and used to generate the page. For example to present a page to a user the layout engine identifies the page template from the template store and retrieves content items from one or more sources or from the content store . The layout engine generates data or instructions associating content items with slots within the page template . Hence the generated page includes various content regions presenting one or more content items associated with a slot in a location specified by the slot.

A content region may present image data text data a combination of image and text data or any other information retrieved from a corresponding content item. For example in the content region A represents a table of contents identifying sections of a digital magazine and content associated with the various sections are presented in content regions B H. For example content region A includes text or other data indicating that the presented data is a table of contents such the text Cover Stories Featuring followed by one or more identifiers associated with various sections of the digital magazine. In one embodiment an identifier associated with a section describes a characteristic common to at least a threshold number of content items in the section. For example an identifier refers to the name of a user of social network from which content items included in the section are received. As another example an identifier associated with a section specifies a topic an author a publisher e.g. a newspaper a magazine or other characteristic associated with at least a threshold number of content items in the section. Additionally an identifier associated with a section may further specify content items selected by a user of the digital magazine server and organized as a section. Content items included in a section may be related topically and include text and or images related to the topic.

Sections may be further organized into subsections with content items associated with one or more subsections presented in content regions. Information describing sections or subsections such as a characteristic common to content items in a section or subsection may be stored in the content store and associated with a user profile to simplify generation of a section or subsection for the user. A page template associated with a subsection may be identified and slots in the page template associated with the subsection used to determine presentation of content items from the subsection relative to each other. Referring to the content region H includes a content item associated with a newspaper to indicate a section including content items retrieved from the newspaper. When a user interacts with the content region a page template associated with the section is retrieved as well as content items associated with the section. Based on the page template associated with the section and the content items the digital magazine server generates a page presenting the content items based on the layout described by the slots of the page template. For example in the section page includes content regions presenting content items associated with the section. The content regions may include content items associated with various subsections including content items having one or more common characteristics e.g. topics authors etc. . Hence a subsection may include one or more subsections allowing hierarchical organization and presentation of content items by a digital magazine.

The digital magazine server obtains an image or a section of the image e.g. for text overlays over the section of the image including a set of pixels. For example the image is obtained for presentation to a user of the digital magazine server for presentation to a user where the image includes a set of pixels. The image may be obtained from a source from another user of the digital magazine server or from the digital magazine server . A color model is used to represent the image. Example color models include red green blue RGB cyan magenta yellow black CMYK CIE XYZ HSV HSL or any other suitable mathematical model representing color. Based on the color model representing the image each pixel in the image is represented by a number of color components each specifying a color and a color value identifying an intensity associated with the specified color. For example in an image represented using the RGB color model each pixel is associated with three color components having color values representing intensity of red green and blue colors. As another example in an image represented using the CMYK color model each pixel is associated with four color components having color values representing intensity of cyan magenta yellow and black colors.

One or more color components associated with each pixel in the set of pixels of the image or each pixel in a subset of the set of pixels determined by sampling of the set of pixels of the image e.g. determined by sampling every N pixels from the set of pixels for computational efficiency or by pseudorandomly sampling pixels from the set of pixels are identified by the digital magazine server . As described above the color components are determined based on a color model used to represent the image. For example one or more color components specified by a color model associated with the image and their associated color values for various pixels of the image are identified by the digital magazine server . The one or more color components and their color values may be extracted from the image may be identified based on data associated with the image by the digital magazine server or may be identified based on additional information retrieved with the image. For example information identifying color components associated with the image is separately obtained from a source associated with the image which may allow the source to customize or modify the color components identified from the image. For example information obtained in addition to the image identifies color components to exclude from identification . In some embodiments color components having at least a threshold color value are identified while color components with less than the threshold color value are not identified .

Based at least in part on the one or more color components associated with each pixel the digital magazine server generates a vector for each pixel. Thus a vector associated with a pixel is determined based on a vector space having a number of dimensions defined by a number of the identified color components. The vector associated with a pixel is then based on coordinates in the vector space corresponding to color values of identified color components corresponding to each dimension in the vector space. In one embodiment when generating the vector associated with a pixel the digital magazine server normalizes the color components associated with the pixel. The digital magazine server may account for color components or one or more additional pixels within a threshold distance of a pixel when generating the vector for the pixel. For example identified color components associated with pixels adjacent to a pixel are used when determining the vector associated with the pixel or color components associated with additional pixels within a threshold number of pixels from the pixel are used when generating the vector associated with the pixel. Identified color components associated with the pixel and with additional pixels within the threshold distance of the pixel may be differently weighted when generating the vector associated with the pixel. For example one or more weights are associated with color components of a pixel and additional weights are associated with one or more color components of additional pixels within a threshold distance of the pixels. An additional weight associated with one or more color components of additional pixel may be based on a distance between the additional pixel and the pixel. For example an additional weight associated with one or more color components of an additional pixel is inversely proportional to a distance between the additional pixel and the pixel. The vector for the pixel may be generated by combining the one or more color components of the pixel and of the additional pixels using the weights and the additional weights.

Based on the vectors associated with various pixels the digital magazine server generates one or more clusters each including one or more pixels. In one embodiment K means clustering is used to generate the one or more clusters of pixels based on the generated vectors representing the various pixels. K means clustering determines whether a pixel is included in a cluster based on the distance between a vector associated with the pixel and a mean value associated with the cluster. For example a pixel associated with a vector having less than a threshold distance between the vector and a mean value associated with the cluster is included in the cluster. A cluster may also be associated with a threshold number of pixels associated with the cluster a threshold magnitude i.e. a sum of magnitudes of vectors associated with pixels included in the cluster is less than or equal to the threshold magnitude a threshold distance from a mean value of the cluster or any combination thereof. In other embodiments alternative clustering methods may be used to generate the clusters. Examples of alternative clustering methods include a balanced iterative reducing and clustering using hierarchies BIRCH method a hierarchical method an expectation maximization EM method a density based spatial clustering of applications with noise DBSCAN method an ordering points to identify the clustering structure OPTICS method and a mean shift clustering method.

The digital magazine server generates characteristic vectors for each cluster based at least in part on the generated vectors. A characteristic vector for a cluster is based at least in part on the vectors associated with the one or more pixels included in the cluster and represents a color associated with the cluster determined from dimensions of the characteristic vector. The characteristic vector for a cluster may be based on combinations of one or more dimensions of the generated vectors. For example a dimension of the characteristic vector of a cluster is a combination of one or more of the corresponding dimensions of the generated vectors of the cluster. The combination may be a sum or a weighted sum of the one or more corresponding dimensions of the vectors associated with pixels included in the cluster.

Based at least in part on the characteristic vectors associated with various clusters the digital magazine server selects a set of the clusters. In one embodiment the one or more clusters are be ranked based on their associated characteristic vectors and clusters having at least a threshold position in the ranking are selected as the set. Alternatively clusters having a characteristic vector with at least a threshold magnitude are selected as the set. Alternatively a score is generated for each cluster based on a magnitude of a cluster s characteristic vector a dimension of the cluster s characteristic vector a number of pixels in the cluster or any combination thereof. For example a score of a cluster having a greater number of pixels and a lower magnitude than an additional cluster is higher than the score of the additional cluster. The digital magazine server selects clusters having at least a threshold score for the set or ranks clusters based on their scores and selects clusters having at least a threshold position in the ranking for the set.

The digital magazine server determines a centroid based on the characteristic vectors of each cluster in the selected set of clusters. The centroid identifies a dominant color associated with the image. For example different dimensions of the characteristic vectors may be differently weighted so the centroid is determined based on values of the characteristic vectors of clusters in the dimensions along with weights associated with the dimensions. In some embodiments if a magnitude of a characteristic vector has greater than a threshold difference from magnitudes of at least a threshold number of additional characteristic vectors the characteristic vector is excluded or attenuated when determining the centroid. In an alternative embodiment the digital magazine server selects a cluster based at least in part on the characteristic vector of the cluster and determines the dominant color associated with the image based on the characteristic vector of the selected cluster. For example the digital magazine server selects a cluster from the set of clusters including a maximum number of pixels and identifies the characteristic vector of the selected color as identifying the dominant color associated with the image

The digital magazine server stores information associating the dominant color with the image. The information may identify the dominant color regions of the image including the dominant color or any combination thereof. For example the information may also include a location within the image having a maximum number of adjacent pixels each associated with colors matching or similar to the dominant color. Based on the information the digital magazine server may modify the image. For example the digital magazine server selects additional content for inclusion in the image based at least in part on the dominant color. As an example the digital magazine server selects a color for text to overlay on the image based at least in part on the dominant color. A color for the text contrasting with the dominant color may be selected by the digital magazine server . Various elements may be selected for inclusion in the image based on the dominant color. Example elements include borders text and additional images. The digital magazine server may also select additional content items to present to the user along with the image based at least in part on the dominant color associated with the image. For example the digital magazine server selects additional content items including images with different or similar dominant colors to present color varying content items or content items with similar colors.

The foregoing description of the embodiments of the invention has been presented for the purpose of illustration it is not intended to be exhaustive or to limit the invention to the precise forms disclosed. Persons skilled in the relevant art can appreciate that many modifications and variations are possible in light of the above disclosure.

Some portions of this description describe the embodiments of the invention in terms of algorithms and symbolic representations of operations on information. These algorithmic descriptions and representations are commonly used by those skilled in the data processing arts to convey the substance of their work effectively to others skilled in the art. These operations while described functionally computationally or logically are understood to be implemented by computer programs or equivalent electrical circuits microcode or the like. Furthermore it has also proven convenient at times to refer to these arrangements of operations as modules without loss of generality. The described operations and their associated modules may be embodied in software firmware hardware or any combinations thereof.

Any of the steps operations or processes described herein may be performed or implemented with one or more hardware or software modules alone or in combination with other devices. In one embodiment a software module is implemented with a computer program product comprising a computer readable medium containing computer program code which can be executed by a computer processor for performing any or all of the steps operations or processes described.

Embodiments of the invention may also relate to an apparatus for performing the operations herein. This apparatus may be specially constructed for the required purposes and or it may comprise a general purpose computing device selectively activated or reconfigured by a computer program stored in the computer. Such a computer program may be stored in a non transitory tangible computer readable storage medium or any type of media suitable for storing electronic instructions which may be coupled to a computer system bus. Furthermore any computing systems referred to in the specification may include a single processor or may be architectures employing multiple processor designs for increased computing capability.

Embodiments of the invention may also relate to a product that is produced by a computing process described herein. Such a product may comprise information resulting from a computing process where the information is stored on a non transitory tangible computer readable storage medium and may include any embodiment of a computer program product or other data combination described herein.

Finally the language used in the specification has been principally selected for readability and instructional purposes and it may not have been selected to delineate or circumscribe the inventive subject matter. It is therefore intended that the scope of the invention be limited not by this detailed description but rather by any claims that issue on an application based hereon. Accordingly the disclosure of the embodiments of the invention is intended to be illustrative but not limiting of the scope of the invention which is set forth in the following claims.

