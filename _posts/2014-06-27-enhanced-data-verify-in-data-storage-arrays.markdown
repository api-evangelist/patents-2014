---

title: Enhanced data verify in data storage arrays
abstract: To provide enhanced operation of data storage devices and systems, various systems, methods, and software are provided herein. In a first example, a data storage system is configured to provide at least a portion of a first data storage device as a verification cache for a storage region of a second data storage device, write data for storage in the verification cache of the first data storage device and write the data for storage in the storage region of the second data storage device. The data storage system is configured to perform a verification process on the data written to the storage region after a verification trigger condition has been met. The data storage system is configured to transfer portions of the data that fail to pass the verification process from the verification cache to supersede the one or more parts of the data in the storage region.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09367254&OS=09367254&RS=09367254
owner: HGST Netherlands B.V.
number: 09367254
owner_city: Amsterdam
owner_country: NL
publication_date: 20140627
---
Computer and network systems such as personal computers workstations server systems and cloud storage systems typically include data storage systems for storing and retrieving data. These data storage systems can include data storage devices such as hard disk drives solid state storage devices tape storage devices and other mass storage devices.

The data storage devices can be arranged in arrays to form the data storage systems such as redundant configurations or striped configurations to enhance reliability speed or availability characteristics of the individual storage devices. These arrays can include one or more data storage devices such as hard disk drives HDDs that are managed by a controller or software process. Some examples of arrayed storage configurations include Redundant Array of Independent Disk RAID arrays mirrored configurations and spanning configurations.

In addition to arrayed storage configurations storage systems can also include archival storage configurations. These archival configurations can include cold storage configurations which attempt to maximize storage space of data storage devices by writing some data to higher density storage. This cold storage data can include data less frequently used than other data or data that is desired to be saved for long term storage. However the cold storage of data can experience reduced storage throughput.

To provide enhanced operation of data storage devices and systems various systems methods and firmware are provided herein. In a first example a data storage system is presented. The data storage system includes a communication interface configured to receive data for storage in a data storage array comprising a plurality of data storage devices. The data storage system also includes a processing system configured to identify at least a portion of a first data storage device as a verification cache for a storage region of a second data storage device write the data for storage in the verification cache of the first data storage device and write the data for storage in the storage region of the second data storage device. The processing system is configured to perform a verification process on at least the data written to the storage region of the second data storage device after a verification trigger condition has been met and identify one or more parts of the data in the storage region of the second data storage device that fail to pass the verification process. Responsive to the one or more parts of the data that fail to pass the verification process the processing system is configured to transfer the one or more parts of the data from the verification cache of the first data storage device to supersede the one or more parts of the data in the storage region of the second data storage device.

In another example a method of operating a data storage system is presented. The method includes receiving data for storage in a data storage array comprising a plurality of data storage devices identifying at least a portion of a first data storage device as a verification cache for a storage region of a second data storage device writing the data for storage in the verification cache of the first data storage device and writing the data for storage in the storage region of the second data storage device. The method also includes performing a verification process on at least the data written to the storage region of the second data storage device after a verification trigger condition has been met and identifying one or more parts of the data in the storage region of the second data storage device that fail to pass the verification process. Responsive to the one or more parts of the data that fail to pass the verification process the method includes transferring the one or more parts of the data from the verification cache of the first data storage device to supersede the one or more parts of the data in the storage region of the second data storage device.

In another example a data storage system is presented. The data storage system includes a storage application configured to receive data for storage in a cold storage file system the cold storage file system comprising one or more data storage devices presented as a virtual storage device that spans the one or more data storage devices. The data storage system also includes a storage mapper configured to establish a storage map data structure that maps a first region in a first data storage device as a verification cache for a cold storage region of a second data storage device and maps a second region of the second data storage device as a verification cache for a cold storage region of the first data storage device. Responsive to receiving the data the storage mapper is configured to select the cold storage region of the second data storage device for storage of the data transfer the data for caching in the verification cache of the first data storage device and transfer the data for storage in the cold storage region of the second data storage device. After at least further data is stored in the cold storage region of the second data storage device the storage mapper is configured to perform a verification process on at least the data written to the cold storage region of the second data storage device and identify one or more parts of the data in the cold storage region of the second data storage device that fail to pass the verification process. Responsive to the one or more parts of the data that fail to pass the verification process the storage mapper is configured to transfer the one or more parts of the data from the verification cache of the first data storage device to supersede the one or more parts of the data in the cold storage region of the second data storage device.

In this example data storage system includes at least two data storage devices namely data storage devices . Data storage system can abstract the individual storage devices and present the data storage devices as a single storage space such as virtual storage drive that spans more than one data storage device. Data storage system can also include any number of communication interfaces for receiving file or object transactions over storage link . These interfaces can include network interfaces storage interfaces packet interfaces or other communication links including combinations thereof.

Each storage device includes associated storage media . which are subdivided into associated cache regions and storage regions. The cache regions and storage regions of each particular storage device reside on the same storage media of the storage device in this example such as a rotating magnetic storage media of a HDD. Other storage media can be employed in storage devices and the cache regions can be included in other storage media such as separate solid state storage media or separate rotating magnetic storage media. Other combinations of storage media can be employed.

In operation data storage system receives data for storage on storage media associated with data storage system such as responsive to write operations received over storage link . These write operations can include data to be stored by data storage system . Read operations can also be handled by data storage system such as by retrieving data already stored in any of storage devices and return of the requested data over storage link . Other file operations or object operations can be handled by data storage system such as delete operations rename operations copy operations metadata operations and the like.

To further illustrate the operation of data system is provided. is a flow diagram illustrating a method of operating data storage system . The operations of are referenced below parenthetically. In data storage system receives data for storage in a data storage array comprising a plurality of data storage devices. The data is received over storage link and in this example comprises write data . Write data can accompany a write transaction which can include a write command write operations modify operations or other file or object transactions.

Data storage system include storage mapper . Storage mapper identifies at least a portion of a first data storage device as a verification cache for a storage region of a second data storage device. In this example storage mapper identifies the cache region of storage device as a verification cache for the storage region of storage device . Storage mapper can maintain a data structure that indicates which regions of the various storage devices are employed for cache regions and storage regions. Storage mapper can also include a logical block record that indicates where in each respective storage device particular data is stored such as a table that indicates storage locations on storage media for each file or object stored in data storage system . Responsive to receiving write data storage mapper can update the associated data structures to indicate where write data is stored among the various storage media of data storage system . File or object allocation information can instead be stored in data structures maintained by other elements of data storage system such as file systems.

Storage mapper writes the data for storage in the verification cache of the first data storage device and write the data for storage in the storage region of the second data storage device. In this example storage mapper writes write data into both the cache region of storage device and the storage region of storage media as indicated by the 140 indicators in . Typically a verification process is performed responsive to writing data to storage media. This verification process can include a Forward Error Correction FEC process or checking an error correcting code ECC of the data among other verification processes. However in this example responsive to writing data data storage system does not perform a verification process on data and instead waits for a verification trigger condition.

Data storage system performs a verification process on at least data written to the storage region of storage device after a verification trigger condition has been met. The verification trigger condition can include various factors. In a first example the verification trigger condition is met when further data is written to the storage region of storage device . In another example the verification trigger condition is met when further data is written to an adjacent storage location as data in the storage region of storage device . This further data can include write data which is received after write data and written to the storage area of storage device after write data . In other examples the verification trigger can include filling a sub region of the storage region of storage device . The sub region can be a storage band among a plurality of storage bands that the storage region of storage device is sub divided into. Data can be written into a particular storage band without verification and once the storage band has filled with data then the verification process can be performed on the entire storage band. In other examples data is written to a series of adjacent tracks on a rotating magnetic media. In examples of adjacent tracks once first data is written to a first track then verification for the first data occurs only after second data is written to a second track adjacent to the first track. Other verification trigger conditions can be employed such as those discussed below regarding .

Data storage device identifies one or more parts of data in the storage region of storage device that fail to pass the verification process. Failure to pass the verification process can include error checking failures failure to correct single bit errors any bit errors found or other data verification errors for data that has been stored in the storage region of storage device . In some examples no verification errors are found and operation can be omitted.

Responsive to identifying one or more parts of data that fail to pass the verification process data storage system transfers the one or more parts of data from the verification cache of storage device to supersede the one or more parts of data in the storage region of storage device . The verification cache of storage device is included in the cache region of storage device and is used in this example to hold data until data has been verified in the storage region of storage device . Verification of data in the verification cache of storage device can occur normally but verification is not required for data in the verification cache of storage device .

Since data does not get verified immediately after writing data on storage media errors might have occurred during the storage of data . Also if further data such as write data is stored to storage media after data portions of data might get corrupted by the write process for data . This corruption can occur when data is stored in the storage region of storage device in a tight or closely spaced manner or if data is written to adjacent storage locations to data . A closely spaced storage configuration can include a shingled magnetic recording SMR arrangement with subsequent tracks of data stored in a tight and overlapping arrangement to increase storage density.

Responsive to detecting errors in data as stored in the storage region of storage device the erroneous portions of data can be replaced or superseded by associated portions held in the verification cache of storage device . In some examples the superseding portions of data are transferred to storage device to overwrite data in storage device . In other examples existing portions of data in the storage portion of storage device which experience errors are marked as deleted and the replacement portions of data transferred from the verification cache of storage device are appended to the storage region of storage device . This appending of replacement data can occur at a tail or current storage location of the storage region of storage device .

A further example of data storage systems are included in . is a system diagram illustrating data system . Data system includes storage control system communication interface drive interface system and HDDs and . only includes two HDDs for clarity but it should be understood that a greater number of HDDs can be included with the operations discussed below applied across more than two HDDs or other storage drive types.

Communication interface and storage control system communicate over link which comprises a network link in this example such as Ethernet Internet Protocol or other communication links. Storage control system and drive interface system communicate over link which can include one or more links such as network links storage interface links chip interconnect Peripheral Component Interconnect PCI PCI express PCIe or other communication links. Drive interface system and HDD communicate over storage link . Drive interface system and HDD communicate over storage link . Storage links and can each comprises any storage or disk interface such as Serial Attached ATA SATA Serial Attached SCSI SAS Fibre Channel Universal Serial Bus USB SCSI or other storage or peripheral interfaces including variations and combinations thereof. Network link can interface with one or more networks such as packet networks the Internet or other data and packet networks including combinations thereof.

In operation data system comprises a data storage system for storing user data in one or more storage media for archival and later retrieval. Data files or data objects can be received over network link by communication interface . These data files or data objects can be transferred by end user devices such as servers software processes computing systems portable devices and the like. Data files or data objects can be stored on any of HDD and .

The data storage elements of can comprise a cold storage data system for handling storage within a cold storage file system CSFS . The CSFS can include a user interface that allows user devices and user software applications to interact with the CSFS. The elements of can illustrate storage elements for a Network File System NFS or Distributed File System DFS in other examples.

Storage control system can include further communication interfaces network interfaces processing systems computer systems microprocessors storage systems storage media or some other processing devices or software systems and can be distributed among multiple devices. Examples of storage control system can include software such as an operating system logs databases data structures utilities drivers networking software and other software stored on a computer readable medium. Communication interface can include network interfaces network interface cards transceivers wired optical or wireless communication equipment among other equipment. Drive interface system includes one or more integrated circuits microprocessors microcontrollers transceivers communication link interface equipment and circuitry connectors and other equipment. In some examples any of communication interface and drive interface system are integrated into storage control system . HDD and are rotating magnetic storage drives. Each of HDD and includes one or more storage media represented by associated platter and . Each of HDD and includes at least one associated read write R W head and for reading and writing data to the magnetic media of the respective HDD. HDD and can also each include processors interface equipment memory firmware preamps amplifiers signal processors armatures heads enclosures and other circuitry and equipment.

The CSFS can be presented by application and file system to a user over link and communication interface . The storage of data system can be presented as a virtual drive to an end user where the virtual drive can abstract any number of physical storage drives or storage spaces and present a user with a single volume of storage which is accessible over link . Write read delete modify and other data file or data object operations can be initiated by end users and handled by storage control system .

In a first example file operation communication interface receives write data for cold storage by data system . This write data is shown as composed of many blocks of data in which represent a plurality of bytes of data. The amount of data included in write data can vary and the example shown in has six groups of data. Communication interface transfers the received write data also with any associated write commands or write operation information to application .

Application can include any user interface or software interface that a user device or external data system can interface with to instruct data system to perform the various storage operations. Application can include a web interface application programming interface API software application operating system user application or other software including combinations and variations thereof. In many examples application is presented to a user device or external system through communication interface and link . For example application can be a user interface or API while communication interface can be a network stack used for exchanging data packets with user devices or external systems over link .

Application can communicate with file system to perform data file or data object operations such as those mentioned above. File system can be a CSFS a network file system NFS or a distributed file system DFS among other file systems including combinations thereof. The file system can track data file or data object allocations so an operating system application or other user level software process can access data stored by any of HDD or .

File system communicates with data mapper to actually store data onto various storage devices such as HDD or . Data mapper determines which HDD to use for data storage for each data piece such as for a particular file or object transaction. Data mapper can perform load balancing analysis to identify one of HDD and on which to write data. This load balancing can include round robin load balancing to alternatively select different HDDs for each transaction. This load balancing can include monitoring a busy or idle state of the HDDs and distribute the write transaction to a HDD which is not in a busy state or which is in an idle state. The busy state can include a HDD presently writing reading or verifying data while the idle state can include a HDD not presently writing reading or verifying data. In further examples the load balancing includes monitoring a current position of a read write head or read head of a HDD and processing the current head position against a desired write or read location to prevent unwanted head seek and tracking operations and delays.

In data mapper maps write data to a cache band of a first HDD and to a cold storage band of a second HDD. The mapping can include determining physical locations on each HDD for writing of data or can include logical address mapping for data on each HDD.

As seen in the storage media for each HDD is divided into at least two regions. A first region includes cache bands and a second region includes cold storage bands. A band includes one or more tracks of a particular HDD. For example a platter of HDD includes a plurality of circular tracks for storing data on the magnetic media of HDD . These tracks subdivide the physical media into sub portions which are addressable for data storage by a system which interfaces with HDD . The tracks of HDD are grouped into bands and HDD can include any number of bands which include any number of tracks. Each band is composed of a sequential storage space on the physical media such as a sequential number of tracks. The cache bands are positioned on outer edges of the respective platters while the cold storage bands are positioned on inner edges of the respective platters. The cache bands are larger diameter tracks than the cold storage bands. Typically tracks near the outside edge of a platter move with a faster angular speed with respect to a write or read head than tracks near the inside edge. HDD includes a similar configuration as mentioned above for HDD .

Thus for HDD cache bands are positioned near an outer edge of platter while cold storage bands are positioned near an inner edge of platter . For HDD cache bands are positioned near an outer edge of platter while cold storage bands are positioned near an inner edge of platter . Although only two cache bands and two storage bands are illustrated for each of HDD and it should be understood than any number of bands can be included. Also the cold storage bands of a HDD can be designated as user space or a user region of the HDD which is accessible as addressable storage space for an end user or external system which reads and writes data to the storage space provided by storage control system . Also the cache bands of a HDD can be designated as vendor space or vendor regions of the HDD which are not accessible as addressable storage space for an end user. This vendor regions can be hidden from a user accessible file system such as the CSFS discussed herein.

The cache bands of HDD are employed as a verification cache for the cold storage bands of HDD . Likewise the cache bands of HDD are employed as a verification cache for the cold storage bands of HDD . Although two HDDs are employed in it should be understood that the cache bands and cold storage bands can be employed on more than two HDDs and a single verification cache can be employed for the cold storage areas of more than one HDD. Likewise although HDDs are shown in the examples herein can be applied to any data storage device including solid state storage devices optical storage devices phase change storage devices and other types of magnetic storage devices including magnetic random access memory MRAM .

When write data is received such as write data data mapper maps data into a verification cache and into a cold storage area. Once data mapper determines onto which HDD data is to be cached and stored then this data is concurrently written A B onto the respective HDDs. As seen in write data is transferred by storage control system for storage in band of HDD and for storage in band of HDD . Band is a cold storage band in this example while band is a cache band in this example. The transfer of write data to both HDD and HDD can be concurrent or can be sequential however data is stored in different locations on separate HDDs.

After data has been written to the cold storage region of HDD a verification process is not performed until a verification trigger condition occurs. Typically when data is written to a HDD the data is verified such as by performing an ECC check on the data just written. However when a rotating magnetic medium is employed such as in HDD a read write head first writes the data to the magnetic medium and then a read head reads the just written data to perform the verification process. This write read verify process can take considerable time especially when the read write head that just completed writing data is in an undesirable angular position after the write process. The read process using a read head might require a full or partial rotation of the rotating storage medium before a verify process can occur which disrupts write operation of the associated HDD. When many writes are desired to occur in a short amount of time such as in burst writing this verify process can be disruptive. Also when cold storage techniques employ tight track spacing such as SMR repositioning a read write head after every write can lead to slow performance and difficulty in head positioning.

In some examples the verification trigger can be an activity level of the HDD that is employed for cold storage. For example when HDD is writing data into cold storage bands an activity level can be considered as busy and a verification process is not performed even if several unrelated write transactions are handled by HDD . Once HDD enters an idle mode such as when not performing any writes to the cold storage bands of HDD then a verification process can occur for any data that has not yet been verified.

However in this example the verification trigger condition includes further data written to an adjacent band as data . For example data can be received by communication interface for storage by data system . As with data data can be mapped to any of HDD and for cold storage and verification caching. Assuming in this example that data is written to a cold storage band which is adjacent to the cold storage band that data was written to then the verification trigger condition can be met. Specifically data is shown as written to band while data is written to band which is adjacent to band . Although band is shown as an inward band from band other configurations are possible.

In SMR arrangements adjacent data tracks are tightly spaced and many times written in a track sequential manner to provide for some overlap in the write process. For example a first track can be written with first data and then a second track inward of the first track can be written with second data. These two SMR tracks can be spaced closer than other writing arrangements such as perpendicular magnetic recording PMR arrangements and thus a higher capacity of a storage medium can be achieved. However the writing of subsequent data to a track that is closely spaced to a previously written track might cause corruption in the data previously stored. Thus in this example writing of data to an adjacent band can trigger the verification process. Although storage bands are employed in this example which may have many tracks similar processes can be applied to track by track verification.

Storage control system burst verifies data in cold storage band after writing of data into band of HDD . The verify process can include reading data from band and performing a verification process on the data to ensure data integrity. The verification process can include an ECC process a checksum process a forward error correction FEC process among other data integrity checks and processes.

In this example a part of data is shown to fail the verification process. Specifically data B is shown to have an error during the verification process such as a bit error or multi bit error. Responsively storage control system retrieves the part of data that failed the verify process from the verification cache and re writes this data part to the cold storage area of HDD to replace the data with the error. In this example data A is read from cache band of HDD and transferred for storage in HDD to replace data B.

The replacement process can be handled in various ways. In a first example data A is overwritten directly to the location where data B is located. In a second example a file allocation table or other data structure in storage control system that tracks where on HDD that data is stored is updated with a new storage location and data A is written to that new storage location. The new storage location can be a present location of R W head or can be to a tail end of any cold storage bands or tracks that are presently used for storing data. For example when data is written in a burst manner into cold storage bands of HDD then any replacement data is written to the present burst location which can include a different cold storage band than that of the rest of data . In further examples the replacement of data B by data A is delayed until another write is to be performed in cold storage bands of HDD which is prompted by incoming data received over link .

Once the verification process has completed and data has been verified in the cold storage bands then any corresponding data held in the verification cache can be purged such as by deleting the verified data from the verification cache. Data that is re written into a cold storage band to replace data that experienced errors can be re verified at a later time such as during a subsequent verification process. Data that has yet to be verified can remain in the verification cache.

Thus the cache bands of HDD are used as a verification cache for data written to the cold storage area of HDD . HDD can burst many writes to the cold storage bands without any verification of the data written during the burst writing. Meanwhile the same data that is being written to the cold storage areas of HDD is also being cached in the verification cache of HDD . The verification cache is used when a subsequent verification process for data written to HDD fails or has errors detected therein. Likewise the cache bands of HDD can be employed as a verification cache for cold storage bands of HDD in a reciprocal manner. When further HDDs are employed then different arrangements and distributions of verification caches and cold storage areas can be employed. For example a single verification cache can be employed for cold storage areas of two or more HDDs.

The cache bands of each HDD are also typically located on the outermost tracks of an associated HDD. The outermost tracks are typically faster for data storage due to the geometric relationship of a circular platter with an associated R W head. Also the cache bands might not employ a high density storage arrangement such as SMR and instead might employ a perpendicular magnetic recording PMR arrangement. The PMR arrangement can be more reliable than the SMR arrangement due to less stringent spacing of adjacent tracks.

As a further example of a storage control system is presented. include storage control system which can be an example of storage control system communication interface and drive interface system of or can be an example of elements of data storage system of .

Storage control system includes communication interface storage interface processing system and memory . The elements of storage control system communicate over bus although discrete links can instead be employed. Storage control system can be distributed or consolidated among equipment or circuitry that together forms the elements of storage control system . Storage control system can optionally include additional devices features or functionality not discussed here for purposes of brevity.

Communication interface includes one or more network interfaces for communicating over communication networks such as the IP networks or packet networks discussed herein. The network interfaces can include an Ethernet interface IP interface or other local or wide area network communication interfaces which can communicate over a communication link. Examples of communication interface include network interface card equipment transceivers modems and other communication circuitry. In this example communication interface communicates over network link . Network link can include any communication network links as described herein.

Storage interface includes one or more storage interfaces for communicating with storage drives such as hard disk drives flash drives phase change memory drives and the like. Storage interface can comprise transceivers interface circuitry connectors buffers microcontrollers and other interface equipment. Storage link can comprise any number of wired optical or wireless storage or disk links such as Serial Attached ATA SATA Serial Attached SCSI SAS Fibre Channel Infiniband Universal Serial Bus USB SCSI Ethernet IP or other storage or peripheral interfaces including variations and combinations thereof.

Processing system includes processor and memory . Processor can comprise one or more microprocessors and other circuitry that retrieves and executes software from memory . Processing system can be implemented within a single processing device but can also be distributed across multiple processing devices or sub systems that cooperate in executing program instructions. Examples of processing system include general purpose central processing units application specific processors and logic devices as well as any other type of processing device combinations or variations thereof.

Memory can comprise any non transitory computer readable storage media readable by processing system and capable of storing software . Memory can include volatile and nonvolatile removable and non removable media implemented in any method or technology for storage of information such as computer readable instructions data structures program modules or other data. In addition to storage media in some implementations memory can also include communication media over which software can be communicated. Memory can be implemented as a single storage device but can also be implemented across multiple storage devices or sub systems co located or distributed relative to each other. Memory can comprise additional elements such as a controller capable of communicating with processing system . Examples of storage media include random access memory read only memory magnetic disks optical disks flash memory virtual memory and non virtual memory magnetic cassettes magnetic tape magnetic disk storage or other magnetic storage devices or any other medium which can be used to store the desired information and that can be accessed by an instruction execution system as well as any combination or variation thereof or any other type of storage media.

Software can be implemented in program instructions and among other functions can when executed by storage control system in general or processing system in particular direct storage control system or processing system to operate as described herein. Software can include additional processes programs or components such as operating system software database software or application software. Software can also comprise firmware or some other form of machine readable processing instructions executable by processing system .

In at least one implementation the program instructions can include first program instructions that direct processing system to receive data for storage in a data storage array comprising a plurality of data storage devices identify at least a portion of a first data storage device as a verification cache for a storage region of a second data storage device write the data for storage in the verification cache of the first data storage device write the data for storage in the storage region of the second data storage device perform a verification process on at least the data written to the storage region of the second data storage device after a verification trigger condition has been met and identify one or more parts of the data in the storage region of the second data storage device that fail to pass the verification process. Responsive to the one or more parts of the data that fail to pass the verification process the program instructions can direct processing system to transfer the one or more parts of the data from the verification cache of the first data storage device to supersede the one or more parts of the data in the storage region of the second data storage device among other operations.

In another example implementation the program instructions can include storage application module file system module and storage mapper module are included in software such as shown in that direct processing system to operate accordingly. Application module can provide a user application or application programming interface to external systems which can access the storage spaces controlled by storage control system . External system or user devices can write data read data among other file or object operations through an application or API presented by application module . Application module can also receive these file or object operations and transfer to file system module . File system module can provide a file system arrangement for storage devices managed by storage control system such as a Cold Storage File System NFS or DFS as discussed herein. File system module can present any number of discrete storage devices or storage drives as a virtual single volume to application module such as when a file system spans multiple hard drives. File system module can maintain one or more data structures such as tables databases hash tables heaps and the like which can relate storage locations on individual storage devices to files and objects. Storage mapper module handles distributing write data across various storage drives using verification caches and cold storage regions as discussed herein. Storage mapper module can perform load balancing operations to distribute the write data across any number of storage devices.

In general software can when loaded into processing system and executed transform processing system overall from a general purpose computing system into a special purpose computing system customized to operate as described herein. Encoding software on memory can transform the physical structure of memory . The specific transformation of the physical structure can depend on various factors in different implementations of this description. Examples of such factors can include but are not limited to the technology used to implement the storage media of memory and whether the computer storage media are characterized as primary or secondary storage. For example if the computer storage media are implemented as semiconductor based memory software can transform the physical state of the semiconductor memory when the program is encoded therein. For example software can transform the state of transistors capacitors or other discrete circuit elements constituting the semiconductor memory. A similar transformation can occur with respect to magnetic or optical media. Other transformations of physical media are possible without departing from the scope of the present description with the foregoing examples provided only to facilitate this discussion.

User application can include any user interface or software interface that a user device or external data system can interface with to instruct data storage system to perform the various storage operations. Application can include a web interface application programming interface API software application operating system user application or other software including combinations and variations thereof. In many examples application is presented to a user device or external system through a communication interface. For example application can be a user interface or API while a communication interface employing a network stack can be used for exchanging data packets with user devices or external systems to interact with application . Application can communicate with file system to perform data file or data object operations such as those mentioned above.

File system can be a CSFS a network file system NFS or a distributed file system DFS among other file systems including combinations thereof. Although CSFS is described herein it should be understood that other file systems can be employed such as local file systems network file systems distributed file systems custom file systems or sequential file systems including combinations and variations thereof. The file system can track data file or data object allocations so an operating system application or other user level software process can access data stored by any of HDD or . In this example file system provides a virtual storage device that spans more than one HDD. Virtual storage device can be presented to a user device or external system by user application as a single volume of storage. In some examples virtual storage device can be subdivide into sub volumes. File system communicates with storage mapper to store data onto various storage devices such as HDD .

Storage mapper determines which HDD to use for data storage for each data piece such as for a particular file or object transaction. Storage mapper can perform load balancing analysis to identify one of HDD on which to write data. This load balancing can include round robin load balancing to alternatively select different HDDs for each transaction. This load balancing can include monitoring a busy or idle state of the HDDs and distribute the write transaction to a HDD which is not in a busy state or which is in an idle state. The busy state can include a HDD presently writing reading or verifying data while the idle state can include a HDD not presently writing reading or verifying data. In further examples the load balancing includes monitoring a current position of a read write head or read head of a HDD and processing the current head position against a desired write or read location to prevent unwanted head seek and tracking operations and delays. Storage mapper can establish a storage map data structure that maps a first region in HDD as a vendor region or verification cache for a user region or cold storage region of HDD and vice versa. In this example cache region is provided on each HDD as a verification cache for the other HDD and cold storage region is provided as a user space for storing user accessible data.

Storage mapper is also configured to perform a verification process on data written to a cold storage region of a HDD after a verification trigger condition has been met such as those discussed herein. Storage mapper can identify one or more parts of the data in the cold storage regions of the HDDs that fail to pass a verification process transfer replacement data from the verification cache to supersede the failed data in the cold storage regions.

Also each HDD are shown with storage bands comprising each associated cache region and cold storage region. Cache bands of each cache region employ a less dense storage configuration such as a perpendicular magnetic recording PMR arrangement while cold storage bands of each cold storage region employ a more dense storage configuration such as a shingled magnetic recording SMR arrangement.

In further examples an enclosure is employed to house the elements of data storage system such as a rack mount enclosure or modular enclosure. A backup power supply such as an uninterruptable power supply UPS might be omitted from data storage system due in part to a higher reliability of stored data achieved using the verification cache to hold data until it has been completely verified for cold storage. Power interruptions can be less of a concern for data loss when the verification cache is employed.

In yet further examples data can begin to exceed a fullness threshold of an associated cold storage region of a HDD. This cold storage region can be expanded to include further storage regions such as storage regions previously used for verification caching. In this manner a HDD can employ the verification cache and cold storage arrangement until the cold storage arrangement exceeds a fullness threshold. Then the verification cache can be reduced in size or eliminated altogether to expand the cold storage area for increased storage capacity as the expense of slower operation due to more frequent verification of data stored in the cold storage regions.

The included descriptions and figures depict specific embodiments to teach those skilled in the art how to make and use the best mode. For the purpose of teaching inventive principles some conventional aspects have been simplified or omitted. Those skilled in the art will appreciate variations from these embodiments that fall within the scope of the invention. Those skilled in the art will also appreciate that the features described above can be combined in various ways to form multiple embodiments. As a result the invention is not limited to the specific embodiments described above but only by the claims and their equivalents.

