---

title: Program storage, retrieval and management based on segmentation messages
abstract: Segmentation messages indicative of locations of upcoming events, such as the start and end of programs and program portions, and/or rights related to the programs and program portions, are used by cable systems and the like to store programs and program portions for later retrieval and transmission to customers on request. Storage, retrieval and management of programming is thereby facilitated. Methods and systems are disclosed.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09538224&OS=09538224&RS=09538224
owner: Time Warner Cable Enterprises LLC
number: 09538224
owner_city: New York
owner_country: US
publication_date: 20141021
---
The present application is a continuation of U.S. patent application Ser. No. 13 673 735 which was filed on Nov. 9 2012 which is a continuation of U.S. patent application Ser. No. 10 428 719 which was filed on May 1 2003 and issued on Nov. 13 2012 bearing U.S. Pat. No. 8 312 504 which is a continuation in part of U.S. patent application Ser. No. 10 263 015 filed on Oct. 2 2002 which claims the benefit of U.S. Provisional Patent Application No. 60 377 963 filed on May 3 2002 under 35 U.S.C. 119 e which are incorporated by reference herein.

The invention relates to communications systems and methods and more particularly to a system and method for formatting multimedia content for storage and retrieval in a communications network.

Personal video recorders PVRs also known as digital video recorders DVRs such as TiVO and ReplayTV devices are popular nowadays for their enhanced capacities in recording television programming. They may offer such functions as one touch programming for automatically recording every episode of a show for an entire season commercial advance for automatically skipping through commercials while watching a recorded broadcast an on screen guide for looking up recorded programs to view etc. The PVRs may also suggest programs for recording based on a user s viewing habit. These devices also enable the pausing rewinding and fast forwarding of a live television TV broadcast while it is being recorded.

PVRs typically use electronic program guides EPGs to facilitate the selection of programming content for recording without having to set a timer. EPGs are also used to manage identify select and record programming content on program channels made available by cable television TV networks. A user s ability to accurately record a broadcast program with a PVR may be contingent upon the accuracy of the broadcast start and end times of the program prescribed by EPG data hereinafter EPG start and end times . In instances where the actual broadcast start or end time of a program is different than the EPG start or end time programming content is often recorded that the user did not want or all of the programming content that the user intended to record is not actually recorded.

The actual start and end times for a given broadcast program may be different than the EPG start and end times for various reasons. For example suppose a sports event such as a baseball game is scheduled to broadcast on a given evening from 7 30 PM to 10 30 PM but because of extra innings or a rain delay the game continues until 11 15 PM. Although the actual time of the game is from 7 30 PM to 11 15 PM the start and end times listed and provided by the EPG will be 7 30 PM and 10 30 PM respectively. Accordingly if a user selects to record the baseball game using the EPG in this instance the user would miss the last 45 minutes of the game i.e. from 10 30 PM to 11 15 PM . Other examples of programs ending later than expected include a Presidential Address a special news show or an awards ceremony. Certain Presidential Addresses or special news shows may not be scheduled at all. Technical difficulties causing the content provider to broadcast a program at a time other than that which is scheduled may also cause such a variance.

In addition when the time of one program provided on a specific channel is off schedule subsequent programs provided by the channel may also be affected unless the scheduled programming content is manipulated for example certain show or commercial segments may be skipped and therefore not broadcast . Thus in the example above if a user records through an EPG a particular show which was scheduled to broadcast from 11 00 PM to 11 30 PM but it actually broadcast from 11 15 PM to 11 45 PM because of a prolonged baseball game the user would not record the desired programming content. Instead in this instance the user s PVR would record the last fifteen minutes of the baseball game and only the first fifteen out of thirty minutes of that particular show.

PVRs have other disadvantages. For example like a VCR a PVR is a standalone device which requires yet another remote control to operate the device in addition to those remote controls for a TV set set top box DVD player VCR etc. which may already be confusing to a user. Another disadvantage is that a prior art PVR only records a the last X minute program material played on the channel to which the user actually tunes where X represents a limited value and b desired programs which need to be identified to or by the PVR in advance of their broadcast. Thus any program material other than a or b is not recorded by a PVR thereby limiting the materials that a user can review. For example the PVR user cannot review any unrecorded program after its broadcast. Still another disadvantage is that limited by the number of tuners therein a prior art PVR is not capable of recording programs in their entirety which have overlapping broadcast times and the number of which is greater than the number of tuners thereby further limiting the materials that a user can review.

Video on demand VOD services such as a subscription VOD service address at least some of these disadvantages by storing broadcasted programs for later retrieval by customers. TV programs may be acquired and stored in real time from multiple origination points. Typically entire program streams for each broadcast channel are stored each day. When a customer requests a particular program that has already been broadcast and stored the VOD service system may fetch the content of the requested program from storage based on the program times in an EPG and transmit the program to the customer. However EPG data does not provide program start and end times accurately enough to ensure that content is cleanly defined between elements. Advertising before or after a program which may have to be shown along with a requested program due to contractual obligations may be clipped. Portions of programs before or after the show may also be provided which may violate copyrights and contractual obligations with respect to those other programs. In addition the EPG data does not take into consideration deviations between the scheduled start and end times and the actual start and end times due to unscheduled program overruns or unscheduled special programs as discussed above. If a program has been delayed retrieval of a stored program based on EPG data will typically not enable retrieval of all or even part of the requested program. A user may therefore expect a program that they do not receive in whole or in part. EPG data also only indicates program start and end times. It does not provide any information about the location of logical blocks or chapters within the program such as monologs skits musical performances guest appearances sports highlights interviews weather reports etc. or advertising and advertising insertion points.

With the advent of digital communications technology many TV broadcast streams are transmitted in digital formats. For example Digital Satellite System DSS Digital Broadcast Services DBS and Advanced Television Standards Committee ATSC broadcast streams are digitally formatted pursuant to the well known Moving Pictures Experts Group 2 MPEG 2 standard. The MPEG 2 standard specifies among others the methodologies for video and audio data compressions which allow multiple programs with different video and audio feeds multiplexed in a transport stream traversing a single broadcast channel. A digital TV receiver may be used to decode an MPEG 2 encoded transport stream and extract the desired program therefrom. The prior art PVRs take advantage of MPEG 2 compression of video and audio data to maximize use of their limited storage capacity.

In accordance with the MPEG 2 standard video data is compressed based on a sequence of groups of pictures GOPs in which each GOP typically begins with an intra coded picture frame also known as an I frame which is obtained by spatially compressing a complete picture using discrete cosine transform DCT . As a result if an error or a channel switch occurs it is possible to resume correct decoding at the next I frame.

The GOP may represent up to 15 additional frames by providing a much smaller block of digital data that indicates how small portions of the I frame referred to as macroblocks move over time. Thus MPEG 2 achieves its compression by assuming that only small portions of an image change over time making the representation of these additional frames extremely compact. Although GOPs have no relationship between themselves the frames within a GOP have a specific relationship which builds off the initial I frame.

The compressed video and audio data are carried by continuous elementary streams respectively which are broken into packets resulting in packetized elementary streams PESs . These packets are identified by headers that contain time stamps for synchronization and are used to form MPEG 2 transport streams. For digital broadcasting multiple programs and their associated PESs are multiplexed into a single transport stream. A transport stream has PES packets further subdivided into short fixed size data packets in which multiple programs encoded with different clocks can be carried. A transport stream not only comprises a multiplex of audio and video PESs but also other data such as MPEG 2 program specific information PSI describing the transport stream. The MPEG 2 PSI includes a program associated table PAT that lists every program in the transport stream. Each entry in the PAT points to a program map table PMT that lists the elementary streams making up each program. Some programs are open but some programs may be subject to conditional access encryption and this information is also carried in the MPEG 2 PSI.

The aforementioned fixed size data packets in a transport stream each carry a packet identifier PID code. Packets in the same elementary streams all have the same PID so that a decoder can select the elementary stream s it needs and reject the remainder. Packet continuity counts are implemented to ensure that every packet that is needed to decode a stream is received.

Cue tones have been inserted into analog program streams by content providers to indicate insertion points for advertisements by cable systems. Cue tones are often missed however resulting in lost opportunities to insert advertising or clipping of inserted advertising adversely impacting advertising revenue.

American National Standard ANSI SCTE 35 2001 Formerly DVS 253 Digital Program Insertion Cueing Messages for Cable May 8 2001 referred to herein as the DVS 253 Standard which is incorporated by reference herein supports the splicing of MPEG 2 digital streams for the insertion of advertising and other content. Splice information may be provided in a splice information table associated with a particular program and or in a cue message in the program stream. The splice information table and cue messages may be sent multiple times. For example a cue message may be sent 8 5 4 and 2 seconds prior to the splice event. Unauthorized parties may intercept the splice information and use it to avoid the viewing of advertising or for other commercially deleterious purposes. The splice information may be encrypted to interfere with such interception.

In accordance with aspects of the present invention one or more segmentation messages are inserted into a program signal stream sources by of programming. The segmentation messages indicate the locations of upcoming events in the program signal stream such as the start and end of programs and program portions within the signal stream and or to indicate rights related to programs and program portions of the program signal stream. The segmentation messages are used by distributors of the programming such as cable systems to store programs and program portions as discrete assets for later retrieval and transmission on request. In general an asset is a container for an object or set of objects that may be desired to implement a service including video audio images etc. The expanse of programs and program portions from their start to their end may be accurately identified for segmentation from the program signal stream based on the segmentation messages. The cable systems rights related to the programs and program portions such as whether there is a right to store a program for later transmission may also be readily determined.

In accordance with one embodiment of the invention a method of storing an expanse of a portion of a program signal stream is disclosed. The program signal stream comprises a sequence of programs provided serially and at least one segmentation message in the stream. The method comprises receiving the program signal stream and storing the expanse of the program signal stream based at least in part on the at least one segmentation message in the program signal stream. The at least one segmentation message may indicate at least one time period until at least one upcoming event such as the start of a program or a portion of a program and or the end of the program or portion of the program for example. The program portion may be a chapter or advertising for example. The at least one segmentation message may be a single segmentation message indicative of a plurality of upcoming events such as the start and end of a program or program portion or a plurality of segmentation messages. For example one segmentation message may indicate the start of a program or program portion and another segmentation message may indicate the end of the program or program portion. The expanse of the program or program portion defined by the one or more segmentation messages is stored.

The at least one segmentation message may comprise information relating to rights concerning the expanse of the program signal stream. The expanse may be stored based at least in part on the at least one rights related segmentation message. The rights may include the right of a distributor of the program signal stream such as a cable system to store the expanse for transmission after broadcasting of the program signal stream to a requesting party for example. The rights may relate to a program or portion of a program. In one example the expanse may only be stored if such a right is indicated in the rights related information. The segmentation message may be within an expanse of program. The rights related information may be incorporated in a segmentation message that is also indicative of a time period until an upcoming event or it may be a separate segmentation message.

The stored expanse of the program signal stream may define an asset. The rights related information may be stored within or in association with the stored asset. A stored asset may be deleted from memory based at least in part on the rights related information as well. For example the rights related segmentation message might indicate that there is a right to store the asset for transmission for a limited period of time. The rights related segmentation message in or associated with the stored asset may be checked and the asset deleted from storage when the rights expire.

In a preferred embodiment a first segmentation message is provided indicative of a start of a program or program portion and a second segmentation message is provided indicative of an end of the program or program portion. A third segmentation message is provided indicative of rights related to the program or program portion. The program or program portion is stored based at least in part on the first second and third segmentation messages. For example whether the program or program portion is stored at all may be determined based on the third segmentation message. The start and end of the expanse to be stored may be determined based on the first and second segmentation messages.

The at least one segmentation message may be encrypted in the program signal stream. In that case the method further comprises decoding the encrypted segmentation message after receiving the program signal stream. Encryption may impede the ability of unauthorized parties to use the segmentation messages for purposes that may have a negative commercial impact such as avoiding commercials.

A program signal stream may comprise a plurality of first segmentation messages between the event and an event prior to the first event. For example the segmentation messages may be repeated from the start of a program or program portion to the end of the program or program portion. Each first segmentation message may be separated by equal time intervals. Each first segmentation messages may further indicate a time period from the prior event. Repeating the messages helps to ensure that a receiver of the program signal stream identifies the time until an upcoming event even if one or several segmentation messages are missed.

In accordance with another aspect of this embodiment of the invention a system is disclosed for storing an expanse of a portion of a program signal stream comprising a sequence of programs provided serially and at least one segmentation message in the program signal stream comprising means for receiving the program signal stream. Means for storing at least a portion of the program signal stream based at least in part on at least one segmentation message in the program signal stream is also provided.

In accordance with another aspect of this embodiment of the invention a system for storing an expanse of a program signal stream comprising a sequence of programs provided serially and at least one segmentation message in the program signal stream is disclosed. The system comprises at least one processor programmed to segment the expanse of the program signal stream from the program signal stream based at least in part on at least one segmentation message in the program signal stream. Memory is provided to store the segmented portion of the program signal stream. The at least one segmentation message may be one or more messages indicative of a time period to an upcoming event such as the start or end of a program or program portion and or rights related to the expanse of the program signal stream as discussed above. The processor is suitably programmed to segment the expanse based at least in part on the at least one segmentation message.

In accordance with another embodiment of the invention a method of transmitting a stored asset to a requesting party wherein the stored asset is an expanse of a portion of a previously broadcast program signal stream is disclosed. The method comprises receiving a request for the stored asset retrieving the requested stored asset and transmitting the requested stored asset to the requesting party. The method may further comprise determining if there is a right to transmit the requested stored asset and transmitting the requested stored asset only if there is a right to transmit the stored asset. This may be determined based on a rights related information associated with or stored within the asset. The asset may be assembled from component stored assets prior to transmitting the requested stored asset. For example the asset may be a program and the program may be transmitted without advertising that may have been in the program when originally broadcast. In another example original advertising may be replaced by substitute advertising. The asset may be a chapter of a program and the method may comprise receiving a request for the chapter from a party retrieving the chapter and transmitting the chapter to the party.

In accordance with another aspect of this embodiment of the invention a system for transmitting a stored asset to a requesting party wherein the stored asset is an expanse of a portion of a previously broadcast program signal stream is disclosed. The system comprises means for receiving a request for the stored asset means for retrieving the requested stored asset and means for transmitting the requested stored asset to the requesting party. Means may further be provided for determining if there is a right to transmit the requested stored asset.

In accordance with another aspect of this embodiment of the invention a system for transmitting a stored asset to a requesting party wherein the stored asset is an expanse of a portion of a previously broadcast program signal stream is disclosed. The system comprises memory to store a plurality of assets. At least one processor is programmed to retrieve a requested asset from the memory and transmit the requested asset to the requesting party. The at least one processor may be programmed to determine if there is a right to transmit the stored asset and transmit the stored asset only if there is such a right. The processor may be programmed to determine if there is a right to transmit the stored asset based at least in part on at least one rights related message associated with or within the asset. The processor may be further programmed to assemble the requested asset from component stored assets prior to transmitting the requested asset as discussed above. The at least one processor may be further programmed to check a rights related message associated with each stored asset in memory and delete a stored asset if the rights related message indicates that rights to transmit have expired.

In accordance with another embodiment of the invention a method of generating a program signal stream for delivery is disclosed comprising creating a serial sequence of programs wherein at least one of the programs comprises a program portion. A segmentation message is inserted in the program stream to indicate an expanse of the portion. The program portion may be a chapter for example.

In accordance with another embodiment of the invention a method of generating a program signal stream for delivery is disclosed comprising creating a serial sequence of programs. At least one segmentation message is inserted in the program signal stream to indicate at least storage and transmission rights related to that portion of the program signal stream.

In accordance with one embodiment of the invention segmentation messages inserted into a program signal stream by sources of programming are used by a distributor of the programming such as a cable system to facilitate storage and management of programs for later retrieval by customers. Two types of segmentation messages are disclosed content segmentation messages and rights related segmentation messages. Content segmentation messages are provided to identify events in the program signal stream such as the boundaries of the program and portions of the program. Content segmentation messages may be placed in the program signal stream prior to an event to indicate a time period until one or more of the following the start of a program the end of a program the start of a chapter of the program the end of the chapter of the program the start of network advertising the end of network advertising the start of local advertising the end of local advertising the start of unscheduled content and the end of unscheduled content for example. Expanses of the program and program portions may thereby be readily and accurately identified segmented from the program signal stream and stored as discrete assets for later retrieval regardless of delays in broadcasting caused by overruns of earlier programs for example. Assets may be readily created and stored of the entire program and chapters national and local advertising and other portions of the program. The flexibility of a video on demand system in offering and presenting stored programming to its customers upon request may thereby be improved.

Rights related segmentation messages may include information about the scope of the rights related to a program granted by a source of a program to a distributor of the program such as a cable system. These rights may include operational rights and operational time windows. For example when a cable company contracts with a source of programming the cable company may only acquire limited rights to the use of a particular program. Certain programs may only be broadcast once while others may be stored and retrieved for additional transmission. The right to store and retrieve may be unlimited or may have an expiration date. The rights related to a particular program or portion of a program may dictate how a program is processed by the cable system such as whether it is stored for later retrieval or not . The rights may also be monitored over time to identify whether granted rights have expired. Management of stored assets is facilitated by associating the information defining the rights related to each program and program portion with the program in the program signal stream and with the corresponding stored assets. Other granted rights may relate to advertising deletion or replacement in transmitted programs a time shift right and rights to rewind fast forward or pause for example. Any operational rights and operational time windows may be incorporated in a segmentation message.

Sources create and broadcast programming to cable system through an origination system . Sources include analog and digital satellite sources that typically provide the traditional forms of television broadcast programs and information services. Sources also include terrestrial broadcasters such as broadcast networks CBS NBC ABC etc. for example which typically transmit content from one ground antenna to another ground antenna and or via cable. Sources may also include application servers which typically provide executable code and data for application specific services such as database services network management services transactional electronic commerce services system administration console services application specific services such as stock ticker sports ticker weather and interactive program guide data resource management service connection management services subscriber cares services billing services operation system services and object management services and media servers which provide time critical media assets such as Moving Pictures Experts Group 2 MPEG 2 standard encoded video and audio MPEG 2 encoded still images bit mapped graphic images PCM digital audio three dimensional graphic objects application programs application data files etc. Although specific examples of programs and services which may be provided by the aforementioned sources are given herein other programs and services may also be provided by these or other sources without departing from the spirit and scope of the invention. An example of an origination system that inserts segmentation messages into a program signal stream to facilitate storage retrieval and management of programming by cable system is discussed in more detail with respect to below.

Cable system includes headend which processes program materials such as TV program streams for example from sources in digital and analog forms. Digital TV streams may be formatted according to Motorola Digicipher System Scientific Atlanta Powerview Systems the Digital Satellite System DSS Digital Broadcast Services DBS or Advanced Television Standards Committee ATSC standards for example. Analog TV program streams may be formatted according to the National Television Standards Committee NTSC or Phase Alternating Line PAL broadcast standard. Headend extracts program content in the analog and digital TV streams and reformats the content to form one or more MPEG 2 encoded transport streams for transmission to users at set top terminals through . Such reformatting may be applied to those received streams already in an MPEG 2 format. This stems from the fact that the digital content in the received MPEG 2 streams are typically encoded at a variable bit rate VBR . To avoid data burstiness headend may re encode such digital content at a constant bit rate CBR to form transport streams in a conventional manner. Headend is discussed in more detail below with respect to and

The generated program signal transport streams are typically transmitted from headend to hub via Internet Protocol IP transport over optical fiber. The program signal streams may also be transmitted as intermediate frequency signals that have been amplitude modulated AM or as a digital video broadcast DVB a synchronous serial interface ASI that has also been AM modulated. Hub includes modulator bank among other components. Modulator bank includes multiple modulators each of which is used to modulate transport streams onto different carriers. Hub is connected to hybrid fiber coax HFC cable network which is connected to service area nodes through . The transport streams may be recorded in headend so that the users at the set top terminals may manipulate e.g. pause fast forward or rewind the programming content in the recorded streams in a manner described in co pending commonly assigned application Ser. No. 10 263 015 the 015 application filed Oct. 2 2002 for example which is incorporated by reference herein. In addition in accordance with an embodiment of the invention the program signal streams are processed and stored by headend based at least in part on the segmentation messages as described further below.

Segmentation message which may be referred to as a program start message indicates that TV program will start in A seconds from the time of the appearance of that message. The time period may be defined in segmentation message . Segmentation message may also include a program identification code PIC that uniquely identifies the program. Other PICs may be used to identify other program segments such as chapters or advertising. Other information such as rights related information may be provided in segmentation message as well. For example the rights information may indicate whether there is a right to store program for later retrieval. is an example of a segmentation message such as segmentation message in program stream . Segmentation message includes PIC field rights related information field and time until event field which here indicates the time until the start of program .

Instead of including rights information in segmentation message it may be provided in a separate message as shown in . Rights message may have a similar configuration as segmentation message of except that time to event field is not needed. PIC field and two rights fields are shown. More or fewer rights fields may be provided depending on the number of rights that need to be defined.

Content and rights related segmentation messages may be formatted in accordance with the DVS 253 Standard discussed above for example. A segmentation message may be in the form of a packet delineated by a sync byte which is a byte that is unlikely to be replicated in the program stream. The fields discussed above may follow the sync byte separated by commas. Segmentation messages may be provided over a single channel for all programs in the multiplex.

Returning to another rights related segmentation message is provided after start of program . It may be useful to provide a rights message within the expanse of the program or program portion to which the right relates in addition to or instead of providing rights related segmentation message prior to the start of program . If both rights related segmentation message and are provided different types of rights information may be provided in each. For example the right to copy program may be included in segmentation message so that headend will know prior to the arrival of program whether or not program may be processed for storage. Other types of rights such as the right to store the program for a particular period of time which is useful information to have access to after program is stored may be provided within the expanse of program in rights segmentation message . Other rights related to the use of the stored program may also be more advantageously stored within the expanse of program in message .

Segmentation message which may be referred to as a program end message indicates that TV program will end in B seconds from the appearance of message . The program identification code and any other desired information may be included in the message as well.

Segmentation message which may be referred to as a chapter start message indicates that a chapter will start in C seconds from the appearance of message . A PIC field and a field for an identification code for chapter may be included in the message. A rights information field may also be incorporated in segmentation message or in a separate rights segmentation message within the expanse of chapter particularly if chapter has different rights associated with it than the rights associated with program . Segmentation message which may be referred to as a chapter end message indicates that chapter will end in D seconds from the appearance of message .

Segmentation message which may be referred to as a network advertising start message indicates that network advertising will start in E seconds from the appearance of message . A PIC field and a field for an identification code for that segment of advertising may be included in segmentation message as well. Rights information if any which may relate to that advertising segment may be included in segmentation message or in a separate segmentation message not shown associated with advertising segment . For example contractual obligations with respect to program may require that the advertising segment be included whenever program is broadcast. Alternatively the right to delete or replace advertising may be granted. Providing such information in segmentation message or in a separate segmentation message associated with the advertising segment facilitates correct processing of program for storage and assists in ensuring that rights obligations are met. Segmentation message which may be referred to as a network advertising end message indicates that the network advertising will end in F seconds from the appearance of message .

Segmentation message which may be referred to as a local advertising start message indicates that local advertising will occur in G seconds from the appearance of message . A PIC field and a field for an identification code for that segment of local advertising may be included in segmentation message as well. As above rights information relating to that segment of local advertising may also be provided in segmentation message or in another segmentation message associated with local advertising segment . Segmentation message which may be referred to as a local advertising end message indicates that that break will end in H seconds from the appearance of message . Advertising is typically included in program stream as provided by a source in the expanse indicated by the local advertising start and local advertising end messages . Cable system may insert local advertising into the program stream replacing the advertising originally provided by a source . Cable system may use segmentation messages to determine when to start insertion of the local advertising and when to return to the program stream . The advertising may be inserted at the headend or at set top terminals through as discussed further below.

If program extends beyond its expected end time such as if program is a sporting event going into overtime for example an unscheduled content start segmentation message may be provided to indicate the start of unscheduled content in I seconds. A PIC field and a field for an identification code for the unscheduled content may also be included. Rights information may be included as well.

If the unscheduled content is overtime in a sporting event for example the unscheduled content ends at the end of program . Program end segmentation message may indicate the end of both program and unscheduled content or an unscheduled content end segmentation message may be provided. If the unscheduled content is a news bulletin for example it may end prior to the end of program . An unscheduled content end message is then preferably provided to indicate the end of that content.

After the unscheduled content is completed program may continue to be broadcast at the point where the program was interrupted. In that case the entire program is broadcast. However program may then run over the scheduled end time. The unscheduled content end message will indicate when the unscheduled content ends. Alternatively if the progress of program continues while the unscheduled content is being broadcast program will end on time but part of program will not be shown to the viewer. Cable system may want to warn the viewer that a portion of the show is being pre empted or will run over the scheduled end time. In addition whether a program has been pre empted may affect treatment as a stored asset for later retrieval. For example users may be notified that the program was not broadcast in its entirety and the requested program will not be complete. If the pre emption is due to a news bulletin the bulletin may be stored as a separate asset as well. It may therefore be useful to include information indicating whether a portion of program is pre empted so that program ends on time or that program is not pre empted and will run over the scheduled end time in unscheduled content segmentation message or in another segmentation message.

The A I time periods referred to above are real numbers. Time periods A I may be 6 seconds for example. Other time periods may be used and different time periods may be used for different segmentation messages. Alternatively it may be previously defined that all segmentation messages or segmentation messages of certain types indicate a predetermined time period until the occurrence of the event.

Both ends of a program or a program portion such as chapter are preferably indicated by separate segmentation messages. Alternatively both the time until a start of a program or program portion and the time until the end of that program or program portion may be indicated in the same segmentation message. For example in segmentation message in where Time to Event field indicates the time until the start of program an additional field may be provided to indicate the time until the end of program and or the duration of the program. Such a segmentation message should be positioned prior to the start of the respective program or program portion. Both a program start segmentation message including a time to end or duration of a program and program end segmentation message may be provided for redundancy as well.

As shown in expanses may exist within other expanses. For example together a program start message and a program end message define an expanse of the entire program . Program start and end messages for chapter network advertising and local advertising define expanses of the respective program portions within the expanse of program . If any portion of a program has a start message without a corresponding end message program end message terminates all segments without their own end message. If a chapter or advertisement portion is the beginning of a program a corresponding start message preferably accompanies the program start message and defines the same boundary time. As mentioned above a program end message can terminate unscheduled content segment .

In accordance with another embodiment segmentation messages may be sent multiple times or periodically for redundancy. Since errors in defining the start and end of program could result in storage of an incomplete program or storage of one program including a portion of another program the program start and program end messages and other such significant segmentation messages are preferably sent two or more times prior to the event boundary. For example the program start message and the program end message may be sent twice within a 5 to 8 second window prior to the respective boundary. Advertising segmentation messages particularly those defining an expanse of local advertising where cable system may insert their own advertising are also preferably sent multiple times because missing an advertising insertion point could adversely impact advertising revenue. Messages may be sent minutes before the boundary as well.

Another important segmentation message that may be repeated is memory or unscheduled content start message and the unscheduled content end message . Since the unscheduled content may extend beyond the scheduled end time of program it is important for the cable company to know this as soon as possible. The exact end time of the unscheduled content may not be known but the end message can indicate an expected time to end of content in the message. The value of the expected time to end of content may become more accurate as the unscheduled content progresses towards its conclusion and the segmentation messages may reflect this developing accuracy.

For further redundancy the messages may be sent periodically throughout a program or program portion. For example a segmentation message to indicate an event may be sent every minute starting from the start of a prior event. As an event is approached the time period between messages may become shorter. For example messages may be sent every minute until the boundary is 1 minute away. Then the messages may be sent every 10 seconds or more frequently. Segmentation messages may also be provided within one or more prior portions to indicate an event in a subsequent portion. For example in program stream national advertising start messages may appear one or more times within chapter or even before the start of chapter in the program stream.

If two segmentation messages received at different times indicate different event times the time of the segmentation message arriving last is considered to be more accurate. It may for example reflect an unanticipated change in the end time of a program such as overtime or postponement of a commercial in a sports event.

Other segmentation messages that may be provided include a table of all of the segmentation points in a program. Tables of particular types of segmentation messages or all of the segmentation messages may also be embedded in program stream . For example a table of each type of advertising national and local for example in a program may be provided. Additional information may be provided in the segmentation message to identify a commercial sponsor of respective advertising to assist cable system in inserting appropriate advertising. For example if the segmentation message includes an indication that a national ad that must be broadcast is for a soda company Coca Cola for example then a cable system can more readily avoid placement of an advertisement for a second soda company Pepsi for example in a local ad spot in proximity to the ad for the first soda company which may be a contractual obligation of cable system . Receipt of such information in a table at the beginning of a program or prior to that allows cable system time to plan for ad placement in the program. Providing all segmentation messages in a table in program stream at the beginning of a program or prior to that would give cable system more time to plan for other events as well.

Another segmentation message that may be provided is a message to indicate that a scheduled program is being replaced by source or may be replaced by system cable by substitute programming. For example if a sporting event is cancelled due to rain source may provide substitute programming and the cable company may have the option of providing its own substitute programming. A segmentation message may be provided as part of program start message or prior to it to indicate that substitute programming follows and to identify the programming.

It will be appreciated that automated techniques may be used instead of a manual technique for monitoring actual start and end times of a program. For example one such automatic technique may involve automatic processing of the broadcast signal to detect fade to black frames typically associated with the beginning and end of a program and registering the time of such detections.

Content segmentation messages are then inserted in Step . For example automation system translates the demarcations defined by the operator into segmentation message insertion commands which may be sent to network controller via an IP connection. Network controller sends the segmentation message insertion commands which includes the segmentation message to be inserted and the insertion time to encoder . Encoder formats the command into an MPEG 2 transport packet for example and inserts the packet which is now the segmentation message into the single program transport stream at the specified clock time.

Appropriate rights segmentation messages are also inserted into the program stream in Step . The operator of automation system may define the rights to be associated with a program or program portion based on externally provided information. Automation system translates the rights information into segmentation message insertion commands which may also be sent to encoder via network controller . Encoder formats the command into an MPEG 2 transport packet for example creating the segmentation message. Encoder inserts the segmentation message into the program signal transport stream as well.

The segmentation messages are preferably encrypted in Step . Encryption interferes with the ability of unauthorized parties to intercept and act upon segmentation messages for unintended purposes. For example interception of segmentation messages could enable unauthorized parties to identify certain types of program portions such as commercials for the purpose of skipping those portions. Encoder or a separate processor may provide encryption. It is noted that the entire program stream may be encrypted to prevent unauthorized interception of programming as well.

Any encryption technique may be used. For example a fixed key encryption may be used where the key used by encoder or an MPEG multiplexor is provided to cable system by source separately from program stream . Cable system may then decrypt the segmentation messages or the entire program stream as necessary. Encryption techniques are discussed in more detail in the DVS 253 Standard which is discussed above and is incorporated by reference herein for example.

Keys for decryption may be provided by sources to cable system in tables sent via an out of band message to cable system . An index to the table may also be sent by source to cable system via another out of band message to indicate which key is to be used to decode program streams and or segmentation messages in program streams from a particular source .

Additional security may be provided through a Public Private Key Exchange. Such a system is used in cable conditional access systems for example. A Data Encryption Standard DES or the Rivest Shamir and Adleman RSA algorithm may also be used for example. The longer the key lengths the more secure the encryption.

As mentioned above segmentation messages for program may be provided in a table in program stream instead of or in addition to providing the messages in program stream proximate related boundaries. Such a table or other such collection of segmentation messages may also be provided out of the band of program stream . It may be carried in a separate program stream for example. The segmentation messages may thereby be secured separately from program . When provided out of band the segmentation messages may be readily removed by the cable system so that they are not broadcast to unauthorized parties or devices. Embedded segmentation messages may also be removed from the program signal stream prior to broadcast as discussed below. Rights segmentation messages may also be provided outside of program signal stream via another communication path or channel such as in a separate program signal stream. They may also be sent with a PIC listing for program . For example rights information may be delivered via a virtual private network VPN . The messages may have the same PIC as program enabling the proper rights information to be correlated with the proper program .

The use of segmentation messages enables a higher level of control over program content by the source of the program. For example if source wants interstitial material such as a parental advisory message to be included in all presentations of a program the program start segmentation message inserted by origination system may indicate a start location prior to the advisory. The advisory will then be stored with the program and will be retrieved whenever the program is retrieved. Other types of interstitial material that source may want to be included in all stored programs include previews certain advertising or promotions related programming such as a documentary about the making of the main program and the trademark of the source for example. Interstitial material may be placed before or after the program as appropriate. Interstitial messages after a program may be included with the program when it is stored as an asset through use of program end segmentation message .

In this example A S processor is also a program splicer. Staging processor segments program stream based on the segmentation messages in the stream and externally provided program schedule information under the control of schedule manager . Program schedule information may be provided to schedule manager by an electronic program guide EPG server in the form of a program guide data stream that includes a program identification code PIC and the approximate program start and end times for each program. The program guide data stream is typically provided by a third party that aggregates program scheduling information from a plurality of sources . The program guide data stream may be stored by cable system in schedule manager memory or other such memory as program guide data. The program start and program end segmentation messages in the program signal transport stream provide more precise program start and end times than those provided in the stored program guide data. The program guide data stream does not provide any information about program portions such as chapters.

Asset manager including memory is coupled to A S processor to receive the expanses of segmented programs and program portions format the segmented programs and program portions if necessary to create respective assets and store the assets. Memory and memory may be a disk cache for example having a memory capacity on the order of terabytes. Asset manager formats the expanses into assets by associating a program identification code PIC with each expanse facilitating location and retrieval of the asset from memory . Rights information is preferably associated with each asset as well. The PIC and rights information may be derived from or may actually be the segmentation message in program stream . Program portion assets such as chapter and advertising portions may also be formatted by being associated with the PIC of the program and another code or codes uniquely identifying the portion and the location of the portion in the program. Such codes may be formatted by A S processor as well.

It is noted that in addition to the raw content program specific information PSI is also a part of an asset that describes characteristics of the asset. For example PSI may describe attributes that are inherent in the content of the asset such as the format duration size or encoding method. Values for asset PSI are also determined at the time the asset is created by asset manager or A S processor .

Memory or other such memory may also store current TV programs being currently broadcast to enable PVR functions such as rewind pause and fast forward as described in the 015 application identified above and incorporated by reference herein. Source may grant rights related to PVR functions for originally broadcast programs the also be defined in rights related segmentation messages. For example there may be rights granted relating to rewinding fast forwarding and pausing. Rights to such functions may also be granted with respect to later transmitted programs as well.

The embedding of rights related information in or near program in program stream facilitates incorporation of the information in a stored asset. Rights management of that program is also facilitated. For example when TV program is received by cable system the rights message associated with the program may be directly checked to determine if the cable system has rights to copy and store the program. If not TV program is broadcast by the cable company to customers without storing the program. In addition the memory may be searched and rights related segmentation messages checked to identify programs and program portions with expired rights. Those programs and program portions may be deleted when such messages are found. When rights information is stored or filed separately from the program or program portion it may be more complicated to identify locate and delete expired assets. When assets are retrieved from memory for transmission rights information associated with the asset may be checked again to ensure that cable system has the right to transmit the asset at that time as discussed further below.

Encoded information is derived from the scanned program signal stream in Step . For example A S processor scans the program stream for content and rights segmentation messages as the stream is being scanned. Upon locating a segmentation message such as program start segmentation message A S processor retrieves and sends the message to schedule manager . If the segmentation message is encrypted A S processor decrypts the message prior to sending it to schedule manager . Schedule manager processes the segmentation message to derive the encoded information. An actual start time of program may be determined by A S processor or schedule manager based on the time to start indicated by the segmentation message and a system clock in headend not shown . Rights segmentation message is identified retrieved and provided to schedule manager as well.

It is then determined whether there is a right to store the program in Step . For example schedule manager evaluates the information derived from rights segmentation message to determine if the cable system has the right to store the program. If Yes additional encoded information is derived from the program stream as it is being scanned in Step . For example program end segmentation message is similarly identified and retrieved by A S processor and provided to schedule manager to derive the encoded information. Program start and end segmentation messages indicating boundaries of program portions such as advertising and chapters may be derived as well.

The program is segmented and stored based on the segmentation messages in Step . In this example schedule manager instructs A S processor to process program for storage based at least in part on the segmentation messages. For example A S processor is instructed to segment program from program stream at the start time indicated by segmentation message and the end time indicated by program end segmentation message . A S processor determines the best splice point for defining the start and end of program and program portions and divides the content at an MPEG 2 I frame or P frame for example proximate that point. The MPEG 2 I frame or P frame may not be at the exact time indicated by the segmentation message. Audio content associated with the program is divided at a time close to the video presentation time of the video segmentation point. The expanse of program from its segmented start point to its segmented end point is then stored as a discrete asset in memory in asset manager .

Segmentation may take place in real time as program stream is being captured by A S processor . For example A S processor may provide a segmentation message to schedule manager upon receipt. Schedule manager may immediately determine that there is a right to store program for retrieval and instruct A S processor to segment program stream at the location in the program signal stream indicated by segmentation message . If there is a lead time of at least several seconds for example A S processor may be instructed to segment the program signal stream at the location identified by the segmentation message prior to receipt of that portion of program signal stream . Segmentation may therefore take place as soon as that location in program signal stream is received.

Expanses of chapter national advertising and local advertising of program may be segmented and stored as discrete assets in accordance with the method as well. For example A S processor may identify and retrieve start and end segmentation messages for any or all of these program portions in Step and provide them to schedule manager as program stream is being scanned. If there are separate rights messages associated with any of these program portions they may be identified retrieved and forwarded to schedule manager as well. Schedule manager interprets the segmentation messages and if authorized by corresponding rights information instructs A S processor to segment those portions from program stream as well. After program has been segmented and stored program is available for retrieval in Step .

In optional steps of method the actual segmentation time for the start and end of program may be sent to schedule manager to update the PSI for the current program . The actual program start and end times may then be compared to program start and end times for the same program in the program guide data stored in memory for example based on the program identification code PIC in Step and the start and end times of the current program and subsequent programs in the program guide data stored in memory for example is updated if necessary in Step . Schedule manager may conduct such a comparison for example. If there is a discrepancy in either the start or end times greater than a predetermined tolerance then schedule manager may update the respective time for program in the program guide data stored in memory for example in Step . The tolerance may be fractions of a second up to a few minutes depending on the importance of the program content surrounding the program stream boundary. For example the program content at the end of a sporting event is very important as is the program content at the beginning of a news program. In those cases the tolerance should be small fractions of a second . If it is determined in Step that there is no right to store the program Step is skipped and Step may be implemented.

A S processor may cause or allow the rights segmentation messages such as messages and to be incorporated within or in association with an asset. For example the rights segmentation messages for the entire program and for chapter respectively may be included within the expanse of the corresponding asset when stored. If the rights related segmentation message is outside of the expanse of a respective program portion in program such as if rights related segmentation message is incorporated in program start segmentation message and the chapter rights segmentation message is incorporated in chapter start segmentation message code may be inserted in or associated with the created asset by asset manager or A S processor .

If the asset is a TV program such as TV program the expanse of the program between the boundaries indicated by program start segmentation message and program end segmentation message may be stored as a single asset which may be readily retrieved in its entirety and transmitted to a customer on request. is an example of a portion of memory where program is stored as a single asset in a memory location . Asset includes a PIC field and a rights field preferably at the head of the asset. As discussed above these fields may be the original segmentation messages part of the original segmentation messages or may be derived from the original segmentation messages in program stream by asset manager or A S processor .

Program may be segmented and stored in other ways instead of or in addition to being stored as a single asset . For example program may be segmented into assets and corresponding to the following program portions 1 start of program to start of chapter 2 chapter 3 end of of chapter to start of national advertising 4 end of national advertising to start of local advertising 5 local advertising 6 end of local advertising to start of unscheduled content and 7 start of unscheduled content to end of program respectively. These assets are shown stored in memory locations 110001 110010 110011 110100 110101 110110 and 110111 respectively in . In this example each asset has a PIC field . Each asset also has an asset code field to uniquely identify the asset. Assets and corresponding to chapter national advertising local advertising and unscheduled content also have a rights field . Rights field may be a rights segmentation message from program stream or may be based upon the information in the rights segmentation message. Storage of a variety of assets with different compositions may provide further flexibility in program retrieval and reconstruction and enable cable system to offer a wider range of choices to a customer.

For example if cable system has the right to offer program without commercials and presents such an option when requested program may be assembled from assets and for transmission. If cable network has the right to replace either or both of national or local advertising in program by other advertising asset manager may do that as well. For example if both national and local advertising may be replaced media processor may retrieve assets and and insert replacement advertising for assets and during assembly of program for transmission. Replacement advertising may be stored in and retrieved from asset memory as well.

In addition cable system may have the right to transmit and offer the option of receiving only a chapter of a program such as chapter . Asset manager would then only retrieve asset . Chapter may also have different associated rights than the remainder of program . For example the rights to transmit chapter on request may expire prior to the transmit rights related to the remainder of program . If program is requested and asset manager determines that the right to transmit chapter has expired then asset manager may assemble program without chapter . Asset manager may cause a notification of the deletion of chapter to be transmitted with program .

Commercial defeat devices may interpret the mere presence of a message in a program stream as an indication of an upcoming advertisement. It is therefore preferred that segmentation messages be removed from the program stream prior to broadcast of the program stream to customers. A S processor may remove content related segmentation messages from the program stream during processing of program for broadcast. It is also similarly preferred that programs be stored for later transmission without segmentation messages. As discussed above rights related segmentation messages may be retained in the stored assets. If rights information is combined with content segmentation messages the rights information may be removed and stored. The use of multiple segmentation messages or decoy messages in the program stream may also render the use of commercial defeat devices impractical. An example of a decoy message is splice null message in DVS 253 format.

As mentioned above rights related messages and information may also be directly checked for expiration dates and other restrictions when a requested program is retrieved from memory. If rights to the program or program portion of the requested program have expired then the expired program or the expired portion thereof is not delivered. The requester may then be informed that the requested program or a segment of the program may no longer be viewed. Use of rights related segmentation message also facilitates verification that rights have been correctly noted.

The asset or assets comprising the requested programming is retrieved in Step . Asset manager may retrieve the asset or assets based on the PIC or other such identification from memory .

It is then determined whether cable network has a current right to transmit the asset or assets in Step . Asset manager may check rights field or in a retrieved asset. If the rights field indicates that the right to transmit the requested asset has expired the user may be notified in Step .

If the rights segmentation message indicates that there is a right to transmit the asset or assets making up the requested programming the asset or assets are processed if necessary in Step . Processing may involve assembling the requested programming from components of the programming deleting or replacing commercials etc. The requested programming is then transmitted to the user in Step .

Cable system may have local advertising inserted by set top terminals through in in accordance with another embodiment of the invention. Application Ser. No. 10 303 290 filed on Nov. 25 2002 assigned to Time Warner Entertainment Company L.P. which is incorporated by reference herein discloses an example of a system where set top terminals may insert substitute commercials corresponding to original commercials as a user fast forwards through the original commercials. The substitute commercial is configured to be appreciated at the faster speed.

An advertising insertion point is identified in Step . For example processor scans the program signal stream for a local advertising start message as the program signal stream is received. If the program signal stream is broadcast by headend with encrypted segmentation messages and or decoy messages processor decrypts encrypted messages and disregards the decoys.

Advertising is inserted into the program signal stream starting at or near to the insertion point in Step . Processor may request a stored advertisement from memory and insert the advertisement starting at or near to local advertising start message for example.

An end of the local advertising portion of the program signal stream is identified in Step . Processor may continue to scan the program signal stream as it is received to identify the local advertising end segmentation message for example. The advertising is ended and the original program signal stream is provided to a TV or other such display device coupled to terminal in Step .

Set top terminal may also include personal video recorder PVR which may be part of processor as shown in or may be coupled to processor . Users may program PVR to record programming at designated times based on an EPG or other such program listing for example. The recorded programming may be stored in memory or other such memory. In accordance with another embodiment of the invention processor may adjust start and end times for recording selected programs based on segmentation messages as well. Processor may compare program start segmentation message and program end segmentation message to the start and end times for a particular program according to the EPG and adjust the respective times indicated by the EPG to ensure accurate recording if necessary. Processor may thereby compensate for differences between the actual broadcast times for a program and the scheduled times in the EPG due to overtime in sporting events news bulletins etc. The segmentation messages may be in the program stream or may be provided separately as described above. The segmentation messages may be encrypted by headend of cable system or by a source as described above.

An encoded program start segmentation message is derived from the program stream in Step by processor for example. The time to the start of a program is determined from the program start segmentation message and compared to the set recording start time based on the EPG in Step by processor for example. If there is a difference or if difference is greater than a threshold for example the recording start time is adjusted in Step . Recording is started by PVR at the appropriate time in Step .

As the program is received the encoded program end time is derived in Step . The time to the end of the program is determined from the derived program end time based on a program end segmentation message and compared to the end time for the program in the EPG by processor in Step . For example if the difference is greater than a threshold the time is adjusted in Step . Recording ends at the end of the appropriate time in Step .

While described in terms of a set top terminal including a PVR the invention may be implemented by a video cassette recorder VCR including a processor or other PVRs or digital video recorders as well.

As discussed above headend may remove segmentation messages from the program stream prior to broadcasting the program signal stream. If cable system enables adjustment of recording times by set top terminals then headend may allow the necessary segmentation messages to be broadcast with the program stream as well. Alternatively the segmentation messages may be provided to set top terminals separate from the program signal stream as discussed above.

Processor may also use other segmentation messages such as unscheduled content start message and unscheduled content end message to assist in more accurately identifying program boundaries for recording. If chapter information is provided in the EPG for separate recording for example chapter start segmentation message and chapter end segmentation message may be used as well. In addition segmentation messages may be used without EPG data to define program and program portion boundaries for recording. For example user input start and end times of a program may be adjusted based at least in part on segmentation messages.

Segmentation messages may be associated with analog transmissions such as satellite transmissions of network stations and digital transmissions decoded via an integrated receiver decoder IRD as well. is an example of origination system that may provide an analog program stream with embedded segmentation messages.

Origination system comprises automation system coupled to uplink system via origination proxy . As discussed above with respect to automation system controls operation of system and enables operators to identify locations of segmentation messages in a program or program stream. Origination proxy interfaces with automation system to receive information on when segmentation messages should be inserted. Origination proxy also interfaces with downstream insertion equipment to have the proper messages inserted at the proper locations. Automation system is thereby insulated from changes in the equipment and techniques for inserting segmentation messages. Origination proxy may comprise a suitably programmed processor or server for example. Alternatively the functions of origination proxy may be incorporated in automation system . Uplink system which processes input program signal streams as necessary for transmission is coupled to transmitter which acts as an interface to transmit analog signals to satellite . For example uplink system may modulate the signal stream by quaternary phase shift keying QPSK modulation for example. Three examples of systems for incorporating segmentation messages are shown in along Path 1 Path 2 and Path 3 respectively. Each Path 1 3 differs in the way origination proxy is coupled to uplink system . Other systems may be used as well.

Path 1 may be used where uplink system includes an asynchronous data port with an RS232 input. Origination proxy may be coupled directly to asynchronous data port . A low data rate bit stream is preferably used to provide richer messages. Certain satellite systems such as the Motorola Video Cipher available from Motorola Inc. San Diego Calif. for example have such an asynchronous port. Origination proxy instructs uplink system to insert segmentation messages at particular locations via an application programming interface. The segmentation messages may be inserted in the well known asynchronous RS 232 serial format.

In Path 2 and Path 3 segmentation information may be inserted into the analog video vertical blanking interval VBI for example which is a portion of the video signal that is outside of the displayable region. An encoding format such as Extended Data Services XDS EIA 608B Line 21 Data Service Sep. 21 1999 may be used to carry segmentation messages in an ancillary portion of the video signal. For example line 21 fields 1 and 2 typically carry closed caption information in accordance with regulations. Segmentation messages in XDS format may be readily supported in line 21 by both satellite and over the air broadcast equipment. Segmentation messages may be in the form of a sync byte as discussed above with respect to DVS 253 messages for example. The segmentation messages described above with respect to digital systems and other segmentation messages as desired may be inserted into the VBI in XDS format. Closed caption information and segmentation messages may be inserted simultaneously or sequentially. It is also noted that XDS format may be used in any non compressed analog or digital program stream. Other suitable formats may be used as well.

If XDS format is used in Path 2 in this example origination proxy is coupled to Extended Data Service Closed Caption XDS CC encoders through via a serial interface for example. MPEG 2 Digital Compression System which comprises respective MPEG 2 encoders . . . and MPEG 2 multiplexor is coupled to XDS CC encoders through . MPEG 2 Digital Compression System is coupled to uplink system . MPEG 2 compression is provided to decrease the number of bits of the program stream decreasing the number of bits that need to be transmitted.

Baseband audio video of individual programs are provided along respective channels 1 2 . . . n to XDS CC encoders through respectively which insert segmentation messages and closed caption information in XDS format into the VBI. The MPEG 2 encoders through digitally encode and compress the digital programs along each channel. MPEG 2 multiplexer multiplexes the programs into a single multi program transport stream in MPEG 2 format which is provided to uplink system .

If XDS format is used in Path 3 of this example XDS CC encoder is coupled to origination proxy and uplink system . XDS CC encoders inserts segmentation messages in XDS format and closed caption information into a baseband audio video program stream under the control of origination proxy . The program stream is conveyed to uplink system and transmitted to satellite in analog format without compression and MPEG 2 conversion. The particular segmentation messages described above with respect to digital systems and other segmentation messages as desired may be inserted in VBI in XDS format. In Path 3 the program stream is not MPEG 2 compressed to allow for analog reception in a headend of cable system.

Dual tone multi frequency DTMF signaling which has been used to indicate insertion points for advertising in analog program streams may also be used to encode segmentation messages along Path 1. The DTMF signals may be inserted into the program stream by uplink system as directed by automation system .

When DTMF signals are used only the most significant segmentation messages are defined. For example a DTMF signal may be assigned to identify the beginning of a program segment. Another DTMF signal may be assigned to indicate that a program segment is about to terminate. To enhance the resiliency of the segmentation each segmentation event is signaled twice at 15 and 5 seconds prior to an event for example. The first and second segmentation messages indicating an event in 15 seconds and 5 seconds respectively to indicate program start and program end may be assigned different respective DTMF signals. If a 5 second segmentation message arrives its timing is used to determine the segmentation position and the 15 second segmentation message is disregarded. If no 5 second message is received then the time indicated by the 15 second message is used.

The DTMF codes preferably also uniquely identify a signal for each service within a transponder. For example if CNN and CNNFn are within the same transponder the program start and program end signals for CNN should be different than the corresponding signals for CNNFn.

When a program not in the schedule is inserted into the content stream signaling of unscheduled start and end of an unscheduled program is used to prevent arriving content from being confused with scheduled content. Different DTMF signals may be assigned to unscheduled start and unscheduled end for 15 seconds prior to the event and 5 seconds prior to the event for example respectively.

Due to the limited number of available signals it is preferred to deliver rights information through an alternate channel. The information may be correlated to programs and program portion based on a schedule. A S processor or asset manager may incorporate the rights messages into stored assets as the assets are created as described above. In addition programs are preferably not assigned unique identifiers. To compensate for the lack of unique identifiers content segments may be treated as a sequence of odd and even pairs. In the typical case signals for an even segment will be followed by signals for an odd segment. If a program is cancelled because of a schedule change for example a program extension causes the following program to be cancelled the cancellation of the program may be indicated by successive signaling of 2 even or 2 odd segments. Alternatively DTMF signals may be used to indicate whether a scheduled program is being delivered within a predetermined window of its scheduled time. The window may be plus or minus 5 minutes for example. Different DTMF signals may be used to identify the start and end of a program within the window on time . Different signals may also be used to identify on time start and end in 15 and 5 seconds respectively or other appropriate time intervals. Other DTMF signals may be used to indicate the start and end of an out of window late program and the start and end of an unscheduled program for two time intervals 15 and 5 seconds .

Arrival of an on time DTMF signal indicates that a scheduled program is to be broadcast. If a sporting event ends 30 minutes late for example a post game show may be canceled and the program scheduled to follow the post game show is delivered on time with on time DTMF signals. If the post game show is to be broadcast then out of window DTMF signals would be included. This would indicate that a scheduled program is being replaced. Where program sequence is maintained out of window signals indicate that an associated program is delayed.

A baseband audio video program stream is provided to distribution amplifier which splits the program stream into a first signal stream that is provided to transmitter for transmission to an antenna not shown . The satellite may broadcast the program stream directly to antennas of TV sets. No segmentation messages are inserted.

In this example the second program stream is provided to XDS CC encoder which inserts segmentation messages in the VBI in XDS format under the control of origination proxy and automation system . The program stream is provided to studio link which is coupled to cable system along fiber optic interconnect for example. The signal stream provided via studio link which may be in digital or analog format may be of higher quality than that transmitted to antennas on TV sets.

Each dish through is coupled to a respective analog satellite receiver IRD through along the respective channel 1 through n. MPEG 2 encoders through receive an output of each respective IRD through . Two outputs of IRD are shown output 1 for baseband audio and video and output 2 for the segmentation messages in RS 232 serial format. One output is provided from IRD along which program streams are received with segmentation messages in the VBI in XDS format where the segmentation messages are integrated with the respective program signal streams.

MPEG encoders through compress the program stream into respective MPEG 2 streams. Segmentation messages in XDS format are extracted from the VBI and converted to DVS 253 messages or another such format and are inserted into the MPEG 2 stream.

Channel m receives program streams via a studio link receiver . The program stream is provided to MPEG 2 encoder which also compresses the program stream into an MPEG 2 stream. As above encoder also extracts XDS segmentation messages converts them to DVS 253 messages and inserts the DVS 253 messages into the MPEG 2 program stream.

Each MPEG encoder through and provide the MPEG 2 stream to staging processor which processes the stream in conjunction with a schedule manager as described above with respect to and . Programs may thereby be stored as assets in asset manager based at least in part on the segmentation messages.

Satellite dish in channel o receives program streams with segmentation messages in DTMF format. Satellite dish is coupled to an integrated receive transcoder IRT . IRT encodes the analog program stream into an MPEG 2 stream which is provided to staging processor along Output 1. A second output of IRT is coupled to receiver which is coupled to segmentation detector . Segmentation detector is coupled to staging processor via an application interface API . The DTMF signals are removed from the program stream by IRT and provided to receiver along Output 2 coordinated in time with the program stream. Receiver provides the DTMF signals to segmentation detector which identifies the segmentation messages and informs staging processor of the value of the DTMF message in coordination with receipt of the program stream by the staging processor. Segmentation detector may also be part of staging processor

Staging processor in conjunction with schedule manager interprets the segmentation messages to segment a program as described above with respect to the operation of A S processor in

The channels 1 through n m and o provided in headend are exemplary. A headend may include none or one or more channels of each type as needed. Other channels may also be provided for receiving compressed digital program streams in MPEG 2 format for example in which case the channel or channels may include the digital IRT discussed in above coupled to the staging processor

As discussed above segmentation messages may be repeated throughout the expanse of a program portion preceding the event to be indicated to ensure that A S processor identifies the message and has time to respond to the message. is a schematic diagram of a program stream marked with segmentation messages in accordance with another embodiment of the invention. In this example each segmentation message indicates a Time from Start time period indicating the time since an event such as the start of a program chapter or advertising and a Time Until End indicating the time until an event such as such as the end of the program end of a chapter or end of advertising. The message also preferably includes a program identification code. The Time Until Start is an optional field.

Segmentation messages may each be local advertising end segmentation messages see for example. As discussed above cable system may insert advertising in place of advertising provided in program stream by a source . The replacement advertisement may be inserted by A S processor or terminal . In segmentation message Time Until End indicates that there are 26.60 seconds until of the end of the advertising portion. Time From Start indicates that the local advertising started 3.40 seconds ago. The next segmentation message which is inserted 2.3 seconds later in program stream in this example indicates a Time Until End of 24.30 seconds. It also indicates a Time From Start of 5.7 seconds. Additional program end segmentation messages are inserted every 2.3 seconds until the end of the advertising.

In this way the end of the advertising portion is precisely defined by multiple messages so that if A S processor or set top terminal miss a message they may receive a subsequent message and still be able to identify the end of the program portion. In addition if terminal is a slow model it may need additional time to respond to a message. Providing multiple messages may provide that additional lead time if necessary.

Segmentation messages may be similarly provided to indicate the end of other portions of the program such as the end of a chapter end of national advertising or end of the entire program as well. The technique of repeating messages may also be used to indicate the start of the program and any of these program portions as well. Providing multiple segmentation messages in the program portion prior to the start of local advertising would be particularly useful for example to ensure that an insertion point for the start of replacement local advertising is not missed. Segmentation messages may be repeated in any portion of program to indicate the start or end of any subsequent portion. Segmentation messages may also be included in a portion of a prior program to indicate the start of the next program or other program portions.

In accordance with this embodiment segmentation messages may be inserted at regular intervals every 2.3 seconds for example or at different intervals based on proximity to the end of the program portion. For example segmentation messages may be separated by greater time periods at the beginning of a program portion and a smaller time period or periods as the end of the program or program portion is approached. If an original program stream is received by headend with only one or a few segmentation messages A S processor may add additional messages for redundancy if desired.

The Time Until End in each segmentation message may be changed if it becomes apparent that a program portion or the program itself will exceed or fall short of the scheduled end time. For example as soon as it is realized that a live event such as a sports event will exceed the scheduled time to end the time inserted in Time Until End field of the segmentation messages may be an anticipated end time of the event. When such a segmentation message is received by downstream devices such as A S processor it will be known that the current program will exceed the scheduled end time and the device may act accordingly. Depending on the program that is exceeding the scheduled end time and the subsequent program the subsequent program may be canceled or postponed for example. A post game show of a sports event may be canceled to avoid canceling or postponing other programs for example. Warning notices may be broadcast to customers informing them of the program going over the scheduled end time and how subsequent programming will be handled so that customers will not be surprised. As the extended program progresses and the end time may be more accurately estimated the Time Until End value may reflect that estimated end time. The messages will be more accurate the closer the segmentation message is to the actual end time of the program.

In another example multiple segmentation messages in accordance with this embodiment may be used where set top terminal runs software that provides a program synchronous user interface such as trigger based advertising. The interface may be shown at specific points in the program and may require lead time for the set top terminal to prepare to process the event. Using segmentation messages in accordance with this embodiment the client software may quickly determine when the next event will take place even if a program is joined in progress. The software can also check earlier sent messages. If a message is missed a subsequent message will provide the necessary information. As discussed above providing a plurality of messages is advantageous for slower models of set top terminals to provide more lead time as well.

Another circumstance where the use of repeating messages in accordance with this embodiment of the invention would be useful is where equipment hardware at the cable system needs to be taken off line or crashes. If new hardware is introduced to replace the original hardware or the original hardware comes back on line it can quickly determine when an event will take place based on the next cue tone.

Lack of receipt of a periodically sent message by a receiver may also quickly indicate a problem in the system upstream of the receiver as well.

The systems disclosed herein are in a form in which various functions are performed by discrete functional blocks. However any one or more of these functions could equally well be embodied in an arrangement in which the functions of any one or more of those blocks or indeed all of the functions thereof are realized for example by one or more appropriately programmed processors.

The foregoing merely illustrates the principles of the invention. It will thus be appreciated that those skilled in the art will be able to devise numerous other arrangements which embody the principles of the invention and thus within the spirit and scope of the invention which is defined in the claims below.

