---

title: Provisioning instant communications for a community of users
abstract: Techniques that enable instant communications services to be provisioned for an online community of users such that the members of the community can interact with each other using instant communications including using instant messaging (IM). In one embodiment, an instant communications facilitator operating from a first domain may provision instant communication services for members of an online community maintained in different domains from the first domain.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09544359&OS=09544359&RS=09544359
owner: Google Inc.
number: 09544359
owner_city: Mountain View
owner_country: US
publication_date: 20140721
---
This application is a continuation of and claims priority to U.S. application Ser. No. 12 606 946 filed Oct. 27 2009 titled Provisioning Instant Communications for a Community of Users which claims priority under 35 U.S.C. 119 of U.S. Provisional Patent Application No. 61 109 117 filed Oct. 28 2008 and entitled System and Method for Community Instant Messaging each of which is incorporated by reference in its entirety.

Embodiments of the present invention relate to enabling instant communications and more particularly to techniques for provisioning instant communication capabilities for a community of users.

The number of online sites that support communities of users has grown exponentially in recent years. A very popular example is FACEBOOK WWW.FACEBOOK.COM social networking community that supports a very large online community of users interested in social networking. A user can become a member of an online community usually by registering with a website supporting that community. Once registered the website provides services that enable the user to interact with other members of the community. In a typical scenario a user identifies a subset of the members of the community as the user s friends or buddies and interacts with the identified friends or buddies.

Due to the increasing popularity of online communities providers of online communities are constantly looking for and offering new and better ways in which members of the community can interact with each other. In such an environment it is desirable that members of a community be able to interact with each other using instant communications including instant messaging IM . However many online communities lack the infrastructure to provide instant communications between its members.

Embodiments of the present invention enable instant communications services to be provisioned for an online community of users such that users of the community can interact with each other using instant communications including using instant messaging IM . In one embodiment an instant communications facilitator operating from a first domain may provision instant communication services for members of an online community maintained in different domains from the first domain.

According to an embodiment of the present invention instant communication services may be provisioned for an online community that enable a member of the online community to exchange one or more messages with another member of the online community using an instant communication technology such as using instant messaging IM . The system provisioning the instant communication may be operating from a domain that is different from the domain under which the online community is maintained.

In one embodiment state information may be stored for a user s instant communication session. The state information is then used to preserve the user s instant communication session across multiple page views. For example a first user interface may be displayed on a first web page accessed by a first member of an online community from a website of the online community. The first user interface may enable the first member to exchange messages with another member of the online community. In one embodiment when the first member accesses a second web page i.e. a different pageview from the website of the online community provider the same first user interface is displayed. This is done based upon the state information stored for the user.

Various different pieces of information may be displayed in an instant communication user interface displayed for a user. The displayed information may include presence information for the user or friends of the user status information for the user or friends of the user one or more notifications received by the user and other like information.

In one embodiment a set of application programming interfaces APIs is provided for facilitating exchange of information between a community provider system and a system facilitating the instant communications. For example a first set of APIs may be provided by the community provider system that is callable by the system facilitating the instant communications. A second set of APIs may be provided by the system facilitating the instant communications that are callable by the community provider system.

In one embodiment the same system may facilitate instant communications for multiple online communities such as for a first online community operating from a first domain and a second online community operating from a second domain different from the first domain. The system facilitating the instant communications may be operating from a third domain that is different from the first and second domains. In one embodiment for a user who is a member of the first online community and the second online community the user may have a first list of friends for the first online community and a second list of friends for the second online community. In such a scenario an aggregated list of friends may be displayed on a first web page accessed by the user from a website of the first online community. The aggregated list of friends may include one or more friends in the first list of friends and one or more friends in the second list of friends.

The foregoing together with other features and embodiments will become more apparent upon referring to the following specification claims and accompanying drawings.

In the following description for the purposes of explanation specific details are set forth in order to provide a thorough understanding of embodiments of the invention. However it will be apparent that the invention may be practiced without these specific details.

Embodiments of the present invention provision instant communication services for members of an online community. As a result of the provisioning the members of the online community are able to send messages to one another using instant communication technologies. Instant communication technologies include technologies that enable the real time delivery of messages between at least one sender and one receiver and may involve maintaining a connection to a service to receive the messages. Examples of instant communication technologies include instant messaging IM presence and status messages multi user chat multi media communication such as voice or video chat the instant delivery of alerts notifications live feeds and other application messages used to create other instant communication applications.

As depicted in system comprises one or more community provider systems CPSs sometimes referred to as partners and an instant communication facilitator provider system ICFS and a user system communicatively coupled with each other via communication network . Each community provider system may support maintain and provide services for a community of users. Examples of community providers include FACEBOOK social networking community FLIXSTER community for information related to movies TWITTER community of users involved in micro blogging MY YEARBOOK social networking community aimed at high school students MYSPACE social networking community AIM instant messaging service service GOOGLETALK instant messaging service and several others. For example in community provider system CPS A may maintain and provide services for a community A of users. Community provider system CPS B may maintain and provide services for another community B of users. Each community provider system may operate from its own website or domain. For example in CPS A is shown as operating from a domain A e.g. www.domainA.com and CPS B is shown as operating from a domain B e.g. www.domainB.com that is different from domain A.

In the embodiment depicted in CPS A operating from domain A includes a web server and a Web Services API application programmer interface server . Web server may be configured to host a website related to the hosted community and serve web pages from the website in response to web page requests. Although only one web server is shown in there may be several web servers in alternative embodiments.

API server may be configured to interact and exchange information with a number of entities using a set of application programmer interfaces APIs . In one embodiment API server is configured to interact with ICFS using a set of Web Service APIs to provide instant communication services for users of community A as described below in further detail. CPS A may also store and manage information related to members of community A.

It should be noted that the components of CPS A depicted in and described above merely provide an example of a community provider system and is not intended to unduly limit the scope of the claims. One of ordinary skill in the art would recognize many variations alternatives and modifications. Further the system of one community provider may be different from the system of another community provider.

A user may connect to start a session with a website of a community provider system. During the session the user may access one or more web pages served from the website of the community provider system. For example a user may use an application such as browser executing on user system to log onto and open a session with a website of a community provider system e.g. CPS A and or CPS B and access one or more web pages served by that website. Examples of commonly used browsers include Windows Internet Explorer Mozilla Firefox Apple Safari Google Chrome Opera and others. A user may request a web page by providing a uniform resource locator URL corresponding to the web page to the browser or by clicking on a link in a web page. The requested web page corresponding to the URL or the clicked link is then fetched and output or rendered to the user by the browser.

For example a user using browser executing on user system may access web pages served by web server of CPS A . The user may use these web pages to become a member of community A maintained by CPS A . Information regarding users that are members of community A may be stored by CPS A in community members information . After becoming a member of community A the user may identify a subset of members of community A as the user s friends or buddies. The user may then interact with the user s friends. A list of friends of the user is commonly referred to as the user s friend list or buddy list . Information related to a user s friend list may be stored and maintained by CPS A as part of community members information . The user may add friends or delete previously identified friends as desired.

A user may be a member of multiple online communities. For example a user may be a member of community A maintained by CPS A and a member of community B maintained by CPS B . The user may have a friend list specific to each online community. Accordingly the user may have one friend list for community A and another friend list for community B. In this manner a user may be a member of several online communities with a friend list specific to each community identifying a subset of members of that community.

According to an embodiment of the present invention ICFS is configured to provision instant communication services for users members of one or more online communities. For example for the embodiment depicted in ICFS may provide instant communication capabilities to user members of community A supported by CPS A . ICFS may also provide instant communication capabilities to user members of community B supported by CPS B . In this manner ICFS may provide and enable instant communications for users of multiple online communities. Since the instant communication capabilities are provided by ICFS a community provider e.g. CPS A for community A does not have to itself invest in or host an infrastructure for providing instant communication capabilities for its members. The instant communication services are outsourced from ICFS .

ICFS may operate under its own domain e.g. www.icfs.com that is different from the domains of the community provider systems for whom the instant communication capabilities are provided. For example as depicted in ICFS operates from domain C that is different from domain A of CPS A and domain B of CPS B . In this manner instant communication services are provisioned by a first domain for a community of users maintained by a second domain that is different from the first domain. In one embodiment ICFS is provided by Meebo Inc. of Mountain View Calif. and operates under the domain meebo.com. From a user s perspective the fact that the instant communication services are being hosted by a third party facilitator rather than the community provider system is transparent to the user meaning that a user cannot detect any difference between a community provider system hosted instant communication solution and an instant communication solution hosted by ICFS .

Since the system facilitating instant communication services and the system maintaining the community of users for which the services are provisioned operate under different domains special techniques are used for communication of information between ICFS and a community provider system. The normal practice for making cross domain XHR XmlHttpRequest requests is a practice called jsonp json with padding . A scripting language such as JavaScript running in the context of domain A in the user s browser makes a script tag request to a URL on domain B with the data for the request and the name of a function referred to as the callback function. The server response contains a JavaScript expression that calls the callback function with the response data as the argument to the callback function. Since the call was initiated using a script tag the browser evaluates the response executing the callback function with the response data. As an example if the browser makes a request to the server with the callback function processCommand and if the server wants to return the string literal Hello the jsonp response would be

In one embodiment the cross domain communication problem can be avoided by having the community provider system create a DNS record as a subdomain of their main domain pointing to ICFS servers. This avoids the cross domain rules since the requests are from CPS.com to ICFS.CPS.com . This however substantially increases the complexity of the deployment for the community provider system. This solution is also not very scalable. It should be noted that the jsonp and requestid implementations are not necessary with recent browser technology. Current browsers support cross origin messaging through a postMessage method which allows frames on separate domains to communicate securely within the browser. Using postMessage local XHRs in a frame on the ICFS domain can be used and the results are posted back to the parent frame on a separate domain. Many browsers also support cross domain XHRs directly. A large population of users however continues to use older browsers that do not have support for these technologies. In one embodiment the technique used for cross domain communications is selected based on what the browser supports. For newer browsers the new methods may be used while for old browsers the jsonp method described above may be used.

In one embodiment a set of Web Service APIs application programming interfaces are provided that enable a community provider system and ICFS to communicate and exchange information with each other to enable the instant communication services. The Web Service APIs comprise a set of Web Service APIs provided by the community provider system referred to as CPS APIs and a set of Web Service APIs provided by ICFS referred to as ICFS APIs . The CPS APIs comprise APIs that ICFS may call to get information from or post information to a community provider system. CPS APIs may also include APIs that ICFS may call to cause the community provider system to perform an operation. The ICFS APIs comprise APIs that a community provider system may invoke to get information from or post information to ICFS . ICFS APIs may also include APIs that a community provider system may call to cause ICFS to perform a task or operation.

Processing related to handling of APIs is performed by API servers present in the community provider system and in ICFS . As previously described CPS A comprises an API server . As depicted in ICFS comprises an API server . API server may be configured to interact and exchange information with one or more entities using one or more sets of APIs. In one embodiment API server is configured to interact and exchange information with a community provider system using a set of Web Service APIs.

In one embodiment API server is configured to communicate with one or more servers of a community provider system including with API servers e.g. API server of CPS A of the community provider system. In one embodiment API server is configured to call CPS APIs provided by a community provider system and process responses received in response to the API calls. Requests to server of a community provider system may also be made by instant communication infrastructure . For example API server may invoke a CPS API provided by CPS A . The call is communicated to API server of CPS A . API server may then perform processing corresponding to the API call generate a response and communicate the response to API server of ICFS . The response may be communicated in different ways. According to one way the response is communicated as a direct response to the request which is returned directly to the requesting server. According to another way the response is communicated as a separate request to the other partner s API servers. ICFS may then perform further processing based upon the response received from the community provider system. API server is also configured to receive CPS API calls invoked by other community provider systems perform processing corresponding to the CPS API calls generate responses for the calls and communicate the responses to the API server of the calling community provider system. For example API server may receive an ICFS API call from API server of CPS A . API server may then perform processing corresponding to the call generate a response and communicate the response to API server of CPS A .

The API servers on the community provider systems and ICFS function as receiving points. Requests can be made to them by any of the other party s servers.

As depicted in ICFS may also comprise an instant communication infrastructure that implements instant communication sessions for a community of users. For example instant communication infrastructure may support IM chat sessions between members of a community. Instant communication infrastructure may comprise one or more IM gateways and one or more chat servers e.g. Jabber servers that facilitate the chat sessions.

In the embodiment depicted in instant communication infrastructure is hosted by ICFS . However instant communication infrastructure needed not be hosted by ICFS . In alternative embodiments the instant communication infrastructure may be hosted by third party servers or even servers of a community provider system. In such an embodiment ICFS may provide an IM gateway that is configured to communicate with IM servers that may be hosted by a third party. For example a community provider system may provide the instant communication infrastructure. In such an embodiment the instant communication infrastructure of the community provider system may be used for supporting instant communication among members of the community provider instead of using ICFS instant communication infrastructure . In such an embodiment ICFS may connect to the community provider system and use them as the conduit for delivering IMs. A user member of the community provided by the community provider system may be authenticated by ICFS e.g. using a username and password as described below and a friend list may be retrieved for the user but in order to send a message ICFS sends it to the community provider system s IM network servers.

As described above ICFS enables instant communication sessions between user members of a community. In one embodiment ICFS is configured to store session state information associated with instant communication sessions between members of a community. In one embodiment ICFS is configured to store instant communication session state information for each community member participating in an instant communication session. The instant communication session status information stored for a member of a community may comprise information such as a status information for the member e.g. available busy etc. which describes the manner in which a user is online This can include for example status messages where a user can say something like Thank goodness it is Friday b presence information for the member including information indicating whether the member is online or offline c information related to messages sent by or received by the member d information related to notifications received by the member e a session ID for the user f information related to the user s friends including status of the friends g the user s profile information such as information about the user the user s name a photo icon to be displayed for the user etc. and h other information related to the member user s session. As described below in further detail the session state information stored by ICFS is used by ICFS to preserve the state of a user s instant communication session across multiple page views served to the user from the website of a community provider system.

The various systems depicted in may communicate with each other via communication network . Communication network may be any network that enables communications between the various systems. Examples of communication network include an Intranet a local area network LAN a wide area network WAN an Ethernet network and the like or combinations thereof. Different communication protocols including wired and wireless protocols may be used for data communications over network including but not limited to TCP IP SNA IPX AppleTalk IEEE 802.XX suite of protocols the Bluetooth protocol and or other protocols or combination of protocols.

At a high level enabling instant communication for a community of users involves design time actions that are taken by the online community provider and runtime processing that is performed when a user member of the community logs into the community provider s website and accesses web pages served from the website. In one embodiment as part of the design time actions the online community provider associates special code or instructions with each web page served from the community provider s website. This special code is executed at runtime when the web page is loaded by a browser executing on a user system and enables instant communication services for the user that enable the user to exchange messages with other members of the online community.

In one embodiment the code that is associated with web pages served by an online community provider system comprises a piece of JavaScript that is added to pages served from the website of the community provider system. An HTML file that is used by the JavaScript code is also placed in a location accessible to the JavaScript code. The HTML file may be placed on a web server of the community provider system or alternatively may be placed on ICFS .

In one embodiment the following JavaScript code is associated with web pages. The code may be placed immediately after the tag of the web page. This is done so that the JavaScript has ample time to load while the web page loads simultaneously.

As can be seen from the JavaScript the code writes an IFRAME and sets up communication with the IFRAME. The IFRAME is used to asynchronously load the JavaScript code in the HTML file. By loading the code asynchronously the impact of loading the code on the web page loading is minimized. Using an IFRAME ensures that if the ICFS servers are slow or break the web page served from the community provider s website continues to load and function like normal. Using an IFRAME also helps to avoid name collisions between the JavaScript code and the code on the web page. Once the JavaScript code has loaded on a web page served from a website of a community provider system it creates a user interface the user interface that enable instant communication e.g. instant communication user interface depicted in and described below also defines a set of APIs JavaScript APIs for the webpage to interface with creating new functionality that is better integrated with the user experience. These APIs may be used for communicating with ICFS . For example the web page may display a list of members of the community that when clicked on will call a JavaScript API to create an IM window to start talking to that user. This enables a user to interact with the chat system by interacting with the web page. The web page can essentially call JavaScript API s to start a conversation share content such as photos videos text and links configure the user interface by enabling or disabling features and so on. The JavaScript APIs allow JavaScript code on the webpage from a community provider system e.g. CPS A running in the browser to interact with JavaScript code from ICFS running in the same browser. The APIs allow the community provider web page to perform actions such as opening an IM window or sharing content when a user clicks on parts of the partner page. While the embodiment described above uses JavaScript in alternative embodiments the code associated with a web page may be in any other language including any scripting language.

Runtime processing may be initiated when a user who is a member of a community uses an application such as a browser executing on a user system to request a web page from a website of a community provider system step . The user may request the web page by providing the URL for the web page to the browser. Alternatively the web page may be requested as a result of the user clicking on a link on another web page already loaded by the browser.

The web page requested by the user is then served to the user system from the community provider s website step . The browser executing on the user system then loads and displays the received web page step . Several processing steps are triggered by the loading of the web page. As a result of the loading the special code e.g. JavaScript code associated with the web page is executed step and causes code to be loaded that enables instant communication services. As described above in one embodiment loading of the code on a web page served from a website of a community provider system creates a user interface the user interface that enable instant communication e.g. instant communication user interface depicted in and described below also defines a set of APIs JavaScript APIs for the webpage to interface with creating new functionality that is better integrated with the user experience. These APIs may be used for communicating with ICFS .

The user requesting the web page is then authenticated to determine whether instant communication capabilities are to be provisioned for the user step . Upon successful authentication an instant communication session is enabled for the user and a user interface that enables instant communication capabilities for the user is rendered on the same web page that is displayed to the user step . In one embodiment a user interface such as the user interface depicted in and described below is displayed to the user.

As depicted in the JavaScript that is associated with a web page accessed by a user from the community provider s website and executed by the user system upon loading of the web page causes user information to be communicated from the user system to ICFS step . As described above in one embodiment loading of the code on a web page served from a website of a community provider system creates a user interface the user interface that enables instant communication e.g. instant communication user interface depicted in and described below also defines a set of APIs JavaScript APIs for the webpage to interface with creating new functionality that is better integrated with the user experience. These APIs may be used for communicating with ICFS .

In one embodiment the user information is stored on the user system by the community provider system when the user successfully logs on to the website of the community provider system. The user information may be stored in the form of a cookie on the user system. In such an embodiment information from the cookie is communicated from the user system to ICFS in . When a user ends the session with the community provider website e.g. when the user logs out from the community provider website the cookie stored on the user system is cleared.

The user information communicated to ICFS in comprises information that can be used to authenticate the user. In one embodiment the user information that is communicated comprises a user identifier UID that uniquely identifies the user and an authentication token. The token may be unique to both the user and the user s session with the community provider s website. An example of a token is a hash of the user s ID and either a session key if already created or the time stamp of the user s last login in the community provider website. The token should be valid for at least as long as the user s session on the community provider system is valid.

The user information received by ICFS from the user system in is then communicated to the community provider system for authentication step . APIs provided by the community provider system may be used by ICFS to request the authentication. The community provider system then authenticates the user based upon the user information received from ICFS step . In one embodiment as part of the authentication the community provider system checks if the user identified by the user information is part of the community maintained by the community provider system.

ICFS then receives an authentication response from the community provider system step . ICFS then checks to see if authentication response received from the community provider system indicates a successful authentication step . If it is determined in that authentication was not successful then the processing ends and instant communication services are not enabled for the user. If it is determined in that authentication was successful then processing continues with step .

Upon successful authentication the user is logged on to ICFS step . In this manner the user is automatically logged on to ICFS without the user having to perform an explicit logon procedure with ICFS . ICFS then initiates an instant communication session for the user step . ICFS receives a friend list for the user from the community provider system step . In one embodiment the friend list is received as part of a successful authentication response in . In another embodiment ICFS may invoke an API provided by the community provider system to request the friend list for the user. The friend list is then communicated from the community provider system to ICFS in the response to the API call.

ICFS then causes a user interface that enables instant communication capabilities for the user to be rendered on the web page accessed by the user step . In one embodiment the user interface is overlayed on the web page displayed to the user. In this manner the user interface for enabling instant communications is displayed on the same page served to the user from the community provider system. In one embodiment the user interface comprises a bar comprising tools and showing status of the user s instant communication session. The user s friend list received in may also be displayed as part of the user interface.

In user interface comprises a first section comprising a set of content sharing tools. The content sharing tools may include user selectable tools that enable content from the displayed web page or the web page itself to be shared with other members of the community. User interface comprises a second section that shows the status of the user s friends in the online community. In the example depicted in none of the user s friends i.e. no one from the user s friend list are online as indicated by the No Friends Online status.

Once one or more of the user s friends come online the status displayed by section is updated to reflect who is online. For example as depicted in the status displayed in section of user interface has been updated to reflect that three of the user s friends are now online. User interface is updated to display another area window that displays a list of friends who are online. As depicted in each friend is identified by the friend s username or real name . Further presence information and status information is displayed for each friend. Presence information may indicate whether the friend is online or offline. In one embodiment for each instant communication session for a user ICFS stores presence information and status for the user and also for each friend in the user s friend list. Status information may be set by the friend to reflect the friend s status such as available busy watching movie do not disturb etc. The name of the user and the user s status are also displayed.

In one embodiment the community provider system uses APIs provided by ICFS to convey information to ICFS about the status of the user s friends. Based on the status information received from the community provider system ICFS causes the status information for the user s friends to be updated in user interface .

The user may decide to open a chat session with one or more friends displayed in window . In one embodiment the user may open a chat session with a friend by clicking on the friend s name in window . For example as depicted in the user has opened a chat session with Friend . As a result user interface is updated to display an IM chat window in which the user can send messages to Friend  and receive messages sent by Friend . A section is also displayed in the bar section of user interface to identify the friend with whom the user service is having a chat. A chat session may also be initiated by another user who sends a message to the first user. This will also cause chat window to appear.

After an instant communication session has been initiated for a user member of a community ICFS stores session state information for the instant communication session. Accordingly for a community of users ICFS stores session state information for each member user involved in an instant communication session. In one embodiment this information is stored as part of communication session state information depicted in . As previously described in one embodiment the instant communication session status information stored for a member of a community may comprise information such as a status information for the member e.g. available busy etc. b presence information for the member identifying a state related to the user s presence e.g. whether the member is online or offline etc. c information related to messages sent by or received by the member d information related to notifications received by the member e a session ID for the user f information related to the user s friends including status of the friends g the user s profile information such as information about the user the user s name a photo icon to be displayed for the user etc. and h other information related to the member user s session.

The instant communication session state information stored by ICFS for a user enables ICFS to cause the state of the user interface displayed to a user to be maintained or preserved across multiple page views served from the website of the community provider system to the user. For example the current state of the instant communication user interface for a user may be as shown in wherein instant communication user interface is rendered on a web page WebPage  . The user may subsequently access another web page served from the website of the community provider website. For example as depicted in the user has accessed WebPage  served from the website of the community provider system. The URL corresponding to the second web page is displayed in . Based upon the instant communication session state information stored for the user ICFS causes the instant communication user interface that was rendered on WebPage  to be also rendered on WebPage . In this manner the state of the instant communication user interface is maintained across multiple page views. The multiple page views may be pages that are sequentially accessed by the user or multiple pages that are concurrently loaded by the browser in different tabs. Accordingly the session state information stored by ICFS is used by ICFS to preserve the state of a user s instant communication session across multiple page views served to the user from the website of a community provider system. The session state information may also be used to synchronize state between sessions on separate computers.

The method may be triggered when ICFS receives an indication that the user has accessed a new web page from the website of a community provider system step . In one embodiment ICFS receives a notification from the community provider system whenever a new web page is accessed by the user from the website of the community provider system. In another embodiment ICFS may receive a signal from the user system indicating that the user is viewing a new page view. ICFS then retrieves the instant communication session state information stored for the user for the community provider system step . ICFS then causes an instant communication user interface to be rendered on the new web page based upon the state information retrieved in step . In one embodiment the user interface is overlayed on the newly accessed web page. The user interface that is displayed to the member thus preserves the state of the member s instant communication session. This enables the state of a user s instant communication session to be preserved across multiple page views served from the community provider system. The multiple page views may correspond to web pages accessed sequentially by the user. The multiple page views may also include different web pages that may be loaded concurrently in different tabs of a browser.

In one embodiment notifications sent to a user by another community member e.g. a friend in the user s friend list may also be delivered and displayed to the user via the instant communication user interface. A notification typically takes the form . For example a notification might be Friend  has challenged User  to a Sudoku game. Here the subject is Friend  and the predicate is has challenged User  to a Sudoku game. The subject may be another user member of the community maintained by the community provider system who the recipient user may wish to hear notifications about. In one embodiment in order to reduce spamming of notifications a notification from a community member is only delivered to the user if the subject is in the user s friend list or the user is mentioned in the predicate. The predicate of a notification message may be a text string that may contain html links. For example the word Sudoku game in the above example might be a link to a page corresponding to the Sudoku game.

In one embodiment ICFS receives notifications for a user from the community provider system. For example when a user has been successfully authenticated the community provider system may communicate a set of notifications for the user to ICFS . These notifications are then displayed in the instant communication user interface rendered on the web page displayed to the user. In one embodiment ICFS automatically turns the subject s name in a notification message into a link which when selected by the user enables the user to begin an IM conversation with the subject. ICFS may regularly poll the community provider system or other data sources storing or having access to the notifications for new notifications that are received for the user. The instant communication user interface is then updated to display the new notifications.

In one embodiment each notification is assigned a unique id by ICFS . ICFS uses these notification ids to avoid displaying duplicate notifications. Once a notification has been received by ICFS and displayed to the user ICFS may notify the community provider system as to which notifications have been displayed. Accordingly when the community provider system receives a request from ICFS for notifications for the user only the new notifications are communicated by the community provider system to ICFS .

ICFS may use APIs provided by the community provider system to request information related to notifications and to notify the community provider system of notifications that have been displayed to the user. The community provider system may use APIs provided by ICFS to convey notifications related information to ICFS . Details related to APIs that may be used are provided below.

As indicated above a set of Web Service APIs are provided that enables a community provider system and ICFS to communicate with each other. The Web Service APIs include a set of community provider Web Service APIs CPS APIs and a set of ICFS Web Service APIs ICFS APIs . The CPS APIs comprise APIs that ICFS may call to request information from or communicate information to a community provider system. CPS APIs may also include APIs that ICFS may call to cause the community provider system to perform a task or operation. The ICFS APIs comprise APIs that a community provider system may invoke to request information from or communicate information to ICFS . ICFS APIs may also include APIs that a community provider system may call to cause ICFS to perform a task or operation.

In one embodiment the ICFS APIs allow a community provider system to make calls to ICFS to notify ICFS of events such as 

In one embodiment a community provider system may make requests to the ICFS APIs over HTTPS. Access to ICFS APIs may be restricted to a specific community provider. ICFS authenticates HTTP requests received from a community provider system using HTTP authentication via a username and password provided to the community provider system. A community provider system may make calls to URLs of the form 

So for example a community provider system may notify ICFS of a friend addition to a user s friend list by making a request to the URL 

An ICFS API call made by a community provider system may generate a response from ICFS to the calling community provider system. In one embodiment all commands return a JSON formatted string. Non ASCII characters may be encoded using the utf 8 character set. Each response comprises a status field stat field which takes on a string value of either OK or FAIL . A FAIL value is returned when ICFS is unable to process the command requested by the community provider system. This may be due to an invalid command or some other error at ICFS . When a failure occurs the response may additionally include the following fields 

An OK is returned when the command requested by the community provider system is properly handled by ICFS . An OK response may also additionally include the following field 

The following section describes various actions that may be performed by making calls to ICFS APIs. These APIs are merely examples and are not intended to limit the scope of the invention as recited in the claims.

When an online user s status message changes the community provider system may notify ICFS of the change by making a POST request to 

In one embodiment an image may be displayed for a user in the user interface for instant communications. When an online user s image changes a community provider system may notify ICFS of the change by making a POST request to 

A community provider system can deliver notifications about users friends activities to one or more online users. Notifications may take the form . For example a notification might be Chris sent you a message. The subject is Chris and the predicate is sent you a message. The subject may be another user member of the community maintained by the community provider system who the recipient user may wish to hear notifications about. The predicate is a text string that can contain html links. For example the word message might be a link to the page where the user can view the message. ICFS automatically turns the subject s name into a link which enables a user to begin an IM conversation with the subject. Notifications are typically only sent to a user if the subject is in the user s friend list or the user is in the predicate. In one embodiment two types of notifications may be delivered 

When a user logs out of the website provided by a community provider system the community provider system may send a notification to ICFS so that ICFS can end the user s instant communication session. To do so the community provider system may make a POST request to 

A community provider system may obtain a count of the number of users from the community maintained by the community provider system that are currently logged in in instant communication sessions facilitated by ICFS . The community provider system may obtain this information my making a GET request to 

ICFS is configured to maintain presence information for each user of a community involved in an instant communication session facilitated by ICFS . A community provider system may find out the login status of particular users by making a GET request to 

In one embodiment the CPS APIs allow ICFS to request information from a community provider system and to cause certain operations to be performed by the community provider system. For example ICFS may call these APIs to perform operations such as 

In one embodiment ICFS may make requests to the CPS APIs over HTTPS. Access to CPS APIs may be restricted to ICFS . ICFS authenticates HTTP requests using HTTP authentication via a username and password provided by the community provider system. ICFS may make calls to URLs of the form 

A CPS API call made by ICFS may generate a response from ICFS to the calling community provider system. In one embodiment all commands return a JSON formatted string. Non ASCII characters may be encoded using the utf 8 character set. Each response comprises a status field stat field which takes on a string value of either OK or FAIL . A FAIL value is returned when the community provider system is unable to process the command requested by ICFS . This may be due to an invalid command request or some other error at the community provider system. When a failure occurs the response may additionally include the following fields 

An OK is returned when the command requested by the community provider system is property handled by ICFS . An OK response may also additionally include the following field 

The following section describes various actions that may be performed by making calls to CPS APIs. These APIs are merely examples and are not intended to limit the scope of the invention as recited in the claims.

As previously described ICFS authenticates a user prior to enabling instant communications for the user. In one embodiment ICFS may authenticate a user using one of the following 

In one embodiment when a user authenticates the community provider system may choose to return a community provider session key. This community provider session key may be provided as a parameter to subsequent requests associated with this user s session. In this way the community provider system can use the session key as an authentication mechanism for subsequent requests. It should be noted that this authentication mechanism is optional.

 stat ok data authenticated true uid uidvalue name Person s name community provider system sessionkey community provider system sessionkeyvalue 

where uidvalue is the user s UID name is the user s friendly name community provider system sessionkey is an optional session key assigned by the community provider system. If the community provider system requires it for authentication for subsequent requests it should be included otherwise it may be omitted.

 stat ok data authenticated true uid uidvalue name Person s name community provider system sessionkey community provider system sessionkeyvalue 

where uidvalue is the user s UID name is the user s friendly name community provider system sessionkey is an optional session key assigned by the community provider system. If the community provider system requires it for authentication for subsequent requests it should be included otherwise it may be omitted.

 stat ok data authenticated true uid uidvalue name Person s name community provider system sessionkey community provider system sessionkeyvalue 

where uidvalue is the user s UID name is the user s friendly name community provider system sessionkey is an optional session key assigned by the community provider system. If the community provider system requires it for authentication for subsequent requests it should be included otherwise it may be omitted.

In order to get a user s friend list from a community provider system ICFS may make a GET request to the getfriends method at 

There are 2 types of successful responses that are possible and the type of response is indicated by the friendresponse field of the data object. If the community provider system wishes to indicate that the friend list is up to date based on the timestamp provided and no changes are necessary the resulting message may be 

If the community provider system wishes to return the full friend list because the list is out of date according to the timestamp a timestamp was not provided by ICFS or the community provider system does not support tracking a last updated time for the friend list the resulting message may be of the form 

To get information about a user from a community provider system ICFS may make a GET request to the getinfo method at 

 stat ok data Imagedata base64encodedstring imagetype imagetypestring status user s status age 21 gender m 

Each notification JSON object may contain the fields type notificationid timestamp subjectuid subjectname predicate. For example a single notification object might take the form 

 type friend notificationid 12345abc timestamp 1220468495 subjectuid abc123 subjectname John Doe predicate sent you a message 

ICFS may notify the community provider system when a user changes their status message in the IM interface. The community provider system may optionally use this information to update the user s status on their site but doing so is not required. If a community provider system does not wish to support this it can simply return a stat ok message in response to all requests for this URL. ICFS client may make a POST request to the statuschange method at 

An ok stat response does not guarantee that the community provider system acted on the information but simply that it received a properly formatted request.

ICFS may report to the community provider system when a notification is read. If a community provider system chooses to store notifications it can use this information to discard the notifications that have been read. Note that acting on this information is completely optional if a community provider system does not wish to support this it can simply return a stat ok message in response to all requests for this URL.

An ok stat response does not guarantee that the community provider system acted on the information but simply that it received a properly formatted request.

Community provider system sites may choose to allow users to IM with other users who are not friends of the users. If so users may wish to add friends when chatting with them. ICFS may provide a button in the IM window when a user is chatting with a non friend to allow them to send an add friend request. ICFS will make a call to the community provider system APIs when the user clicks the button. The community provider system can then use the information to generate an add friend request to the other user or if the other user has already sent an add friend request the community provider system may choose to treat it as an approval of the add friend request.

This API call is only a request for a friendship. It is up to the community provider system to determine whether users should be treated as friends as a result of the call. If a new friend should be added to a user s friend list as a result of this call then the community provider system makes a call to the addfriend method of the ICFS API described above .

Acting on this information is completely optional if a community provider system does not wish to support this it can simply return a stat ok message in response to all requests for this URL.

An OK stat response does not guarantee that the community provider system acted on the information but simply that it received a properly formatted request.

ICFS may report to the community provider system when a user has blocked another user from sending them IMs. The community provider system can choose whether to take any action based on this notification e.g. disable accounts with excessive reports block the user from seeing the other user s profile etc. . Acting on this information is completely optional if a community provider system does not wish to support this it can simply return a stat ok message in response to all requests for this URL.

An OK stat response does not guarantee that the community provider system acted on the information but simply that it received a properly formatted request.

ICFS may report to the community provider system when a user has reported abusive behavior from another user. The community provider system can choose whether to take any action based on this notification. Acting on this information is completely optional if a community provider system does not wish to support this it can simply return a stat ok message in response to all requests for this URL.

In one embodiment the cony parameter is a serialized JSON list of objects where each object represents one IM from the conversation. Each IM object may comprise the following fields 

The following is an example of the format of the cony parameter. It contains a conversation with two lines the first sent to the user and the second sent by the user who is reporting the abuse.

An OK stat response does not guarantee that the community provider system acted on the information but simply that it received a properly formatted request.

A user can be a member of multiple communities maintained by multiple community provider systems. For example in the embodiment depicted in a user may be a member of community A maintained by CPS A and a member of community B maintained by CPS B . The user may have a different friend list for each user. In one embodiment ICFS may also maintain its own community and the user may be a member of that community also.

ICFS may provision instant communication services for the multiple communities of which the user is a member. The user may be concurrently logged in to websites of multiple community provider systems. Accordingly a user may be involved in multiple sessions with different community provider systems. These multiple sessions may be on the same computer or on different computers. For each session with a community provider system the user may also be involved in an instant communication session facilitated by ICFS . Accordingly a user may be involved in multiple instant communication sessions at the same time.

For example the user may be logged into the websites of CPS A for community A and CPS B for community B . Since ICFS provisions the instant communication services for both of these communities the user may be involved in an instant communication session for CPS A and an instant communication session for CPS B both instant communication sessions being facilitated by ICFS . Since ICFS stores session state information for each instant communication session ICFS may store instant communication session state information for the user s instant communication session with CPS A and also for the user s instant communication session with CPS B.

In one embodiment ICFS may use the state information stored for a user s instant communication session with one community to affect the user s instant communication session for another community. For example for a particular user logged into a session with CPS A and CPS B ICFS may use the instant communication session state information stored for the user for CPS B to affect the instant communication services session of the user for CPS A. Alternatively ICFS may use the instant communication session state information stored for the user for CPS A to affect the instant communication services session of the user for CPS B.

For example the session state information stored by ICFS for a user s instant communication session for a particular community website includes information identifying the user s friend list. Accordingly for a user participating in multiple sessions for multiple communities ICFS has knowledge of the user s friend list for each of the multiple communities. In one embodiment ICFS may aggregate the friend lists from the multiple sessions and push the aggregated friend list to the user for each of the sessions. For example for a user logged into CPS A and CPS B ICFS has information about the user s friend list for community A friend list A and the user s friend list for community B friend list B . In one embodiment ICFS may combine friend list A and friend list B to create an aggregated friend list. The aggregated friend list may then be pushed by ICFS to the user s instant communication session for community A and also for community B. Accordingly for a web page accessed by the user from the website of CPS A the instant communication user interface rendered on the web page may list the aggregated list of friends including the user s friends from community A and the user s friends from community B. This enables the user to have an IM chat not only with friends from community A but also with friends from community B. Other types of information included in each session state information e.g. notifications presence status etc. may also be aggregated and pushed to the user in a like manner.

In one embodiment ICFS can display friends and provision an instant communication session for a community provider system e.g. CPS B with or without the user being on the site of CPS B at the current time. ICFS may also provide an instant communication session with traditional IM networks such as AIM GoogleTalk etc.

Bus subsystem provides a mechanism for letting the various components and subsystems of computer system communicate with each other as intended. Although bus subsystem is shown schematically as a single bus alternative embodiments of the bus subsystem may utilize multiple busses.

Network interface subsystem provides an interface to other computer systems and networks. Network interface subsystem serves as an interface for receiving data from and transmitting data to other systems from computer system . For example network interface subsystem may enable a user computer to connect to the Internet and facilitate communications using the Internet.

User interface input devices may include a keyboard pointing devices such as a mouse trackball touchpad or graphics tablet a scanner a barcode scanner a touch screen incorporated into the display audio input devices such as voice recognition systems microphones and other types of input devices. In general use of the term input device is intended to include all possible types of devices and mechanisms for inputting information to computer system .

User interface output devices may include a display subsystem a printer a fax machine or non visual displays such as audio output devices etc. The display subsystem may be a cathode ray tube CRT a flat panel device such as a liquid crystal display LCD or a projection device. In general use of the term output device is intended to include all possible types of devices and mechanisms for outputting information from computer system .

Storage subsystem provides a computer readable storage medium for storing the basic programming and data constructs that provide the functionality of the present invention. Software programs code modules instructions that when executed by a processor provide the functionality of the present invention may be stored in storage subsystem . These software modules or instructions may be executed by processor s . Storage subsystem may also provide a repository for storing data used in accordance with the present invention. Storage subsystem may comprise memory subsystem and file disk storage subsystem .

Memory subsystem may include a number of memories including a main random access memory RAM for storage of instructions and data during program execution and a read only memory ROM in which fixed instructions are stored. File storage subsystem provides persistent non volatile storage for program and data files and may include a hard disk drive a floppy disk drive along with associated removable media a Compact Disk Read Only Memory CD ROM drive an optical drive removable media cartridges and other like storage media.

Computer system can be of various types including a personal computer a portable computer a workstation a network computer a mainframe a kiosk a server or any other data processing system. Due to the ever changing nature of computers and networks the description of computer system depicted in is intended only as a specific example for purposes of illustrating the preferred embodiment of the computer system. Many other configurations having more or fewer components than the system depicted in are possible.

Although specific embodiments of the invention have been described various modifications alterations alternative constructions and equivalents are also encompassed within the scope of the invention. Embodiments of the present invention are not restricted to operation within certain specific data processing environments but are free to operate within a plurality of data processing environments. Additionally although embodiments of the present invention have been described using a particular series of transactions and steps it should be apparent to those skilled in the art that the scope of the present invention is not limited to the described series of transactions and steps.

Further while embodiments of the present invention have been described using a particular combination of hardware and software it should be recognized that other combinations of hardware and software are also within the scope of the present invention. Embodiments of the present invention may be implemented only in hardware or only in software or using combinations thereof.

The specification and drawings are accordingly to be regarded in an illustrative rather than a restrictive sense. It will however be evident that additions subtractions deletions and other modifications and changes may be made thereunto without departing from the broader spirit and scope as set forth in the claims.

