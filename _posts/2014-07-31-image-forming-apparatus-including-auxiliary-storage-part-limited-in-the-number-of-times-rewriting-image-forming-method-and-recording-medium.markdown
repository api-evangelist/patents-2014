---

title: Image forming apparatus including auxiliary storage part limited in the number of times rewriting, image forming method, and recording medium
abstract: Provided is an image forming apparatus that speeds up starting. The image forming apparatus is provided with a main storage part and an auxiliary storage part. A boot loader that is stored in the auxiliary storage part is expanded to the main storage part. The boot loader that has been expanded is executed to generate a defective area table for the auxiliary storage part. When a kernel of an OS that is stored in the auxiliary storage part is expanded, the kernel is caused to be referred the defective area table that has been generated. When the kernel is executed, the defective area table is not generated. Thereby, the defective area table generated by the boot loader can be used by the OS, which allows the boot time to be shortened.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09485379&OS=09485379&RS=09485379
owner: KYOCERA Document Solutions Inc.
number: 09485379
owner_city: Osaka
owner_country: JP
publication_date: 20140731
---
This application is based on and claims the benefit of priority from Japanese Patent Application No. 2013 158822 filed on Jul. 31 2013 the contents of which are hereby incorporated by reference.

The present disclosure relates to an image forming apparatus an image forming method and a recording medium and particularly to an image forming apparatus including an auxiliary storage part an image forming method and a recording medium.

A typical image forming apparatus such as a printer or a Multifunctional Peripheral MFP can print a document or an image.

Some image forming apparatuses are provided with an auxiliary storage part. In the auxiliary storage part the number of times of rewriting may be limited or a part of the area for storage may be physically damaged. Therefore it is necessary to detect a defective area.

According to one aspect of the present disclosure an image forming apparatus including a main storage part and an auxiliary storage part is provided. A boot loader expanding part causes a boot loader that is stored in the auxiliary storage part to expand in the main storage part. A defective area table preparing part executes the boot loader expanded by the boot loader expanding part to generate a defective area table for the auxiliary storage part. A kernel defective area referencing part causes a kernel of an OS to be referred the defective area table generated by the defective area table preparing part. When kernel is executed the defective area table is not generated by the kernel.

According to one aspect of the present disclosure an image forming method by using an image forming apparatus including a main storage part and an auxiliary storage part is provided. With the image forming method of the present disclosure a boot loader that is stored in the auxiliary storage part is expanded in the main storage part. Then the expanded boot loader is executed to generate a defective area table for the auxiliary storage part. Then a kernel of an OS is caused to reference the defective area table generated and upon the kernel being executed the defective area table is not generated.

According to one aspect of the present disclosure a non transitory computer readable recording medium that stores programs to be executed by an image forming apparatus including a main storage part and an auxiliary storage part is provided. The program operates the image forming apparatus as a boot loader expanding part a defective area table preparing part and a kernel defective area referencing part. The boot loader expanding part causes a boot loader that is stored in the auxiliary storage part to expand in the main storage part. The defective area table preparing part executes the boot loader expanded by the boot loader expanding part to generate a defective area table for the auxiliary storage part. The kernel defective area referencing part causes a kernel of an OS to be referred the defective area table generated by the defective area table preparing part. When the kernel is executed the defective area table is not generated by the kernel.

To the image forming apparatus there are connected a control part an image processing part a document reading part a document feeding part a conveyance part a feed roller conveyance rollers and discharge rollers a network transmission reception part an operation panel part an image forming part a main storage part an auxiliary storage part and the like with the same bus and the like. Each part is operation controlled by the control part .

The control part is an information processing part. The control part reads out a control program in the auxiliary storage part to expand it in the main storage part and it executes the control program. Thereby the control part is operated as the respective parts of a functional parts described later. In addition the control part controls the entire apparatus in response to prescribed instruction information inputted from an external terminal not shown or the operation panel part .

The image processing part is a control arithmetic unit. The image processing part performs prescribed image processing on the image data. The image processing part performs various types of image process such as enlargement reduction density adjustment and gradation adjustment and image improvement.

The image forming part causes based on an instruction by the user an image to be formed on a recording sheet from data that has been stored in the main storage part and the auxiliary storage part read by the document reading part or acquired from an external terminal.

The conveyance part conveys a recording sheet from a paper feeding cassette . In addition the conveyance part conveys the recording sheet to the image forming part and then the recording sheet on which an image has been formed into the stack tray .

The operations of the document reading part the document feeding part the conveyance part and the image forming part will be described later.

The network transmission reception part includes a LAN board a radio frequency transmitter receiver and the like for connecting to an external network.

The network transmission reception part uses a circuit for data communication to transmit receive data. The network transmission reception part also uses an audio telephone circuit for transmitting receiving an audio signal.

The operation panel part includes a display part and an input part. The input part includes buttons or a touch panel and the like. The buttons in the input part may include ten keys a start key a canceling key and buttons for selecting an operation mode such as copying facsimile transmission and scanner. Further the buttons in the input part may include buttons for giving an instruction related to execution of a job such as printing transmitting saving or recording for the selected document.

The operation panel part acquires instructions given by the user about various jobs for image forming apparatus . The operation panel part can also receive or modify a particular user s information based on a user instruction obtained from the operation panel part .

The main storage part is a recording medium that is non transitory. The main storage part stores a program or data that has been read from the auxiliary storage part .

The auxiliary storage part is a recording medium that is non transitory. The auxiliary storage part stores various programs and data.

The auxiliary storage part includes a nonvolatile memory. The nonvolatile memory in the auxiliary storage part may be limited in the number of times for rewriting.

Also the auxiliary storage part stores a control program including firmware for performing operation control of the image forming apparatus . Also the auxiliary storage part may include an area for use as a saving folder for each user.

In addition in the image forming apparatus the control part and the image processing part may be formed as an integral part.

In addition the image forming apparatus may include a facsimile transmission reception part for performing facsimile transmission reception.

Then as refer to the operation of the image forming apparatus according to the embodiment of the present disclosure will be explained.

The document reading part is disposed on top of the main part . The document feeding part is disposed on top of the document reading part . The stack tray is disposed on the side of a delivery port for recording sheets that is formed in the main part . Further the operation panel part is disposed on the front side of the image forming apparatus .

The document reading part includes a scanner a platen glass and a document reading slit . The scanner includes an imaging sensor and the like. The scanner is movable in a direction of conveyance of a document by the document feeding unit . The platen glass is a document table containing a transparent material. The document reading slit has a slit that is formed in a direction orthogonal to the direction of conveyance of a document by the document feeding part .

When the scanner is to read a document placed on the platen glass it is moved to a position opposed to the platen glass . The scanner reads the document placed on the platen glass while scanning the document for acquiring image data. The scanner outputs the acquired image data to the main part .

Further when the scanner is to read a document carried by the document feeding part the scanner is moved to a position opposed to the document reading slit . The scanner reads the document through the document reading slit in synchronization with the document carrying operation of the document feeding part for acquiring image data. The scanner outputs the acquired image data to the main part .

The document feeding part includes a document mounting part a document discharge part and a document carrying mechanism . The documents placed in the document mounting part are fed in turn one by one by the document carrying mechanism to be carried to a position opposed to the document reading slit . The documents are thereafter discharged into the document discharge part

The document feeding part may be configured to be tiltable. In other words by bringing the document feeding part upward the top face of the platen glass may be opened.

The main part includes an image forming part and also includes a paper feeding part a paper carrying passage conveyance rollers and discharge rollers . The paper feeding unit may include a plurality of paper feeding cassettes for storing recording sheets that are different in size or orientation respectively. Further the paper feeding unit includes a feed roller for feeding the recording sheets one by one from the paper feeding cassette to the paper carrying passage . The feed roller the conveyance rollers and the discharge rollers function as a conveyance part. The recording sheet is conveyed by this conveyance part.

The recording sheet fed by the feed roller into the paper carrying passage is conveyed by the conveyance rollers into the image forming part . Then the recording sheet provided with a record by the image forming part is discharged into the stack tray by the discharge rollers .

The image forming part includes a photosensitive drum an exposure part a developing part a transfer part and a fixing part . The exposure part outputs light on the basis of the image data to expose the photosensitive drum thereto forming an electrostatic latent image on the surface of the photosensitive drum . The developing part is a developing unit that uses toner for developing the electrostatic latent image formed on the photosensitive drum . The developing part causes a toner image to be formed on the photosensitive drum on the basis of the electrostatic latent image. The transfer part causes the toner image formed on the photosensitive drum by the developing part to be transferred onto the recording sheet. The fixing part causes the toner image to be fixed on the recording sheet by heating the recording sheet onto which the toner image has been transferred by the transfer part

With reference to the configuration of the auxiliary storage part and the main storage part at the time of boot will be explained. In the same symbol used in indicates the same component.

In the main storage part a boot loader and a kernel are expanded from the auxiliary storage part to be stored. Further in the main storage part a defective area table is generated and stored.

The boot loader provides a program and data for performing initialization of the hardware starting of the kernel and the like. The boot loader includes an IPL Initial Program Loader and a boot loader. The IPL is read out immediately after starting for performing initialization of the hardware. The boot loader reads and starts an OS Operating System including the kernel and the like and other control programs not shown from the auxiliary storage part .

The kernel provides a program and data in which the basic functions constituting a core portion of the OS are implemented. The kernel manages the hardware and software resources with an API Application Programming Interface and the like. In other words the kernel uses the API and the like to intermediate between the hardware provided in the image forming apparatus and the application software not shown that is stored in the auxiliary storage part for executing it.

The defective area table is data such as a table for managing a defective area of the auxiliary storage part . The defective area table may be a bad block table for managing a bad block that has been made no longer capable of being written in the case where the auxiliary storage part is of NAND type flash memory. The defective area table is generated in a format that is commonly usable between the boot loader and the kernel .

With reference to the control part of the image forming apparatus of the present embodiment includes a boot loader expanding part a defective area table preparing part and a kernel defective area referencing part .

The boot loader expanding part reads the boot loader that is stored in the auxiliary storage part and causes it to expand in the main storage part .

The defective area table preparing part causes the boot loader expanded by the boot loader expanding part to be executed for preparing the defective area table for the auxiliary storage part . In other words the defective area table preparing part is executed as a process of the boot loader expanded in the main storage part to check for a defective area in the auxiliary storage part . The defective area table preparing part saves the information of the checked defective area s as a defective area table in the main storage part .

Further the defective area table preparing part generates the defective area table in a format that is usable in common with the boot loader and the kernel .

The kernel defective area referencing part causes the kernel to be referred the defective area table that has been generated by the defective area table preparing part . In addition the kernel defective area referencing part makes not generate the defective area table when the kernel is executed.

In other words the kernel defective area referencing part controls the kernel expanded in the storage part from the auxiliary storage part so as to directly refer the defective area table that the defective area table preparing part has generated by checking the auxiliary storage part at the time of execution of the boot loader . In addition the kernel defective area referencing part controls the kernel so as not to check the defective area in the auxiliary storage part at the time of execution of the kernel that has been expanded in the storage part .

With the NAND type flash memory writing and reading operation are performed in units that are called blocks. The block is further divided into units that are called pages.

The NAND type flash memory is limited in the number of times for rewriting. With the NAND type flash memory if the limited number of times for rewriting is exceeded the possibility of the writing being not completed in a prescribed time is increased. If writing deleting or the like is performed on a bad block which is a block including a page with which the writing has not been completed in a prescribed time an error will be caused. Therefore for the boot loader and the kernel it is required to specify a bad block as a defective area and exclude it from the memory management objects for the auxiliary storage part .

The information about bad block is stored in the redundancy area that is given to each block. The data as a result of reading the redundancy areas for all the blocks to the main storage part is collected as a table which is the defective area table .

Here by executing the control programs including the boot loader and the kernel that are stored in the auxiliary storage part the control part of the image forming apparatus functions as the boot loader expanding part the defective area table preparing part and the kernel defective area referencing part .

In addition the above described respective parts of the image forming apparatus provide hardware resources for executing an image forming method according to the embodiment of the present disclosure.

The auxiliary storage part may be constituted by an auxiliary storage part for the boot loader and that for the kernel and the other programs and data which are separately provided.

In addition the control part may incorporate an RAM or ROM a flash memory or the like. In the case where the control part incorporates an ROM the boot loader and the kernel may be stored therein.

Then with reference to boot process by the image forming apparatus according to the embodiment of the present disclosure will be explained.

The boot process in the present embodiment is executed mainly by the control part expanding the programs that is stored in the auxiliary storage part to the main storage part and executing them by using the hardware resources in cooperation with the respective parts.

Hereinbelow with reference to the flowchart in the details of the boot process will be explained for each step.

At first the control part uses the boot loader expanding part and performs boot loader expanding process.

The control part causes the boot loader that is stored in the auxiliary storage part to expand in the main storage part .

The control part reads the boot loader from the auxiliary storage part to the main storage part and starts the execution thereof.

Next the control part uses the defective area table preparing part to perform defective area table preparation process.

The control part executes the boot loader expanded by the boot loader expanding part and generates the defective area table for the auxiliary storage part .

The control part generates the defective area table by reading out the redundancy areas for the respective blocks of the auxiliary storage part to the main storage part . The control part prevents to use a block which contains even one piece of information about bad block in the redundancy area in a unit.

In addition the control part generates the defective area table in a format that is usable in common with the boot loader and the kernel .

The control part causes the kernel of the OS that is stored in the auxiliary storage part to expand in the main storage part .

Next the control part uses the kernel defective area referencing part for performing kernel defective area referencing operation generating process.

The control part causes the kernel of the OS that is stored in the auxiliary storage part to reference the defective area table generated by the defective area table preparing part in the main storage part .

To achieve this the control part sets for example a pointer to refer the defective area table for the kernel . Thereafter the control part executes the kernel . At this time if the control part detects for example the pointer to refer the defective area table for the kernel has been set the control part will not generate the defective area table by the kernel .

In addition the control part may be configured that it calls kernel stored in the auxiliary storage part having been set from the first so as for this defective area table not to be generated.

After the kernel having been expanded the control part executes the kernel to start the remaining control programs including a part of OS.

The control part expands the other programs and data necessary for controlling the image forming apparatus such as the part of the OS other than the kernel and the application programs stored in the auxiliary storage part in the main storage part and it executes them. Thus the boot is completed.

By the above way the boot process according to the embodiment of the present disclosure is terminated.

For using a typical technology both the boot loader and the kernel generate the defective area tables by reading the information of all the defective areas in the auxiliary storage part respectively. Therefore the time for reading the information about all the defective areas twice has been required and the process retards the boot completion as a result.

Contrarily to this an image forming apparatus according to an embodiment of the present disclosure is provided with a main storage part and an auxiliary storage part including 

a boot loader expanding part for expanding a boot loader being stored in the auxiliary storage part in the main storage part a defective area table preparing part for executing the boot loader expanded by the boot loader expanding part to generate a defective area table for the auxiliary storage part and a kernel defective area referencing part for causing a kernel of an OS to be referred the defective area table generated by the defective area table preparing part and upon the kernel being executed preventing the defective area table from being generated.

With such a configuration the defective area table that has been generated by the boot loader at the time of initial boot process of the image forming apparatus can also be used by the kernel . Therefore the time for reading out the auxiliary storage part to generate the defective area table can be cut to thereby speed up the boot.

In other words the present embodiment allows the defective area table that has been generated by the boot loader to be used also by the kernel . Thereby the need for preparing the defective area table in a duplicate manner is eliminated whereby the starting can be speeded up.

Further with the image forming apparatus according to the embodiment of the present disclosure the auxiliary storage part is a flash memory and the defective area table is a table that has been generated by reading out the redundancy areas of the respective pages of each block of the flash memory.

With such a configuration the defective area table generated by the boot loader and the defective area table to be used by the kernel are provided with a common format by the control part . Thereby the need for performing such a process to convert the defective area table generated by the boot loader is not needed when it is to be used by the kernel . Thereby the time required for conversion of the defective area table can be reduced during whole boot time.

In addition the control part needs not to generate the defective area table for all the blocks in the auxiliary storage part . For example the control part may generate a defective area table for the blocks other than the area in which the boot loader is placed.

With such a configuration the need for reading all the bad blocks is eliminated. Thereby the boot can be speeded up.

In addition with such a configuration the need for writing or reading the area of the boot loader at the time of execution of the OS is eliminated. Thereby the consumption of the memory capacity of the main storage part can be suppressed. In addition at the time of accessing to the auxiliary storage part the defective area table can be browsed at a higher speed whereby the performance can be improved.

In addition after the control part has generated the defective area table with the boot loader it may specify a predetermined area to be a write inhibit one like the defective area. This allows the critical area to be prevented from being falsified by a virus or the like during execution of the kernel by the control part .

Further at the time of execution of the boot loader the control part may execute the defective area table preparing part in a specific privilege mode supervisor mode or hypervisor mode . In addition the control part may generate the defective area table in an area in the main storage part that can be rewritten only in the privilege mode. In addition the control part may execute the loaded kernel in a mode that is lower in privilege level.

With such a configuration the possibility that the defective area table may be falsified is eliminated. Thereby the possibility that an area in the auxiliary storage part in which a virus or the like is stored may be camouflaged by the virus or the like as a bad block is eliminated to thereby allow deletion of the area. Thereby the security can be improved.

In addition the type of recording medium is not limited to the NAND type flash memory and the auxiliary storage part can also generate the defective area table for a recording medium such as a ReRAM which is limited in the number of times for rewriting. In addition also in this case as in the above described embodiment the kernel can be caused to be referred the defective area table . In this case the capacities of the page and the block can also be changed depending upon the type of the recording medium.

In addition in the case where the auxiliary storage part is an HDD the defective area table using information about a defective sector or the like can also be generated.

In addition the control part may change the format and the like when it uses the boot loader to generate the defective area table and causes the kernel to reference it.

In addition the control part may set a defective area table in such a form as a pointer array in the kernel in correspondence to the defective area table generated by the boot loader . In other words the control part may generate a defective area table that allows the kernel to continuously reference the blocks other than the bad blocks.

Thereby the control part can generate a defective area table for a continuous area at the time of execution of the OS including the kernel . Therefore if the auxiliary storage part is dotted with bad blocks the possibility that the access speed may be retarded is eliminated.

Further the present disclosure is applicable to information process apparatuses other than the image forming apparatus. In other words the configuration provided may be such that it uses such a tool as a network scanner or a server to which a scanner is separately connected with a USB or the like.

The configuration and operation of the above embodiments are examples and of course it is possible to alter them as appropriate for implementation within the scope of the gist of the present disclosure for execution.

