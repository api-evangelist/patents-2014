---

title: Mass transit fare processing system
abstract: An implementation of a system and method for using existing identification token infrastructures for mass transit fare product entitlement and payment is provided. The system and method make use of tokens—usually issued by a third party—for identification purposes and optionally for settlement purposes. The system does not store information on the tokens and instead maintains access control data (i.e., “white” and “black” lists). This implementation differs from known systems that require specially issued credit cards that have dedicated mass transit functionality.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09218600&OS=09218600&RS=09218600
owner: Smart Systems Innovations, LLC
number: 09218600
owner_city: Hopewell
owner_country: US
publication_date: 20140626
---
This application is a continuation and claims the benefit of U.S. application Ser. No. 13 469 065 entitled Mass Transit Fare Processing System and filed May 10 2012 which is incorporated herein by reference and assigned to the same assignee as the present application. U.S. application Ser. No. 13 469 065 claims the benefit under 35 U.S.C. 119 e of U.S. Provisional Application 61 484 219 entitled Mass Transit Fare Processing System and filed May 10 2011 which is incorporated herein by reference and assigned to the same assignee as the present application. U.S. application Ser. No. 13 469 065 is also a continuation in part and claims the benefit under 35 U.S.C. 120 of co pending U.S. application Ser. No. 12 511 037 entitled Public transit system fare processor for transfers and filed Jul. 28 2009 which is a continuation in part of U.S. Pat. No. 7 566 003 application Ser. No. 11 838 499 entitled Learning Fare Collection System for Mass Transit filed Aug. 14 2007 and a continuation in part of U.S. Pat. No. 7 568 617 application Ser. No. 11 668 456 also entitled Learning Fare Collection System for Mass Transit filed Jan. 29 2007 which each claims the benefit under 35 U.S.C. 119 e from U.S. Provisional Application 60 869 112 filed Dec. 7 2006 each of which are incorporated herein by reference and assigned to the same assignee as the present application.

The invention relates generally to public transit system access and more specifically to enabling a full set of mass transit fare products without the need to store information on the identification tokens.

Fare collection in mass transit has traditionally relied on mass transit agencies issuing scrip. A scrip ticket is used to describe paper money being used for e.g. mass transit rides in lieu of taking money at those rides. Originally in tangible form like coinage the same system was later translated to the electronic domain as a virtual scrip. The virtual scrip was first stored in magnetic memory later in electrical memory sometimes connected to a microprocessor such as in the case of so called smart cards.

The advent of virtual scrip brought with it the use of the storage medium to store not just scrip or a currency balance but to store entitlement on the storage medium in which case it may be called fare media . Such an entitlement might be the right to ride free of charge or free of additional charge for a specified time e.g. a monthly pass or the right to a reduced fare e.g. a senior citizen pass .

However such electronic fare media comes at a significant financial cost for transit agencies not only is production and issuance of virtual scrip and other fare media very expensive fraud risk is an additional burden in this model.

Independently of the above development the recent years have brought the ubiquity contactless credit cards and contactless debit cards as well as first attempts of implementing wireless payment or identification protocols using mobile phones.

A need thus exists to enable mass transit agencies to give up issuing fare media and make use of existing semi public infrastructures of identification tokens such as the credit and debit card networks where issuers take on the cost of production issuance and where the networks take on much of the fraud risk.

An implementation of a system and method for using existing identification token infrastructures for mass transit fare product entitlement and payment is provided. The system and method make use of tokens usually issued by a third party for identification purposes and optionally for settlement purposes. The system does not store information on the tokens and instead maintains access control data i.e. white and black lists . This implementation differs from known systems that require specially issued credit cards that have dedicated mass transit functionality.

Embodiments of the present invention include a fare processor a transit system rules processor to maintain access control lists and account for and settle fare payments.

Some embodiments of the present invention provide for a fare processor the fare processor comprising at least one processor a first interface coupled to the at least one processor and coupled to receive a plurality of presentation records from the at least one public transit system memory coupled to the at least one processor wherein the memory is configured to hold the received plurality of presentation records fare rules and transit account data comprising an account state for a plurality of transit accounts and a second interface coupled to the at least one processor and coupled to communicate to a payment gateway to settle the plurality of transit accounts wherein the at least one processor is configured to apply the fare rules to the received plurality of presentation records.

Some embodiments of the present invention provide for a method for gating entry into a first transit system the method comprising receiving a set of records wherein each of the records includes an index representative of an individual token and wherein the set of records includes a set of records representing black listed tokens wherein a black listed token will be denied access to the first transit system sequentially reading at a token terminal and processing token data from a plurality of tokens wherein a first token of the plurality of tokens is issued by a first issuer and a second token of the plurality of tokens is issued by a second issuer separate and distinct from the first issuer and wherein the first and second issuers are separate from the first transit system processing a third token comprising a reading at the token terminal token data from the third token b determining an index representative of the third token c searching for the index representative of the third token in the set of records to determine a status of the third token d setting the status of the third token to indicate the third token is an unknown token and e allowing access into the first transit system and entering to a transaction history database an indication of access into the first transit system by a holder of the third token providing to a processing system entries from the transaction history database for remote determination of a transaction amount for each entry and receiving an update to the set of records.

Some embodiments of the present invention provide for a method for authorizing a bankcard transaction the method comprising downloading two sets of records each record comprising at least a bankcard identifier the first set representing known invalid bankcards the second set representing known valid bankcards. receiving a first authorization request referencing a first bankcard checking if the first bankcard matches a known invalid card denying the first authorization request if the first bankcard matches a known invalid card receiving a second authorization request referencing a second bankcard the request comprising at least the identifier of a second bankcard checking if the second bankcard matches a known invalid card checking if the second bankcard matches a known valid card approving the second authorization request if the first bankcard does not match any known invalid cards and matches a known valid card.

Some embodiments of the present invention provide for a method for controlling access to a transit network by maintaining a black list of identifying tokens the method comprising granting a potential rider access to a transit system upon presentation of an identifying token comprising reading a first set of token data from a first identifying token using a token reader computing a first token identifier from the token data checking the first token against a black list in memory using the first token identifier and allowing access to the transit network if the first token is not black listed denying a potential rider access to the transit system upon presentation of an identifying token comprising reading a second set of token data from a second identifying token using a token reader computing a second token identifier from the token data checking the second token against a black list in memory using the second token identifier and denying access to the transit network if the second token is black listed removing a third identifying token from the black list after its outstanding balance is paid comprising successfully charging a payment account associated with the third identifying token and removing the third user token from the black list and adding a fourth identifying token to the black list if the outstanding balance remains unpaid comprising unsuccessfully charging one or more a payment accounts associated with the fourth identifying token and adding the fourth identifying token to the black list.

Some embodiments of the present invention provide for a fare processing system associated with a set of public transit systems the processing system comprising a first interface to receive a plurality of presentation records from at least one of the set of public transit systems record memory to hold received presentation records rule memory to hold fare rules account memory to store the state of one or more transit accounts a second interface connected to a payment gateway to settle the one or more transit accounts one or more processors coupled to the first and second interfaces and to the record memory rule memory and account memory to apply the fare rules held in the rule memory to the presentations records held in the presentation record memory.

These and other aspects features and advantages of the invention will be apparent from reference to the embodiments described hereinafter.

In the following description reference is made to the accompanying drawings which illustrate several embodiments of the present invention. It is understood that other embodiments may be utilized and mechanical compositional structural electrical and operational changes may be made without departing from the spirit and scope of the present disclosure. The following detailed description is not to be taken in a limiting sense. Furthermore some portions of the detailed description that follows are presented in terms of procedures steps logic blocks processing and other symbolic representations of operations on data bits that can be performed in electronic circuitry or on computer memory. A procedure computer executed step logic block process etc. are here conceived to be a self consistent sequence of steps or instructions leading to a desired result. The steps are those utilizing physical manipulations of physical quantities. These quantities can take the form of electrical magnetic or radio signals capable of being stored transferred combined compared and otherwise manipulated in electronic circuitry or in a computer system. These signals may be referred to at times as bits values elements symbols characters terms numbers or the like. Each step may be performed by hardware software firmware or combinations thereof.

Hereinafter a bankcard such as a credit card or a debit card is a payment token that may be linked to a bank account or credit line. Bankcards include cards and tokens in any of a number of form factors. A bankcard may be dimensioned in accordance with ISO 7810 7813 ID1 about 3.375 2.125 0.0030 commonly known as Credit Card Format . Alternatively a bankcard may take other forms. A bankcard may take the form of a key fob e.g. as issued by Speedpass or wristband. Alternatively the bankcard may be embedded into integrated with or be emulated by a mobile phone or other handheld device. A bankcard includes memory to hold an identifier used to uniquely identify an account for billing. The memory may be in the form of a magnetic stripe and or may be attached to circuitry which may be in accordance to ISO 7816. A bankcard may include or be integrated with contactless circuitry such as ISO 14443. In some embodiments a bankcard includes a token issued by a third party that is not a transit agency such as a bank credit union a government agency issuing a state driver s license or DMV issued identification card federal government issued passport and or other government issued ID .

Hereinafter a user token such a bankcard or government ID is something that allows a rider to be identify with a certainty that is sufficient for mass transit fare collection. In some embodiments of the invention a token is not limited to physical devices but is intangible such as a biometric trait.

Fare processing system may also include one or more interface to a registration system . Registration system provides a back end interface to bankcards. A bankcard holder may register a bankcard with fare processing system via a website using an interactive voice response system IVR at an interactive electronic kiosk or using a vending machine by supplying registration data either manually and or by enabling the registration system to read registration data from the bankcard. Alternatively a proxy of the bankcard holder such as the bankcard issuer may register bankcards with fare processing system on behalf of the holder. Such a proxy registration may be for an individual card or in bulk for a plurality of cards. Registration data may include bankcard data contained on the card such as cardholder name bankcard number or expiration data and or bankcard meta data such as the billing address or other cardholder data. Registration data transmitted during a proxy registration may include data that is not readily available to the holder such as an alias bankcard number that is transmitted over the card s wireless interface instead of the actual bankcard number or such as a cryptographic key and or shared secret used to authenticate the bankcard. A proxy may additionally transmit registration data programmatically via remote procedure calls using protocols such as REST or SOAP or by manually or automatically transmitting files to the registration system or directly to the fare processing system . In some embodiments of the invention holder and issuer both supply bankcard data and or meta data to registration system and or fare processing system . In some embodiments of the invention registration system may be part of fare processing system .

Fare processing system may also include one or more interfaces to a bankcard verification system . The bankcard verification system will verify whether a bankcard is currently a valid bankcard and or if it is likely to be good for a given amount of money. In some embodiments of this invention the bankcard verification system is nothing more than an interface to a standard bankcard authorization system ultimately utilizing a switch to connect to settlement and clearing networks used by debit and credit card companies. In other embodiments the bankcard verification system is capable of verifying cards independently of a connection to clearing and settlement networks. Because issues of control over the card verification system relate closely to security and liability in particular when card data is stored in some instances of the invention bankcard verification system is under the control of an acquirer while in others it may be under the control of a processor processor in the sense of a 3party card processing company and in yet another instance it may be under the control of a transit network and finally it may be under the control of a card network.

In some embodiments bankcard reader provides a physical electrical electromagnetic optical magnetic and or radio frequency RF interface to bankcards . Bankcard reader may be a receiver without a transmitter or may include both a receiver and a transmitter to communicate with a bankcard . A bankcard may transmit bankcard data including 1 a cardholder s name 2 a bankcard number e.g. a PAN as defined in ISO IEC 7812 3 an expiration date 4 security data e.g. the result of a cryptographic operation based on one or more cryptographic keys stored in the card s memory 5 issuer private data and or 6 records or summaries of past transactions. Bankcards are not limited to what is commonly known as a credit card s physical embodiment.

In some embodiments bankcard reader simply reads data from bankcard as bankcard passes by it. In some embodiments bankcard reader transmits a signal to bankcard to access bankcard data. Bankcard reader forwards selective bankcard data or all bankcard data received to bankcard terminal processor . In some embodiments bankcard reader additionally transmits to bankcard terminal processor communication meta data resulting from communication with the bankcard such as protocol data.

Bankcard terminal Processor includes a first interface to a fare processing system and a second interface to assist in gating access as well as an interface to memory. Bankcard terminal processor may be implemented with a microcontroller a microprocessor and or other logic circuitry. In some embodiments of the present invention the bankcard terminal processor reads writes and updates data in memory representing a set of bankcard records which contains a set of known bankcards and an optional access history which keeps a history of bankcards presented to bankcard terminal and may be used for billing. In other embodiments of the invention the set of bankcard records and or access history may be located elsewhere for instance with or in fare processing system or bankcard verification system described in further detail below. The set of bankcard records and access history may be in the form of one or more sequential lists tree structures other sorted data structures and or databases which may be indexed or searchable by one or more an identifiers such as a hash value or the identifier of a bank card such as a PAN or a PAN alias. The set of bankcard records may be presorted for faster subsequent searching. The set of bankcard records access history and identifiers are described in more detail below.

Processor is coupled to and communicates with first interface second interface and third interface respectively. Processor is also coupled to memory and manipulates a set of known bankcard records held in the memory. The set of known bankcard records may contain bankcard data such as a bankcard number usually a PAN and or a PAN alias as described below or one or more hash values computed from the bankcard data. Processor may be implemented with a microcontroller a microprocessor and or other logic circuitry.

The set of known bankcard records contains an identifier of each bankcard in the set. The bankcard may be one that was previously presented by a respective holder of the bankcard to fare processing system and verified by fare processing system . A presentation may be by way of a physical presentation by the holder at a bankcard terminal at a gate or entrance of a transit system. Alternatively the presentation may be by way of registering the bankcard over the telephone for example using an IVR system or by way of registering using the Internet for example using a web browser. Alternatively the presentation may be by a bank or other financial institution enabling the bankcard by communicating with processor . Such a financial institution may provide multiple presentations to fare processing system individually or in a batch process.

At a bankcard terminal bankcard data received via a magnetic stripe may differ from that received over the air through an RF connection which may differ still from bankcard data received via a registration system. For example bankcard data may contain a Primary Account Number PAN which is typically a 15 digit to 16 digit numeric code embossed on the face side of a bankcard and which is also encoded in the magnetic stripe. PAN is further defined in ISO IEC 7811 and ISO IEC 7812. The PAN standard allows up to 19 digits. The PAN standard allows for three main components in the form nnnn nndd dddd ddds where 1 nnnn nn is the Issuer Identification Number IIN typically six digits 2 dd dddd ddd is the NIH ID number or individual account identification IAI up to twelve digits without the check digit and 3 s is the ISO EIC 7812 1 check digit. A bankcard having a wireless chip may be coded with a different identifying number than the PAN. For example when a bankcard communicates with an RF reader it will send an alias or ghost of the PAN rather than the PAN itself. The PAN alias may need to be mapped to a PAN for further processing. Not all bankcards are in full compliance with aforementioned standards e.g. some do not use a check digit . Some embodiments of the present invention operate with bankcards compliant with these PAN ISO IEC standards while other embodiments operate with non compliant bankcards not compliant to the PAN ISO IEC standards. Still other embodiments of the present invention operate with a family of compliant and non compliant bankcards.

If a bankcard is expected to provide different identifying data e.g. PAN alias rather than the credit card number e.g. PAN the bankcard terminal fare processing system verification system or the like will provide a translation between the alias PAN and the PAN. In some cases the set of bankcard records in the bankcard terminal contains a PAN an alias PAN a hash value based on the PAN and or a hash value based on the alias PAN. In some cases the set of known bankcard records in the fare processing system contains a PAN an alias PAN a hash value based on the PAN and or a hash value based on the alias PAN.

As stated above the set of bankcard records may be presorted for faster subsequent searching. For example the set of bankcard records may be stored as a self balancing tree. In some embodiments a bankcard identifier is determined using the Issuer Identification Number IIN and the individual account identification IAI without the check digit. The check digit is not included in the determined bankcard identifier because it is simply a checksum value and does not provide any additional identification. In some embodiments the determined bankcard identifier includes the individual account identification IAI and the record is stored together with other determined bankcard identifier having the same Issuer Identification Number IIN . In these embodiments a first lookup will search for the IIN and a second lookup will subsequently search for the IAI. In some embodiments the IIN is used for the first search and a hash value is created and used for the IAI. In other embodiments a first hash value is created for the IIN and a second hash value is created for the IAI. These embodiments provide for both compact storage and sufficient speed. Some embodiments require that the time between bankcard presentation by a cardholder and granting or denying access be within 200 milliseconds. Therefore a search of the set of bankcard records should be complete within 200 milliseconds.

First interface second interface and third interface may share a common physical interface for example the physical interface maybe an Ethernet connection to the Internet and or an intranet. In this case first interface second interface and third interface share a common physical interface but are logically three different interfaces. For example first interface second interface and third interface may each have a unique socket identifier.

When an unknown bankcard is presented it becomes a known bankcard . A known bankcard may also be considered to be in one of two classifications a known valid bankcard or a known invalid bankcard . A known valid bankcard represents a bankcard that has been presented by a respective holder of the bankcard as well as verified with a bankcard verification system . A known invalid bankcard represents a bankcard that has been presented by a respective holder of the bankcard however verification with a bankcard verification system has failed in some respect. For example bankcard terminal or fare processing system was unable to communicate with bankcard verification system . Alternatively bankcard terminal or fare processing system communicated with bankcard verification system which indicated bankcard is somehow the invalid for a purchase. A known valid bankcard may transition to a known invalid bankcard for example if an attempt to clear and settle a transaction fails. Similarly a known invalid bankcard may transition to a known valid bankcard for example if an attempt to verify or to clear and settle a transaction completes successfully.

A bankcard terminal may receive bankcard data from one or more of several paths. First a bankcard terminal may receive bankcard data directly from a bankcard s magnetic stripe e.g. a bankcard holder may pass a magnetic stripe of a bankcard through a magnetic stripe reader on the bankcard reader . Second a bankcard terminal may receive bankcard data via an RF connection between the bankcard terminal and the bankcard e.g. a wireless chip in a bankcard may communicate with a radio transceiver in a bankcard reader . Third a bankcard terminal may receive bankcard data directly from electronic contacts to a smart chip on the bankcard. Fourth bankcard terminal may receive bankcard data from a fare processing system which previously received bankcard data from an external connection e.g. IVR system Internet web interface and or financial institution and or one or more agents of financial institutions . After receiving and processing bankcard data received from a third interface to a registration system the fare processing system may send bankcard data to a bankcard terminal through its first interface second interface and third interface .

A hash function may be used to compute a hash value from the bankcard data. A hash function or hash algorithm is a reproducible method of turning bankcard data into hash data that may serve as a digital fingerprint of the bankcard data. The hash function may be considered to chop and mix i.e. substitutes or transposes the data to create such a fingerprint. The fingerprint may be called hash sums hash values hash codes or simply hashes. The hash computation may be based on a cryptographic hash function. Broadly speaking a cryptographic hash function behaves like a random function while still being deterministic and efficiently computable.

In bankcard terminal uses the determined identifier to tell whether or not the bankcard is contained in a set of bankcard records and whether or not the bankcard is a known valid bankcard. In some embodiments of bankcard terminal that have an interface to a bankcard verification system an attempt is made to verify the bankcard at . At bankcard terminal determines whether or not the bankcard was successfully verified. At if the bankcard was successfully verified the set of bankcard records is updated with the determined identifier for the currently presented bankcard. At if the verification was unsuccessful access is denied for example by not opening a gate and or by activating an audio and or visual indicator to the bankcard holder and or to a conductor. At if the determined identifier was already in the set of bankcard records as a known valid bankcard or was added to the set of bankcard records at access to the transit system is allowed for example by opening the gate and or by activating an audio and or visual indicator to the bankcard holder and or to a conductor.

A system as illustrated in is too slow for transit sometimes requiring more than 30 seconds just for the communications in the financial network domain whereas the commonly accepted maximal duration for a bankcard transaction in mass transit is 300 ms dictated by the speed by which travelers pass the transit gates during rush hour. The present invention adds a verification proxy that circumvents or delays the use of bankcard verification system . In some embodiments of the invention the authorization proxy receives authorization request from fare processing system and replies to the same with authorization response and in response to authorization request sends authorization request to bankcard verification system and receives authorization responses from the same.

In an exemplary instance of a bankcard verification system is shown. Merchants have traditionally been passing their data to an acquirer usually a bank who will have the technology to route transaction data such as authorization request to the correct payment network . It is usually up to the payment network to route the authorization request to the card issuer although it is standard practice for the network to stand in for the issuer under certain conditions such as communication failures. An authorization response will be passed back to the merchant unless this is prevented by an exceptional condition such as a communications error.

This configuration is depicted in which also indicates the preferred geographical location of bankcard verification proxy in this configuration namely at the transit authority close to fare processing system for best communication speed and reliability. It should be noted that geographic location does not necessarily imply legal ownership or liability for bankcard verification proxy it would usually be owned or operated by an acquirer or network. shows another flow where the proxy delegates the authorization and passes it on verbatim similar to .

Likewise in some instances of the invention bankcard ACL B is maintained by interpreting list updates derived from transit account ACL A. In some instances of the invention bankcard ACL B is manipulated directly at terminal via direct entry data . In some instances of the invention bankcard ACL B is maintained by interpreting known good and or known bad data received via bankcard verification system for example a list of stolen or lost cards. In some instances of the invention bankcard ACL B is maintained by interpreting authorization response and or settlement response received from bankcard verification system in response to authorization request . In some instances of the invention bankcard ACL B is replicated in whole or in part on Bankcard Terminal even if the configuration differs from . In other instances of the invention bankcard ACL B is maintained entirely on one or more instances of Bankcard Terminal even if the configuration differs from . In some instances of the invention as described above and indicated in transit account ACL A and bankcard ACL B are both maintained by fare processing system .

The invention s response to a presented bankcard differs as shown in based on bankcard either being determined to be a known valid bankcard or as a presently unknown or black listed i.e. known invalid bankcard. The response to a known valid bankcard is shown in . Responses to a presently unknown or black listed bankcard are shown in .

At a fare processing system receives from a bankcard registration system through its third interface to the registration system a registration request. The registration request is a request by the remote bankcard holder or by a financial institution or its agent to register the bankcard with the fare processing system . By pre registering the bankcard future regulation of entry or access to any of the set of transit systems may be more quickly performed for example because a remote bankcard terminal will not need to perform an authorization or clearing and settlement request with a distant bankcard verification or clearing and settlement system. The registration request contains bankcard data of a bankcard presented by a respective holder of the bankcard. The bankcard data may include an identifier of the bankcard such as the PAN or credit card number. Next the fare processing system determines an identifier of the presented bankcard. This determined identifier of the presented bankcard may be used as an index to a database or lookup table and may be a PAN or a credit card number or derived from the PAN or credit card number such as through a hashing function.

At the fare processing system determines whether the determined identifier is contained in a set of bankcard records. The set of bankcard records includes identifying information of bankcards that were previously presented to the fare processing system . These previously presented bankcards include bankcards from a plurality of issuers. For example the set contains at least one bankcard from a first issuer e.g. Chase and at least one bankcard from a second issuer e.g. American Express . The plurality of issuers may contain two or more issuers including for example Chase American Express Citi Bank of America Discover MasterCard Visa and the like. The set contains a number of values for each bankcard including an identifier of a bankcard previously presented to the processing system. This identifier in the set may be searchable and may be used by the fare processing system when determining whether the determined identifier is contained in a set of bankcard records.

At the fare processing system attempts to verify the bankcard through a bankcard verification system. The attempt to verify the currently presented bankcard with the bankcard verification system may include attempting to verify the currently presented bankcard with a clearing and settlement network. Alternatively the attempt to verify the currently presented bankcard with the bankcard verification system may include receiving an authorization from a clearing and settlement network for an amount of funds from an account linked to the currently presented bankcard. In some circumstances the attempt to verify the currently presented bankcard with the bankcard verification system may result in a failed attempt. For example the attempt to verify the currently presented bankcard with the bankcard verification system may result in receiving from the bankcard verification system an indication that the bankcard verification system rejects the authorization of a financial charge.

By verifying the bankcard the fare processing system determines whether the bankcard will be eligible or ineligible for a future purchase. At if the verification is not successful the fare processing system reports this failure at . That is the fare processing system reports a failure if attempting to verify the presented bankcard results in a determination of an invalid bankcard. At if the set contains invalid or ineligible bankcards the fare processing system changes the set to show that the bankcard is an invalid bankcard. That is the fare processing system removes from the set of bankcard records the present bankcard if attempting to verify the presented bankcard results in the determination of an invalid bankcard. At if the verification is successful the fare processing system changes the set to show that the bankcard is a valid bankcard at . That is the fare processing system incorporates the presented bankcard into the set of bankcard records if attempting to verify the presented bankcard with the bankcard verification system results in receiving an indication of a valid bankcard.

In either case at if the fare processing system made a change to the set of bankcard records it will communicate to at least one bankcard terminal updates to the set of bankcard records. The updates may be made either individual for each received bankcard record or may be aggregated as a batch update. The update may be downloaded to a bankcard terminal by an electronic data connection or may be made by physically porting a memory device e.g. a CD ROM or flash drive from the fare processing system to the bankcard terminals .

In some embodiments the set of bankcard records contains only bankcards presented to the system at the front end through bankcard terminal. In other embodiments the set of bankcard records contains only bankcards presented to the system at the back end through a registration system. Still in other embodiments the set of bankcard records contains only bankcards presented to the system at either the front end or the back end. In some embodiments the set of bankcard records contains only bankcards individually by a holder of the bankcard. In some embodiments the set of bankcard records contains only bankcards individually by a holder or holder s agent of the bankcard. In a sense each of the presentations is learned by the system. In some embodiments the set of bankcard records includes bankcards presented by a financial institution or the like in addition to the learned bankcards.

A rules processor may be used to process bankcard records or user token data. These presentations may be processed offsite in real time or offline individually or accumulated and processed in a batch mode. In some embodiments a bankcard is either a debit card or a credit card. In other embodiments a user token or identifying toke is used. An identifying token may be a bankcard or other payment card or other identification ID card or chip in the form of a card or embedded in or on another device such as a mobile phone.

When bankcard presentations are processed offline not in real time resulting user toke records each representing a presentation may be received by a rules processor in non sequential order. That is records may be received out of order and perhaps some records may be delayed by a substantial period of time.

Therefore it should be understood that the invention can be practiced with modification and alteration within the spirit and scope of the appended claims. The description is not intended to be exhaustive or to limit the invention to the precise form disclosed. It should be understood that the invention can be practiced with modification and alteration.

