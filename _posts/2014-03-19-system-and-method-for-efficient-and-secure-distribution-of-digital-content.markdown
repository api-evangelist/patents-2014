---

title: System and method for efficient and secure distribution of digital content
abstract: One embodiment provides a system for processing encrypted content. During operation, a client computing device determines a request for content based on the identity of the user or the client computing device. Content is received which has been encrypted using a master encryption, where the master encryption key is not known to the client computing device. The client computing device generates an interest packet that includes a request for a user-specific re-encryption key, and, based on the information in the interest packet, receives a content object that includes the user-specific re-encryption key. The client computing device decrypts the master-encrypted content by: re-encrypting the master-encrypted content, using the user-specific re-encryption key to transform the master-encrypted content to a user-specific encrypted content; and decrypting the transformed user-specific encrypted content using a user-specific key. This thereby facilitates the secure distribution of user-specific content without requiring a content source to distribute user-specific encrypted content.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09407432&OS=09407432&RS=09407432
owner: PALO ALTO RESEARCH CENTER INCORPORATED
number: 09407432
owner_city: Palo Alto
owner_country: US
publication_date: 20140319
---
This disclosure is generally related to the distribution of encrypted digital content. More specifically this disclosure is related to processing encrypted content in a network with intermediate storage by performing decryption using a re encryption key to transform master encrypted content into user specific encrypted content.

The proliferation of mobile computing and cellular networks is making digital content more mobile than ever including content such as song videos and movies. Content centric network CCN architectures have been designed to facilitate accessing such digital content including content that requires protection under digital rights management DRM . Thus it is necessary for such network architectures to include security features for accessing and distributing the digital content.

A consumer who wishes to download a song from a content producer such as iTunes requests the song. As part of its DRM scheme the iTunes server sends the user an encrypted copy of the song which the user decrypts using his own specific key. The encrypted copy of the song may pass through and be cached at an intermediate storage device on the network. If a second consumer wishes to download the same song he requests the song from iTunes and the iTunes server returns a differently encrypted copy of the song which the second consumer decrypts using his own specific key. Because the consumers each use their own specific user key to decrypt the song the system by way of the iTunes server creates and sends a separately encrypted version of the song for each consumer. The system cannot simply access and send to the second consumer the previously encrypted copy of the requested song which has already been cached in the intermediate storage device. This does not take advantage of the content centric network architecture best suited for DRM.

One solution would be to provide each consumer with the same decryption key such that the previously encrypted copy of the song could be cached at the intermediate storage and sent back upon request by subsequent consumers. This would allow subsequent consumers to therefore utilize the cached copy of the encrypted song in the intermediate storage and eliminate the need for the content producer to encrypt and send another copy of the same song. This solution would leverage the CCN infrastructure and its inherent in networking caching capabilities. Unfortunately providing the same key to all users contradicts the very purpose of user specific encryption and increases the risk of security breaches within the CCN.

One embodiment provides a system for processing encrypted content. During operation a client computing device determines a request for content based on the identity of the user or the client computing device. Content is received which has been encrypted using a master encryption where the master encryption key is not known to the client computing device. The client computing device generates an interest packet that includes a request for a user specific re encryption key and based on the information in the interest packet receives a content object that includes the user specific re encryption key. The client computing device decrypts the master encrypted content by re encrypting the master encrypted content using the user specific re encryption key to transform the master encrypted content to a user specific encrypted content and decrypting the transformed user specific encrypted content using a user specific decryption key. This thereby facilitates the secure distribution of user specific content without requiring a content source to distribute user specific encrypted content.

In some embodiments the interest packet generated by the client computing device can also include one or more of a public key of the user and a name of the content corresponding to the requested user specific re encryption key. In another embodiment the interest packet generated by the client computing device can include authentication information relating to the user.

In some embodiments the client computing device can receive a content object that based on the information in the generated interest packet includes information relating to pricing. The system then generates another interest packet that includes information relating to payment.

In some embodiments an intermediate storage device in the network performs the re encrypting of the master encrypted data by using the user specific re encryption key to transform the master encrypted data to a user specific encrypted content which can only be decrypted by the user specific decryption key. The intermediate storage device can be associated with one or more of an authorized distributor an authorized retailer a storage device selected specifically for a particular Internet Service Provider ISP and any medium capable of caching the master encrypted content and the corresponding user specific re encryption key.

In some embodiments the intermediate storage device sends the transformed user specific encrypted content to a client computing device so that the client computing device can decrypt the transformed user specific encrypted content using the user specific decryption key.

In some embodiments a client computing device determines a request for content based on the identity of the user or the client computing device. Content is received which has been encrypted using a symmetric key where the symmetric key has been encrypted using a master encryption key. The client computing device then generates an interest packet that includes a request for a user specific re encryption key and based on the information in the interest packet receives a content object that includes the user specific re encryption key. The client computing device decrypts the symmetric key encrypted content by re encrypting the master encrypted symmetric key using the user specific re encryption key to a user specific encrypted symmetric key decrypting the re encrypted symmetric key using the user specific decryption key and decrypting the symmetric key encrypted content using the decrypted symmetric key.

The following description is presented to enable any person skilled in the art to make and use the embodiments and is provided in the context of a particular application and its requirements. Various modifications to the disclosed embodiments will be readily apparent to those skilled in the art and the general principles defined herein may be applied to other embodiments and applications without departing from the spirit and scope of the present disclosure. Thus the present invention is not limited to the embodiments shown but is to be accorded the widest scope consistent with the principles and features disclosed herein.

Embodiments of the present invention provide a computer network environment for processing encrypted content that solve the problem of secure and efficient distribution of content to a user by using a re encryption which both preserves the secrecy of the content and allows for re use of a cached copy of the content by subsequent users. The computer network environment can include a content centric network CCN . For exemplary communication occurring within a CCN the terms interest and content object described below may be used when describing the content of request and response messages. For example a client computing device can determine a request for content based on the identity of the user or the client computing device. The client computing device receives the requested content which has been encrypted using a master encryption key which is not known to the client computing device. The content is then encrypted by a content producer using a master encryption key which is known only to the content producer.

Upon receiving the master encrypted content the client device generates an interest packet that includes the name of the content and a request for a user specific re encryption key. The content producer then generates a content object which based on the information in the interest packet includes the user specific re encryption key. Once the user specific re encryption key is received the client device decrypts the master encrypted content by 1 re encrypting the master encrypted content using the user specific re encryption key to transform the master encrypted content to a user specific encrypted content and 2 decrypting the transformed user specific encrypted content using a user specific decryption key.

Thus the user specific decryption key can only decrypt the specifically transformed content i.e. the output of the transformation of the master encrypted content . The user specific decryption key cannot be used on its own to decrypt the master encrypted content. Furthermore because the re encryption key is user specific each user obtains content which has been re encrypted specifically for him which he can decrypt on the fly using his user specific decryption key on any of his computing devices. This process allows the content to remain secure and also allows the user to transfer the user specific encrypted content between his various devices.

In some embodiments after the client device determines a request for content the master encrypted content and the user specific re encryption key may be cached in an intermediate storage device. The intermediate storage device may for example be an Internet Service Provider ISP under contract with the content producer and is thus a trusted storage device within the content centric network CCN . The system may also choose a specific ISP for intermediate storage based on the requested content. Upon accessing a copy of the master encrypted content and the user specific re encryption key the intermediate storage device performs the re encryption by 1 re encrypting the master encrypted content by using the user specific re encryption key to transform the master encrypted content to a user specific encrypted content and 2 sending the transformed user specific encrypted content to the client device. The client device then decrypts the transformed user specific content using the user specific decryption key. This allows the intermediate storage device to cache both the master encrypted content and the re encryption key and also perform the transformation of the re encryption thus leveraging the CCN infrastructure and its inherent networking caching capabilities.

In some embodiments the network clients network nodes e.g. forwarders and publishers communicate over an information centric network ICN . In ICN each piece of content is individually named and each piece of data is bound to a unique name that distinguishes the data from any other piece of data such as other versions of the same data or data from other sources. This unique name allows a network device to request the data by disseminating a request or an Interest that indicates the unique name and can obtain the data independent from the data s storage location network location application and means of transportation. Named data network NDN or a content centric network CCN are examples of ICN architecture the following terms describe elements of an NDN or CCN architecture 

A single piece of named data which is bound to a unique name. Content Objects are persistent which means that a Content Object can move around within a computing device or across different computing devices but does not change. If any component of the Content Object changes the entity that made the change creates a new Content Object that includes the updated content and binds the new Content Object to a new unique name.

A name in an ICN is typically location independent and uniquely identifies a Content Object. A data forwarding device can use the name or name prefix to forward a packet toward a network node that generates or stores the Content Object regardless of a network address or physical location for the Content Object. In some embodiments the name may be a hierarchically structured variable length identifier HSVLI . The HSVLI can be divided into several hierarchical components which can be structured in various ways. For example the individual name components parc home ndn and test.txt can be structured in a left oriented prefix major fashion to form the name parc home ndn test.txt. Thus the name parc home ndn can be a parent or prefix of parc home ndn test.txt. Additional components can be used to distinguish between different versions of the content item such as a collaborative document.

In some embodiments the name can include a non hierarchical identifier such as a hash value that is derived from the Content Object s data e.g. a checksum value and or from elements of the Content Object s name. A description of a hash based name is described in U.S. patent application Ser. No. 13 847 814 entitled ORDERED ELEMENT NAMING FOR NAME BASED PACKET FORWARDING by inventor Ignacio Solis filed 20 Mar. 2013 which is hereby incorporated by reference. A name can also be a flat label. Hereinafter name is used to refer to any name for a piece of data in a name data network such as a hierarchical name or name prefix a flat name a fixed length name an arbitrary length name or a label e.g. a Multiprotocol Label Switching MPLS label .

A packet that indicates a request for a piece of data and includes a name or a name prefix for the piece of data. A data consumer can disseminate a request or Interest across an information centric network which CCN NDN routers can propagate toward a storage device e.g. a cache server or a data producer that can provide the requested data to satisfy the request or Interest.

In some embodiments the ICN system can include a content centric networking CCN architecture. However the methods disclosed herein are also applicable to other ICN architectures as well. A description of a CCN architecture is described in U.S. patent application Ser. No. 12 338 175 entitled CONTROLLING THE SPREAD OF INTERESTS AND CONTENT IN A CONTENT CENTRIC NETWORK by inventors Van L. Jacobson and K. Smetters filed 18 Dec. 2008 which is hereby incorporated by reference.

Computing environment can also include network which can be for example a content centric network CCN or an information centric network ICN . Network can include intermediate storage devices . . which can each contain storage means . . respectively to cache various content passed through network .

Computing environment can include a content producer that can host content requested by user via client computing device . Content producer can master encrypt and return the requested content to client computing device . Upon request from client computing device or one of intermediate storage devices . . content producer can also return a user specific re encryption key. Both the master encrypted content and the user specific re encryption key may be cached in one of intermediate storage devices . .residing in network . The cached data may be accessed upon future requests for the data such that content producer only needs to access and generate the master encrypted content and the user specific re encryption key once. Thus in a CCN this would efficiently utilize the networking caching capabilities of network .

Client computing device can re encrypt the master encrypted content to user specific encrypted content using the user specific re encryption key and can further decrypt this transformed user specific content by using a user specific decryption key. In some embodiments one of intermediate storage device . .can re encrypt the master encrypted content to user specific encrypted content using the user specific re encryption key and send the transformed user specific encrypted content to client computing device . Client computing device can then further decrypt this transformed user specific content by using a user specific decryption key.

Client device now in possession of the master encrypted content from receive master encrypted content message generates a request re encryption key interest . This request is for a user specific re encryption key and passes through intermediate storage . Content producer then receives this receive re encryption key request interest and generates a user specific re encryption key based on the information in the interest packet. The algorithm detailing the generation of the user specific re encryption key by content producer is shown in the PREKeyGen procedure in Table 2. Content producer then sends a return re encryption key content object back to client device which content object first passes through and may be cached at intermediate storage .

Client device now in possession of both the master encrypted content from receive master encrypted content message and the user specific re encryption key from receive re encryption key content object proceeds to decrypt the master encrypted content by performing a client re encrypt procedure whereby client device re encrypts the master encrypted content by using the user specific re encryption key to transform the master encrypted content to a user specific encrypted content. This user specific encrypted content can only be decrypted by a user specific decryption key. Then client device performs a client decrypt procedure and decrypts the user specific encrypted content using his user specific decryption key to obtain the requested content. The algorithm detailing the decryption of the master encrypted content by client device which encompasses both client re encrypt and client decrypt is shown in the CDecrypt procedure in Table 3.

The below algorithms list the explicit steps required for the encryption and re encryption key generating procedures in the content producer and the re encryption and decryption procedures in the client in accordance with an embodiment of the invention.

In these sample algorithms E and D refer to Advanced Encryption Standard AES symmetric key encryption and decryption respectively and Kis the secret key for client A generated from an offline KeyGen procedure. Furthermore the above listed sample algorithms in Tables 1 3 make calls to known algorithms used within the Proxy Re Encryption PRE scheme including the KeyGen Encrypt ReKeyGen ReEncrypt and Decrypt procedures. A general explanation of these known internal PRE procedures is described herein 

Intermediate storage obtains the user specific re encryption key by either 1 sending a request re encryption key interest to content producer and receiving a receive re encryption key content object from content producer who generates a user specific re encryption key based on the information in the interest packet see PReKeyGen algorithm in Table 2 or 2 accessing a previously cached copy of the user specific re encryption key residing in intermediate storage .

Intermediate storage now in possession of both the master encrypted content from receive master encrypted content message and the user specific re encryption key from receive re encryption key content object proceeds to transform the master encrypted content by performing an intermediate storage re encrypt procedure whereby intermediate storage re encrypts the master encrypted content by using the user specific re encryption key to transform the master encrypted content to a user specific encrypted content This user specific encrypted content can only be decrypted by a user specific decryption key.

Intermediate storage then sends this user specific encrypted content back to client device . Client device receives the user specific encrypted content in a receive user specific encrypted content message . Client device performs a client decrypt procedure and decrypts the user specific encrypted content using his user specific decryption key to obtain the requested content.

In order to decrypt the master encrypted content the client device obtains a re encryption key which is specific to the particular requesting user. So the client device generates an interest packet that includes a request for a user specific re encryption key operation . The client device then receives the requested user specific re encryption key which has been generated by e.g. a content producer. In a CCN this message could comprise a content object that includes the requested user specific re encryption key operation .

The client device then re encrypts the master encrypted content by using the user specific re encryption key to transform the master encrypted content to user specific encrypted content operation . Because the re encryption key is specific to the user the transformed content is also specific to the user such that the only way to finally decrypt the user specific encrypted content is to use the user specific decryption key operation . Furthermore because the transformation occurs for each user each user obtains a specifically encrypted version of the content which he can decrypt on the fly using his user specific decryption key on any of his computing devices. This provides a secure manner of storage for the content and also provides the user with an efficient way to transfer this user specific encrypted content between his various devices.

If the requested content does reside in the cache of intermediate storage then the client device simply receives the master encrypted content operation . In order to decrypt the master encrypted content the client device obtains a user specific re encryption key. As in the example of a CCN the client device generates an interest packet that includes a request for a user specific re encryption key operation . The system again determines whether the requested user specific re encryption key resides in the cache of an intermediate storage operation . If the requested user specific re encryption key does not reside in the cache of an intermediate storage then the request is sent on to a content producer. The content producer generates a user specific re encryption key operation . The content producer then returns the user specific re encryption key to the client device and the system caches the user specific re encryption key at intermediate storage along the way operation . The client device then receives the user specific re encryption key operation .

If the requested user specific re encryption key does reside in the cache of intermediate storage then the client device simply receives the user specific re encryption key operation . presents the continuation of method of . The client device performs re encryption operation by first re encrypting the master encrypted content using the user specific re encryption key transforming the master encrypted content to user specific encrypted content operation and then decrypting the user specific encrypted content by using a user specific decryption key operation .

Thus the system can make efficient use of the cached versions of previously requested and processed content here the master encrypted content and the user specific re encryption key by way of smart intermediate storage devices in the network. This along with the use of the user specific re encryption key to transform the master encrypted content to user specific encrypted content provides an efficient and secure manner of distribution of digital content that requires protection under DRM within a CCN.

If the requested content does reside in the cache of intermediate storage then the intermediate storage accesses the master encrypted content in its cache operation . The intermediate storage then obtains the user specific re encryption key operation by sending a request to and receiving a response from e.g. the content producer. The intermediate storage then performs a re encryption operation by re encrypting the master encrypted content using the user specific re encryption key to transform the master encrypted content to user specific encrypted content operation . The intermediate storage then returns and the client device then receives the transformed user specific encrypted content operation . Finally the client device decrypts the user specific encrypted content using a user specific decryption key operation .

If the requested user specific re encryption key does reside in the cache of an intermediate storage then the client device receives a content object that includes pricing information operation . This content object is based upon the contents of the generated first interest packet as shown in and could be sent to the client device by a content producer. The pricing information could also be specific to the user based on user authentication information included in interest packet . In response to the content object that includes pricing information the client device can generate a second interest packet that includes payment information operation .

At this point similar to the system caches the user specific re encryption key at the intermediate storage operation . The client device then receives a content object which based on the information in the first interest packet includes the user specific re encryption key operation . The client device performs re encryption by first re encrypting the master encrypted content using the user specific re encryption key transforming the master encrypted content to user specific encrypted content operation and then decrypting the user specific encrypted content by using a user specific decryption key operation .

In order to decrypt the symmetric key encrypted content the client device performs the following steps 1 re encrypts the master encrypted symmetric key by using the user specific re encryption key to transform the master encrypted symmetric key to a user specific encrypted symmetric key operation 2 decrypts the re encrypted symmetric key using the user specific decryption key operation and 3 decrypts the symmetric key encrypted content using the decrypted symmetric key operation .

In some embodiments communication mechanism can send requests for content and receive responses containing master encrypted content. Re encryption key obtaining mechanism can obtain a user specific re encryption key. This user specific re encryption key can be generated by a content producer and or previously cached at intermediate storage. Re encryption key obtaining mechanism can further generate an interest packet that includes a request for a user specific re encryption key and also receive a content object based on the information in the interest packet that includes the user specific re encryption key. When the generated interest packet also includes user authentication information pricing and payment mechanism can receive a content object that includes information relating to pricing based on information in the generated interest packet. Pricing and payment mechanism can also generate a second interest packet that includes information relating to payment.

Re encryption mechanism can re encrypt the master encrypted content by using the user specific re encryption key to transform the master encrypted content to a user specific encrypted content which can only be decrypted by a user specific decryption key. Re encryption mechanism can be performed by either a client device or intermediate storage. Decryption mechanism can decrypt the transformed user specific encrypted content by using the user specific decryption key.

Sending mechanism can send by an intermediate storage device the transformed user specific encrypted content to a client device thus allowing the client device to utilize decryption mechanism to decrypt the transformed user specific encrypted content using the user specific decryption key.

Symmetric key mechanism can include content received from communication mechanism where the received content is encrypted using a symmetric key and where the symmetric key has been encrypted by for example a content producer using a master encryption key. Symmetric key mechanism obtains a user specific re encryption key from re encryption key obtaining mechanism . Symmetric key mechanism also includes a re encryption mechanism that transforms the symmetric key encrypted content by re encrypting the master encrypted symmetric key using the user specific re encryption key to a user specific encrypted symmetric key decrypting the re encrypted symmetric key using the user specific decryption key and decrypting the symmetric key encrypted content using the decrypted symmetric key.

Content processing system can include instructions which when executed by computer and communication system can cause computer and communication system to perform methods and or processes described in this disclosure. Specifically content processing system may include instructions for sending requests for content and receiving responses containing master encrypted content communication mechanism . Further content processing system can include instructions for obtaining a user specific re encryption key that further includes generating an interest packet that includes a request for a user specific re encryption key and also receiving a content object based on the information in the interest packet that includes the user specific re encryption key re encryption key obtaining mechanism . Content processing system can also include instructions for receiving a content object that includes information relating to pricing based on information in the generated interest packet as well as instructions for generating a second interest packet that includes information relating to payment pricing and payment mechanism .

Content processing system can also include instructions for re encrypting master encrypted content by using the user specific re encryption key to transform the master encrypted content to a user specific encrypted content which can only be decrypted by a user specific decryption key re encryption mechanism . Content processing system can include instructions for sending the transformed user specific encrypted content sending mechanism . Content processing system can further include instructions for decrypting the transformed user specific encrypted content by using the user specific decryption key decryption mechanism .

Data can include any data that is required as input or that is generated as output by the methods and or processes described in this disclosure. Specifically data can store at least master encrypted content for one or more users cryptographic keys e.g. a user specific public key a user specific decryption key or a user specific re encryption key and user specific encrypted content for one or more users.

The data structures and code described in this detailed description are typically stored on a computer readable storage medium which may be any device or medium that can store code and or data for use by a computer system. The computer readable storage medium includes but is not limited to volatile memory non volatile memory magnetic and optical storage devices such as disk drives magnetic tape CDs compact discs DVDs digital versatile discs or digital video discs or other media capable of storing computer readable media now known or later developed.

The methods and processes described in the detailed description section can be embodied as code and or data which can be stored in a computer readable storage medium as described above. When a computer system reads and executes the code and or data stored on the computer readable storage medium the computer system performs the methods and processes embodied as data structures and code and stored within the computer readable storage medium.

Furthermore the methods and processes described above can be included in hardware modules or apparatus. The hardware modules or apparatus can include but are not limited to application specific integrated circuit ASIC chips field programmable gate arrays FPGAs dedicated or shared processors that execute a particular software module or a piece of code at a particular time and other programmable logic devices now known or later developed. When the hardware modules or apparatus are activated they perform the methods and processes included within them.

The foregoing descriptions of embodiments of the present invention have been presented for purposes of illustration and description only. They are not intended to be exhaustive or to limit the present invention to the forms disclosed. Accordingly many modifications and variations will be apparent to practitioners skilled in the art. Additionally the above disclosure is not intended to limit the present invention. The scope of the present invention is defined by the appended claims.

