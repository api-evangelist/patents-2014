---

title: Fast multi-touch stylus and sensor
abstract: A stylus and touch sensitive device are disclosed. The stylus includes a stylus transmitter for transmitting a stylus signal. The touch sensitive device includes row conductors, each of which is associated with a row transmitter and a row receiver. The row transmitter is adapted to simultaneously transmit row signals, each on its associated row conductor, each of the row signals being orthogonal to each other of the plurality of row signals transmitted on each other of the row conductors. The row receiver is adapted to detect the stylus signal. Column conductors are provided, each associated with a column receiver that is adapted to detect the presence of each of the row signals transmitted by the row transmitter and the stylus signal.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09235307&OS=09235307&RS=09235307
owner: Tactual Labs Co.
number: 09235307
owner_city: New York
owner_country: US
publication_date: 20140317
---
This application is a non provisional of and claims priority to U.S. Provisional Patent Application No. 61 798 948 entitled Fast Multi Touch Stylus filed Mar. 15 2013 this application is a continuation in part of U.S. patent application Ser. No. 13 841 436 entitled Low Latency Touch Sensitive Device filed Mar. 15 2013 this application is a continuation in part of U.S. patent application Ser. No. 14 069 609 entitled Fast Multi Touch Post Processing filed Nov. 1 2013 which is a non provisional of U.S. Provisional Patent Application No. 61 845 892 filed Jul. 12 2013. This application includes material which is subject to copyright protection. The copyright owner has no objection to the facsimile reproduction by anyone of the patent disclosure as it appears in the Patent and Trademark Office files or records but otherwise reserves all copyright rights whatsoever.

The disclosed system and method relate in general to the field of user input and in particular to user input systems which provide a novel stylus and fast multi touch sensor.

This application relates to user interfaces such as the fast multi touch sensors and other interfaces disclosed in U.S. patent application Ser. No. 13 841 436 filed Mar. 15 2013 entitled Low Latency Touch Sensitive Device U.S. Patent Application No. 61 928 069 filed Jan. 16 2014 entitled Fast Multi Touch Update Rate Throttling U.S. patent application Ser. No. 14 046 819 filed Oct. 4 2013 entitled Hybrid Systems And Methods For Low Latency User Input Processing And Feedback U.S. Patent Application No. 61 798 948 filed Mar. 15 2013 entitled Fast Multi Touch Stylus U.S. Patent Application No. 61 799 035 filed Mar. 15 2013 entitled Fast Multi Touch Sensor With User Identification Techniques U.S. Patent Application No. 61 798 828 filed Mar. 15 2013 entitled Fast Multi Touch Noise Reduction U.S. Patent Application No. 61 798 708 filed Mar. 15 2013 entitled Active Optical Stylus U.S. Patent Application No. 61 710 256 filed Oct. 5 2012 entitled Hybrid Systems And Methods For Low Latency User Input Processing And Feedback U.S. Patent Application No. 61 845 892 filed Jul. 12 2013 entitled Fast Multi Touch Post Processing U.S. Patent Application No. 61 845 879 filed Jul. 12 2013 entitled Reducing Control Response Latency With Defined Cross Control Behavior U.S. Patent Application No. 61 879 245 filed Sep. 18 2013 entitled Systems And Methods For Providing Response To User Input Using Information About State Changes And Predicting Future User Input U.S. Patent Application No. 61 880 887 filed Sep. 21 2013 entitled Systems And Methods For Providing Response To User Input Using Information About State Changes And Predicting Future User Input U.S. patent application Ser. No. 14 046 823 filed Oct. 4 2013 entitled Hybrid Systems And Methods For Low Latency User Input Processing And Feedback U.S. patent application Ser. No. 14 069 609 filed Nov. 1 2013 entitled Fast Multi Touch Post Processing U.S. Patent Application No. 61 887 615 filed Oct. 7 2013 entitled Touch And Stylus Latency Testing Apparatus and U.S. Patent Application No. 61 930 159 filed Jan. 22 2014 entitled Dynamic Assignment Of Possible Channels In A Touch Sensor and U.S. Patent Application No. 61 932 047 filed Jan. 27 2014 entitled Decimation Strategies For Input Event Processing. The entire disclosures of those applications are incorporated herein by this reference.

This disclosure will first describe the operation of fast multi touch sensors to which the present post processing may be described. The presently disclosed system and method however is not limited to post processing in connection with the fast multi touch sensors described below but rather may be applied broadly to other sensors without departing from the spirit and scope of the invention.

In an embodiment a fast multi touch sensor which utilizes the post processing techniques disclosed herein provides detection of touch events or other gestures from human fingers or other objects on a two dimensional manifold and has the capability for a touch event or multiple simultaneous touch events to be detected and distinguished from each other. As used herein the phrase touch event and the word touch when used as a noun include a near touch and a near touch event or any other gesture that can be identified using a sensor. In accordance with an embodiment touch events may be detected processed and supplied to downstream computational processes with very low latency e.g. on the order of ten milliseconds or less or on the order of less than one millisecond.

In an embodiment the disclosed fast multi touch sensor utilizes a projected capacitive method that has been enhanced for high update rate and low latency measurements of touch events. The technique can use parallel hardware and higher frequency waveforms to gain the above advantages. Also disclosed are methods to make sensitive and robust measurements which methods may be used on transparent display surfaces and which may permit economical manufacturing of products which employ the technique. In this regard a capacitive object as used herein could be a finger other part of the human body a stylus or any object to which the sensor is sensitive. The sensors and methods disclosed herein need not rely on capacitance. With respect to the optical sensor embodiment disclosed below such embodiments utilize photon tunneling and leaking to sense a touch event and a capacitive object as used herein includes any object such as a stylus or finger that that is compatible with such sensing. Similarly touch locations and touch sensitive device as used herein do not require actual touching contact between a capacitive object and the disclosed sensor.

With continued reference to in an embodiment generally the capacitive result of a touch event in the proximity of both a row and column may cause a non negligible amount of signal present on the row to be coupled to the column. More generally touch events cause and thus correspond to the received signals on the columns. Because the signals on the rows are orthogonal multiple row signals can be coupled to a column and distinguished by the receiver. Likewise the signals on each row can be coupled to multiple columns. For each column coupled to a given row the signals found on the column contain information that will indicate which rows are being touched simultaneously with that column. The quantity of each signal received is generally related to the amount of coupling between the column and the row carrying the corresponding signal and thus may indicate a distance of the touching object to the surface an area of the surface covered by the touch and or the pressure of the touch.

When a row and column are touched simultaneously some of the signal that is present on the row is coupled into the corresponding column. As discussed above the term touch or touched does not require actual physical contact but rather relative proximity. Indeed in various implementations of a touch device physical contact with the rows and or columns is unlikely as there may be a protective barrier between the rows and or columns and the finger or other object of touch. Moreover generally the rows and columns themselves are not in touch with each other but rather placed in a proximity that prevents more than a negligible amount of signal to be coupled there between. Generally the row column coupling results not from actual contact between them nor by actual contact from the finger or other object of touch but rather by the capacitive effect of bringing the finger or other object into close proximity which close proximity resulting in capacitive effect is referred to herein as touch. 

The nature of the rows and columns is arbitrary and the particular orientation is irrelevant. Indeed the terms row and column are not intended to refer to a square grid but rather to a set of conductors upon which signal is transmitted rows and a set of conductors onto which signal may be coupled columns . It is not even necessary that the rows and columns be in a grid at all. Other shapes are possible as long as a touch event will touch part of a row and part of a column and cause some form of coupling. For example the rows could be in concentric circles and the columns could be spokes radiating out from the center. Moreover it is not necessary for there to be only two types signal propagation channels instead of rows and columns in an embodiment channels A B and C may be provided where signals transmitted on A could be received on B and C or in an embodiment signals transmitted on A and B could be received on C . It is also possible that the signal propagation channels can alternate function sometimes supporting transmitters and sometimes supporting receivers. Many alternative embodiments are possible and will be apparent to a person of skill in the art after considering this disclosure.

As noted above in an embodiment the touch surface comprises of a series of rows and columns along which signals can propagate. As discussed above the rows and columns are designed so that when they are not being touched a negligible amount of signal is coupled between them. Moreover a different signal is transmitted into each of the rows. In an embodiment each of these different signals are orthogonal i.e. separable and distinguishable from one another. When a row and column are touched simultaneously a non negligible amount of the signal that is present on the row is coupled into the corresponding column. The quantity of the signal that is coupled onto a column may be related to the pressure or area of touch.

A receiver is attached to each column. The receiver is designed to receive non negligible amounts of any of the orthogonal signals or an arbitrary combination of the orthogonal signals and to identify the columns providing non negligible amounts of signal. In an embodiment the receiver may measure the quantity of each of the orthogonal transmitted signals present on that column. In this manner in addition to identifying the rows in touch with each column the receiver can provide additional e.g. qualitative information concerning the touch. In general touch events may correspond to the received signals on the columns. For each column the different signals received thereon indicate which of the corresponding rows is being touched simultaneously with that column. In an embodiment the non negligible quantity of each signal received may be related to the amount of coupling between the corresponding row and column and may indicate the area of the surface covered by the touch the pressure of the touch etc.

In an embodiment the orthogonal signals being transmitted into the rows may be unmodulated sinusoids each having a different frequency the frequencies being chosen so that they can be easily distinguished from each other in the receiver. In an embodiment frequencies are selected to provide sufficient spacing between them such that they can be easily distinguished from each other in the receiver. In an embodiment no simple harmonic relationships exist between the selected frequencies. The lack of simple harmonic relationships may mitigate non linear artifacts that can cause one signal to mimic another.

Generally a comb of frequencies where the spacing between adjacent frequencies is constant and the highest frequency is less than twice the lowest will meet these criteria if the spacing between frequencies f is at least the reciprocal of the measurement period . For example if it is desired to measure a combination of signals from a column for example to determine which row signals are present once per millisecond then the frequency spacing f must be greater than one kilohertz i.e. f 1 . According to this calculation in an example case with only ten rows one could use the following frequencies 

It will be apparent to one of skill in the art that frequency spacing may be substantially greater than this minimum to permit robust design. As an example a 20 cm by 20 cm touch surface with 0.5 cm row column spacing would require forty rows and forty columns and necessitate sinusoids at forty different frequencies. While a once per millisecond analysis rate would require only 1 KHz spacing an arbitrarily larger spacing is utilized for a more robust implementation. The arbitrarily larger spacing is subject to the constraint that the maximum frequency should not be more than twice the lowest i.e. f

In an embodiment each of the sinusoids on the list may be generated by a signal generator and transmitted on a separate row by the transmitter. To identify the rows and columns that are being simultaneously touched a receiver receives any signals present on the columns and a signal processor analyzes the signal to determine which if any frequencies on the list appear. In an embodiment the identification can be supported with a frequency analysis technique e.g. Fourier transform or by using a filter bank.

In an embodiment from each column s signal the receiver can determine the strength of each frequency from the list of frequencies found in the signal on that column. In an embodiment where the strength of a frequency is greater than some threshold the signal processor identifies there being a touch event between the column and the row corresponding to that frequency. In an embodiment signal strength information which may correspond to various physical phenomena including the distance of the touch from the row column intersection the size of the touch object the pressure with which the object is pressing down the fraction of row column intersection that is being touched etc. may be used as an aid to localize the area of the touch event.

Once the signals strengths have been calculated for at least two frequencies corresponding to rows or for at least two columns a two dimensional map can be created with the signal strength being the value of the map at that row column intersection. In an embodiment the signals strengths are calculated for each frequency on each column. Once signal strengths are calculated a two dimensional map may be created. In an embodiment the signal strength is the value of the map at that row column intersection. In an embodiment due to physical differences in the touch surface at different frequencies the signal strengths need to be normalized for a given touch or calibrated. Similarly in an embodiment due to physical differences across the touch surface or between the intersections the signal strengths need to be normalized for a given touch or calibrated.

In an embodiment the two dimensional map data may be thresholded to better identify determine or isolate touch events. In an embodiment the two dimensional map data may be used to infer information about the shape orientation etc. of the object touching the surface.

Returning to the discussion of the signals being transmitted on the rows a sinusoid is not the only orthogonal signal that can be used in the configuration described above. Indeed as discussed above any set of signals that can be distinguished from each other will work. Nonetheless sinusoids may have some advantageous properties that may permit simpler engineering and more cost efficient manufacture of devices which use this technique. For example sinusoids have a very narrow frequency profile by definition and need not extend down to low frequencies near DC. Moreover sinusoids can be relatively unaffected by 1 f noise which noise could affect broader signals that extend to lower frequencies.

In an embodiment sinusoids may be detected by a filter bank. In an embodiment sinusoids may be detected by frequency analysis techniques e.g. Fourier transform . Frequency analysis techniques may be implemented in a relatively efficient manner and may tend to have good dynamic range characteristics allowing them to detect and distinguish between a large number of simultaneous sinusoids. In broad signal processing terms the receiver s decoding of multiple sinusoids may be thought of as a form of frequency division multiplexing. In an embodiment other modulation techniques such as time division and code division multiplexing could also be used. Time division multiplexing has good dynamic range characteristics but typically requires that a finite time be expended transmitting into or analyzing received signals from the touch surface. Code division multiplexing has the same simultaneous nature as frequency division multiplexing but may encounter dynamic range problems and may not distinguish as easily between multiple simultaneous signals.

In an embodiment a modulated sinusoid may be used in lieu of in combination with and or as an enhancement of the sinusoid embodiment described above. The use of unmodulated sinusoids may cause radiofrequency interference to other devices near the touch surface and thus a device employing them might encounter problems passing regulatory testing e.g. FCC CE . In addition the use of unmodulated sinusoids may be susceptible to interference from other sinusoids in the environment whether from deliberate transmitters or from other interfering devices perhaps even another identical touch surface . In an embodiment such interference may cause false or degraded touch measurements in the described device.

In an embodiment to avoid interference the sinusoids may be modulated or stirred prior to being transmitted by the transmitter in a manner that the signals can be demodulated unstirred once they reach the receiver. In an embodiment an invertible transformation or nearly invertible transformation may be used to modulate the signals such that the transformation can be compensated for and the signals substantially restored once they reach the receiver. As will also be apparent to one of skill in the art signals emitted or received using a modulation technique in a touch device as described herein will be less correlated with other things and thus act more like mere noise rather than appearing to be similar to and or being subject to interference from other signals present in the environment.

In an embodiment a modulation technique utilized will cause the transmitted data to appear fairly random or at least unusual in the environment of the device operation. Two modulation schemes are discussed below Frequency Modulation and Direct Sequence Spread Spectrum Modulation.

Frequency modulation of the entire set of sinusoids keeps them from appearing at the same frequencies by smearing them out. Because regulatory testing is generally concerned with fixed frequencies transmitted sinusoids that are frequency modulated will appear at lower amplitudes and thus be less likely to be a concern. Because the receiver will un smear any sinusoid input to it in an equal and opposite fashion the deliberately modulated transmitted sinusoids can be demodulated and will thereafter appear substantially as they did prior to modulation. Any fixed frequency sinusoids that enter e.g. interfere from the environment however will be smeared by the unsmearing operation and thus will have a reduced or an eliminated effect on the intended signal. Accordingly interference that might otherwise be caused to the sensor is lessened by employing frequency modulation e.g. to a comb of frequencies that in an embodiment are used in the touch sensor.

In an embodiment the entire set of sinusoids may be frequency modulated by generating them all from a single reference frequency that is itself modulated. For example a set of sinusoids with 100 kHz spacing can be generated by multiplying the same 100 kHz reference frequency by different integers. In an embodiment this technique can be accomplished using phase locked loops. To generate the first 5.0 MHz sinusoid one could multiply the reference by 50 to generate the 5.1 MHz sinusoid one could multiply the reference by 51 and so forth. The receiver can use the same modulated reference to perform the detection and demodulation functions.

In an embodiment the sinusoids may be modulated by periodically inverting them on a pseudo random or even truly random schedule known to both the transmitter and receiver. Thus in an embodiment before each sinusoid is transmitted to its corresponding row it is passed through a selectable inverter circuit the output of which is the input signal multiplied by 1 or 1 depending on the state of an invert selection input. In an embodiment all of these invert selection inputs are driven from the same signal so that the sinusoids for each row are all multiplied by either 1 or 1 at the same time. In an embodiment the signal that drives the invert selection input may be a pseudorandom function that is independent of any signals or functions that might be present in the environment. The pseudorandom inversion of the sinusoids spreads them out in frequency causing them to appear like random noise so that they interfere negligibly with any devices with which they might come in contact.

On the receiver side the signals from the columns may be passed through selectable inverter circuits that are driven by the same pseudorandom signal as the ones on the rows. The result is that even though the transmitted signals have been spread in frequency they are despread before the receiver because they have been multiplied by either 1 or 1 twice leaving them in or returning them to their unmodified state. Applying direct sequence spread spectrum modulation may spread out any interfering signals present on the columns so that they act only as noise and do not mimic any of the set of intentional sinusoids.

In an embodiment selectable inverters can be created from a small number of simple components and or can be implemented in transistors in a VLSI process.

Because many modulation techniques are independent of each other in an embodiment multiple modulation techniques could be employed at the same time e.g. frequency modulation and direct sequence spread spectrum modulation of the sinusoid set. Although potentially more complicated to implement such multiple modulated implementation may achieve better interference resistance.

Because it would be extremely rare to encounter a particular pseudo random modulation in the environment it is likely that the multi touch sensors described herein would not require a truly random modulation schedule. One exception may be where more than one touch surface with the same implementation is being touched by the same person. In such a case it may be possible for the surfaces to interfere with each other even if they use very complicated pseudo random schedules. Thus in an embodiment care is taken to design pseudo random schedules that are unlikely to conflict. In an embodiment some true randomness may be introduced into the modulation schedule. In an embodiment randomness is introduced by seeding the pseudo random generator from a truly random source and ensuring that it has a sufficiently long output duration before it repeats . Such an embodiment makes it highly unlikely that two touch surfaces will ever be using the same portion of the sequence at the same time. In an embodiment randomness is introduced by exclusive or ing XOR the pseudo random sequence with a truly random sequence. The XOR function combines the entropy of its inputs so that the entropy of its output is never less than either input.

Touch surfaces using the previously described techniques may have a relatively high cost associated with generating and detecting sinusoids compared to other methods. Below are discussed methods of generating and detecting sinusoids that may be more cost effective and or be more suitable for mass production.

In an embodiment sinusoids may be detected in a receiver using a complete radio receiver with a Fourier Transform detection scheme. Such detection may require digitizing a high speed RF waveform and performing digital signal processing thereupon. Separate digitization and signal processing may be implemented for every column of the surface this permits the signal processor to discover which of the row signals are in touch with that column. In the above noted example having a touch surface with forty rows and forty columns would require forty copies of this signal chain. Today digitization and digital signal processing are relatively expensive operations in terms of hardware cost and power. It would be useful to utilize a more cost effective method of detecting sinusoids especially one that could be easily replicated and requires very little power.

In an embodiment sinusoids may be detected using a filter bank. A filter bank comprises an array of bandpass filters that can take an input signal and break it up into the frequency components associated with each filter. The Discrete Fourier Transform DFT of which the FFT is an efficient implementation is a form of a filter bank with evenly spaced bandpass filters that is commonly used for frequency analysis. DFTs may be implemented digitally but the digitization step may be expensive. It is possible to implement a filter bank out of individual filters such as passive LC inductor and capacitor or RC active filters. Inductors are difficult to implement well on VLSI processes and discrete inductors are large and expensive so it may not be cost effective to use inductors in the filter bank.

At lower frequencies about 10 MHz and below it is possible to build banks of RC active filters on VLSI. Such active filters may perform well but may also take up a lot of die space and require more power than is desirable.

At higher frequencies it is possible to build filter banks with surface acoustic wave SAW filter techniques. These allow nearly arbitrary FIR filter geometries. SAW filter techniques require piezoelectric materials which are more expensive than straight CMOS VLSI. Moreover SAW filter techniques may not allow enough simultaneous taps to integrate sufficiently many filters into a single package thereby raising the manufacturing cost.

In an embodiment sinusoids may be detected using an analog filter bank implemented with switched capacitor techniques on standard CMOS VLSI processes that employs an FFT like butterfly topology. The die area required for such an implementation is typically a function of the square of the number of channels meaning that a 64 channel filter bank using the same technology would require only 1 256th of the die area of the 1024 channel version. In an embodiment the complete receive system for the low latency touch sensor is implemented on a plurality of VLSI dies including an appropriate set of filter banks and the appropriate amplifiers switches energy detectors etc. In an embodiment the complete receive system for the low latency touch sensor is implemented on a single VLSI die including an appropriate set of filter banks and the appropriate amplifiers switches energy detectors etc. In an embodiment the complete receive system for the low latency touch sensor is implemented on a single VLSI die containing n instances of an n channel filter bank and leaving room for the appropriate amplifiers switches energy detectors etc.

Generating the transmit signals e.g. sinusoids in a low latency touch sensor is generally less complex than detection principally because each row requires the generation of a single signal while the column receivers have to detect and distinguish between many signals. In an embodiment sinusoids can be generated with a series of phase locked loops PLLs each of which multiply a common reference frequency by a different multiple.

In an embodiment the low latency touch sensor design does not require that the transmitted sinusoids are of very high quality but rather accommodates transmitted sinusoids that have more phase noise frequency variation over time temperature etc. harmonic distortion and other imperfections than may usually be allowable or desirable in radio circuits. In an embodiment the large number of frequencies may be generated by digital means and then employ a relatively coarse analog to digital conversion process. As discussed above in an embodiment the generated row frequencies should have no simple harmonic relationships with each other any non linearities in the described generation process should not cause one signal in the set to alias or mimic another.

In an embodiment a frequency comb may be generated by having a train of narrow pulses filtered by a filter bank each filter in the bank outputting the signals for transmission on a row. The frequency comb is produced by a filter bank that may be identical to a filter bank that can be used by the receiver. As an example in an embodiment a 10 nanosecond pulse repeated at a rate of 100 kHz is passed into the filter bank that is designed to separate a comb of frequency components starting at 5 MHz and separated by 100 kHz. The pulse train as defined would have frequency components from 100 kHz through the tens of MHz and thus would have a signal for every row in the transmitter. Thus if the pulse train were passed through an identical filter bank to the one described above to detect sinusoids in the received column signals then the filter bank outputs will each contain a single sinusoid that can be transmitted onto a row.

It may be desirable that the touch surface be integrated with a computer display so that a person can interact with computer generated graphics and imagery. While front projection can be used with opaque touch surfaces and rear projection can be used with translucent ones modern flat panel displays LCD plasma OLED etc. generally require that the touch surface be transparent. In an embodiment the present technique s rows and columns which allow signals to propagate along them need to be conductive to those signals. In an embodiment the present technique s rows and columns which allow radio frequency signals to propagate along them need to be electrically conductive.

If the rows and columns are insufficiently conductive the resistance per unit length along the row column will combine with the capacitance per unit length to form a low pass filter any high frequency signals applied at one end will be substantially attenuated as they propagate along the poor conductor.

Visually transparent conductors are commercially available e.g. indium tin oxide or ITO but the tradeoff between transparency and conductivity is problematic at the frequencies that may be desirable for some embodiments of the low latency touch sensor described herein if the ITO were thick enough to support certain desirable frequencies over certain lengths it may be insufficiently transparent for some applications. In an embodiment the rows and or columns may be formed entirely or at least partially from graphene and or carbon nanotubes which are both highly conductive and optically transparent.

In an embodiment the rows and or columns may be formed from one or more fine wires that block a negligible amount of the display behind them. In an embodiment the fine wires are too small to see or at least too small to present a visual impediment when viewing a display behind it. In an embodiment fine silver wires patterned onto transparent glass or plastic can be used to make up the rows and or columns. Such fine wires need to have sufficient cross section to create a good conductor along the row column but it is desirable for rear displays that such wires are small enough and diffuse enough to block as little of the underlying display as appropriate for the application. In an embodiment the fine wire size is selected on the basis of the pixels size and or pitch of the underlying display.

As an example the new Apple Retina displays comprises about 300 pixels per inch which yields a pixel size of about 80 microns on a side. In an embodiment a 20 micron diameter silver wire 20 centimeters long the length of an iPad display which has a resistance of about 10 ohms is used as a row and or column and or as part of a row and or column in a low latency touch sensor as described herein. Such 20 micron diameter silver wire however if stretched across a retina display may block up to 25 of an entire line of pixels. Accordingly in an embodiment multiple thinner diameter silver wires may be employed as a column or row which can maintain an appropriate resistance and provide acceptable response with respect to radiofrequency skin depth issues. Such multiple thinner diameter silver wires can be laid in a pattern that is not straight but rather somewhat irregular. A random or irregular pattern of thinner wires is likely to be less visually intrusive. In an embodiment a mesh of thin wires is used the use of a mesh will improve robustness including against manufacturing flaws in patterning. In an embodiment single thinner diameter wires may be employed as a column or row provided that the thinner wire is sufficiently conductive to maintain an appropriate level resistance and acceptable response with respect to radiofrequency skin depth issues.

A touch event with an area greater than one of the diamonds will cover at least part of a row and a column which will permit some coupling of a row signal into the overlapped column. In an embodiment the diamonds are sized to be smaller than the touching implement finger stylus etc. . In an embodiment a 0.5 cm spacing between rows and columns performs well for human fingers.

In an embodiment a simple grid of wires is employed as the rows and columns. Such a grid would provide less surface area for the rows and columns but can suffice for radio frequency signals and provide a sufficient non negligible coupling which can be detected by a receiver.

In an embodiment the diamond patterns for the rows and columns as shown in can be created by using a randomly connected mesh of thin wires that fills the space of the indicated shapes or by combining wire mesh and an another transparent conductor such as ITO. In an embodiment thin wires may be used for long stretches of conductivity e.g. across the entire screen and ITO may be used for local areas of conductivity such as the diamond shaped areas.

While radiofrequency and electrical methods of implementing the described fast multi touch technique have been discussed above other media can be employed as well. For example the signals can be optical signals i.e. light having waveguides or other means for the rows and columns. In an embodiment the light used for the optical signals may be in the visible region the infrared and or the ultraviolet.

In an embodiment instead of electrically conductive rows and columns that carry radiofrequency signals the rows and columns could comprise optical waveguides such as optical fiber fed by one or more light sources that generate orthogonal signals and are coupled to the waveguides by an optical coupler. For example a different distinct wavelength of light could be injected into each row fiber. When a human finger touches a row fiber some of the light in it will leak i.e. couple into the finger due to frustrated total internal reflection. Light from the finger may then enter one of the column fibers due to the reciprocal process and propagate to a detector at the end of the fiber.

In an embodiment optical signals may be generated with LEDs of different wavelengths or by using optical filters. In an embodiment custom interference filters are employed. In an embodiment the different wavelengths of light present on the fiber columns can be detected using optical filter banks. In an embodiment such optical filter banks may be implemented using custom interference filters. In an embodiment wavelengths of light outside the visible spectrum e.g. infrared and or ultraviolet light may be used to avoid adding extra visible light to the display.

In an embodiment the row and column fibers may be woven together so that a finger can touch them simultaneously. In an embodiment the woven construction may be made as visually transparent as needed to avoid obscuring the display.

After the signal strengths from each row in each column have been calculated using for example the procedures described above post processing is performed to convert the resulting 2 D heat map into usable touch events. In an embodiment such post processing includes at least some of the following four procedures field flattening touch point detection interpolation and touch point matching between frames. The field flattening procedure subtracts an offset level to remove crosstalk between rows and columns and compensates for differences in amplitude between particular row column combinations due to attenuation. The touch point detection procedure computes the coarse touch points by finding local maxima in the flattened signal. The interpolation procedure computes the fine touch points by fitting data associated with the coarse touch points to a paraboloid. The frame matching procedure matches the calculated touch points to each other across frames. Below each of the four procedures is described in turn. Also disclosed are examples of implementation possible failure modes and consequences for each processing step. Because of the requirement for very low latency the processing steps should be optimized and parallelized.

We first describe the field flattening procedure. Systematic issues due to the design of the touch surface and sensor electronics may cause artifacts in each column s received signal strength. These artifacts can be compensated for as follows. First because of cross talk between the rows and columns the received signal strength for each row column combination will experience an offset level. To a good approximation this offset level will be constant and can be subtracted off.

Second the amplitude of the signal received at a column due to a calibrated touch at a given row and column intersection will depend on that particular row and column mostly due to attenuation of the signals as they propagate along the row and column. The farther they travel the more attenuation there will be so columns farther from the transmitters and rows farther from the receivers will have lower signal strengths in the heat map than their counterparts. If the RF attenuation of the rows and columns is low the signal strength differences may be negligible and little or no compensation will be necessary. If the attenuation is high compensation may be necessary or may improve the sensitivity or quality of touch detection. Generally the signal strengths measured at the receivers are expected to be linear with the amount of signal transmitted into the columns. Thus in an embodiment compensation will involve multiplying each location in the heat map by a calibration constant for that particular row column combination. In an embodiment measurements or estimates may be used to determine a heat map compensation table which table can be similarly used to provide the compensation by multiplication. In an embodiment a calibration operation is used to create a heat map compensation table. The term heat map as used herein need not require an actual map of heat but rather the term can mean any array of at least two dimensions comprising data corresponding to locations.

In an exemplary embodiment the entire field flattening procedure is as follows. With nothing touching the surface first measure the signal strength for each row signal at each column receiver. Because there are no touches substantially the entire signal received is due to cross talk. The value measured e.g. the amount of each row s signal found on each column is an offset level that needs to be subtracted from that position in the heat map. Then with the constant offsets subtracted place a calibrated touch object at each row column intersection and measure the signal strength of that row s signal at that column receiver. The signal processor may be configured to normalize the touch events to the value of one location on the touch surface. We can arbitrarily choose the location likely to have the strongest signals because it experiences the least attenuation i.e. the row column intersection closest to the transmitters and receivers. If the calibrated touch signal strength at this location is Sand the calibrated touch signal strength for each row and column is Sthen if we multiply each location in the heat map by S S then all touch values will be normalized. For calibrated touches the normalized signal strength for any row column in the heat map will be equal to one.

The field flattening procedure parallelizes well. Once the offsets and normalization parameters are measured and stored which should only need to be done once or possibly again at a maintenance interval the corrections can be applied as soon as each signal strength is measured. illustrates an embodiment of a field flattening procedure.

In an embodiment calibrating each row column intersection may be required at regular or selected maintenance intervals. In an embodiment calibrating each row column intersection may be required once per unit. In an embodiment calibrating each row column intersection may be required once per design. In an embodiment and particularly where e.g. RF attenuation of the rows and columns is low calibrating each row column intersection may not be required at all. Moreover in an embodiment where the signal attenuation along the rows and columns is fairly predictable it may be possible to calibrate an entire surface from only a few intersection measurements.

If a touch surface does experience a lot of attenuation the field flattening procedure will at least to some degree normalize the measurements but it may have some side effects. For example the noise on each measurement will grow as its normalization constant gets larger. It will be apparent to one of skill in the art that for lower signal strengths and higher attenuations this may cause errors and instability in the touch point detection and interpolation processes. Accordingly in an embodiment care is taken to provide sufficient signal strength for the largest attenuation e.g. the farthest row column intersection .

We now turn to touch point detection. Once the heat map is generated and the field flattened one or more coarse touch points can be identified. Identifying the one or more coarse touch points is done by finding local maxima in the normalized i.e. flattened signal strengths. A fast and parallelizable method for finding the one or more touch points involves comparing each element of the normalized heat map to its neighbors and label it a local maximum if it is strictly greater than all of them. In an embodiment a point is identified as a local maximum if it is both strictly greater than all of its neighbors and above a given threshold.

It is within the scope of this disclosure to define the set of neighbors in various ways. In an embodiment the nearest neighbors are defined by a Von Neumann neighborhood. In an embodiment the nearest neighbors are defined by a Moore neighborhood. The Von Neumann neighborhood may consists of the four elements that are vertically and horizontally adjacent to the element in the center i.e. the elements to the north south east and west of it . This is also called a four connected neighborhood. More complex i.e. larger Von Neumann neighborhoods are also applicable and may be used. The Moore neighborhood consists of the eight elements that are vertically horizontally and diagonally adjacent to the element in the center i.e. the elements to the north south east west northeast northwest southeast and southwest of it . This is also called the eight connected neighborhood.

The neighborhood chosen will depend on the interpolation scheme used to calculate the fine touch points. This is illustrated in further detail below.

In a given neighbor comparison a special case may exists where an element s normalized signal strength is equal to one or more of its neighbors strictly or within a tolerance to allow for noise levels. In an embodiment neither point in such pairs is considered to be a touch point even if they have values above the threshold. In an embodiment both points in such pairs are considered to be touch points. In an embodiment regions where two or more neighboring points have approximately the same value are treated as one touch event. In an embodiment regions where two or more neighboring points have approximately the same value are treated as a different type of touch event e.g. perhaps someone has their wrist in contact with the touch surface from the regions where a single local maxima can be found.

Turning now to the interpolation procedure. Once the coarse touch points have been determined i.e. identified fine touch points can be computed using interpolation. In an embodiment the capacitive contact of a distributed touch is fit to a model function having a maximum. In an embodiment the model function is a second order function in two or more dimensions. In an embodiment the second order function is a paraboloid. In an embodiment the paraboloid model is an acceptable approximation for a variety of objects that may be used to touch a touch surface such as a finger or stylus. Moreover as discussed below the paraboloid model is relatively non intensive computationally. In an embodiment a more complex or more computationally intensive model may be used to provide more accurate estimation of the touch from the flattened heat map. For the purposes of the discussion below the paraboloid is used as an illustrative example but as will be apparent to one of skill in the art other models including models of greater or lesser complexity may be employed for the purpose of interpolation.

Where x and y are the position of an element z is the signal strength of the element and A C D E and F are the coefficients of the second order polynomial. Relative to the central point all of element x y positions are constant. The z values are the measured signal strengths at each element and thus are known. In an embodiment five simultaneous equations can be used to solve for the five unknown polynomial coefficients. Each equation represents one of the five points including the central point and its four neighbors.

In an embodiment a Vandermonde like matrix can be employed to solve for the polynomial coefficients as follows 

In an embodiment the polynomial coefficients are a linear combination of the signal strengths and only simple multiplication involving negation and a single shift are required to calculate them accordingly they can be efficiently computed in an FPGA or ASIC.

Thus in an embodiment where the neighborhood data is fit to a paraboloid and because a paraboloid has one maximum that maximum is used as a location of the fine touch point. In an embodiment utilizing the four connected neighborhood the values xand yare independent of each other with xdepending only on the signal strengths of the elements to the left and right of the center point and ydepending only on the signal strengths of the elements above and below it.

This equation has an added xy cross term and a new B coefficient that permits the model to compensate for elongation in a direction other than x or y. Again relative to the central point all of the element x y positions are constant and the z values are known. Nine simultaneous equations one per element can be used to determine i.e. overdetermine the six unknown polynomial coefficients. A least squares technique may be used to solve for the six unknown polynomial coefficients.

A Vandermonde like matrix may be used to fit the polynomial. Unlike the embodiment described above the matrix is non square with nine rows and six columns.

All of the entries in the Vandermonde like matrix are constant and the z values are known so substituting in the constant values yields

Because the Vandermonde like matrix is non square it cannot be inverted to solve for the polynomial coefficients. It can be solved however using its Moore Penrose pseudo inverse and performing a least squares fit to the polynomial coefficients. In an embodiment the pseudo inverse is defined as 

The polynomial coefficients are a linear combination of the signal strengths. The multiplications are slightly more complicated but many of the multiplicands can be factored out and applied a single time near the end of the calculation. The purpose of this step is to find the maximum of a paraboloid. Accordingly overall scale factors are irrelevant and focus need only be on relative values and arguments which maximize the function in an embodiment many of the operations may be able to cancel out improving the efficiency of implementation.

As above the fine touch point is presumed at the maximum of the paraboloid where both partial derivatives are zero 

For the eight connected neighborhood the values xand yare not independent of each other. Both depend on the signal strengths of all eight neighbors. Thus this approach may have an increased computational burden and the possibility that certain combinations of signal strengths will produce singular values for the fine touch points. In an embodiment using the least squares approach on the eight Moore neighbors such an implementation is more robust against noisy signal strength values. In other words in an embodiment small errors in one signal strength will be compensated for by the increased amount of data used in the calculation and the self consistency of that data.

Moreover the eight connected neighborhood provides a B coefficient an extra piece of information that might prove useful as part of a user interface. The B coefficient of the xy cross term can be used to characterize asymmetry in the fitted paraboloid and along with the aspect ratio information inherent in the A and C coefficients which could allow software to determine the angle at which a touch is occurring.

Knowledge of the angle can provide information on the orientation of the ellipse and might for example indicate which way a finger or stylus is pointing. can be calculated from the eigenvalues and eignevectors of the 2 2 matrix M given by the following 

This matrix will have two eignevalues and two eigenvectors. The eigevector associated with the largest eigenvalue will point in the direction of the ellipse s major axis. The other eigenvector will point in the direction of the minor axis. The eigenvalues and can be computed as follows 

Where tr M is the trace of the matrix M which is equal to AC and det M is the determinant of the matrix M which is equal to AC B 4.

Once the eigenvalues are obtained we can use the Cayley Hamilton theorem to compute the eigenvectors. The eigenvector associated with is either of the columns of the matrix M I and the eigenvector associated with is either of the columns of the matrix M I. Note the reversal of the eigenvalue indexes. The angle that the major axis of the ellipse makes with respect to the x axis of our coordinate system is the arctangent of the slope of the eigenvector. The slope of the eigenvector is just y x.

As discussed above the interpolation step requires determining a fine touch point e.g. using data acquired from a flattened heat map but is not limited to the illustrative paraboloid model discussed above. The purpose of determining a fine touch point is to permit the post processor to provide better granularity in touch points and specifically to provide granularity that exceeds the sensor s intersections. Stated another way the modeled and interpolated fine touch point can land directly on a row column intersection or anywhere in between the intersections. There may be a tradeoff between the accuracy of the model and its computational requirements similarly there may be a tradeoff between the accuracy of the model and its ability to provide an interpolated fine touch point that corresponds with the actual touch. Thus in an embodiment a model is selected to require the smallest computational load while providing sufficient correspondence between the interpolated touch point and the actual touch. In an embodiment a model is selected to require sufficient correspondence between the interpolated touch point and the actual touch and the processing hardware is selected to accommodate the computational load of the model. In an embodiment a model is selected that does not exceed the computational capacity of pre selected hardware and or other software operating the touch interface.

Turning to the frame matching procedure to properly track objects moving on the touch surface over time it is important to match the calculated touch points to each other across frame boundaries and thus e.g. to track objects moving on the touch surface as they move. Stated another way each calculated touch point in one frame should be identified in or have another disposition e.g. removed in the subsequent frame. While this is a fundamentally difficult problem which may be insoluble in the general case an embodiment can be implemented using both geometry and the laws of physics. Because the items that are in contact with the touch surface are of finite size and move according to certain physical principles certain cases can be ignored as being outside of plausible ranges. Moreover in an embodiment the frame rate should be sufficient to permit object tracking that is frame to frame touch point tracking with reasonable certainty. Thus for example where objects to be tracked are either known to move at a maximum rate across the touch surface or the tracking is designed to track the objects only up to a maximum rate a frame rate can be selected that will permit tracking with reasonable certainty. For example if a maximum rate of movement across the rows or columns of the touch surface is e.g. 1000 rows or columns per second then a frame rate of 1000 Hz will see an object move no more than 1 row or column per frame. In an embodiment touch point interpolation as discussed above can provide a more precise measure of the touch point location and thus intra row and intra column positions are readily identifiable as described more fully herein.

Fingers and styluses have a minimum size and are unlikely to approach each other closely enough to cause an ambiguous case. They also travel at speeds characteristic of the motion of a human arm and its parts e.g. wrist elbow fingers etc. which bounds the problem. Because the touch surface of the presently disclosed sensor has a relatively high update rate which in an embodiment may be on the order of one kilohertz or more fingers and styluses touching the surface cannot move very far or at extreme angles during the update period from one frame to the next. Because of the limited distances and angles tracking can be somewhat simplified according to the present disclosure.

In an embodiment tracking of objects moving on the touch surface over time is performed by comparing data from one frame to one or more past frames. In an embodiment data concerning past frames e.g. a heat map may be maintained in a temporary buffer. In an embodiment processed data concerning past frames e.g. field flattened heat map or fitted polynomial coefficients may be maintained in a temporary buffer. In an embodiment the data concerning a past frame that is maintained in a temporary buffer may include or may consist of an interpolated fine touch point coordinate for each fine touch point in the prior frame and to the extent such exists vectors concerning prior motion of those fine touch points. The temporary buffer may retain data concerning one or more past frames and may cease to retain the data when it is no longer relevant to later calculations.

In an embodiment the frame matching process initially presumes that an object s touch point in the current frame i is probably the touch point in the prior frame i.e. i 1 which is geometrically closest to it.

In an embodiment data concerning the motion of a touch point e.g. velocity and direction are determined and stored in connection with one or more frames. In an embodiment data concerning the motion of a touch point is used to predict a likely location for that touch point in the next frame. Data concerning the motion of a touch point may comprise for example velocity or change in position and may come from one or more prior frames. In an embodiment predicting a likely location in a frame is done by considering the motion between two frames yielding a per frame displacement and its direction. In an embodiment predicting a likely location in a frame is done by considering the motion in three or more frames. Using fine touch point positional information from three or more frames may yield a more precise prediction as it can take into account acceleration and changes of direction in addition to per frame displacement and direction. In an embodiment more weight is assigned to more recent frame data than to older frame data. A frame matching process then may initially presume that an object s touch point in the current frame i probably corresponds with the touch point in the prior frame i.e. i 1 that is associated with the predicted likely location closest to the touch point in the current frame.

In an embodiment data concerning the size magnitude of a touch point e.g. the A and C coefficients of a paraboloid is determined and stored in connection with one or more frames. A frame matching process may initially presume that the size of a given object in the current frame i probably corresponds with the size of that object in the prior frame i.e. i 1 .

In an embodiment data concerning the change in size magnitude of a touch point over time are determined and stored in connection with one or more frames. In an embodiment data concerning the change in size of a touch point in a frame e.g. since the last frame or over a plurality of frames is used to predict a likely size for that touch point in the next frame. A frame matching process may initially presume that an object in the current frame i probably corresponds with an object in the prior frame i.e. i 1 that is associated with the predicted likely size nearest the size of the touch point in the current frame.

In an embodiment data concerning the change in rotational orientation e.g. the B coefficient of a paraboloid of a touch point over time are determined and stored in connection with one or more frames. In an embodiment data concerning the rotational orientation of a touch point in a frame e.g. since the last frame or over a plurality of frames is used to predict a rotational orientation for that touch point in the next frame. A frame matching process may initially presume that an object in the current frame i probably corresponds with an object in the prior frame i.e. i 1 that is associated with the predicted likely rotational orientation nearest the rotational orientation of the touch point in the current frame. In an embodiment the rotational orientation of a touch point could permit single touch point control e.g. single finger control of rotation thus for example the rotation of one finger on a screen could provide sufficient information to for example rotate a view a function that traditionally requires two rotating points of contact with a touch surface. Using data describing rotational orientation over time rotational velocity can be computed. Similarly data concerning rotational orientation or rotational velocity can be used to compute rotational acceleration. Thus rotational velocity and rotational acceleration both utilize rotational orientation. Rotational orientation rotational velocity and or rotational acceleration may be computed for a touch point and output by or used by the frame matching process.

In an embodiment heuristics for frame matching include changes in distance and in the velocity vectors of the touch points. In an embodiment heuristics for frame matching include one or more of the following 

Other combinations of historical data may be used without departing from the scope of this disclosure. In an embodiment both prior positions and the velocity histories may be used in a heuristic frame matching process. In an embodiment prior positions the velocity histories and size histories may be used in a heuristic frame matching process. In an embodiment prior positions and other historical information may be used in a heuristic frame matching process. In an embodiment historical information over a plurality of frames is used in a heuristic frame matching process. Other combinations will be apparent to one of skill in the art in view of the foregoing disclosure.

In an embodiment methods and systems are provided to overcome certain conditions in which noise produces interference with or phantom touches in the Fast Multi Touch FMT sensor. In embodiments of the sensor described above rows have a signal transmitted thereon and the transmitted signal is coupled to columns in proximity to a touch or touches when a touch or touches are applied to or near the surface of the sensor. In some cases the touch or touches can cause a reduction of the row signal in the column. The locations of touches are determined by reading the signals from the columns and determining the rows in which they were produced.

When the sensor as described above is used in the presence of certain conditions e.g. electromagnetic noise it is possible for a column to receive a signal from another source that is can be confused with a known signal generated by one of the rows of the device. In such case the device may report a phantom touch determining that the signal received in the column is coming from a row which in fact it is not. The present embodiments provide methods and devices for reducing or eliminating the occurrence of such phantom touches.

Thus in an embodiment of the sensor both the rows and the columns of the device are configured to both transmit unique signals and also to receive signals from the columns or rows of the device respectively. In an embodiment a detected signal from Row N in a given column may be considered a touch if that column s transmitted signal were simultaneously detected in Row N. In other words both the row and the column must receive the other s transmitted signal in order for the device to report a touch at the intersection of the row and column. A signal that is received in either the row or the column that is not matched in this manner may be rejected as for example noise from an external source. In an alternative embodiment both a detected signal from Row N in a given column and a detected signal from the given column in Row N may each be considered a touch regardless of whether matching is found. While this configuration may not provide the benefits of the matching described above it may provide for a sensor with increased sensitivity.

In an embodiment unique signals may be transmitted on all rows and columns. In an embodiment unique signals may be transmitted on each row in one or more subsets of rows. In an embodiment unique signals may be transmitted on each column in one or more subsets of columns. In an embodiment all rows and columns are configured to detect the unique signals. In an embodiment each row in one or more subsets of rows is configured to detect the unique signals. In an embodiment each column in one or more subsets of columns is configured to detect the unique signals.

Generally in the present sensor the signal coupled between the rows and columns changes when they are not subject to a touch event versus when they are. In an embodiment the rows and columns are configured such that when they are not subject to a touch event a lower or negligible amount of signal is coupled between them whereas when they are subject to a touch event a higher or non negligible amount of signal is coupled between them. In an embodiment the rows and columns are configured such that when they are subject to a touch event a lower or negligible amount of signal is coupled between them whereas when they are not subject to a touch event a higher or non negligible amount of signal is coupled between them. In an embodiment the signal coupled between the rows and columns changes when they are not subject to a touch event versus when they are. As discussed above the word touch or phrase touch event does not require a physical touching but rather requires an event affecting the sensor e.g. but not noise and which affects the level of coupled signal. In this respect hovering is considered a touch event. Further a level or amount of signal as used herein includes not only a discrete predetermined level but a relative amount of signal a range of amounts of signal an amount of signal that is determined dynamically at intervals of time or when a touch event determination is made or any combination thereof. Thus in an embodiment the present sensor and configuration is able to identify touch events resulting from a change in the signal coupled between one or more rows and one or more columns.

As used below for convenience of description the terms transmitting conductor and receiving conductor will be used. The transmitting conductor may be a row or column carrying a signal e.g. from a signal generator. In this respect conductor as used herein includes not only electrical conductors but other paths on which signals flow. A receiving conductor may be a row or column carrying a signal resulting from the coupling of a touch event when a touch event occurs in the proximity of the receiving conductor and not carrying the signal resulting from the coupling of a touch event when no touch event occurs in the proximity of the receiving conductor. In an embodiment a receiver signal processor measures the quantity of each of the orthogonal transmitted signal on a receiving conductor which signals resulted from the coupling of a touch event. Measuring the quantity allows for identification of a touch event. The receiver signal processor may comprise a DSP a filter bank or a combination thereof. In an embodiment the receiver signal processor is a comb filter providing bands corresponding to the orthogonal signals.

Because any touch event in proximity to a row column intersection may change both the row signal present on the column and the column signal present on the row in an embodiment any signal on a column or row that does not have a corresponding row or column counterpart may be rejected. In an embodiment a row signal received at a column receiver signal processor is used in locating or identifying a touch event if a corresponding column signal is received at a corresponding row receiver signal processor. For example a detected signal from Row R in Column C is only considered to be caused by a touch event if Column C s transmitted signal is also detected in Row R. In an embodiment Column C and Row R simultaneously transmit signals that are orthogonal to the other row and column signals and orthogonal to each other. In an embodiment Column C and Row R do not simultaneously transmit signals but rather each transmits its signal in an allotted time slice. In such an embodiment signals only require orthogonality from other signals transmitted in the same time slice.

As illustrated in an embodiment a single signal generator may be used to generate the orthogonal signals for both the rows and the columns and a single signal processor may be used to process the received signals from both the rows and the columns. In an embodiment one signal generator is dedicated to generating row signals and a separate signal generator is dedicated to generating column signals. In an embodiment a plurality of signal generators is dedicated to generating row signals and the same or a separate plurality of signal generators is dedicated to generating column signals. Likewise in an embodiment one signal processor is dedicated to processing row signals and a separate signal processor is dedicated to processing column signals. In an embodiment a plurality of signal processors are dedicated to processing row signals and the same or a separate plurality of signal processors are dedicated to processing column signals.

In an embodiment each receiving conductor is associated with a filter bank which acts as its receiver and signal processor the filter bank being adapted to distinguish between a plurality of orthogonal signals. In an embodiment a filter bank associated with a receiving conductor row is adapted to distinguish between all orthogonal signals that can result from a touch event associated with that receiving conductor row likewise a filter bank associated with a receiving conductor column is adapted to distinguish between all orthogonal signals that can result from a touch event associated with that receiving conductor column.

In an embodiment each row and each column may be associated with a signal and the signal associated with each row or column is unique and orthogonal with respect to the signal for every other row or column. In such an embodiment it may be possible to transmit all row and column signals simultaneously. Where design or other constraints require or where it is desirable to use fewer than one signal per row and column time division multiplexing may be employed.

Factors affecting the choice of orthogonal signal generation and transmission scheme include e.g. without limitation the number of rows and number of columns in the sensor the desired resolution of the sensor the material and dimensions of the rows and columns available signal processing power and the minimum acceptable latency of the system. Numerous other variations can be made and are within the scope and spirit of this disclosure and the attached claims. For example it will be apparent to a person of skill in the art the various tradeoffs that can be made in selecting between the number of unique orthogonal signals and the number of time slices employed by a given touch detection system provided however that multiple signals are transmitted in the same time slice and each of those multiple signals is orthogonal from all of the other signals transmitted in that time slice.

As noted above a column receiver Rx on a particular column may receive an orthogonal signal that was transmitted on one or more of the row conductors and the signal will be used by the signal processor to determine the row conductor responsible for the touch event coupling thus yielding a row column coordinate. In addition to the orthogonal signal transmitted on one or more rows the column receiver Rx may see the signal originating from the column transmitter Tx and its amplitude may be quite great and thus may interfere with the processing of lower amplitude signals that have traversed portions of a row and column. In an embodiment the presently disclosed system and method provides for the removal of the column transmitter Tx signal from the signal processed by the column receiver Rx. Thus in an embodiment the orthogonal signal sent by the column transmitter Tx may be subtracted from the signal received at the column receiver Rx. Such subtraction may be provided electrically by a circuit comprising an inverter configured such that the inverse of the signal transmitted by the column transmitter Tx is added to the signal received by the column receiver Rx thereby subtracting the transmitted column signal from the received column signal. Such a subtraction function may alternatively be provided in the signal processor .

The perceived quality of a touch sensor in a computer system depends on a high signal to noise ratio where in user input signals are properly discerned from ambient electromagnetic noise. Such electromagnetic noise can stem from other components within the computer system of which the touch sensor is a part e.g. an LCD information display or from artificial or natural signals in the user s external environment e.g. unwanted signal from a device s external AC power charger . These unwanted electromagnetic signals can be falsely detected by the touch sensor as user input and thereby produce false or noisy user commands.

In an embodiment a system and method enables a touch sensor to reduce or eliminate such false or noisy readings and maintain a high signal to noise ratio even if it is proximate to interfering electromagnetic noise from other computer system components or unwanted external signals. This method can also be used to dynamically reconfigure the signal modulation scheme governing select portions or the entire surface area of a touch sensor at a given point in time in order to lower the sensor s total power consumption while still optimizing the sensor s overall performance in terms of parallelism latency sample rate dynamic range sensing granularity etc.

Embodiments of the present system and method are particularly advantageous when applied to a capacitive touch sensor whose performance depends on the accurate reading of electromagnetic signals and particularly for a capacitive touch sensor that employs frequency division multiplexing FDM to increase the scan rate and lower the latency of reported touch input events to a computer system. In this respect the present embodiments may be applied to sensors such as those disclosed in Applicant s U.S. patent application Ser. No. 13 841 436 filed on Mar. 15 2013 entitled Low Latency Touch Sensitive Device and U.S. patent application Ser. No. 14 069 609 filed on Nov. 1 2013 entitled Fast Multi Touch Post Processing which contemplate a capacitive frequency division multiplexing touch sensor as an embodiment.

The touch sensor can analyze all the signals it receives when it is known that no user is touching the sensor or if actual touch signals are reasonably known i.e. if it is known that some parts of the touch surface are being touched while other parts are not being touched .

Such determinations of whether or not and where a touch sensor is being touched can be formed and strengthened through analyzing a combination of readings from the sensor itself other common computer input sensors like accelerometers the computer system s power status e.g. if the computer is placed into sleep mode etc. the event stream from currently running software applications on the computer system etc. This analytic process of relying on data from more than one sensor in a computer system to draw a conclusion about system state the state of system components or the state of the user is commonly called sensor fusion in the art.

With an analytic judgment about known touches in hand all of the touch sensor s received signals can then be compared against signals received for these known touches. The resulting differences between signals the sensor has measured and what should have been measured given what is known about current or prior touch events can then be used to mitigate the noise and interference.

In an embodiment of this method some of this measurement of interfering signals can happen at design time at least for the portions of interference thereof that will be predictable at design time. In another embodiment of this method some of the measurement can happen at manufacturing or testing time. In another embodiment some of the measurement can happen during a pre use period when it is reasonably known that the user is not touching the touch sensor. In another embodiment some of the measurement can occur when the user is touching the sensor at known positions. In another embodiment some of the measurement can occur at times between user touches when it is predicted by other sensors or algorithmically that the user is not touching the touch surface.

In another embodiment some of the measurement can occur statistically by software that can gauge the statistical patterns and likelihood of a user s touches. For example the user interface UI could have buttons placed at only certain positions on the touch surface so that these are the only places that a user is likely to be touching at a given time. When touched at one of these known positions the difference between the touch no touch states could be very obvious even in the presence of noise. In an embodiment the UI can be designed such that a button must be held down for a certain defined period of time perhaps indicated by the display yielding a pre determined period over which the touch may be detected even in the presence of noise. In another embodiment a slider or two dimensional pointer could be used instead of a button as these UI controls require a user to follow an arbitrary path that is either known by the UI ahead of time or which can be dynamically determined to some extent by other sensors on the device through sensor fusion. In an embodiment such a UI slider could be the single slide to open slider control commonly found on the lock screen of touch friendly operating systems like but not limited to iOS Android other Linux variants or Windows. In related embodiments any such unlocking gesture control can be used. In an embodiment a virtual keyboard provides known touch locations as the letters in a word can be easily and accurately predicted through looking at the neighboring letters.

In an embodiment such analysis could be performed on a touch sensor s discrete touch controller. In another embodiment such analysis could be performed on other computer system components such as but not limited to ASIC MCU FPGA CPU GPU or SoC.

Once noisy readings are identified as interference based on known touch signals and or via statistical inference as recounted in Step 1 such knowledge of electromagnetic interference can be used to avoid collisions between certain portions of the frequency time or code space where such noise can or will possibly be sensed by the touch sensor. Collisions between known touch signals and identified electromagnetic interference can be avoided through a variety of techniques or combinations of techniques such as but not limited to 

If there are identified signal frequencies that have no or little interference then the touch sensor should be configured to use them. If there are time slots that have little or no interference then the touch sensor should be configured to use them. If there are codes that have little or no interference then the touch sensor should be configured to use them. If there are combinations of frequency time and code that have little or no interference then the touch sensor should be configured to use them.

For touch sensors that employ frequency division multiplexing FDM the signal frequencies that the touch sensor employs do not have to be contiguous. If some parts of the frequency band are occupied by interference then the touch sensor can be configured to avoid those frequencies. If some parts of the frequency band are occupied by interference at certain known times then the touch sensor can be configured to avoid using those signal frequencies at those known times. If some parts of the frequency band are occupied by relatively static interference at certain known times the signals transmitted by the touch sensor can be modulated at those times in a fashion whereby demodulation will cancel out or eliminate the known interference. For example in an embodiment of this modulation technique if the interference is a steady sinusoid at some frequency of interest binary phase shift keying BPSK should be used to modulate the frequency emitted by the touch sensor so that when the opposite BPSK is used to demodulate the resulting sum of the signal received from the touch sensor and the interfering signal an equal portion of the interference has been multiplied by the positive phase and an equal portion has been multiplied by the negative phase so that when the signals are integrated over the total reception period the interference signal has summed to something negligible. Other forms of modulation with similar effect are possible.

If a touch sensor using FDM employs a fast Fourier transform to perform frequency analysis or a similar fast algorithm in which the number of frequency bins is constrained by the algorithm or nature of the algorithm the sensor can use a larger transform with a larger number of bins perhaps the next size up so that there are extra possible receive frequencies. The touch sensor can be configured prior to manufacturing with the ability to transmit at any of these frequencies. In this manner if some of the frequency bins contain interference these can be avoided in favor of frequencies that have little or no interference.

If some of the electromagnetic interference cannot be completely eliminated through use of the aforementioned techniques a touch sensor can be configured to ensure that such noise is spread evenly across the sensor s surface area to minimize any operational problems posed by the remaining interference.

In an embodiment a touch sensor can be configured and paired with custom application programming interfaces APIs to ensure that more noise tolerant UI elements with respect to ensuring a good user experience are placed on portions of the touch surface with more noise and that portions of the UI that require near noise free input commands due to the need for precision control are associated with parts of the touch sensor s surface that are affected by little or no interference. In other embodiments essentially the reverse of this concept is utilized. That is a developer API can be used to flag UI elements which then dictate the placement of high performance modulation schemes on the touch surface.

In another embodiment unwanted electromagnetic noise can be mitigated by remapping the timing frequencies and codes assigned to touch sensor signals. The division of these signals associated with the rows and columns of a touch sensor need not have a fixed relationship and can be dynamically remapped as desired. For example in an embodiment a touch sensor that employs FDM may always transmit a sinusoid of a particular frequency for a given row or it may remap the frequencies that it transmits dynamically. For example if the touch sensor s transmitter and receiver are capable of operating at n different frequencies and if m of those frequencies have been determined to contain a sufficiently small amount of interference and the number of touch sensor rows simultaneously transmitted frequencies is r where n is greater than or equal to m which is greater than or equal to r then the touch sensor can choose r frequencies out of the set of m and map those to the rows in a manner designed to minimize degradation to the user experience. In another embodiment the sensor s chosen set of operating frequencies can be re mapped dynamically every frame in a random or pseudo random fashion so that there is a negligible correlation of noise statistics between different portions of the touch surface over a noticeable time. More specifically a touch sensor can choose the r frequencies out of the m possible if they have the least noise or it may choose among them dynamically and randomly or pseudo randomly in a manner designed to minimize the correlation of noise statistics between different portions of the touch surface over a noticeable time. Similar methods can be used for time slots codes or other modulation schemes or combinations thereof.

In another embodiment for a touch sensor that primarily employs FDM where m frequencies which have been determined to contain a sufficiently small amount of interference is greater than or equal to the number of r frequencies required to simultaneously transmit a unique frequency on each sensor row a touch sensor can employ a dynamic FDM modulation scheme that optimizes the latency and sample rate performance of specific portions of the touch sensor s surface area based on the known layout and requirements of UI controls. Here in the known locations at a given point in time of UI controls demanding high precision low latency user input are mapped onto corresponding portions of the surface area of the touch sensor for which the signal modulation scheme has been optimized at a given point in time for high performance. Such dynamic mapping between the locations and performance requirements of the computer system s software defined UI controls and the locations and performance requirements of the surface area of the touch sensor could be explicitly defined by the application developer before run time or defined by operating system logic and analysis at run time of UI controls with communication between the application operating system and touch surface defined by application programming interfaces APIs . Simultaneously alongside these high performance regions other adjacent regions of the same surface area could employ lower performance frequency time or code modulation schemes. Running only select regions of the surface area of a touch sensor with a modulation scheme optimized for high performance in terms of parallelism latency sample rate dynamic range sensing granularity etc. has the added benefit of potentially lowering the total energy consumed by the touch sensor in order to both sense and process user input as only specific regions of the sensor are operated at demanding performance levels enabling the remainder of the surface area to operate with a modulation scheme that optimizes energy savings over performance. Such a dynamic modulation scheme can be updated and reoptimized as fast as every new frame of sensor input.

In another embodiment for a touch sensor that primarily employs FDM where the set of m possible frequencies identified with the least noise is a number lower than the number of r unique sensor signals required to assign a unique frequency to each row of the touch sensor the sensor can be configured to employ a hybrid modulation approach that combines time code or other modulation schemes with frequency division. In an embodiment of this method the specific hybrid modulation approach can be dynamically chosen and re evaluated by the touch sensor as fast as every new frame of sensor input to optimize for the lowest latency and the highest touch event sample rate across the entire sensor s surface area. In another embodiment of this method the specific hybrid modulation approach can be dynamically chosen and re evaluated by the touch sensor to optimize the latency and sample rate performance of specific portions of the surface area of the touch sensor based on the known layout and requirements of UI controls. Here in the known locations at a given point in time of UI controls demanding high precision low latency user input are mapped onto corresponding portions of the surface area of the touch sensor for which the signal modulation scheme has been optimized at a given point in time for high performance in terms of parallelism latency sample rate dynamic range sensing granularity etc. Such dynamic mapping between the locations and performance requirements of the computer system s software defined UI controls and the locations and performance requirements of the surface area of the touch sensor could be explicitly defined by the application developer before run time or defined by operating system logic and analysis at run time of UI controls with communication between the application operating system and touch surface defined by application programming interfaces APIs . Simultaneously alongside these high performance regions other adjacent regions of the same surface area could employ lower performance frequency time or code modulation schemes. Running only select regions of the surface area of a touch sensor with a modulation scheme optimized for high performance in terms of parallelism latency sample rate dynamic range sensing granularity etc. has the added benefit of potentially lowering the total energy consumed by the touch sensor in order to both sense and process user input as only specific regions of the sensor are operated at demanding performance levels enabling the remainder of the surface area to operate with a modulation scheme that optimizes energy savings over performance. Such a dynamic modulation scheme can be updated and reoptimized as fast as every new frame of sensor input.

In another embodiment for a touch sensor that primarily employs FDM where the set of m possible frequencies identified with the least noise is a number lower than the number of r unique sensor signals required to assign a unique frequency to each row of the touch sensor the sensor can be configured to enter a time division multiplexing TDM mode for a given time period choosing one of the frequencies in m and sampling rows and columns sequentially as is typical in a TDM approach. Switching a primarily FDM sensor to a pure TDM mode for a given time period ensures accurate input at the expense of the frame rate and latency of sensor readings.

In another embodiment for a touch sensor that primarily employs FDM where the set of m possible frequencies identified with the least noise is a number lower than the number of r unique sensor signals required to assign a unique frequency to each row of the touch sensor the sensor can be configured to enter a hybrid FDM and TDM mode for a given time period choosing a select number of the frequencies in m and thereby sequentially sampling multiple rows and columns in parallel to improve the frame rate and latency of sensor readings over the performance limits of a purely sequential TDM mode. Such a hybrid FDM and TDM modulation scheme improves sensor parallelism and performance while simultaneously mitigating the adverse impact of noisy readings that would have otherwise arisen from utilizing sensor signals outside of m that real time historical and or statistical analysis of the surrounding electromagnetic noise deemed more interference prone.

A touch sensor can also utilize a number of techniques to decrease the influence of interference and other noise in the touch sensor. For example in an embodiment for a touch sensor that employs FDM a touch sensor could use multiple frequencies per row so that even if the sensor cannot predict which frequency bins will be subject to interference then it can measure each row or column in multiple ways and gauge the least noisy measurement or combination of measurements and then use those.

In cases where it is difficult to decide whether a measurement has been affected by interference or not a touch sensor could employ a voting scheme whereby a voting plurality of measurements or a similar statistical method is used to determine which measurements to throw away which to keep and the best way to statistically and mathematically combine the ones it keeps to maximize the signal to noise interference ratio and thereby enhance the user experience. For example in an embodiment an FDM touch sensor subject to interference could transmit three different frequencies on each row where the frequencies are sufficiently separated so that interference between them is statistically unlikely and measure the results. Then using a two out of three voting system the sensor can determine which of the frequencies has been degraded the most by interference and either remove its measurement from consideration in the final measurement or combine the remaining two in a statistically plausible manner given what the sensor knows a priori about the interference and noise statistics or include all three and combine them in a statistically plausible manner weighting the influence of each frequency measurement by the statistical likelihood of its degradation by noise and interference.

In an embodiment the fast multi touch sensor is provided with the ability to identify touches as coming from the same hand different hands of the same user the same user or different users. In an embodiment the fast multi touch sensor is provided with the ability to identify touches as coming from a portion of an object linked to touch areas either through capacitive touch points on a single object to help determine its position and orientation or through a stylus held by a user who is also touching another area of the display simultaneously with a part of his her body.

In the basic embodiment of the sensor initially discussed above each row has a signal transmitter. The signal is coupled into nearby columns when a touch or touches are applied to the surface. The locations of these touches are determined by reading the signals from the columns and knowing in which rows they were produced.

When a user makes contact with the sensor or with a device within which the sensor is integrated or comes within a certain distance of the sensor or otherwise causes a touch event at more than one location there will ordinarily be a certain amount of coupling that will occur across touches made by the same user as signals are transmitted by the user s body from one touch location to the other. With reference to when a single touch or near touch is applied by a user s digit at the intersection of row r1 with column c1 coupling will occur between row r1 and column c1. If a second contemporaneous touch or near touch is made by the user s second digit at the intersection of row r2 and column c2 coupling will occur between row r2 and column c2. Additionally weaker coupling may occur between row r1 and column c2 as well as between r2 and column c1. In some embodiments weaker coupling may occur between the columns and between the rows.

These weaker body transmitted signals which might otherwise be dismissed as noise or cross talk can instead be used by the signal processor as an additional signal to identify that a single user is responsible for both touches. In particular to extend the above example the coupling between row r1 and column c2 as well as between row r2 and column c1 might normally be considered noise and filtered out or otherwise ignored to ensure a touch is not erroneously reported at the intersections of row r1 and column c2 or row r2 and column c1. The weaker body transmitted coupling might still be filtered to ensure only accurate touch locations are reported but also interpreted to allow the system to identify that the touches come from the same user. The sensor may be configured to detect weaker body transmitted coupling transmitted from any digit of the user s hand including but not limited to locations or in addition to . The signal processor may be configured to use such detection to identify touches as coming from the same hand different hands of the same user the same user or different users.

In other embodiments of the of the touch sensor with user identification a signal generator can be coupled to the user elsewhere such as in a handheld unit a pad under their chair or indeed on an edge of the device into which the sensor is integrated. Such a generator can be used to identify the user making a particular touch in a manner similar to that described above. In other embodiments the signal generator might be integrated into a stylus pen or other object.

The following are examples of the types of weaker coupling that can be detected and used to identify touches as coming from the same hand the same user or different users coupling between a row or column being touched by a first one of the user s digits and a row or column being touched by a second one of the user s digits coupling between a row or column being touched by a user s digit and a row or column being touched by another part of the user s body such as his palm coupling between a row or column being touched by a part of the user s body such as his digit or his palm and a signal generator operatively connected to the user s body and coupling between a row or column being touched by a part of the user s body such as his digit or his palm and a signal generator integrated into a stylus or pen and coupling between a row or column being touched by a part of the user s body through a conductive intermediary object such as stylus or other tangible and coupling between a row or column being touched by a part of the user s body possibly through a conductive intermediary object such as a stylus or other tangible. As used herein touch includes events where there is physical contact between a user and the disclosed sensor and also events where there is no physical contact but an action by the user that occurs in proximity to the sensor and is detected by the sensor.

The weaker couplings described above can be used to identify touches as coming from the same hand different hands of the same user the same user or different users. For example the presence of a weaker coupling that is relatively strong can be used to identify two touch events as coming from the same hand such as from two digits of the same hand e.g. the index finger and the thumb or a digit and a palm of the same hand. As another example the presence of a weaker coupling that is relatively weak relative the previous example can be used to identify two touch events as coming from different hands of the same person or a hand and another body part of the same person. As a third example the absence of a weaker coupling can be used to identify two touch events as coming from different persons. Furthermore the presence of a signal from a signal generator operatively connected to a user s body can be used to identify a touch as coming from a particular user and the absence of such signal can be used to identify a touch as not coming from a particular user.

In certain embodiments of the fast multi touch sensor the sensor is configured to detect the position of a stylus and optionally its tilt angle and angle of rotation about its longitudinal axis as well. Such embodiments begin with sensor hardware essentially as initially described above and further utilize a stylus having a signal transmitter near its tip from which signals are transmitted which are compatible same or similar modulation scheme similar frequency etc. with but orthogonal to the orthogonal signals that may be transmitted on the rows or columns. A switch which could be any kind of a switch including e.g. proximity detector or pressure sensor in the tip of the stylus can be used to control when the transmitter is on or off. The stylus can be configured such that under normal operating conditions the switch turns on the transmitter when the stylus is in contact with or within proximity to the fast multi touch sensor s surface. In an alternate embodiment the stylus is configured such that it constantly transmits a signal and the state of the switch can change one or more properties of the signal such as its frequency amplitude or the like. This allows the stylus to not only be used when it is in contact with the surface of the touch sensitive device but also when it is slightly above as well providing a hover capability.

In an embodiment the signal transmitted by the stylus is similar to the orthogonal signals which may be transmitted onto the rows as discussed above and the stylus can be treated essentially as an extra row. Signals emitted by the stylus are coupled into nearby columns and the amount of signal received on the columns can be used to determine the position of the pen with respect to them.

To provide the ability to measure the position of the stylus in two dimensions receivers can be placed on the rows of the FMT sensor as well as on the columns. The receivers on the rows do not need to be as complicated as those on the columns the column receivers should be configured to pick up and discriminate between any of the signals that are transmitted onto the rows. However the row receivers only need to be capable of picking up and discriminating between any signals that are transmitted by the stylus or in some embodiments multiple styli.

In an embodiment the signals transmitted by the stylus are be distinct from those transmitted onto the rows so that there is no confusion between them. If the row signals are modulated the stylus signals should be similarly modulated to be compatible with the other receivers. In an embodiment such modulation requires a time reference which the multi touch sensor can be configured to provide to the stylus via a communication channel. Such channel can be a radio link an optical link an acoustic or ultrasonic link or the like. In an embodiment the stylus receives the row signals and synchronizes its modulation to them with no other communication channel involved.

As the stylus transmits its signals they are received by the column and row receivers. The signal strengths on the rows and columns are used to determine the position of the stylus in two dimensions with respect to the rows and columns. Stronger signal strengths are an indication that the stylus is in relatively close proximity to the sensor and weaker signal strengths are an indication that the stylus is farther away. Interpolation can be used to determine the position of the stylus to a much finer resolution than the physical granularity of the rows and columns.

A more complex embodiment allows us to simultaneously measure both the tilt and rotation of the stylus as the user holds it along with measuring the position of the stylus.

Instead of emitting a single signal the stylus in this embodiment can emit multiple signals each of which is transmitted from near the tip of the stylus but from points spread around its circumference. While two such signals 180 degrees apart would provide some of the information required at least three signals ideally 120 degrees apart are needed to unambiguously measure the tilt and rotation of the stylus and four signals ideally 90 degrees apart would make the math and signal processing less cumbersome. The four signal case is used in the examples below.

Stylus rotation can be detected in a similar manner. As the x and y position of each of the stylus four transmitters is rotated in parallel to the z axis the four transmitters on the pen will be linearly closer to or farther from the various rows and columns of the touch surface. These different linear distances between the x and y position of the stylus transmitters relative to the FMT s various rows and columns result in different signal strengths picked up by the FMT s receivers. Rotating the stylus in parallel with the z axis would change these linear distances and thus the associated signal strengths. The x and y rotation angle of the stylus can be inferred from these differences in signal strengths.

Embodiments of the invention include a fast accurate low latency stylus and sensor system that can be used for hand written input on a computer display or touch sensor. In an embodiment the stylus provides input that is fluid and natural mimicking the experience of a pen or pencil. In this respect the update rate of the system can be raised to over a kilohertz and the latency from stylus movement to measured position and other parameters can be lowered to less than one millisecond. Along with measuring the position of the stylus its tilt angle and rotation can be measured. It is noted that the Active Optical Stylus described herein is compatible with computer displays and touch sensors of virtually all designs and is not limited to use with the fast multi touch sensors described above.

The disclosed technique includes an optical method that uses Induced Total Internal Reflection ITIR . The technique allows a plurality of styli to simultaneously be used for input purposes. The sensor system can be placed on top of a computer display such as an LCD or OLED monitor and the inferred sensor position and other parameters over time used to draw lines curves text etc. on the computer display.

In an embodiment of the active optical stylus the stylus emits light in a plurality of distinct patterns into the sensor surface. The sensor surface is a thin flat sheet or some two dimensional manifold of material that is transparent or translucent at the wavelength of the light emitted from the stylus.

Inside the sheet some of the light emitted by the stylus interacts with the direction changing means which causes some light to become trapped in the sensor sheet and propagate outward away from the distinct pattern of light which the stylus emitted into the sheet at that position. The propagating light travels to the edge of the sheet where it reaches an angular filter. Light that is perpendicular to the filter and the edge of the sheet is allowed to pass to the linear light sensor.

The linear light sensor measures the amount of light impinging on it along its length which allows us to infer the position of the stylus. The position along the linear light sensor which receives the maximum amount of light corresponds to the projection of the stylus position along that dimension.

The system can not only measure the position of the stylus on the sensor sheet but it can also infer its tilt and rotation if the stylus emits more than a single ray of light. If the stylus emits multiple rays of light or perhaps cones or other shapes the projection of these along the sides of the antenna sheet can be measured by the system and that data used to simultaneously infer the position tilt and rotation of the stylus.

Normally light entering a thin transparent medium like the sensor surface will exit out the other side and none of it will get trapped inside and propagate by total internal reflection. In order for the entering light to be trapped and propagate inside some means is required to change its direction. In one embodiment the sensor surface scatters some of the incoming light in different directions. Some of those directions are within the angle at which total internal reflection can occur. Scattering is not a preferred method because the there is no way to prevent the scattering from further changing the direction of the light which will lower the amount of light received by the linear light sensors and also cause light to travel by non straight line paths even after the first change of direction has occurred. Non straight line paths will cause light to appear to come from incorrect directions and will cause the system to yield false position readings.

The preferred direction changing means is a one time wavelength changing means such as a fluorescent or phosphorescent material. Light emitted by the stylus at wavelength W1 enters the sensor sheet where it interacts with the one time wavelength changing means. Said means absorbs a portion of that light and emits light at wavelength W2 in multiple directions. Wavelength W1 could be in the ultraviolet portion of the electromagnetic spectrum. Wavelength W2 could be in the visible or infrared portion of the spectrum. A portion of the light at wavelength W2 now propagates along the sensor sheet via total internal reflection and nothing otherwise impedes it because the one time wavelength changing means does not appreciably affect wavelength W2.

Light propagating through the sensor surface reaches the edge from a multitude of angles. In order to infer the position of the stylus s light patterns inside the sensor surface we want to restrict the linear light sensor s field of vision to a specific direction. In an embodiment an angular filter provides this function. In the preferred embodiment with a rectangular sensor sheet and linear light sensors on two of the sides we want to restrict the field of view of the light sensors to directions perpendicular to the edges of the sensor sheet. This could be accomplished with a tiny set of venetian blinds similar to the way that privacy screen for computer monitors restrict the view to a narrow angle directly in front of the monitor.

Light impinging on the angular filter from directions outside the intended field of view should preferably be absorbed by the filter or reflected in a manner such that the rejected light will not enter or be sensed by any of the linear light sensors in the system.

The linear light sensors measure the amount of light impinging on them at a plurality of positions along their length. They could be implemented by position sensitive detectors linear CCD arrays linear CMOS imager arrays an array of photomultiplier tubes and array of individual photodiodes phototransistors photo cells or any other means of detecting light.

With reference to the stylus is a pen shaped device that can emit light in a plurality of distinct patterns into the sensor sheet when the user holds it like a pen or pencil and draws on the surface of the sensor sheet . The projections of the patterns along the edges of the sensor sheet can be used to infer the position tilt and rotation of the stylus. If multiple styli are desired they can emit their light one at a time in a form of time division multiplexing. This would require some form of synchronization between the styli which could be implemented by a variety of simple communication channels including but not limited to a radio link ultrasound or an optical signal. The optical signal could be generated by the computer display below the sensor sheet allowing the pens to be synchronized using almost no additional hardware.

The stylus could be constructed using a light source such as a light emitting diode that is illuminated when a contact switch or pressure sensor senses that the stylus is in contact with the sensor sheet. Optical elements such as lenses diffraction gratings light pipes splitters etc. could take the light from a plurality of light sources and create a different plurality of distinct patterns of light which could be projected into the sensor sheet. In an embodiment the stylus could also be a non contact light source such as a laser.

In a basic embodiment of the technology the stylus emits a single ray or cone of light probably coaxially with respect to the stylus body. A single ray of light will cause simple point like projections of this pattern along the sides of the sensor sheet allowing us to infer the position of the stylus. shows the geometric projection of a spot emitted by a simple stylus along the edges of the sensor sheet. The maxima of the light detected by the linear light sensors along their lengths gives us the geometric projection of the illuminated spot on the sensor sheet. From this we can infer the sensor position.

If the stylus emits a cone shaped beam it will intersect the sensor sheet in a circle if the stylus is held perpendicular to the surface or in an ellipse if the stylus is tilted away from perpendicular . The projections of these intersections will have different shapes and widths allowing us to infer the tilt angle as well as the angle relative to the sensor sheet edges that the stylus is being held. shows the geometric projection of a spot emitted by a simple stylus along the edges of the sensor sheet. The maxima of the light detected by the linear light sensors along their lengths gives us the geometric projection of the illuminated spot on the sensor sheet. From this we can infer the sensor position.

As shown in if the stylus emit a cone of light instead of a ray of light where that cone intersect the sensor sheet will cause an ellipse. The projection of the ellipse may be different in one direction than it is in the other allowing us to infer the tilt of the stylus.

If the stylus projects multiple patterns onto the sensor sheet the projections of these along the sides of the sensor sheet can be used to infer the position tilt and rotation angle of the stylus. As shown in if both projections are wider than we would expect for a stylus held perpendicular to the sensor sheet and yet are nearly equal in size it is probable that the stylus is tilted at a 45 degree angle to the direction of the edges of the sensor sheet. The width of the projections can be used to infer the tilt angle from the vertical. The wider the projections the greater the tilt.

With reference to if the stylus emits multiple patterns of light around its circumference the projections of these along the edges of the sensor sheet can allow us to infer the sensor tilt and also the rotation around its axis along with the location at which the stylus is touching the sensor sheet. The number and arrangement of the patterns projected by the stylus must be carefully chosen For example the patterns should not be evenly spaced around the circumference of the stylus because that might cause multiple rotation angles of the stylus to have the same projected light patterns along the edges of the sensor sheet. Even if this were the case although the absolute rotation of the stylus could not always be measured small relative rotations could be measured which could still provide useful information to the user interface. The most straightforward way to infer the stylus position tilt and rotation from the geometric projections of its emitted patterns might be to measure the projections for a wide variety of stylus positions tilts and rotations and then to map onto and interpolate between these to get from the projections back onto the stylus parameters. The two stylus patterns shown at A and B are identical except that the stylus has been moved farther to the lower right and rotated clockwise by 45 degrees.

Sunlight contains many wavelengths of light and these might interfere with operation of the stylus system if that is used in sunlight. It would be advantageous for the stylus to emit at a wavelength which is either nonexistent or very weak in the solar spectrum as experienced at the earth s surface. One possibility is for the stylus to emit light in the solar blind region of the ultraviolet where the oxygen in the earth s atmosphere absorbs most or all of those wavelengths. LEDs that emit in the solar blind portion of the UV spectrum are available on the commercial market.

A similar argument could be made for wavelengths of light from other sources natural or artificial that might impinge on the stylus system and impede its use.

If it is desired to use multiple styli simultaneously a method must be used to disambiguate the signals from each. For example time division multiplexing can be used in which case each stylus takes a turn emitting patterns e.g. as shown in into the sensor sheet.

Multiple styli could also use different direction changing means so that each could emit at a different wavelength and these different wavelengths could be distinguished after the direction changing means by the linear light sensors.

In certain embodiments all of the styli emit at the same time with the same wavelength and disambiguate their contributions to the geometric projections along the sides of the sensor sheet in software or firmware using knowledge of the possible and likely trajectories of the styli as they are being used.

The present system and methods are described above with reference to block diagrams and operational illustrations of methods and devices comprising a fast multi touch stylus and sensor. It is understood that each block of the block diagrams or operational illustrations and combinations of blocks in the block diagrams or operational illustrations may be implemented by means of analog or digital hardware and computer program instructions. These computer program instructions may be provided to a processor of a general purpose computer special purpose computer ASIC or other programmable data processing apparatus such that the instructions which execute via the processor of the computer or other programmable data processing apparatus implements the functions acts specified in the block diagrams or operational block or blocks. In some alternate implementations the functions acts noted in the blocks may occur out of the order noted in the operational illustrations. For example two blocks shown in succession may in fact be executed substantially concurrently or the blocks may sometimes be executed in the reverse order depending upon the functionality acts involved.

While the invention has been particularly shown and described with reference to a preferred embodiment thereof it will be understood by those skilled in the art that various changes in form and details may be made therein without departing from the spirit and scope of the invention.

