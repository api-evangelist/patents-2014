---

title: Controlling access to an operator network by non-conforming devices
abstract: A device is configured to receive an alarm message from a particular device that received a radio resource control request from a client device. The alarm message may indicate that a threshold access limit to an operator network is satisfied by the client device or that a particular protocol is being used by the client device. The device may determine a policy associated with the client device. The policy may indicate a policy rule associated with a policy action to be taken if the policy rule is violated. The device may determine the policy rule is violated based on the alarm message received from the particular device. The device may instruct the particular device to perform the policy action, by accepting or rejecting the radio resource control request, based on the policy rule being violated.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09450983&OS=09450983&RS=09450983
owner: Verizon Patent and Licensing Inc.
number: 09450983
owner_city: Basking Ridge
owner_country: US
publication_date: 20140708
---
Machine to Machine M2M devices are widely used to communicate information via the Internet of Things IoT . M2M devices may use an operator network e.g. a wireless network a mobile network etc. to communicate this information.

The following detailed description of example implementations refers to the accompanying drawings. The same reference numbers in different drawings may identify the same or similar elements.

Allowing M2M devices to communicate via an operator network may mean that non M2M devices e.g. a user device have to contend with M2M devices for radio frequency RF resources on the operator network. M2M devices may use an exorbitant amount of resources by connecting to the operator network too frequently and or using certain protocols that utilize RF resources. The end result may be that M2M devices abuse the RF resources and cause a service availability issue for other devices e.g. a user device operated by a person that communicate via the operator network.

The operator network may publish guidelines for application developers and or M2M developers to design M2M applications that utilize RF resources in a permitted way. However it may be difficult for the operator network to enforce these guidelines. For example an operator network may have to track which M2M devices are not complying with guidelines after the fact and work with owners of the M2M devices to resolve the issue.

Implementations described herein may determine whether an M2M device complies with policies for the M2M device and control access of the M2M device to an operator network in real time. Furthermore implementations described herein may detect violations of the policies due to a message being sent from a M2M device and or to a M2M device from an application server.

The operator network may receive the RRC request and determine whether radio resources should be assigned to the client device. For example the operator network may determine whether the client device is a M2M device associated with a policy that restricts the M2M device s access to the operator network. For instance a policy may restrict how often the client device may access the operator network to send and or receive messages. Additionally or alternatively the policy may restrict particular security protocols from being used by the client device.

The operator network may determine in real time whether the client device violates a policy and whether radio resources should be assigned to the client device. For example a base station included in the operator network may store a cached policy data structure that may be used by the base station to determine whether assigning resources to the client device would cause the client device to violate a policy. The operator network may send a RRC accept message that allows the client device access to the operator network or a RRC rejection message that prevents the client device from accessing the operator network to the client device based on whether radio resources may be assigned to the client device.

In this way the operator network may control access of the client device to the operator network in real time.

Operator network may include an evolved packet system EPS that includes a long term evolution LTE network and or an evolved packet core EPC that operate based on a third generation partnership project 3GPP wireless communication standard. The LTE network may be a radio access network RAN that includes one or more base stations such as eNodeBs eNBs via which client device communicates with the EPC. The EPC may include SGW MME and or PGW that enables client device to communicate with network HSS AAA server and or PCRF and may manage certain information and services such as authentication session initiation account information and or a user profile associated with client device . The LTE network may include multiple base stations and the EPC may include multiple SGWs MMEs and or PGWs . Additionally or alternatively operator network may include a cellular network a public land mobile network PLMN a second generation 2G network a third generation 3G network a fourth generation 4G network a fifth generation 5G network and or another network.

Base station may include one or more network devices that receive process and or transmit traffic such as audio video text and or other data destined for and or received from client device . In an example implementation base station may be an eNB device and may be part of the LTE network. Base station may receive traffic from and or send traffic to network via SGW and PGW . Base station may send traffic to and or receive traffic from client device via an air interface. One or more of base stations may be associated with a RAN such as the LTE network. In some implementations base station may include a cache memory that stores a cached policy data structure.

SGW may include one or more network devices or other types of computation or communication devices that gather process search store and or provide information in a manner described herein. SGW may include one or more data processing and or traffic transfer devices such as a gateway a router a modem a switch a firewall a network interface card NIC a hub a bridge a proxy server an optical add drop multiplexer OADM or some other type of device that processes and or transfers traffic. SGW may for example aggregate traffic received from one or more base stations and may send the aggregated traffic to network via PGW . In some implementations SGW may route and forward data may act as a mobility anchor for a user plane during inter base station handovers and may act as an anchor for mobility between LTE and other 3GPP technologies.

MME may include one or more computation or communication devices that gather process search store and or provide information in a manner described herein. For example MME may perform operations associated with a handoff to and or from the EPS. MME may perform operations to register client device with the EPS to handoff client device from the EPS to another network to handoff client device from the other network to the EPS and or to perform other operations. MME may perform policing operations for traffic destined for and or received from client device . In some implementations MME may include a cache memory that stores a cached policy data structure.

PGW may include one or more network devices that gather process search store and or provide information in a manner described herein. PGW may include one or more data processing and or traffic transfer devices such as a gateway a router a modem a switch a firewall a NIC a hub a bridge a proxy server an OADM or some other type of device that processes and or transfers traffic. PGW may for example provide connectivity of client device to external packet data networks such as network by being a traffic exit entry point for client device . PGW may perform policy enforcement packet filtering charging support lawful intercept and packet screening. PGW may also act as an anchor for mobility between 3GPP and non 3GPP technologies. PGW may authenticate client device e.g. via interaction with HSS AAA server . In some implementations PGW may include a cache memory that stores a cached policy data structure.

HSS AAA server may include one or more server devices or other types of computation or communication devices that gather process search store and or provide information in a manner described herein. For example HSS AAA server may manage update and or store in a memory associated with HSS AAA server profile information associated with client device that identifies applications and or services that are permitted for and or accessible by client device bandwidth or data rate thresholds associated with the applications or services information associated with a user of client device e.g. a username a password a personal identification number PIN etc. a data plan rate information minutes allowed and or other information.

Additionally or alternatively HSS AAA server may include a device that performs authentication authorization and or accounting AAA operations associated with a communication session with client device . With regard to the authentication operation HSS AAA server may verify a device s e.g. client device specific digital identity provided via an identifier e.g. a password a digital certificate a phone number etc. associated with the device. With regard to the authorization function HSS AAA server may grant or refuse privileges to a device e.g. client device for accessing specific services e.g. IP address filtering address assignment route assignment quality of service QoS etc. . With regard to the accounting operation HSS AAA server may track consumption of network resources e.g. by client device and may use this information for management planning billing etc.

Service control server may include one or more devices capable of storing processing and or routing information. In some implementations service control server may include a communication interface that allows service control server to receive information from and or transmit information to other devices in environment . In some implementations service control server may detect a non conforming client device and determine an action to manage the non conforming client device .

PCRF may include one or more server devices or other types of computation or communication devices that gather process search store and or provide information in a manner described herein. For example PCRF may perform operations that enforce EPS policies associated with a communication session with client device . For example PCRF may dynamically provide real time bandwidth allocations and or controls e.g. associated with a particular access point name APN associated with particular applications network accesses and or services provided to client device during a communication session. PCRF may also dynamically provide a real time signal flow policy to adapt to changing conditions within the network and or to manage traffic flow during the communication session.

SCS may include one or more server devices or other types of computation or communication devices that gather process search store and or provide information in a manner described herein. For example SCS may enable applications provided by application server to access and use functionality provided by service components of operator network e.g. bearers defined by QoS parameters and or other mechanisms for realizing a service over standardized interfaces e.g. application programming interfaces APIs . SCS may host multiple service components.

IWF may include one or more network devices that gather process search store and or provide information in a manner described herein. IWF may include one or more data processing and or traffic transfer devices such as a gateway a router a modem a switch a firewall a NIC a hub a bridge a proxy server an OADM or some other type of device that processes and or transfers traffic. IWF may for example enable network or another network to communicate with the LTE network included in operator network . In some implementations IWF may include a cache memory that stores a cached policy data structure. In some implementations IWF may map external identifiers of devices to internal network identifiers such as an international mobile subscriber identity IMSI to hide the network internal identifiers from external applications or devices. Additionally or alternatively IWF may convert external M2M protocols to proper internal network protocols to enable M2M applications to send trigger and or control messages to the devices or to pass user plane data to from M2M devices. Furthermore IWF may interrogate HSS AAA server and or PCRF for authentications and authorizations and apply runtime policies and or charging rules actions.

Cache memory may be a memory that stores a cached policy data structure which may be updated by service control server and or another device included in environment .

Client device may include a device capable of receiving processing and providing information. For example client device may include a mobile phone e.g. a smart phone a radiotelephone etc. a computing device e.g. a laptop computer a tablet computer a handheld computer a gaming device etc. a M2M device or a similar device. In some implementations client device may include a communication interface that allows client device to receive information from and or transmit information to another device in environment .

Application server may include one or more devices capable of storing processing and or routing information. In some implementations application server may include a communication interface that allows application server to receive information from and or transmit information to other devices in environment . In some implementations application server may manage a M2M application for communicating with client device e.g. an M2M device via operator network .

Network may include one or more wired and or wireless networks. For example network may include a cellular network e.g. an LTE network a 3G network a code division multiple access CDMA network etc. a public land mobile network PLMN a wireless local area network e.g. a Wi Fi network a local area network LAN a wide area network WAN a metropolitan area network MAN a telephone network e.g. the Public Switched Telephone Network PSTN a private network an ad hoc network an intranet the Internet a fiber optic based network a cloud computing network and or a combination of these or another type of network.

The number and arrangement of devices and networks shown in is provided as an example. In practice there may be additional devices and or networks fewer devices and or networks different devices and or networks or differently arranged devices and or networks than those shown in . Furthermore two or more devices shown in may be implemented within a single device or a single device shown in may be implemented as multiple distributed devices. Additionally or alternatively a set of devices e.g. one or more devices of environment may perform one or more functions described as being performed by another set of devices of environment .

Bus may include a component that permits communication among the components of device . Processor may include a processor e.g. a central processing unit CPU a graphics processing unit GPU an accelerated processing unit APU etc. a microprocessor and or any processing component e.g. a field programmable gate array FPGA an application specific integrated circuit ASIC etc. that interprets and or executes instructions. Memory may include a random access memory RAM a read only memory ROM and or another type of dynamic or static storage device e.g. a flash memory a magnetic memory an optical memory etc. that stores information and or instructions for use by processor .

Storage component may store information and or software related to the operation and use of device . For example storage component may include a hard disk e.g. a magnetic disk an optical disk a magneto optic disk a solid state disk etc. a compact disc CD a digital versatile disc DVD a floppy disk a cartridge a magnetic tape and or another type of computer readable medium along with a corresponding drive.

Input component may include a component that permits device to receive information such as via user input e.g. a touch screen display a keyboard a keypad a mouse a button a switch a microphone etc. . Additionally or alternatively input component may include a sensor for sensing information e.g. a global positioning system GPS component an accelerometer a gyroscope an actuator etc. . Output component may include a component that provides output information from device e.g. a display a speaker one or more light emitting diodes LEDs etc. .

Communication interface may include a transceiver like component e.g. a transceiver a separate receiver and transmitter etc. that enables device to communicate with other devices such as via a wired connection a wireless connection or a combination of wired and wireless connections. Communication interface may permit device to receive information from another device and or provide information to another device. For example communication interface may include an Ethernet interface an optical interface a coaxial interface an infrared interface a radio frequency RF interface a universal serial bus USB interface a Wi Fi interface a cellular network interface or the like.

Device may perform one or more processes described herein. Device may perform these processes in response to processor executing software instructions stored by a computer readable medium such as memory and or storage component . A computer readable medium is defined herein as a non transitory memory device. A memory device includes memory space within a single physical storage device or memory space spread across multiple physical storage devices.

Software instructions may be read into memory and or storage component from another computer readable medium or from another device via communication interface . When executed software instructions stored in memory and or storage component may cause processor to perform one or more processes described herein. Additionally or alternatively hardwired circuitry may be used in place of or in combination with software instructions to perform one or more processes described herein. Thus implementations described herein are not limited to any specific combination of hardware circuitry and software.

The number and arrangement of components shown in is provided as an example. In practice device may include additional components fewer components different components or differently arranged components than those shown in . Additionally or alternatively a set of components e.g. one or more components of device may perform one or more functions described as being performed by another set of components of device .

As shown in process may include sending a radio resource control RRC request to base station block . For example client device may send the RRC request to base station . In some implementations the RRC request may request access to radio resources from base station and or to activate a communication session with operator network . The RRC request may indicate a client device identifier that uniquely identifies client device e.g. a phone number an IP address an IMSI an international mobile station equipment identify IMEI a mobile equipment identifier MEID etc. .

Base station may receive the RRC request from client device and transmit the RRC request to MME . MME may receive the RRC request from base station .

As further shown in process may include determining whether to reject the RRC request based on a policy stored in a cached policy data structure block . For example base station and or MME may determine whether to reject the RRC request based on the stored policy.

In some implementations base station and or MME may store a cached policy data structure in cache memory . The cached policy data structure may include local policy information that identifies one or more policies and or may include client device information that identifies policies associated with one or more client devices .

The local policy information may associate a policy identifier that uniquely identifies the policy a policy rule for the policy and or a policy action to take for a violation of the policy rule.

In some implementations the policy rule may identify a threshold access limit that indicates how often any client device may be assigned radio resources from a base station and or access operator network . For example the threshold access limit may indicate a maximum number of communication sessions e.g. based on RRC requests from client device and or based on trigger messages from application server to connect to client device that any client device is permitted per an amount of time. Additionally or alternatively the policy rule may restrict a kind of data security protocol e.g. an Internet Security Protocol IPsec and or a kind of data transmission. For example the policy rule may restrict data being sent using transport layer security TLS a secure sockets layer SSL protocol a virtual private network VPN etc. In some implementations the policy rule may act as a trigger that triggers a policy action to be taken.

In some implementations the policy action may include throttling a communication session e.g. limiting how often client device may be assigned radio resources and or access operator network releasing a communication session preventing a new communication session from being established preventing radio resources from being assigned and or taking no action.

For example the local policy information may indicate a policy that throttles a communication session if the threshold access limit is reached. In other words if client device is accessing operator network at a rate faster than a permitted threshold access limit e.g. one access per one minute the policy may limit subsequent requests to a different rate e.g. one access per five minutes . On the other hand the local policy information may indicate that no action should be taken if the threshold access limit is reached.

As another example the local policy information may indicate another policy that restricts using a SSL protocol. If the policy rule is violated by data being transmitted or attempted to be transmitted during a communication using a SSL protocol then the local policy information may indicate that the communication session should be released or terminated. On the other hand if the policy rule is violated by data being transmitted using a SSL protocol the local policy information may indicate that no action should be taken and communication using the SSL protocol should be allowed.

The client device information may associate a client device identifier for client device a policy identifier of a policy for client device a status of a client device and or an alarm state for client device . The status may indicate a current policy action that should be taken for the associated client device . The alarm state may indicate whether an alarm has been triggered for client device . In some implementations a RRC request may not be accepted while an alarm is in an active state.

As will be discussed in more detail later service control server may send update information to base station and or MME to update the cached policy data structure at particular times. For example the local policy information may be updated to reflect new or changed policies. Additionally or alternatively the client device information may be updated to reflect a new policy identifier associated with client devices a new status associated with client devices and or a new alarm state e.g. active or deactive . For example if any device in operator network detects that client device violated a policy the status may be updated at other devices in operator network to reflect the current status of client device .

In some implementations base station and or MME may determine whether the cached policy data structure includes client device information for client device that sent the RRC request based on the client device identifier of client device . If the policy data structure does not include client device information for client device then base station and or MME may determine not to reject the RRC request based on a stored policy but not necessarily to accept the RRC request .

If the policy data structure includes client device information for client device then base station and or MME may determine a status of client device based on the client device information. Base station and or MME may determine whether to reject the RRC request based on the status. For example if the status indicates the RRC request should be rejected the communication session should be terminated and or the communication session should be throttled base station and or MME may determine to reject the RRC request. On the other hand if the status indicates no action should be taken then base station and or MME may determine not to reject the RRC request based on the status but not necessarily to accept the RRC request .

In some implementations if the policy data structure includes client device information for client device then base station and or MME may determine a policy associated with client device based on the client device information and the local policy information. Base station and or MME may determine whether to reject the RRC request based on whether the RRC request violates the policy. For example base station and or MME may detect how many RRC requests have been received from client device at a respective base station and or at a respective MME in a particular amount of time and or use deep packet inspection DPI to determine a security protocol e.g. an internet security protocol IPsec to be used to transmit a data packet. For example base station and or MME may use DPI to detect an encapsulating security payload ESP header and or an authentication header AH included in a data packet to be transmitted from client device . If base station and or MME do not detect that a threshold access limit is exceeded and or a particular security protocol is to be used then base station and or MME may determine not to reject the RRC request based on the policy but not necessarily to accept the RRC request .

In some implementations the policy may throttle or prevent new communication sessions if the RRC request will cause client device to exceed the threshold access limit. Thus if the RRC request exceeds the threshold access limit base station and or MME may determine to reject the RRC request in accordance with the policy. It should be noted that a base station may not detect that a RRC request exceeds the threshold access limit but an associated MME may detect that the RRC request exceeds the threshold access limit. Such a situation may occur when client device sends multiple RRC requests to multiple base stations in a particular amount of time none of which exceed the threshold access rate at any one base station . Accordingly each base station may not detect a violation. However the multiple RRC requests may go through a same MME which may add together the RRC requests from the multiple base stations to detect the violation.

Additionally or alternatively the policy may restrict particular security protocols. Thus if the RRC request indicates a particular security protocol will be used base station and or MME may determine to reject the RRC request in accordance with the policy. On the other hand the policy may indicate that no action should be taken even if the threshold access limit is exceeded and or the particular security protocol is used. Thus base station and or MME may determine not to reject the RRC based on the policy but not necessarily to accept the RRC request .

As further shown in if base station and or MME determines that the RRC request should be rejected based on the cached policy data structure block yes process may include sending a RRC rejection message to client device block . For example base station may send the RRC rejection message to client device and or MME may instruct base station to send the RRC rejection message. The RRC rejection message may be a message that rejects assigning radio resources to client device . Client device may receive the RRC rejection message and may be not be permitted to connect to operator network .

In some implementations base station and or MME may send update information to service control server indicating that client device sent a RRC request and or that the RRC rejection message was sent to client device . Additionally or alternatively the update information may indicate a reason why the RRC rejection message was sent to client device .

As further shown in if base station and or MME determines that the RRC request should not be rejected based on the cached policy data structure block no process may include determining if an alarm condition is satisfied block . For example base station and or MME may determine if an alarm condition is satisfied.

In some implementations base station and or MME may store alarm information indicating an alarm condition. The alarm condition may identify the threshold access limit and or a different access limit that indicates how often any client device may be assigned radio resources from a base station and or access operator network . For example the alarm condition may be satisfied if a rate at which RRC requests are received exceeds the threshold access limit and or the different access limit. Additionally or alternatively the policy rule may restrict a kind of data security and or a kind of data transmission. For example the alarm condition may be satisfied by using transport layer security TLS a secure sockets layer SSL protocol a virtual private network VPN etc.

In some implementations base station and or MME may determine if all RRC requests satisfy an alarm condition. In some implementations base station and or MME may determine if a RRC request satisfies an alarm condition only when the cached policy data structure does not store a policy for the client device that sent the RRC request. In some implementations base station and or MME may determine if a RRC request satisfies an alarm condition only when the RRC request was not rejected based on the cached policy data structure. In some implementations base station and or MME may determine if an alarm condition is satisfied before simultaneously with or after base station and or MME determines whether to reject the RRC request based on the cached policy data structure.

As further shown in if base station and or MME determine that the alarm condition is not satisfied block no process may include sending a RRC accept message to client device block . For example base station may send the RRC accept message to client device and or MME may instruct base station to send the RRC accept message. The RRC accept message may be a message that assigns radio resources to client device and or acknowledges that radio resources will be assigned to client device . Client device may receive the RRC accept message and use the RRC accept message to communicate with operator network .

In some implementations base station and or MME may send information to service control server indicating that client device sent a RRC request and or that the RRC accept message was sent to client device .

As further shown in if base station and or MME determine that the alarm condition is satisfied block yes process may include sending an alarm message to service control server block . For example base station and or MME may send the alarm message to service control server based on the alarm condition being satisfied. The alarm message may indicate the alarm condition that was satisfied and the client device identifier for client device . For example the alarm message may indicate a threshold access rate is exceeded and or a security protocol is being used by client device . In some implementations base station and or MME may update an alarm state indicated by the client device information to indicate the alarm state is active. While the alarm state is active base station and or MME may not permit a RRC accept message to be sent to client device .

As further shown in process may include sending a subscription query to HSS AAA server block . For example service control server may send the subscription query to HSS AAA server based on receiving the alarm message. The subscription query may include the client device identifier for client device and request device type information about client device . The device type information may indicate whether client device is a M2M device.

HSS AAA server may receive the subscription query from control server . HSS AAA server may store subscription information for client devices registered with operator network . HSS AAA server may query the subscription information using the client device identifier included in the subscription query and obtain device type information for client device .

As further shown in process may include sending a subscription response to service control server block . For example HSS AAA server may send the subscription response to service control server . The subscription response may include the obtained device type information and indicate a device type of client device .

As further shown in process may include determining whether client device is a M2M device based on the subscription response block . For example service control server may determine whether client device is a M2M device.

In some implementations service control server may determine client device is a M2M device if the device type information included in the subscription response indicates client device is a M2M device. On the other hand service control server may determine client device is not a M2M device if the device type information included in the subscription response indicates client device is not a M2M device.

In some implementations operator network may define which devices are M2M devices. For example M2M may be a device class defined by operator network .

As further shown in if service control server determines client device is not a M2M device block no process may include sending a cancel alarm message to base station and or MME block . For example service control server may send the cancel alarm message. The cancel alarm message may indicate to set an alarm state for client device to deactive.

Base station and or MME may receive the cancel alarm message and set the alarm state to deactive for client device .

In some implementations the cancel alarm message may include M2M information indicating that client device is not a M2M device. Base station and or MME may store the M2M information indicating client device is not a M2M device. Accordingly base station and or MME may not send alarm messages for client device in the future based on client device not being a M2M device.

As further shown in process may include sending a RRC accept message to client device block . For example base station may send the RRC accept message to client device and or MME may instruct base station to send the RRC accept message. The RRC accept message may be a message that assigns radio resources to client device and or acknowledges that radio resources will be assigned to client device . Client device may receive the RRC accept message and use the RRC accept message to communicate with operator network .

As further shown in if service control server determines client device is a M2M device block yes process may include sending a policy query to PCRF block . For example service control server may send the policy query to PCRF based on client device being a M2M device. The policy query may include the client device identifier for client device and information indicating an event detected by base station . The policy query may further request a policy associated with client device .

PCRF may receive the policy query from service control server . PCRF may store policy information for client devices registered with operator network . PCRF may query the policy information using the client device identifier and or the information indicating the event included in the subscription query and obtain policy information for client device .

As further shown in process may include sending a policy response to service control server block . For example PCRF may send the policy response to service control server . The policy response may include the obtained policy information for client device and indicate a policy for client device .

As further shown in service control server may determine whether to cancel the alarm based on the policy for client device block . For example service control server may determine whether to cancel the alarm based on the policy obtained from PCRF a RRC request received by one or more base stations an alarm condition satisfied by client device at one or more base stations and or MMEs a trigger message received from application server by one or more PGWs and or IWFs and or an alarm condition satisfied for client device at one or more PGWs and or IWFs.

In some implementations the policy obtained from PCRF may include a policy rule that limits an access rate to a permitted access rate. Accordingly service control server may determine whether client device complies with the policy based on how many RRC requests have been received from client device at one or more base stations and or MMEs in a particular amount of time and or how many trigger messages have been received from application server by one or more PGWs and or IWFs in the particular amount of time. For example service control server may add together all the RRC requests received from client device and all the trigger messages sent to client device to calculate a total number of messages in the particular amount of time. Service control server may determine the total number of messages in the particular amount of time based on alarm messages and or update information received from base stations MMEs PGWs and or IWFs .

In other words while each base station MME PGW and or IWF may determine whether an individual interaction with client device violates a policy for client device service control server may determine whether the cumulative interactions between client device and devices of operator network violate the policy for client device .

If the total number of messages in the particular amount of time does not exceed the access limit permitted by the policy for client device then service control server may determine that client device complies with the policy. Accordingly service control server may determine to cancel the alarm based on the access limit not being exceeded.

On the other hand if the total number of messages in the particular amount of time exceeds an access limit permitted by a policy for client device then service control server may determine that client device does not comply with the policy. Accordingly service control server may determine whether to cancel the alarm based on the policy action associated with violating the policy rule e.g. exceeding the permitted access limit . For example the policy action may indicate no action should be taken e.g. the total number of messages in the particular amount of time is permitted . Accordingly service control server may determine to cancel the alarm. On the other hand the policy action may indicate to reject the RRC request and or to throttle the communication session with client device . Accordingly service control server may determine not to cancel the alarm and to reject the RRC request based on the policy action.

In some implementations the policy information obtained from PCRF may include a policy rule that restricts the use of a particular security protocol. Accordingly control server may determine whether client device complies with the policy based on whether an alarm message indicates the particular security protocol is being used. If the particular security protocol is not being used then control server may determine that client device complies with the policy and the alarm should be cancelled.

On the other hand if the particular security protocol is being used then control server may determine that client device does not comply with the policy. Accordingly service control server may determine whether to cancel the alarm based on the policy action associated with violating the policy rule e.g. using the restricted security protocol . For example the policy action may indicate no action should be taken e.g. client device is permitted to use the security protocol . Accordingly service control server may determine to cancel the alarm. On the other hand the policy action may indicate to reject the RRC request and or to throttle the communication session with client device . Accordingly service control server may determine not to cancel the alarm and to reject the RRC request based on the policy action.

As further shown in if service control server determines to cancel the alarm block yes process may include sending a cancel alarm message to base station and or MME block . For example service control server may send the cancel alarm message. The cancel alarm message may indicate to set an alarm state for client device to deactive.

Base station and or MME may receive the cancel alarm message and set the alarm state to deactive for client device .

In some implementations the cancel alarm message may include policy information indicating the policy for client device . Base station and or MME may use the policy information to update client device information included in the cached policy data structure to indicate the policy for client device .

As further shown in process may include sending a RRC accept message to client device block . For example base station may send the RRC accept message to client device and or MME may instruct base station to send the RRC accept message. The RRC accept message may be a message that assigns radio resources to client device and or acknowledges that radio resources will be assigned to client device . Client device may receive the RRC accept message and use the RRC accept message to communicate with operator network .

As further shown in if service control server determines not to cancel the alarm block no process may include sending a rejection instruction to base station and or MME block . For example service control server may send the rejection instruction. The rejection instruction may indicate to reject the RRC request from client device and to maintain the alarm state of client device as active.

In some implementations the rejection instruction may include policy information indicating the policy for client device . Base station and or MME may use the policy information to update client device information included in the cached policy data structure to indicate the policy for client device .

As further shown in process may include sending a RRC rejection message to client device block . For example base station may send the RRC rejection message to client device and or MME may instruct base station to send the RRC rejection message based on receiving the rejection instruction from service control server . The RRC rejection message may be a message that rejects assigning radio resources to client device . Client device may receive the RRC rejection message and may be not be permitted to connect to operator network .

As shown in if service control server determines not to cancel the alarm block no process may include sending a notification to application server block . For example service control server may send a notification to an application server that controls client device . The notification may indicate that client device is not complying with a permitted policy. The application server may receive the notification and take action to control client device to comply with the policy. For example application server may send a control message to client device that instructs client device to reduce RRC requests and or to use approved security protocols.

As further shown in process may include sending update information to base station and or MME block . For example service control server may send update information to base station and or MME to update the cached policy data structure.

For instance the local policy information may be updated to reflect new or changed policies. Additionally or alternatively the client device information may be updated to reflect new or changed polices for client device as indicated by PCRF . For example the update information may indicate a new policy identifier associated with client device . Moreover the client device information may be updated to reflect a new status associated with client device and or a new alarm state e.g. active or deactive . For example if any device in operator network detects that client device violated a policy the status may be updated at other devices in operator network to reflect the current status of client device .

As further shown in process may include updating the cached policy data structure block . For example base station and or MME may update the cached policy data structure based on the update information. Thus base station and or MME may be able to accurately determine to accept or reject a future RRC request e.g. at blocks using the cached policy data structure without service control server having to determine to accept or reject the future RRC request.

As further shown in process may include sending update information to PGW and or IWF block . For example service control server may send update information to PGW and or IWF to update the cached policy data structure.

For instance the local policy information may be updated to reflect new or changed policies. Additionally or alternatively the client device information may be updated to reflect new or changed polices for client device as indicated by PCRF . For example the update information may indicate a new policy identifier associated with client device . Moreover the client device information may be updated to reflect a new status associated with client device and or a new alarm state e.g. active or deactive . For example if any device in operator network detects that client device violated a policy the status may be updated at other devices in operator network to reflect the current status of client device .

As further shown in process may include updating the cached policy data structure block . For example PGW and or IWF may update the cached policy data structure based on the update information e.g. generated based on interaction between client device and base station MME . Thus PGW and or IWF may be able to accurately determine to accept or reject a trigger message from application server as will be discussed in more detail with respect to using the cached policy data structure without service control server having to determine to accept or reject the trigger message.

Although show example blocks of process in some implementations process may include additional blocks fewer blocks different blocks or differently arranged blocks than those depicted in . Additionally or alternatively two or more of the blocks of process may be performed in parallel.

As shown in process may include receiving a RRC request from client device block . For example base station and or MME may receive the RRC request as discussed with respect to block in .

As further shown in process may include determining whether a cached policy data structure indicates to reject the RRC request block . For example base station and or MME may determine whether the cached policy data structure indicates to reject the RRC request as discussed with respect to block in .

As further shown in if the cached policy data structure indicates to reject the RRC request block yes process may include sending a RRC rejection message to client device block . For example base station and or MME may send the RRC rejection message as discussed with respect to block in .

As further shown in if the cached policy data structure indicates not to reject the RRC request block no process may include determining whether the RRC request causes client device to satisfy an alarm condition block . For example base station and or MME may determine whether the RRC request causes client device to satisfy an alarm condition as discussed with respect to block in .

As further shown in if the RRC request does not cause client device to satisfy an alarm condition block no process may include sending a RRC accept message to client device and assign radio resources to client device block . For example base station and or MME may send the RRC accept message and assign radio resources as discussed with respect to block in .

As further shown in if the RRC request does cause client device to satisfy an alarm condition block yes process may include sending an alarm message to service control server block . For example base station and or MME may send the alarm message as discussed with respect to block in .

As further shown in process may include receiving the alarm message from base station and or MME block . For example service control server may receive the alarm message as discussed with respect to block in .

As further shown in process may include sending a subscription query to HSS AAA server block . For example service control server may send the subscription query as discussed with respect to block in .

As further shown in process may include receiving a subscription response from HSS AAA server block . For example service control server may receive the subscription query as discussed with respect to block in .

As shown in process may include determining whether client device is a M2M device based on the subscription response block . For example service control server may determine whether client device is a M2M device as discussed with respect to block in .

As further shown in if client device is determined not to be a M2M device block no process may include sending a cancel alarm message to base station and or MME block . For example service control server may send the cancel alarm message as discussed with respect to block in .

As further shown in process may include receiving the cancel alarm message from service control server block . For example base station and or MME may receive the cancel alarm message as discussed with respect to block in .

As further shown in process may include sending a RRC accept message to client device and assigning radio resources to client device block . For example base station and or MME may send the RRC accept message and assign radio resources as discussed with respect to block in .

As further shown in if client device is determined to be a M2M device block yes process may include sending a policy query to PCRF block . For example service control server may send a policy query as discussed with respect to block in .

As further shown in process may include receiving a policy response from PCRF block . For example service control server may receive the policy response as discussed with respect to block in .

As shown in process may include determining whether to cancel the alarm based on the policy response block . For example service control server may determine whether to cancel the alarm based on the policy response as discussed with respect to block in .

As further shown in if the RRC request causes client device to comply with the policy block yes process may include sending a cancel alarm message to base station and or MME block . For example service control server may send the cancel alarm message as discussed with respect to block in .

As further shown in process may include receiving the cancel alarm message from service control server block . For example base station and or MME may receive the cancel alarm message as discussed with respect to block in .

As further shown in process may include sending a RRC accept message to client device and assigning radio resources to client device block . For example base station and or MME may send the RRC accept message and assign radio resources as discussed with respect to block in .

As further shown in if the RRC request causes client device to not comply with the policy block no process may include sending a RRC rejection instruction to base station and or MME block . For example service control server may send the RRC rejection instruction as discussed with respect to block in .

As further shown in process may include receiving the RRC rejection instruction from service control server block . For example base station and or MME may receive the RRC rejection instruction as discussed with respect to block in .

As further shown in process may include sending a RRC reject message to client device block . For example base station and or MME may send the RRC reject message as discussed with respect to block in .

As further shown in process may include sending update information to base station MME PGW and or IWF block . For example service control server may send update information as discussed with respect to blocks and in .

As further shown in process may include receiving the update information from service control server block . For example base station and or MME may receive the update information as discussed with respect to block in .

As further shown in process may include updating the cached policy data structure based on the update information block . For example base station and or MME may update the cached policy data structure as discussed with respect to block in .

As further shown in process may include sending a notification to application server indicating that client device is non compliant block . For example service control server may send the notification as discussed with respect to block in .

Although show example blocks of process in some implementations process may include additional blocks fewer blocks different blocks or differently arranged blocks than those depicted in . Additionally or alternatively two or more of the blocks of process may be performed in parallel.

In example implementation assume base station stores in cache memory a cached policy data structure as illustrated in . For example the cached policy data structure may include local policy information and client device information. Assume the local policy information indicates a first policy having a policy identifier 1 which throttles access to operator network to five accesses per minute when a threshold access limit of three access per minute is exceeded. Further assume the local policy information indicates a second policy having a policy identifier 2 which rejects a message having an ESP header. Further assume the client device information does not include any information at this time. In other words assume the cached policy data structure does not indicate a policy for client device .

Also assume base station stores alarm information indicating an alarm condition that is satisfied when more than three access requests are received from client device and or a data packet includes an ESP header.

As shown in assume that client device sends a fourth RRC request to base station within a minute. Assume base station sent RRC accept messages to client device in response to a first three RRC requests in the minute because the first three RRC requests did not violate a policy indicated by the cached policy data structure or trigger an alarm.

Base station may receive the fourth RRC request and determine that the fourth RRC request triggers an alarm based on violating an alarm condition. Base station may send an alarm message to service control server . The alarm message may indicate a client device identifier e.g. IMSI1 for client device and indicate that client device sent four RRC requests within a minute.

Service control server may receive the alarm message and obtain policy information for client device based on the client device identifier. Assume the policy information indicates that policy 1 and policy 2 are associated with client device . Accordingly service control server may determine that client device is permitted five accesses per minute and that client device is complying with policy 1. Service control server may send a cancel alarm message and update information to base station .

Base station may receive the cancel alarm message and the update information. Base station may cancel the alarm and send a RRC accept message to client device . Furthermore base station may update the client device information included in the cached policy data structure based on the update information.

As shown in base station may update the client device information to include an entry for client device having IMSI1. The client device information may associate policy 1 and policy 2 with client device and indicate that a status for client device is that accesses should be throttled to five per minute.

As further shown in assume that client device sends a fifth RRC request within the minute to base station . Base station may receive the fifth RRC request and determine client device is complying with policy 1 based on the cached policy data structure. Accordingly base station may send a RRC accept message to client device without consulting service control server .

As further shown in assume that client device sends a sixth RRC request within the minute to base station . Base station may receive the sixth RRC request and determine the sixth RRC request causes client device to violate policy 1 based on the cached policy data structure. Accordingly base station may send a RRC rejection message to client device without consulting service control server . Additionally or alternatively base station may send update information to service control server indicating that client device violated policy 1 so that service control server may update cached policy data structures within other devices included in operator network .

In this way client device s access to operator network may be controlled based on policies associated with client device .

As indicated above are provided merely as an example. Other examples are possible and may differ from what was described with regard to .

As shown in process may include sending a trigger message to PGW and or IWF block . For example application server may send a trigger message to client device via PGW and or IWF . In some implementations the trigger message may be used to send information to client device and or request information from client device and may cause operator network to assign radio resources to client device for communication. The trigger message may indicate a client device identifier that uniquely identifies client device e.g. a phone number an IP address an IMSI an IMEI a MEID etc. .

PGW may receive the trigger message from application server . Additionally or alternatively IWF may receive the trigger message from application server via SCS .

As further shown in process may include determining whether to reject the trigger message based on a policy stored in a cached policy data structure block . For example PGW and or IWF may determine whether to reject the trigger message based on the stored policy.

In some implementations PGW and or IWF may store a cached policy data structure in cache memory . The cached policy data structure may include local policy information that identifies one or more policies and or may include client device information that identifies policies associated with one or more client devices .

The local policy information may associate a policy identifier that uniquely identifies the policy a policy rule for the policy and or a policy action to take for a violation of the policy rule.

In some implementations the policy rule may identify a threshold access limit that indicates how often any client device may be assigned radio resources from a base station and or access operator network . For example the threshold access limit may indicate a minimum number of communication sessions e.g. based on RRC connection requests from client device and or based on a trigger message from application server to connect to client device that any client device is permitted per an amount of time. Additionally or alternatively the policy rule may restrict a kind of data security and or a kind of data transmission. For example the policy rule may restrict data being sent using TLS a SSL protocol a VPN etc. In some implementations the policy rule may act as a trigger that triggers a policy action to be enforced.

In some implementations the policy action may include throttling a communication session e.g. limiting how often client device may be assigned radio resources and or access operator network releasing a communication session preventing a new communication session from being established preventing radio resources from being assigned and or taking no action.

For example the local policy information may indicate a policy that throttles a communication session if the threshold access limit is reached. In other words if client device is accessing operator network at a rate faster than a permitted threshold access limit e.g. one access per one minute the policy may limit subsequent requests to a different rate e.g. one access per five minutes . On the other hand the local policy information may indicate that no action should be taken if the threshold access limit is reached.

As another example the local policy information may indicate another policy that restricts using a SSL protocol. If the policy rule is violated by data being transmitted or attempted to be transmitted during a communication using a SSL protocol then the local policy information may indicate that the communication session should be released or terminated. On the other hand if the policy rule is violated by data being transmitted using a SSL protocol the local policy information may indicate that no action should be taken and communication using the SSL protocol should be allowed.

The client device information may associate a client device identifier for client device a policy identifier of a policy for client device a status of a client device and or an alarm state for client device . The status may indicate a current policy action that should be taken for the associated client device . The alarm state may indicate whether an alarm has been triggered for client device . In some implementations a trigger message may not be sent to client device while an alarm is in an active state and or radio resources may not be assigned to client device .

In some implementations PGW and or IWF may determine whether the cached policy data structure includes client device information for client device to which the trigger message is to be sent. If the policy data structure does not include client device information for client device then PGW and or IWF may determine not to reject the trigger message based on a stored policy but not necessarily to send the trigger message to client device .

If the policy data structure includes client device information for client device then PGW and or IWF may determine a status of client device based on the client device information. PGW and or IWF may determine whether to reject the trigger message based on the status of client device . For example if the status indicates radio resources should not be assigned to client device the communication session should be terminated and or the communication session should be throttled PGW and or IWF may determine to reject the trigger message. On the other hand if the status indicates no action should be taken then PGW and or IWF may determine not to reject the trigger message based on the status of client device but not necessarily to send the trigger message to client device .

In some implementations if the cached policy data structure includes client device information for client device then PGW and or IWF may determine a policy associated with client device based on the client device information and the local policy information. PGW and or IWF may determine whether to reject the trigger message based on whether the trigger message will cause client device to violate the policy. For example PGW and or IWF may detect how many trigger messages have been sent to client device via a respective PGW and or IWF in a particular amount of time and or use deep packet inspection DPI to determine a security protocol to be used. If PGW and or IWF do not detect that a threshold access limit is exceeded and or a particular security protocol is to be used then PGW and or IWF may determine not to reject the trigger message based on the policy but not necessarily to send the trigger message to client device .

In some implementations the policy may throttle or prevent new communication sessions if the trigger message will cause client device to exceed the threshold access limit. Thus if sending the trigger message to client device would cause client device to exceed the threshold access limit PGW and or IWF may determine to reject the trigger message in accordance with the policy.

Additionally or alternatively the policy may restrict particular security protocols. Thus if the trigger message indicates a particular security protocol will be used PGW and or IWF may determine to reject the trigger message in accordance with the policy. On the other hand the policy may indicate that no action should be taken even if the threshold access limit is exceeded and or the particular security protocol is used. Thus PGW and or IWF may determine not to reject the trigger message based on the policy but not necessarily to send the trigger message to client device .

As further shown in if PGW and or IWF determines that the trigger message should be rejected based on the cached policy data structure block yes process may include sending a notification to application server block . For example PGW and or IWF may send the notification to application server . The notification may be a message that notifies application server that the trigger message will not be sent to client device . Additionally or alternatively the notification may indicate a policy that sending the trigger request to client device would cause client device to violate.

Application server may receive the notification and take action to control how often trigger messages are sent to client device and or what security protocols are used.

In some implementations PGW and or IWF may send update information to service control server indicating that application server sent a trigger message for client device and or that the notification was sent to client device . Additionally or alternatively the update information may indicate a reason why the notification was sent to client device e.g. indicate a policy that was violated .

As further shown in if PGW and or IWF determines that the trigger message should not be rejected based on the cached policy data structure block no process may include determining if an alarm condition is satisfied block . For example PGW and or IWF may determine if an alarm condition is satisfied.

In some implementations PGW and or IWF may store alarm information indicating an alarm condition. The alarm condition may identify the threshold access limit and or a different access limit that indicates how often any client device may be assigned radio resources and or access operator network . For example the alarm condition may be satisfied if a rate at which trigger messages are received exceeds the threshold access limit and or the different access limit. Additionally or alternatively the policy rule may restrict a kind of data security and or a kind of data transmission. For example the alarm condition may be satisfied by using transport layer security TLS a secure sockets layer SSL protocol a virtual private network VPN etc.

In some implementations PGW and or IWF may determine if all trigger messages satisfy an alarm condition. In some implementations PGW and or IWF may determine if a trigger message satisfies an alarm condition only when the cached policy data structure does not store a policy for the client device to which the trigger message is to be sent. In some implementations PGW and or IWF may determine if a trigger message satisfies an alarm condition only when the trigger message was not rejected based on the cached policy data structure. In some implementations PGW and or IWF may determine if an alarm condition is satisfied before simultaneously with or after PGW and or IWF determines whether to reject the trigger message based on the cached policy data structure.

As further shown in if PGW and or IWF determine that the alarm condition is not satisfied block no process may include causing the trigger message to be sent to client device block . For example PGW and or IWF may cause the trigger message to be sent to client device via operator network by causing radio resources to be assigned to client device . Client device may receive the trigger message.

In some implementations PGW and or IWF may send information to service control server indicating that client device was sent the trigger message.

As further shown in if PGW and or IWF determine that the alarm condition is satisfied block yes process may include sending an alarm message to service control server block . For example PGW and or IWF may send the alarm message to service control server based on the alarm condition being satisfied. The alarm message may indicate the alarm condition that was satisfied and the client device identifier for client device . For example the alarm message may indicate the trigger message will cause a threshold access rate to be exceeded and or a security protocol to be used to communicate with client device . In some implementations PGW and or IWF may update an alarm state indicated by the client device information to indicate the alarm state is active. While the alarm state is active PGW and or IWF may not permit the trigger message to be sent to client device .

As further shown in process may include sending a subscription query to HSS AAA server block . For example service control server may send the subscription query to HSS AAA server based on receiving the alarm message. The subscription query may include the client device identifier for client device and request device type information about client device . The device type information may indicate whether client device is a M2M device.

HSS AAA server may receive the subscription query from control server . HSS AAA server may store subscription information for client devices registered with operator network . HSS AAA server may query the subscription information using the client device identifier included in the subscription query and obtain device type information for client device .

As further shown in process may include sending a subscription response to service control server block . For example HSS AAA server may send the subscription response to service control server . The subscription response may include the obtained device type information and indicate a device type of client device .

As further shown in process may include determining whether client device is a M2M device based on the subscription response block . For example service control server may determine whether client device is a M2M device.

In some implementations service control server may determine client device is a M2M device if the device type information included in the subscription response indicates client device is a M2M device. On the other hand service control server may determine client device is not a M2M device if the device type information included in the subscription response indicates client device is not a M2M device.

As further shown in if service control server determines client device is not a M2M device block no process may include sending a cancel alarm message to PGW and or IWF block . For example service control server may send the cancel alarm message. The cancel alarm message may indicate to set an alarm state for client device to deactive.

PGW and or IWF may receive the cancel alarm message and set the alarm state to deactive for client device .

In some implementations the cancel alarm message may include M2M information indicating that client device is not a M2M device. PGW and or IWF may store the M2M information indicating client device is not a M2M device. Accordingly PGW and or IWF may not send alarm messages in response to trigger messages being sent to client device in the future based on client device not being a M2M device.

As further shown in process may include causing the trigger message to be sent to client device via operator network block . For example PGW and or IWF may cause the trigger message to be sent to client device via operator network by causing radio resources to be assigned to client device . Client device may receive the trigger message.

As further shown in if service control server determines client device is a M2M device block yes process may include sending a policy query to PCRF block . For example service control server may send the policy query to PCRF based on client device being a M2M device. The policy query may include the client device identifier for client device and request a policy associated with client device .

PCRF may receive the policy query from service control server . PCRF may store policy information for client devices registered with operator network . PCRF may query the policy information using the client device identifier included in the subscription query and obtain policy information for client device .

As further shown in process may include sending a policy response to service control server block . For example PCRF may send the policy response to service control server . The policy response may include the obtained policy information for client device and indicate a policy for client device .

As further shown in process may include service control server determining whether to cancel the alarm based on the policy for client device block . For example service control server may determine whether to cancel the alarm based on the policy obtained from PCRF a RRC request received by one or more base stations an alarm condition satisfied by client device at one or more base stations and or MMEs a trigger message received from application server by one or more PGWs and or IWFs and or an alarm condition satisfied for client device at one or more PGWs and or IWFs.

In some implementations the policy obtained from PCRF may include a policy rule that limits an access rate to a permitted access rate. Accordingly service control server may determine whether client device complies with the policy based on how many RRC requests have been received from client device at one or more base stations and or MMEs in a particular amount of time and or how many trigger messages have been received from application server by one or more PGWs and or IWFs in the particular amount of time. For example service control server may add together all the RRC requests received from client device and all the trigger messages sent to client device to calculate a total number of messages in the particular amount of time. Service control server may determine the total number of messages in the particular amount of time based on alarm messages and or update information received from base stations MMEs PGWs and or IWFs .

In other words while each base station MME PGW and or IWF may determine whether an individual interaction with client device and or application server violates a policy for client device service control server may determine whether the cumulative interactions between client device and devices of operator network violate the policy for client device .

If the total number of messages in the particular amount of time does not exceed the access limit permitted by the policy for client device then service control server may determine that client device complies with the policy. Accordingly service control server may determine to cancel the alarm based on the access limit not being exceeded.

On the other hand if the total number of messages in the particular amount of time exceeds an access limit permitted by a policy for client device then service control server may determine that client device does not comply with the policy. Accordingly service control server may determine whether to cancel the alarm based on the policy action associated with violating the policy rule e.g. exceeding the permitted access limit . For example the policy action may indicate no action should be taken e.g. the total number of messages in the particular amount of time is permitted . Accordingly service control server may determine to cancel the alarm. On the other hand the policy action may indicate to reject the trigger message and or not to assign radio resources to client device . Accordingly service control server may determine not to cancel the alarm and to reject the trigger message based on the policy action.

In some implementations the policy obtained from PCRF may include a policy rule that restricts the use of a particular security protocol. Accordingly control server may determine whether the trigger message would cause client device to comply with the policy based on whether an alarm message indicates the particular security protocol is being used. If the particular security protocol is not being used then control server may determine that client device complies with the policy and the alarm should be cancelled.

On the other hand if the particular security protocol is being used then control server may determine that client device does not comply with the policy. Accordingly service control server may determine whether to cancel the alarm based on the policy action associated with violating the policy rule e.g. using the restricted security protocol . For example the policy action may indicate no action should be taken e.g. client device is permitted to use the security protocol . Accordingly service control server may determine to cancel the alarm. On the other hand the policy action may indicate to reject the trigger message and or to not assign radio resources to client device . Accordingly service control server may determine not to cancel the alarm and to reject the trigger message based on the policy action.

As further shown in if service control server determines to cancel the alarm block yes process may include sending a cancel alarm message to PGW and or IWF block . For example service control server may send the cancel alarm message to PGW and or IWF . The cancel alarm message may indicate to set an alarm state for client device to deactive.

PGW and or IWF may receive the cancel alarm message and set the alarm state to deactive for client device .

In some implementations the cancel alarm message may include policy information indicating the policy for client device . PGW and or IWF may use the policy information to update client device information included in the cached policy data structure to indicate the policy for client device .

As further shown in process may include causing the trigger message to be sent to client device via operator network block . For example PGW and or IWF may cause the trigger message to be sent to client device via operator network by causing radio resources to be assigned to client device . Client device may receive the trigger message.

As further shown in if service control server determines not to cancel the alarm block no process may include sending a rejection instruction to PGW and or IWF block . For example service control server may send the rejection instruction. The rejection instruction may indicate to reject the trigger message from application server and to send a notification to application server .

In some implementations the rejection instruction may include policy information indicating the policy for client device . PGW and or IWF may use the policy information to update client device information included in the cached policy data structure to indicate the policy for client device .

As further shown in process may include sending a notification to application server block . For example PGW and or IWF may send the notification to application server . The notification may be a message that notifies application server that the trigger message will not be sent to client device . Additionally or alternatively the notification may indicate a policy that sending the trigger request to client device would cause client device to violate.

Application server may receive the notification and take action to control how often trigger messages are sent to client device and or what security protocols are used.

As shown in process may include sending update information to base station and or MME block . For example service control server may send update information to base station and or MME to update the cached policy data structure.

For instance the local policy information may be updated to reflect new or changed policies. Additionally or alternatively the client device information may be updated to reflect new or changed polices for client device as indicated by PCRF . For example the update information may indicate a new policy identifier associated with client device . Moreover the client device information may be updated to reflect a new status associated with client device and or a new alarm state e.g. active or deactive . For example if any device in operator network detects that client device violated a policy the status may be updated at other devices in operator network to reflect the current status of client device .

As further shown in process may include updating the cached policy data structure block . For example base station and or MME may update the cached policy data structure based on the update information. Thus base station and or MME may be able to accurately determine to accept or reject a future RRC request using the cached policy data structure without service control server having to determine to accept or reject the future RRC request.

As further shown in process may include sending update information to PGW and or IWF block . For example service control server may send update information to PGW and or IWF to update the cached policy data structure.

For instance the local policy information may be updated to reflect new or changed policies. Additionally or alternatively the client device information may be updated to reflect new or changed polices for client device as indicated by PCRF . For example the update information may indicate a new policy identifier associated with client device . Moreover the client device information may be updated to reflect a new status associated with client device and or a new alarm state e.g. active or deactive . For example if any device in operator network detects that client device violated a policy the status may be updated at other devices in operator network to reflect the current status of client device .

As further shown in process may include updating the cached policy data structure block . For example PGW and or IWF may update the cached policy data structure based on the update information. Thus PGW and or IWF may be able to accurately determine to accept or reject a trigger message from application server using the cached policy data structure without service control server having to determine to accept or reject the trigger message.

Although show example blocks of process in some implementations process may include additional blocks fewer blocks different blocks or differently arranged blocks than those depicted in Additionally or alternatively two or more of the blocks of process may be performed in parallel.

As shown in process may include receiving a trigger message from application server block . For example PGW and or IWF may receive the trigger message as discussed with respect to block in .

As further shown in process may include determining whether a cached policy data structure indicates to reject the trigger message block . For example PGW and or IWF may determine whether the cached policy data structure indicates to reject the trigger message as discussed with respect to block in .

As further shown in if the cached policy data structure indicates to reject the trigger message block yes process may include sending a notification to application server block . For example PGW and or IWF may send the notification as discussed with respect to block in .

As further shown in if the cached policy data structure indicates not to reject the trigger message block no process may include determining whether the trigger message causes client device to satisfy an alarm condition block . For example PGW and or IWF may determine whether the trigger message causes client device to satisfy an alarm condition as discussed with respect to block in .

As further shown in if the trigger message does not cause client device to satisfy an alarm condition block no process may include causing the trigger message to be sent to client device block . For example PGW and or IWF may cause the trigger message to be sent to client device as discussed with respect to block in .

As further shown in if the trigger message does cause client device to satisfy an alarm condition block yes process may include sending an alarm message to service control server block . For example PGW and or IWF may send the alarm message as discussed with respect to block in .

As further shown in process may include receiving the alarm message from PGW and or IWF block . For example service control server may receive the alarm message as discussed with respect to block in .

As further shown in process may include sending a subscription query to HSS AAA server block . For example service control server may send the subscription query as discussed with respect to block in .

As further shown in process may include receiving a subscription response from HSS AAA server block . For example service control server may receive the subscription query as discussed with respect to block in .

As shown in process may include determining whether client device is a M2M device based on the subscription response block . For example service control server may determine whether client device is a M2M device as discussed with respect to block in .

As further shown in if client device is determined not to be a M2M device block no process may include sending a cancel alarm message to PGW and or IWF block . For example service control server may send the cancel alarm message as discussed with respect to block in .

As further shown in process may include receiving the cancel alarm message from service control server block . For example PGW and or IWF may receive the cancel alarm message as discussed with respect to block in .

As further shown in process may include causing the trigger message to be sent to client device block . For example PGW and or IWF may cause the trigger message to be sent to client device as discussed with respect to block in .

As further shown in if client device is determined to be a M2M device block yes process may include sending a policy query to PCRF block . For example service control server may send a policy query as discussed with respect to block in .

As further shown in process may include receiving a policy response from PCRF block . For example service control server may receive the policy response as discussed with respect to block in .

As shown in process may include determining whether to cancel the alarm based on the policy response block . For example service control server may determine whether to cancel the alarm based on the policy response as discussed with respect to block in .

As further shown in if the trigger message causes client device to comply with the policy block yes process may include sending a cancel alarm message to PGW and or IWF block . For example service control server may send the cancel alarm message as discussed with respect to block in .

As further shown in process may include receiving the cancel alarm message from service control server block . For example PGW and or IWF may receive the cancel alarm message as discussed with respect to block in .

As further shown in process may include causing the trigger message to be sent to client device block . For example PGW and or IWF may cause the trigger message to be sent to client device as discussed with respect to block in .

As further shown in if the trigger message causes client device to not comply with the policy block no process may include sending a reject instruction to PGW and or IWF block . For example service control server may send the reject instruction as discussed with respect to block in .

As further shown in process may include receiving the reject instruction from service control server block . For example PGW and or IWF may receive the reject instruction as discussed with respect to block in .

As further shown in process may include sending a notification to application server and preventing transmission of the trigger message block . For example PGW and or IWF may send the notification as discussed with respect to block in .

As further shown in process may include sending update information to base station MME PGW and or IWF block . For example service control server may send update information as discussed with respect to blocks and in .

As further shown in process may include receiving the update information from service control server block . For example PGW and or IWF may receive the update information as discussed with respect to block in .

As further shown in process may include updating the cached policy data structure based on the update information block . For example PGW and or IWF may update the cached policy data structure as discussed with respect to block in .

Although show example blocks of process in some implementations process may include additional blocks fewer blocks different blocks or differently arranged blocks than those depicted in . Additionally or alternatively two or more of the blocks of process may be performed in parallel.

In example implementation assume IWF stores in cache memory a cached policy data structure as illustrated in . For example the cached policy data structure may include local policy information and client device information. Assume the local policy information indicates a first policy having a policy identifier 1 takes no action when a threshold access limit of three access per minute is exceeded. Further assume the local policy information indicates a second policy having a policy identifier 2 which takes no action when a message includes ESP header. Further assume the client device information does not include any information at this time. In other words assume the cached policy data structure does not indicate a policy for client device .

Also assume IWF stores alarm information indicating an alarm condition that is satisfied when client device accesses operator network more than three times within a minute and or a message for client device includes an ESP header.

As shown in assume that application server sends a trigger message to IWF to be sent to client device . IWF may receive the trigger message and determine that the trigger message triggers an alarm based on violating an alarm condition by including an ESP header. IWF may send an alarm message to service control server . The alarm message may indicate a client device identifier e.g. IMSI1 for client device and indicate that a trigger message with an ESP header is to be sent to client device .

Service control server may receive the alarm message and obtain policy information for client device based on the client device identifier. Assume the policy information indicates that policy 1 and policy 2 are associated with client device . Accordingly service control server may determine that client device is permitted to send and or receive a message with an ESP header based on policy 2 indicating no action should be taken. Service control server may send a cancel alarm message and update information to IWF .

IWF may receive the cancel alarm message and the update information. IWF may cancel the alarm and cause the trigger message to be sent to client device . Furthermore IWF may update the client device information included in the cached policy data structure based on the update information.

As shown in IWF may update the client device information to include an entry for client device having IMSI1. The client device information may associate policy 1 and policy 2 with client device and indicate that a status for client device is that no action should be taken.

As further shown in client device may send another trigger message with an ESP header meant for client device to IWF . IWF may receive the trigger message and determine client device is complying with policy 2 based on the cached policy data structure. Accordingly IWF may cause the trigger message to be sent to client device without consulting service control server .

In this way application server s access to client device via operator network may be controlled based on policies associated with client device .

As indicated above are provided merely as an example. Other examples are possible and may differ from what was described with regard to .

Implementations described herein may determine whether a M2M device complies with policies for the M2M device and control access of the M2M device to an operator network in real time. Furthermore implementations described herein may detect violations of the policies due to a message being sent from a M2M device and or to a M2M device from an application server.

The foregoing disclosure provides illustration and description but is not intended to be exhaustive or to limit the implementations to the precise form disclosed. Modifications and variations are possible in light of the above disclosure or may be acquired from practice of the implementations.

As used herein the term component is intended to be broadly construed as hardware firmware or a combination of hardware and software.

Some implementations are described herein in connection with thresholds. As used herein satisfying a threshold may refer to a value being greater than the threshold more than the threshold higher than the threshold greater than or equal to the threshold less than the threshold fewer than the threshold lower than the threshold less than or equal to the threshold equal to the threshold etc.

To the extent the aforementioned embodiments collect store or employ personal information provided by individuals it should be understood that such information shall be used in accordance with all applicable laws concerning protection of personal information. Additionally the collection storage and use of such information may be subject to consent of the individual to such activity for example through well known opt in or opt out processes as may be appropriate for the situation and type of information. Storage and use of personal information may be in an appropriately secure manner reflective of the type of information for example through various encryption and anonymization techniques for particularly sensitive information.

It will be apparent that systems and or methods described herein may be implemented in different forms of hardware firmware or a combination of hardware and software. The actual specialized control hardware or software code used to implement these systems and or methods is not limiting of the implementations. Thus the operation and behavior of the systems and or methods were described herein without reference to specific software code it being understood that software and hardware can be designed to implement the systems and or methods based on the description herein.

Even though particular combinations of features are recited in the claims and or disclosed in the specification these combinations are not intended to limit the disclosure of possible implementations. In fact many of these features may be combined in ways not specifically recited in the claims and or disclosed in the specification. Although each dependent claim listed below may directly depend on only one claim the disclosure of possible implementations includes each dependent claim in combination with every other claim in the claim set.

No element act or instruction used herein should be construed as critical or essential unless explicitly described as such. Also as used herein the articles a and an are intended to include one or more items and may be used interchangeably with one or more. Furthermore as used herein the term set is intended to include one or more items and may be used interchangeably with one or more. Where only one item is intended the term one or similar language is used. Also as used herein the terms has have having or the like are intended to be open ended terms. Further the phrase based on is intended to mean based at least in part on unless explicitly stated otherwise.

