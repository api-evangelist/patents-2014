---

title: Compact and fast N-factorial single data rate clock and data recovery circuits
abstract: A plurality of line interfaces is configured to receive a spread signal over the plurality of line interface. The spread signal carrying symbols with guaranteed symbol-to-symbol state transitions between consecutive symbols. The spread signal is defined by a plurality of transition signals including a first signal over a first line interface. A clock signal is extracted based on a comparison between a first instance of the first signal and a delayed second instance of the first signal. The delayed second instance of the first signal is sampled based on the clock signal to provide a symbol output. The clock extraction circuit is further adapted to generate the clock signal based on additional comparisons between a first instance of a second signal, within the plurality of transition signals, and a delayed second instance of the second signal, where the first and second signals are concurrent signals received over different line interfaces.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09313058&OS=09313058&RS=09313058
owner: QUALCOMM Incorporated
number: 09313058
owner_city: San Diego
owner_country: US
publication_date: 20140813
---
U.S. Utility patent application Ser. No. 14 252 450 entitled N Factorial Dual Data Rate Clock and Data Recovery filed Apr. 14 2014 which claims priority to

U.S. Provisional Application No. 61 886 567 entitled N Factorial Clock And Data Recovery With Negative Hold Time Sampling filed Oct. 3 2013 

U.S. Utility patent application Ser. No. 14 199 322 entitled Circuit To Recover A Clock Signal From Multiple Wire Data Signals That Changes State Every State Cycle And Is Immune To Data Inter Lane Skew As Well As Data State Transition Glitches filed Mar. 26 2014 which claims priority to

U.S. Provisional Application No. 61 774 247 entitled Circuit To Recover A Clock Signal From Multiple Wire Data Signals That Changes State Every State Cycle And Is Immune To Data Inter Lane Skew As Well As Data State Transition Glitches filed Mar. 7 2013 

U.S. Provisional Application No. 61 774 408 entitled Transcoding Method For Multi Wire Signaling That Embeds Clock Information In Transition Of Signal State filed Mar. 7 2013 and

U.S. Provisional Application No. 61 778 768 entitled Transcoding Method For Multi Wire Signaling That Embeds Clock Information In Transition Of Signal State filed Mar. 13 2013 and

U.S. Utility patent application Ser. No. 14 220 056 entitled Multi Wire Open Drain Link with Data Symbol Transition Based Clocking filed Mar. 19 2014 which claims priority to

U.S. Provisional Application No. 61 803 684 entitled Multi Wire Open Drain Link With Data Symbol Transition Based Clocking filed Mar. 20 2013 and

U.S. Provisional Application No. 61 846 977 entitled Multi Wire Open Drain Link With Data Symbol Transition Based Clocking filed Jul. 16 2013 all of which are assigned to the assignee hereof and hereby expressly incorporated by reference herein.

The present disclosure relates generally to an interface between a host processor and a peripheral device such as a camera or sensor and more particularly to improving clock generation for single data rate data transfer on an N wire communication interface.

Manufacturers of mobile devices such as cellular phones may obtain components of the mobile devices from various sources including different manufacturers. For example an application processor in a cellular phone may be obtained from a first manufacturer while the display for the cellular phone may be obtained from a second manufacturer. The application processor and a display or other device may be interconnected using a standards based or proprietary physical interface. For example a display may provide an interface that conforms to the Display System Interface DSI standard specified by the Mobile Industry Processor Interface Alliance MIPI .

In one example a multi signal data transfer system may employ multi wire differential signaling such as 3 phase or N factorial N low voltage differential signaling LVDS transcoding e.g. the digital to digital data conversion of one encoding type to another may be performed to embed symbol clock information by causing a symbol transition at every symbol cycle instead of sending clock information in separate data lanes differential transmission paths . Embedding clock information by transcoding is an effective way to minimize skew between clock and data signals as well as to eliminate the necessity of a phase locked loop PLL to recover the clock information from the data signals.

Clock and data recovery CDR circuits are decoder circuits that extract data signals as well as a clock signals from multiple data signals. However clock recovery from multiple data signals whose state transitions represent clock events often suffers unintended spike pulses on its recovered clock signal due to inter lane skew of the data signals or glitch signals by intermediate or undeterminable data signal states at data transition times. For instance such clock signal may be susceptible to jitter. Jitter is how early or late a signal transition is with reference to when it should transition. Jitter is undesirable because it causes transmission errors and or limits the transmission speed. The recovered clock signal may be used to extract data symbols encoded within the multiple wires conductors.

Therefore a clock recovery circuit is needed that minimizes analog delays is tolerant to jitter and is scalable in multi signal systems having different numbers of conductors.

A receiver circuit may comprise a plurality of line interfaces a plurality of receivers a clock extraction circuit and a negative hold time logic circuit. The plurality of line interfaces may be configured to receive a spread signal distributed over the plurality of line interfaces the spread signal carrying symbols with guaranteed symbol to symbol state transitions between consecutive symbols the spread signal defined by a plurality of state transition signals including a first signal over a first line interface. The plurality of receivers may be coupled to the line interfaces. In one example the plurality of receivers may be differential receivers and the first signal is a differential signal. In another example the plurality of receivers may be single ended receivers and the first signal is a single ended signal. In various examples the spread signal may be one of a N factorial N encoded signal a three phase encoded signal and or a N phase encoded signal.

The clock extraction circuit may be adapted to obtain a clock signal based on a comparison between a first instance of the first signal and a delayed second instance of the first signal. The negative hold time logic circuit may be adapted to sample the delayed second instance of the first signal based on the clock signal and provide a symbol output.

In one implementation the clock extraction circuit may be further adapted to generate the clock signal based on additional comparisons between a first instance of a received second signal within the plurality of state transition signals and a delayed second instance of the second signal and the first signal and second signal are concurrent signals received over different line interfaces.

In one implementation the negative hold time logic circuit may include a separate negative hold time logic device for each of the plurality of line interfaces each separate negative hold time logic device adapted to concurrently sample a delayed instance of a distinct received signal within the plurality of state transition signals based on the clock signal and provide distinct symbol outputs.

In one example the clock extraction circuit may include a a comparator that compares the first instance of the first signal SI and the delayed instance of the first signal SD and outputs a comparison signal NE b a set reset latch device that receives the comparison signal NE and outputs a filtered version of the comparison signal NEFLT and or c a first analog delay device that delays the filtered version of the comparison signal NEFLT and outputs a delayed filtered version of the comparison signal NEFLTD where the delayed filtered version of the comparison signal NEFLTD serves to reset the set reset latch device.

The negative hold time logic circuit may include a flip flop device that receives the delayed second instance of the first signal SD and outputs a symbol S where the flip flop device is triggered by the filtered version of the comparison signal NEFLT .

Additionally in some implementations the receiver circuit may include a second analog delay device that delays the first instance of the first signal and outputs the delayed second instance of the first signal.

Additionally in other implementations the receiver circuit may include a a latch device that captures the first instance of the first signal and outputs the delayed second instance of the first signal and or b a second analog delay device that delays the comparison signal NE and uses the delayed comparison signal NED to trigger the latch device.

In yet other implementations the receiver circuit may include a a latch device that captures the first instance of the first signal and outputs the delayed second instance of the first signal while either the filtered version of the comparison signal NEFLT or the delayed filtered version of the comparison signal NEFLTD is in a logical high state and or b an OR gate that receives as input the filtered version of the comparison signal NEFLT and the delayed filtered version of the comparison signal NEFLTD and outputs a signal used to trigger the latch device.

Additionally a method operational on a receiver circuit may comprise a receiving a spread signal distributed over the plurality of line interfaces the spread signal carrying symbols with guaranteed symbol to symbol state transitions between consecutive symbols the spread signal defined by a plurality of state transition signals including a first signal over a first line interface b obtaining a clock signal based on a comparison between a first instance of the first signal and a delayed second instance of the first signal and or c sampling the delayed second instance of the first signal based on the clock signal to provide a symbol output. In various examples the first signal may be a differential signal or a single ended signal. In one example the spread signal may be one of a N factorial N encoded signal a three phase encoded signal and or a N phase encoded signal. In some implementations the sampling of the delayed second instance of the first signal maybe done using a negative hold time logic circuit.

In one example the method may further include generating the clock signal based on additional comparisons between a first instance of a received second signal within the plurality of state transition signals and a delayed second instance of the second signal where the first signal and the second signal are concurrent signals received over different line interfaces.

In another example the method may further include concurrently sampling a delayed instance of a plurality of distinct signals within the plurality of state transition signals based on the clock signal and provide distinct symbol outputs.

In some exemplary implementations obtaining a clock signal may include a comparing the first instance of the first signal SI and the delayed instance of the first signal SD to provide a comparison signal NE b latching the comparison signal NE to obtain a filtered version of the comparison signal NEFLT and or c delaying the filtered version of the comparison signal NEFLT to provide a delayed filtered version of the comparison signal NEFLTD where the delayed filtered version of the comparison signal NEFLTD serves to latch the comparison signal NE . In a first example the method may further include delaying the first instance of the first signal to obtain the delayed second instance of the first signal. In a second example the method may further include a capturing the first instance of the first signal to obtain the delayed second instance of the first signal and or b delaying the comparison signal NE and using the delayed comparison signal NED to trigger the latching of the comparison signal NE . In a third example the method may further include capturing the first instance of the first signal to obtain the delayed second instance of the first signal while either the filtered version of the comparison signal NEFLT or the delayed filtered version of the comparison signal NEFLTD is in a logical high state.

Various aspects are now described with reference to the drawings. In the following description for purposes of explanation numerous specific details are set forth in order to provide a thorough understanding of one or more aspects. It may be evident however that such aspect s may be practiced without these specific details.

Certain aspects described herein may be applicable to communications links deployed between electronic devices that are subcomponents of a mobile apparatus such as a telephone a mobile computing device an appliance automobile electronics avionics systems etc. Examples of a mobile apparatus include a cellular phone a smart phone a session initiation protocol SIP phone a laptop a notebook a netbook a smartbook a personal digital assistant PDA a satellite radio a global positioning system GPS device a multimedia device a video device a digital audio player e.g. MP3 player a camera a game console a wearable computing device e.g. a smartwatch a health or fitness tracker etc. an appliance a sensor a vending machine or any other similar functioning device.

Various clock recovery circuits are herein provided that implement jitter tolerance techniques with limited number of analog delays. In one example a receiver circuit is adapted to receive a spread signal distributed over the plurality of line interfaces the spread signal carrying symbols with guaranteed symbol to symbol state transitions between consecutive symbols. The spread signal defined by a plurality of state transition signals including a first signal over a first line interface. In some examples the first signal may be a differential signal or a single ended signal. While the first signal may be received spread over multiple line interfaces it may be combined into a single signal carrying symbols with guaranteed state transitions from symbol to symbol. Due to the guaranteed state transitions the first signal may also be referred to as a state transition signal.

A clock signal may then be extracted or obtained based on a comparison between a first instance of the first signal and a delayed second instance of the first signal. The delayed second instance of the first signal may be sampled based on the clock signal to provide a symbol output. Since the received first signal carries symbols with guaranteed symbol to symbol state transitions between consecutive symbols these transitions are detected and used to generate the clock signal.

According to another feature the clock signal may be further generated based on additional comparisons between a first instance of a received second signal within the plurality of state transition signals and a delayed second instance of the second signal and the first signal and second signal are concurrent signals received over different line interfaces.

One or more of the components illustrated in may implement clock and data recovery according to one or more aspects described herein to recover a clock embedded within differential signal transitions in a multi wire N Wire communication system e.g. N factorial N encoding and N phase encoding . Note that the terms wires conductors connectors and or lines may be interchangeably used to refer to the electrical paths through which differential signals may be transmitted.

The communication link may provide multiple channels and . One or more channels may be bidirectional and may operate in half duplex and or full duplex modes. One or more channels and may be unidirectional. The communication link may be asymmetrical providing higher bandwidth in one direction. In one example described herein a first communications channel may be referred to as a forward link while a second communications channel may be referred to as a reverse link . The first IC device may be designated as a host system or transmitter while the second IC device may be designated as a client system or receiver even if both IC devices and are configured to transmit and receive on the communications link . In one example the forward link may operate at a higher data rate when communicating data from a first IC device to a second IC device while the reverse link may operate at a lower data rate when communicating data from the second IC device to the first IC device .

The IC devices and may each have a processor or other processing and or computing circuit or device . In one example the first IC device may perform core functions of the apparatus including maintaining wireless communications through a wireless transceiver and an antenna while the second IC device may support a user interface that manages or operates a display controller . In the example the second IC device may be adapted to control operations of a camera or video input device using a camera controller . Other features supported by one or more of the IC devices and may include a keyboard a voice recognition component and other input or output devices. The display controller may include circuits and software drivers that support displays such as a liquid crystal display LCD panel touch screen display indicators and so on. The storage media and may include transitory and or non transitory storage devices adapted to maintain instructions and data used by respective processors and and or other components of the IC devices and . Communication between each processor and its corresponding storage media and and other modules and circuits may be facilitated by one or more bus and respectively.

The reverse link may be operated in the same manner as the forward link and the forward link and reverse link may be capable of transmitting at comparable speeds or at different speeds where speed may be expressed as data transfer rate and or clocking rates. The forward and reverse data rates may be substantially the same or differ by orders of magnitude depending on the application. In some applications a single bidirectional link may support communications between the first IC device and the second IC device . The forward link and or reverse link may be configurable to operate in a bidirectional mode when for example the forward and reverse links and share the same physical connections and operate in a half duplex manner. In one example the communication link may be operated to communicate control command and other information between the first IC device and the second IC device in accordance with an industry or other standard.

In one example forward and reverse links and may be configured or adapted to support a wide video graphics array WVGA 80 frames per second LCD driver IC without a frame buffer delivering pixel data at 810 Mbps for display refresh. In another example forward and reverse links and may be configured or adapted to enable communications between with dynamic random access memory DRAM such as double data rate synchronous dynamic random access memory SDRAM . Encoding devices and or can encode multiple bits per clock transition and multiple sets of wires can be used to transmit and receive data from the SDRAM control signals address signals and so on.

The forward and reverse links and may comply with or be compatible with application specific industry standards. In one example the MIPI standard defines physical layer interfaces between an application processor IC device and an IC device that supports the camera or display in a mobile device. The MIPI standard includes specifications that govern the operational characteristics of products that comply with MIPI specifications for mobile devices. The MIPI standard may define interfaces that employ complementary metal oxide semiconductor CMOS parallel busses.

The communication link of may be implemented as a wired bus that includes a plurality of signal wires denoted as N wires . The N wires may be configured to carry data encoded in symbols where clock information is embedded in a sequence of the symbols transmitted over the plurality of wires. Examples of encoding techniques used with N wire interfaces include N factorial N encoding and N phase encoding.

The IC devices and or and or components therein illustrated in may implement clock and data recovery according to one or more aspects described herein to recover a clock embedded within differential signal transitions in a multi wire N Wire communication system e.g. N factorial N encoding and N phase encoding .

A clock signal is embedded within this 3 wire differential signaling by guaranteeing that there is a symbol change every cycle. A clock data recovery circuit that extracts a clock signal from the differential signal must also minimize jitter. This clock signal may be used to synchronize decoding of the symbols in the 3 wire differential signal. While certain logic circuits may serve to minimize jitter these require a relatively large number of logic devices which is a problem when scaling up to n wire differential signaling.

In one example differential signal encoding may be used to transmit signals from the transmitter device the receiver device . Consequently each of a plurality of receivers may be configured to take two of the three lines A B and C and provide a different signal. For instance a first line A and a second line B may serve to provide a first differential signal RX AB the second line B and a third line C may serve to provide a second differential signal RX BC and the first line A and the third line C may serve to provide a third differential signal RX CA . These differential signals and may serve as inputs to a decoder circuit . The decoder circuit decodes the three differential signals RX AB RX BC and RX CA and outputs the six states XM YM ZM ZP YP and XP. In one example each of the six states XM YM ZM ZP YP and XP may represent a symbol and the encoding used guarantees a symbol to symbol state transition for transmitted signals. The combination of differential signals RX AB RX BC and RX CA may be referred to a spread signal where the spread signal carries the symbols. Due to their guaranteed state transitions each of the differential signals RX AB RX BC and RX CA may be referred to as a state transition signal.

In this example the receivers are illustrated as differential receivers which take as inputs two signals from two different wires e.g. AB BC AC and output a differential signal i.e. the output signal being the difference between the two input signals . In one example the voltage difference between two wires conductors may define a differential signal. In another example the current flow direction in each wire conductor may also be used alone or in combination with voltage define a differential signal.

A state diagram illustrates the six 6 states XM YM ZM ZP YP and XP that may be defined by the differential signals and carried by the three conductors A B and C . As can be observed the voltage levels across the three differential signals and may be mapped to different combinations of ones 1 and zeros 0 . For instance the differential signal voltage levels for state XM may be associated with 011 state YM may be associated with 101 state ZP may be associated with 001 state ZM may be associated with 110 state YP may associated with 010 and state XP may be associated with 100 .

In addition to the information encoded in the states e.g. 3 bits per state information may also be encoded based on transitions between the states. Note that transition between any two states XM YM ZM ZP YP and XP occurs in a single step without traversing intermediate states. As such differential data transmission schemes based on the state diagram would be free of state transition decoding problems.

Each of the conductors of the bus may be driven High driven Low or undriven with only one conductor being undriven in any single cycle. In one embodiment three differential signals RX AB RX BC and RX CA e.g. received by a decoder within receiver device are defined as positive differential voltage to logic 1 and negative differential voltage to logic 0 between conductor A relative to conductor B conductor B relative to conductor C and conductor C relative to conductor A respectively. Example waveforms of the three differential signals and are illustrated in the diagram .

Six possible states excluding the states that cause a zero differential voltage between conductor A relative to conductor B conductor B relative to conductor C and conductor C relative to conductor A are defined as XM YM ZP ZM YP XP and XM by states of the signals RX AB RX BC and RX CA according to state diagram .

State signals corresponding to the six possible states XM YM ZP ZM YP XP and XM are generated from the differential signals RX AB RX BC and RX CA by a decoder block DEC in the receiver device and exemplary waveforms of the state signals are shown in the diagram .

In one embodiment a state transition from a state XM YM ZP ZM YP XP or XM to a different state always occurs at any single cycle in a way that a state transition represents data to be transmitted from the transmitter device to the receiver device .

In an alternative embodiment single ended signaling may be used over the conductors wires A B C of the multi line bus . In one example of single ended signaling one conductor wire may carry a varying voltage that represents the signal while another conductor wire may be connected to a reference voltage e.g. ground . In the case of such single ended signaling the transmitter device may include a plurality of single ended open drain transistor drivers each driver coupled to a single wire conductor A B C of the multi line bus . The receiver device may include one or more single ended receivers e.g. complementary metal oxide semiconductor CMOS transistors where each single ended receiver is coupled to a single wire conductor A B C of the multi line bus . The transmitter device may receive input bits encodes them into single ended signals and transmits the single ended signals to the receiver device through single ended drivers via each wire conductor A B C of the multi line bus . The receiver device receives the single ended signals via each wire conductor A B C of the multi line bus through the single ended receivers decodes the single ended signals and provides output bits. In this single ended system the decoder may include a clock and data recovery CDR such that a clock signal is extracted from one or more received single ended signals.

A termination impedance typically resistive couples each of the N wires to a common center point in a termination network . It will be appreciated that the signaling state of the N wires reflects a combination of the currents in the termination network attributed to the differential drivers coupled to each wire. It will be further appreciated that the center point is a null point whereby the currents in the termination network cancel each other at the center point.

The N encoding scheme need not use a separate clock channel and or non return to zero decoding because at least one of the Csignals in the link transitions between consecutive symbols. Effectively each transcoder ensures that a transition occurs between each pair of symbols transmitted on the N wires by producing a sequence of symbols in which each symbol is different from its immediate predecessor symbol. In the example depicted in four wires are provided N 4 and the 4 wires can carry C 6 differential signals. The transcoder may employ a mapping scheme to generate raw symbols for transmission on the N wires . The transcoder may map data bits to a set of transition numbers. The transition numbers may be used to select raw symbols for transmission based on the value of the immediately preceding symbol such that the selected raw symbol is different from the preceding raw symbol. The raw symbols may be serialized by the serializer to obtain a sequence of symbols for transmission over the N wires . In one example a transition number may be used to lookup a data value corresponding to the second of the consecutive raw symbols with reference to the first of the consecutive raw symbols. At the receiver a transcoder may employ a mapping to determine a transition number that characterizes a difference between a pair of consecutive raw symbols in a lookup table for example. The transcoders operate on the basis that every consecutive pair of raw symbols includes two different symbols.

The transcoder at the transmitter may select between N 1 available signaling states at every symbol transition. In one example a system provides 4 1 23 signaling states for the next symbol to be transmitted at each symbol transition. The bit rate may be calculated as log available states per transmit clock cycle.

According to certain aspects disclosed herein double data rate DDR signaling may be employed to increase the interface bandwidth by transmitting two symbols in each period of the transmit clock . Symbol transitions occur at both the rising edge and falling edge of the transmit clock in a system using double data rate DDR clocking. The total available states in the transmit clock cycle is N 1 23 529 and the number of data bits that can transmitted over two symbol may be calculated as log 529 9.047 bits.

A receiving device receives the sequence of symbols using a set of line receivers where each receiver in the set of line receivers determines differences in signaling states on one pair of the N wires . Accordingly Creceivers are used where N represents the number of wires. The Creceivers produce a corresponding number of raw symbols as outputs. In the depicted 4 wire example the signals received on the 4 wires are processed by 6 receivers C 6 to produce a raw symbol signal that is provided to a CDR and deserializer . The raw symbol signal is representative of the signaling state of the N wires and the CDR may process the raw symbol signal to generate a receive clock signal that can be used by the deserializer .

The receive clock signal may be a DDR clock signal that can be used by external circuitry to process received data provided by the transcoder . The transcoder decodes a block of received symbols from the deserializer by comparing each symbol to its immediate predecessor. The transcoder produces output data corresponding to the data provided to the transmitter .

It should be noted that the system illustrated in may also be implemented using single ended signaling and single ended drivers receivers between the transmitter device and the receiver device in place of differential signaling and differential drivers and differential receivers . When single ended signaling and single ended drivers receivers are used between the transmitter device and the receiver device the termination network illustrated in can be excluded.

When N phase polarity encoding is used conductors such as signal wires and on an M wire bus may be undriven driven positive or driven negative. An undriven signal wire or may be in a high impedance state. An undriven signal wire or may be at least partially pulled or driven towards a voltage level that lies substantially halfway between the positive and negative voltage levels provided on driven signal wires. An undriven signal wire or may have no current flowing through it. In the example illustrated in a set of drivers may control the state of each signal wire and for each symbol transmission interval such that each signal wire and may be in one of three states denoted as 1 1 and 0 for a transmitted symbol. In one example drivers may include unit level current mode drivers. In another example drivers may drive opposite polarity voltages on two signals and while the third signal is at high impedance and or pulled to ground. For each symbol transmission interval at least one signal is in the undriven 0 state while the number of signals driven positive 1 state is equal to the number of signals driven negative 1 state such that the sum of current flowing to the receiver is always zero. For each pair of consecutive symbol transmission intervals at least one signal wire or has a different state in the two symbol transmission intervals.

In the example depicted in 16 bit data is input to a mapper which maps the input data to symbols for transmitting sequentially over the signal wires and . The 7 symbols may be serialized using parallel to serial converters for example. A 3 wire 3 phase encoder receives 7 symbols produced by the mapper one symbol at a time and computes the state of each signal wire and for each symbol interval. The encoder selects the states of the signal wires and based on the input symbol and the previous states of signal wires and

The use of M wire N phase encoding permits a number of bits to be encoded in a plurality of symbols where the bits per symbol is not an integer. In the simple example of a 3 wire system there are 3 available combinations of 2 wires that may be driven simultaneously and 2 possible combinations of polarity on the pair of simultaneously driven wires yielding 6 possible states. Since each transition occurs from a current state 5 of the 6 states are available at every transition. The state of at least one wire is required to change at each transition. With 5 states log 5 2.32 bits may be encoded per symbol. Accordingly a mapper may accept a 16 bit word and convert it to 7 symbols because 7 symbols carrying 2.32 bits per symbol can encode 16.24 bits. In other words a combination of seven symbols that encodes five states has 5 78 125 permutations. Accordingly the 7 symbols may be used to encode the 2 65 536 permutations of 16 bits.

At any phase state in the illustrated three wire example exactly two of the conductors carry a signal which is effectively a differential signal for that phase state while the third conductor or is undriven. The phase state for each conductor may be determined by voltage difference between the conductor or and at least one other conductor and or or by the direction of current flow or lack of current flow in the conductor or . As shown in the state transition diagram three phase states S Sand S are defined. A signal may flow clockwise from phase state Sto phase state S phase state Sto phase state S and or phase state Sto phase state Sand the signal may flow counter clockwise from phase state Sto phase state S phase state Sto phase state S and or phase state Sto phase state S. For other values of N transitions between the N states may optionally be defined according to a corresponding state diagram to obtain circular rotation between state transitions.

In the example of a three wire three phase communications link clockwise rotations Sto S Sto S and or Sto S at a state transition may be used to encode a logic 1 while counter clockwise rotations Sto S Sto S and or Sto S at the state transition may be used to encode a logic 0. Accordingly a bit may be encoded at each transition by controlling whether the signal is rotating clockwise or counter clockwise. For example a logic 1 may be encoded when the three wires transition from phase state Sto phase state Sand a logic 0 may be encoded when the three wires transition from phase state Sto phase state S. In the simple three wire example depicted direction of rotation may be easily determined based on which of the three wires is undriven before and after the transition.

Information may also be encoded in the polarity of the driven conductors or direction of current flow between two conductors . Signals and illustrate voltage levels applied to conductors respectively at each phase state in a three wire three phase link. At any time a first conductor is coupled to a positive voltage V for example a second conductor is coupled to a negative voltage V for example while the third conductor may be open circuited or otherwise undriven. As such one polarity encoding state may be determined by the current flow between the first and second conductors or the voltage polarities of the first and second conductors . In some embodiments two bits of data may be encoded at each phase transition. A decoder may determine the direction of signal phase rotation to obtain the first bit and the second bit may be determined based on the polarity difference between two of the signals and . The decoder having determined direction of rotation can determine the current phase state and the polarity of the voltage applied between the two active conductors and or or the direction of current flow through the two active conductors and or

In the example of the three wire three phase link described herein one bit of data may be encoded in the rotation or phase change in the three wire three phase link and an additional bit may be encoded in the polarity of two driven wires. Certain embodiments encode more than two bits in each transition of a three wire three phase encoding system by allowing transition to any of the possible states from a current state. Given three rotational phases and two polarities for each phase 6 states are defined such that 5 states are available from any current state. Accordingly there may be log 5 2.32 bits per symbol transition and the mapper may accept a 16 bit word and convert it to 7 symbols.

Table 1 illustrates the operation of the differential receivers . In this example the wire states may be encoded in the voltage amplitude on the three wires and such that the 1 state of a wire is represented as a voltage V volts the 1 state of the wire is represented as 0 volts and the undriven state is represented or approximated as V 2 volts. In particular Table 1 illustrates the outputs of the differential receivers for each wire in the 3 wire 3 Phase Polarity encoding system. A receiver decoder may be configured to output a code at the digital output of the receiver for each symbol decoded.

Certain N wire interfaces may be adapted to provide increased bandwidth through the use of DDR clocking whereby a new symbol is transmitted at both the rising and falling edges of a transmit clock. However conventional CDR circuits may be unable to respond to DDR clocking and or conventional CDR circuits may limit the maximum possible operation speed of an N wire or N phase interface.

A receiver circuit may include a four wire termination network a plurality of receivers Rcvrs and a clock and data recovery circuit . In one example a clock is embedded in symbol transitions within a spread signal distributed across four wires or conductors . The CDR circuit may be configured to extract a clock and data symbols from the spread signal received over the four wires or conductors . The spread signal may be defined by a plurality of transition signals including a first signal over a first line interface conductor or wire. The CDR circuit may include a comparator a set reset latch a first analog delay device S and a second analog delay device T . A clock extraction circuit may be defined by the comparator a set reset latch and a first analog delay device S . The clock extraction circuit may be adapted to extract a signal that may be used to obtain a clock signal from state transition in the received first signal. Since the spread signal carries symbols with guaranteed symbol to symbol state transitions between consecutive symbols these transitions are detected and used to generate the clock signal. The clock signal may be obtained using jitter compensation and serves to sample symbols from the spread signal distributed over the plurality of receivers .

The comparator may compare a first instance of the first signal SI and a delayed second instance of the first signal SD i.e. delayed by the second analog delay device T and the comparator outputs a comparison signal NE signal . The set reset latch may receive the NE signal from the comparator and provides a filtered version of the comparison signal NEFLT signal . The first analog delay device S receives the NEFLT signal and outputs a delayed instance of the NEFLT signal as the NEFLTD signal . The NEFLTD signal serves as the reset input to the set reset latch such that the output of the set reset latch is reset after a delay S. In one example the NEFLT signal may be used as the clock signal to sample symbols.

The second analog delay device may receive the first instance of the first signal SI and provides a delayed second instance of the first signal SD to the comparator . In one example the spread signal distributed across the plurality of wires or conductors and may include or is defined a plurality of distinct state transition signals which when combined carry symbols with guaranteed symbol to symbol state transitions between consecutive symbols. For example for the case of three conductors using differential signaling in spread signal may be defined by the combination of the differential signals RX AB RX BC or RX CA . The first signal may be one of the differential signals RX AB RX BC or RX CA . The first instance of the first signal SI may comprise for example all or a portion segment of any one of the differential signals RX AB RX BC or RX CA .

A flip flop device may also receive the delayed second instance of the first signal SD and outputs a symbol S triggered by the NEFLT signal . That is the flip flop device is triggered by a rising edge on the NEFLT signal . Consequently the second analog delay device serves to generate the NE signal . In turn the NE signal serves to generate the NEFLT signal which serves as a latching clock for the flip flop device .

In operation when a transition occurs between a current symbol S and a next symbol S the state of the SI signal begins to change. The NE signal transitions high when the comparator first detects a difference between the SI signal and the SD signal causing the set reset latch to be asynchronously set. Accordingly the NEFLT signal transitions high and this high state is maintained until the set reset latch is reset when the NEFLTD signal becomes high. The NEFLT signal transitions to a high state in response to the rising edge of the NE signal and the NEFLT signal transitions to a low state in response to the rising edge of the NEFLTD signal after a delay attributable to the first analog delay device S .

As transitions between symbols and occur one or more intermediate or indeterminate states may occur on the SI signal due to inter wire skew signal overshoot signal undershoot crosstalk and so on. The intermediate states on SI may be regarded as invalid data and these intermediate states may cause spikes and in the NE signal as the output of the comparator returns towards a low state for short periods of time. The spikes and do not affect the NEFLT signal output by the set reset latch . The set reset latch effectively blocks and or filters out the spikes and on the NE signal from the NEFLT signal .

The flip flop device may have a negative hold time ht as the input symbols and in the SI signal can change prior to the symbol being latched or captured by the flip flop device . For instance each symbol and in the SD signal is set or captured by the flip flop device at the rising clock edge of the NEFLT signal which occurs after the input symbols and have changed in the SI signal .

Various elements illustrated in the CDR circuit may be implemented by various subcircuits. For example the set reset latch may be implemented as a first logic circuit the analog delay S device may be implemented as a series of inverters and the comparator may be implemented as a second logic circuit .

The first logic circuit may include an inverter an OR gate a first NAND gate and a second NAND gate .

The second logic circuit may include a plurality of XNOR gates whose outputs all serve as inputs to a NAND gate . The output of the NAND gate may serve as the NE signal . Each input signal SI x into each of the XNOR gates may correspond to a distinct state transition signal carrying part of the spread signal. For example in the case of differential signaling of the first signal SI may be the first differential signal RX AB a second signal SI may be the second differential signal RX BC and a third signal SI may be the third differential signal RX CA .

While the CDR circuit is tolerant to jitter it is achieved using only Canalog delays and 2 Cinput comparators without the need for 2 Cflip flops where Cis the number of available combinations of wire pairs . For example in U.S. Pat. No. 8 064 535 illustrates a clock and data recovery circuit using 2 Cflip flops i.e. twelve flip flops for a combination of six wire pairs and C 1 analog delays i.e. seven analog delays for a combination of six wire pairs . Both flip flops and analog delays are expensive resources to include in a CDR circuit so minimizing their use is desirable. By comparison in the CDR circuit may be implemented using C 1 analog delays and i.e. seven analog delays for a combination of six wire pairs and CXNOR gates i.e. six comparator gates for a combination of six wire pairs .

A receiver circuit may include a four wire termination network a plurality of receivers and a clock data recovery circuit . In one example a clock is embedded in symbol transitions within a spread signal distributed across four wires or conductors .

The CDR circuit may be configured to extract a clock and data symbols from the spread signal received over the four wires or conductors . The spread signal may be defined by a plurality of transition signals including a first signal over a first line interface conductor or wire. The CDR circuit may include a comparator a set reset latch a first analog delay device S a second analog delay device T and a level latch . A clock extraction circuit may be defined by the comparator a set reset latch and a first analog delay device S . The clock extraction circuit may be adapted to extract a signal that may be used to obtain a clock signal from state transitions within the received first signal. Since the received spread signal carries symbols with guaranteed symbol to symbol state transitions between consecutive symbols these transitions are detected and used to generate the clock signal. The clock signal may be obtained using jitter compensation and serves to sample symbols from the spread signal distributed over the plurality of receivers .

The comparator may compare a first instance of the first signal SI and a delayed second instance of the first signal SD and the comparator outputs a comparison signal NE signal . The set reset latch may receive the NE signal from the comparator and provides a filtered version of the comparison signal NEFLT signal . The first analog delay device S receives the NEFLT signal and outputs a delayed instance of the NEFLT signal as the NEFLTD signal . The NEFLTD signal serves as the reset input to the set reset latch such that the output of the set reset latch is reset after a delay S. In one example the NEFLT signal may be used as the clock signal to sample symbols.

Various elements illustrated in the CDR circuit may be implemented by various subcircuits. For example the set reset latch may be implemented as a first logic circuit the analog delay S device may be implemented as a series of inverters and the comparator may be implemented as a second logic circuit .

In one example the spread signal distributed across the wires or conductors may include a plurality of distinct transition signals which when combined carry symbols with guaranteed symbol to symbol state transitions between consecutive symbols. For example for the case of three conductors using differential signaling in spread signal may be defined by the combination of the differential signals RX AB RX BC or RX CA . The first signal may be one of the differential signals RX AB RX BC or RX CA . The first instance of the first signal SI may comprise for example all or a portion segment of any one of the differential signals RX AB RX BC or RX CA .

A level latch receives the first instance of the first signal SI and provides the delayed second instance of the first signal SD to the comparator . The level latch is triggered by a delayed instance of the NE signal . A flip flop device may also receive the delayed second instance of the first signal SD and outputs a symbol S triggered by the NEFLT signal . That is the flip flop device is triggered by a rising edge on the NEFLT signal . Consequently the level latch and second analog delay device serve to generate the NE signal . In turn the NE signal serves to generate the NEFLT signal which serves as a latching clock for the flip flop device .

In operation when a transition occurs between a current symbol S and a next symbol S the state of the SI signal begins to change. The NE signal transitions high when the comparator first detects a difference between the SI signal and the SD signal causing the set reset latch to be asynchronously set. Accordingly the NEFLT signal transitions high and this high state is maintained until the set reset latch is reset when the NEFLTD signal becomes high. The NEFLT signal transitions to a high state in response to the rising edge of the NE signal and the NEFLT signal transitions to a low state in response to the rising edge of the NEFLTD signal after a delay attributable to the first analog delay device S .

As transitions between symbols and occur one or more intermediate or indeterminate states may occur on the SI signal due to inter wire skew signal overshoot signal undershoot crosstalk and so on. The intermediate states on the SI signal may be regarded as invalid data and these intermediate states may cause spikes and in the NE signal as the output of the comparator returns towards a low state for short periods of time. The spikes and do not affect the NEFLT signal output by the set reset latch . The set reset latch effectively blocks and or filters out the spikes and on the NE signal from the NEFLT signal .

The flip flop device may have a negative hold time ht as the input symbols and in the SI signal can change prior to the symbol being latched or captured by the flip flop device . For instance each symbol and in the SD signal is set or captured by the flip flop device at the rising clock edge of the NEFLT signal which occurs after the input symbols and have changed in the SI signal .

In comparison to the first CDR circuit in the second CDR circuit in provides a wider and or more stable symbols within the SD signal . In particular by triggering the level latch using a delayed version of the NE signal signal NED a stable version of the delayed second instance of the first signal SD signal can be latched in more quickly resulting in a stable wider symbol. For example in a symbol S1 may have a width A in the SD signal while in the corresponding symbol S1 may have a width B in the SD signal where width B width A. Since the stable symbol portion of the SD signal is wider in this approach this provides a wider sampling margin so a faster transmission link may be possible relative to the approach in .

Relative to the CDR circuit in FIG. 13 of U.S. Pat. No. 8 064 535 which uses 2 Cflip flops and C 1 analog delays the CDR circuit of is implemented using only two analog delays and Clevel latches and CXNOR gates . Generally the level latches are less costly in terms of resources to implement than analog delays. Also a level latch is less expensive than a flip flop in terms of resources as a flip flop takes two level latches to implement.

A receiver circuit may include a four wire termination network a plurality of receivers and a clock data recovery circuit . In one example a clock is embedded in symbol transitions within a spread signal received across four wires or conductors . The spread signal may be defined by a plurality of transition signals including a first signal over a first line interface conductor or wire. The CDR circuit may be configured to extract a clock and data symbols from the spread signal received over the four wires or conductors . The CDR circuit may include a comparator a set reset latch a first analog delay device S and a level latch . A clock extraction circuit may be defined by the comparator a set reset latch and a first analog delay device S . The clock extraction circuit may be adapted to extract a signal that may be used to obtain a clock signal from signals. The clock signal may be obtained using jitter compensation and serves to sample symbols from state transition in the spread signal received over the plurality of receivers .

The comparator may compare a first instance of the first signal SI and a delayed second instance of the first signal SD and the comparator outputs a comparison signal NE signal . The set reset latch may receive the NE signal from the comparator and provides a filtered version of the comparison signal NEFLT signal . The first analog delay device S receives the NEFLT signal and outputs a delayed instance of the NEFLT signal as the NEFLTD signal . The NEFLTD signal serves as the reset input to the set reset latch such that the output of the set reset latch is reset after a delay S. In one example the NEFLT signal may be used as the clock signal to sample symbols.

Various elements illustrated in the CDR circuit may be implemented by various subcircuits. For example the set reset latch may be implemented as a first logic circuit the analog delay S device may be implemented as a series of inverters and the comparator may be implemented as a second logic circuit .

In one example the spread signal distributed across the wires or conductors may include a plurality of distinct transition signals which when combined carry symbols with guaranteed symbol to symbol state transitions between consecutive symbols. For example for the case of three conductors using differential signaling in spread signal may be defined by the combination of the differential signals RX AB RX BC or RX CA . The first signal may be one of the differential signals RX AB RX BC or RX CA . The first instance of the first signal SI may comprise for example all or a portion segment of any one of the differential signals RX AB RX BC or RX CA .

A level latch receives the first instance of the first signal SI and provides the delayed second instance of the first signal SD . The level latch is triggered by the resulting output NEFLT COMP of an OR gate which has the NEFLT and NEFLTD signal as inputs.

A level latch receives the first instance of the first signal SI and provides the delayed second instance of the first signal SD to the comparator . The level latch is triggered by a delayed instance of the NE signal . A flip flop device may also receive the delayed second instance of the first signal SD and outputs a symbol S triggered by the NEFLT signal . That is the flip flop device is triggered by a rising edge on the NEFLT signal . Consequently the level latch serves to generate the NE signal . In turn the NE signal serves to generate the NEFLT signal which serves as a latching clock for the flip flop device .

In operation when a transition occurs between a current symbol S and a next symbol S the state of the SI signal begins to change. The NE signal transitions high when the comparator first detects a difference between the SI signal and the SD signal causing the set reset latch to be asynchronously set. Accordingly the NEFLT signal transitions high and this high state is maintained until the set reset latch is reset when the NEFLTD signal becomes high. The NEFLT signal transitions to a high state in response to the rising edge of the NE signal and the NEFLT signal transitions to a low state in response to the rising edge of the NEFLTD signal after a delay attributable to the first analog delay device S .

As transitions between symbols and occur one or more intermediate or indeterminate states may occur on the SI signal due to inter wire skew signal overshoot signal undershoot crosstalk and so on. The intermediate states on the SI signal may be regarded as invalid data and these intermediate states may cause spikes and in the NE signal as the output of the comparator returns towards a low state for short periods of time. The spikes and do not affect the NEFLT signal output by the set reset latch . The set reset latch effectively blocks and or filters out the spikes and on the NE signal from the NEFLT signal .

The flip flop device may have a negative hold time ht as the input symbols and in the SI signal can change prior to the symbol being latched or captured by the flip flop device . For instance each symbol and in the SD signal is set or captured by the flip flop device at the rising clock edge of the NEFLT signal which occurs after the input symbols and have changed in the SI signal .

In comparison to the first CDR circuit in and the second CDR circuit in this third CDR circuit is implemented without the second analog delay device T while still providing wider or more stable symbols within the SD signal in relation to the approaches in and . The CDR circuit of is a way to achieve minimum delay while guaranteeing to sample valid data in order to output symbol S . Note that the CDR circuit of has no way to make the delay T i.e. second analog delay device T as small as the delay i.e. the delay caused by the OR gate in since delay T in must have a safety margin to account for delay variations due to variations in manufacturing processes electrical path lengths temperature etc.

In particular by triggering the level latch using a delayed version of the NE signal signal NEFLT COMP a stable version of the delayed second instance of the first signal SD signal can be latched in more quickly resulting in a stable wider symbol. For example in a symbol S1 may have a width A in the SD signal while in the corresponding symbol S1 may have a width B in the SD signal where width B width A. Since the stable symbol portion of the SD signal is wider in this approach this provides a wider sampling margin so a faster transmission link may be possible relative to the approach in .

Relative to the CDR circuit in FIG. 13 of U.S. Pat. No. 8 064 535 which uses 2 Cflip flops and C 1 analog delays the CDR circuit of is implemented using only one analog delay Clevel latches and CXNOR gates . Generally the level latches are less costly in terms of resources to implement than analog delays.

A receiver circuit may include a four wire termination network a plurality of receivers and a clock and data recovery circuit . In one example the receivers may be differential receivers e.g. whose output is the difference between two input signals . In another example the receivers may be single ended receivers e.g. whose output is its input signal relative to a reference such as ground . When single ended receivers are used the termination network may be excluded.

In one example a clock is embedded in symbol transitions across four wires or conductors . The CDR circuit may be configured to extract a clock and data symbols from signals received over the four wires or conductors .

A plurality of line interfaces e.g. defined by the plurality of receivers may be configured to receive a spread signal distributed over the plurality of line interfaces the spread signal carrying symbols with guaranteed symbol to symbol state transitions between consecutive symbols. The spread signal may be defined by a plurality of transition signals including a first signal over a first line interface. In one example the first signal may be a differential signal or a single ended signal. The spread signal may be one of a N factorial N encoded signal a three phase encoded signal and or a N phase encoded signal.

The CDR circuit may include a clock extraction circuit a delay circuit and a negative hold time logic circuit . The clock extraction circuit may be adapted to obtain a clock signal from state transitions within the spread signal. The clock signal may be obtained using jitter compensation and serves to sample symbols from the received spread signal distributed over the plurality of receivers . For example the clock signal may be based on a comparison between a first instance of a first signal SI a and a delayed second instance of the first signal SD a . Since the spread signal carries symbols with guaranteed symbol to symbol state transitions between consecutive symbols these transitions are detected and used to generate the clock signal. Note that the delayed second instance of the first signal SD a may be obtained by a delay circuit e.g. delay device T in the second analog delay device T and the level latch in and or the OR gate and the level latch in .

Various examples of the clock extraction circuit are found in and where the NEFLT signal and or may serve as a clock signal.

The clock extraction circuit may be adapted to generate a clock signal based on a comparison between a first instance of a first signal SI a and a delayed second instance of the first signal SD a . For instance an NEFLT signal and or is generated in and may serve as a sampling clock signal for symbol extraction.

In one example the spread signal is distributed across the wires or conductors and may include a plurality of distinct transition signals which when combined carry symbols with guaranteed symbol to symbol state transitions between consecutive symbols. For example for the case of three conductors using differential signaling in the first signal may be defined by the combination of the differential signals RX AB RX BC and RX CA . The first instance of the first signal SI may comprise for example any one of the differential signals RX AB RX BC or RX CA .

In one implementation the clock extraction circuit may be further adapted to generate the clock signal based on additional comparisons between a first instance of a second signal SI b within the plurality of state transition signals and a delayed second instance of the second signal SD b and the first signal SI a and second signal SI b may be concurrent signals received over different line interfaces plurality of receivers .

A negative hold time logic circuit may be adapted to sample the delayed second instance of the first signal SD a based on the clock signal and provide a symbol output S a . In one implementation the negative hold time logic circuit includes a separate negative hold time logic device for each of the plurality of line interfaces each separate negative hold time logic device may be adapted to concurrently sample a delayed instance of a distinct signal SD a SD b SD c . . . SD n based on the clock trigger signal and provide distinct symbol outputs S a S b S c . . . S n .

A clock signal may be obtained based on a comparison between a first instance of the first signal and a delayed second instance of the first signal . The delayed second instance of the first signal may be sampled based on the clock signal to provide a symbol output . The sampling of the delayed second instance of the first signal may be done using a negative hold time logic circuit.

The clock signal may be generated based on additional comparisons between a first instance of a second signal within the plurality of state transition signals and a delayed second instance of the second signal and the first signal and second signal may be concurrent signals received over different line interfaces. A delayed instance of a plurality of distinct received signals may be concurrently sampled based on the clock signal and to provide distinct symbol outputs.

In one example obtaining a clock signal may include a comparing the first instance of the first signal SI and the delayed instance of the first signal SD to provide a comparison signal NE b latching the comparison signal NE to obtain a filtered version of the comparison signal NEFLT and or c delaying the filtered version of the comparison signal NEFLT to provide a delayed filtered version of the comparison signal NEFLTD where the delayed filtered version of the comparison signal NEFLTD serves to latch the comparison signal NE .

According to a first aspect illustrated in the method may further include delaying the first instance of the first signal to obtain the delayed second instance of the first signal.

According to a second aspect illustrated in the method may further include a capturing the first instance of the first signal to obtain the delayed second instance of the first signal and or b delaying the comparison signal NE and using the delayed comparison signal NED to trigger the latching of the comparison signal NE .

According to a third aspect illustrated in the method may further include capturing the first instance of the first signal to obtain the delayed second instance of the first signal while either the filtered version of the comparison signal NEFLT or the delayed filtered version of the comparison signal NEFLTD is in a logical high state.

It is understood that the specific order or hierarchy of steps in the processes disclosed is an illustration of exemplary approaches. Based upon design preferences it is understood that the specific order or hierarchy of steps in the processes may be rearranged. The accompanying method claims present elements of the various steps in a sample order and are not meant to be limited to the specific order or hierarchy presented.

While the above discussed aspects arrangements and embodiments are discussed with specific details and particularity one or more of the components steps features and or functions illustrated in and or may be rearranged and or combined into a single component step feature or function or embodied in several components steps or functions. Additional elements components steps and or functions may also be added or not utilized without departing from the present disclosure. The apparatus devices and or components illustrated in and or may be configured to perform or employ one or more of the methods features parameters and or steps described in and or . The novel algorithms described herein may also be efficiently implemented in software and or embedded in hardware.

Also it is noted that at least some implementations have been described as a process that is depicted as a flowchart a flow diagram a structure diagram or a block diagram. Although a flowchart may describe the operations as a sequential process many of the operations can be performed in parallel or concurrently. In addition the order of the operations may be re arranged. A process is terminated when its operations are completed. A process may correspond to a method a function a procedure a subroutine a subprogram etc. When a process corresponds to a function its termination corresponds to a return of the function to the calling function or the main function. The various methods described herein may be partially or fully implemented by programming e.g. instructions and or data that may be stored in a non transitory machine readable computer readable and or processor readable storage medium and executed by one or more processors machines and or devices.

Those of skill in the art would further appreciate that the various illustrative logical blocks modules circuits and algorithm steps described in connection with the embodiments disclosed herein may be implemented as hardware software firmware middleware microcode or any combination thereof. To clearly illustrate this interchangeability various illustrative components blocks modules circuits and steps have been described above generally in terms of their functionality. Whether such functionality is implemented as hardware or software depends upon the particular application and design constraints imposed on the overall system.

The various features associate with the examples described herein and shown in the accompanying drawings can be implemented in different examples and implementations without departing from the scope of the present disclosure. Therefore although certain specific constructions and arrangements have been described and shown in the accompanying drawings such embodiments are merely illustrative and not restrictive of the scope of the disclosure since various other additions and modifications to and deletions from the described embodiments will be apparent to one of ordinary skill in the art. Thus the scope of the disclosure is only determined by the literal language and legal equivalents of the claims which follow.

