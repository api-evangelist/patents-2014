---

title: Service chaining across multiple networks
abstract: In some examples, a controller comprises one or more processors; a control unit configured to obtain, from a router in a first network, a route that specifies a next hop to an address prefix reachable by the first network; and a service chain unit configured to generate a modified route that specifies a service node as the next hop for the address prefix, wherein the service node is external to the first network, and wherein the control unit is further configured to send the modified route to a second network, the modified route marked with an import route target configured for a provider edge router of the second network so that traffic from the first network and destined for the second network is forwarded to the service node.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09634936&OS=09634936&RS=09634936
owner: Juniper Networks, Inc.
number: 09634936
owner_city: Sunnyvale
owner_country: US
publication_date: 20140630
---
The invention relates to computer networks and more specifically to applying network services to network traffic traversing computer networks.

A computer network is composed of a set of nodes and a set of links that connect one node to another. For instance a computer network may be composed of a set of routers while the set of links may be cables between the routers. When a first node in the network sends a message to a second node in the network the message may pass through many links and many nodes. The set of links and nodes that the message passes through while traveling from the first node to the second node is referred to as a path through the network.

A network operator may deploy one or more network devices to implement service points that apply network services such as firewall carrier grade network address translation CG NAT performance enhancement proxies for video transport control protocol TCP optimization and header enrichment caching and load balancing. In addition the network operator may configure service chains that each identify a set of the network services to be applied to packet flows mapped to the respective service chains. A service chain in other words defines one or more network services to be applied in a particular order to provide a composite service for application to packet flows bound to the service chain.

In general techniques are described in which a centralized controller constructs service chains that span multiple networks. Moreover the centralized controller may allow for the construction of inter network service chains without requiring direct reprogramming or reconfiguring provider edge routers that separate the networks. For example the centralized controller may automatically synchronize between the networks any intra network routing prefixes and next hop information that may be needed for constructing the service chains.

In one example implementation the controller may for example automatically configures virtual private networks to establish a virtual network topology to direct traffic flows along a chain of service nodes or service chain that provide network services to the traffic flows. For example a controller that controls in a centralized manner routing within one or more networks may modify routes obtained from a destination network to direct traffic destined for prefixes associated with the obtained routes to a service node rather than to the destination network. The controller may then re originate the modified routes into a routing instance for the destination network to cause a router that participates in the routing instance to import the modified re originated routes. The routing instance may correspond to a virtual routing and forwarding instance VRF or a network. In re originating the modified routes into the routing instance for the destination network the controller may set a route target for the modified routes that is a route target associated with the routing instance.

PE routers that have the routing instance ensure that any route associated with the route target is distributed to every PE router that has a routing instance associated with the route target. Accordingly by setting a route target for the modified routes that is the route target of the routing instance the controller may cause each PE router that has the routing instance to receive and install the modified routes to its routing instance without the controller having to program each PE router with a route target associated with a routing instance for the destination network. In this way the techniques may avoid reconfiguring the PE routers with a new route target for the PE routers may import the re originated modified routes and direct network traffic to the service node in accordance with the modified routes.

In one example a method comprises obtaining by a controller and from a router in a first network a route that specifies a next hop to an address prefix reachable by the first network generating by the controller a modified route that specifies a service node as the next hop for the address prefix wherein the service node is external to the first network and sending by the controller the modified route to a second network the modified route marked with an import route target configured for a provider edge router of the second network so that traffic from the first network and destined for the second network is forwarded to the service node.

In another example a controller comprises one or more processors a control unit configured to obtain from a router in a first network a route that specifies a next hop to an address prefix reachable by the first network and a service chain unit configured to generate a modified route that specifies a service node as the next hop for the address prefix wherein the service node is external to the first network and wherein the control unit is further configured to send the modified route to a second network the modified route marked with an import route target configured for a provider edge router of the second network so that traffic from the first network and destined for the second network is forwarded to the service node.

In another example a non transitory computer readable medium contains instructions. The instructions cause one or more programmable processors to obtain by a controller and from a router in a first network a route that specifies a next hop to an address prefix reachable by the first network generate by the controller a modified route that specifies a service node as the next hop for the address prefix wherein the service node is external to the first network and send by the controller the modified route to a second network the modified route marked with an import route target configured for a provider edge router of the second network so that traffic from the first network and destined for the second network is forwarded to the service node.

The details of one or more embodiments of the invention are set forth in the accompanying drawings and the description below. Other features objects and advantages of the invention will be apparent from the description and drawings and from the claims.

In the example of service provider network includes access network access network that provides connectivity to packet data network PDN via service provider core network and gateway . Service provider core network and PDN provide packet based services that are available for request and use by subscriber devices . As examples core network and or PDN may provide for example bulk data delivery voice over Internet protocol VoIP Internet Protocol television IPTV Short Messaging Service SMS Wireless Application Protocol WAP service or customer specific application services. Packet data network may comprise for instance a local area network LAN a wide area network WAN the Internet a virtual LAN VLAN an enterprise LAN a layer 3 virtual private network VPN an Internet Protocol IP intranet operated by the service provider that operates access network an enterprise IP network or some combination thereof. In various embodiments PDN is connected to a public WAN the Internet or to other networks. Packet data network executes one or more packet data protocols PDPs such as IP IPv4 and or IPv6 X.25 or Point to Point Protocol PPP to enable packet based transport of PDN services.

Subscriber devices connect to gateway via access network to receive connectivity to subscriber services for applications hosted by subscriber devices . A subscriber may represent for instance an enterprise a residential subscriber or a mobile subscriber. Subscriber devices may be for example personal computers laptop computers or other types of computing device associated with subscribers. In addition subscriber devices may comprise mobile devices that access the data services of service provider network via radio access network RAN . Example mobile subscriber devices include mobile telephones laptop or desktop computers having e.g. a 3G wireless card wireless capable netbooks video game devices pagers smart phones personal data assistants PDAs or the like. Each of subscriber devices may run a variety of software applications such as word processing and other office support software web browsing software software to support voice calls video games videoconferencing and email among others. Subscriber devices connect to access network via access links that comprise wired and or wireless communication links. The term communication link as used herein comprises any form of transport medium wired or wireless and can include intermediate nodes such as network devices. Each of access links may comprise for instance aspects of an asymmetric DSL network WiMAX a T 1 line an Integrated Service Digital Network ISDN wired Ethernet or a cellular radio link.

A network service provider operates or in some cases leases elements of access network to provide packet transport between subscriber devices and gateway . Access network represents a network that aggregates data traffic from one or more subscribers for transport to from service provider core network of the service provider. Access network includes network nodes that execute communication protocols to transport control and user data to facilitate communication between subscriber devices and gateway . Access network may include a broadband access network network a wireless LAN a public switched telephone network PSTN or other type of access network and may include or otherwise provide connectivity for cellular access networks such as radio access network RAN of . Examples of access network may also include networks conforming to a Universal Mobile Telecommunications System UMTS architecture an evolution of UMTS referred to as Long Term Evolution LTE mobile IP standardized by the Internet Engineering Task Force IETF as well as other standards proposed by the 3Generation Partnership Project 3GPP 3Generation Partnership Project 2 3GGP 2 and the Worldwide Interoperability for Microwave Access WiMAX forum.

Service provider core network hereinafter core network offers packet based connectivity to subscriber devices attached to access network for accessing PDN . Core network may represent a public network that is owned and operated by a service provider to interconnect a plurality of networks which may include access network . Core network may implement Multi Protocol Label Switching MPLS forwarding and in such instances may be referred to as an MPLS network or MPLS backbone. In some instances core network represents a plurality of interconnected autonomous systems such as the Internet that offers services from one or more service providers. PDN may represent an edge network coupled to core network e.g. by a customer edge device such as customer edge switch or router. PDN may include a data center.

In examples of network that include a wireline broadband access network gateway may represent a Broadband Network Gateway BNG a Broadband Remote Access Server BRAS MPLS Provider Edge PE router core router or gateway or a Cable Modem Termination System CMTS for instance. In examples of network that include a cellular access network as access network gateway may represent a mobile gateway for example a Gateway General Packet Radio Service GPRS Serving Node GGSN an Access Gateway aGW or a Packet Data Network PDN Gateway PGW . In other examples the functionality described with respect to gateway may be implemented in a switch service card or other network element or component.

A network service provider that administers at least parts of network typically offers services to subscribers associated with devices e.g. subscriber devices which access the service provider network. Services offered may include for example traditional Internet access Voice over Internet Protocol VoIP video and multimedia services and security services. As described above with respect to access network core network may support multiple types of access network infrastructures that connect to service provider network access gateways to provide access to the offered services. In some instances network system may include subscriber devices that attach to multiple different access networks having varying architectures.

In general any one or more of subscriber devices may request authorization and data services by sending a session request to gateway . In turn gateway typically accesses Authentication Authorization and Accounting AAA server to authenticate the subscriber device requesting network access. Once authenticated any of subscriber devices may send subscriber data traffic toward service provider core network in order to access and receive services provided by PDN and such packets traverse gateway as part of at least one packet flow. Flows illustrated in represent one or more upstream packet flows from any one or more subscriber devices and directed to PDN via gateway which is a next hop for PDN for traffic from subscribers. Gateway includes a routing instance A routing and forwarding for traffic on its core facing interfaces. The term packet flow traffic flow or simply flow refers to a set of packets originating from a particular source device and sent to a particular destination device. A single flow of packets in either the upstream sourced by one of subscriber devices or downstream destined for one of subscriber devices direction may be identified by the 5 tuple for example. This 5 tuple generally identifies a packet flow to which a received packet corresponds. An n tuple refers to any n items drawn from the 5 tuple. For example a 2 tuple for a packet may refer to the combination of or for the packet. Moreover a subscriber device may originate multiple packet flows upon authenticating to service provider network and establishing a communication session for receiving data services.

As described herein service provider network includes a services complex having a cluster of service nodes A N that provide an execution environment for the network services. That is each of service nodes apply one or more services. As examples service nodes may apply firewall and security services carrier grade network address translation CG NAT media optimization voice video IPSec VPN services deep packet inspection DPI HTTP filtering counting accounting charging and load balancing of packet flows or other types of services applied to network traffic. Each of service nodes in this way represents a service instance.

Gateway may represent a gateway node for the services complex that is a physical gateway router or switch that connects virtual networks of the services complex to physical networks such as the Internet a customer VPN e.g. L3VPN another data center or to non virtualized servers. In such examples services complex may include layer two L2 and layer three L3 switching and routing components that provide point to point connectivity between servers not shown that execute one or more of service nodes within a virtual environment. That is one or more of service nodes may run as virtual machines in a virtual compute environment. Moreover the compute environment may comprise a scalable cluster of general computing devices such as x86 processor based servers. As another example service nodes may comprise a combination of general purpose computing devices and special purpose appliances.

As virtualized individual network services provided by service nodes can scale just as in a modern data center through the allocation of virtualized memory processor utilization storage and network policies as well as horizontally by adding additional load balanced virtual machines. In one example services complex comprises a set of interconnected high performance yet off the shelf packet based routers and switches that implement industry standard protocols. In one example services complex may comprise off the shelf components that provide Internet Protocol IP over an Ethernet IPoE point to point connectivity.

Again in such examples SDN controller provides a high level controller for configuring and managing routing and switching infrastructure of services complex . SDN controller provides a logically and in some cases physically centralized controller for facilitating operation of one or more virtual networks within services complex. Additional information regarding a SDN controller operating as a virtual network controller in conjunction with other devices of services complex or other software defined network is found in International Application Number PCT US2013 044378 filed Jun. 5 2013 and entitled PHYSICAL PATH DETERMINATION FOR VIRTUAL NETWORK PACKET FLOWS which is incorporated by reference as if fully set forth herein.

As shown in gateway steers individual subscriber packet flows through defined sets of services provided by service nodes . That is each subscriber packet flow may be forwarded through a particular ordered combination of services provided by service nodes each ordered set being referred to herein as a service chain. In the example of one or more subscriber packet flows are directed along a first service chain A and therefore receive services applied by service nodes A B and N in that order. Similarly one or more subscriber packet flows are directed along a second service chain B and therefore receive services applied by service nodes C B and N.

In this way subscriber flows may be processed by service nodes as the packets flow between access network and PDN according to service chains configured by the service provider. In the illustrated example service chain A identifies the ordered set of nodes A B and N according to the listed ordering. Service chain B identifies the ordered set of nodes C B and N. Accordingly packet flows processed according to service chain A follow a service path that traverses nodes A B and finally node N as the terminal node for the service chain A. A particular node may support multiple service chains. In this example service node B supports service chains A B.

Once processed at a terminal node of the service chain i.e. the last node to apply services to packets flowing along a particular service path the terminal node may direct the traffic back to gateway for further processing and or forwarding to PDN according to routing instance B that includes routes for PDN . For example traffic engineered service paths may start and terminate with gateway . In some cases separate network devices logical or physical may start and terminate any of service chains .

Whereas a service chain defines one or more services to be applied in a particular order to provide a composite service for application to packet flows bound to the service chain a service tunnel or service path refers to a logical and or physical path taken by packet flows processed by a service chain along with the forwarding state for forwarding packet flows according to the service chain ordering. Each service chain may be associated with a respective service tunnel and packet flows associated with each subscriber device flow along service tunnels in accordance with a service profile associated with the respective subscriber. The arrows denoted as service chains A B illustrate respective paths taken by packet flows mapped to the service chains A or B. For example a given subscriber may be associated with a particular service profile which in turn is mapped to a service tunnel associated with service chain A. Similarly another subscriber may be associated with a different service profile which in turn is mapped to a service tunnel associated with service chain B. Gateway in some instances after authenticating and establishing access sessions for the subscribers may direct packet flows for the subscribers along the appropriate service tunnels thereby causing service complex to apply the requisite ordered services for the given subscriber.

Service nodes may implement service chains A B using internally configured forwarding state that directs packets of the packet flow along the service chains A B for processing according to the identified set of service nodes . Such forwarding state may specify tunnel interfaces for tunneling between service nodes using network tunnels such as Internet Protocol IP or Generic Route Encapsulation GRE tunnels or by using Virtual Local Area Networks VLANs Multiprotocol Label Switching MPLS techniques and so forth. In some instances real or virtual switches routers or other network elements that interconnect connect service nodes may be configured to direct packet flow to the service nodes according to service chains A B. One or more tunnel endpoints for a given service chain may each be associated with a different virtual private network overlaying a physical underlay network. Such a tunnel endpoint may be logically located and implemented by a network element that has a routing instance e.g. a VRF for the virtual private network for the tunnel endpoint. Such a network element whether physical or virtual may be considered and alternatively referred to as a provider edge PE router for the virtual private network for the tunnel endpoint. A network element may be a PE router for multiple virtual private networks.

In software defined networking SDN controller provides a high level controller for configuring and managing routing and switching infrastructure of service provider network e.g. gateway core network and service nodes . In some instances SDN controller manages deployment of virtual machines within the operating environment of value added services complex . SDN controller communicates with gateway to specify service chain A B information. Service chain information provided by SDN controller may specify any combination and ordering of value added services provided by service nodes traffic engineering information e.g. labels or next hops for tunneling or otherwise transporting e.g. MPLS or IP tunnels packet flows along service paths rate limits Type Of Service TOS markings or packet classifiers that specify criteria for matching packet flows to a particular service chain A B. Further example details of an SDN controller for a software defined network are described in PCT International Patent Application PCT US13 44378 filed Jun. 5 2013 the entire contents of which are incorporated herein by reference.

Service provider network may include an Authentication Authorization and Accounting server AAA server . For example upon detecting a new traffic flow gateway may authenticate new subscribers to AAA server e.g. by way of the Radius or Diameter protocols and at this time receive a service profile or other information that defines the services to be applied to the subscriber or maps the various traffic expected for the subscriber to one or more service flows. Upon detecting a new flow the gateway selects the service chain for the flow based on the service profile and traffic type. For example gateway selects one of the service chains for the packet based on the service profile received for the subscriber and or based on the type of traffic e.g. HTTP traffic or VoIP traffic.

Service nodes may receive subscriber specific service requirements from other elements of service provider network such as SDN controller AAA server policy control server or other subscriber control systems to configure the services chains. For example when processing packet flows service nodes may issue receive subscriber specific service requirements. Examples of subscriber specific service requirements returned by SDN controller or AAA server include policies service level agreement parameters information describing the services to be applied for a particular subscriber and the like.

As a specific example one or more of service nodes may implement policy and charging control PCC functionality for subscriber devices . In response to queries issued by any of service nodes policy control server issues responses to provision the requesting service node by a policy interface with one or more policy rules that each specifies a set of information enabling the detection of a service data flow and defining policy control charging or application detection parameters for application by network elements of access network . Policy control server may provision one or more service nodes with a Policy Control and Charging Rules Function PCRF for a mobile e.g. 3GPP subscriber devices or alternatively or in addition for a broadband wireline subscriber devices.

One or more of service nodes may for example provide an operating environment for a policy enforcement module that enforces subscriber based policy and charging control according to the policy rules. In some examples the policy interface presented by a service node may represent a Gx and or Sd interface reference point provided by one or more service nodes. In some instances the policy rules provided by policy control server to gateway include PCC rules and the policy enforcement module s executing on service nodes represents a Policy and Charging Enforcement Function PCEF . In some instances the policy rules may also or alternatively include Application Detection and Control ADC rules and the policy enforcement module implemented by one or more service nodes may represents a Traffic Detection Function TDF . In some instances the policy enforcement module s of service nodes may represent a Policy Decision Point for a BPCF framework. Further details regarding policy and charging controls are found in 3GPP TS 23.203 Policy and Charging Control Architecture Release 10 Version 10.1.0 3rd Generation Partnership Project Technical Specification Group Services and System Aspects September 2010 and 3GPP TS 29.212 Policy and Charging Control PCC Reference Points Release 11 Version 11.7.0 February 2012 which are each incorporated herein by reference in their entirety.

In accordance with techniques of the disclosure service provider network may include a service provider system . In general service provider system may send requests to SDN controller that cause SDN controller to validate provision and or manage services provided by service provider network . Service provider system may send data interchange formatted messages to interface of SDN controller that include requests to validate provision and or manage services provided by service provider network . In some examples service provider system is implemented and operated by the service provider that manages service provider network . In such examples customers of the service provider may interact with service provider system using a client device not shown . For instance service provider system may provide a portal that includes a graphical user interface and or application programming interface API which allow customers to submit requests for network services. Examples of customers may include universities businesses or any other entities that purchased or otherwise use services provided by service provider network . In other examples service provider system may be owned operated and or maintained by the customer rather than the service provider that manages service provider network .

Service provider system may send data interchange formatted messages to interface of SDN controller to request network services. In some examples interface is implemented according to a stateless client server communications architecture. The stateless client server communications architecture may rely on a protocol that is cacheable. As an example interface may be implemented according to a representational state transfer REST software architecture to send and receive data interchange formatted messages with service provider system . Data interchange formatted messages may conform to an open standards format that uses human readable text to transmit data objects that include attribute value pairs. An example of a data interchange formatted message format is JavaScript Object Notation JSON described in RFC 7159 and ECMA 404.

To submit requests to SDN controller service provider system may generate data interface formatted messages that include service abstractions. A service abstraction may include a definition of one or more services and or resources of a network requested by a customer. As one example a service abstraction may specify a Virtual Private Network VPN service requested by a customer between one or more customer sites. Service provider system may structure the service abstraction in a data interface formatted message according to one or more schemas that define the requirements for the structure content and or semantics of the data interface formatted message. In some examples SDN controller may store and provide the schemes for interface which may be retrieved by service provider system . In other examples service provider system may receive the schemas from sources other than SDN controller .

An example of a service abstraction specified in a data interface formatted message may include the following 

In response to input provided by a customer to request a service service provider system may generate a data interface formatted message that includes a service abstraction defining the service such as described for the VPN service above. Service provider system sends the data interface formatted message to interface . Service provisioning module may realize the state of the network represented by the data interface formatted message. That is service provisioning module may translate the high level data model of the service abstraction defining the service into a lower level form suitable for interacting with network elements including e.g. service node and service provider core . SDN controller may validate the request included in the message and provision the service if sufficient resources exist to satisfy the request. In this way interface and service provisioning module may provide a flexible service abstraction layer on top of SDN controller that can support fast changing service types adapt to real time network resources and enforce business logic.

Service provider system may be implemented as hardware software and or a combination of hardware and software. Although shown as a standalone system in any set of functionality of service provider system described in this disclosure may be implemented in SDN controller gateway AAA server policy control server or any other suitable device.

As described above service nodes may implement service chains A B using internally configured forwarding state that directs packets of the packet flow along the service chains A B for processing according to the identified set of service nodes . Such forwarding state may specify tunnel interfaces for tunneling between service nodes using network tunnels such as Internet Protocol IP Multiprotocol Label Switching MPLS label switched paths LSPs Generic Route Encapsulation GRE tunnels or by using Virtual Local Area Networks VLANs VxLANs techniques and so forth. An MPLS or VxLAN label may identify to a virtual router executing on a tunnel endpoint a routing instance for tunneled packets with which to forward the tunneled packets to the appropriate one of service nodes . Additional information regarding virtual routing and forwarding is found in U.S. Provisional Patent Appln. No. 61 973 045 filed Mar. 31 2014 and entitled HIGH PERFORMANCE SCALABLE AND DROP FREE DATA CENTER SWITCH FABRIC the entire contents of which being incorporated by reference in its entirety. In some instances real or virtual switches routers or other network elements that interconnect service nodes may be configured to direct packet flow to the service nodes according to service chains A B.

In accordance with techniques described herein SDN controller provisions other components of service provider network with forwarding information to direct the components to forward traffic along service chains A B. For service chain A for example SDN controller may provision respective routing instances that include virtual interfaces for service nodes A B and N and at least one routing instance of gateway in order to steer traffic along service chain A from gateway to service node A to service node B to service node N and thence again to gateway . More specifically SDN controller may communicate with virtual routers and gateway to 1 manipulate route targets and provision service node servers and or advertise routes within the virtual and or physical networks and or 2 manipulate next hops and or labels of the routes from routing instance to routing instance to steer traffic through the right sequence of routing instances and accordingly the right sequence of virtual interfaces for service nodes in order to realize service chain A.

In some examples SDN controller automatically configures virtual private networks to establish a virtual network topology to direct traffic flows along service chain A includes service nodes that provides services to the traffic flows. For example SDN controller may modify routes obtained from a destination network for the network traffic to direct traffic destined for prefixes associated with the obtained routes along service chain A rather than directly to the destination network. The SDN controller may then re originate the modified routes into a routing instance to cause a physical or virtual router that participates in or has the routing instance to import the modified re originated routes. The routing instance may correspond to a virtual routing and forwarding instance VRF . In re originating the modified routes into the routing instance the SDN controller may set a route target for the modified routes that is a route target associated with the routing instance.

Provider edge PE routers such as gateway or a network element that implements any of service nodes that have the routing instance ensure that any route associated with the route target is distributed to every PE router that has a routing instance associated with the route target. Accordingly by setting a route target for the modified routes that is the route target of the routing instance the SDN controller may cause each PE router that has the routing instance to receive and install the modified routes to its routing instance without the SDN controller having to program each PE router with a route target associated with a routing instance for the destination network. In this way the techniques may avoid reconfiguring the PE routers with a new route target for the PE routers may import the re originated modified routes and direct network traffic along service chains in accordance with the modified routes.

In this example one or more subscriber packet flows A are directed along a first service chain A to receive network address translation NAT service . Similarly one or more subscriber packet flows B are directed along a second service chain B for application of an HTTP filter service NAT service and session border controller SBC services for voice over IP VoIP processing and control. In service chain C packet flows C are directed only to HTTP filter service . In service chain D packet flows D are directed to HTTP filter and subsequently to firewall service . As another example packet flows E are directed along service chain E for application of HTTP filter NAT and intrusion detection and prevention e.g. deep packet inspection service . Each of NAT services and HTTP filter services and SBC services firewall service and IDP may represent examples of any of service nodes .

The provider edge PE routers extend attachment circuits to customer edge CE devices to provide services to customers. In some cases the network system implements BGP Multiprotocol Label Switching BGP MPLS Internet Protocol IP Virtual Private Networks VPNs to segregate traffic for different customers by ensuring that routes from different VPNs remain distinct and separate regardless of whether VPNs for respective customers have overlapping address spaces. For each VPN configured for the network system and in which a particular PE router participates the PE router maintains a VPN Routing and Forwarding instance VRF . In general each attachment circuit connecting a PE router and a CE device is associated with a VRF. For any given VPN the PE router learns routes for the VPN in some cases from the CE device and installs the VPN routes to the corresponding VRF which the PE router uses to forward traffic. In addition the PE router distributes learned VPN routes to other PE routers or to PE routers of other networks using BGP. BGP MPLS IP VPNs are described in detail in Rosen Rekhter BGP MPLS IP Virtual Private Networks VPNs Internet Engineering Task Force Network Working Group Request for Comments 4364 February 2006 which is incorporated herein by reference in its entirety hereinafter RFC 4364 .

In instances that use BGP MPLS IP VPNs PE routers use Route Target RT extended communities route targets to control the distribution of routes into VRFs. For a given collection of PE routers that peer using BGP each PE router only stores VPN routes that are received and marked with route targets corresponding to VRFs that have local CE attachment circuits configured for the PE router. The PE router may discard all other VPN routes that it receives.

PE routers may execute one or more interior gateway protocols such as Open Shortest Path First OSPF Routing Information Protocol RIP Intermediate System to Intermediate System IS IS Interior Gateway Routing Protocol IGRP Enhanced IGRP EIGRP and Interior Border Gateway Protocol iBGP . PE routers are logically located at the edge of respective networks and may extend attachment circuits to customer edge CE device s or customer device s to provide services to one or more customers. Either or both of networks may represent physical or virtual networks e.g. VPNs established for network system and thus either or both of PE routers may represent virtual PEs executing on one or more real servers. Any of PE routers may alternatively represent an external PE router such as a data center gateway to network system e.g. gateway of with which controller may peer according to a routing protocol e.g. BGP but that is not configurable with routes by SDN controller . That is in some examples whereas other PE routers of network A may be virtual routers configurable by the SDN controller PE router A may be a physical router that is not configurable by the SDN controller but is able to exchange network packets with network A for instance. As one example the SDN controller may in some instances be unable to configure a route target for a Virtual Routing and Forwarding instance VRF for PE router A because PE router A is a physical router that does not expose a configuration interface to the SDN controller . VRFs are described in further detail below.

CE devices not shown in may each represent a network device located at a customer site that connects to either of networks to receive services. Although referred to herein as devices CE and customer devices also not shown in may represent either physical or virtual machines VMs routers switches appliances and controllers for example. Furthermore customer devices such as application VMs may be considered CE devices from the perspective of the VPN despite not implementing conventional edge functionality such as speaking one or more routing protocols.

Components of network system implement Virtual Private Networks VPNs to segregate traffic by ensuring that routes from different VPNs remain distinct and separate regardless of whether the multiple VPNs have overlapping address spaces. In some cases the VPNs represent Internet Protocol VPNs IP VPNs such as BGP Multiprotocol Label Switching BGP MPLS IP VPNs. For each VPN configured for the network system and in which a particular PE router of PE routers participates the PE router may implement a VPN Routing and Forwarding instance VRF . A PE router that implements a VRF of the network system may have a distinct routing table for the VRF by which the PE router forwards network packets associated with the VRF. Because this distinct routing table for the VRF and the VRF itself are often referred to interchangeably in this respect the PE router may also be referred to as having a VRF. Every attachment circuit connecting one of PE routers and a CE customer device may also be associated with a VRF.

For any given VPN a PE router learns routes for the VPN from CE devices connected to the PE router via an attachment circuit for the VPN as well as from routing advertisements within its respective network that are marked with a route target corresponding to a VRF that has an attachment circuit configured for the PE router. One or more VRFs of the PE routers may be configured with a route target to direct the PE router to import all routes received that are marked with the route target into the VRFs. In addition the PE routers may distribute learned VPN routes to other PE routers of service provider network using a routing protocol such as BGP. BGP MPLS IP VPNs are described in detail in RFC 4364 incorporated above. In the illustrated example PE router A is configured to import routes marked with a route target of 100 and PE router B is configured to export routes marked with a route target of 200. Each of networks may be associated with a different VRF. The VRF for network A is associated with the route target of 100 and the VRF for network B is associated with the route target of 200.

Within a single VPN pairs of PE routers may connect by a bidirectional tunnel not shown for ease of illustration which may include at least one MPLS label switched path LSP Generic Route Encapsulation tunnel VxLAN or other suitable tunneling connection between pairs of PE routers that is capable of tunneling IP traffic between the PE routers. PE routers may establish tunnels using e.g. Resource Reservation Protocol RSVP or Label Distribution Protocol LDP .

Network system may additionally include one or more core P routers not shown for ease of illustration that implement at least in part tunnels between pairs of PE routers for IP VPNs. P routers may support MPLS LSP or label distribution protocol LDP functionality for instance but the P routers do not necessarily need to support VPN functionality. Network system may include a data switch fabric underlay for networks overlaid thereon.

Service node represents a physical or virtual node that applies a service to network traffic received by the service node . Service node may for instance apply network services such as firewall DPI IDS IPS carrier grade network address translation CG NAT performance enhancement proxies for video transport control protocol TCP optimization and header enrichment caching and load balancing to the network traffic.

Service node may represent an appliance e.g. firewall appliance VPN appliance and so forth server components or modules of a single appliance or server virtual machines executed a server or any combination of the above. Service node may be a device managed as part of a value added services complex which may represent a data center. Service node may also in some instances be coupled by one or more switches or virtual switches of a core network may in some instances be inline for packet flows from a gateway of any of networks or any combination of the above. Service node may represent a virtual machine orchestrated by the SDN controller that implements in accordance with techniques described herein service chains by sequentially directing packets to the service node according to an orderings specified by one or more service chains including service chain. Service node may be associated with an IP address by which the service node is addressable to direct network traffic. Service node may in some examples alternatively be referred to as a service point value added service VAS point or node or network function virtualization NFV node. Network function virtualization involves orchestration and management of networking functions such as a Firewalls Intrusion Detection or Preventions Systems IDS IPS Deep Packet Inspection DPI caching Wide Area Network WAN optimization etc. in virtual machines instead of on physical hardware appliances. Network function virtualization in the service provider network may provide Value Added Services VAS for edge networks such as business edge networks broadband subscriber management edge networks and mobile edge networks. Access network of is an example of an edge network for service provider network of .

The arrows denoted as service path illustrate a path taken by packet flows mapped to a corresponding service chain for service path . The controller may compute and establish service path .

The controller manages at least in part VPNs of network system to direct traffic along service path to service node and thereafter to PE router B. The traffic may be destined for address prefixes originated by PE router B as well as sourced by address prefixes originated by PE router A. The SDN controller may represent one or more servers appliances dedicated controller devices or any combination of the above that executes processes to manage VPNs of network system . In the illustrated example The SDN controller establishes routing protocol sessions with devices of network A to exchange routing protocol communications that advertise routes to destination address prefixes. The routing protocol advertisements may include an MPLS label identifying a VPN a destination address prefix route target and a next hop router for the traffic destined to an address within the destination address prefix. The routing protocol advertisements may also include a route distinguisher. Routing protocol session may represent one or more BGP peering sessions with one or more PE routers of networks A and the routing protocol advertisements for protocol sessions in this case may be BGP UPDATE messages extended to include Multiprotocol Reachable NLRI MP REACH NLRI . Multiprotocol Reachable NLRI is described in further detail in Bates et al. Multiprotocol Extensions for BGP 4 Internet Engineering Task Force Network Working Group Request for Comments 2858 June 2000 which is incorporated herein by reference in its entirety hereinafter RFC 2858 .

The SDN controller further exchanges communication via communication session with at least one device of network B. Communication session may represent an Extensible Messaging and Presence Protocol XMPP session or a session for another communication protocol suitable for exchanging control state. Although described as a session communication session may not necessarily be stateful. Via communication session PE B may exchange control state with SDN controller . For example PE B may provide routes reachable by network B including a route for prefix P. The route may include one or more of the prefix P a virtual network identifier for network B and a physical network address for a network element that executes PE router B e.g. a real server .

In accordance with techniques described herein the SDN controller receives via communication session at least one route for network B for an address prefix P for which PE router B is the next hop router. To establish service path to direct traffic originated in network A and destined to prefix P to service node for processing controller modifies the next hop for P received in a routing protocol advertisement from network B to refer to an interface of service node . In some examples modifying the next hop in the routing protocol advertisement for P may include modifying a destination network address for an underlying physical network to point to a network address of a server that executes service node or to a network address of a service device such as a firewall or load balancing device. In some examples modifying the next hop in the routing protocol advertisement for P may also or alternatively include modifying a label or other virtual network identifier tunnel encapsulation information or other next hop information that identifies service node to a combination of network A and in some cases an underlying physical network.

For example SDN controller may generate or obtain from PE B via communication session a route that specifies PE router B as the next hop. The route may also include a virtual network identifier that when located in a tunnel encapsulation header for encapsulated data traffic is associated with a routing instance for network B. The SDN controller may modify the next hop to instead specify service node as the next hop address. The modified next hop address may correspond to an interface for a real server to the underlying physical network or an interface for a service appliance controller for instance. In addition in some instances the SDN controller may modify the next hop to include a virtual network identifier that identifies a routing instance for service node . In addition in some instances the SDN controller may modify the route distinguisher. As a result in instances in which service node is applied by a virtual machine executing on a server that has one or more routing instances the virtual router for the service may direct service path traffic that includes the virtual network identifier to service node which is associated in the virtual router with the routing instance as described in further detail below.

SDN controller then advertises P as a route in a routing protocol message to network A the route modified as described above to have a next hop set to the service node left interface and marked with a route target of 100. This advertisement by the SDN controller into network A may be alternatively referred to as re origination to distinguish the original origination that may have been performed by router B. As a result PE router A and other PE routers of network A configured to import route target imports the route with the prefix P and the next hop set to the service node interface and to its VRF for network A. Having imported the route advertised in routing protocol message PE router A forwards network traffic destined for P to the route next hop i.e. service node . In some examples the route in routing protocol message may include a label that identifies service node executed as a virtual machine by a server that has an interface addressable by the next hop specified by the route. The label may be a label that identifies a VRF implemented by the server for service node . This VRF may be alternatively referred to as a service VRF or service routing instance and may be particular to the service node e.g. established by SDN controller or another entity for the purpose of directing traffic to service node .

SDN controller without having to configure PE router A with a new route target to import the routes associated with the VRF for network B is in this way nevertheless able to watch obtain prefixes for network B and to direct network traffic destined for network B prefixes along service path . The techniques described above may be particularly applicable in topologies of network system in which PE router A is a physical external or gateway router over which SDN controller has little or no configuration capability such as the capability to configure an import route target for a VPN. That is SDN controller may use techniques described herein to cause PE router A to import routes for other networks despite the SDN controller being unable in some examples to configure the PE router A with import route targets.

Similarly SDN controller re originates routes with the address prefix to respective VRFs A B associated with service nodes A B to cause service node A to direct traffic destined for the address prefix to service node B and to cause service node A to direct traffic destined for the address prefix to PE router B. In re originating the routes using routing protocol messages A C SDN controller includes import route targets previously configured for network A VRF A and VRF B. For example SDN controller marks the route in routing protocol message A with the route target of 100 that PE router A and potentially other PE routers of network A are configured to import. As a result PE router A may import the route to prefixes hosted by PE router B without being re configured with a new import target the route causing PE router A to forward traffic received by PE router A and destined for the prefix to service node A.

BGP UPDATE message includes path attributes which include ORIGIN A AS PATH B NEXT HOP C and MP REACH NLRI . Each of path attributes may comprise a triple of variable length.

MP REACH NLRI of extended BGP UPDATE message specifies an Address Family Identifier AFI A of 1 in this example to indicate IPv4 network addresses along with a value for the Subsequent AFI SAFI B of 128 to identify the NLRI as an MPLS labeled VPN IPv4 address defined by the AFI SAFI combination 1 128. AFI A and SAFI B may in some instances have different values as assigned by a private party or by IRNA. MP REACH NLRI also specifies a VPN NEXT HOP C that is a combination of a route distinguisher RD and an IPv4 prefix.

MP REACH NLRI further includes NLRI to identify a reachable IPv4 prefix C and provide the MPLS label A to identify the VRF for the prefix on a virtual router that has the VRF and thus provides access or applies services to traffic destined for the prefix C.

In accordance with techniques described herein a controller such as SDN controller may receive an MPLS labeled VPN IPv4 address prefix for a network. The network may in some examples host the prefix. To provision a link of a service chain SDN controller advertises a route for the address prefix into another network to cause devices of the network to import the route and to direct traffic destined for the address prefix to a service node.

For example as described with respect to SDN controller may receive an IPv4 prefix reachable by PE router B. The IPv4 prefix may have an associated route distinguisher and further be associated with a label and a next hop for CE B or VM B for instance and therefore represent an MPLS labeled VPN IPv4 address prefix. To re originate the prefix in network A so as to direct traffic destined for the SDN controller may generate extended BGP UPDATE message . SDN controller generates BGP UPDATE message such that the value of NEXT HOP C may specify a real server or controller that executes service node A. Within MP REACH NLRI NEXT HOP C may specify an IPv4 address for a virtual machine. In cases in which the service node A is not virtualized the NEXT HOP C and the NEXT HOP C may specify the same IPv4 prefix. SDN controller further generates BGP UPDATE message such that the label in NLRI for the prefix C the prefix reachable by PE router B and being re originated rather than identifying network B to a real or virtual PE router instead identifies VRF A having service node A. In this way a PE router for service node A may properly identify VRF A and forward traffic to service node A for application of a service provided by the service node A.

SDN controller further generates BGP UPDATE message in a manner to cause PE router A to import the MP REACH NRLI . For instance the SDN controller stores configuration data specifying import route target PE router A and SDN controller sets an extended community attribute to include a route target A with a value B of 100. In other words SDN controller marks MP REACH NRLI with RT 100.

SDN controller re originates the prefix for network B and represented in MP REACH NLRI in network A using in this example a BGP session with PE router A. SDN controller sends BGP UPDATE to PE router A via the BGP session e.g. as routing protocol message A. By generating and advertising BGP UPDATE message in a manner that marks the MP REACH NRLI with an import route target for PE router A the SDN controller causes PE router A to import MP REACH NRLI . PE router A may thereafter direct traffic directed to the IPv4 prefix C along service path to service node A.

As illustrated in the example of virtual network controller VNC includes one or more virtual network controller VNC nodes A N collectively VNC nodes . Each of VNC nodes may represent any of VNC nodes of virtual network controller of . VNC nodes that peer with one another according to a peering protocol operating over a network which may represent an example instance of a switch fabric or L2 L3 IP fabric. In the illustrated example VNC nodes peer with one another using a Border Gateway Protocol BGP implementation an example of a peering protocol. In this sense VNC nodes A and N may represent a first controller node device and a second controller node device peered using a peering protocol. VNC nodes include respective network discovery modules A N to discover network elements of the network.

VNC nodes provide to one another using the peering protocol information related to respective elements of the virtual network managed at least in part by the VNC nodes . For example VNC node A may manage a first set of one or more servers operating as virtual network switches for the virtual network. VNC node A may send information relating to the management or operation of the first set of servers to VNC node N by BGP A. Other elements managed by VNC nodes may include network controllers and or appliances network infrastructure devices e.g. L2 or L3 switches communication links firewalls and VNC nodes for example. Because VNC nodes have a peer relationship rather than a master slave relationship information may be sufficiently easily shared between the VNC nodes . In addition hardware and or software of VNC nodes may be sufficiently easily replaced providing satisfactory resource fungibility.

Each of VNC nodes may include substantially similar components for performing substantially similar functionality said functionality being described hereinafter primarily with respect to VNC node A. VNC node A may include an analytics database A for storing diagnostic information related to a first set of elements managed by VNC node A. VNC node A may share at least some diagnostic information related to one or more of the first set of elements managed by VNC node A and stored in analytics database as well as to receive at least some diagnostic information related to any of the elements managed by others of VNC nodes . Analytics database A may represent a distributed hash table DHT for instance or any suitable data structure for storing diagnostic information for network elements in a distributed manner in cooperation with others of VNC nodes . Analytics databases A N collectively analytics databases may represent at least in part one of distributed databases of distributed virtual network controller of .

VNC node A may include a configuration database A for storing configuration information related to a first set of elements managed by VNC node A. Control plane components of VNC node A may store configuration information to configuration database A using interface A which may represent an Interface for Metadata Access Points IF MAP protocol implementation. VNC node A may share at least some configuration information related to one or more of the first set of elements managed by VNC node A and stored in configuration database A as well as to receive at least some configuration information related to any of the elements managed by others of VNC nodes . Configuration database A may represent a distributed hash table DHT for instance or any suitable data structure for storing configuration information for network elements in a distributed manner in cooperation with others of VNC nodes . Portions of RIBs may be stored by control nodes to facilitate operation of network discovery modules and BGPs .

Virtual network controller may perform any one or more of the illustrated virtual network controller operations represented by modules which may include orchestration user interface VNC global load balancing and one or more applications . VNC executes orchestration module to facilitate the operation of one or more virtual networks in response to a dynamic demand environment by e.g. spawning removing virtual machines in data center servers adjusting computing capabilities allocating network storage resources and modifying a virtual topology connecting virtual switches of a virtual network. VNC global load balancing executed by VNC supports load balancing of analytics configuration communication tasks e.g. among VNC nodes . Applications may represent one or more network applications executed by VNC nodes to e.g. change topology of physical and or virtual networks add services or affect packet forwarding.

User interface includes an interface usable to an administrator or software agent to control the operation of VNC nodes . For instance user interface may include methods by which an administrator may modify e.g. configuration database A of VNC node A. Administration of the one or more virtual networks operated by VNC may proceed by uniform user interface that provides a single point of administration which may reduce an administration cost of the one or more virtual networks.

VNC node A may include a control unit such as a control plane virtual machine VM A that executes control plane protocols to control and monitor a set of network elements. Control plane VM A may in some instances represent a native process. In the illustrated example control VM A executes BGP A to provide information related to the first set of elements managed by VNC node A to e.g. control plane virtual machine N of VNC node N. Control plane VM A may use an open standards based protocol e.g. BGP based L3VPN to distribute information about its virtual network s with other control plane instances and or other third party networking equipment s . Given the peering based model according to one or more aspects described herein different control plane instances e.g. different instances of control plane VMs A N may execute different software versions. In one or more aspects e.g. control plane VM A may include a type of software of a particular version and the control plane VM N may include a different version of the same type of software. The peering configuration of the control node devices may enable use of different software versions for the control plane VMs A N. The execution of multiple control plane VMs by respective VNC nodes may prevent the emergence of a single point of failure.

Control plane VM A may communicate with physical and virtual routers using a communication protocol. Virtual routers or switches facilitate overlay networks in one or more virtual networks. In the illustrated example control plane VM A uses Extensible Messaging and Presence Protocol XMPP A to communicate with at least one virtual router for a virtual network. Virtual network route data statistics collection logs and configuration information may in accordance with XMPP A be sent as XML documents for communication between control plane VM A and the virtual routers. Control plane VM A may in turn route data to other XMPP servers such as an analytics collector or may retrieve configuration information on behalf of one or more virtual network switches. Control plane VM A may further execute a communication interface A for communicating with configuration virtual machine VM A associated with configuration database A. Communication interface A may represent an IF MAP interface.

VNC node A may further include configuration VM A to store configuration information for network elements and to manage configuration database A. Configuration VM A although described as a virtual machine may in some aspects represent a native process executing on an operating system of VNC node A. Configuration VM A and control plane VM A may communicate using IF MAP by communication interface A using XMPP. In some aspects configuration VM A may include a horizontally scalable multi tenant IF MAP server and a distributed hash table DHT based IF MAP database that represents configuration database A. In some aspects configuration VM A may include a configuration translator which may translate a user friendly higher level virtual network configuration to a standards based protocol configuration e.g. a BGP L3VPN configuration which may be stored using configuration database A. Communication interface may include an IF MAP interface for communicating with other network elements. The use of the IF MAP may make the storage and management of virtual network configurations very flexible and extensible given that the IF MAP schema can be dynamically updated. Advantageously aspects of virtual network controller may be flexible for new applications .

VNC node A may further include an analytics virtual machine VM A to store diagnostic information and or visibility information related to at least the first set of elements managed by VNC node A. Control plane VM and analytics VM may communicate using an XMPP implementation by communication interface A. Analytics VM A although described as a virtual machine may in some aspects represent a native process executing on an operating system of VNC node A.

Analytics VM A may include analytics database A which may store visibility data for virtual networks. Visibility information may describe visibility of both distributed VNC itself and of customer networks. The distributed database may include an XMPP interface on a first side and a REST JASON XMPP interface on a second side.

Virtual routers may controlled by VNC implement the layer 3 forwarding and policy enforcement point for one or more end points and or one or more hosts. The one or more end points or one and or one or more hosts may be classified into a virtual network due to configuration from control plane VM A. Control plane VM A may also distribute virtual to physical mapping for each end point to all other end points as routes. These routes may give the next hop mapping virtual IP to physical IP and encapsulation technique used e.g. one of IPinIP NVGRE VXLAN etc. . A virtual router may be agnostic to actual tunneling encapsulation used. A virtual router may also trap interesting layer 2 L2 packets broadcast packets and or implement proxy for the packets e.g. using one of Address Resolution Protocol ARP Dynamic Host Configuration Protocol DHCP Domain Name Service DNS etc.

In some cases different VNC nodes may be provided by different suppliers. However the peering configuration of VNC nodes may enable use of different hardware and or software provided by different suppliers for implementing the VNC nodes of distributed VNC . A system operating according to the above may provide logical view of network topology to end host irrespective of physical network topology access type and or location. Distributed VNC provides programmatic ways for network operators and or applications to change topology to affect packet forwarding and or to add services as well as horizontal scaling of network services e.g. firewall without changing the end host view of the network.

Any of the virtual network controller operations represented by modules may direct request VNC nodes to establish a service chain for steering traffic from a source network to a destination network through a sequence of service nodes . UI for instance may receive a client request to create a service chain for client traffic. As another example one of applications may request a service chain for application traffic for the application.

Control plane VMs A N also include respective service chain units A N that implement service chains in accordance with techniques described in this disclosure. Operations of service chain units A N are described hereinafter with respect to service chain unit A for ease of description purposes. Service chain unit A monitors routes obtained by control plane VMs via BGPs from networks of elements controlled by VNC as well as in some instances routes generated by VNC for configuring the elements.

In accordance with techniques described herein service chain unit A may establish requested service chains in part by modifying and re originating routes into networks of elements controlled by VNC . For example to direct traffic from a source network to a destination network via a service node service chain unit A may obtain a route from the destination network modify the route to replace a next hop and in some cases a label to specify the service node and re originate the modified route into the source network. To re originate the modified route into the source network the service chain unit A may use BGP A to send the modified route marked with a route target that is an import route target for the source network. In this way VNC causes the source network to import the modified route and the source network directs traffic to the destination network via the service node as a result.

SDN controller receives a request that defines a service chain for steering traffic from a source network to a destination network via a service node . Network A may represent the source network network B the destination network and service node the service node. SDN controller may obtain e.g. store generate or receive a route for the destination network that specifies a next hop for the destination network . SDN controller modifies the next hop of the route to specify the service node . Modifying the next hop may include setting a physical address for a service that hosts the service node and in some instances setting a label that identifies a routing instance associated with the service node to a router. SDN controller may then re originate the modified route by sending a routing protocol advertisement to the source network the routing protocol advertisement including the modified route and marked with an import route target for the source network . As a result PE routers of the source network import the advertised modified route and direct traffic destined for the destination network to the service node for application of a service.

The techniques described herein may be implemented in hardware software firmware or any combination thereof. Various features described as modules units or components may be implemented together in an integrated logic device or separately as discrete but interoperable logic devices or other hardware devices. In some cases various features of electronic circuitry may be implemented as one or more integrated circuit devices such as an integrated circuit chip or chipset.

If implemented in hardware this disclosure may be directed to an apparatus such a processor or an integrated circuit device such as an integrated circuit chip or chipset. Alternatively or additionally if implemented in software or firmware the techniques may be realized at least in part by a computer readable data storage medium comprising instructions that when executed cause a processor to perform one or more of the methods described above. For example the computer readable data storage medium may store such instructions for execution by a processor.

A computer readable medium may form part of a computer program product which may include packaging materials. A computer readable medium may comprise a computer data storage medium such as random access memory RAM read only memory ROM non volatile random access memory NVRAM electrically erasable programmable read only memory EEPROM Flash memory magnetic or optical data storage media and the like. In some examples an article of manufacture may comprise one or more computer readable storage media.

In some examples the computer readable storage media may comprise non transitory media. The term non transitory may indicate that the storage medium is not embodied in a carrier wave or a propagated signal. In certain examples a non transitory storage medium may store data that can over time change e.g. in RAM or cache .

The code or instructions may be software and or firmware executed by processing circuitry including one or more processors such as one or more digital signal processors DSPs general purpose microprocessors application specific integrated circuits ASICs field programmable gate arrays FPGAs or other equivalent integrated or discrete logic circuitry. Accordingly the term processor as used herein may refer to any of the foregoing structure or any other structure suitable for implementation of the techniques described herein. In addition in some aspects functionality described in this disclosure may be provided within software modules or hardware modules.

Various embodiments have been described. These and other embodiments are within the scope of the following examples.

