---

title: Cloud based video detection and tracking system
abstract: A method for detecting and tracking multiple moving targets from airborne video within the framework of a cloud computing infrastructure. The invention simultaneously utilizes information from an optical flow generator and an active-learning histogram matcher in a complimentary manner so as to rule out erroneous data that may otherwise, separately, yield false target information. The invention utilizes user-based voice-to-text color feature description for track matching with hue features from image pixels.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09373174&OS=09373174&RS=09373174
owner: The United States of America as represented by the Secretary of the Air Force
number: 09373174
owner_city: Washington
owner_country: US
publication_date: 20141021
---
The invention described herein may be manufactured and used by or for the Government for governmental purposes without the payment of any royalty thereon.

This invention relates generally to the field of cloud based video detection and tracking systems. More specifically this disclosure presents the first attempt at detecting and tracking multiple moving targets from an airborne video within the framework of a cloud computing infrastructure for the application of suspicious behavior recognition.

The detection and tracking of moving objects is critical in many defense and security applications where motion detection is usually performed in a preprocessing step a key success in the following of a target tracking and automatic target recognition. Many videos used in defense and security applications are outdoor videos whose quality may be degraded by various noisy sources such as atmospheric turbulence sensor platform scintillation etc. Meanwhile moving objects may be very small occupying a few pixels only which makes motion detection very challenging. Under this circumstance existing approaches may generate significant amount of false alarms of detecting things that are not targets.

Motion detection has been extensively investigated. Many research works are conducted from indoor videos with large objects. As one of the major techniques optical flow based approaches have been widely used for motion detection. There are two classic methods of optical flow computation in computer vision Gunnar Farneback GF method and Lucas Kanade LK method. Both of them are based on the two frame differential algorithms. Since the LK method needs the construction of a pyramid model in sparse feature scale space and iterative computational updating at successively finer scales a preferred approach would be to focus on the GF method for a dense optical flow computation.

Experiments conducted for video detection and tracking applications appearing in the literature mostly involve stable lighting conditions and relatively stable image collections when using cameras. However in practice image information captured under realistic lighting conditions degrades considerably under moving background and unstable image collections. As a result target detection and tracking becomes quite challenging and many false alarms get generated by existing approaches. In the present invention a developed target detection and tracking system consists of cloud based image alignment online target color calibration optical flow detection and histogram matching.

It is therefore an object of the present invention to provide a method for the detection and tracking of moving objects.

It is a further object of the present invention to provide a method for the detection and tracking of moving objects that overcomes the prior art s limitations in generating false target alarms.

Briefly stated the present invention achieves these and other methods through the detection and tracking of multiple moving targets from airborne video within the framework of a cloud computing infrastructure. The invention simultaneously utilizes information from an optical flow generator and an active learning histogram matcher in a complimentary manner so as to rule out erroneous data that may otherwise separately yield false target information. The invention utilizes user based voice to text color feature description for track matching with hue features from image pixels.

According to an embodiment of the present invention a method for video detection and tracking of a target comprising the steps of defining a target by selecting a dataset of target image frames from a database and selecting the desired color of the target converting the color to a template hue histogram representation initializing an image detector performing target image frame alignment and registration in which homography matrices are generated producing an optical flow field executing morphology processing on the optical flow field so as to produce candidate target contours matching the target contours to the template hue histogram representation initializing tracking of the target and generating target tracks aligning a current target image frame so as to form a sequential track of the target and when the target is not located redefining the target.

The above and other objects features and advantages of the present invention will become apparent from the following description read in conjunction with the accompanying drawings in which like reference numerals designate the same elements.

The present invention utilizes a template hue histogram associated with specific color in a window as a matching feature to locate or redetect the target location estimate when its tracking is hampered by the environment. The candidate window with the histogram is generated from the optical flow field between two aligned consecutive frames. Any optical flow blob with a similar histogram will be considered as a strong potential candidate. The template hue histogram will be tuned according to the strong potential candidates. The goal of the online target color calibration is to adapt the present invention s subsequent color processing to the color characteristic of the light source under which images are captured. This technique has been previously used quite successfully for hand detection in order to cope with unknown color characteristics of various light sources encountered in practice. The calibration is performed from the beginning when the system is turned on or the tracked target is missing till the target is located or redetected. It involves updating the histogram in HSV color space to represent the color characteristics of the target being captured in an online or on the fly manner. The calibration is easily applied by a weighted linear addition between the template histogram and the strong candidate histogram. Representative color pixels of the target are collected within the window and the histogram is calibrated and used as a feature to perform target locating or redetection. Thus the developed solution is designed to be robust to different background and lighting conditions.

The present invention also utilizes a cloud infrastructure to run image alignment or registration processes in parallel and thus a non real time algorithm can perform at a real time frame rate. The well known attractive features of cloud computing include on demand scalability of highly available and reliable pooled computing resources secure access to metered services from anywhere and displacement of data and services from inside to outside the organization.

In the present invention the target track generation based on the image alignment and registration enables further analysis and estimation to the target behavior. The image alignment is a process of transforming different sets of data into one coordinate system since the homography matrix generated from the image alignment can further achieve the rotation and translation matrices. With the rotation and translation matrices the coordinates in the previous frames are projected into the current frames and form a sequential track of the target. Since the image alignment consumes most of the computation in the framework this step is adaptively allocated in a cloud infrastructure.

The goal of the present invention is the development of a general purpose detection framework to increase the robustness of detection by utilizing the information from the optical flow generator OFG and an active learning histogram AHM matcher at the same time and in real time. The OFG and AHM processes are deployed in such a way that they act in a complementary manner by an intersection of each other to rule out the erroneous data that may get detected by each process individually and thus capture the potential and valuable moving targets. Since the background in the airborne video is generally moving a proper registration process is necessary to make the data integration of the whole image sequence possible.

As far as active learning histogram matcher is concerned the hue component of color in HSV hue saturation value space is used for tracking. A template hue histogram associated with a typical color is initialized at the start of the working flow. From the start of detection to the start of tracking the template hue histograms keep actively calibrating according to the slight color changes of the targets. The histogram within a certain window is used as the target tracking feature in case the target was missing in the tracking and this feature makes detection and tracking robust. The active learning histogram matcher is reported in the following section.

As far as cloud based framework is concerned a cloud computing system is built using Xenserver. A web portal in the cloud is provided for the user. From this web portal the user chooses algorithms datasets and system parameters such as the desired processing frame rate maximum frame duration etc. A controller in the cloud will then decide the amount of computing resources to be allocated to the task in order to achieve the user s requirement of performance. Inside the cloud there are several Virtual Machines VMs running on each physical machine. Each of these VMs is capable of running various detection registration. and tracking algorithms. The computation consuming registration algorithm is usually run by several threads in one or more VMs. The other major contribution is that a non real time algorithm achieves real time performance based on the application of a cloud computing infrastructure. The processing speed is improved by parallel implementation and elastic resource usage of cloud computing.

Referring to and the existing feature descriptors including SIFT Scale Invariant Feature Transform SURF Speeded Up Robust Features and Harris Corner pose feature challenges as far as the real time aspect is concerned due to their computational complexity. To have a more computationally efficient matching the active learning histogram is adopted in the present invention. In the present invention the color depth of hue component in HSV is set to 0 to 255 and they are divided into 16 bars with the same step width which means each bar has 16 color bits. The two figures respectively represent two typically colored e.g. Silver and Red pixel distributions in Hue component space. The color distribution of the template histograms is considered as 16 component vectors e.g. Silver 0 20 45 38 75 18 0 0 0 0 0 0 0 0 0 0 and Red 60 28 0 0 0 0 0 0 0 0 0 0 0 0 0 110 . The active learning of the histogram matcher is applied as 1 As can be seen in equation 1 the calibration to the template component histogram is performed in each frame by the weighted linear addition. The given Cis used to represent the current template histogram Ccan be considered for the strong candidate histogram. and are two weighting factors of the linear additive calibration. In the present invention is chosen as 0.9 and as 0.1 to update the current template Hue component histogram. The candidate histogram windows with the histogram are generated from the optical flow field between two aligned consecutive frames.

Referring to the three white blobs are generated from the optical flow field after image alignment and the bounding rectangles are considered as candidate windows. The candidate windows with the most similar Hue histogram are selected as the true target and these candidate Hue histograms are used to calibrate the current template histogram. As can be seen in the Figure there are three strong candidate windows in this frame. As expected the candidate on the right hand side matched with the red template and the one on the left hand side matched with the silver template while the one in the middle is ruled out because of the low similarity of the histogram with the template histograms. In the present invention the vectors consist of 16 consecutive numbers of the bars in the histogram are considered the color feature distribution of the windows. The Dynamic Time Warping DTW algorithm is used as the histogram matcher as this algorithm is capable of generating the dynamic distance between an unknown signal and a set of reference signals in a computational efficient manner. The sample signal comes from the vector of the current template histogram. Note that the introduced silver and red template hue histograms in the present invention is for general purpose matching in the sense that it is applicable to other color histogram matching.

Referring to an original RGB red green blue image for the visible reference is presented to the system operator. Note that the grayscale depiction of is presented for the purposes of the invention application.

Referring to depicts an exemplary flowchart which describes how the present invention works. In Step the dataset of images in frame available in the cloud was selected at the beginning of the flow. In Step a speech or voice command calls out the color desired of the target and was converted into a text input which is used to describe the feature of the targets. The text designation of the target is converted into a Hue representation using the gamut colorspace naming convention. In the present invention color distribution of the histogram is used to recognize and locate the targets of interest. In Step once the command has been given the detector as shown in the red box is initialized. The first step in the detector is image alignment Homography Matrices generation and registration. This step is the most computation consuming step thus it is applied in cloud and performed in a computational efficient manner. In Step based on the homography matrices and then the registered frames the optical flow field is generated. In Step morphology processing which includes a Closing and an Opening operation using a 3 3 square structuring element is applied on the optical flow field. The leftover blobs of the morphology processing are considered as strong candidate contours of the target. In Step the histogram templates of colors which are described in Step are used to match and recognize the valuable targets. In Step the tracker is initialized. In the present invention either a L1 tracker or a Compressive tracker are two options which are used to track the targets of interest. In Step based on the homography matrices generated from the cloud infrastructure in Step the prior tracks of the objects are projected in current frame . In Step in the event that the present invention cannot correctly locate the target the speech command or text input is fed into the system to redefine or relocate the targets of interest.

Referring to depicts a high level view of a host in the cloud system. XenServer serves as the Virtual Machine VM Manager or hypervisor of each physical server in the cloud. All components of the same task have access to a shared storage in the cloud. The user only interacts with the system through the Web GUI . The user s computing requests are delivered to controller for further processing. The controller assigns an appropriate number of jobs to VM Workers for each request. Each VM Worker runs one or more of the assigned tasks detector . tracker and register and sends the results to the controller. The web GUI will then display the processing result in real time once the backend processing starts. The Monitor uses a database to store real time performance of all tasks in the system. It also monitors the cloud s performance such as average CPU central processing unit load and memory usage. The user chooses what metrics to display on the web GUI and can call other visual analytic tools such as a rendering on a ground plane road network or 3 dimensional trajectory.

The interactive tracking module provides the options to choose various detectors. registers tracker algorithms and desired processing frame rates as parameters before the system initializes. Each combination of detector register tracker and frame rate consists of a configuration of the system. Once a configuration is chosen by the user the system will start to process the video sequence once the processing command is received from the web GUI. A target in the initial frame can also be manually or audibly identified by the user as an alternative to a detector that selects the pixel boundary representing the target.

In the target detection and tracking scenario the key components of the present invention perform the following tasks 

Web GUI. The web GUI communicates with the user by receiving input commands displays processing results and presents analytical system performance.

Controller. The Controller receives commands from the web GUI makes decisions on how many resources are needed to satisfy the required performance assigns jobs and tasks to virtual machines in the cloud combines processing results of different components into resultant frames calculates processing speed in real time and informs the web GUI processing results.

Monitor. The Monitor collects performance metrics such as processing speed and system load and provides a query service for the web GUI when there is a need to display these metrics.

Virtual Machines VMs . Each VM can act as a detector register or tracker in the system. The actual roles a VM will perform are decided by the Controller.

Referring to . the voice command tracking module is able to receive commands from the user s speech in real time. shows the overall data flow of this module. The system starts and enters Play Video displaying the video sequence on the web GUI. At the web GUI keeps checking if the current frame is the last frame. If it is the web GUI stops at the last frame otherwise it listens to any voice signal from the user at . The user triggers a voice command at any time before the last frame is displayed. When speech signals are received from the user s microphone the system first runs speech recognition to identify the command. If a command is recognized the command is sent to a detector running in the cloud entering detect . The matcher utilizes the speech command converted to text from which the text color designation is transformed into Hue space for matching with the detector processing the Hue of the pixels in the image. When there is a matched target a tracker will take over the execution at in coordinating with multiple registers determined by the Controller. The Controller will then combine processing results from trackers and registers and produce the resultant annotated video sequence . The web GUI will switch to display processed frames once the first processed frame is available. If there is no matched target in the current frame the web GUI will prompt a message to the user at and continue to display the next frame.

Referring to the web GUI displays the system output when the user triggers a voice command to track the silver car in the video sequence. There are three windows and in . Window displays the original frames when no voice command is received. Once a voice command is triggered the frames in this window will be replaced by processed frames with rectangle box on the target. On the right side of the video frame is the optical flow window synchronized with the current video frame. Window is the histogram of current frame used by the detector to detect the target. The web GUI also supports a User Defined Operating Picture UDOP reconfigurable display.

Referring to an instance of the System Monitoring Module or the dashboard on the web GUI is shown. Upon entering the dashboard page the user can choose one or more metrics provided by the monitor to be displayed. The selected charts are then created on the fly by the web GUI. Once all charts are created the web GUI starts to query with the monitor and retrieve all data for each chart. In the charts and provide real time monitoring metrics the user chose updated every five seconds. Chart depicts the Cloud host average CPU utilization which is an indication of the fulfillment of service level agreement SLA . Chart illustrates the real time processing performance the frame per second fps processing rate. As a baseline the fps of all algorithms running on a single machine are provided. Chart shows the number of register threads processes running when executing the task.

As the homography matrices of the frames are generated from the cloud infrastructure based image alignment the rotation and translation matrices derived from homography matrices makes the integration of the whole image sequence possible. Thus prior tracks of the objects are projected into current frame. The homography matrix H generated from image alignment consists of 9 components.

Since the airborne transformation between frames are not only affine but also projective the geometric transformation can be represented by a matrix from

Referring to . the registered tracks are displayed in the current frame which record the motion curves of the objects of interest. In the present invention two registration algorithms are applied RANSAC RANdom SAmple Consensus and LMEDS Least MEDian of Squares . The tracks of RANSAC are shown as light dots while the ones using LMEDS are shown in darker lines one track for each target . At the beginning of the work flow one of these algorithms is selected to align the image sequences.

Having described preferred embodiments of the invention with reference to the accompanying drawings it is to be understood that the invention is not limited to those precise embodiments and that various changes and modifications may be effected therein by one skilled in the art without departing from the scope or spirit of the invention as defined in the appended claims.

