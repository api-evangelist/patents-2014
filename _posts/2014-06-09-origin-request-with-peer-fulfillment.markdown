---

title: Origin request with peer fulfillment
abstract: A method of servicing content requests in a CDN may include receiving a request for content from a first client device, identifying content associated with the content request, identifying a second client device that stores the content, identifying a CDN storage location that also stores the content, determining whether the second client device is authorized to source the content to the first client device, and selecting a source for the content. The source for the content may be selected from the storage location associated with the CDN and the second client device. The source for the content may be selected based on one or more CDN policies. The method may also include initiating a transfer of the at least a portion of the content from the second client device to the first client device if the second client device is selected as the source for the content.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09100463&OS=09100463&RS=09100463
owner: Limelight Networks, Inc.
number: 09100463
owner_city: Tempe
owner_country: US
publication_date: 20140609
---
This application is a continuation in part of U.S. patent application Ser. No. 13 750 744 filed Jan. 25 2013 now U.S. Pat. No. 8 775 611 entitled ORIGIN REQUEST WITH PEER FULFILLMENT which is a continuation of U.S. patent application Ser. No. 13 214 124 filed Aug. 19 2011 now U.S. Pat. No. 8 396 980 entitled ORIGIN REQUEST WITH PEER FULFILLMENT which is a continuation of U.S. patent application Ser. No. 12 265 647 filed Nov. 5 2008 now U.S. Pat. No. 8 090 860 entitled ORIGIN REQUEST WITH PEER FULFILLMENT which claims priority to U.S. Provisional Application No. 60 985 590 filed Nov. 5 2007 entitled END TO END DATA TRANSFER. Each of these applications is incorporated herein by reference for all purposes.

This application is also a continuation in part of U.S. patent application Ser. No. 13 848 868 filed Mar. 22 2013 entitled ROUTING UNDER HEAVY LOADING which is a continuation of U.S. patent application Ser. No. 13 102 941 filed May 6 2011 now U.S. Pat. No. 8 422 376 entitled ROUTING UNDER HEAVY LOADING which is a continuation of Ser. No. 11 461 173 filed Jul. 31 2006 now U.S. Pat. No. 7 961 625 entitled ROUTING UNDER HEAVY LOADING which claims priority to U.S. Provisional Application No. 60 761 582 filed Jan. 23 2006 entitled ROUTING UNDER HEAVY LOADING and is also a continuation in part of U.S. patent application Ser. No. 11 195 247 filed Aug. 1 2005 now U.S. Pat. No. 7 706 280 entitled HEAVY LOAD PACKET SWITCHED ROUTING. Each of these applications is incorporated herein by reference for all purposes.

This application is also a continuation in part of U.S. patent application Ser. No. 13 780 573 filed Feb. 28 2013 entitled INTELLIGENT CONTENT STREAM BANDWIDTH DETERMINATION which is a continuation of U.S. patent application Ser. No. 13 564 486 filed Aug. 1 2012 now U.S. Pat. No. 8 402 160 entitled INTELLIGENT CONTENT STREAM BANDWIDTH DETERMINATION which is a continuation of U.S. patent application Ser. No. 12 563 660 filed Sep. 21 2009 now U.S. Pat. No. 8 250 232 entitled INTELLIGENT CONTENT STREAM BANDWIDTH DETERMINATION which claims priority to U.S. Provisional Application No. 61 098 521 filed Sep. 19 2008 entitled INTELLIGENT CONTENT STREAM BANDWIDTH DETERMINATION. Each of these applications is incorporated herein by reference for all purposes.

This application is also a continuation in part of U.S. patent application Ser. No. 13 595 904 filed Aug. 27 2012 now U.S. Pat. No. 8 750 155 entitled CONDITIONAL PROTOCOL CONTROL which is a continuation of U.S. patent application Ser. No. 12 572 981 filed Oct. 2 2009 now U.S. Pat. No. 8 274 909 entitled CONDITIONAL PROTOCOL CONTROL which is a continuation of PCT US2009 038361 filed Mar. 26 2009. Each of these applications is incorporated herein by reference for all purposes.

This disclosure relates in general to network delivery of data and but not by way of limitation to transfer of content in unique ways.

Traditional data delivery using the Internet falls into two broad categories namely traditional origin download and end user originated download. Either type of download can be used for content delivery such as file uploads and downloads or streaming delivery. In a traditional origin download a centralized server such as an origin server a traditional content delivery network or a traditional cache operates as a source of the content for the end users. In a user originated download one end user sources content to another end user.

In early user originated download systems often referred to as first generation peer to peer P2P content delivery systems when an individual end user seeks to find content available from its peers the end user logs into a central indexing server. The requesting end user consults a tracker function within a central indexing server that serves as a file directory of content available from sourcing end users. Once a sourcing end user offering the requested content is identified the actual content transfer occurs directly between the requesting and sourcing end users.

User originated download is controversial for many reasons. There is a perception that user originated download fosters copyright theft. In addition internet service providers ISPs dislike user originated downloading because of the high level of resource utilization it imposes on the ISP system and the difficulties associated with managing an increased flow of data. Not withstanding these issues user originated downloads continue to become more popular among end users to support applications such as Internet telephony file stream transfer and Internet television.

Many ISPs have attempted to regain control over the resource utilization of their network infrastructure by attempting to identify and regulate user originated downloads. Some have resorted to traffic throttling or shaping to slow down or eliminate resource utilization.

However second generation user originated download systems also known as decentralized P2P systems have eliminated the need for a central server. In such a system peers send search queries to other peers. If a peer cannot service a request it forwards the query to other peers until the requested information is found. When the information is found the initiating peer receives the download directly from the peer with the information. Using these and other techniques the second generation user originated download systems seek to evade the network restrictions by impeding the ability of the ISP to detect P2P traffic as there is no central indexing server.

Third generation hybrid user originated systems also known as hybrid P2P systems operate between a centralized directory structure and a distributed structure. The networks use super nodes which act as mini central servers to keep the network distributed while reducing the time required to identify the holder of requested content. These super nodes are typically unaware that they have been selected to act as such. Often the third generation user originated download systems also seek to evade the network restrictions by impeding the ability of the ISP to detect the P2P traffic.

There is a long tail theory that suggests obscure content is difficult to deliver to end users efficiently. Caches are efficient at delivery of commonly requested items but rarely store obscure content. Often obscure content must be sourced from the origin server if still available. Where an end user has the obscure content depending on the delivery suitability of that user user originated download can serve to source the content to another end user without going back to the origin server. This type of efficient transfer benefits both the end user and the ISP.

In some embodiments a method of servicing content requests in a Content Delivery Network CDN may be presented. The method may include receiving a request for content from a first client device identifying content associated with the content request and identifying a second client device that is in communication with the CDN. The second client device may store at least a part of the content. The method may also include identifying a storage location associated with the CDN that also stores the at least a portion of the content. The method may additionally include determining whether the second client device is authorized to source the at least a portion of the content to the first client device and selecting a source for the content to be provided to the first client device in response to the request for content. The source for the content may be selected from the storage location associated with the CDN and the second client device. The source for the content may be selected based on one or more CDN policies. The method may further include initiating a transfer of the at least a portion of the content from the second client device to the first client device if the second client device is selected as the source for the content and initiating a transfer of the at least a portion of the content from the storage location associated with the CDN to the first client device if the storage location associated with the CDN is selected as the source for the content.

In some embodiments a server in a Content Delivery Network CDN for servicing requests for content may be presented. The server may include one or more processors and one or more memory devices comprising instructions which when executed by the one or more processors cause the one or more processors to perform operations including receiving a request for content from a first client device identifying content associated with the content request and identifying a second client device that is in communication with the CDN. The second client device may store at least a part of the content. The operations may also include identifying a storage location associated with the CDN that also stores the at least a portion of the content. The operations may additionally include determining whether the second client device is authorized to source the at least a portion of the content to the first client device and selecting a source for the content to be provided to the first client device in response to the request for content. The source for the content may be selected from the storage location associated with the CDN and the second client device. The source for the content may be selected based on one or more CDN policies. The operations may further include initiating a transfer of the at least a portion of the content from the second client device to the first client device if the second client device is selected as the source for the content and initiating a transfer of the at least a portion of the content from the storage location associated with the CDN to the first client device if the storage location associated with the CDN is selected as the source for the content.

Further areas of applicability of the present disclosure will become apparent from the detailed description provided hereinafter. It should be understood that the detailed description and specific examples while indicating various embodiments are intended for purposes of illustration only and are not intended to necessarily limit the scope of the disclosure.

In the appended figures similar components and or features may have the same reference label. Further various components of the same type may be distinguished by following the reference label by a dash and a second label that distinguishes among the similar components. If only the first reference label is used in the specification the description is applicable to any one of the similar components having the same first reference label irrespective of the second reference label.

The ensuing description provides preferred exemplary embodiment s only and is not intended to limit the scope applicability or configuration of the disclosure. Rather the ensuing description of the preferred exemplary embodiment s will provide those skilled in the art with an enabling description for implementing a preferred exemplary embodiment. It is understood that various changes may be made in the function and arrangement of elements without departing from the spirit and scope as set forth in the appended claims.

Throughout this document the terms content delivery and content download are used and can mean either file download or streaming delivery. Additionally a content object can be either a file or a stream. For example the content object could be a voice call stream a video stream an image file a music file a live concert an animation an advertisement a web page a slide show data file executable software or the like.

Referring first to a block diagram of an embodiment of a data transfer system is shown. The data transfer system allows end users in home networks or business networks to request and source content downloads from to other end users directly. The end user sometimes simply called a user is typically a personal computer but may be any user controlled device capable of communicating over the Internet such as by way of example a handheld device media player mobile phone or supercomputing terminal. In some cases an end user may include a networked set of end users.

In addition to data transfer from end user to end user the data transfer system shown in also allows for traditional origin download between the end user and a content provider . A content object may be referenced in a variety of protocols. For example a universal resource locator URL could reference a content object available from the content provider. In many cases a content provider contracts with a content delivery network CDN to outsource delivery of content objects. A CDN is a system of computers networked together across the Internet that cooperate transparently to deliver content often for the purpose of improving performance scalability cost efficiency and the like. For example a large on line photo processing enterprise with a global footprint may contract with a CDN to distribute the functionality of the user interface to various worldwide locations to speed the response to a query by the end user. In such cases both the content provider and the CDN are motivated to use the CDN network efficiently to further increase performance. In one aspect the configuration shown in may be used to this end.

Although many network configurations are possible for illustrative purposes in we assume that content provider has contracted with a CDN. According to the exemplary embodiment shown in the CDN controls a global resource authority and a control layer database as well as a dispatcher content database and a client database each of which is discussed further below. In other embodiments these blocks could reside with and be controlled by an ISP or other entity.

Often especially when the size of some of the content downloads is expected to be quite large the content provider transfers to the receiving end user a download manager or client. A download manager is a software program which performs the task of downloading and sometimes uploading content from and sometimes to the Internet for storage. The typical download manager at a minimum provides means to recover from errors without losing the work already completed. Sometimes a download manager provides other functions such as splitting the content file to be transferred into two or more segments which are then transferred in parallel potentially making the process faster. According to one aspect the download manager may also include control layer software as described below.

According to one aspect a control plane of the global resource authority regulates which download managers or clients in the home and business networks can request and source a particular content object and under what conditions those clients may do so. The global resource authority includes policies to enable control of the behavior and activities of the clients in the home and business networks . According to these policies the clients can receive and request content globally or within some limited scope or can be prohibited from either sourcing or receiving altogether. In one aspect the global resource authority is under the control of a CDN. In another aspect the global resource authority may be under the control of an Internet service provider ISP a content provider and or other entity.

For example in one aspect control layer client software is transferred to the end user to enable the control plane. For example the client software may be transferred from the global resource authority the content provider the ISP or another end user. If transferred from a content provider the transfer may occur in association with the installation of a download manager. If transferred from an ISP or global resource authority the transfer may occur when a new end user is coupled to a home or business network for the first time or as part of software distributed at the time an end user initiates service from the ISP . The client can be used in conjunction with other elements to provide efficient download of content according to the control plane policies.

In one aspect the client transfers status information and control layer settings to the global resource authority which may also receive status information and control layer settings from other entities such as ISP content provider or both. The global resource authority uses the status information and control layer settings to determine a set of policies which for example control content transfer over the network. The status information and control layer settings may be stored in the control layer database along with the resulting policies.

The ISP aggregates users to provide access to private wide area networks WANs and the Internet. Generally the users of ISPs fall into two categories users who control a specific IP address space such as business networks end users who do not control a specific IP address space such as home networks . Some ISPs tend to specialize in one type of user or the other. Generally bandwidth used by home users is oversubscribed such that all users of the ISP cannot use the full bandwidth at times of heavy usage. Bandwidth for businesses can often be guaranteed to have a certain amount of bandwidth.

Users connect individual devices and or networks to the ISPs to receive Internet connectivity. Home and business networks often use a router to connect with the ISP using some sort of last mile technology for connectivity e.g. DSL cable modem WiFi WiMax satellite modem local communications circuit etc. . Home networks may have a number of computing devices all sharing the Internet connection e.g. personal digital assistants PDAs laptops VOIP UMA phones IP TV set tops desktops Internet appliances alarm systems etc. . Business networks may have a number of computing devices all sharing the Internet connection e.g. user PCs web servers email servers etc. and may also have leased lines between various locations or VPN tunnels to tie various business networks together. In the depicted example the first business network has a connection with the second business network .

The ISPs interact with other ISPs and backbone providers to allow their users full route access to the Internet . This may involve purchase of connectivity from Tier 1 providers peering arrangements with other ISPs or both. In the depicted example the first ISP has a peering relationship with the second ISP such that traffic can pass directly and typically at a reduced cost and or latency between the two ISPs to avoid the additional network distance inefficiency time delay cost and the like associated with using a Tier 1 provider to pass traffic between the first and second ISPs . Although not shown an ISP can have subnetworks such as for servicing a specific geographic region or for other reasons. Peering may occur in one region of an ISP and not another.

According to one aspect the dispatcher provides a centralized server which may store an indication of a client s availability and status control layer settings and policies current activity state or a combination of these and like parameters. The dispatcher may also include information with respect content from origin servers. An origin server is any server cache etc. which is used to service a request for content in a conventional non point to point fashion. The dispatcher may operate according to control layer policies which may for example be stored in the client data base . In addition the dispatcher may be associated with the content database which serves to store information regarding available sources of content in some cases both end users and origin servers as well as in some embodiments frequently requested user originated or origin server content.

In one embodiment the dispatcher may satisfy a traditional origin download request with an end user originated download. For example the dispatcher determines whether the requested content should be sourced from another user or retrieved form the content provider or other origin server. In some systems the dispatcher may always favor download from another user rather than the content provider . Other embodiments the dispatcher only initiates user originated download when such a transfer is likely to have an advantage such as a quality of service QoS advantage an increased data rate a more efficient use of system resources a better cost structure and the like.

In one embodiment the dispatcher may include a subset of the policies from the global resource authority to control the content delivery. Another embodiment the dispatcher may include the policies from the global resource authority . The policies may be set according to one or more control layer settings and serve to manage content delivery to from and between clients.

According to one aspect the dispatcher can uniquely identify a client and associate the client with the relevant control layer policies. A client can be programmed to check in periodically or when its address changes such that the dispatcher can continue to properly identify the client. In another embodiment the client identifies itself to the dispatcher whenever a directory listing or content object is requested by the end user or from the end user.

In one embodiment a client database stores location information and applicable control layer settings or resulting policies for the clients either individually or in groupings such as by network identifier. When responding to a request from a client the location information status information and policy information in the client database is used by the dispatcher to determine an appropriate source for the requested content.

In one embodiment a client periodically reports the content available to be sourced to the dispatcher . The content database stores the information to indicate the content objects available within the system. The system uses the client location information status information available content information and the control layer policies to determine how a requesting client should get content objects including determining what other clients are potentially available to serve the object to the requesting client.

Although the embodiment shown in uses a centralized directory in the dispatcher other embodiments could allow one client to directly interact with other clients and or super node clients to determine the content available for download. In these embodiments the control layer policies could be implemented by the individual or super node clients. For example the global resource authority determines the policies from the various control layer settings status information and the like and then distributes the policies to the other clients super nodes or both. Alternatively input from the multiple tiers in the control layer may report directly to the appropriate client or super node which could then determine the resulting policies. The policies could be presented to other clients.

According to an aspect in which the global resource authority determines the control plane policies the global resource authority receives control layer information from various sources. The control layer database stores this information. Additionally the various control layer settings are parsed according to a hierarchy. Multiple tiers of the control plane are allowed to influence the control layer according to a predetermined hierarchy where typically the lower level tiers take precedence over higher level tiers. The final set of policies is determined for the clients honoring settings associated with entities of higher priority over settings associated with entities have a lower priority. In one embodiment one or more of the combined policies is set to the most restrictive setting received from any entity. The policy information is communicated to the dispatcher for storage in the client database as illustrated in .

Referring next to a block diagram of an embodiment of the ISP coupled to a user . It is to be understood that a typical configuration would include a number of users coupled with a number of ISPs . The user in this embodiment could be a home network or business network . Although not shown the user may have multiple ISPs or additional ways outside of its local area network LAN .

 An Internet component is any component which is part of the data transfer system . As such each of the entities shown in may be the referred to as an Internet component. The Internet component shown in can be implemented using standard hardware and software modules and techniques which are further configured to operate according to the principles described herein. Except for the possible manual entry of one or more of the settings in typical implementations the functions of the data transfer system are largely executed using equipment and software. In many cases the status and actions of the various hardware and software modules may be displayed for a human observer. For example technical personnel may monitor the settings and policies associated with data transfer as well as the various database content. Similarly a human operating an end user device is typically presented a visual representation associated with setup and operation according to the principles described herein.

 A network component is a component which plays a role in transferring data to and from an end user device. The global resource authority the control layer database the dispatcher the content database the client database the content provider the local resource authority the server engine and the associated client a corresponding content delivery network the Internets are examples of network components. The clients and user devices are not network components.

The user has a number of computing devices . The computing device includes a client that allows both end user originated download and sourcing as well as traditional origin server download. Typically the client is implemented in software that runs on the computing device although other implementations are also possible. The client can be part of the operating system layer device driver layer download manager or application layer. In one aspect an application programming interface API to the client allows any number of applications to access and to influence the control layer settings and status of the client . The computing device the client and the application are one embodiment of an end user. Typically a router bridges the LAN of the computing devices to the ISP network .

This embodiment of the ISP includes one or more server engines but other embodiments could include none. The ISP network is coupled to one or more full route internet providers not shown. Server engines increase the likelihood that content objects are found in the ISPs network without having to go back to the content provider . In one aspect the dispatcher and content database are cognizant of the content stored in the server engine and can route appropriate requests thereto. In another embodiment the ISP network such as for example by way of the local resource authority intercepts requests for content which is stored in the server engine .

In the embodiment shown in the ISP includes such a local resource authority to collect select and process the control layer information. The local resource authority operates within a limited network and performs locally a similar role as the global resource authority . For example the local resource authority may receive status and setting information the clients . It may also operate to implement the control layer settings associated with the ISP .

Control layer settings can be provided to the local resource authority from a number of sources in various embodiments. For example various applications the client the user and the ISP each can have control layer settings and status in one embodiment. In one aspect the local resource authority processes the various control layer settings and provides the resulting settings policies status and the like to the global resource authority .

The server engine also has a client for tracking status and settings. According to well known techniques a cache within the server engine is populated based on user requests for content or other parameters. Once the cache of the server engine has content the server engine can act as another end point that can source content to the end user clients such as requested by the dispatcher in response to either an origin or end user request. In addition to traditional cache functions the server engine in conjunction with local resource authority may perform at a local level some of the same functions as the dispatcher such as directing the satisfaction of a traditional origin download request with an end user originated download. In some embodiments the server engine may be a preferred source for content as compared to other possible sources in one embodiment. Some embodiments allow one server engine to query other server engines and or end users to request content not currently found in the cache.

The ISPs and business networks can indicate through their respective control layers the extent to which the clients using their network can serve content objects to other clients in varying relationships with their network. The control layer settings may be based on the relationship between networks such as peer relationships intra ISP relationships metro sub net relationships business sub net relationships and or unrestricted relationships. IP addresses a range s of IP addresses or domains could be used to specify the relationship between any particular business network ISP user base or the like.

Referring to the example of Table I an exemplary set of relationships between end point networks is specified. These relationships may be reflected in the global resource authority the control layer database and content database such that the scope of a client s sharing space can be determined. In one aspect this information is also reflected in the local resource authority . The control layer settings such as the type typically specified by the ISP the networks indicate the allowed transfers between entities based on their relationship. Together the peer relationship and the related settings determine the policies by which transfers are governed by the dispatcher .

For example according to Table I for user originated download the ACME ISP peers with three other ISPs and therefore may have control layer settings which allow end user content download intra network such that a client in a network of the ACME ISP can source content directly within the ISP network and to any of the indicated peer networks. The Foo ISP has an open relationship with all other providers and thus allows its clients to receive user originated downloads from or source user originated downloads to any client on the ISP network or Internet . The Atlas ISP has no end point relationships and prohibits the clients from performing user originated download and thus limits its clients to performing origin downloads. The Open ISP has an open end point relationship and allows its clients to exchange user originated content over any other ISP that allows its clients to exchange user originated content to and from the Open ISP network. Speedy ISP has relationships with and allows peering with the ACME ISP the TTC Denver business and intra network. The TTC Denver business sub net may allow user originated download to another business sub net affiliated business or other network groups. Specified on another line of Table I the TTC Denver business allows user originated download with the TTC business entity.

Business networks can specify the scope of user originated download acceptable for its clients in other ways. Large Corp only allows user originated exchanges within its network. The network could be defined to be one or many different locations by specifying the relevant IP addresses or other network information. The business networks could be specified in according to several schemes such as by breaking out IP addresses or other network information into separate groups or including other IP addresses or other network information in a particular group. According to typical contractual relationships ISPs for businesses generally avoid further restriction on how a business decides to participate in user originated download because the Internet service is sold to the business in an unrestricted manner so that the business to choose how best to utilize the allocated bandwidth.

Some embodiments of the server engine allow pre populating the server engines with content likely to be requested. Use of a server engine s can reduce the use of connectivity to the Internet or within its network by the ISP to gather requested content. The dispatcher or the server engine itself could decide which content objects are likely to be requested such that the cache can be pre populated. Content providers can also specify what is likely to be requested. In some embodiments the content providers could purchase or lease space on the various server engines such that their content objects are delivered with higher QoS.

Use of the server engine s can be controlled by the ISP that has been allocated particular server engine capacity. Use of the server engine can be limited to the clients within the ISP network . Additionally other networks can be given access to the server engines in some embodiments. In one embodiment server engines are controlled through the local and or global resource authority by specifying settings such as those specified for clients in a similar manner as discussed above with respect to Table I.

With reference to a diagram showing an embodiment of a multi tiered control plane is shown. At the top of the diagram the application layer is where the application s reside that uses the client . The applications have configuration options that indicate how the client can be used. A particular layer on top of the diagram can have their control settings overridden by any layer below one hierarchy scheme. For example the application layer may specify that twenty simultaneous responses to requests for user originated downloads are allowed at one time but the client control layer specifies only four outbound user originated downloads may be executed at the same time. Because the application layer is trumped by the client layer only four outbound user originated downloads can be executed at any moment between the applications using the client . Thus the control layer settings sent by the client to for example the global resource authority specify a maximum of four simultaneous uploads or downloads.

In one aspect as shown in the settings for the application layer the client control layer as well as the account control layer are sent to the global resource authority and stored in the control layer database . The global resource authority then determines the policies based at least in part on the settings. In another aspect the client processes the control layer settings of which it is aware and sends the combined result to the global resource authority . The global resource authority then determines the policies based at least in part on the combined settings. In yet another aspect the client sends either the combined or raw control layer settings the local resource authority which in turn combines them with other local settings of which it is aware and sends the resulting combined settings to the global resource authority . In any case the resulting policies are transferred to the dispatcher which stores them in the client database . The dispatcher uses the policies to determine the actions which are taken in response to a request for content.

In the embodiment shown in there are four layers that control the user originated download. The client layer can alternatively do a conventional origin download using a conventional network control structure or preferably used the ISP control layer and the system control layer . In one embodiment both origin server and end user originated requests are sent to the dispatcher so that origin server request can be serviced in a point to point manner if appropriate and based on the policies implemented by the dispatcher . In order of hierarchy the application layer the client layer an ISP control layer and a system control layer are shown. Each layer can specify settings that would form the control layer policies influencing how a user originated download is performed in some embodiment. According to the embodiment shown in a lower layer takes precedence over a higher layer. Other embodiments may have more or fewer control layers or only one control layer.

Different parties can optionally designate the control settings at the various layers. For example the user may be able to modify options at the application and client layers . The ISP management can set overriding settings at the ISP control layer . The system administrators can set yet further overriding settings at the system control layer . Interfaces in the application client local resource authority and global resource authority could be used by the various parties to enter the control layer settings.

Table II indicates examples of the things that could be part of the control plane for the application layer in one embodiment. The application could specify individually the particular control setting desired. Different applications could have different desired control settings. The application can specify if user originated download is even allowed in addition to conventional origin download and which type is preferred. The maximum outgoing incoming bandwidth can be specified along with the number of simultaneous outgoing incoming connections allowed. Further a minimum and or maximum delivery speed for the user originated downloads could be specified such that the download would switch to origin download or fail if that level of QoS were no longer available.

Table III specifies certain control settings for the control layer of the client layer . These control settings would apply to applications in the higher application layer . In this example the control settings for the client layer are similar to those of the application layer . Additionally the client layer can specify whether central dispatch is used for content directories if the clients themselves hold the directory of available content objects. The number of applications that can simultaneously use the client is also specified in this embodiment.

Table IV specifies the control settings an ISP layer can specify for the users in their defined address space. In addition to some of the control settings for the other layers the ISP control layer allows defining the scope of clients that can request user originated download of content objects like what was globally defined in Table I above. The ISP can specify the divisions allowed within their address space and how any server engines can be used. One embodiment allows the ISP to control and update the content delivery in over time such that the dispatcher can reflect these updates. The ISP may determine where an end user can download the requested content according to the system availability control of unlicensed content and status of the other end users or server engines .

At the system control layer additional control settings can be specified. For example directory listings can optionally be limited as specified by the control layers. As such the system uses the control layer to avoid use of the system to transfer content that the copyright holders would disapprove of. Additionally content filtering could be optionally activated or enabled for only certain groups that use the system .

An example system control layer is depicted in Table V. For this example the directory listing is limited by the control layers. Application client business ISP and sub net control layers are provided for in this example. Where there is protected content meaning that the copyright holders would not allow sharing with other end users the system could filter out those files from appearing in directory listings. This example allows sharing of downloading processing storage VOIP and streaming among clients .

Referring next to a diagram showing another embodiment of a multi tiered control plane is shown. This embodiment includes an account control layer and an ISP metro control layer between the client and ISP control layers . The account control layer allows the ISP account holder to specify control settings. For example a parent in a home network could specify control settings for the children in the home network. The ISP metro control layer allows different geographic locations or groups of an ISP to be individually controlled. For example one group may have higher bandwidth such that a higher amount of user originated download can be tolerated.

With reference to a diagram showing yet another embodiment of a multi tiered control plane is shown. In this embodiment the applications in the application layer determines if origin download or user originated download is to be used for a particular content object download. For the control layers for user originated download there is an enterprise control layer that allows businesses to specify control settings.

In comparison to control layer settings status information might change more frequently. For example based on the control layer settings a policy with in the client layer control plane at the client may prohibit servicing end user originated download requests when a VoIP call is in progress. Such a policy would likely result in the status of the client changing on a frequent basis. For example whenever a VoIP call is begun the control layer in the client indicates to the global resource authority the local resource authority or both that the client is currently unavailable to service end user originated downloads. The global resource authority may send a corresponding notification to the dispatcher . Likewise the local resource authority may send a corresponding notification to the service engine .

Status information may also be forwarded by the ISP . For example if the ISP is experiencing a period of high congestion it may send an indication to the global resource authority to prohibit its end users from servicing end user originated download requests.

Status information may also include information with respect to the location of the computing device . The location of a client may change if the associated computing device is moved geographically or if it is connected to the network via an altered path. In one embodiment location information is periodically reported and or in response to a change in location.

Referring next to an embodiment of a process for performing user originated download is shown from the perspective of a content delivery network operating the global resource authority the control layer database the dispatcher the content database as well as the client database . The depicted portion of the process begins in block where control layer settings are received from various tiers that are defined for a particular client . In the embodiment shown in the control layer database holds the control settings and resulting policies for the clients . Status information for the clients is reported in block and received for example by the client database . In block the content objects available from the clients are updated typically in response to a polling inquiry or by periodic or sporadic reporting. In one embodiment the content database performs block . The original location of the content objects may also be stored such that the content provider can be queried for the content object if there is a problem getting the content object from another client.

Processing continues to block where a request for content is received from a client . Alternatively the requesting device could be on a computing device a server engine or other entity. The request is processed with reference to the policies of the requesting and sourcing entity status and content database in block . As such the content objects available in response to the request are determined.

A determination is made in block as to whether the content should be downloaded from another client or retrieved form the content provider . For some requests the process may favor download from another client rather than going back to the content provider even if the original request was made to a origin server. For example user originated download may be favored when service from another end user would provide better network performance QoS efficiency or the like. The determination in block could be variously made by the dispatcher the client super node or application as well as other entities or combinations thereof. Where the content originates from another client processing flows from block to block in which information is sent to the requesting end user regarding one or more end users which are capable of servicing the request. In one embodiment the dispatcher performs block . Where the content is to be sourced from an origin server processing goes from block to block in which the content object is requested from the content provider using conventional origin download. In one embodiment the dispatcher performs blocks and .

Thus data transfer system expressly shown in one instantiation in is configured to allow content download between end user devices such as for example computing devices . The data transfer system has a first client associated with a first device capable of communication over the Internet and configured to provide a first setting from which a first set of potentially eligible sources can be determined as described herein. According to one of many examples which could be developed the first client communicates with the Internet using the ISP network the router and the LAN . One possible setting which the first client may specify is that it accepts content only from sources having a data transfer rate of 300 kbps or higher. Such a setting may render some possible sources ineligible to provide content to the first client . In such a way the first setting is one aspect that indicates a set of potentially eligible sources. Of course the data transfer system also includes many other client stations such as the second client which are capable of communication over the Internet.

As described above the data transfer system includes multiple entities which may provide settings. For example a network entity such as for example ISP may be configured to provide a second setting from which a second set of potentially eligible sources can be determined. For example the network entity may specify a setting which limits the maximum transfer rate for point to point data transfer to 50 kbps in order to better manage the burdens imposed on the system by point to point traffic. In one embodiment the data transfer system receives the first and second settings as well as a request for content from the first client. The data transfer system determines a policy based on the first and second settings. The policy allows determination of a set of eligible source devices. In one embodiment the data transfer system honors the network entity setting over the client station setting and thus determines the set of eligible source devices to include only those capable of transferring data at 50 kbps or less. In another embodiment the data transfer system selects a policy which satisfied the most restrictive setting. Other more complex processes are also possible.

Based on the request the data transfer system determines a subset of the set of eligible sources that have the content. In systems capable of point to point data transfer the subset often includes one more client stations such as second client . The data transfer system sends an indication of the second client as being an eligible source of the content to the first client .

Referring to a flowchart of an exemplary embodiment is shown. In block a first setting is received from a first entity indicating a first set of potentially eligible sources. In one example the client may specify that only sources with a delivery bandwidth of 1200 kbps are eligible sources for that particular client. In another example the ISP may characterize relationships between Internet components and specify the content sharing privileges associated with the various relationships. In block a second group of one or more control layer settings is received from a second entity. For example the content provider may indicate that a request for designated streaming content may be satisfied by sourcing the streaming content between clients having a specified relationship.

In block a request for content from a client is received. For example in one embodiment the dispatcher receives a request from a first client that may have previously provided or concurrently or subsequently provides control layer settings. In another embodiment another client or super node client may receive the request. Blocks and can be executed in any order.

In block one or more control layer policies are determined based on the control layer settings. Based upon the control layer policies a set of one or more eligible sources is identified. For example in one embodiment the eligible sources may be a group of end users having the requested content and having a specified relationship to the requesting entity as well as the ability to deliver the content to the requesting entity at a minimum specified data rate. In another embodiment one eligible source may be an origin server such as any server cache etc. which is used to service a request for content in a conventional non point to point fashion and may be the content provider .

In block a subset of the eligible sources that have the requested content are determined. For example in one embodiment such a determination is made by the dispatcher or a super node. In block an indication of one or more entities having the requested content within the set of eligible resources is sent to the client.

Referring to a flowchart of an exemplary embodiment is shown generally illustrating servicing a request for origin server content by way of an end user. A requesting entity generates a request for content that originates from a content provider. In block the request is received. For example the application requests a live sporting event streaming content. The client parses the request according to its local policies. The client sends the request to the dispatch . In block a set of eligible end user sources that are eligible to source the content are determined. For example in one embodiment the dispatcher receives one or more settings from the content provider indicating that client stations within a business network can share content in a peer to peer fashion. Likewise the dispatcher may receive like settings from a content delivery entity specifying that particular content may be shared in a peer to peer fashion. In block the transfer of content is facilitated. For example the dispatcher responds to the requesting entity specifying an end user from which to source the content. In this way a request for content from a content provider is serviced in a peer to peer fashion. For example if two end users within the business network each make a request to the content provider to watch the Olympics rather than establish two parallel streams the dispatcher facilitates the transfer from a second entity in the business network according to settings received from the content provider or the global resource authority .

Referring to a flowchart of an exemplary embodiment is shown including illustration of an aspect of the interaction between the application and client. In block one or more application settings are received. Each setting indicates the characteristics of a first set of potentially eligible sources or requesters. For example the client receives settings from one or more applications . A first application may limit the number of simultaneously outgoing end user downloads. Another application sets a minimum incoming data rate.

In block one or more client settings are determined as a function of the one or more application settings. For example the client may merge the application settings with client layer settings associated with the client to create the overall client settings. For example the client may determine internally created settings based upon control layer settings such as parental control settings. Typically the client honors the client layer settings over and above the application settings. As such the client may impose more restrictive settings thereby potentially decreasing the number of potentially eligible sources. However in some cases the client may expand the application settings thereby potentially increasing the number of potentially eligible sources.

In block a request for content is received by the client from a application . For example the requesting application may make a request for an MP3 download. In block information regarding a set of eligible clients is retrieved. For example the set of eligible clients may be determined based on the one or more client settings and one or more network settings from an Internet component remote to the requesting client . The set of eligible clients matches or is a subset of the set of potentially eligible sources. The information regarding the set of eligible clients may be retrieved from the dispatcher a super node a module within the end user device etc.

In block information regarding one or more specific sourcing clients from within this set of eligible clients is retrieved. The specific sourcing clients are capable of sourcing the requested content. In one embodiment such information is retrieved from the dispatcher a super node a module within the end user device etc. In block a request for the content is made. For example the client requests the content from one of the specific sourcing clients and passes the incoming data to the requesting application.

A number of variations and modifications of the disclosed embodiments can also be used. For example some of the above embodiments discuss use of an end user computer to source a download. The system could be used to allow use and control of other resources on end user computers. For example a user computer could be used for distributed computing at the control of the application client ISP and or system. Some embodiments could use the control plane to regulate machine virtualization of resources such as storage bandwidth and processing power. For example one end user could use another end user s hard drive to store their data.

While the principles of the disclosure have been described above in connection with specific apparatuses and methods it is to be clearly understood that this description is made only by way of example and not as limitation on the scope of the disclosure.

