---

title: Secure randomized input
abstract: A user inserts a received random sequence into the user's password or PIN. The user enters and transmits this randomized password to a service provider. The service provider extracts the password to determine whether to authenticate the user.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09356930&OS=09356930&RS=09356930
owner: PAYPAL, INC.
number: 09356930
owner_city: San Jose
owner_country: US
publication_date: 20140519
---
This application is a continuation of U.S. patent application Ser. No. 13 035 542 filed Feb. 25 2011 which claims priority to U.S. Provisional Patent Application Ser. No. 61 312 054 filed Mar. 9 2010 all of which are incorporated herein by reference in their entirety.

The present invention generally relates to user authentication and in particular to use of passwords for authentication.

With the ever increasing use of the Internet and other electronic communication more and more sensitive information is being communicated electronically. Such sensitive information may include social security numbers passwords date of birth mother s maiden name PINs account numbers etc. Fraudsters acquiring such information may result in identity theft unauthorized use of funds etc. Thus capturing this important information is one of the targets of hackers and malicious applications.

One of the easiest ways of mounting this attack is for the malicious application to listen to keystrokes and record the sequence of the keys that the user has entered. This is also known as a key logging attack. Protecting against key logging attack is a nontrivial task that demands deep modifications performed to the operating environment to ensure that the malicious listeners are detected and blocked. The problem becomes more difficult to solve when a sensitive piece of code that has security requirements such as protecting the user s credentials is running inside a non secure environment. The environment in this context is either another application or the operating system as a whole. The problem is equally applicable to personal computers PC that use a physical keyboard as well as devices that deploy a touch screen keyboard such as Apple iPhone pop up virtual keyboard or other data input means.

Sensitive information is often required to authenticate the user so that a service provider such as a financial institution or merchant can be reasonably sure the user is who he says he is. Without user authentication the transaction may not be allowed to proceed.

Therefore a need exists to provide the user a more secure way of entering and electronically transmitting sensitive information.

In one embodiment a user inserts a random sequence of letters numbers characters and or symbols into the user s password or PIN. The random sequence is generated from a system that will require authentication for access such as a payment provider financial institution retailer etc. The random sequence is transmitted to the user and displayed on a user device. During a log in process the user enters the user s password or PIN with the random sequence appended at the beginning or end of the password or PIN. The random sequence may also be inserted in the middle of the password such that the random sequence separates the password into two portions or broken up and inserted throughout the password. The password plus random sequence is then transmitted to the system authenticating the user. Because the transmitted password has a random generated sequence anyone intercepting the transmission without knowledge of the actual random generated sequence would not be able to determine the actual password.

Once received by the system the system knowing the random generated sequence can extract the sequence from the received transmission to determine the actual user password. The system can then use the password to authenticate allow access or deny access to the user.

In one embodiment the system generates a random sequence of characters which can be any length and any combination of letters capital or lowercase symbols numbers or characters. Each time a user whether it be the same or different attempts to log in or access content another random sequence is generated which can be of different lengths and types.

The random sequence is sent to the user such as through the device the user is using to access the system. The device may be a mobile device such as a smart phone a PC laptop or any communication device used to access content on a system.

The user is then asked to enter the received random sequence into the user s password. Note that the user can be requested to enter the sequence at a specific location e.g. at the end beginning or somewhere in the middle such as after the second character in the password . If the user is requested to enter the random sequence in a particular location this may vary each time the user attempts to log in or access content. For example one time the user may be asked to insert the random sequence at the beginning of the credential another time at the end and another time somewhere in the middle. Alternatively the user may enter the sequence anywhere in the password based solely on the user s discretion without specific guidance from the system.

The system then receives the password which includes the random sequence within the real password. The system determines the actual password by extracting the random sequence. If the credentials are sent in clear i.e. received in the same format as the user enters them then eliminating or extracting the random sequence will produce the actual password or credential. If the password is sent in hash format then the system could extract the password since it knows the correct has. If the password is sent as a function of the password plus random sequence the system could extract the actual password by applying a reverse or inverse function to the received password and removing the random sequence.

In other embodiments the system may ask the user to insert numbers characters symbols or letters if the user selected password is weak e.g. a user name or other easily determined identifier. This may make it more difficult for hackers to extract the actual password from an intercepted transmission having a random sequence embedded. The system may have checks that prevent a hacker from attempting multiple password entries e.g. after three unsuccessful attempts the user is not allowed to enter another password. This may help prevent hackers from simply trying different iterations of the intercepted transmission and guess what the actual password or credential is.

Since the system knows the random sequence algorithms can be put in place that detect when someone is trying to guess the password by taking out portions of the random sequence. This would increase security of the randomized password. The random sequence may be generated with knowledge of the actual user password. For example when the user attempts to log in or access content a user identifier such as a username email or phone number may be transmitted to the system. The system can then access that user s password. The random sequence generator can use this password to generate repetitions of the characters in the actual password thereby making it more difficult for a hacker to determine what is the random sequence.

In another embodiment a hash can be used for a quick lookup to determine whether a received password is authentic. For example if there are at most five characters in the sequence and say six characters in the password then there may be 30 5 6 password attempts. This could be optimized when the random sequence is generated. The system could create all the 30 possibilities and get a hash on the fly in memory and when the response is received get a hash and do a quick lookup. If there is a match then the user is authenticated.

Thus using the random sequence within a password to authenticate a user provides additional security from hackers. Any listener or hacker who receives the random sequence within the password without knowledge of the random sequence would not be able to determine the actual user password because the sequence is randomly generated.

These and other features and advantages of the present invention will be more readily apparent from the detailed description of the embodiments set forth below taken in conjunction with the accompanying drawings.

Embodiments of the present disclosure and their advantages are best understood by referring to the detailed description that follows. It should be appreciated that like reference numerals are used to identify like elements illustrated in one or more of the figures wherein showings therein are for purposes of illustrating embodiments of the present disclosure and not for purposes of limiting the same.

The indication may be received from the user s mobile device tablet PC laptop or other computing communication device through any suitable wired or wireless means including through the Internet phone channels NFC etc. In one embodiment the indication is conveyed by the user when the user first accesses the system s website such as by entering the URL of the system s home page such that the system is able to obtain information from the device such as cookies device IDs etc. Other ways include the user actively transmitting the indication such as selecting a login link or button and or entering a user identifier such as an email address phone number or user name. The user identifier enables the system to locate the user s password.

Next the system determines at step whether to generate the random sequence based on the user s password. The determination may include looking at characteristics or traits of the user s password including but not limited to its relative strength or weakness its length the type of characters used in the password or just system or user settings preferences. For example if the user s password is weak the system may want to generate the random sequence based on the password so that it is harder for the password to be extracted when combined with the random sequence. If the password is a recognizable name phrase or other sequence of characters adding in a random sequence may still make the password recognizable. Thus the system may want to generate a more specific random sequence based on the particular password to make extraction of the password more difficult. Examples will be provided later in the description.

If as determined at step the random sequence will be based on the user s password the system determines the user password at step . By knowing the user s identifier the system can typically obtain the user s password. If not the system may request the user for information that allows the system to obtain the password. Note that determination of the user password may take place before step . In that embodiment the determination of whether to generate the random sequence based on the user password may be based at least in part on characteristics of the user password.

Next the random sequence is generated at step by the system. If the random sequence is not based on the user password the random sequence can be completely random with random lengths and or random types or combinations of characters. The characters can be upper case letters lower case letters symbols numbers or characters. In one embodiment the characters include only what is available on a standard keyboard or keypad which makes it easier for the user to enter the sequence. Lengths may vary from one character to any number although there are practical limitations to the maximum amount. Also shorter length sequences may not be as secure as longer length sequences. One example show how difficult it could be to extract the actual password. Say the user password is mike R45jZ and the random sequence is k RU 9 . The combination of the two may be either k RU 9 mike R45jZ or mike R45jZ k RU 9 both of which would be very hard for someone to determine the actual user password from.

If the random sequence is based on the user password the random sequence is not entirely random. For example if user password is a recognizable word or phrase the random sequence may start or end with characters that make it harder for someone to know when the real password starts stops and when the random sequence starts stops. This can include adding repetitions of characters from the user password or inserting characters that still make portions of the password plus sequence recognizable. By illustration say a user password is mary120372 which is a relative weak password having a name and a typical calendar sequence maybe a date of birth or anniversary . With such a password the random sequence may be gray113475rose. Attaching this sequence to the beginning of the user password results in gray113475rosemary120372 making it more difficult to extract the original password.

In another embodiment with weaker passwords the system may use a specific first sub sequence and randomly generate a second sub sequence where the combination of the two sub sequences is the random sequence. Using the above example the first sub sequence may be rose and then the second sub sequence is completely random but always attached in front of rose. 

Once the random sequence is generated the system transmits the random sequence to the user at step . In one embodiment the random sequence is presented visually such as through SMS email or on a screen of the system e.g. the same or different screen where the user first accesses the system site on the user s PC laptop . The random sequence may also be presented audibly such as with an automated voice message to the user s phone mobile device or a voice file attached to an email sent to the user. Note that the random sequence need not be presented on the same device the user accessed the system site from. This results in higher security because the random sequence is sent to a separate known user device. Thus if a fraudster is attempted to access the user s account through a user device such as the user s PC the fraudster may not also have access to a separate user device such as the user s phone.

Along with or separate from the random sequence instructions if any are also transmitted at step to the user. Instructions may inform the user what to do with the received random sequence. For example the user may be asked to insert the random sequence at the beginning of the user s password and enter the result instead of the user s actual password. Other examples include inserting the random sequence at the end of the user s password or within the user s password. For the latter examples include inserting the sequence after the first character after the second character before the last character before the second to last character etc. The instructions may also be for the user to insert the sequence anywhere along or within the user s password.

After the user modifies the password with the random sequence as instructed the system receives at step the password plus random sequence or randomized password. Reception is typically accomplished by the user clicking on a link or button that causes a communication back to the system through the system site. However other means may also be suitable such as through another user device email text voice etc. The randomized password may be received in different forms. One form is clear text i.e. received in the same format as the user enters the randomized password . Another form is a hash value in which the randomized password is used in a hash function to return a hash value to the system. Yet another form is sequence obtained from using the randomized password as input to a function i.e. F randomized password . Other forms may also be suitable.

Once received the system extracts the actual user password at step using its knowledge of the random sequence and any other information. In the first form above the system looks for the random sequence within the randomized password and removes the random sequence thereby revealing the user password. In the second form above knowledge of the hash function and the randomized password allows the system to know what the expected hash value should be i.e. Hash randomized password . In the third form above knowledge of the function enables the system to apply an inverse function to the received data to obtain the user password i.e. F F randomized password .

After the password or equivalent is obtained the system determines at step whether there is a match. If the actual user password is extracted the system compares the extracted password with the password associated the user e.g. the user identifier . If the system receives a value such as through a hash the system compares the received value with the expected value where the known randomized password is used in the hash function . If the system receives a function the system applies the inverse function to obtain the randomized password.

If a match is determined i.e. the received data is what is expected for the user the system authenticates the user at step . The system may send a confirmation or successful notification to the user that the user has been authenticated. The system may then provide access to the site or any other suitable action. For example the system may allow the user to access his account view certain information make purchases etc.

However if the system determines there is not a match in step the may end the process and not authenticate or allow access to the user. In another embodiment the system may give the user additional attempts to be authenticated. If that is the case the system generates another random sequence at step and the same steps are performed as before. Note that even if the same session a new random sequence is generated each time the user attempts to authenticate. This provides additional security. If the system has not been able to authenticate the user after the predetermined amount of attempts the process ends without the user being authenticated.

Thus by having a user insert a random sequence within the user s password for authentication a system is able to authenticate a user while minimizing the risk that the user s password will be intercepted or otherwise obtained by an unauthorized system program entity or person.

In one use case the user may first need to be identified as human as opposed to machine. This can be accomplished in any number of ways. One way is to transmit a distorted image or phrase such as Captcha to the user. The user is then asked to enter the distorted image and transmit an undistorted image back to the system. If the received image matches or is what is expected the system verifies the user is human and proceeds with generating the random sequence as discussed above.

User device and payment provider server may each include one or more processors memories and other appropriate components for executing instructions such as program code and or data stored on one or more computer readable mediums to implement the various applications data and steps described herein. For example such instructions may be stored in one or more computer readable media such as memories or data storage devices internal and or external to various components of system and or accessible over network .

Network may be implemented as a single network or a combination of multiple networks. For example in various embodiments network may include the Internet or one or more intranets landline networks wireless networks and or other appropriate types of networks.

User device may be implemented using any appropriate hardware and software configured for wired and or wireless communication over network . For example in one embodiment user device may be implemented as a personal computer PC a smart phone personal digital assistant PDA laptop computer and or other types of computing devices capable of transmitting and or receiving data such as an iPad from Apple .

User device may include one or more browser applications which may be used for example to provide a convenient interface to permit user to browse search and access information available over network . For example in one embodiment browser application may be implemented as a web browser configured to view information available over the Internet. User device may also include one or more toolbar applications which may be used for example to provide client side processing for performing desired tasks in response to operations selected by user . In one embodiment toolbar application may display a user interface in connection with browser application .

User device may further include other applications as may be desired in particular embodiments to provide desired features to user device . For example other applications may include security applications for implementing client side security features programmatic client applications for interfacing with appropriate application programming interfaces APIs over network or other types of applications. Applications may also include email texting voice and IM applications that allow user to send and receive emails calls texts and other ways to communicate through network to payment provider server . User device includes one or more user identifiers which may be implemented for example as operating system registry entries cookies associated with browser application identifiers associated with hardware of user device or other appropriate identifiers such as used for user and or device authentication. In one embodiment user identifier may be used by a payment service provider to associate user with a particular account maintained by the payment provider as further described herein. A communications application with associated interfaces enables user device to communicate with payment provider server as well as other devices within system .

Payment provider server may be maintained for example by an online payment service provider which may provide payment services from user . Before using the services of the payment provider user may need to be authenticated first. This may be accomplished in part by an authentication application and a random sequence generator . Authentication application may be used to authenticate user when the user attempts to access information associated with the user s account with the payment provider make payments or use other services of the payment provider and other reasons in which the user must first be authenticated by the payment provider. Random sequence generator which may be separate or part of authentication application generates random sequences that are transmitted to user such as via user device for the user to insert within the user s password as discussed above. Random sequence generator may generate completely random sequences or pseudo random sequences based on the user password. In one embodiment each time a user is asked to enter a password a new random sequence is generated.

Recipients of user payments may be merchants charities retailers online marketplaces individuals etc. In this regard payment provider server includes one or more payment applications which may be configured to interact with user device over network to facilitate payments by user to others.

Payment provider server also maintains a plurality of user accounts each of which may include account information associated with individual users and merchants. For example account information may include private financial information of users of devices such as account numbers passwords device identifiers user names phone numbers credit card information bank information purchase code conditions or other financial information which may be used to facilitate online transactions by user . Advantageously payment application may be configured to interact with user during a transaction to make the appropriate payment to a desired recipient.

A transaction processing application which may be part of or separate from payment application may be configured to receive information from a user device for processing and storage in a payment database . Transaction processing application may include one or more applications to process information from user for processing a payment or other service. Payment application may be further configured to determine the existence of and to manage accounts for user as well as create new accounts if necessary.

Computer system includes a bus or other communication mechanism for communicating information data signals and information between various components of computer system . Components include an input output I O component that processes a user action such as selecting keys from a keypad keyboard selecting one or more buttons or links etc. and sends a corresponding signal to bus . I O component may also include an output component such as a display and a cursor control such as a keyboard keypad mouse etc. . An optional audio input output component may also be included to allow a user to use voice for inputting information by converting audio signals. Audio I O component may allow the user to hear and transmit audio. A transceiver or network interface transmits and receives signals between computer system and other devices such as another user device a merchant server or a payment provider server via network . In one embodiment the transmission is wireless although other transmission mediums and methods may also be suitable. A processor which can be a micro controller digital signal processor DSP or other processing component processes these various signals such as for display on computer system or transmission to other devices via a communication link . Processor may also control transmission of information such as cookies or IP addresses to other devices.

Components of computer system also include a system memory component e.g. RAM a static storage component e.g. ROM and or a disk drive . Computer system performs specific operations by processor and other components by executing one or more sequences of instructions contained in system memory component . Logic may be encoded in a computer readable medium which may refer to any medium that participates in providing instructions to processor for execution. Such a medium may take many forms including but not limited to non volatile media volatile media and transmission media. In various implementations non volatile media includes optical or magnetic disks volatile media includes dynamic memory such as system memory component and transmission media includes coaxial cables copper wire and fiber optics including wires that comprise bus . In one embodiment the logic is encoded in non transitory computer readable medium. In one example transmission media may take the form of acoustic or light waves such as those generated during radio wave optical and infrared data communications.

Some common forms of computer readable media includes for example floppy disk flexible disk hard disk magnetic tape any other magnetic medium CD ROM any other optical medium punch cards paper tape any other physical medium with patterns of holes RAM PROM EPROM FLASH EPROM any other memory chip or cartridge or any other medium from which a computer is adapted to read.

In various embodiments of the present disclosure execution of instruction sequences to practice the present disclosure may be performed by computer system . In various other embodiments of the present disclosure a plurality of computer systems coupled by communication link to the network e.g. such as a LAN WLAN PTSN and or various other wired or wireless networks including telecommunications mobile and cellular phone networks may perform instruction sequences to practice the present disclosure in coordination with one another.

Where applicable various embodiments provided by the present disclosure may be implemented using hardware software or combinations of hardware and software. Also where applicable the various hardware components and or software components set forth herein may be combined into composite components comprising software hardware and or both without departing from the spirit of the present disclosure. Where applicable the various hardware components and or software components set forth herein may be separated into sub components comprising software hardware or both without departing from the scope of the present disclosure. In addition where applicable it is contemplated that software components may be implemented as hardware components and vice versa.

Software in accordance with the present disclosure such as program code and or data may be stored on one or more computer readable mediums. It is also contemplated that software identified herein may be implemented using one or more general purpose or specific purpose computers and or computer systems networked and or otherwise. Where applicable the ordering of various steps described herein may be changed combined into composite steps and or separated into sub steps to provide features described herein.

The foregoing disclosure is not intended to limit the present disclosure to the precise forms or particular fields of use disclosed. As such it is contemplated that various alternate embodiments and or modifications to the present disclosure whether explicitly described or implied herein are possible in light of the disclosure. Having thus described embodiments of the present disclosure persons of ordinary skill in the art will recognize that changes may be made in form and detail without departing from the scope of the present disclosure. Thus the present disclosure is limited only by the claims.

