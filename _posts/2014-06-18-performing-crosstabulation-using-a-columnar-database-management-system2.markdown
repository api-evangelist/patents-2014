---

title: Performing cross-tabulation using a columnar database management system
abstract: Cross tabulation operation is performed within a columnar database management system. The columnar database management system receives a request to perform a cross-tabulation operation on a set of database tables. The columnar database management system determines values of cross tabulation operation for each row of the result. The columnar database management system determines a domain for each value of the row dimension corresponding to a row combination. The columnar database management system determines an intersection set of the domains corresponding to values of the row dimensions for the row combination. The columnar database management system determines a value for the result column for the row combination as an aggregate value based on the records of the intersection set.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09600539&OS=09600539&RS=09600539
owner: Actuate Corporation
number: 09600539
owner_city: San Mateo
owner_country: US
publication_date: 20140618
---
This application claims the benefit of U.S. Provisional Patent Application No. 61 837 780 filed Jun. 21 2013 which is incorporated by reference in its entirety.

This invention relates generally to data mining operations and in particular to performing cross tabulation using a columnar database management system.

Data mining operations are often employed by enterprises to process data sourced from various database management systems. Data is often represented as sets of various types of entities for example products employees users of a system transactions performed by an online system and so on. Data mining systems perform operations on these sets of data for example union intersection difference and so on. One operation performed by data mining systems is cross tabulation of tables. Conventional techniques for performing cross tabulation often perform inefficiently because they load the same data multiple times for performing various steps. As a consequence performing cross tabulation is often inefficient and consumes more computing resources than needed.

Embodiments of the invention perform cross tabulation on tables. A columnar database management system receives a request to perform a cross tabulation operation on a set of database tables. The request specifies row dimensions based on columns of database tables participating in the cross tabulation operation. The columnar database management system determines the result of cross tabulation operation by performing following steps for each row of the result. Each row of the result is associated with a combination of values corresponding to the row dimensions. The columnar database management system determines a domain for each value of the row dimension corresponding to the combination. The domain comprises a set of records of the table that match the value of the row dimension. The columnar database management system determines an intersection set of the domains corresponding to values of the row dimensions for the row combination. The columnar database management system determines a value for the result column for the row combination as an aggregate value based on the records of the intersection set.

The features and advantages described in this summary and the following detailed description are not all inclusive. Many additional features and advantages will be apparent to one of ordinary skill in the art in view of the drawings specification and claims hereof.

The Figures FIGS. and the following description describe certain embodiments by way of illustration only. One skilled in the art will readily recognize from the following description that alternative embodiments of the structures and methods illustrated herein may be employed without departing from the principles described herein. It is noted that wherever practicable similar or like reference numbers may be used in the figures and may indicate similar or like functionality.

The data mining requests may indicate to the data mining system to perform one or more data mining algorithms on data stored by the data mining system . For example the data mining request may indicate that a cross tabulation calculation operation be performed. In one aspect the client may be a suitable computing device such as a desktop computer a laptop computer a workstation a server computer a mobile phone a tablet device etc.

As shown in the data mining system includes among other components an application frontend and a columnar database management system . The application frontend may be a software application configured to receive data mining requests from the client and or provide data mining results to the client device . In one embodiment the application frontend may forward or route data mining requests to the columnar database management system for data processing. The application frontend may additionally receive data mining results from the columnar database management system for transmission to a client . In one embodiment the application frontend does not include and or is not configured to use data mining algorithms to process data indicated by a data mining request.

The columnar database management system is a system configured to store data according to a column oriented scheme. As shown in the columnar database management system includes data data mining algorithms and a database engine . In one aspect data includes various columns of data where each column is associated with a logical set.

The database engine is a logical entity configured to create read update and delete data stored by the columnar data management system . In one embodiment the database engine is also configured to perform data mining using the data mining operations and the data . In one embodiment the data mining algorithms include a cross tabulation operation for performing cross tabulation calculations.

In the embodiment responsive to receiving a data mining request to perform a cross tabulation calculation directly from the client or forwarded by the application frontend the database engine performs various steps to process the request and perform the cross tabulation calculation. In some embodiments the database engine may include a bubbler module and an operator module to facilitate performance of the cross tabulation calculation. The bubbler module performs intersection of a plurality of sets of data provided as input. The sets of data are also referred to herein as domains. The operator module performs specific operations on input values for example performing difference of values determining cardinality of set of elements and the like. Further details of the bubbler module and an operator module are described herein.

The storage device is a non transitory computer readable storage medium such as a hard drive compact disk read only memory CD ROM DVD or a solid state memory device. The memory holds instructions and data used by the processor . The pointing device may be a mouse track ball or other type of pointing device and is used in combination with the keyboard to input data into the computer system . The graphics adapter displays images and other information on the display . The network adapter couples the computer system to the network .

A computer can have different and or other components than those shown in . In addition the computer can lack certain illustrated components. In one embodiment a computer acting as the data mining system is formed of multiple blade computers and lacks a keyboard pointing device graphics adapter and or display . Moreover the storage device can be local and or remote from the computer such as embodied within a storage area network SAN .

The computer is adapted to execute computer program modules for providing functionality described herein. As used herein the term module refers to computer program logic utilized to provide the specified functionality. Thus a module can be implemented in hardware firmware and or software. In one embodiment program modules are stored on the storage device loaded into the memory and executed by the processor .

Embodiments of the entities described herein can include other and or different modules than the ones described here. In addition the functionality attributed to the modules can be performed by other or different modules in other embodiments. Moreover this description occasionally omits the term module for purposes of clarity and convenience.

The following description of the cross tabulation process uses the following terms. A row dimension is a database column that participates in a cross tabulation operation. A row combination is a combination of values of row dimensions defining a record in the cross tabulation result. A measure in a cross tabulation is a value that is determined from the inputs and stored in an individual cell as result. A measure value can be the result of an aggregation function for example count sum max etc. of the values that correspond to an associated combination. A pivot dimension is a database column that splits the resulting measure in one value for each discrete value in the pivot column one value per category . A resolution level is a table on which the aggregation function of the measure is applied i.e. in an expression COUNT Customers the resolution level is the table Customers . 

A domain is a set of table records that meet a given condition. For example if a customer table has a column state storing values including California Nevada Texas and the like an example domain is all customers from state California. A domain resolves to a specific table that is selects records in that table. A resolution level change is an action of projecting a domain from a given table to another related table. The database engine projects a domain corresponding to records of a table to a result domain comprising a set of records of a results table. The database engine projects a domain from an input table to a result table by using a foreign key relationship between the input table and the result table. In an embodiment the database engine determines for each record of the intersection set of domain a corresponding record of the result table based on the foreign key relationship between the input table and the result table

A universal filter is a domain applied as a filter in a cross tabulation at the lowest level possible i.e. applied early during the computation of the cross tabulation result. For example if a cross tabulation operation is performed using a set of input tables the universal filter is applied to the input tables rather than to intermediate or final results obtained by processing the input tables. A target filter is a domain applied as a filter in a cross tabulation at the resolution level. A base filter is a domain used in conjunction with the target filter to compare values of data or to perform any operator using values of data from the base and the target filter.

The bubbler module performs intersection of domains involved in a cross tabulation calculation. The operator module computes the aggregation functions using the incoming domain. Typical aggregation functions are count sum average maximum minimum etc. Additionally comparison functions such as difference relative index percent etc. . . . can be used when two domains are defined target domain and base domain . The bubbler modules creates data structures called bubblers for performing intersections of various input sets.

In one embodiment the database engine performs the following process to perform a cross tabulation calculation. The columnar database management system receives a request to perform a cross tabulation operation on a set of database tables. The request may be received by the application front end from a client and sent to the columnar database management system . The request specifies one or more row dimensions representing columns of the database tables participating in the cross tabulation operation.

In one aspect the cross tabulation request can be encapsulated in a suitable message format. For example the cross tabulation request may be encapsulated in a text format such as XML or in any other format. In some embodiments the cross tabulation request is received by the columnar database management system via one or more suitable network transfer protocols. In other embodiments the cross tabulation request is received via an application programming interface API call through receipt of a file containing the cross tabulation request or via an interactive console. It will be appreciated however that other ways of receiving the cross tabulation request may be used.

The database engine of the columnar database management system determines the result of cross tabulation and stores the results. The result of the cross tabulation operation comprises rows each row having a combination of values of row dimensions. In an embodiment the columnar database management system sends the results for example to the client sending the request.

The database engine performs the following processing for each row of the result for the cross tabulation operation. Each row of the result is associated with a combination of values for different row dimensions. The database engine determines a domain for each value of a row dimension of the combination. Each domain comprises a set of table records of the table matching the value of the row dimension. The database engine determines an intersection set of domains corresponding to the row combination. The intersection set comprises table records that match the combination of values corresponding to the row. The database engine determines one or more result columns for the row combination for example an aggregate value based on the intersection set. The database engine may either store the rows of the result of the cross tabulation as data or return the result to the requestor.

The cross tabulation request may specify a plurality of tables as input tables. The database engine determines an intersection set corresponding to each table. The database engine projects the records of intersection set of corresponding to a table to records of another table by performing a resolution level change. For example the cross tabulation request may specify a customer table and a pet table where the result of aggregations are based on pet table. The database engine determines a domain corresponding to intersection of various domains based on the customer table and projects the records of this domain to associated records of the customer table.

For example if the domain includes pets p and p and pet p matches customer c and pet p matches customer c the database engine projects the domain based on pets to corresponding customer records from the customer table. A single record of a table may maps to multiple records of the target table thereby resulting in a different number of records when a resolution level change is performed. The number of records may either increase decrease or remain the same after performing resolution change. Performing the various resolution level changes for the intersection set results is referred to as a vertical collapse in which the various sets of records get mapped to records of a target table. The vertical collapse moves domains towards the cross tabulation resolution level intersecting domains at each level in the path to the final one.

In some embodiments the cross tabulation specification includes one or more filters. A filter specifies certain criteria that must be satisfied for the records considered for cross tabulation. The database engine determines a filter domain for the filter value. The filter domain comprises a set of values that satisfy the filter value for the filter column of the table. The bubbler module determines an intersection set of the filter domain with domains corresponding to a row combination.

In some embodiments the cross tabulation request specifies pivot dimensions. A pivot dimension may correspond to a column of an input table. The result of the cross tabulation with pivot dimension includes a column for each distinct value of the specified column. To determine the result values of the pivot dimension the database engine determines a pivot domain for each discrete value of the pivot dimension. The pivot domain comprises a set of records that satisfy the corresponding value for the column of the table. The bubbler module determines an intersection set of the pivot domain with domains corresponding to values of row dimensions for the row combination. The operator module determines an aggregate value based on the intersection set as a value of the measure for example count.

An example pet table is shown in table II including columns name age class of pet whether the pet is reptile mammal fish or bird species weight and customer ID. The column customer ID is a foreign key referring to the customer table.

An example cross tabulation specification using the above data generates a report of count of customers grouped by pet Class with possible values Bird Fish Mammal Reptile and WWF member yes no including pivot dimensions showing owner gender with values Male Female the report filtered by pets that are not birds universal filter in this example .

For this example the maximum possible number of row combinations is 8 since there are 4 discrete values in column Class which gets multiplied by 2 discrete values in the column WWF Member. Each row combination is split into 2 columns because the pivoting dimension has 2 discrete values male and female. Omitting blank rows the result looks as shown in table III.

Without omitting blank rows the result table obtained from the cross tabulation would look as follows.

In this case Class and WWF Member are row dimensions whereas Gender is a pivoted dimension and count Customer is the measure. Accordingly the cross tabulation presents the total number of Customers by Gender in each combination of Class and WWF Member.

The columnar database management system performs the calculation process as follows. The columnar database management system calculates the domain for the first discrete value in each row dimension. The number of elements with Class Bird is two and the number of elements with WWF Member No is ten. The columnar database management system determines the domain for the first discrete value in the pivot dimension i.e. owner Gender Female. This domain has 6 elements. The columnar database management system determines a domain for the Universal Filter i.e. Class Not Bird having 20 elements. Put Universal Filter and Row Dimensions domains calculated in previous steps in a Bubbler.

The columnar database management system uses the bubbler module to intersect the domains resolving at the same table level. The bubbler module determines the resulting domain at Customer level based on input domain R corresponding to WWF Member No as D. The bubbler module determines the resulting domain at the pet level by performing intersection of a domain R corresponding to Class Fish row dimension and a domain Ux corresponding to Class a Bird Universal filter . The resulting domain is D.

The resulting domains D and D are used as inputs for measures universal bubbler see . The measures bubbler collapses horizontally. In this case only D is at the Customer level so no intersection is needed at this level. At Pet level there is no intersection as only D is at this level. The results of horizontal collapse are M and M in this case equal to D and D .

At this stage the columnar database management system performs a vertical collapse by moving domains towards the cross tabulation resolution level intersecting domains at each level in the path to the final one. In this case M is changed to customer level M 2 elements and intersected with M M M M 2 elements .

The output result of this bubbler becomes an input of the next bubbler the target bubbler. At this stage current pivoting domain P is introduced in the bubbler along with M. Every domain in the target bubbler is changed to the measure resolution level before any operation is performed with them. Then all these are intersected P M Final 1 element 

At the final stage the result of this bubbler is sent to the operator count as this is the operation set in the definition. The operator then generates the final value of the cell with value 1 . The remaining cells are calculated similarly.

A cross tabulation measure can compare results from two filters a target filter against a base filter. The comparison may be determined by computing a function that takes two input values one value from the base filter and the other value from the target filter. For example the function may determine a difference a relative index a percentage or any other function for comparison. The database engine determines the result values for the target filter by following the steps described herein for determining results of a filter. The database engine also determines the result values for the base filter by following the steps described herein. The database engine provides the two result values determined to the operator module . The operator module determines the final value for the measure by applying the comparison operator specified by the measure to the two results values input to the operator module .

The following example illustrates the use of base bubbler and target bubbler. The cross tabulation requests a filter that is based on two other filters defined. A first filter hair that includes all those animals with fur Bear Cat Dog Rabbit Squirrel . A second filter no hair includes all animals that do not have hair e.g. Duck Fish Parrot Snake Turtle. The cross tabulation determines a first measure of number of people that own one animal from the class bird fish mammal reptile and at least one other pet that has hair and a second measure of number of people that own one animal from the class bird fish mammal reptile and at least one other pet that has NO hair. The cross tabulation determines a third filter diff which is the difference of the value of hair measure and the value of the no hair measure.

The first measure hair has a hair filter applied as a target filter. Second measure no hair has a no hair filter applied as a target filter. Third measure diff has 2 filters hair as a target filter and no hair as a base filter. For example the second row of class fish has a first measure hair that shows that there are 2 people owning a fish and at least one animal with hair Ted and Alice to be exact . Furthermore there are 2 people owning a fish and at least one animal without hair. The third measure calculates the difference between the target filter results and the base filter results that is measure hair 2 owners measure no hair 2 owners 0 owners.

The features and advantages described in the specification are not all inclusive and in particular many additional features and advantages will be apparent to one of ordinary skill in the art in view of the drawings specification and claims. Moreover it should be noted that the language used in the specification has been principally selected for readability and instructional purposes and may not have been selected to delineate or circumscribe the inventive subject matter.

The foregoing description of the embodiments of the invention has been presented for the purpose of illustration it is not intended to be exhaustive or to limit the invention to the precise forms disclosed. Persons skilled in the relevant art can appreciate that many modifications and variations are possible in light of the above disclosure.

Some portions of this description describe the embodiments of the invention in terms of algorithms and symbolic representations of operations on information. These algorithmic descriptions and representations are commonly used by those skilled in the data processing arts to convey the substance of their work effectively to others skilled in the art. These operations while described functionally computationally or logically are understood to be implemented by computer programs or equivalent electrical circuits microcode or the like. Furthermore it has also proven convenient at times to refer to these arrangements of operations as modules without loss of generality. The described operations and their associated modules may be embodied in software firmware hardware or any combinations thereof.

Any of the steps operations or processes described herein may be performed or implemented with one or more hardware or software modules alone or in combination with other devices. In one embodiment a software module is implemented with a computer program product comprising a computer readable medium containing computer program code which can be executed by a computer processor for performing any or all of the steps operations or processes described.

Embodiments of the invention may also relate to an apparatus for performing the operations herein. This apparatus may be specially constructed for the required purposes and or it may comprise a general purpose computing device selectively activated or reconfigured by a computer program stored in the computer. Such a computer program may be stored in a tangible non transitory computer readable storage medium or any type of media suitable for storing electronic instructions and coupled to a computer system bus. Furthermore any computing systems referred to in the specification may include a single processor or may be architectures employing multiple processor designs for increased computing capability.

Finally the language used in the specification has been principally selected for readability and instructional purposes and it may not have been selected to delineate or circumscribe the inventive subject matter. It is therefore intended that the scope of the invention be limited not by this detailed description but rather by any claims that issue on an application based hereon. Accordingly the disclosure of the embodiments of the invention is intended to be illustrative but not limiting of the scope of the invention which is set forth in the following claims.

