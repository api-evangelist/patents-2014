---

title: Information processing system and method that record result of process that uses e-mail transmission
abstract: An information processing system, which includes an electronic apparatus and a service providing system executing a process using e-mail based on a request from the electronic apparatus, includes a process reception part that receives the request, a mail transmission part that transmits the e-mail to which identification information uniquely identifying the request is added and in which the address of the service providing system is set as the return destination of the e-mail, a monitoring part that detects reception of the e-mail returned in response to the failure of the transmission of the e-mail, and identifies the request based on the identification information added to the returned e-mail, and a reporting part that reports the failure as the process result of the request to the process reception part. The process reception part records the failure as the process result of the request in response to the reported failure.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09503405&OS=09503405&RS=09503405
owner: Ricoh Company, Ltd.
number: 09503405
owner_city: Tokyo
owner_country: JP
publication_date: 20141002
---
The present application is based upon and claims the benefit of priority of Japanese Patent Applications No. 2013 214663 and No. 2013 214980 both filed on Oct. 15 2013 the entire contents of which are incorporated herein by reference.

The present invention relates to information processing systems service providing systems and process result recording methods.

Image forming apparatuses have been known that have an electronic mail e mail transmitting function to transmit image data from a scanner as an attachment of e mail as a file attached to e mail . When an e mail message indicating that transmitted e mail is undeliverable an undeliverable error message is returned from a mail server such image forming apparatuses transfer the undeliverable error message to the address of a transmitter of the e mail. See for example Japanese Laid Open Patent Application No. 2006 164110. 

According to an aspect of the present invention an information processing system which includes an electronic apparatus and a service providing system executing a process using electronic mail based on a request from the electronic apparatus includes a process reception part configured to receive the request from the electronic apparatus a mail transmission part configured to add identification information uniquely identifying the request from the electronic apparatus to the electronic mail set an address of the service providing system as a return destination of the electronic mail to which the identification information is added and transmit the electronic mail in which the address is set a monitoring part configured to detect reception of the electronic mail returned in response to failure of the transmission of the electronic mail and to identify the request from the electronic apparatus based on the identification information added to the returned electronic mail and a reporting part configured to report the failure as a process result of the request to the process reception part. The process reception part is configured to record the failure as the process result of the request in response to the reported failure.

According to an aspect of the present invention a service providing system executing a process using electronic mail based on a request from an electronic apparatus includes a process reception part configured to receive the request from the electronic apparatus a mail transmission part configured to add identification information uniquely identifying the request from the electronic apparatus to the electronic mail set an address of the service providing system as a return destination of the electronic mail to which the identification information is added and transmit the electronic mail in which the address is set a monitoring part configured to detect reception of the electronic mail returned in response to failure of the transmission of the electronic mail and to identify the request from the electronic apparatus based on the identification information added to the returned electronic mail and a reporting part configured to report the failure as a process result of the request to the process reception part. The process reception part is configured to record the failure as the process result of the request in response to the reported failure.

According to an aspect of the present invention a process result recording method executed by an information processing system including an electronic apparatus and a service providing system executing a process using electronic mail based on a request from the electronic apparatus includes receiving the request from the electronic apparatus by a process reception part adding identification information uniquely identifying the request from the electronic apparatus to the electronic mail setting an address of the service providing system as a return destination of the electronic mail to which the identification information is added and transmitting the electronic mail in which the address is set detecting reception of the electronic mail returned in response to failure of the transmission of the electronic mail and identifying the request from the electronic apparatus based on the identification information added to the returned electronic mail and reporting the failure as a process result of the request to the process reception part. The failure is recorded as the process result of the request in response to the reported failure by the process reception part.

The object and advantages of the present invention will be realized and attained by means of the elements and combinations particularly pointed out in the claims.

It is to be understood that both the foregoing general description and the following detailed description are exemplary and explanatory and not restrictive of the invention.

The above described e mail transmitting function to transmit scanned image data as an attachment of e mail may be provided as such a function service of a Web application or a server side application as typified by a cloud service.

For example an application for transmitting image data scanned in an image forming apparatus to a destination as an attachment of e mail transmits e mail to which image data are attached using a mail server. Furthermore the application may be required to record the result success or failure error of transmission of e mail to which image data are attached.

When the transmitted e mail is not delivered to the destination because of for example a wrong destination address however the application may not be able to detect the transmission delivery error. For example in the case where a return address a return path is set in e mail to which image data are attached an error message that is transmitted because of a wrong destination is transferred to the return address so that the application cannot detect the transmission error of the e mail. Accordingly there is a problem in that the application cannot record a correct transmission result of e mail to which image data are attached.

According to an aspect of the present invention an information processing system a service providing system and a process result recording method are provided that are capable of recording a correct process result of a process that uses e mail transmission.

A description is given below with reference to the accompanying drawings of embodiments of the present invention.

The network N1 includes one or more image forming apparatuses hereinafter collectively referred to as image forming apparatus and a client terminal . An apparatus that detects and blocks unauthorized access such as a firewall may be provided between the network N1 and the network N3.

The image forming apparatus is an apparatus electronic apparatus that includes an image forming function such as a multifunction peripheral. The image forming apparatus includes a communication part that performs wired or wireless communications. The image forming apparatus is also an apparatus that executes scanning reading an original material such as a multifunction peripheral or a scanner.

The client terminal may be implemented by for example an information processing apparatus including a common operating system OS . The client terminal includes a communication part that performs wired or wireless communications. The client terminal is a terminal operable by a user such as a tablet personal computer PC a notebook PC a smartphone or a cellular phone.

The network N2 includes a scan application server apparatus a callback server apparatus an asynchronous conversion server apparatus a mail server apparatus a company management database DB a job log management DB a scan settings management DB and a shared file storage . An apparatus that detects and blocks unauthorized access such as an access controller may be provided between the network N2 and the network N3.

The scan application server apparatus communicates with the image forming apparatus and the client terminal via a Web application programming interface API . The scan application server apparatus requests the asynchronous conversion server apparatus to execute a process in accordance with the contents of a job.

The callback server apparatus monitors the mail server apparatus and detects reception of an error e mail message. The callback server apparatus identifies a job correlated with the error e mail message whose reception the callback server apparatus has detected and reports a result to calls back the scan application server apparatus that has requested the job. The error e mail message is an example of an e mail message that is returned in response to the failure of e mail transmission.

The asynchronous conversion server apparatus asynchronously performs conversion or e mail transmission requested by the scan application server or the like. The mail server apparatus executes processes such as transmission of e mail requested by the asynchronous conversion server apparatus to a destination and reception of an error e mail message. In addition to e mail the mail server apparatus may transmit and receive Webmail.

The company management DB manages information on companies and users that use the service providing system. The job log management DB manages the logs of jobs executed by users. The scan settings management DB manages settings for performing scanning and e mail transmission in the image forming apparatus . The shared file storage is a storage for storing files such as the files of scanned images and text files after optical character recognition OCR used in the service providing system.

The scan application server apparatus the callback server apparatus the asynchronous conversion server apparatus and the mail server apparatus are implemented by one or more information processing apparatuses. The scan application server apparatus the callback server apparatus the asynchronous conversion server apparatus and the mail server apparatus may be implemented by being integrated into a single information processing apparatus or by being divided into multiple information processing apparatuses.

Likewise the company management DB the job log management DB the scan settings management DB and the shared file storage are implemented by one or more information processing apparatuses. The company management DB the job log management DB the scan settings management DB and the shared file storage may be implemented by being integrated into a single information processing apparatus or by being divided into multiple information processing apparatuses.

One or more of server apparatuses and databases included in the service providing system may be external to the network N2. Furthermore databases included in the service providing system may be apparatuses for storing files provided by vendors such as online storages. The configuration of the service providing system as illustrated in is an example and the service providing system may have another configuration.

Each of the client terminal the scan application server apparatus the callback server apparatus the asynchronous conversion server apparatus and the mail server apparatus may be implemented by for example a computer having a hardware configuration as illustrated in . Furthermore each of the company management DB the job log management DB the scan settings management DB and the shared file storage may be implemented by for example a computer having a hardware configuration as illustrated in .

The input device includes a keyboard a mouse and a touchscreen and is used to input operation signals by a user. The display unit includes a display and displays the result of processing by the computer .

The communications I F is an interface that connects the computer to the network N1 or N2. Thus it is possible for the computer to perform data communications via the communications I F .

The HDD is a nonvolatile storage device that contains programs and data. Examples of the stored programs and data include an OS that is a basic program that controls the computer and application software that provides various functions on the OS. The HDD manages the contained programs and data with a predetermined file system and or database.

The external I F is an interface with external devices. Examples of external devices include a recording medium . Thus it is possible for the computer to read and or write to the recording medium via the external I F . Examples of the recording medium includes a flexible disk a compact disk CD a digital versatile disk DVD a secure digital SD memory card and a universal serial bus USB memory.

The ROM is a nonvolatile semiconductor memory storage device that can retain programs and data when not powered. The ROM contains programs and data such as a basic input output system BIOS OS settings and network settings that are executed at the time of activation of the computer . The RAM is a volatile semiconductor memory storage device that temporarily retains programs and data.

The CPU is a processor that controls and implements functions of the computer by reading programs and data from storage devices such as the ROM and the HDD into the RAM and executing processes.

It is possible for the client terminal the scan application server apparatus the callback server apparatus the asynchronous conversion server apparatus and the mail server apparatus of to implement the various processes as described below with the hardware configuration of the computer illustrated in for example.

The image forming apparatus of is implemented by for example a computer having a hardware configuration as illustrated in . FIG. is a block diagram illustrating a hardware configuration of an image forming apparatus according to an embodiment. The image forming apparatus illustrated in includes a controller an operation panel an external I F a communications I F a printer and a scanner .

The controller includes a CPU a ROM a nonvolatile NV RAM and an HDD . The ROM contains various programs and data. The RAM temporarily retains programs and data. The NVRAM contains for example settings information. The HDD contains various programs and data.

The CPU controls and implements functions of the image forming apparatus by reading programs data and settings information from the ROM the NVRAM and the HDD into the RAM and executing processes.

The operation panel includes an input part that receives a user s inputs and a display part that displays information. The external I F is an interface with external devices. Examples of external devices include a recording medium . Thus it is possible for the image forming apparatus to read and or write to the recording medium via the external I F . Examples of the recording medium includes an integrated circuit IC card a flexible disk a CD a DVD an SD memory card and a USB memory.

The communications I F is an interface that connects the image forming apparatus to the network N1. Thus it is possible for the image forming apparatus to perform data communications via the communications I F . The printer is a printing device for printing print data on a recording medium such as paper. The scanner is a reading device for reading image data electronic data from an original material such as a document.

A service providing system according to an embodiment is implemented by for example process blocks including modules and storage devices as illustrated in . is a diagram illustrating process blocks of a service providing system according to an embodiment.

Referring to a service providing system implements a scan server application an asynchronous conversion part a mail transmission and reception part a callback process part and Web APIs and by executing one or more programs.

Furthermore the service providing system implements a job log management and storage part a scan settings management and storage part a company management and storage part and a shared file storage part .

The asynchronous conversion part includes a data conversion request management part a message queue one or more conversion parts hereinafter collectively referred to as conversion part a mail transmission part and a job information management and storage part . The callback process part includes a mail transmission and reception monitoring part . The message queue may include one or more message queues for individual tasks.

The scan server application communicating with an embedded application of the image forming apparatus via the Web API so as to connect modules. The embedded application of the image forming apparatus communicates with the scan server application so as to obtain scan settings and register jobs. The scan server application requests for example the asynchronous conversion part to execute a process in accordance with the contents of a job.

The job log management part is a storage part that manages the logs of jobs executed by users. The job log management part is used when a manager or a user refers to the history of the results of executing processing jobs.

The scan settings management and storage part is a storage part that manages settings for performing scanning and e mail transmission in the image forming apparatus . The company management and storage part is a storage part that manages information on companies and users that use the service providing system and provides information in response to queries from modules. The shared file storage part is a storage part that stores files used in the service providing system .

The asynchronous conversion part is a process part that asynchronously executes processes requested by the scan server application etc. The data conversion request management part of the asynchronous conversion part transmits a request for processing to the message queue in accordance with the contents of a job such as conversion or e mail transmission requested by for example the scan server application . The message queue stores a request for processing received from the data conversion request management part .

The conversion part and the mail transmission part monitor requests for processing stored in the message queue . If a request for processing to be executed by the conversion part or the mail transmission part is stored the conversion part or the mail transmission part executes the processing. The conversion part performs conversion. For example the conversion part performs OCR on a tiff file so as to generate a PDF file with text.

The mail transmission part transmits e mail. The mail transmission part transmits e mail to the mail transmission and reception part . The job information management and storage part is a storage part that manages job information that is information on jobs that the asynchronous conversion part is requested to execute by for example the scan server application .

The mail transmission and reception part executes processes such as transmission of e mail requested by for example the mail transmission part to a destination and reception of an error e mail message. The mail transmission and reception monitoring part of the callback process part monitors the mail transmission and reception part and detects reception of an error e mail message by the mail transmission and reception part . The callback process part identifies a job correlated with the error e mail message whose reception has been detected by the mail transmission and reception monitoring part and reports a result to calls back for example the scan server application that has requested the job.

The Web APIs and are predefined interfaces provided to receive requests and are constituted of for example functions and classes. The image forming apparatus and the client terminal may access the functions of the scan server application made open by the Web API . Furthermore the scan server application may access the functions of the asynchronous conversion part etc. made open by the Web API . The form of classification of process blocks of the service providing system illustrated in is an example and it is not necessary for the process blocks of the service providing system to be classified as illustrated in . The form of classification of process blocks of the service providing system is not limited in particular to the classification illustrated in as long as it is possible to execute processes of the service providing system according to an embodiment.

The job log ID is information that identifies a job log. The date of creation is the date and time of creation of a job log. The conversion job ID is information that identifies job information managed by the job information management and storage part of the asynchronous conversion part . The company ID is information that identifies an organization or group such as a company or department. The company ID is not limited by the term company. The apparatus ID is information that identifies the image forming apparatus that has registered recorded a job.

The execution user is information that identifies a user who has registered a job by operating the image forming apparatus . The project ID is information that identifies a project described below . The image ID is information that identifies a file to be processed such as an image file. The transmission destination indicates e mail or server message block SMB as a method of file transmission.

The transmission source address is a transmission source address set in an e mail message to be transmitted. The return address is a return address set in an e mail message to be transmitted. The transmission destination address is a destination address set in an e mail message to be transmitted. The file format is the file format of a file attached to an e mail message. The error report destination is the address of a destination at which the transmission error of an e mail message is reported to a user. The status is the result of processing of a job such as IN PROGRESS SUCCESS or ERROR FAILURE .

In the project table a user sets the contents of executable jobs as projects from the image forming apparatus . Examples of projects include the job of performing scanning and transmitting scanned image data to the e mail addresses of a user who has executed the job and other users and the job of performing scanning and transmitting the scanning result to a local server.

The project table of has data items such as a project ID a name a group a transmission destination a transmission destination address a file format and an error report destination. The transmission destination the transmission destination address the file format and the error report destination are the same as those of the job log table of and accordingly their description is omitted.

The project ID is information that identifies a project. The name is an example of information for identifying a project by a user. The group is the group ID of a group to which a project belongs. One or more projects may belong to a group.

The group table is for setting groups. The group table of has data items such as a group ID a name a profile and order.

The group ID is information that identifies a group. The name is an example of information for identifying a group by a user. The profile is the profile ID of a profile to which a group belongs. The order indicates the order of display of groups in a profile. One or more groups may belong to a profile.

The profile table is for setting profiles. The profile table has data items such as a profile ID a name and a company ID. The profile ID is information that identifies a profile. The name is an example of information for identifying a profile by a user. The company ID is the same as that of the job log table of . An apparatus such as the image forming apparatus may be correlated with one profile.

The apparatus settings table correlates profiles and apparatuses. The apparatus settings table has data items such as a profile ID and an apparatus ID. An apparatus such as the image forming apparatus is correlated with one profile by the apparatus settings table.

The company table has data items such as a company ID and a company name. The company name is an example of information for identifying a company by a user. The company ID is correlated with the company name by the company table.

The user table has data items such as a user ID a company ID a name an e mail address and an authentication token. The user ID and the name are information that identifies a user. The e mail address is the e mail address of a user. The authentication token is an authentication token given to a user who successfully logs on. A user is correlated with a company by the user table.

The apparatus table has data items such as an apparatus ID a company ID and a body number. The body number is an example of unique information obtainable from an apparatus such as the image forming apparatus . An apparatus such as the image forming apparatus is correlated with a company by the apparatus table.

The date of creation is the date and time of creation of job information. The file URI is an example of information indicating a location where a file such as an image file which is an object of processing is stored. Furthermore the Message ID is an example of information for correlating an error e mail message and job information as described below. The other data items are the same as those of the job log table of and accordingly their description is omitted.

At step S a user who performs scanning performs scanning in the image forming apparatus using the scan settings synchronized with those managed in the service providing system . At step S the image forming apparatus transmits scanned image data a scanned image and the scan settings used by the user to the service providing system and requests the service providing system to execute a process.

At step S the service providing system executes a process such as file conversion based on the scan settings. At step S the service providing system obtains a universally unique identifier UUID which is a unique identifier and correlates the obtained UUID with the process job requested at step S. The UUID is an example of identification information that can uniquely identify a requested process.

At step S the service providing system transmits an e mail message to the e mail address specified as a destination based on the scan settings. To the e mail message transmitted at step S a file generated by the process of step S is attached and the UUID obtained at step S is added. After completion of the transmission at step S the service providing system sets the process result of the job shown at the status of the job log table of and the job information management table of to SUCCESS.

When the e mail message is not delivered to the destination because of for example a wrong destination address an error e mail message is returned that is the e mail message is returned with an error message to the service providing system . Here a description is given of a process in the case where an error e mail message is returned. At step S an error e mail message is returned to the service providing system . The UUID added to the e mail message at step S is added to the returned error e mail message.

At step S the service providing system identifies the process requested at step S by the UUID added to the returned error e mail message. At step S the service providing system sets the process result of the job shown at the status of a job log of and job information of corresponding to the process identified by the UUID to ERROR.

At step S the service providing system refers to the error report destination of the identified job log of and transmits an error e mail message describing the details of an error to the user if the error report destination is set.

Thus according to the process illustrated in the sequence diagram of a UUID which is a unique identifier is added to an e mail message transmitted by the service providing system and the job and the UUID are correlated in the service providing system . When an error e mail message is returned it is possible to identify the job by the UUID added to the error e mail message and to record error as the process result of the job.

Therefore according to the service providing system of an embodiment it is possible to record a correct process result of a job that uses e mail transmission so that it is possible for a user who executes a process and a manager to recognize a correct process result. Furthermore according to the service providing system of an embodiment because it is possible to record a correct process result of a job that uses e mail transmission it is also possible to report error to a user who executes a process and a manager using e mail.

By way of example the process of providing scan settings scan setting process at step S of is executed as illustrated in . is a sequence diagram illustrating a scan setting process. illustrates a case where a manager operates a browser to execute a scan setting process.

As a result of executing the scan setting process of values are stored in the profile table the group table the project table and the apparatus settings table of the scan settings management and storage part illustrated in .

At step S a manager requests creation of a profile from a profile setting screen illustrated in . is a schematic diagram illustrating a profile setting screen. The manager may determine the name of a profile and whether to perform user authentication and request the scan server application to create a profile from the profile setting screen. The user authentication set from the profile setting screen is user authentication at the time of using the profile in the image forming apparatus .

At step S the scan server application requests the scan settings management and storage part to store the contents of the profile whose creation has been requested by the manager in the profile table . The scan settings management and storage part obtains a profile ID and stores the contents of the profile in correlation with the profile ID in the profile table. The scan settings management and storage part returns the obtained profile ID to the scan server application so as to report the profile ID to the manager.

At step S the manager requests creation of a group belonging to the profile of the reported profile ID from a group setting screen illustrated in . is a schematic diagram illustrating a group setting screen. The manager may determine the name of a group and request the scan server application to create a group belonging to the profile from the group setting screen.

Furthermore at step S the scan server application requests the scan settings management and storage part to store the contents of the group whose creation has been requested by the manager in the group table . The scan settings management and storage part obtains a group ID and stores the contents of the group including the profile to which the group belongs in correlation with the group ID in the group table. The scan settings management and storage part returns the obtained group ID to the scan server application so as to report the group ID to the manager.

At step S the manager requests creation of a project belonging to the group of the reported group ID from a project setting screen illustrated in . is a schematic diagram illustrating a project setting screen. The manager may determine the name of a project a group to which a project belongs a delivery destination a transmission source address a destination address an error report destination and a file format and request the scan server application to create a project from the project setting screen.

At step S the scan server application requests the scan settings management and storage part to store the contents of the project whose creation has been requested by the manager in the project table . The scan settings management and storage part obtains a project ID and stores the contents of the project in correlation with the project ID in the project table. The scan settings management and storage part returns the obtained project ID to the scan application server so as to report the project ID to the manager.

At step S the manager requests obtaining of a list of apparatuses correlated with the company ID which list is used to display a profile assignment screen for assigning profiles to apparatuses such as the image forming apparatus . At step S the scan server application obtains the requested list of apparatuses correlated with the company ID from the apparatus table of the company management and storage part . The scan server application receives the assignment of profile IDs to apparatus IDs from the manager by displaying a profile assignment screen including the obtained apparatus list as illustrated in .

At step S the scan server application requests the scan settings management and storage part to store the apparatus IDs and profile IDs requested to be correlated by the manager in the apparatus settings table . The scan settings management and storage part stores the apparatus IDs and profile IDs requested to be stored by the manager in correlation with each other in the apparatus settings table of the scan settings management and storage part .

Thus according to the service providing system of this embodiment it is possible to store values in the profile table the group table the project table and the apparatus settings table of the scan settings management and storage part of by the scan setting process.

For example a process as illustrated in is executed before performing scanning in the image forming apparatus . is a sequence diagram illustrating a process up to the start of scanning. At step S the embedded application of the image forming apparatus specifies an apparatus ID and requests the scan server application of the service providing system to obtain scan settings.

At step S the scan server application obtains the scan settings correlated with the apparatus ID from the scan settings management and storage part and provides the embedded application of the image forming apparatus with the obtained scan settings. Thus the image forming apparatus synchronizes with the scan settings stored in the service providing system by obtaining the scan settings from the service providing system by for example polling.

Thereafter a user who performs scanning who is an example of an execution user a user who executes a process uses the image forming apparatus at any time. At step S the user makes a request for a logon with authentication information such as a company ID a user ID and a password to the embedded application . At step S the embedded application makes a request for a logon to the scan server application of the service providing system .

At step S the scan server application requests the company management and storage part to collate the authentication information used for a logon. If user information that matches the authentication information used for a logon is stored the company management and storage part transmits an authentication token correlated with the user information to the scan server application . The scan server application transmits the received authentication token to the embedded application of the image forming apparatus .

At step S the user operates the embedded application to select a project corresponding to the contents of a job desired to be executed. It is possible for the user to check the settings of the selected project.

By way of example a process as illustrated in is executed before registration of a job with the service providing system after performing scanning. is a sequence diagram illustrating a process for registering a job with the service providing system .

At step S a user who performs scanning requests the embedded application of the image forming apparatus to perform scanning. At step S the embedded application scans an original material based on the settings of a project selected by the user and obtains image data. Thereafter the embedded application reports completion of the scanning to the user.

At step S the embedded application transmits an authentication token and the image data to the scan server application of the service providing system and requests the scan server application to register the image data. At step S the scan server application requests the shared file storage part to store the image data. The shared file storage part stores the image data and assigns an image ID to the image data. The shared file storage part reports the image ID of the stored image data to the scan server application . Furthermore the scan server application reports the image ID of the image data stored in the shared file storage part to the embedded application .

At step S the embedded application transmits the authentication token job information corresponding to the settings of the project selected by the user and the reported image ID to the scan server application of the service providing system and requests the scan server application to register the job information and the image ID. At step S the scan server application obtains the e mail address of the user from the company management and storage part using the received authentication token. The scan server application updates the e mail setting of the job information by the obtained e mail address.

If for example is set in the transmission destination address of the job information the scan server application replaces the transmission destination address with the obtained e mail address. The scan server application specifies the e mail address of the service providing system in the return address in order to detect an e mail message that results in error in the scan server application .

At step S the scan server application transmits the job information and the image ID to the data conversion request management part of the asynchronous conversion part and requests the data conversion request management part to register the job information and the image ID. At step S the data conversion request management part transmits the job information and the image ID to the job information management and storage part and requests the job information management and storage part to store the job information and the image ID. The job information management and storage part stores the job information and the image ID and assigns a conversion job ID to the stored job information and image ID. The job information management and storage part reports the assigned conversion job ID to the data conversion request management part . Furthermore at step S the data conversion request management part determines a task from the job information and at step S the data conversion request management part registers a message request in which the task type of the task and the conversion job ID are specified with the message queue .

For example if the task determined from the job information includes conversion of a file format a file format is converted before transmission of e mail. Therefore a keyword that indicates conversion of a file format is specified in the task type before the message is stored in the message queue .

Examples of conversion of a file format executed before transmission of e mail include conversion of a TIFF file into a PDF with text or an application file. Furthermore examples of keywords indicating conversion of a file format specified in the task type include img2pdf .

At step S in response to the registration request of step S the data conversion request management part returns the conversion job ID the job information the image ID and the status of IN PROGRESS to the scan server application . At step S the scan server application causes the job log management and storage part to store the conversion job ID the job information the image ID and the status of IN PROGRESS returned from the asynchronous conversion part as a job log. The job log management and storage part assigns a job log ID to the job log and reports the job log ID to the embedded application of the image forming apparatus through the scan server application .

The process of registering recording image data at step S and the process of registering recording job information at step S which are separated in may alternatively be integrated into a single process. In the process of step S and the process of step S are separated in view of local delivery.

A description is given of conversion of a file format by the asynchronous conversion part . By way of example the asynchronous conversion part executes a process as illustrated in . is a sequence diagram illustrating a file format conversion process by the asynchronous conversion part . When a message is stored in a message queue for file format conversion for example the conversion part that monitors the message queue executes the process of step S.

At step S the conversion part obtains a message in which a task type and a conversion job ID are specified from the message queue that is under the monitoring of the conversion part . At step S the conversion part obtains job information and an image ID from the job information management and storage part by specifying the conversion job ID of the obtained message.

At step S the conversion part obtains image data from the shared file storage part by specifying the obtained image ID. At step S the conversion part converts the file format of the obtained image data in accordance with the task type specified in the message. At step S the conversion part determines whether there is a subsequent task by referring to the job information. Here it is assumed that there is a subsequent task of e mail transmission.

At step S the conversion part requests the shared file storage part to store the converted file whose file format has been converted. The shared file storage part stores the converted file and assigns an image ID 2 to the converted file. The shared file storage part reports the image ID 2 of the stored converted file to the conversion part .

At step S the conversion part transmits the conversion job ID the job information the image ID 2 and the status of IN PROGRESS to the job information management and storage part and causes the job information management and storage part to update the information stored in the job information management and storage part . At step S the conversion part registers a message in which a task type of e mail transmission and the conversion job ID are specified with the message queue .

Furthermore by way of example the asynchronous conversion part executes a process as illustrated in . is a sequence diagram illustrating an e mail transmission process by the asynchronous conversion part . When a message is stored in a message queue for e mail transmission for example the mail transmission part that monitors the message queue executes the process of step S.

At step S the mail transmission part obtains a message in which a task type and a conversion job ID are specified from the message queue that is under the monitoring of the mail transmission part . At step S the mail transmission part obtains job information and an image ID 2 from the job information management and storage part by specifying the conversion job ID specified in the obtained message.

At step S the mail transmission part obtains a converted file from the shared file storage part by specifying the obtained image ID 2. At step S the mail transmission part reads e mail settings such as a transmission destination address from the job information obtained from the job information management and storage part . At step S the mail transmission part generates a UUID.

At step S the mail transmission part generates an e mail message of the e mail settings read from the job information and attaches the converted file to the e mail message. Furthermore the e mail transmission part adds the UUID to the Message ID of the mail header. The UUID may alternatively be added to the Comment of the mail header or the text of the e mail message.

Then the mail transmission part requests the mail transmission and reception part to transmit the e mail message. At step S the mail transmission and reception part transmits the e mail message whose transmission has been requested by the mail transmission part .

When a request to the mail transmission and reception part for e mail transmission is successfully made at step S the mail transmission part determines whether there is a subsequent task by referring to the job information. Here it is assumed that there is no subsequent task. At step S the mail transmission part transmits the conversion job ID the job information the image ID 2 and the status of SUCCESS to the job information management and storage part and causes the job information management and storage part to update the information stored in the job information management and storage part .

At step S the mail transmission part reports the conversion job ID and the status of SUCCESS to the scan server application as a process result. At step S the scan server application transmits the conversion job ID and the status of SUCCESS to the job log management and storage part and causes the job log management and storage part to update the information stored in the job log management and storage part .

When an e mail message is not delivered to a destination because of for example a wrong destination address an error e mail message is returned. According to the service providing system of this embodiment the e mail address of the service providing system is specified in the return address of an e mail message to be transmitted. Therefore an error e mail message is returned to the mail transmission and reception part . When an error e mail message is returned the service providing system executes a process as illustrated in . is a sequence diagram illustrating a process result updating process due to detection of an error e mail message.

When an e mail message is not delivered to a destination because of for example a wrong destination address at step S the mail transmission and reception part receives an error e mail message and stores the received error e mail message. The mail transmission and reception monitoring part monitors the mail transmission and reception part and detects reception of an error e mail message by the mail transmission and reception part .

At step S the mail transmission and reception monitoring part obtains the UUID and the status of ERROR added to the error e mail message received by the mail transmission and reception part from the mail transmission and reception part .

At step S the mail transmission and reception monitoring part obtains a conversion job ID correlated with the UUID Message ID from the job information management and storage part of the asynchronous conversion part by specifying the UUID. At step S the mail transmission and reception monitoring part reports the conversion job ID and the status of ERROR to the callback process part . At step S the callback process part reports the conversion job ID and the status of ERROR to the scan server application as a process result.

At step S the scan server application transmits the conversion job ID and the status of ERROR to the job log management storage part and causes the job log management storage part to update the information stored in the job log management storage part . Thus the process result of a job of a job log managed by the job log management and storage part is correctly updated.

When the error report destination of the job log of is determined the scan server application executes a process at and after step S. At step S the scan server application requests the mail transmission and reception part to transmit an error e mail message in which the details of the error are described to the error report destination. At step S the mail transmission and reception part transmits the error e mail message whose transmission has been requested by the scan application server at step S to an execution user who is the error report destination. The details of a job that has resulted in error may be described in the error e mail message transmitted to the error report destination by the scan server application . Therefore it is possible to notify the execution user of the cause of the error in more detail than by error e mail from a mailer daemon.

When a manager or an execution user refers to job logs the scan server application may cause a job log check screen as illustrated in to be displayed on the image forming apparatus or the client terminal . is a schematic diagram illustrating a job log check screen. On the job log check screen of the process results statuses of processed jobs are shown as statuses. The status of the job log check screen is displayed based on the status of a job log managed by the job log management and storage part .

Accordingly it is possible for a manager or an execution user who refers to job logs to refer to the correctly updated process results of jobs on the job log check screen. Furthermore it is possible to display internal errors and external errors separately on the job log check screen by recording external errors for which error e mail messages are returned and internal errors caused before e mail transmission separately in the job logs managed by the job log management and storage part .

According to the service providing system a UUID is added to each e mail message transmitted in response to execution of a job and the UUID is stored in correlation with the job in the service providing system . Furthermore the service providing system records the status of the job as SUCCESS at the time of execution of transmission of the e mail message.

Thereafter when the mail transmission and reception part of the service providing system receives an error e mail message due to a wrong destination address the mail transmission and reception monitoring part detects reception of the error e mail message. It is possible for the mail transmission and reception monitoring part to identify the job correlated with the UUID by obtaining the UUID from the error e mail message.

The callback process part notifies the scan server application that the identified job has resulted in error so that it is possible for the scan server application to update the status of the job to ERROR overwrite ERROR on the status of the job .

Furthermore organization id is a company ID that identifies an organization or a group to which the end user who is a requester of the job belongs. Furthermore tasks stores one or more tasks in an array. The data structure of tasks includes type that indicates the process type task type of a task and params that indicates the parameters of file format conversion or e mail transmission specified by a user.

When multiple files are specified in the files parameter of mail sender the mail transmission part transmits an e mail message by attaching the multiple files to the single e mail message. The mail transmission part uses the output data of the conversion part . Therefore it is possible for the mail transmission part to use a function in a job such as 1.file . Accordingly it is possible for the mail transmission part to use a converted file that is the process result of a preceding task.

Here 1.file which is a method of description by the conversion part can only support specification in string format. For example it may be desired to specify a filename file by file in the mail transmission part . Therefore in order to support format such as file 1.file filename test1.doc the mail transmission part additionally includes an analysis part that supports hashes and arrays. As a result it is possible for the asynchronous conversion part to add an attribute file by file with another engine.

Referring to a required parameter from is a transmission source address and does not allow specification of multiple values. Although not required parameters at least one of optional parameters to cc and bcc has to be set. The total number of destinations is not limited.

Furthermore an optional parameter files sets information by the hash of an element attachment file by attachment file in array format. In the hash the URI of an attachment file may be specified by a value corresponding to a file key. The filename including an extension of an attachment file to be transmitted may be specified by a value corresponding to a filename key or omitted .

The default value of filename is a character string after the last of the URL specified in file . The maximum number of characters of the filename is 128 including an extension. The upper limit of the total size of files is for example 50 MB. The number of attachment files is not limited.

The optional parameter to is a destination e mail address and allows specification of multiple values in an array. The optional parameter cc is a cc e mail address and allows specification of multiple values in an array. The optional parameter bcc is a bcc e mail address and allows specification of multiple values in an array.

An optional parameter subject is an e mail subject and is for example fewer than or equal to 1 000 characters. An optional parameter body is e mail text and is for example fewer than or equal to 10 000 characters. An optional parameter charset specifies the character code of the e mail subject and the e mail text. Examples of character codes that may be specified include utf 8 us ascii iso 8859 1 iso 2022 jp shift jis and euc jp.

The mail transmission part creates for example e mail text as illustrated in . is a diagram illustrating e mail text. The mail transmission part generates e mail text as illustrated in in accordance with the multipurpose Internet mail extensions MINE standard from the obtained job information and attachment file. Then the mail transmission part requests the mail transmission and reception part to transmit the generated e mail text.

According to the service providing system it is possible for a user who executes scanning or a manager to refer to the correctly updated process results of jobs. Furthermore according to the service providing system because it is possible to correctly update the statuses of jobs an error e mail message is returned to the user or manager by the error reporting function.

Thus according to the service providing system for example the introduction of the callback process part and the mail transmission and reception monitoring part makes it possible to detect an error e mail message for e mail transmission performed asynchronously at the final step of a process. Furthermore it is possible to identify a job correlated with the error e mail message and report the error of the job to the scan server application . Accordingly it is possible to reflect the correct process result of the job in the job log.

According to an aspect of the present invention the scan server application corresponds to a process reception part the mail transmission part corresponds to a mail transmission part the mail transmission and reception monitoring part corresponds to a monitoring part the callback process part corresponds to a reporting part and the conversion part corresponds to a conversion part.

All examples and conditional language provided herein are intended for pedagogical purposes of aiding the reader in understanding the invention and the concepts contributed by the inventors to further the art and are not to be construed as limitations to such specifically recited examples and conditions nor does the organization of such examples in the specification relate to a showing of the superiority or inferiority of the invention. An information processing system a service providing system and a process result recording method have been described in detail based on one or more embodiments of the present invention. It should be understood however that the various changes substitutions and alterations could be made hereto without departing from the spirit and scope of the invention.

