---

title: Proxy device receiving specific data from instruction device in response to transmitted response data and transmitting specific data to outputting device which outputs an image and location data indicating a location in which the output data is stored
abstract: In a proxy device, an acquiring unit acquires one of outputting-device-identification data and instruction-device-identification data from a storing unit. The storing unit stores the outputting-device-identification data associated with the instruction-device-identification data. A first determining unit determines whether the acquired outputting-device-identification data is associated with the received instruction-device-identification data. A first transmitting unit transmits the received instruction data to the particular outputting device. A second receiving unit receives response data from the outputting device. A second transmitting unit transmits the received response data to the instruction device from which the received instruction data is transmitted. A third receiving unit receives specific data that is transmitted from the instruction device. The specific data is one of output data based on which the outputting device outputs an image and location data indicating a location of the output data. A third transmitting unit transmits the received specific data to the outputting device.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09191430&OS=09191430&RS=09191430
owner: BROTHER KOGYO KABUSHIKI KAISHA
number: 09191430
owner_city: Nagoya-Shi, Aichi-Ken
owner_country: JP
publication_date: 20140519
---
This application is a continuation of U.S. application Ser. No. 13 423 964 filed Mar. 19 2012 which claims priority from Japanese Patent Application No. 2011 121514 filed May 31 2011. The entire contents of the above noted applications are incorporated herein by reference.

The invention relates to a proxy device connected to a terminal device and an image outputting device.

Japanese patent application publication No. 2001 101091 describes a system that includes a client a proxy server and a printer. In this system the client transmits the URL for a file to be printed and a print command to the printer. The printer transfers the file URL to a proxy server. The proxy server acquires the file identified by the URL from a file server and returns this file to the printer. The printer then performs a printing operation based on the file received from the proxy server.

With the conventional technology described above the proxy server acquires a file from the file server using a file acquisition request when the client transmits the file URL and print command to the printer and the proxy server must store the acquired file until the printer has completed the printing operation. This can lead to problems with storage capacity if the proxy server must store a large volume of data. The invention in the following specification provides a technology capable of overcoming such disadvantages.

In order to attain the above and other objects the invention provides a proxy device. The proxy device may include a communication unit configured to communicate with a plurality of outputting devices and a plurality of instruction devices and a processor. The processor may function as an acquiring unit a first receiving unit a first determining unit a first transmitting unit a second receiving unit a second transmitting unit a third receiving unit and a third transmitting unit. The acquiring unit may acquire at least one of outputting device identification data and instruction device identification data from a storing unit. The outputting device identification data may identify a particular outputting device from among the plurality of outputting devices. The instruction device identification data identifies a particular instruction device from among the plurality of instruction devices. The storing unit may store the outputting device identification data associated with the instruction device identification data. The first receiving unit may receive via the communication unit instruction device identification data and instruction data. The first determining unit may determine whether the acquired outputting device identification data is associated with the received instruction device identification data. The first transmitting unit may transmit via the communication unit the received instruction data to the particular outputting device in response to determining that the particular outputting device identified by the acquired outputting device identification data is associated with the received instruction device identification data in the storing unit. The instruction data may instruct the determined outputting device to output an image. The second receiving unit may receive via the communication unit response data from the particular outputting device in response to the instruction data transmitted by the first transmitting unit. The second transmitting unit may transmit via the communication unit the received response data to the instruction device from which the received instruction data is transmitted. The third receiving unit may receive via the communication unit specific data that is transmitted from the instruction device in response to the response data transmitted to the instruction device by the second transmitting unit. The specific data may be one of output data based on which the outputting device outputs an image and location data indicating a location in which the output data is stored. The third transmitting unit may transmit the received specific data to the particular outputting device.

According to another aspect the invention provides a system. The system may include a proxy server a plurality of outputting devices communicable with the proxy server via a local area network and Internet and a plurality of instruction devices communicable with the proxy server. The proxy device may include a communication unit configured to communicate with a plurality of outputting devices and a plurality of instruction devices and a processor. The processor may function as an acquiring unit a first receiving unit a first determining unit a first transmitting unit a second receiving unit a second transmitting unit a third receiving unit and a third transmitting unit. The acquiring unit may acquire at least one of outputting device identification data and instruction device identification data from a storing unit. The outputting device identification data may identify a particular outputting device from among the plurality of outputting devices. The instruction device identification data identifies a particular instruction device from among the plurality of instruction devices. The storing unit may store the outputting device identification data associated with the instruction device identification data. The first receiving unit may receive via the communication unit instruction device identification data and instruction data. The first determining unit may determine whether the acquired outputting device identification data is associated with the received instruction device identification data. The first transmitting unit may transmit via the communication unit the received instruction data to the particular outputting device in response to determining that the particular outputting device identified by the acquired outputting device identification data is associated with the received instruction device identification data in the storing unit. The instruction data may instruct the determined outputting device to output an image. The second receiving unit may receive via the communication unit response data from the particular outputting device in response to the instruction data transmitted by the first transmitting unit. The second transmitting unit may transmit via the communication unit the received response data to the instruction device from which the received instruction data is transmitted. The third receiving unit may receive via the communication unit specific data that is transmitted from the instruction device in response to the response data transmitted to the instruction device by the second transmitting unit. The specific data may be one of output data based on which the outputting device outputs an image and location data indicating a location in which the output data is stored. The third transmitting unit may transmit the received specific data to the particular outputting device.

According to another aspect the invention provides an outputting device that outputting device identification data identifies. The outputting may include a communication unit communicable with a proxy device via Internet an outputting unit configured to output an image and a processor. The processor may function as a requesting unit a first receiving unit a transmitting unit a second receiving unit and a performing unit. The requesting unit may transmit via the communication unit request data requesting the proxy device to store the outputting device identification data in association with instruction device identification data identifying an instruction device with which the proxy device communicable. The first receiving unit may receive instruction data that the proxy device relays in response to the request data transmitted by the requesting unit from the instruction device identified by the instruction device identification data stored in association with the outputting device identification data the instruction data instructing the outputting unit to output the image. The transmitting unit may transmit response data when the receiving unit receives the instruction data and when the outputting unit outputs the image. The second receiving unit may receive specific data that the proxy device relays from the instruction device in response to the response data transmitted by the transmitting unit. The specific data may be one of output data based on which the outputting device outputs an image and location data indicating a location in which the output data is stored. The performing unit may perform a process to output the image by using the outputting unit in response to the specific data received by the second receiving unit.

As shown in a printing system includes a mobile telephone a multifunction peripheral MFP an access point a proxy server and a base station . The mobile telephone and the MFP function as wireless LAN terminal devices well known in the art. The MFP is also provided with a printer function a scanner function and a copier function. The access point functions as a wireless LAN access point known in the art. The proxy server is connected to the base station and access point via an Internet .

The mobile telephone is capable of performing wireless communications with the base station according to a method of mobile telephone communications while the MFP is capable of performing wireless communications with the access point exchanging digital signals representing various data. In addition the base station the access point and the proxy server can communicate with each other via the Internet . Hence the proxy server can perform data communications with the MFP and the mobile telephone . The method of communications used by the wireless LAN system conforms to the standard IEEE 802.11a b g n for example.

Next the structure of the proxy server will be described. The proxy server serves as a proxy for coordinating various data communications between a plurality of clients over a network. Here the client is the mobile telephone the MFP for example. The proxy server is primarily configured of a central processing unit CPU a storage unit and a communication unit . All of these components are interconnected via input output ports .

The CPU executes programs stored in the storage unit . The communication unit exchanges various information with the mobile telephone the MFP and the like through communications.

The storage unit includes a combination of a random access memory hereinafter referred to as RAM a read only memory hereinafter referred to as ROM a flash memory a hard disk and a buffer provided for the CPU . The storage unit stores programs . The programs include a printing application and an operating system hereinafter referred to as OS . The OS further includes a program for controlling the communication unit to implement communications. The OS also provides an application programming interface hereinafter referred to as API through which programs can acquire data acquired by various hardware or through which the programs can command the hardware. The printing application serves to instruct the CPU to implement operations on the printing system as will be described later.

The storage unit also has a table storage area . The table storage area is used to store such data as MFP identification data user ID data and a password a proxy server address a mobile telephone address and a printing status. The MFP identification data serves to identify a specific MFP among a plurality of MFPs. The device serial number is one example of MFP identification data. The user ID data and the password serve to identify a user who uses the printing system . A username is one example of the user ID data. The proxy server address is the e mail address of the proxy server . The proxy server address is used when transmitting various information and print data from the mobile telephone or the MFP to the proxy server . A user or the like may store this proxy server address in the table storage area in advance. The mobile telephone address is the e mail address of the mobile telephone . The mobile telephone address is used when the proxy server transmits various information to the mobile telephone . The printing status is data representing the current state of the printing system . One of four states is saved as the printing status. The four states include an initial state a printing reserved state a data requested state and a data provision waiting state. The printing status is one byte worth of data. In the embodiment the printing status is set to the values 1 2 3 and 4 for the initial state printing reserved state data requested state and data provision waiting state respectively.

Next the structure of the mobile telephone will be described. As shown in the mobile telephone primarily includes a CPU a storage unit a button input unit a panel a mobile telephone transceiver unit a mobile telephone antenna unit and a camera unit . The CPU executes programs stored in the storage unit . The mobile telephone is also provided with a speaker and a microphone for implementing a telephone call and voice input. All of the above components are interconnected via an input output port .

The mobile telephone transceiver unit implements wireless communications with the base station via the mobile telephone antenna unit in conformance with a mobile telephone communication method. The button input unit and the camera unit accept operations performed by the user of the mobile telephone . The panel displays information about the functions of the mobile telephone . The camera unit photographs a prescribed range of view with a charge coupled device or the like to acquire image data. The structure of the storage unit is identical to the storage unit of the proxy server described above and hence will not be described here.

Next the structure of the MFP will be described. The MFP primarily includes a CPU a storage unit a wireless transceiver unit a wireless antenna unit a button input unit a display panel a printer and a scanner all of which components are interconnected via an input output port .

The CPU executes programs stored in the storage unit . The button input unit includes keys for implementing various functions of the MFP . The display panel displays various functional data for the MFP . The printer executes printing operations. The scanner executes image reading operations. The structure of the storage unit is identical to that of the storage unit provided in the proxy server and hence will not be described here.

Next operations of the printing system according to the embodiment will be described with reference to . First an overview of the printing system will be described.

When the mobile telephone instructs the MFP to perform a printing operation the mobile telephone first notifies the proxy server with a print reservation rather than sending the print data itself. The proxy server stores data indicating the print reservation.

When receiving a print reservation confirmation request from the MFP the proxy server notifies the MFP whether a print reservation exists. The print reservation confirmation request is data that the MFP transmits to the proxy server to inquire whether the mobile telephone has transmitted a print reservation to the proxy server . The print reservation confirmation request also includes user ID data and a password from which the MFP is identified.

If a print reservation has been made the MFP transmits a print data request to the proxy server when the MFP is ready to execute the printing operation. Upon receiving the print data request from the MFP the proxy server issues a request to the mobile telephone for the print data. When the print data is received from the mobile telephone the proxy server transfers this print data to the MFP . The MFP receives the print data and executes the printing operation.

Next the operations of the proxy server will be described with reference to the flowcharts in . In S at the beginning of the process in the CPU determines whether a use registration request transmitted according to HTTP has been received from the MFP . The use registration request is data requesting initiation of a use registration process. The use registration process is performed to register the MFP on the proxy server in order that the proxy server can control the MFP to perform printing operations based on user commands received from the mobile telephone . The use registration request includes data indicating that the request is a use registration request and MFP identification data identifying the MFP . The MFP identification data enables the proxy server to recognize the MFP and more specifically is a device serial number that was stored in the MFP at the factory. The use registration process may be performed one time when the user wishes to register the MFP on the proxy server .

When the proxy server receives a use registration request S YES in S the CPU reads the MFP identification data from the use registration request received from the MFP and stores this data in the storage unit . In this case the CPU stores the MFP identification data identifying the MFP that transmitted the use registration request. In S the CPU generates user ID data and stores this data in the storage unit . The user ID data is a unique character string that enables the user to recognize the MFP registers on the proxy server . In S the CPU controls the communication unit to transmit the user ID data and the proxy server address to the MFP . The proxy server address is the e mail address of the proxy server and is required when the mobile telephone transmits e mail to the proxy server . The CPU also issues a request to the MFP for a password and the mobile telephone address in order to confirm the mobile telephone that transmitted the print reservation. The mobile telephone address is the e mail address for the mobile telephone that enables the proxy server to identify the source mobile telephone of the print reservation. The mobile telephone address also serves to identify the user of the mobile telephone . In S the CPU determines whether a password and a mobile telephone address was received from the MFP . The CPU continually loops back to S while the password and the mobile telephone address have not been received S NO and advances to S when the data has been received S YES .

In S the CPU stores the password and the mobile telephone address received from the mobile telephone in the storage unit . Next the CPU stores the user ID data and the password in association with the MFP identification data in the table storage area of the storage unit . The CPU also stores the status initial state in the table storage area in association with the MFP identification data the user ID data and the password serving as data for identifying the MFP . The CPU also stores the data for identifying the MFP in the table storage area in association with the mobile telephone address serving as data for identifying the mobile telephone .

In S the CPU controls the communication unit to transmit a registration completed response to the MFP and subsequently returns to S.

However if the proxy server has not received a use registration request in S S NO in S the CPU determines whether a print reservation was received from the mobile telephone . The print reservation is data indicating that a reservation has been made for a print job. The print reservation includes data indicating the print request the mobile telephone address of the mobile telephone and the user ID data and the password for the MFP . One byte of data is used to specify the print request. In other words the data indicating a print request is smaller in size than the print data.

When a print reservation has been received S YES in S the CPU identifies the MFP identification data corresponding to the user ID data and the password included in the print reservation by accessing the table storage area . Next the CPU changes the printing status corresponding to the identified MFP identification data to printing reserved state. In S the CPU controls the communication unit to transmit a reservation received notification to the mobile telephone and subsequently returns to S. Note that if the mobile telephone address included in the print reservation does not match the mobile telephone address associated with the user ID data and the password included in the print reservation in S the CPU simply returns to S. In other words when the print reservation received from the mobile telephone does not include the user ID data the password and the mobile telephone address received from the MFP that are registered when the use registration request was performed for the MFP it is probable that the print reservation was not received from a valid user. Therefore in S the CPU does not recognize the received print reservation as a valid reservation. When the CPU does not recognize the received print reservation as a valid reservation in S the CPU does not instruct the communication unit to transmit a reservation received notification to the mobile telephone . Further the CPU does not change the print status corresponding to the identified MFP identification data to the printing reserved state and simply returns to S.

However if a print reservation was not received from the mobile telephone in S S NO in S see the CPU determines whether a print reservation confirmation request was received from the MFP . If a print reservation confirmation request was received S YES in S the CPU identifies the MFP identification data associated with the user ID data and the password included in the print reservation confirmation request by accessing the table storage area . In S the CPU determines whether the current print status associated with the identified MFP identification data is the printing reserved state. If the printing status is currently the printing reserved state S YES in S the CPU controls the communication unit to transmit response data indicating print reservation exists to the MFP . However when the current printing status is not the printing reserved state S NO in S the CPU controls the communication unit to transmit response data indicating print reservation does not exist to the MFP . Subsequently the CPU returns to S.

On the other hand when the CPU determines in S that a print reservation confirmation request was not received from the MFP S NO in S the CPU determines whether a print data request was received from the MFP . A print data request is data serving to request that print data be transmitted to the MFP . The print data request includes the user ID data and the password for the MFP . When a print data request has been received S YES in S the CPU controls the communication unit to transmit a request received notification to the MFP .

In S the CPU identifies the MFP identification data associated with the user ID data and the password that were included in the print data request by accessing the table storage area . In S the CPU determines whether the current status associated with the MFP identification data identified in S is the printing reserved state. The CPU returns to S see when determining that the printing status is not the printing reserved state S NO and advances to S when determining that the current state is the printing reserved state S YES . In S the CPU changes the printing status associated with the identified MFP identification data to the data requested state. 

In S the CPU controls the communication unit to transmit a print data request to the mobile telephone . Specifically the CPU transmits a print data request to the mobile telephone through e mail using the mobile telephone address. The print data request is transmitted to the mobile telephone identified by the mobile telephone address associated with the MFP identification data identified in S. That is the CPU transmits the print data request to the mobile telephone that transmitted the print reservation that is the mobile telephone that is identified by using the user ID and the password of the print data request.

In S the CPU determines whether data was received from the mobile telephone indicating that the print data request was received as a response to the print data request. The CPU continues to loop back to S while a response has not been received from the mobile telephone S NO and advances to S see when a response has been received S YES .

On the other hand when the CPU determines in S that a print data request was not received from the MFP S NO in S see the CPU determines whether print data which is included in an e mail for example was received from the mobile telephone . The print data is data used by the MFP to perform a printing operation on the printer .

When an e mail including print data has been received S YES in S the CPU accesses the table storage area to identify the MFP identification data stored in association with the mobile telephone address that was the source of the transmitted e mail including the print data. Thus the mobile telephone address for the source of the transmitted print data can be identified by exchanging print data in e mail. This method improves security since the CPU can confirm whether the source of the e mail used to transmit the print data matches the mobile telephone address registered by the user during the use registration process for the MFP .

In S the CPU determines whether the current printing status associated with the MFP identification data identified in S is the data requested state. The CPU returns to S when determining that the printing status is not the data requested state S NO and advances to S when determining that the current status is the data requested state S YES .

In S the CPU stores the print data in the storage unit . Here the print data received from the mobile telephone may be stored as is in the storage unit or may be stored after first being processed to a format suitable for the MFP . In S the CPU changes the printing status associated with the MFP identification data identified in S to the data provision waiting state. In S the CPU controls the communication unit to transmit data to the mobile telephone indicating that print data has been received. Subsequently the CPU returns to S see .

However if the CPU determines in S that print data was not received from the mobile telephone S NO in S the CPU determines whether a print data acquisition request has been received from the MFP . A print data acquisition request is data requesting to begin a process in which the MFP acquires print data from the proxy server . The print data acquisition request includes the user ID data and the password of the MFP .

When the proxy server receives a print data acquisition request S YES in S the CPU identifies the MFP identification data associated with the user ID data and the password that were included in the print data acquisition request by accessing the table storage area . In S the CPU determines whether the current printing status stored in the table storage area is the data provision waiting state. The CPU advances to S when the printing status is not the data provision waiting state S NO and transmits data to the MFP indicating that no print data is stored. Subsequently the CPU returns to S.

However when the current printing status is the data provision waiting state S YES in S the CPU controls the communication unit to transmit the print data to the MFP that transmitted the print data request. In S the CPU changes the printing status to the initial state and returns to S see .

Next operations of the MFP will be described with reference to the flowcharts in . The process shown in the flowcharts of begins when the MFP is started.

In S of the CPU sets a print reservation confirmation timer. The print reservation confirmation timer is used to determine whether a second wait time has elapsed. In S the CPU determines whether the use registration process has been started. The use registration process is performed in order to register the MFP on the proxy server in order to use the MFP in the printing system . In this process the MFP acquires from the proxy server the user ID data with which the proxy server has assigned the MFP and a proxy server address required when the mobile telephone transmits e mail to the proxy server . Further the MFP transmits to the proxy server the password and the mobile telephone address that must be inputted into the mobile telephone for a print reservation. The CPU accepts user input through the button input unit to register various data.

When the use registration process has been initiated S YES in S the CPU uses the wireless transceiver unit to transmit a use registration request to the proxy server . Note that the URL of the proxy server has already been stored in the MFP and the MFP can use this URL to transmit the use registration request according to HTTP. The MFP identification data is included in the use registration request. In S the CPU determines whether the user ID data and the proxy server address was received from the proxy server in response. The CPU continually loops back to S while such data has not been received S NO and advances to S when the data has been received S YES . In S the CPU stores the user ID data and the proxy server address received in S in the storage unit . In S the CPU displays the user ID data and the proxy server address in the display panel together with a window for inputting the password and the mobile telephone address.

In S the CPU determines whether the password and the mobile telephone address were inputted via the button input unit and continually loops back to S when such data has not been inputted S NO .

When the password and the mobile telephone address have been inputted S YES in S the CPU uses the wireless transceiver unit to transmit the inputted password and the mobile telephone address to the proxy server . In S the CPU determines whether a registration completed response was received from the proxy server . The CPU returns to S if the registration completed response was not received S NO and advances to S when the response was received S YES . In S the CPU stores the password in the storage unit thereby completing the use registration process. Subsequently the process returns to S.

On the other hand if the CPU determines in S that the use registration process has not been started S NO in S see the CPU determines whether the timing for acquiring print data has arrived based on a print data acquisition timer. The print data acquisition timer is used to determine whether a first wait time has elapsed and is set in S and S described later.

When the timing for print data acquisition has arrived S YES in S the CPU uses the wireless transceiver unit to transmit the print data acquisition request to the proxy server . In S the CPU determines whether either print data or data indicating that no print data is stored was received from the proxy server . The CPU returns to S when no response has been received S NO .

However when a response has been received S YES in S the CPU determines whether the print data was received. If the print data was not received S NO in S the CPU sets the print data acquisition timer and cancels the other timers. The CPU subsequently returns to S see . However if the print data was received in S S YES in S the CPU uses the print data to execute a printing operation on the printer . In S the CPU sets the print reservation confirmation timer and cancels the other timers. Subsequently the CPU returns to S see .

On the other hand if the CPU determines in S that the timing for the print data acquisition has not arrived S NO in S see the CPU determines whether the print reservation confirmation timing has arrived based on the print reservation confirmation timer. The print reservation confirmation timer is set in S S and S described later . If the timing for the print reservation confirmation has not arrived S NO in S the CPU executes other processes such as a process using the scanner and returns to S see . However if the timing for the print reservation confirmation has arrived S YES in S the CPU uses the wireless transceiver unit to transmit the print reservation confirmation request to the proxy server .

Here the second wait time of the print reservation confirmation timer is set longer than the first wait time of the print data acquisition timer. In this way the polling for print data acquisition S can be performed more frequently than the polling for confirming whether the mobile telephone has issued a print reservation S .

In S the CPU determines whether the response data was received from the proxy server . The CPU continually loops back to S while the response data has not been received S NO and advances to S when the response data was received S YES .

In S the CPU determines whether a print reservation has been issued. More specifically the CPU determines whether the response data received from the proxy server indicates that the printing status is print reservation exists. If the status is print reservation does not exist S NO in S the CPU sets the print reservation confirmation timer and returns to S see . However if the status indicates print reservation exists S YES in S the CPU uses the wireless transceiver unit to transmit a print data request to the proxy server .

In S the CPU determines whether the request received notification was received from the proxy server . The CPU continually loops back to S while the request received notification has not been received S NO and advances to S when the notification has been received S YES . In S the CPU sets the print data acquisition timer and cancels all other timers. Subsequently the CPU returns to S see .

Next the operations of the mobile telephone will be described with reference to the flowcharts in . The process described in begins when the mobile telephone is started. In S of the CPU determines whether a print reservation process has been started. The print reservation process is performed to control the MFP to print the print data.

When the CPU determines that the print reservation process has begun S YES in S the CPU displays a window on the panel for inputting the user ID data and the password. When the user has registered the MFP on the proxy server the MFP displays the user ID data received from the proxy server on the display panel in S. When the MFP is registered on the proxy server in S the user inputs the password and the mobile telephone address through the button input unit . Hence the user that registered the MFP on the proxy server can input through the button input unit of the mobile telephone the user ID data displayed in the display panel of the MFP and the password registered on the proxy server through the button input unit of the MFP .

In S the CPU determines whether operations performed by the user to input the user ID data and the password were received through the button input unit . The CPU continually loops back to S while the input has not been received S NO and advances to S when the input has been received S YES . In S the CPU transmits a print reservation including the inputted user ID data and the password to the proxy server . Note that the URL of the proxy server has already been stored in the mobile telephone and the CPU uses the URL of the proxy server to transmit a print reservation according to HTTP.

In S the CPU determines whether a reservation received notification was received from the proxy server . The CPU continually loops back to S while a reservation received notification has not been received S NO and advances to S when a notification has been received S YES . In S the CPU displays a message on the panel indicating that the reservation has been completed and subsequently returns to S.

However if the CPU determines in S that a print reservation process has not been initiated S NO in S see the CPU determines whether the print data request was received from the proxy server . If a print data request was received S YES in S the CPU uses the mobile telephone transceiver unit to transmit data to the proxy server indicating that the print data request was received.

In S the CPU displays a window on the panel for selecting print data to be transmitted. In S the CPU determines whether a selection of print data was made through the button input unit . The CPU continually loops back to S while the selection has not been made S NO and advances to S when the selection has been made S YES . In S the CPU controls the mobile telephone transceiver unit to transmit the selected print data to the proxy server using the proxy server address. The print data is transmitted through e mail using the proxy server address as the transmission destination and the mobile telephone address as the transmission source. In S the CPU determines whether data indicating that the print data was successfully received is received from the proxy server . The CPU continually loops back to S while such data has not been received S NO and returns to S when the data has been received S YES .

On the other hand if the CPU determines in S that the print data request was not received S NO in S the CPU determines whether a process to register a proxy server address has been initiated. The process to register a proxy server address is performed to register the proxy server address in order to make use of the printing system . Here the proxy server address is the e mail address of the proxy server . If the process to register the proxy server address has not been initiated S NO in S the CPU executes other processes and subsequently returns to S see .

However if the process to register the proxy server address has begun S YES in S the CPU displays a window on the panel for inputting the proxy server address. At this time the user who registered the MFP on the proxy server can input the proxy server address displayed in the display panel of the MFP through the button input unit of the mobile telephone . In S the CPU determines whether the proxy server address has been inputted through the button input unit and continually loops back to S while the proxy server address has not been inputted S NO . When the proxy server address has been inputted S YES in S the CPU records the inputted proxy server address in the storage unit and subsequently returns to S.

Next a sample operation performed on the printing system will be described with reference to a sequence diagram in . When the use registration process is started on the MFP at a time T S YES the MFP transmits a use registration request to the proxy server S . After the proxy server receives the use registration request S YES the proxy server reads the MFP identification data from the use registration request and stores this data in the storage unit S . The proxy server also generates the user ID data and stores this data in the storage unit S . Next the proxy server transmits the user ID data and the proxy server address to the MFP S . The MFP stores the user ID data and the proxy server address received from the proxy server in the storage unit S . The MFP transmits the user inputted password and the mobile telephone address to the proxy server S . The proxy server stores the password and the mobile telephone address received from the MFP in the table storage area S . Next the proxy server sets the printing status to the initial state. 

When the timing arrives for the print reservation confirmation at a time T S YES the MFP transmits the print reservation confirmation request to the proxy server S . After receiving the print reservation confirmation request S YES the proxy server confirms the printing status S . Since the printing status is not the printing reserved state S NO the proxy server transmits response data to the MFP indicating print reservation does not exist S . Thus the MFP determines that the print reservation has not been made S NO and sets the print reservation confirmation timer S .

At a time T when a print reservation process is started on the mobile telephone S YES the mobile telephone transmits the print reservation to the proxy server S . Upon receiving the print reservation S YES the proxy server changes the printing status to the printing reserved state S .

At a time T when the timing of the print reservation confirmation has arrived S YES the MFP transmits the print reservation confirmation request to the proxy server S . Upon receiving the print reservation confirmation request S YES the proxy server reconfirms the printing status S . Since the printing status is now the printing reserved state S YES the proxy server transmits response data to the MFP indicating print reservation exists S . The MFP determines that the print reservation has been made S YES and transmits the print data request to the proxy server S . Upon determining that the print data request was received from the MFP S YES the proxy server transmits the print data request to the mobile telephone S . Subsequently the mobile telephone receives the print data request S YES .

At a time T when the timing for the print data acquisition has arrived S YES the MFP transmits a print data acquisition request to the proxy server S . Upon receiving the print data acquisition request S YES the proxy server confirms the printing status S . Since the current printing status is not the data provision waiting state S NO the proxy server transmits data to the MFP indicating that no print data is currently stored S .

At a time T when the mobile telephone transmits print data to the proxy server S the proxy server receives S YES and stores the print data S .

At a time T when the timing for print data acquisition has arrived S YES the MFP retransmits the print data acquisition request to the proxy server S . Upon receiving the print data acquisition request S YES the proxy server confirms the printing status S . Since the printing status is currently the data provision waiting state S YES the proxy server transmits the print data to the MFP S and changes the printing status to the initial state S . The MFP receives the print data S YES and executes a printing operation based on this print data S .

The printing system according to the embodiment described above has the following effects. When the proxy server receives a print reservation from the mobile telephone S YES and when the proxy server receives a print data request from the MFP S YES the proxy server transmits a print data request to the mobile telephone S . Upon receiving the print data request S YES the mobile telephone transmits the print data to the proxy server S . The proxy server relays the print data received from the mobile telephone to the MFP S .

Through this method the proxy server need not store actual print data in the storage unit during the period after the mobile telephone has outputted a print reservation and until the print data is received by the proxy server but may simply store printing reserved state as the printing status associated with the MFP identification data identified by user ID data and a password included in the print reservation. Since the volume of data used in the printing status is much smaller than that of the print data this technique helps avoid such problems as insufficient storage space in the storage unit of the proxy server .

Further the proxy server in the embodiment can identify the printing system or the MFP based on the received print reservation or the print data request. Accordingly the communication of print reservations print data and the like between the mobile telephone and the MFP can be performed through the proxy server .

Further polling for print data acquisitions S is performed by the MFP at a greater frequency than polling to confirm whether the mobile telephone has issued a print reservation S . This configuration prevents an increase of traffic on the proxy server and can reduce the time required for receiving print data.

While the invention has been described in detail with reference to the embodiment thereof it would be apparent to those skilled in the art that various changes and modifications may be made therein without departing from the scope of the invention.

The printing system may be configured to display a preview of print data on the MFP based on a command from the mobile telephone . In this variation the mobile telephone may generate preview data from the print data such that the preview data is smaller in size than the print data. For example the preview data may be of a size sufficient for displaying a thumbnail image in the display panel of the MFP . In S see the mobile telephone may transmit the preview data to the proxy server together with a print reservation. The proxy server receives the print reservation and preview data in S see and stores this data in the storage unit .

In another variation for displaying a preview in S see the mobile telephone may be configured to transmit data specifying the location of preview data to the proxy server together with a print reservation. An example of data indicating the location of the preview data is a URL specifying the region on a server in which the preview data is stored. In this case the proxy server receives the URL and print reservation in S see acquires the preview data using the URL and stores the preview data in the storage unit .

In another variation for displaying a preview in S see the mobile telephone may transmit the print data itself to the proxy server together with a print reservation. In this case the proxy server receives the print data in S see and stores the print data in the storage unit . The proxy server subsequently generates preview data based on the stored print data and deletes the print data after the preview data has been generated.

In all of the variations for displaying a preview of the image to be printed the proxy server transmits response data specifying print reservation exists together with the preview data stored in the storage unit to the MFP in S see . When the MFP determines in S see that the status is print reservation exists the MFP displays a thumbnail image on the display panel based on the preview data and waits for input indicating whether or not to print the image. When the user inputs a command to execute the printing operation the MFP advances to S and transmits a print data request to the proxy server . In this way the MFP can display a preview of the print data so that the user can determine whether or not to print the image. In S the proxy server may transmit the location of the preview data and in S the MFP may acquire the preview data based on the location of the preview data.

In the embodiment described above the print reservation includes data identifying the mobile telephone and data identifying the MFP . Here the data identifying the mobile telephone is a mobile telephone address and data identifying the MFP is user ID data and a password. However the print reservation may instead include the user ID data but not the mobile telephone address for example. In this case the CPU identifies the mobile telephone address stored in the table storage area in association with user ID data identical to the user ID data included in the print reservation and uses this identified mobile telephone address in subsequent processing. Alternatively the print reservation may include the mobile telephone address but not the user ID data. In this case the CPU identifies the user ID data stored in the table storage area in association with a mobile telephone address identical to the mobile telephone address included in the print reservation and uses this user ID data in subsequent processing.

There are various methods in which the proxy server can store each sets of data such that the each sets of data is associated with each other in S of . For example the MFP identification data may be associated with the user ID data and password by storing the data in sequential memory addresses. Alternatively the memory address at which the MFP identification data is stored and the memory address at which the user ID data and password are stored may be stored such that these memory addresses are associated with each other. The same method may be used for storing the data identifying the MFP and data identifying the mobile telephone such that the data identifying the MFP is associated with the data for identifying the mobile telephone . Here the data identifying the MFP is MFP identification data user ID data and password and the data identifying the mobile telephone is mobile telephone address.

Further the table storage area for storing various correlated data need not be provided in the proxy server but may be provided in external storage means such as network storage that is accessible to the proxy server .

Further the mobile telephone address is data used for identifying the mobile telephone but may also be considered data for identifying the user of the mobile telephone . Hence any data capable of identifying the mobile telephone such as a MAC address an IP address a serial number of the mobile telephone a telephone number of the mobile telephone or a user code for the mobile telephone may be used in place of the e mail address.

The MFP identification data is not limited to a serial number. Any data capable of identifying individual MFPs may be used as the MFP identification data such as a MAC address an IP address or a node name.

Further the CPU may also return to S from S when determining that the mobile telephone address associated with the user ID data and password included in the print reservation is not stored in the table storage area . In other words when the print reservation received from the mobile telephone does not include the mobile telephone address received from the MFP when the use registration process was performed for the MFP it is possible that the print reservation was not received from a valid user. Therefore in S the CPU does not recognize the received print reservation as a valid reservation.

Further when the CPU does not recognize the received print reservation as a valid reservation in S the CPU may control the communication unit to transmit a reservation denied notification to the mobile telephone .

Further while the mobile telephone transmits print data using e mail in S see another method may be used to transmit print data provided that the source of the communication can be identified. The proxy server may also be configured to store data for identifying the mobile telephone used for communication purposes in the same way that the mobile telephone address was stored in the embodiment in association with data identifying the MFP when performing the use registration process for registering the MFP on the proxy server . Here the data identifying the MFP is the MFP identification data user ID data and password. By storing data identifying the mobile telephone for communication purposes the proxy server can identify mobile telephones that are the source of a transmission regardless of the method of communications.

Further the proxy server may store any type of data for identifying the mobile telephone such as the IP address of the mobile telephone in association with data identifying the MFP during the use registration request for the MFP even when employing a method of communication with which the transmission source is difficult to identify. As long as the mobile telephone transmits data capable of identifying the mobile telephone with the print data the proxy server can identify the transmission source by comparing this data to the stored data.

There are a variety of other configurations possible for transmitting print data from the mobile telephone to the proxy server in S see . For example when the mobile telephone receives a print data request from the proxy server in S the mobile telephone may be configured to return the print data to the proxy server automatically.

Alternatively in S the mobile telephone may be configured to transmit data indicating the location of the print data to the proxy server such as a URL for the print data. With this configuration the proxy server acquires the print data in S using the data specifying the location of the print data and transmits the acquired print data to the MFP .

The source from which the proxy server acquires data required to communicate with the mobile telephone may also be the mobile telephone and is not limited to the MFP . For example in S see the proxy server need not receive the mobile telephone address from the MFP . In this case in S the proxy server stores only the received password in the storage unit . In S the proxy server stores a mobile telephone address included in a print reservation received from the mobile telephone in the table storage area of the storage unit in association with data identifying the MFP . Further in S the proxy server may transmit a print data request received from the MFP to the mobile telephone using the mobile telephone address included in the print reservation received from the mobile telephone for example.

The proxy server may also be configured to generate a unique reservation number for each print reservation received from the mobile telephone and may use this reservation number as the data identifying the MFP in place of the user ID data. The proxy server may also delete a reservation number used as the data for identifying the MFP after transmitting print data to the MFP and may generate separate reservation numbers for new print reservations.

In the embodiment the mobile telephone transmits data indicating a print request the mobile telephone address of the mobile telephone and user ID data and a password for the MFP to the proxy server as a print reservation and the proxy server confirms the MFP identification data associated with the user ID data and password in S. However the mobile telephone may be configured not to transmit user ID data for the MFP to the proxy server in the print reservation. In this case in S the proxy server may be configured to confirm the MFP identification data associated with the mobile telephone address included in the print reservation in order to identify the MFP . Also in this case the proxy server need not generate user ID data in the use registration process.

The invention is not limited to a printing system that includes a single mobile telephone and a single MFP but may also be applied to a printing system possessing a plurality of either or both. In such a system the proxy server can receive print data from an unspecified number of mobile telephones and can transfer this print data to MFPs associated with each of the mobile telephones .

The printing system according to the embodiment controls the MFP to print the print data based on a command configured of a print reservation from the mobile telephone . However the invention may be applied to a display system for controlling the MFP to display image data based on a command received from the mobile telephone . In this case when the proxy server receives a display reservation from the mobile telephone S YES and receives an image data request from the MFP S YES the proxy server transmits the image data request to the mobile telephone S . Upon receiving this image data request S YES the mobile telephone transmits image data to the proxy server S . The proxy server transmits the image data received from the mobile telephone to the MFP S . Next the MFP displays the image data received from the proxy server on the display panel S . With this configuration the proxy server need not store image data in the storage unit during the period after receiving a display reservation from the mobile telephone until image data is received from the mobile telephone .

The programs in the embodiment may also be configured as a single program module or as a plurality of program modules. Each of the portions and the processes in the embodiment given above may be replaced with a different configuration within the scope of the invention. For example a computer e.g. the CPU may execute a process based on an image processing program e.g. the printing application . The computer may execute a process based on programs other than the image processing program such as the operating system or another application. A hardware configuration may be used to perform operations according to instructions from the computer. The computer and the hardware configuration may be designed to work together. A computer may also be used to execute a process by coordinating multiple processes based on a plurality of programs and a hardware configuration may perform operations based on instructions from the computer executing a process by coordinating multiple processes based on the plurality of programs.

