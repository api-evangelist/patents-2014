---

title: Predictive touch surface scanning
abstract: A method for locating a conductive object at a touch-sensing surface may include detecting a first resolved location for the conductive object at the touch-sensing surface based on a first scan of the touch-sensing surface, predicting a location for the conductive object, and determining a second resolved location for the conductive object by performing a second scan of a subset of sensor electrodes of the touch-sensing surface, wherein the subset of sensor electrodes is selected based on the predicted location of the conductive object.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09417728&OS=09417728&RS=09417728
owner: PARADE TECHNOLOGIES, LTD.
number: 09417728
owner_city: Santa Clara
owner_country: US
publication_date: 20140512
---
This application is a continuation of U.S. patent application Ser. No. 13 591 145 filed Aug. 21 2012 which claims priority to U.S. Provisional Patent Application No. 61 557 148 filed on Nov. 8 2011 and which is a continuation in part of U.S. patent application Ser. No. 13 250 379 filed on Sep. 30 2011 which is a continuation in part of U.S. patent application Ser. No. 12 844 798 filed on Jul. 27 2010 which claims priority to U.S. Provisional Application No. 61 229 236 filed on Jul. 28 2009 all of which are incorporated by reference herein in their entirety.

This disclosure relates to the field of touch sensors and in particular to performing measurement scans of capacitive touch sensor arrays.

Computing devices such as notebook computers personal data assistants PDAs kiosks and mobile handsets have user interface devices which are also known as human interface devices HID . One user interface device that has become more common is a touch sensor pad also commonly referred to as a touchpad . A basic notebook computer touch sensor pad emulates the function of a personal computer PC mouse. A touch sensor pad is typically embedded into a PC notebook for built in portability. A touch sensor pad replicates X Y movement using a collection of capacitive sensor electrodes arranged along two defined axes that detect the presence or proximity of one or more conductive objects such as a finger. Mouse right left button clicks can be replicated by two mechanical or capacitive sensed buttons located in the vicinity of the touchpad or by tapping commands or other gestures on the touch sensor pad itself. The touch sensor pad provides a user interface device for performing such functions as positioning a pointer or selecting an item on a display. These touch sensor pads may include multi dimensional sensor arrays for determining movement of the conductive object in multiple axes. The sensor array may include a one dimensional sensor array detecting movement in one axis. The sensor array may also be two dimensional detecting movements in two axes.

Another user interface device that has become more common is a touch screen. Touch screens also known as touchscreens touch windows touch panels or touchscreen panels are transparent display overlays which are typically either pressure sensitive resistive or piezoelectric electrically sensitive capacitive acoustically sensitive surface acoustic wave SAW or photo sensitive infra red . Such overlays allow a display to be used as an input device removing the keyboard and or the mouse as the primary input device for interacting with the displayed image s content. Such displays can be attached to computers or as terminals to networks. Touch screens have become familiar in retail settings on point of sale systems on ATMs on mobile handsets on kiosks on game consoles and on PDAs where a stylus is sometimes used to manipulate the graphical user interface GUI and to enter data. A user can touch a touch screen or a touch sensor pad to manipulate data. For example a user can apply a single touch by using a finger to touch the surface of a touch screen to select an item from a menu.

The following description sets forth numerous specific details such as examples of specific systems components methods and so forth in order to provide a good understanding of several embodiments of the present invention. It will be apparent to one skilled in the art however that at least some embodiments of the present invention may be practiced without these specific details. In other instances well known components or methods are not described in detail or are presented in a simple block diagram format in order to avoid unnecessarily obscuring the present invention. Thus the specific details set forth are merely exemplary. Particular implementations may vary from these exemplary details and still be contemplated to be within the spirit and scope of the present invention.

In one embodiment a capacitive touch sensing surface may be used to track locations of one or more conductive objects in contact or in close proximity to the touch sensing surface by scanning each of a number of intersections between capacitive sensor electrodes. In one embodiment a touch may be detected at the touch sensing surface when a conductive object such as a finger contacts or is in close proximity to the touch sensing surface. An intersection between two sensor electrodes may be understood as a location at which one sensor electrode crosses over or overlaps another while maintaining galvanic isolation from each other. A scan may include a series of mutual capacitance measurements between pairs of intersecting sensor electrodes spanning all or a portion of the touch sensing surface. An embodiment of scanning of such a capacitive touch sensing surface within a touch sensing device may decrease power consumption and increase noise immunity by limiting the number of intersections scanned for identifying a location of the one or more conductive objects. In one embodiment limiting the number of scanned intersections may further increase accuracy reduce response time and improve refresh rate of the touch sensing device.

In one embodiment a processing device may perform a first scan of the touch sensing surface to detect and resolve the location of a conductive object. Based on this resolved i.e. calculated location the processing device may predict a location or a set of possible future locations for the conductive object. For example the processing device may calculate a predicted location of the conductive object based on the last known or previously resolved locations the velocity the acceleration or a mix thereof of the conductive object. Alternatively the processing device may determine a search window including all or most of the locations that the conductive object is likely to be found during a subsequent scan. In one embodiment the prediction may also be based on the duration between the first scan and the next subsequent scan. In one embodiment the search window may be rectangular. In an alternative embodiment the search window may be some other non square or non rectangular shape.

Having determined a search window associated with the predicted location of the conductive object the processing device may invoke a scan of intersections within the search window which may include intersections near the predicted location. The conductive object can thus be tracked over time by performing a series of local scans comprising the limited number of intersections where the conductive object is likely to be located. In the rare event that the location of the conductive object cannot be accurately resolved using data from a local scan additional intersections up to or including the whole panel may be sensed in order to determine the location of the object.

In one embodiment the sensor array includes sensor electrodes N where N is a positive integer that are disposed as a two dimensional matrix also referred to as an XY matrix . The sensor array is coupled to pins N of the processing device via one or more analog buses transporting multiple signals. In an alternative embodiment without an analog bus each pin may instead be connected either to a circuit that generates a TX signal or to an individual RX sensor circuit.

In one embodiment the capacitance sensor may include a relaxation oscillator or other means to convert a capacitance into a measured value. The capacitance sensor may also include a counter or timer to measure the oscillator output. The processing device may further include software components to convert the count value e.g. capacitance value into a touch detection decision also referred to as switch detection decision or relative magnitude. It should be noted that there are various known methods for measuring capacitance such as current versus voltage phase shift measurement resistor capacitor charge timing capacitive bridge divider charge transfer successive approximation sigma delta modulators charge accumulation circuits field effect mutual capacitance frequency shift or other capacitance measurement algorithms. It should be noted however instead of evaluating the raw counts relative to a threshold the capacitance sensor may be evaluating other measurements to determine the user interaction. For example in the capacitance sensor having a sigma delta modulator the capacitance sensor is evaluating the ratio of pulse widths of the output i.e. density domain instead of the raw counts being over or under a certain threshold.

In one embodiment the processing device further includes processing logic . Operations of the processing logic may be implemented in firmware alternatively they may be implemented in hardware or software. The processing logic may receive signals from the capacitance sensor and determine the state of the sensor array such as whether an object e.g. a finger is detected on or in proximity to the sensor array e.g. determining the presence of the object resolve where the object is on the sensor array e.g. determining the location of the object tracking the motion of the object or other information related to an object detected at the touch sensor.

In another embodiment instead of performing the operations of the processing logic in the processing device the processing device may send the raw data or partially processed data to the host . The host as illustrated in may include decision logic that performs some or all of the operations of the processing logic . Operations of the decision logic may be implemented in firmware hardware software or a combination thereof. The host may include a high level Application Programming Interface API in applications that perform routines on the received data such as compensating for sensitivity differences other compensation algorithms baseline update routines start up and or initialization routines interpolation operations or scaling operations. The operations described with respect to the processing logic may be implemented in the decision logic the applications or in other hardware software and or firmware external to the processing device . In some other embodiments the processing device is the host .

In another embodiment the processing device may also include a non sensing actions block . This block may be used to process and or receive transmit data to and from the host . For example additional components may be implemented to operate with the processing device along with the sensor array e.g. keyboard keypad mouse trackball LEDs displays or other peripheral devices .

The processing device may reside on a common carrier substrate such as for example an integrated circuit IC die substrate or a multi chip module substrate. Alternatively the components of the processing device may be one or more separate integrated circuits and or discrete components. In one embodiment the processing device may be a Programmable System on a Chip PSoC processing device developed by Cypress Semiconductor Corporation San Jose Calif. Alternatively the processing device may be one or more other processing devices known by those of ordinary skill in the art such as a microprocessor or central processing unit a controller special purpose processor digital signal processor DSP an application specific integrated circuit ASIC a field programmable gate array FPGA or other programmable device. In an alternative embodiment for example the processing device may be a network processor having multiple processors including a core unit and multiple micro engines. Additionally the processing device may include any combination of general purpose processing device s and special purpose processing device s .

In one embodiment the electronic system is implemented in a device that includes the touch sensing surface as a user input device such as handheld electronics portable telephones cellular telephones notebook computers personal computers personal data assistants PDAs kiosks keyboards televisions remote controls monitors handheld multi media devices handheld video players gaming devices control panels of a household or industrial appliances or other computer peripheral or input devices. Alternatively the electronic system may be used in other types of devices. It should be noted that the components of electronic system may include all the components described above. Alternatively electronic system may include only some of the components described above or include additional components not listed herein.

Capacitance sensor includes multiplexer control demultiplexer multiplexer clock generator signal generator demodulation circuit and analog to digital converter ADC . ADC is further coupled with touch coordinate converter . Touch coordinate converter may be implemented in the processing logic .

The transmit and receive electrodes in the electrode matrix may be arranged so that each of the transmit electrodes overlap and cross each of the receive electrodes such as to form an array of intersections while maintaining galvanic isolation from each other. Thus each transmit electrode may be capacitively coupled with each of the receive electrodes. For example transmit electrode is capacitively coupled with receive electrode at the point where transmit electrode and receive electrode overlap.

Clock generator supplies a clock signal to signal generator which produces a TX signal to be supplied to the transmit electrodes of touch sensor . In one embodiment the signal generator includes a set of switches that operate according to the clock signal from clock generator . The switches may generate a TX signal by periodically connecting the output of signal generator to a first voltage and then to a second voltage wherein said first and second voltages are different.

The output of signal generator is connected with demultiplexer which allows the TX signal to be applied to any of the M transmit electrodes of sensor array . In one embodiment multiplexer control controls demultiplexer so that the TX signal is applied to each transmit electrode in a controlled sequence. Demultiplexer may also be used to ground float or connect an alternate signal to the other transmit electrodes to which the TX signal is not currently being applied. In an alternate embodiment the TX signal may be presented in a true form to a subset of the transmit electrodes and in complement form to a second subset of the transmit electrodes wherein there is no overlap in members of the first and second subset of transmit electrodes .

Because of the capacitive coupling between the transmit and receive electrodes the TX signal applied to each transmit electrode induces a current within each of the receive electrodes. For instance when the TX signal is applied to transmit electrode through demultiplexer the TX signal induces an RX signal on the receive electrodes in matrix . The RX signal on each of the receive electrodes can then be measured in sequence by using multiplexer to connect each of the N receive electrodes to demodulation circuit in sequence.

The mutual capacitance associated with the intersections of all TX electrodes and RX electrodes can be measured by selecting every available combination of TX electrode and an RX electrode using demultiplexer and multiplexer . To improve performance multiplexer may also be segmented to allow more than one of the receive electrodes in matrix to be routed to additional demodulation circuits . In an optimized configuration wherein there is a 1 to 1 correspondence of instances of demodulation circuit with receive electrodes multiplexer may not be present in the system.

When a conductive object such as a finger approaches the electrode matrix the object causes a decrease in the measured mutual capacitance between only some of the electrodes. For example if a finger is placed near the intersection of transmit electrode and receive electrode the presence of the finger will decrease the charge coupled between electrodes and . Thus the location of the finger on the touchpad can be determined by identifying the one or more receive electrodes having a decrease in measured mutual capacitance in addition to identifying the transmit electrode to which the TX signal was applied at the time the decrease in capacitance was measured on the one or more receive electrodes.

By determining changes in the mutual capacitances associated with each intersection of electrodes in the matrix the presence and locations of one or more conductive objects may be determined. The determination may be sequential in parallel or may occur more frequently at commonly used electrodes.

In alternative embodiments other methods for detecting the presence of a finger or other conductive object may be used where the finger or conductive object causes an increase in measured capacitance at one or more electrodes which may be arranged in a grid or other pattern. For example a finger placed near an electrode of a capacitive sensor may introduce an additional capacitance to ground that increases the total capacitance between the electrode and ground. The location of the finger can be determined based on the locations of one or more electrodes at which a change in measured capacitance is detected and the associated magnitude of capacitance change at each respective electrode.

The induced current signal is integrated by demodulation circuit . The rectified current output by demodulation circuit can then be filtered and converted to a digital code by ADC .

A series of such digital codes measured from adjacent sensor intersections when compared to or offset by the associated codes of these same sensors in an un touched state may be converted to touch coordinates indicating a position of an input on touch sensor array by touch coordinate converter . The touch coordinates may then be used to detect gestures or perform other functions by the processing logic .

In one embodiment the processing device is connected to a host which may receive the measured capacitances or calculated centroid locations from the processing device .

The sensor array illustrated in includes sensor electrodes arranged to create a pattern of interconnected diamond shapes. Specifically the sensor electrodes of sensor array form a single solid diamond SSD pattern. In one embodiment each intersection between a row electrode and a column electrode defines a unit cell. Each point within the unit cell is closer to the associated intersection than to any other intersection. For example unit cell contains the points that are closest to the intersection between row electrode and column electrode .

In one embodiment a capacitive touch sensing system may collect data from the entire touch sensing surface by performing a scan to measure capacitances of the unit cells that comprise the touch sensing surface then process the data serially or in parallel with a subsequent scan. For example one system that processes data serially may collect raw capacitance data from each unit cell of the entire touch sensing surface and filter the raw data. Based on the filtered raw data the system may determine local maxima corresponding to local maximum changes in capacitance to calculate positions of fingers or other conductive objects then perform post processing of the resolved positions to report locations of the conductive objects or to perform other functions such as motion tracking or gesture recognition.

In one embodiment a touch sensing system may be configured to perform one or both of self capacitance sensing and mutual capacitance sensing. One embodiment of a capacitive touch sensing system that is configured to perform self capacitance sensing may in sequence or in parallel measure the self capacitance of each row and column sensor electrode of the touch sensing surface such that the total number of sense operations is N M for a capacitive sensor array having N rows and M columns. In one embodiment the touch sensing system may be capable of connecting individual sensor electrodes together to be sensed in parallel with a single operation. For example multiple row and or column sensor electrodes may be coupled together and sensed in a single operation to determine whether a conductive object is touching or near the touch sensing surface. In an alternate embodiment the touch sensing system may be capable of connecting each row sensor electrode to it is own sensor circuit such that all row electrodes may be sensed in parallel with a single operation. The touch sensing system may also be capable of connecting each column sensor electrode to its own sensor circuit such that all column electrodes may be sensed in parallel with a single operation. The touch sensing system may also be capable of connecting all row and column electrodes to their own sensor circuits such that all row and column electrodes may be sensed in parallel with a single operation.

In one embodiment a touch sensing system may perform mutual capacitance sensing of the touch sensing surface by individually sensing each intersection between a row electrode and a column sensor electrode. Thus a total number of sense operations for a capacitive touch sensor having X rows and Y columns is X Y. In one embodiment performing a mutual capacitance measurement of a unit cell formed at the intersection of a row electrode and a column electrode includes applying a signal TX to one electrode and measuring characteristics of the signal on another electrode resulting from the capacitive coupling between the electrodes.

In one embodiment multiple capacitance sensing circuits may be used in parallel to measure a signal coupled to multiple column electrodes simultaneously from a signal applied to one or more row electrodes. In one embodiment for a capacitive sensor array having X rows Y columns and N columns that can be sensed simultaneously the number of mutual capacitance sensing operations is the smallest whole number greater than or equal to X Y N.

The power consumption of a self capacitance or mutual capacitance touch sensing system may be decreased by limiting scans to a portion of the touch sensing surface. Limiting the scan may further result in higher immunity from noise as well as higher accuracy response time and refresh rate when tracking a conductive object.

As an example a touch sensing system may have X 16 rows Y 24 columns and N 8 columns that can be sensed simultaneously. Such a touch sensing system when configured to measure an 8 8 block of unit cells as a search window may track a presence and location of a conductive object using 8 sensing operations for each update of the touch locations. The same system performing a scan of the entire touch sensing surface would use 48 sensing operations per update. Thus in this particular example local scanning results in a 6 improvement in scan time and similar reduction in power to perform the scan.

In one embodiment each update of the touch locations may include a sensing portion and a non sensing portion. The sensing portion may include measurement of capacitance associated with intersections between sensor electrodes while the non sensing portion may include calculation of touch locations based on the capacitance measurements and reporting of the calculated touch locations to a host device.

In one embodiment a 5.5 inch diagonal panel composed of 500 unit cells using a 7 7 search window may reduce scanning time by a factor of 10 as compared to a full scan. This reduced scanning time may further affect many of the critical parameters of a touchscreen system such as power consumption signal to noise ratio refresh rate and accuracy.

In one embodiment a size of a search window over which a touch sensing system may perform a local scan may be determined based on an expected maximum velocity of a finger or other conductive object to be tracked by the touch sensing system. For example a capacitive sensor array may have an electrode pitch of 5 mm and may be scanned at a rate of 100 Hz. For a touch sensing application a finger on a touchscreen may move as fast as 1 meter per second over the sensor array with speeds much faster than a few hundred millimeters per second being relatively uncommon.

In such a touch sensing system it will be unusual for a finger to have moved more than a few millimeters during a time interval between scans. Thus the search window may be sized to include substantially all of the predicted locations of the conductive object given the expected rate of travel of the conductive object. For example the local scan may include all or a subset of the intersections within an 8 8 area of unit cells which would be large enough to accommodate the maximum expected travel distance for the finger or other conductive object of a few millimeters per scan interval if the local scan window were centered on the centroid of the resolved touch in the previous scan.

In one embodiment a touch sensing system may determine a location of the search window over which to perform a local scan based on a predicted location of a conductive object such as a finger. For example the system may predict a location where a finger is expected to be during the time of a subsequent scan and perform a local scan including intersections of sensor electrodes around the predicted location. In one embodiment the system identifies a search window which is an area including intersections to be scanned during the local scan. In one embodiment the search window includes the predicted location of the conductive object. In one embodiment the predicted location of the conductive object is the calculated location of the conductive object from the previous scan.

In one embodiment the touch sensing system uses the location of the conductive object as determined by an initial scan as the predicted location of the conductive object for a subsequent local scan. In one embodiment the touch sensing system may also account for the velocity or acceleration of a conductive object that is in motion. For example the system may determine the last known position velocity and acceleration of the conductive object based on previously resolved positions of the conductive object in order to calculate a predicted location for the conductive object at a time when the subsequent local scan is scheduled to be performed.

In one embodiment a process for locating a contact using a local scan begins by calculating an expected contact location. In one embodiment a touch sensing system may operate based on assuming that the contact location of a conductive object proximate to the touch sensing surface is moving sufficiently slowly that the last known location of the contact can be used to approximate the predicted location of the contact for a subsequent scan.

In one embodiment the suitability of using the last known contact location as a predicted location may depend on factors including the scanning rate of the touch sensing system the size of the sensor electrodes the expected maximum velocity of the conductive object and the size of the search window.

For example a touch sensing panel that is scanned at 200 Hz with a unit cell size of 5 5 mm would still be able to locate a conductive object such as a finger moving at 200 Hz 5 mm 1 m s using a search window that includes a border that is at least one additional buffer unit cell wide on all sides of the minimum area of unit cells used by the system for determining the centroid location of the contact. For example if the touch sensing system uses minimum of a 6 6 grid of unit cells to calculate the centroid location of the conductive object the size of the search window would be 8 8 unit cells.

In an alternative embodiment the predicted location of the conductive object may be based on previously determined locations of the contact location. In one embodiment the previous locations of the contact may be used to calculate a velocity and acceleration of the contact. Calculation of the predicted contact location based on velocity may increase the accuracy of the prediction particularly for a contact moving at a substantially constant rate. Compensating for acceleration of the moving contact may further increase the prediction accuracy for contacts that are not moving at a constant velocity.

In one embodiment the touch sensing system scans the intersections within the search window by performing capacitance measurements using the rows and columns the result of such measurements are used to resolve a location of the conductive object within the search window . In one embodiment the capacitance measurements may be mutual capacitance measurements between individual row and column sensor electrodes. Alternatively the touch sensing system may perform a self capacitance scan of each of the row electrodes and column electrodes to determine a detected location of the conductive object within the search window . For example a self capacitance scan of the row and column electrodes spanning local scan search window may result in a self capacitance profile including column capacitances and row capacitances .

Capacitance measurements collected from scanning the search window may be analyzed to determine whether a presence of a finger or other conductive object has been detected within the search area . In one embodiment if a contact is detected wholly within the search area the touch sensing system may proceed with resolving a location of the conductive object based on the capacitance measurements. In one embodiment a location can be resolved based on a minimum number of capacitance measurements. Thus a location of a conductive object that is completely within the search window is resolvable using only capacitance measurements of unit cells formed of sensor electrodes that intersect within the search window. In contrast a contact that is only partially within the search window may be resolved using the capacitance measurements of sensor electrodes intersecting within the search window in addition to capacitance measurements of sensor electrodes intersecting outside the search window . In one embodiment a contact may be detected to be only partially i.e. not wholly within the search window if the highest or lowest capacitance value in either the X or Y direction is within a predetermined number of intersections of the edge of the search window. In another embodiment a contact may be determined to be only partially within the search window if the measured capacitance value at one or more or another predetermined number of the intersections forming the boundary of the search window differs more than a predetermined amount from a reference level this predetermined level may be an absolute capacitance value or may be a value relative to the highest or lowest capacitance value measured within the search window.

For example a contact at location may be completely within the search window while a contact at location may be partially within the search window . Notably although the contact location is centered outside of the search window a contact at location may still cause changes in capacitance measurable at some intersections inside the search window .

In response to failing to detect that the contact location is at least partially within the search window the touch sensing system may expand the size of the search window by scanning intersections associated with additional sensor electrodes such as columns and rows . Thus the initial search window may be expanded to the extended search window which includes the intersections between each of a set of rows including rows and rows and each of a set of columns including columns and . Note that in some embodiments it may not be possible to distinguish between a touch having moved outside the search window and the conductive object having moved away from proximity to the touch sensing surface. However in one embodiment the system responds in the same way by expanding the size of the search window. In one embodiment the search window may be increased to cover the entire touch sensing surface. If no touch is detected within the expanded search window then it may be inferred that the conductive object is no longer proximate to the sensing surface.

For example a finger may be proximate to the touch sensing surface at a touch location even after the touch sensing system has predicted a location based on previously determined locations of the finger. In one embodiment this situation may arise when the finger is removed and replaced on the touch panel or has moved faster than can be accommodated by the prediction method.

In one embodiment the touch sensing system may extend the search window by the same number of intersections in each direction. For example an extended search window may include unit cells within the initial search window and a boundary of unit cells one or more unit cells wide on each of the four sides of the initial search window while not extending the search window beyond the limits of physically present sensor electrodes. Alternatively the touch sensing system may extend the search window in a direction depending on the capacitances measured from within the search window or a predicted direction of travel of the contact.

In one embodiment the touch sensing system may extend the initial search window by scanning additional intersections on the same side as the largest magnitude of change in capacitance measured within the initial search window. This process accommodates situations where a contact at location is partially within the initial search window or at least causes measurable changes in capacitance at the intersections within the search window . In one embodiment the search window may be extended until a minimum sufficient amount of capacitance data for resolving the contact location is collected.

In one embodiment the touch sensing system may extend the search window in the same direction as a direction of travel of the contact. For example the touch sensing system may extend the search window upwards and to the left with reference to to find the position of a contact that is traveling from location to location in response to determining that the contact influenced the capacitance of intersections not completely within the search window .

In one embodiment if a touch sensing system is not able to detect a presence of a contact based on a local scan limited to a search window the touch sensing system may extend the search to scan the entire capacitive sensor array. Thus the touch sensing system may be able to locate the contact even if the contact travels completely outside the search window such that the conductive object does not affect any capacitance measurements within the search window .

In one embodiment a touch sensing system implementing the local scan method may also be configured to detect the presence of additional conductive objects while tracking an initial contact using the local scan method to allow local scanning to be used with multi touch applications. There are several methods that can be used to detect new contacts including detecting one or more secondary capacitance peaks within an existing local scan window detecting a change in the total self capacitance of the capacitive sensor array detecting a change in the self capacitance of sensor electrodes not already measured as part of the local scan window or scanning all or part of the sensor array using self or mutual capacitance sensing methods.

In one embodiment a touch sensing system may perform a scan of the remaining area of the touch sensing surface in addition to the area of the local scan in order to detect the presence of additional conductive objects such as additional fingers proximate to the touch sensing surface.

In one embodiment a quick detection of a first new contact at the touch sensing surface may be performed using a single self capacitance measurement of the entire sensor which may be performed in a single touch detection and resolution cycle. In one embodiment when there is no touch location currently being tracked the detecting the presence of a new touch may include a self capacitance sensing of sensor electrodes of only one axis. Once a touch is detected then that touch can be localized and verified to be a single touch by a self capacitance measurement of the second axis. If more than one touch is present then one or more fine scans using mutual capacitance may be used to resolve the locations of the individual touches. In one embodiment where the self capacitance measurements are of low spatial resolution or low signal to noise resolution to only perform reliable detection of touch presence resolution of touch location may always be performed using mutual capacitance fine scans.

In one embodiment the sensor array may be sensed in sections to detect a new contact by electrically coupling multiple sensor electrodes to make up such sections. In one embodiment the sections may be adjacent but non overlapping. Alternatively a touch sensing system may sense three overlapping sections of a capacitive sensor array with each section covering approximately half the area of the entire capacitive sensor array. In one embodiment a touch sensing system with overlapping sections may more easily detect the presence of a conductive object in an overlapping area particularly when the change in measured capacitance caused by the conductive object is relatively small. Specifically when measuring large areas a change in capacitance caused by a single finger may be small such that if the finger is located at a boundary between two non overlapping sections the change in measured capacitance may be insufficient to be detected as a presence. For systems having a capacitance sensor with multiple sensing channels the self capacitance of all row all column or all row and column sense electrodes can all be measured in parallel wherein each sense electrode may be connected to a separate sensing channel.

In one embodiment the touch sensing system may detect the presence of additional contacts by scanning all or part of the capacitive sensor array using mutual capacitance sensing methods. Depending on the ratio of sensor pitch to a minimum expected contact size the intersections of the sensor electrodes may be sensed according to various patterns such as striped or checkerboard patterns. In one embodiment the touch sensing system may sense intersections associated with alternate rows and columns to detect the presence of a contact. Alternatively a touch sensing system may sense intersections associated with every third row and column to detect the contact. In an alternate embodiment those intersections not measured in a first sensing of the touch sensing surface when looking for touch presence are measured in a subsequent sensing of the surface such that over time all intersections are measured. For example if every other intersection of the touch sensing surface comprising a checkerboard pattern is measured for touch presence in a first scan of the touch sensing surface the remaining intersections not measured in the first scan may be measured in the following scan.

For example illustrates an embodiment of a touch sensing surface including a 16 24 sensor array with N 8. A touch sensing system may detect a contact at the touch sensing surface by performing a self or mutual capacitance scan that includes scanning one of every three rows rows in conjunction with alternating columns columns . Mutual capacitance measurements are thus performed for the unit cells including unit cells at the intersections of the scanned rows and columns . Alternatively the touch sensing system may apply a TX signal to multiple rows simultaneously. In one embodiment these rows may be interleaved with rows associated with intersections that are not sensed.

In one embodiment a scan for new contacts may be performed at a lower rate than a tracking of a known contact using a local scan. In one embodiment a scan of the entire sensor array to detect a new additional contact may be performed over several local scan periods. For example a touch sensing system may perform a self capacitance scan of each of three sections where one section is scanned for new contacts after every local scan for tracking a known contact. In such a case with a 200 Hz update rate for local scan tracking the typical touch latency for detecting a new contact would be approximately 15 ms to 20 ms.

In one embodiment where new contacts are detected using mutual capacitance measurements the mutual capacitance scan for new contacts may be interleaved between one or more local scans. For example if 12 mutual capacitance sensing operations corresponding to alternating rows and columns and N 8 channels and measuring 48 independent intersections are used to find new contacts over the full area of the touch sensing surface then three rows may be sensed after each local scan resulting in a 20 ms typical latency for detecting new contacts. Note that when performing these new contact scans in one embodiment the area already covered by a local scan may be excluded since it has already been measured.

In one embodiment the local scan is used only when tracking the location of a single conductive object in contact with or proximate to the touch sensing surface. Alternatively the local scan may be used to track a number of proximate conductive objects such as finger touches.

In one embodiment the system may use the local scan method for tracking a limited number of touches in a system that is capable of tracking more than the limited number of contacts. For example a touch sensing system capable of tracking up to ten contacts may use the local scan mode when tracking up to two simultaneous contacts at the touch sensing surface and may switch to a different mode for tracking more than two contacts. In this example two separate search windows may be used when tracking two fingers. In one embodiment if the two search windows overlap a single larger window may be used for as long as the two centroids are within a predetermined distance of each other.

In one embodiment scanning process begins at block prior to which time no contacts are detected to be present at the touch sensing surface. At block the touch sensing system may perform an initial scan of the touch sensing surface to detect the presence of a new contact at the touch sensing surface. In one embodiment the scan at block may be a self capacitance scan of electrodes comprising one axis of the touch sensing surface such as touch sensing surface as illustrated in . If the self capacitance scan of one axis indicates a contact is present the alternate axis is also scanned to allow prediction of a touch location along both axes. In one embodiment a self capacitance scan that indicates more than one touch may cause the system to switch to a mutual capacitance scanning method to determine the number of touches. In an alternative embodiment the initial scan may be a mutual capacitance scan of all the intersections or a subset of intersections of the sensor electrodes. From block the process continues at block .

At block if the presence of a new contact was not detected by the initial scan of block the process continues back to block after a timeout at block . Thus the initial scan for a new contact repeats periodically until a new contact is detected. If at block a new contact was detected by the initial scan of block the process continues at block .

At block the system may predict a location of a contact based on the initial scan performed at block . From block the process continues at block .

At block the touch sensing system may perform a local scan to collect raw capacitance data from sensor unit cells around the predicted contact location. In one embodiment if the contact is a new contact as identified at block then the predicted contact location may be taken as an approximate location of the new contact as determined by initial scan performed at block . Thus the local scan of block may be performed within a search window surrounding an approximate location of the new contact as determined by the full panel or initial scan of block . In one embodiment the search window may be centered around the predicted contact location. For example search window of is centered around predicted contact location . In one embodiment the local scan is performed on unit cells within a search window such as search window or as illustrated in respectively. From block the process continues at block .

At block the system determines whether the raw capacitance data represents a whole contact. In one embodiment a centroid location for a whole contact can be determined based on only the capacitance values measured from within the search window. In contrast a centroid location for a partial contact may be determined based on capacitance values measured from within the search window in addition to capacitance values measured from outside the search window. If the touch sensing system determines that the capacitance data does not represent a whole contact the process continues at block . If the touch sensing system instead identifies a whole contact or that a partial contact is found near the perimeter area of the touch sensing surface wherein expanding the search window will not provide additional capacitance data the process continues at block .

At block the system determines whether the full panel has been scanned. If at block the full panel has been scanned then a whole contact or partial contact along the perimeter was not found within the bounds of the entire touch sensing panel and the panel no longer has a touch or contact present. Accordingly the process continues back to block and where a new initial scan is performed after a timeout to look for a new touch or contact to occur. If at block the full panel has not been scanned then the system continues at block .

At block the system may expand the search area and a local scan may be performed on the extended search window at block to obtain additional capacitance data for locating a whole contact or further resolving a location of any partial contact that may have been found by the scan at block . For example the touch sensing system may scan unit cells in an extended search window such as extended search window as illustrated in . Thus the blocks may be repeated until at block either a whole contact is found or the entire panel is scanned without finding a whole contact or partial contact along the perimeter of the panel. If a whole contact or partial contact along the perimeter of the panel is not found after scanning the full panel then the process continues from block to block after a timeout . If a whole contact is found then the process continues from block to block .

At block the touch sensing system calculates a resolved contact location of the whole contact or partial contact along the perimeter of the panel based on the capacitance data from block . The touch sensing system may report the location as touch coordinates to a host computer such as host of . From block the process continues to block .

At block the touch sensing system predicts a contact location. In one embodiment when only initial locations have been determined for one or more contacts the predicted contact location may be the same as the resolved contact locations as calculated at block .

In one embodiment the predicted contact location may be based on a previous scan such as the scan at block or where the predicted contact location is associated with a time of a subsequent scan. In one embodiment the prediction of the contact location may be based on one or more previously determined locations of the same contact. For example the touch sensing system may determine a velocity or acceleration for the contact based on previous locations of the contact and may determine a predicted location that accounts for the velocity or acceleration. Alternatively the touch sensing system may use a last known location of the contact such as the contact location determined at block as the predicted location of the contact.

In one embodiment the next predicted location following the resolution of a first touch location may be centered on the first touch location. Once the second touch location is resolved the two touch locations and their associated time of measurement may be mathematically evaluated to provide a velocity vector that may be used to predict a location for the third scan. Once three resolved touch locations are available then an acceleration of the conductive object can be determined. In one embodiment the previous one two or three resolved locations of the touch can then be used for a subsequent prediction depending on the velocity and acceleration. In one embodiment the previously resolved locations of the touch may also be used to shape the area of the fine scan window. If the acceleration is 0 then the last two points may be used. If the velocity is zero then the last point may be used in the prediction. The predicted location of touch determined in block may be used for a local scan performed as provided at block . From block the process continues at block .

In one embodiment either after or before block there will be some delay to control the scanning rate of the touch sensing system. For example the system may include a timer e.g. a 5 ms timer for a 200 Hz system such that before or after block the system will wait until the timer indicates that 5 ms has passed since the start of the previous scan. Block represents a timeout occurring after block which may be implemented by such a timer.

At block when the timeout has elapsed the process continues at block . Accordingly in one embodiment the timeout determines an interval for periodically scanning for new contacts as provided at block .

At block a touch sensing system may perform a scan of a touch sensing surface to detect a new additional contact at the touch sensing surface. In one embodiment the scan may be a mutual capacitance scan of a touch sensing surface such as touch sensing surface as illustrated in . In one embodiment the scan may be a self capacitance scan of a touch sensing surface. In one embodiment the scan at block may cover the entire sensing area of a touch sensing surface to detect a new contact anywhere in the sensing area. From block the process continues at block .

In one embodiment the number of contacts at the touch sensing surface may change because of the addition of an initial contact as detected by the scan at block or the introduction of a new additional contact as detected by a scan according to block to a set of contacts already detected at the touch sensing surface. In one embodiment if the number of contacts has increased the touch sensing system locates the one or more new contacts by performing a full self capacitance scan both axes for a single contact or mutual capacitance scan for multiple contacts of the entire touch sensing panel.

At block based on the scan performed at block the touch sensing system determines whether the number of contacts at the touch sensing surface has changed since the previous scan. In one embodiment the number of contacts at block may change because a contact was added to or removed from the touch sensing surface. From block if the number of contacts has not changed then the process continues at block where the system may perform a local scan based on the predicted position from block . Otherwise if the number of contacts has changed then the process continues at block where the system predicts a contact location.

In one embodiment the process thus repeats while the touch sensing system is in operation to continuously track the locations of one or more conductive objects on or proximate to the touch sensing surface.

In one embodiment the local scanning and additional contact detection methods are not limited to detection and tracking of fingers but may be used to track other objects such as active or passive styli or may be used to detect and track conductive objects in proximity to but not necessarily contacting the touch sensing surface. In one embodiment the local scanning and additional contact detection methods may also be applicable to non capacitive touchscreen sensing methods which use an array of sensing locations.

Embodiments of the present invention described herein include various operations. These operations may be performed by hardware components software firmware or a combination thereof. As used herein the term coupled to may mean coupled directly or indirectly through one or more intervening components. Any of the signals provided over various buses described herein may be time multiplexed with other signals and provided over one or more common buses. Additionally the interconnection between circuit components or blocks may be shown as buses or as single signal lines. Each of the buses may alternatively be one or more single signal lines and each of the single signal lines may alternatively be buses.

Certain embodiments may be implemented as a computer program product that may include instructions stored on a computer readable medium. These instructions may be used to program a general purpose or special purpose processor to perform the described operations. A computer readable medium includes any mechanism for storing or transmitting information in a form e.g. software processing application readable by a machine e.g. a computer . The computer readable storage medium may include but is not limited to magnetic storage medium e.g. floppy diskette optical storage medium e.g. CD ROM magneto optical storage medium read only memory ROM random access memory RAM erasable programmable memory e.g. EPROM and EEPROM flash memory or another type of medium suitable for storing electronic instructions.

Additionally some embodiments may be practiced in distributed computing environments where the computer readable medium is stored on and or executed by more than one computer system. In addition the information transferred between computer systems may either be pulled or pushed across the transmission medium connecting the computer systems.

Although the operations of the method s herein are shown and described in a particular order the order of the operations of each method may be altered so that certain operations may be performed in an inverse order or so that certain operation may be performed at least in part concurrently with other operations. In another embodiment instructions or sub operations of distinct operations may be in an intermittent and or alternating manner.

In the foregoing specification the invention has been described with reference to specific exemplary embodiments thereof. It will however be evident that various modifications and changes may be made thereto without departing from the broader spirit and scope of the invention as set forth in the appended claims. The specification and drawings are accordingly to be regarded in an illustrative sense rather than a restrictive sense.

