---

title: Digital rights management system implemented on a scanner
abstract: In a digital rights management system where a scanner is connected to a rights management server, the process of applying digital rights protection is performed by the scanner, rather than the server, so that scanning and document protection can be done even when the server is not available. Upon scanning a document, the operator selects a rights management policy to be applied to the digital document. The scanner generates a document ID, embeds the document ID as metadata in the document, encrypts the document, and stores the document ID, policy ID of the selected policy, and encryption key as an entry in a local document-policy association table on the scanner. The scanner uploads the above information of the digital document to the server, which stores the information in a document-policy association table on server and uses it to perform document access control.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09355226&OS=09355226&RS=09355226
owner: KONICA MINOLTA LABORATORY U.S.A., INC.
number: 09355226
owner_city: San Mateo
owner_country: US
publication_date: 20140529
---
This invention relates to digital rights management for scanned copies of documents and in particular it relates to a method implemented on a scanner for applying digital rights to scanned documents.

Documents traditionally available only in hard copies are increasingly also available in digital copies. In fact many documents nowadays are prepared generated stored distributed accessed read or otherwise used electronically in digital file formats such as the Portable Document Format PDF . With the wide use of digital documents and digital document processing digital rights management systems DRM or RMS are increasingly implemented to control user access and prevent unauthorized use of digital documents. The rights involved in using a digital document may include the right to view or read the digital document the right to edit or write the digital document the right to print the digital document in hard copies the right to copy the digital document etc. A user may access a digital document by acquiring or being assigned one or more of these rights.

DRM systems are generally implemented for managing users rights to the digital documents stored in the systems. In a current DRM system each digital document is associated with a rights management policy or simply referred to as policy in this disclosure that specifies which user has what rights to the document as well as other parameters relating to access rights. Many such policies are stored in a DRM server also called RMS server . The server stores a database table that associates each document e.g. by a unique ID referred to as document ID or license ID with a policy e.g. by policy ID . Each digital document may also have metadata that contains the document ID. When a user attempts to access a document either a document residing on a server or a document that has been downloaded or copied to the user s computer using an application program such as Adobe Reader the application program contacts the DRM server to request permission. The DRM server determines whether the requesting user has the right to access the document in the attempted manner view edit print etc. by determining the policy associated with the document and then referring to the content of that policy. The DRM server then transmits an appropriate reply to the application program to grant or deny the access. If access is granted the server s reply may contain a decryption key to decrypt the document.

Scanner devices including multi function printers MFP that have printing scanning and copying functions integrated in one device or a device that has only a scanning function are used to scan hardcopy documents to generate digital documents. Some scanners are equipped with DRM management functions to manage digital rights of the digital documents created by the scanner. For example in one known DRM system a scanner is connected to the DRM server by a network. When an operator uses the scanner to scan a hardcopy document into a digital document the scanner prompts the operator to specify a rights management policy to be associated with the digital document. The scanner transmits a copy of the scanned digital document to the DRM server along with the operator s selection of right management policy. The DRM server applies the policy to the digital document e.g. by adding the document ID of the digital document to the database table and associates it with the policy ID of the selected policy and also embedding the document ID in the metadata of the digital document. The DRM server sends the protected version of the digital document back to the scanner. The operator at the scanner can then distribute the protected document for example by storing it or emailing it to various users. Here a protected document refers to a digital document that has a rights management policy applied to it by the DRM server. Later when a user attempts to access the protected document access control can be accomplished by the DRM system in the method described above. An example of a scanner having DRM functions is the Canon imageRUNNER ADVANCE device described in a document entitled Safeguarding information Within Documents and Devices available on the internet at http www.usa.canon.com CUSA assets app pdf ISG Security brochure run iradv security pdf.

In the above described scanner device that implements DRM the scanner relies on the DRM server to apply right management policies to digital documents to generate protected digital documents. One disadvantage of such a system is that if the DRM server is unavailable over the network the scanned document cannot be properly protected by the DRM system. Thus when the DRM server is not available the scanner may prevent the user from scanning which will cause inconvenience to the operator. Alternatively the scanner can allow simple scanning without applying digital rights protection to the scanned digital document which is an undesirable compromise.

Accordingly the present invention is directed to a method and related apparatus for protecting digital documents that substantially obviates one or more of the problems due to limitations and disadvantages of the related art.

An object of the present invention is to apply right management policies to digital documents generated by a scanner without the involvement of the RMS server so as to avoid the inconvenience to scanner operators when the RMS server is not available.

Additional features and advantages of the invention will be set forth in the descriptions that follow and in part will be apparent from the description or may be learned by practice of the invention. The objectives and other advantages of the invention will be realized and attained by the structure particularly pointed out in the written description and claims thereof as well as the appended drawings.

To achieve these and or other objects as embodied and broadly described the present invention provides a method implemented in a system comprising a digital document generation apparatus connected to a digital rights management server via a network for managing digital rights of scanned documents wherein the method includes the following steps performed by the digital document generation apparatus a storing a plurality of right management policies in a storage device local to the digital document generation apparatus each right management policy defining user access rights with respect to digital documents with which the policy is to be associated b generating a digital document c receiving an operator input indicating a policy ID of a selected one of the plurality of rights management policies d generating a unique document ID for the digital document e embedding the document ID and information identifying the digital rights management server in metadata of the digital document f encrypting the digital document using an encryption key g storing the document ID the policy ID and the encryption key as an entry in a local document policy association table in the storage device local to the digital document generation apparatus h storing or transmitting the document to a user without permitting any access to content of the digital document and i transmitting after step h the document ID the policy ID and the encryption key to the digital rights management server.

The method further includes the following steps performed by the server j storing a plurality of right management policies in a storage device of the server each right management policy defining user access rights which specifies a plurality of users having access rights to digital documents with which the policy is to be associated k receiving the document ID the policy ID and the encryption key from the digital document generation apparatus and l storing the document ID the policy ID and the encryption key as an entry in a document policy association table in the storage device of the server.

The method further includes the following steps by the server m receiving a request for access from a user computer the request indicating a document ID of a digital document to be accessed and a user ID of a requesting user n determining a policy ID associated with the document ID by referring to the document policy association table in the storage device of the server o determining an access permission of the requesting user by referring to the policy table using the policy ID and the user ID and p transmitting a reply to the user computer based on the access permission determined in step o .

In another aspect the present invention provides a computer program product comprising a computer usable non transitory medium e.g. memory or storage device having a computer readable program code embedded therein for controlling a data processing apparatus the computer readable program code configured to cause the data processing apparatus to execute the above methods. One computer program product may include program code executed by a digital document generation apparatus to perform steps a through i above. Another computer program product may include program code executed by a digital rights management server to perform steps j through p above.

It is to be understood that both the foregoing general description and the following detailed description are exemplary and explanatory and are intended to provide further explanation of the invention as claimed.

The description herein of the structures functions interfaces and other relevant features such as digital rights policies application programming interface API for rights management and policies etc. of existing DRM systems may at times incorporates references or otherwise uses certain information documents and materials from publicly and readily available and accessible public information e.g. Rights Management URL http help.adobe.com en US livecycle 10.0 Overview WS92d06802c76abadb2c8525912ddcb9aad9 7ff8.html Programmatically applying policies a subsection of Rights Management URL http help.adobe.com en US livecycle 10.0 Overview WSb96e41f8a4ca47a9 4882aeb5131190eddba 8000.html LiveCycle ES Java API Reference URL http livedocs.adobe.com livecycle es sdkHelp programmer javadoc index.html etc.

Embodiments of the present invention provide a method for restricting and or controlling access to digital documents and tracking access to confidential information at the point of scanning physical copies. The control method is implemented in scanners and can be applied to protect digital documents even when the RMS server is not available.

The scanner device includes a processing section a memory storing a control program an DRM program and a message queue synchronizer program a user interface panel and a scanning section which includes hardware that performs the scanning functions. The scanner device also has a storage device internal or external which stores digital documents and DRM related tables and other information described later. The processing section executes the control program to control the various functions of the scanner including various steps of the digital rights management method described later. The RMS server includes a processor which executes software programs stored in a memory to perform various processes including steps of the digital rights management method described later. The server has a storage device internal or external which stores digital documents and DRM related tables and other information described later the digital documents and the various tables may be collectively referred to as the DRM database . The user computer is installed with a rights management program that cooperates with the server . The user computer also includes a processor and memory where the program is stored but for simplicity they are not shown in . Although only one scanner is shown in multiple scanners are typically connected to the server.

The DRM database stored in storage device of the RMS server includes a registered users database storing information regarding users that are registered in the DRM system a policy table containing a list of rights management policies and a document policy association table . The policy table an example of which is schematically shown in specifies for each rights management policy identified by a policy ID the user access rights i.e. which user has what kind of access rights e.g. view print copy etc. under the policy as well as other optional polity terms such as the time period the policy will be in force other restrictions etc. The document policy association table an example of which is schematically shown in contains a list of documents identified by unique document IDs which may be a license ID along with a policy ID of the policy associated with each document as well as other information optional about the document such as the encryption key used to encrypt the document time of creation license revoke status etc.

The scanner generates a unique document ID for the digital document step S . The document ID is embedded in the document as a part of its metadata step S . In addition an URL Uniform Resource Locator of the RMS server is also embedded in the metadata of the document in this step. The scanner also generates an encryption key and encrypts the digital document step S . Then the scanner stores the document ID policy ID encryption key and other information optional about the document as an entry in a local document policy association table on the storage device step S . The local document policy association table has a similar structure as the document policy association table on the server see but typically has a smaller number of entries because the local document policy association table will only contain entries for documents scanned by the particular scanner while the document policy association table on the server contains entries for digital documents from other sources.

It should be noted that the document ID generated in step S is unique not only within the scanner but also within the entire DRM system which may include multiple scanners connected to the server and performing similar scanning functions. This may be accomplished by using a naming scheme where the document ID is partly based on an ID of the scanner so that document IDs generated by one scanner will always be different from those generated by other scanners. For example the document ID may contain multiple characters where a subset of the characters represents the scanner ID or the document ID may be a hash value where a part of the input of the hash function represents the scanner ID.

Steps S to S constitute the steps of applying rights management policy to the digital document the resulting digital document is a protected digital document recognized in the DRM system. The operator is now allowed to store the protected digital document or transmit it to other users step S . However the scanner does not permit any user to access the content of the digital document authorization of access to the content of the document is controlled by the RMS server as will be described later.

Steps S to S shown in can be performed by the scanner even when the RMS server is not available over the network. The scanner can repeat steps S to S to scan additional documents. When the RMS server becomes available the scanner uploads the information about newly scanned digital document s to the server step S . For each document the information uploaded to the server includes the various items stored in the local document policy association table including the document ID policy ID encryption key etc.

The digital document itself may or may not need to be transferred to the RMS server depending on system design. The server does not require a copy of the digital document itself in order to perform access authorization step S described later but in some DRM systems the server may store copies of all documents managed by it.

On the RMS server side when the information about the scanned documents e.g. document ID policy ID encryption key etc. is received from the scanner step S the server stores it in the document policy association table on the server step S . Thereafter when a user attempts to access a document the server can perform document access authorization functions in the conventional manner step S . More specifically when the server receives a request from a user computer to access a digital document the request indicating a document ID for a digital document and a user ID of the requesting user the server uses the document ID received from the user to look up the document policy association table to determined the policy ID associated with the requested document and then refers to the policy table to determine whether the requesting user has access right to the requested document under that policy.

As shown in the scanner and the RMS server may utilize a message queue to exchange DRM related information. The message queue is an application and can be implemented on the RMS server on the scanner or on a separate server in the message queue is depicted as being implemented on a separate server . A message queue synchronizer program on the scanner sends messages containing the relevant information to the message queue. A message queue synchronizer program on RMS server keeps monitoring the message queue when new messages arrive on the message queue it reads the messages and updates the various database tables on the server. If the message queue is temporarily unavailable to the scanner and or the server for example the message queue is implemented on the server and the server is not available to the scanner over the network the message exchange can proceed after it becomes available.

To implement the information exchange via a message queue the scanner is configured with the public key and the server address for the message queue if the message queue is implemented on a separate server and or the public key and server address for the RMS server.

In addition to the local policy table the scanner may also store other information useful for the DRM system such as a local registered user database similar to the registered user database on the server. The server may update the local policy table and other database tables on the scanner from time to time for example by using the message queue . For example the message queue synchronizer on the RMS server may monitor the registered users database and policy table and when any changes in these tables occur send a message to the message queue containing the update information. The message queue synchronizer program on the scanner may continuously monitor the message queue read new messages from the message queue and update the corresponding database tables on the scanner. This way the RMS databases on the scanner and the RMS database on the server are always synchronized. The dashed lines with double arrows in schematically indicate the information flow to and between the message queue and the scanner and server .

To summarize the steps of applying rights management policies to the scanned digital documents i.e. steps S to S in which are conventionally performed by an RMS server are now performed by the scanner without the involvement of the server . Thus even if the RMS server is down the scanner can still allow the operator to scan documents and apply rights management policies to protect the scanned documents. Note that because the RMS server is needed to authorize access to documents by users i.e. step S which is only performed by the RMS server and not performed by the scanner before the information about the newly scanned digital documents is uploaded to the server users will not yet be able to access these documents. As soon as communication between the scanner and server is established the information about the newly scanned digital documents can be uploaded to the server and users are now able to access these documents via the document access authorization function of the RMS server .

Although a message queue is a convenient way of implementing information exchange between the server and scanner it is not essential and other method of information exchange may be used.

In one embodiment the scanner performs the steps of applying right management policies only when the RMS server is not available at the time the operator wishes to scan a document if the RMS server is available the steps of applying right management policies are performed by the server in the conventional manner. In other words if the RMS server is available at the time the operator wishes to scan a document the scanner sends the scanned digital document to the server and receives the protected version of the document back from the server. In another embodiment even when the RMS server is available the steps of applying right management policies are still performed by the scanner. The latter is advantageous particularly when the RMS server is connected with the scanner by the Internet when the server is in the cloud because it is faster and uses less network bandwidth. Using the conventional method the scanned digital documents are sent from the scanner to the RMS server where the server applies DRM protection to them and sends the protected documents back to the scanner. When the scanned digital files have large sizes file transfer over the Internet may take too long and the scanning operation may even fail due to timeout caused by long file transfer time. The method of this embodiment also uses less network bandwidth because the digital documents do not need to be transferred over the Internet multiple times. When the DRM system is designed such that copies of the digital documents are not kept by the server there will be no need to transfer the documents to the server at all.

As described earlier when an operator scans a document the scanner displays a list of right management policies to the operator and the operator selects one policy to be applied to the scanned digital document step S . In some embodiments the list of policies that are displayed to the operator which the operator can select from may be restricted in order to enhance security. This is useful in situations for example where the scanner is located in a space where confidential documents are kept and where physical access is controlled. In such a situation it would be undesirable if an operator can scan a confidential document then apply a relatively non restrictive policy to the digital document such that the digital document can be widely viewed by users who are not supposed to have access to it.

Thus according to an embodiment of the invention a table specifying an association between operator IDs and available policies is stored in the storage device of the scanner. The list may be a subset of all policies in the policy table of the RMS server. Different lists may be specified for different operators. In an example of a most restrictive case an operator can select from only one policy and that one policy gives only the system administrator access rights to the document. In such a case operators can scan a document but cannot access the scanned digital document the system administrator can later re assign another policy to be associated with the document before the information about the document is uploaded to the RMS server step S . Such measures will help in protecting documents as they are getting scanned it ensures that as soon as a document is scanned the scanned copy is protected and only allowed users can open and view it.

Note that the operators are often also users of the DRM system who are given various access rights to digital documents by the various policies. In this disclosure the term user is used in the context of accessing the digital documents and the term operator is used in the context of performing document scanning but they are often the same people such as employees of an organization.

Further the scanner can be set up to track all accesses made to scanned digital documents while they reside on the scanner so that every operator action viewing printing modifying copying etc. is recorded. Tracking the audit trail of the scanned copies allows companies to keep track of who are using scanned copies and what they are doing with them like printing modifying copying viewing etc. The recorded tracking information may be later reported to the RMS server and stored in the database there as a part of the access record of the document. Such tracking will be useful for industries controlled by e document law where original copies of scanned documents must be preserved even if the scanned documents are allowed to be modified. Using this method as soon as the document is scanned it is protected and all changes in the scanned copy are continuously tracked.

Although the above embodiments of the invention are described in the context of a scanner the method can also be implemented on a mobile device such as a smart phone or tablet computer which has a camera capability.

Moreover in DRM systems often a computer which may be another server or a client computer may generate digital documents such as PDF documents by means other than scanning a hardcopy document and submit such digital documents to be managed by the RMS server . For example a document may be generated by a word processing program and then converted to PDF. The method described above can be applied to such a DRM system as well. In other words the scanner shown in may more generally be any digital document generation apparatus including but not limited scanners computers digital cameras etc. step S is more generally a step of generating a digital document by any suitable means and steps S to S are performed by the digital document generation apparatus . Such a system and method are different from conventional DRM systems and methods in that in the conventional DRM systems and methods only the RMS server which performs the steps of document access authorization step S can perform the steps of applying rights management policies to digital documents steps S to S while in the present embodiments the steps of applying rights management policies to digital documents can be performed by a digital document generation apparatus that does not perform the steps of document access authorization. The system and methods of the present embodiments have the advantage that rights management policies can be applied by the digital document generation apparatus even when the RMS server is not available to the apparatus . This advantage is significant when the embodied invention is implemented in a digital document generation apparatus shared by a multiple users such as an MFP. That is to say because it is inconvenient for other users if one user operator occupies the shared MFP for a long time. By using the embodied invention a delay in applying rights management policy in a scan job due to the failure of connection to RMS server can be avoided which results in that the time occupied by the scan job operator can be minimized.

It will be apparent to those skilled in the art that various modification and variations can be made in the digital rights management method and related apparatus of the present invention without departing from the spirit or scope of the invention. Thus it is intended that the present invention cover modifications and variations that come within the scope of the appended claims and their equivalents.

