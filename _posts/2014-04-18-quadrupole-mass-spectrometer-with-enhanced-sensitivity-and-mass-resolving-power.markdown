---

title: Quadrupole mass spectrometer with enhanced sensitivity and mass resolving power
abstract: A novel method and mass spectrometer apparatus is introduced to spatially and temporally resolve images of one or more ion exit patterns of a multipole instrument. In particular, the methods and structures of the present invention measures the ion current as a function of time and spatial displacement in the beam cross-section of a quadrupole mass filter via an arrayed detector. The linearity of the detected quadrupole ion current in combination with it reproducible spatial-temporal structure enables the deconvolution of the contributions of signals from individual ion species in complex mixtures where both sensitivity and mass resolving power are essential.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08841610&OS=08841610&RS=08841610
owner: Thermo Finnigan LLC
number: 08841610
owner_city: San Jose
owner_country: US
publication_date: 20140418
---
The present application is a continuation under 35 U.S.C. 120 and claims the priority benefit of co pending U.S. patent application Ser. No. 13 784 497 filed Mar. 4 2013 which is a continuation under 35 U.S.C. 120 of U.S. patent application Ser. No. 12 716 138 filed Mar. 2 2010 now U.S. Pat. No. 8 389 929. The disclosure of each of the foregoing applications is incorporated herein by reference in its entirety.

The present invention relates to the field of mass spectrometry. More particularly the present invention relates to a mass spectrometer system and method that provides for improved high mass resolving power MRP and sensitivity via deconvolution of the spatial and temporal characteristics collected at the exit aperture of a quadrupole instrument.

Quadrupoles are conventionally described as low resolution instruments. The theory and operation of conventional quadrupole mass spectrometers is described in numerous text books e.g. Dawson P. H. 1976 Elsevier Amsterdam and in numerous Patents such as U.S. Pat. No. 2 939 952 entitled Apparatus For Separating Charged Particles Of Different Specific Charges to Paul et al filed Dec. 21 1954 issued Jun. 7 1960.

As a mass filter such instruments operate by setting stability limits via applied RF and DC potentials that are capable of being ramped as a function of time such that ions with a specific range of mass to charge ratios have stable trajectories throughout the device. In particular by applying fixed and or ramped AC and DC voltages to configured cylindrical but more often hyperbolic electrode rod pairs in a manner known to those skilled in the art desired electrical fields are set up to stabilize the motion of predetermined ions in the x and y dimensions. As a result the applied electrical field in the x axis stabilizes the trajectory of heavier ions whereas the lighter ions have unstable trajectories. By contrast the electrical field in the y axis stabilizes the trajectories of lighter ions whereas the heavier ions have unstable trajectories. The range of masses that have stable trajectories in the quadrupole and thus arrive at a detector placed at the exit cross section of the quadrupole rod set is defined by the mass stability limits.

Typically quadrupole mass spectrometry systems employ a single detector to record the arrival of ions at the exit cross section of the quadrupole rod set as a function of time. By varying the mass stability limits monotonically in time the mass to charge ratio of an ion can be approximately determined from its arrival time at the detector. In a conventional quadrupole mass spectrometer the uncertainty in estimating of the mass to charge ratio from its arrival time corresponds to the width between the mass stability limits. This uncertainty can be reduced by narrowing the mass stability limits i.e. operating the quadrupole as a narrow band filter. In this mode the mass resolving power of the quadrupole is enhanced as ions outside the narrow band of stable masses crash into the rods rather than passing through to the detector. However the improved mass resolving power comes at the expense of sensitivity. In particular when the stability limits are narrow even stable masses are only marginally stable and thus only a relatively small fraction of these reach the detector.

Background information on a system and method that utilizes a mathematical deconvolution process to analyze spatial characteristics provided by an arrayed source is described and claimed in U.S. Pat. No. 7 339 521 entitled ANALYTICAL INSTRUMENTS USING A PSEUDORANDOM ARRAY OF SOURCES SUCH AS A MICRO MACHINED MASS SPECTROMETER OR MONOCHROMATOR issued Mar. 4 2008 to Scheidemann et al. including the following Novel methods and structures are disclosed herein which employ pseudorandom sequences to spatially arrange multiple sources in a pseudorandom source array. The pseudorandom source array can replace the single source in analytical instruments relying on spatial separation of the sample or the probe particles waves emitted by the sources. The large number of sources in this pseudorandom source array enhances the signal on a position sensitive detector. A mathematical deconvolution process retrieves a spectrum with improved signal to noise ratio from the detector signal. 

Background information for a mass spectrometer system that provides for spatial detection of ions via a photo emissive device is described and claimed in U.S. Pat. No. 4 810 882 entitled MASS SPECTROMETER FOR POSITIVE AND NEGATIVE IONS issued Mar. 7 1989 to Bateman et al. including the following t he invention provides a mass spectrometer capable of detecting both positive and negative ions. Positive ions emerging from the mass analyzer strike a conversion electrode to release secondary electrons which pass through an annular electrode to strike a phosphor releasing photons. Negative ions strike the surface of the annular electrode to release secondary electrons which also strike the phosphor releasing photons. The photons are detected with a conventional photomultiplier. The electrodes are biased and disposed so that both positive ions and negative ions may be detected without changing the potentials applied to them. 

Background information for a system that uses an arrayed detector for ion collection is described in From the Infrared to X ray Advanced Detectors Set to Revolutionize Spectroscopy presented Mar. 8 2009 at Pittcon by Bonner Denton including the following w hole new generations of highly promising ion and electron detectors are being implemented by adapting and modifying a combination of technologies originally developed for visible CCD s and infrared multiplexer arrays. This new generation of ion and electron detectors is being implemented in configurations ranging from a single element suitable for quadrupole and time of flight ion mobility instruments to linear arrays for ion cycloidal and sector based mass spectrometers. The latest results using these new techniques to read micro Faraday cups and arrays of finger electrodes will be presented. Since this approach is a high sensitivity Faraday type coulombic detector it is suitable for implementing high density arrays in isotope ratio spectrometers and conventional mass spectrometers as well as ultra high sensitivity detectors for ion mobility spectrometers. While the described detectors in the presentation provide information about the exit positions of ions the described research does not make use of this information. Rather the array is used to improve the total number of ions captured and is functionally equivalent to a single detector with enhanced sensitivity.

The key point to be taken by is that conventionally operation of a quadrupole mass filter provides for either relatively high mass resolving power or high sensitivity at the expense of mass resolving power but not for both simultaneously and in all cases the scan rate is relatively slow. The present invention however provides for a system and method of operation that simultaneously provides for both a high mass resolving power and an increased sensitivity at higher scan rates which exceeds current capabilities of quadrupole mass analyzers.

Accordingly there is a need in the field of mass spectrometry to improve the mass resolving power of such systems without the loss in signal to noise ratio i.e. sensitivity . The present invention addresses this need as disclosed herein by measuring the ion current as a function of both time and spatial displacement in the beam cross section and then deconvolving the contributions of the signals from the individual ion species.

The present invention is directed to a novel quadrupole mass filter method and system that discriminates among ion species even when both are simultaneously stable by recording where the ions strike a position sensitive detector as a function of the applied RF and DC fields. When the arrival times and positions are binned the data can be thought of as a series of ion images. Each observed ion image is essentially the superposition of component images one for each distinct m z value exiting the quadrupole at a given time instant. Because the present invention provides for the prediction of an arbitrary ion image as a function of m z and the applied field each individual component can be extracted from a sequence of observed ion images by the mathematical deconvolution processes discussed herein. The mass to charge ratio and abundance of each species necessarily follow directly from the deconvolution.

A first aspect of the present invention is directed to a high mass resolving power high sensitivity mass spectrometer instrument that includes a multipole configured to pass an abundance of one or more ion species within stability boundaries defined by the applied RF and DC fields which are characterized by the unitless Mathieu parameters a q a detector configured to record the spatial and temporal properties of the abundance of ions at a cross sectional area of the multipole and a processing means configured to subject said recorded spatial and temporal properties of said abundance of one or more species of ions as a function of the applied RF and or DC fields to deconvolution so as to provide mass discrimination of said one or more ion species.

Another aspect of the present invention provides for a deconvolution process of acquired images from a mass analyzer and detector by first acquiring or synthetically generating a reference signal. The reference signal is a series of images where each image represents the spatial distribution of exiting ions of a single canonical species produced by a particular state of the fields applied to the quadrupole. Thereafter the process is designed to acquire spatial and temporal raw data of an abundance of one or more ion species from an exit channel of said multipole. It then generates a shifted autocorrelation vector from the reference signals and breaks the acquired data into suitable chunks and pads such data with zeros. The dot product of one of more chunks of data with each of the reference signals is then generated. The deconvolution problem is then put into a matrix form often in Toeplitz form so as to solve and thus provide mass discrimination of said abundance of one or more ion species to include the number of distinct ion species and for each species accurate estimates of its relative abundance and mass to charge ratio.

Accordingly the present invention provides for an apparatus and method of operation that enables a user to acquire comprehensive mass data with a time resolution on the order of about an RF cycle by computing the distribution of the ion density not only as a function of the applied fields but also as a function of position in the spatial cross section at a quadrupole exit. Applications include but are not strictly limited to petroleum analysis drug analysis phosphopeptide analysis DNA and protein sequencing etc. that hereinbefore were not capable of being interrogated with quadrupole systems. As side benefits such configurations and methods disclosed herein enable relaxed requirements on the manufacturing tolerances which reduces overall cost while improving robustness.

In the description of the invention herein it is understood that a word appearing in the singular encompasses its plural counterpart and a word appearing in the plural encompasses its singular counterpart unless implicitly or explicitly understood or stated otherwise. Furthermore it is understood that for any given component or embodiment described herein any of the possible candidates or alternatives listed for that component may generally be used individually or in combination with one another unless implicitly or explicitly understood or stated otherwise. Moreover it is to be appreciated that the figures as shown herein are not necessarily drawn to scale wherein some of the elements may be drawn merely for clarity of the invention. Also reference numerals may be repeated among the various figures to show corresponding or analogous elements. Additionally it will be understood that any list of such candidates or alternatives is merely illustrative not limiting unless implicitly or explicitly understood or stated otherwise. In addition unless otherwise indicated numbers expressing quantities of ingredients constituents reaction conditions and so forth used in the specification and claims are to be understood as being modified by the term about. 

Accordingly unless indicated to the contrary the numerical parameters set forth in the specification and attached claims are approximations that may vary depending upon the desired properties sought to be obtained by the subject matter presented herein. At the very least and not as an attempt to limit the application of the doctrine of equivalents to the scope of the claims each numerical parameter should at least be construed in light of the number of reported significant digits and by applying ordinary rounding techniques. Notwithstanding that the numerical ranges and parameters setting forth the broad scope of the subject matter presented herein are approximations the numerical values set forth in the specific examples are reported as precisely as possible. Any numerical values however inherently contain certain errors necessarily resulting from the standard deviation found in their respective testing measurements.

Typically a multipole mass filter e.g. a quadrupole mass filter operates on a continuous ion beam although pulsed ion beams may also be used with appropriate modification of the scan function and data acquisition algorithms to properly integrate such discontinuous signals. A quadrupole field is produced within the instrument by dynamically applying electrical potentials on configured parallel rods arranged with four fold symmetry about a long axis. The axis of symmetry is referred to as the z axis. By convention the four rods are described as a pair of x rods and a pair of y rods. At any instant of time the two x rods have the same potential as each other as do the two y rods. The potential on the y rods is inverted with respect to the x rods. Relative to the constant potential at the z axis the potential on each set of rods can be expressed as a constant DC offset plus an RF component that oscillates rapidly with a typical frequency of about 1 MHz .

The DC offset on the x rods is positive so that a positive ion feels a restoring force that tends to keep it near the z axis the potential in the x direction is like a well. Conversely the DC offset on the y rods is negative so that a positive ion feels a repulsive force that drives it further away from the z axis the potential in the y direction is like a saddle.

An oscillatory RF component is applied to both pairs of rods. The RF phase on the x rods is the same and differs by 180 degrees from the phase on the y rods. Ions move inertially along the z axis from the entrance of the quadrupole to a detector often placed at the exit of the quadrupole. Inside the quadrupole ions have trajectories that are separable in the x and y directions. In the x direction the applied RF field carries ions with the smallest mass to charge ratios out of the potential well and into the rods. Ions with sufficiently high mass to charge ratios remain trapped in the well and have stable trajectories in the x direction the applied field in the x direction acts as a high pass mass filter. Conversely in the y direction only the lightest ions are stabilized by the applied RF field which overcomes the tendency of the applied DC to pull them into the rods. Thus the applied field in the y direction acts as a low pass mass filter. Ions that have both stable component trajectories in both x and y pass through the quadrupole to reach the detector. The DC offset and RF amplitude can be chosen so that only ions with a desired range of m z values are measured. If the RF and DC voltages are fixed the ions traverse the quadrupole from the entrance to the exit and exhibit exit patterns that are a periodic function of the containing RF phase. Although where the ions exit is based upon the separable motion the observed ion oscillations are completely locked to the RF. As a result of operating a quadrupole in for example a mass filter mode the scanning of the device by providing ramped RF and DC voltages naturally varies the spatial characteristics with time as observed at the exit aperture of the instrument.

The present invention exploits such varying characteristics by collecting the spatially dispersed ions of different m z even as they exit the quadrupole at essentially the same time. For example as exemplified in at a given instant in time the ions of mass A and the ions of mass B can lie in two distinct clusters in the exit cross section of the instrument. The present invention acquires the dispersed exiting ions with a time resolution on the order of 10 RF cycles more often down to an RF cycle e.g. a typical RF cycle of 1 MHz corresponds to a time frame of about 1 microsecond or with sub RF cycle specificity to provide data in the form of one or more collected images as a function of the RF phase at each RF and or applied DC voltage. Once collected the present invention can extract the full mass spectral content in the captured image s via a constructed model that deconvolutes the ion exit patterns and thus provide desired ion signal intensities even while in the proximity of interfering signals.

In composition the quadrupole mass spectrometer of the present invention differs from a conventional quadrupole mass spectrometer in that the present invention includes a high speed position sensitive detector for observing ions as they exit the quadrupole while the latter merely counts ions without recording the relative positions of the ions. In particular the present invention differs from a conventional instrument in two important respects 1 a mathematical transformation that converts a time series of ion images into a mass spectrum and 2 a quadrupole configured to operate with wide stability limits producing high sensitivity. Unlike conventional quadrupole instruments wider stability limits when utilized herein do not lead to reduced mass resolving power. In fact the present invention produces very high mass resolving power under a wide variety of operating conditions a property not usually associated with quadrupole mass spectrometers.

Accordingly the novel data acquisition and data analysis apparatus and methods disclosed herein form the basis of the present invention allowing it to simultaneously achieve higher sensitivity and mass resolving power MRP at higher scan rates than is possible in conventional systems. A time series of ion images is acquired at a high temporal sampling rate while the applied DC offset and RF amplitude are ramped. A deconvolution algorithm reconstructs the distribution of ion mass to charge ratio values that reach the detector providing a mass spectrum actually a mass to charge ratio spectrum. Given the high data rate and computational requirements of the present invention a graphics processing unit GPU is often used to convert the data stream into mass spectra in real time.

The trajectory of ions in an ideal quadrupole is modeled by the Mathieu equation. The Mathieu equation describes a field of infinite extent both radially and axially unlike the real situation in which the rods have a finite length and finite separation. The solutions of the Mathieu equation as known to those skilled in the art can be classified as bounded and non bounded. Bounded solutions correspond to trajectories that never leave a cylinder of finite radius where the radius depends on the ion s initial conditions. Typically bounded solutions are equated with trajectories that carry the ion through the quadrupole to the detector. For finite rods some ions with bounded trajectories hit the rods rather than passing through to the detector i.e. the bound radius exceeds the radius of the quadrupole orifice. Conversely some ions with marginally unbounded trajectories pass through the quadrupole to the detector i.e. the ion reaches the detector before it has a chance to expand radially out to infinity. Despite these shortcomings the Mathieu equation is still very useful for understanding the behavior of ions in a finite quadrupole such as that used in the present invention.

The Mathieu equation can be expressed in terms of two unitless parameters a and q. The general solution of the Mathieu equation i.e. whether or not an ion has a stable trajectory depends only upon these two parameters. The trajectory for a particular ion also depends on a set of initial conditions the ion s position and velocity as it enters the quadrupole and the RF phase of the quadrupole at that instant. If m z denotes the ion s mass to charge ratio U denotes the DC offset and V denotes the RF amplitude then a is proportional to U m z and q is proportional to V m z . The plane of q a values can be partitioned into contiguous regions corresponding to bounded solutions and unbounded solutions. The depiction of the bounded and unbounded regions in the q a plane is called a stability diagram as is to be discussed in detail below with respect to . The region containing bounded solutions of the Mathieu equation is called a stability region. A stability region is formed by the intersection of two regions corresponding to regions where the x and y components of the trajectory are stable respectively. There are multiple stability regions but conventional instruments involve the principal stability region. The principal stability region has a vertex at the origin of the q a plane. Its boundary rises monotonically to an apex at a point with approximate coordinates 0.706 0.237 and falls monotonically to form a third vertex on the a axis at q approximately 0.908. By convention only the positive quadrant of the q a plane is considered. In this quadrant the stability region resembles a triangle.

Therefore the instrument using the stability diagram as a guide can be parked i.e. operated with a fixed U and V to target a particular ion of interest e.g. at the apex of as denoted by m or scanned increasing both U and V amplitude monotonically to bring the entire range of m z values into the stability region at successive time intervals from low m z to high m z. A special case is when U and V are each ramped linearly in time. In this case all ions progress the same fixed operating line through the stability diagram with ions moving along the line at a rate inversely proportional to m z. For example if an ion of mass to charge ratio M passes through q a at time t an ion with mass to charge 2M passes through the same point at time 2t. If q a is placed just below the tip of the stability diagram of so that mass to charge M is targeted at time t then mass to charge ratio 2M is targeted at time 2t. Therefore the time scale and m z scale are linearly related. As a result the flux of ions hitting the detector as a function of time is very nearly proportional to the mass distribution of ions in a beam. That is the detected signal is a mass spectrum .

To provide increased sensitivity by increasing the abundance of ions reaching the detector the scan line as shown in can be reconfigured with a reduced slope as bounded by the regions and . When the RF and DC voltages are ramped linearly with time scanned as stated above every m z value follows the same path in the Mathieu stability diagram i.e. the q a path with the ions as before moving along the line at a rate inversely proportional to m z.

To further appreciate ion movement with respect to the Mathieu stability diagram it is known that an ion is unstable in the y direction before entering the stability region but as the ion enters a first boundary of the stability diagram having a 0 it becomes critically stable with relatively large oscillations of high amplitude and low frequency in the y direction that tend to decrease over time. As the ion exits the stability diagram as shown by the boundary region it becomes unstable in the x direction 1 and so the oscillations in the x direction tend to increase over time with relatively large oscillations in x just before exiting. If the scan line is operated in either the y unstable region or the x unstable region ions not bounded within the stability diagram discharge against the electrodes and are not detected. Generally if two ions are stable at the same time the heavier one entering the stability diagram later has larger y oscillations and the lighter one has larger x oscillations.

The other aspect of ion motion that changes as the ion moves through the stability region of is the frequency of oscillations in the x and y directions as characterized by the Mathieu parameter beta . As the ion enters the stability diagram the frequency of its fundamental oscillation in the y direction is essentially zero and rises to some exit value. The fundamental y direction ion frequency increases like a chirp i.e. having a frequency increasing slightly non linearly with time as beta increases non linearly with the a q ramp as is well known in the art. Similarly the frequency of the fundamental x direction oscillation also increases from some initial value slightly below the RF 2 or 2 up to exactly the 2 1 at the exit. It is to be appreciated that the ion s motion in the x direction is dominated by the sum of two different oscillations with frequencies just above and below the main 2 . The one just below 2 i.e. the fundamental is the minor image of the one just above 2. The two frequencies meet just as the ion exits which results in a very low frequency beating phenomenon just before the ion exits analogous to the low frequency y oscillations as the ion enters the stability region.

Thus if two ions are stable at the same time the heavier one not as far through the stability diagram has slower oscillations in both X and Y slightly in X but significantly so in Y with the lighter one having faster oscillations and has low frequency beats in the X direction if it is near the exit. The frequencies and amplitudes of micromotions also change in related ways that are not easy to summarize concisely but also help to provide mass discrimination. This complex pattern of motion is utilized in a novel fashion by the present invention to distinguish two ions with very similar mass.

As a general statement of the above description ions manipulated by a quadrupole are induced to perform an oscillatory motion an ion dance on the detector cross section as it passes through the stability region. Every ion does exactly the same dance at the same a and q values just at different RF and DC voltages at different times. The ion motion i.e. for a cloud of ions of the same m z but with various initial displacements and velocities is completely characterized by a and q by influencing the position and shape cloud of ions exiting the quadrupole as a function of time. For two masses that are almost identical the speed of their respective dances is essentially the same and can be approximately related by a time shift

As the ion approaches the exit of the stability region a similar effect happens but in reverse and involving the x component rather than y. The cloud gradually elongates in the horizontal direction and the oscillations in this direction increase in magnitude until the cloud is carried across the left and right boundaries of the image. Eventually both the oscillations and the length of the cloud increase until the transmission decreases to zero.

In particular the vertical cloud of ions as enclosed graphically by the ellipse shown in correspond to the heavier ions entering the stability diagram as described above and accordingly oscillate with an amplitude that brings such heavy ions close to the denoted Y quadrupoles. The cluster of ions enclosed graphically by the ellipse shown in correspond to lighter ions exiting the stability diagram as also described above and thus cause such ions to oscillate with an amplitude that brings such lighter ions close to the denoted X quadrupoles. Within the image lie the additional clusters of ions shown in but not specifically highlighted that have been collected at the same time frame but which have a different exit pattern because of the differences of their a and q and thus beta parameters.

Every exit cloud of ions thus performs the same dance oscillating wildly in y as it enters the stability region and appears in the image settling down and then oscillating wildly in x as it exits the stability diagram and disappears from the image. Even though all ions do the same dance the timing and the tempo vary. The time when each ion begins its dance i.e. enters the stability region and the rate of the dance are scaled by m z .

Accordingly because it is possible to construct a time series of ion images for an ion with arbitrary m z it is also possible to extract each individual component from a sequence of observed ion images similar to that shown in by the mathematical deconvolution process detailed herein. The mass to charge ratio and abundance of each species follow directly from the deconvolution. It is to be noted that while ions injected symmetrically along the axis of a quadrupole provide for distinction as imaged at the exit aperture of a quadrupole device it is preferable that ions be injected off center to provide for even greater distinctions as collected at the exit aperture due to the exit ion cloud undergoing even larger oscillations. illustrates such an off center injection embodiment.

A key point is that merely classifying ion trajectories as bounded versus unbounded does not harness the full potential of a quadrupole to distinguish ions with similar mass to charge ratios. Finer distinctions can be made among ions with bounded trajectories by collecting ion images that record where ions fall on the detector as a function of the applied fields. Each observed ion image is the superposition of component images one for each distinct m z value exiting the quadrupole at a given time instant. The present invention demonstrates the ability to distinguish the m z values of ions that are simultaneously stable in the quadrupole by recording the times and positions where ions hit the detector. Leveraging this ability the present invention has a profound impact upon the sensitivity of a quadrupole mass spectrometer. Because only ions with bounded trajectories are measured it necessarily follows that the signal to noise characteristic of any ion species improves with the number of ions that actually reach the detector.

The stability transmission window for the quadrupole in the present invention can thus be configured in a predetermined manner i.e. by reducing the slope of the scan line as shown in to allow a relatively broad range of ions to pass through the instrument the result of which increases the signal to noise because the number of ions recorded for a given species is increased. Accordingly by increasing the number of ions a gain in sensitivity is beneficially provided because at a given instant of time a larger fraction of a given species of ions can now not only pass through the quadrupole but also pass through the quadrupole for a much longer duration of the scan. The potential gain in sensitivity necessarily follows by the multiplicative product of these factors.

However while the increase in ion counts is necessary there are certain tradeoffs that may be required for increased sensitivity. As an example when a quadrupole is operated as a mass filter with improved ion statistics i.e. by opening the transmission stability window a gain in sensitivity can be negated by a loss in mass resolving power because the low abundance species within the window may be obscured by one of higher abundance that is exiting the quadrupole in the same time frame. To mitigate such an effect it is to be appreciated that while the mass resolving power of the present invention is potentially substantially large i.e. by operating with RF only mode often the system of the present invention is operated with a mass resolving power window of up to about 10 AMU wide and in some applications up to about 20 AMU in width in combination with scan rates necessary to provide for useful signal to noise ratios within the chosen m z transmission window.

Using ion images as a basis for separation enables the methods and instruments of the present invention to provide not only high sensitivity i.e. an increased sensitivity 10 to 200 times greater than a conventional quadrupole filter but to also simultaneously provide for differentiation of mass deltas of 100 ppm a mass resolving power of 10 thousand down to about 10 ppm a mass resolving power of 100 thousand . Unexpectedly the present invention can even provide for an unparalleled mass delta differentiation of 1 ppm i.e. a mass resolving power of 1 million if the devices disclosed herein are operated under ideal conditions that include minimal drift of all electronics.

Turning back to the drawings shows a beneficial example configuration of a triple stage mass spectrometer system e.g. a commercial TSQ as shown generally designated by the reference numeral . It is to be appreciated that mass spectrometer system is presented by way of a non limiting beneficial example and thus the present invention may also be practiced in connection with other mass spectrometer systems having architectures and configurations different from those depicted herein.

The operation of mass spectrometer can be controlled and data can be acquired by a control and data system not depicted of various circuitry of a known type which may be implemented as any one or a combination of general or special purpose processors digital signal processor DSP firmware software to provide instrument control and data analysis for mass spectrometers and or related instruments and hardware circuitry configured to execute a set of instructions that embody the prescribed data analysis and control routines of the present invention. Such processing of the data may also include averaging scan grouping deconvolution as disclosed herein library searches data storage and data reporting.

It is also to be appreciated that instructions to start predetermined slower or faster scans as disclosed herein the identifying of a set of m z values within the raw file from a corresponding scan the merging of data the exporting displaying outputting to a user of results etc. may be executed via a data processing based system e.g. a controller a computer a personal computer etc. which includes hardware and software logic for performing the aforementioned instructions and control functions of the mass spectrometer .

In addition such instruction and control functions as described above can also be implemented by a mass spectrometer system as shown in as provided by a machine readable medium e.g. a computer readable medium . A computer readable medium in accordance with aspects of the present invention refers to mediums known and understood by those of ordinary skill in the art which have encoded information provided in a form that can be read i.e. scanned sensed by a machine computer and interpreted by the machine s computer s hardware and or software.

Thus as mass spectral data of a given spectrum is received by a beneficial mass spectrometer system disclosed herein the information embedded in a computer program of the present invention can be utilized for example to extract data from the mass spectral data which corresponds to a selected set of mass to charge ratios. In addition the information embedded in a computer program of the present invention can be utilized to carry out methods for normalizing shifting data or extracting unwanted data from a raw file in a manner that is understood and desired by those of ordinary skill in the art.

Turning back to the example mass spectrometer system of a sample containing one or more analytes of interest can be ionized via an ion source operating at or near invention can be operated either in the radio frequency RF only mode or an RF DC mode. Depending upon the particular applied RF and DC potentials only ions of selected charge to mass ratios are allowed to pass through such structures with the remaining ions following unstable trajectories leading to escape from the applied multipole field. When only an RF voltage is applied between predetermined electrodes e.g. spherical hyperbolic flat electrode pairs etc. the apparatus is operated to transmit ions in a wide open fashion above some threshold mass. When a combination of RF and DC voltages is applied between predetermined rod pairs there is both an upper cutoff mass as well as a lower cutoff mass. As the ratio of DC to RF voltage increases the transmission band of ion masses narrows so as to provide for mass filter operation as known and as understood by those skilled in the art.

Accordingly the RF and DC voltages applied to predetermined opposing electrodes of the multipole devices of the present invention as shown in e.g. Q3 can be applied in a manner to provide for a predetermined stability transmission window designed to enable a larger transmission of ions to be directed through the instrument collected at the exit aperture and processed so as to determined mass characteristics.

An example multipole e.g. Q3 of can thus be configured along with the collaborative components of a system to provide a mass resolving power of potentially up to about 1 million with a quantitative increase of sensitivity of up to about 200 times as opposed to when utilizing typical quadrupole scanning techniques. In particular the RF and DC voltages of such devices can be scanned over time to interrogate stability transmission windows over predetermined m z values e.g. 20 AMU . Thereafter the ions having a stable trajectory reach a detector capable of time resolution on the order of 10 RF cycles or atmospheric pressure or at a pressure as defined by the system requirements. Accordingly the ion source can include but is not strictly limited to an Electron Ionization EI source a Chemical Ionization CI source a Matrix Assisted Laser Desorption Ionization MALDI source an Electrospray Ionization ESI source an Atmospheric Pressure Chemical Ionization APCI source a Nanoelectrospray Ionization NanoESI source and an Atmospheric Pressure Ionization API etc.

The resultant ions are directed via predetermined ion optics that often can include tube lenses skimmers and multipoles e.g. reference characters and selected from radio frequency RF quadrupole and octopole ion guides etc. so as to be urged through a series of chambers of progressively reduced pressure that operationally guide and focus such ions to provide good transmission efficiencies. The various chambers communicate with corresponding ports represented as arrows in the figure that are coupled to a set of pumps not shown to maintain the pressures at the desired values.

The example spectrometer of is shown illustrated to include a triple stage configuration having sections labeled Q1 Q2 and Q3 electrically coupled to respective power supplies not shown so as to perform as a quadrupole ion guide that can also be operated under the presence of higher order multipole fields e.g. an octopole field as known to those of ordinary skill in the art. It is to be noted that such pole structures of the present more more often down to an RF cycle or with sub RF cycles specificity wherein the specificity is chosen to provide appropriate resolution relative to the scan rate to provide desired mass differentiation PPM . Such a detector is beneficially placed at the channel exit of the quadrupole e.g. Q3 of to provide data that can be deconvoluted into a rich mass spectrum . The resulting time dependent data resulting from such an operation is converted into a mass spectrum by applying deconvolution methods described herein that convert the collection of recorded ion arrival times and positions into a set of m z values and relative abundances.

A simplistic configuration to observe such varying characteristics with time can be in the form of a narrow means e.g. a pinhole spatially configured along a plane between the exit aperture of the quadrupole Q3 and a respective detector designed to record the allowed ion information. By way of such an arrangement the time dependent ion current passing through the narrow aperture provides for a sample of the envelope at a given position in the beam cross section as a function of the ramped voltages Importantly because the envelope for a given m z value and ramp voltage is approximately the same as an envelope for a slightly different m z value and a shifted ramp voltage the time dependent ion currents passing through such an example narrow aperture for two ions with slightly different m z values are also related by a time shift corresponding to the shift in the RF and DC voltages. The appearance of ions in the exit cross section of the quadrupole depends upon time because the RF and DC fields depend upon time. In particular because the RF and DC fields are controlled by the user and therefore known the time series of ion images can be beneficially modeled using the solution of the well known Mathieu equation for an ion of arbitrary m z.

However while the utilization of a narrow aperture at a predetermined exit spatial position of a quadrupole device illustrates the basic idea there are in effect multiple narrow aperture positions at a predetermined spatial plane at the exit aperture of a quadrupole as correlated with time each with different detail and signal intensity. To beneficially record such information the spatial temporal detector configurations of the present invention are in effect somewhat of a multiple pinhole array that essentially provides multiple channels of resolution to spatially record the individual shifting patterns as images that have the embedded mass content. The applied DC voltage and RF amplitude can be stepped synchronously with the RF phase to provide measurements of the ion images for arbitrary field conditions. The applied fields determine the appearance of the image for an arbitrary ion dependent upon its m z value in a way that is predictable and deterministic. By changing the applied fields the present invention can obtain information about the entire mass range of the sample.

As a side note there are field components that can disturb the initial ion density as a function of position in the cross section at a configured quadrupole opening as well as the ions initial velocity if left unchecked. For example the field termination at an instrument s entrance e.g. Q3 s often includes an axial field component that depends upon ion injection. As ions enter the RF phase at which they enter effects the initial displacement of the entrance phase space or of the ion s initial conditions. Because the kinetic energy and mass of the ion determines its velocity and therefore the time the ion resides in the quadrupole this resultant time determines the shift between the ion s initial and exit RF phase. Thus a small change in the energy alters this relationship and therefore the exit image as a function of overall RF phase. Moreover there is an axial component to the exit field that also can perturb the image. While somewhat deleterious if left unchecked the present invention can be configured to mitigate such components by for example cooling the ions in a multipole e.g. the collision cell Q2 shown in and injecting them on axis or preferably slightly off center by phase modulating the ions within the device. The direct observation of a reference signal i.e. a time series of images rather than direct solution of the Mathieu equation allows us to account for a variety of non idealities in the field. The Mathieu equation can be used to convert a reference signal for a known m z value into a family of reference signals for a range of m z values. This technique provides the method with tolerance to non idealities in the applied field.

As discussed above as the RF and DC amplitudes are ramped linearly in time the a q values for each ion each increase linearly with time as shown above in . Specifically the ions in traversing the length of a quadrupole undergo a number of RF cycles during this changing condition and as a consequence such ions experience a changing beta during the ramping of the applied voltages. Accordingly the exit position for the ions after a period of time change as a function of the ramp speed in addition to other aforementioned factors. Moreover in a conventional selective mass filter operation the peak shape is negatively affected by ramp speed because the filter s window at unit mass resolving power shrinks substantially and the high and low mass cutoffs become smeared. A user of a conventional quadrupole system in wanting to provide selective scanning e.g. unit mass resolving power of a particular desired mass often configures his or her system with chosen a q parameters and then scans at a predetermined discrete rate e.g. a scan rate at about 500 AMU sec to detect the signals.

However while such a scan rate and even slower scan rates can also be utilized herein to increase desired signal to noise ratios the present invention can also optionally increase the scan velocity up to about 10 000 AMU sec and even up to about 100 000 AMU sec as an upper limit because of the wider stability transmission windows and thus the broader range of ions that enable an increased quantitative sensitivity. Benefits of increased scan velocities include decreased measurement time frames as well as operating the present invention in cooperation with survey scans wherein the a q points can be selected to extract additional information from only those regions i.e. a target scan where the signal exists so as to also increase the overall speed of operation.

To illustrate operability by way of an example the first surface of the chevron or Z stack MCP can be floated to 10 kV i.e. 10 kV when configured for negative ions and 10 kV when configured to receive positive ions with the second surface floated to 12 kV and 8 kV respectively as shown in . Such a plate biasing provides for a 2 kV voltage gradient to provide the gain with a resultant output relative 8 to 12 kV relative to ground. All high voltages portions are under vacuum between about 1e 5 mBar and 1e 6 mBar with an inert gas such as for example Argon.

The example biasing arrangement of thus enables impinging ions I as received from for example the exit of a quadrupole as discussed above to induce electrons in the front surface of the MCP that are thereafter directed to travel along individual channels of the MCP as accelerated by the applied voltages. As known to those skilled in the art since each channel of the MCP serves as an independent electron multiplier the input ions I as received on the channel walls produce secondary electrons denoted as e . This process is repeated hundreds of times by the potential gradient across both ends of the MCP stack and a large number of electrons are in this way released from the output end of the MCP stack to substantially enable the preservation of the pattern image of the particles incident on the front surface of the MCP.

Returning back to the biasing arrangement also provides for the electrons multiplied by the MCP stack to be further accelerated in order to strike an optical component e.g. a phosphor coated fiber optic plate configured behind the MCP stack . Such an arrangement converts the signal electrons to a plurality of resultant photons denoted as p that are proportional to the amount of received electrons. Alternatively an optical component such as for example an aluminized phosphor screen can be provided with a biasing arrangement not shown such that the resultant electron cloud from the MCP stack can be drawn across a gap by the high voltage onto a phosphor screen where the kinetic energy of the electrons is released as light. In any arrangement a subsequent plate such as a photosensitive channel plate assembly shown with the anode output biased relative to ground can then convert each incoming resultant photon p back into a photoelectron. Each photoelectron generates a cloud of secondary electrons at the back of the photosensitive channel plate which spreads and impacts as one arrangement an array of detection anodes such as but not limited to an two dimensional array of resistive structures a two dimensional delay line wedge and strip design as well as a commercial or custom delay line anode readout. As part of the design the photosensitive channel plate and the anodes are in a sealed vacuum enclosure as denoted by the dashed vertical rectangle .

As an illustrative example of a two dimensional anode structure to comport with the designs herein such an array can be configured as a linear X Y grid with the anode structure often optimally configured herein to be smaller than those further from the center since almost all ion trajectories received from the exit of a quadrupole pass through the origin and thus comprise the most signal. As an illustrative arrangement if an Arria FPGA is utilized a target grid of 10 radial sectors and 8 radial divisions in a spider web arrangement is desired. From such an example arrangement the output of the anodes can be configured as four symmetrical quadrants that are physically joined. If capacitance effects degrade the bandwidth of the signals each of the anodes of can be coupled to an independent amplifier and additional analog to digital circuitry ADC as known in the art. For example such independent amplification can be by way of differential trans impedance amplifiers to amplify and suppress noise with the ADC s being provided by octal ADC s converting at less than about 500 MHz often down to about 100 MHz often at least about 40 MHz. If the ion entrance provided by a quadrupole is not symmetrical then additional discrimination can be provided by an off axis entrance orifice or by use of a cooling cell as briefly discussed above such as Q2 in the triple quad arrangement shown in so as to alter the input phase and enhance system operations. In this case joining opposite sectors is not desired.

While such an anode structure shown in is a beneficial embodiment it is to also be appreciated that delay line anodes as stated above of different designs e.g. cross wired delay line anodes helical grids etc. can also be implemented in the shown arrangement of or equally arranged to be coupled adjacently following the MCP stack without the additional shown components so as to also operate within the scope of the present invention. To enable the working of such devices the structures themselves are often coupled with appropriate additional timing and amplification circuitry e.g. trans impedance amplifiers matched to the anode configurations in order to aid in converting the reading of the signal differences in arrival time into image position information. Particular beneficial cross wired delay line anodes that can be utilized with the systems of the present invention can be found in U.S. Pat. No. 6 661 013 entitled DEVICE AND METHOD FOR TWO DIMENSIONAL DETECTION OF PARTICLES OR ELECTROMAGNETIC RADIATION to Jagutzki et al. issued Dec. 9 2003 the disclosure of which is hereby incorporated by reference in its entirety.

Turning back to the basic anode structure of the signals resultant from amplifier and analog to digital circuitry ADC and or charge integrators not shown can eventually be directed to a Field Programmable Gate Array FPGA via for example a serial LVDS low voltage differential signaling high speed digital interface which is a component designed for low power consumption and high noise immunity for the data rates of the present invention. An FPGA is beneficial because of the capability of being a configurable co processor to a computer processing means as shown in allowing it to operate as an application specific hardware accelerator for the computationally intensive tasks of the present invention. As one such example non limiting arrangement a commercial Arria FPGA having 84 in 85 out LVDS I O channels as well as integrated PCI express hardware denoted with four bidirectional arrows having at least a 4 channel PCI express acquisition system feeding a standard data processing means e.g. a computer a PC etc. can be utilized with a Compute Unified Device Architecture CUDA parallel processing Graphics Processing Unit GPU subsystem.

To provide photon to time and position detection an optical component such as but not limited to a phosphor coated fiber optic plate is configured a behind the MCP stack so as to convert the signal electrons to a plurality of photons proportional to the amount of received electrons from the MCP stack . Thereafter an optical conduit often a tapered fiber optic bundle is coupled to the phosphor coated fiber optic plate to expand the image size up to about 80 mm e.g. 40 mm in at least one of the X Y dimensions to provide a resolution that is not limited by the quadrupole device. The optical conduits often the tapered optical conduits can be configured from round square and hexagonal formats and can be fabricated in the form of almost any regularly shaped polygon.

In the configuration shown in the directed photons are then received by a commercial or custom made delay line system . As an example configuration to illustrate without limiting the configurations herein the delay line system can be a commercial RoentDek delay line 3 dimensional photosensitive detector encapsulated within a sealed tube housing. Such a system is often configured with a low noise photo cathode not shown coupled to a fiber optic window also not shown designed to convert received photons from the optical conduit into proportional electrons. Thereafter a chevron or Z Stack microchannel plate MCP receives and amplifies the converted electrons and directs a resultant electron cloud to orthogonal delay line anodes generally shown as . The lead of the anodes are thus coupled to a circuit board not shown located external to the sealed environment wherein the circuit board can include five constant fraction discriminators CFD not shown and time to digital converters TDC also not shown designed to register up to about five precise time stamps for every single ion event as eventually provided to a PCI interface and data processing means not shown as discussed above. Because of the arrangement shown in the ion events I are thus easily converted into a three dimensional representation of X and Y coordinates and time of arrival for each and every ion as long as the arrival rate does not exceed the typical pulse pile up limit for counting systems.

As similarly discussed above different delay line anode designs e.g. cross wired delay line anodes helical grids etc. can also be substituted for the anode structures shown in i.e. by substituting structures found in for example incorporated by reference U.S. Pat. No. 6 661 013. Moreover as part of the read out concept for MCPs advanced by Roentek the present invention can also be configured with a delay line read out anodes mounted outside of the sealed environment. In such an arrangement a resistive layer of Germanium is deposited directly on the output window glass or ceramics of the intensifier replacing the phosphor screen of a conventional image intensifier. The position information is obtained by a dedicated pickup delay line electrode anode and coupled read out board mounted outside the seal and in close contact to the window. The spacing between the travelling charge cloud inside the tube and the separated read out electrode outside causes a geometrical spread of the induced signal on the read out board. This is beneficial because it allows using rather coarse read out structures e.g. strips with few millimeters of pitch for the delay line read out.

Thus desired incoming ions I shown directionally by way of accompanying arrows are received by the front end assembly of microchannel plates MCPs as similarly discussed above with respect to . To provide the photon to time and position detection an optical component such as but not limited to a phosphor coated fiber optic plate is again configured a few millimeters behind the MCP stack so as to convert the signal electrons to a plurality of photons proportional to the amount of received electrons from the MCP stack . Thereafter an optical conduit such as but not limited to a tapered fiber optic bundle is coupled to the phosphor coated fiber optic plate to magnify and or minify the produced images so as to match the dimensions of the photo detector e.g. a CID. The optical conduits as before can be configured from round square and hexagonal formats and can be fabricated in the form of almost any regularly shaped polygon.

In those example situations where an increase of mass resolving power is desired the system can be configured to provide the detected information in a manageable fashion. For example during deconvolution the dot product part of the algorithm as detailed below can be pipelined. The dot products between the observed signal and the family of reference signals can be computed on the fly by accumulating the contributions to each dot product from each pixel value as the pixel is read out. Pixel values need not be stored after their contributions to the dot products have been recorded reducing the need for large memory buffers. Using the FPGA of as an example a 64 by 64 array can be read out as 64 rows and thus 64 columns is only 128 total readings to represent most of the unique information in the 4096 pixel array. If the acquisition rate is also lowered multiple RF cycles can be averaged to reduce computational burden without significantly sacrificing mass resolving power. As another alternative a multichannel analyzer can be configured with each pixel to divide the RF cycle of the quadrupole device into a number of sub cycle bins wherein the RF is either tracked by as an example the FPGA of or the photo detector of or generated by it. Each sub cycle bin can integrate signal for the desired duration and then be read out. The total data rate is therefore a continuous conversion process with all components active all of the time.

The computer processing means not shown within the acquisition electrons as also provided in the configurations of and often includes a Graphics Processing Unit GPU which is as known to those in the field a processing means that can provide a level of massively parallel computation that was once only the preserve of supercomputers. As part of the configurations the Graphics Processing Units GPUs as utilized herein can be provided in a variety of forms such as in the form of a processor a circuit an application specific integrated circuit a digital signal processor a video card or combinations thereof or other now known or later developed devices for graphics processing. As an example the GPU can include a graphics processor or video card provided by ATI Matrox or nVIDIA using an application programming interface API of OpenCL and CUDA or other now known or later developed APIs. Such a GPU utilized herein can also include one or more vertex processors and one or more fragment processors. Other analog or digital devices may also be included such as rasterization and interpolation circuits. One or more frame buffers may also be provided for outputting data to a display.

Thus the GPU as coupled to the configurations described above is beneficially utilized to receive data representing various objects with associated spatial relationships in one or more formats. Thereafter the GPU in turn beneficially generates 2 or 3 dimensional images based on the data such as by performing texture mapping or other 2 or 3 dimensional rendering. The GPU is also operable to determine the relative positioning of the data and generate fragments representing data visible from a particular viewing direction. As part of GPU architecture utilized herein such an incorporated GPU unit also includes video memory such as for example random access memory configured to store desired amounts of information i.e. 64 128 256 or other number of kilobytes as received from an upstream device such as but not limited to the FPGA shown in . The GPU in operation thus accesses the information from the video memory for graphics processing pursuant to the application programming interface API as configured with the data processing means such as a personal computer PC .

The deconvolution process is a numerical transformation of the image data acquired from a specific mass spectrometric analyzer e.g. a quadrupole and a detector. All mass spectrometry methods deliver a list of masses and the intensities of those masses. What distinguishes one method from another is how it is accomplished and the characteristics of the mass intensity lists that are produced. Specifically the analyzer that discriminates between masses is always limited in mass resolving power and that mass resolving power establishes the specificity and accuracy in both the masses and intensities that are reported. The term abundance sensitivity i.e. quantitative sensitivity is used herein to describe the ability of an analyzer to measure intensity in the proximity of an interfering species. Thus the present invention utilizes a deconvolution process to essentially extract signal intensity in the proximity of such an interfering signal.

The instrument response to a mono isotopic species can be described as a stacked series of two dimensional images and that these images appear in sets that may be grouped into a three dimensional data packet described herein as voxels. Each data point is in fact a short series of images. Although there is the potential to use the pixel to pixel proximity of the data within the voxels the data herein is treated as two dimensional with one dimension being the mass axis and the other a vector constructed from a flattened series of images describing the instrument response at a particular mass. This instrument response has a finite extent and is zero elsewhere. This extent is known as the peak width and is represented in Atomic Mass Units AMU . In a typical quadrupole mass spectrometer this is set to one and the instrument response itself is used as the definition of the mass spectrometer s mass resolving power and specificity. Within the instrument response however there is additional information and the real mass resolving power limit is much higher albeit with additional constraints related to the amount of statistical variance inherent in the acquisition of weak ion signals.

Although the instrument response is not completely uniform across the entire mass range of the system it is constant within any locality. Therefore there are one or more model instrument response vectors that can describe the system s response across the entire mass range. Acquired data comprises convolved instrument responses. The mathematical process of the present invention thus deconvolves the acquired data i.e. images to produce an accurate list of observed mass positions and intensities.

Accordingly the deconvolution process of the present invention is beneficially applied to data acquired from a mass analyzer that often comprises a quadrupole device which as known to those of ordinary skill in the art has a low ion density. Because of the low ion density the resultant ion ion interactions are negligibly small in the device effectively enabling each ion trajectory to be essentially independent. Moreover because the ion current in an operating quadrupole is linear the signal that results from a mixture of ions passing through the quadrupole is essentially equal to N overlapping sum of the signals produced by each ion passing through the quadrupole as received onto for example a detector array as described above.

The present invention capitalizes on the above described overlapping effect via a model of detected data as the linear combination of the known signals that can be subdivided into sequential stages 

1 to produce a mass spectrum intensity estimation under the constraint that the N signals are superimposed by unit time shifts e.g. a Toeplitz system and

2 selection of a subset of the above signals with intensities significantly distinguishable from zero and subsequent refinement of their intensities to produce a mass list.

Accordingly the following is a discussion of the deconvolution process of the one or more captured images resulting from a configured quadrupole as performed by for example a coupled computer. To start let a data vector X X X . . . X denote a collection of J observed values. Let ydenote the vector of values of the independent variables corresponding to measurement X. For example the independent variables in this application position in the exit cross section and time so yis a vector of three values that describe the conditions under which Xcan be measured.

In the general case for deconvoluting a linear superposition of N known signals suppose one has N known signals U U . . . U where each signal is a vector of J components. There is a one to one correspondence between the J components of the data vector and the J components of each signal vector. For example consider the nth signal vector U U U . . . U Urepresents the value of the nth signal if it were measured at y.

One can form a model vector S by choosing a set of intensities I I . . . I scaling each signal vector U U . . . U and adding them together as indicated by Equation 1.

Let e denote the error in the approximation of X by S and then find a collection of values I I . . . Ithat minimizes e. The choice of e is somewhat arbitrary. As disclosed herein one defines e as the sum of the squared differences between the components of data vector X and the components of model vector S as shown in Equation 2.

One simplifies Equation 2 by defining an intensity vector I Equation 3 defining a difference vector Equation 4 and using an inner product operator Equation 5 . 3 4 

Using Equations 3 5 Equation 2 can be rewritten as shown in Equation 6. 6 Let I denote the optimal value of I i.e. the vector of intensities I I I . . . I that minimizes e. Then the first derivative of e with respect to I evaluated at I is zero as indicated by Equation 7.

One can use the chain rule to evaluate the right hand side of Equation 6 wherein the error e is a function of the difference vector is a function of the model vector S and S is a function of the intensity vector I which contains the intensities I I . . . I.

One then considers the derivative of e with respect to one of the intensities I evaluated at unknown I where m is an arbitrary index in 1 . . . N .

One uses the linearity of the inner product to rewrite the inner product of a sum that appears on the left hand side of Equation 14 as a sum of inner products.

The column vector on the left hand side of Equation 20 contains N row vectors each of size N. This column of rows represents an N N matrix that we will denote by A. One forms the matrix A by substituting 1 for m in Equation 17 and replacing Ain the first row of the column vector on the left hand side of Equation 20. This process is repeated for indices 2 . . . N thereby constructing an N N matrix whose entries are given by Equation 21.

To summarize the N equations are encapsulated as a single matrix equation 22 where the components of vector a that appears in the right hand side of Equation 22 are defined by Equation 18.

In the trivial case where none of the signals overlap i.e. A 0 whenever m n A is a diagonal matrix. In this case the solution of the optimal intensities are given by I a A for each n in 1 . . . N . Another special case is when the signals can be partitioned into K clusters such that A 0 whenever m and n belong to distinct clusters. In that case A is a block diagonal matrix the resulting matrix equation can be partitioned into K sub matrix equations one for each cluster or submatrix block . The block diagonal case is still O N but involves fewer computations than the general case.

In general solving an equation of the form of Equation 22 has O N complexity. That is the number of calculations required to determine the N unknown intensities scales with the cube of the number of unknown intensities.

In this section some additional constraints are imposed on the problem so as to provide a dramatic reduction in the complexity of solving the general case of Equation 22 . Constraint 1 any pair of signals Uand Ucan be superimposed by a time shift. Constraint 2 the time shift between adjacent signals Uand Uis the same for all n in 1 . . . N 1 .

An equivalent statement of constraint 1 is that all signals can be represented by a time shift of a canonical signal U. This constraint is applicable to the high mass resolving power quadrupole problem. The second constraint leads to an easily determined solution for detecting signals and providing initial estimates of their positions despite significant overlap between the signals. These two constraints reduce the solution of Equation 22 from an O N problem to an O N problem as disclosed herein below.

Constraint 1 above can be represented symbolically by Equation 23. 23 where v is a set of indices representing the values of all independent variables except time i.e. in this case position in the exit cross section and initial RF phase and q is a time index. Because the signals are related by time shifts it becomes necessary to distinguish between time and the other independent variables affecting the observations.

For Equation 23 to be well defined the collection of measurements taken at any time point m must involve the same collection of values of v as at any other time point n. Taking this property into account the definition of the inner product Equation 5 is rewritten in terms of time values and the other independent variables.

In addition because both Uand Umust be defined on the entire interval 1 . . . N both signals must also be defined outside 1 . . . N . A time shift of the interval 1 . . . N or any other finite interval would not be contained within the same interval. Therefore all signals must be defined for all integer time points presumably outside some support region of finite extent the signal value is defined to be zero.

The special property imposed by the constraints is revealed by considering the matrix entry A. The short derivation below shows that one can write Ain terms of A plus a term that in many cases are negligibly small.

In Equation 25 above the expression to the right of the first equals sign follows from the definition of the matrix entry Equation 22 the next expression follows from the new inner product definition where time is distinguished from the other independent variables Equation 24 the next expression follows by applying the time shift equation Equation 23 to each factor in order to write them in terms of Uand Urespectively. The expression on the second line of Equation 25 involves replacing the summation index q by q k. The expression on the third line of Equation 25 is the result of breaking the summation over the time index into three parts the values of q less than 1 the values of q from 1 to Q and then subtracting the extra terms from Q k 1 to Q. The second of these three sums is Aand this quantity is relabeled and pulled out front in the final expression.

To equate entry Awith Afor arbitrary values of k one considers the term that appears in parentheses in the final expression in Equation 25 to be an error term. The error term comprises two terms referred to as left and right .

The left term is zero when either signal Uor U has decreased to zero before reaching the left edge of the time window where data had been collected similarly the right term is zero when either signal has decreased to zero before reaching the right edge of the data window.

When the error term of Equation 25 is approximated by zero one can approximate each entry of the form Aby A. By definition a matrix A that satisfies this property is a Toeplitz form the significance of which is described herein below.

Suppose matrix A is a Toeplitz form. Then the entries along diagonal bands of the matrix are equivalent. For example A A A. . . In general any entry in the matrix e.g. A depends only upon the difference between the row index and the column index m n. Therefore the N N matrix contains only 2N 1 distinct values corresponding to values of m n ranging from N to N.

Matrix A can be constructed by specifying the 2N 1 distinct values placing the first N values in the first column of the matrix in inverted order i.e. from bottom to top and then filling the remaining N 1 entries of the first row from left to right. The rest of the matrix is filled by filling each of the 2N 1 bands parallel to the main diagonal by copying the value from the left or upper edge of the matrix downward to the right until reaching the bottom or left edge respectively. When A is a Toeplitz matrix Equation 22 can be solved by the method of Levinson recursion e.g. see Numerical Recipes in C requiring only O N calculations. The Toeplitz property leads to relatively rapid computation of initial estimates of N intensity values.

The errors induced by the Toeplitz approximation A A can be most easily understood when considering special cases. First consider a diagonal matrix A. Suppose that signal Ulies entirely within the time interval 1 . . . Q where data is observed i.e. no truncation. Now consider signal U which is shifted by n 1 time units to the right of U. Suppose that signal Uextends beyond time Q and thus the right tail of the signal is truncated by the data window. The inner product of Uwith itself the matrix entry A is then less than A as a result of the truncation. However in the Toeplitz approximation one equates Ato A. The resulting overestimation of Aresults in underestimation of the corresponding intensity I . Similarly in the block diagonal case the intensities of signals in blocks that are truncated by the edge of the window are also underestimated. Within a block if truncation reduces all terms by a similar scale factor the result is to scale all intensities by the inverse of the same factor.

The collection of N estimated values at regular intervals in time or equivalently m z In can be interpreted as the mass spectrum reconstructed from the observed data vector X. 

Finally one considers how to use the initial estimates that result from solving the Toeplitz system. One does not expect that the data is in fact the realization of N evenly spaced signals. Rather it is expected that the data is the realization of a relatively small number of signals e.g. k

A threshold is applied to the intensity values retaining only k signals corresponding to distinct ion species that exceed a threshold and setting the remaining intensities to zero. The thresholded model approximates the data as the superposition of k signals. As a beneficial result for application purposes of the present invention the solution of the Toeplitz system produces a set of intensity values that lead to the identification of the number of signals present k and the approximate positions of these k signals.

The present invention is thus designed to express an observed signal as a linear combination of a mixture of reference signals. In this case the observed signal is the time series of acquired images of ions exiting the quadrupole. The reference signals are the contributions to the observed signal from ions with different m z values. The coefficients in the linear combination correspond to a mass spectrum.

To construct the mass spectrum for the present invention it is beneficial to specify for each m z value the signal the time series of ion images that can be produced by a single species of ions with that m z value. The approach herein is to construct a canonical reference signal offline as a calibration step by observing a test sample and then to express a family of reference signals indexed by m z value in terms of the canonical reference signal.

At a given time the observed exit cloud image depends upon three parameters a and q and also the RF phase of the ions as they enter the quadrupole. The exit cloud also depends upon the distribution of ion velocities and radial displacements with this distribution being assumed to be invariant with time except for intensity scaling.

The construction of the family of reference signals for the present invention presents a challenge. Two of three parameters a and q that determine the signal depend upon the ratio t m z but the third parameter depends only on t not on m z. Therefore there is no way simple way to precisely relate the time series from a pair of ions with arbitrary distinct m z values.

Fortunately a countable rather than continuous family of reference signals can be constructed from a canonical reference signal by time shifts that are integer multiples of the RF cycle. These signals are good approximations of the expected signals for various ion species especially when the m z difference from the canonical signal is small.

To understand why the time shift approximation works and to explore its limitations consider the case of two pulses centered at tand trespectively and with widths of dand drespectively where t kt d kt and t d. Further assume that k is approximately 1. The second pulse can be produced from the first pulse exactly by a dilation of the time axis by factor k. However applying a time shift of t tto the first pulse would produce a pulse centered at twith a width of d which is approximately equal to dwhen k is approximately one. For low to moderate stability limits e.g. 10 Da or less the ion signals are like the pulse signals above narrow and centered many peak widths from time zero.

Because the ion images are modulated by a fixed RF cycle the canonical reference signal cannot be related to the signal from arbitrary m z value by a time shift rather it can only be related to signals by time shifts that are integer multiples of the RF period. That is the RF phase aligns only at integer multiples of the RF period.

The restriction that we can only consider discrete time shifts is not a serious limitation of the present invention. Even in Fourier Transform Mass Spectrometry FTMS where the family of reference signals is valid on the frequency continuum the observed signal is actually expressed in terms of a countable number of sinusoids whose frequencies are integer multiples of 1 T where T is the duration of the observed signal. In both FTMS and the present invention expressing a signal that does not lie exactly on an integer multiple where a reference signal is defined results in small errors in the constructed mass spectrum. However these errors are in general acceptably small. In both FTMS and in the present invention the m z spacing of the reference signals can be reduced by reducing the scan rate. Unlike FTMS a reduced scan rate in the present invention does not necessarily mean a longer scan rather a small region of the mass range can be quickly targeted for a closer look at a slower scan rate.

Returning to the deconvolution problem stated above it is assumed that the observed signal is the linear combination of reference signals and it is also assumed that there is one reference signal at integer multiples of the RF period corresponding to regularly spaced intervals of m z. The m z spacing corresponding to an RF cycle is determined by the scan rate.

The construction of a mass spectrum via the present invention is conceptually the same as in FTMS. In both FTMS and as utilized herein the sample values of the mass spectrum are the components of a vector that solves a linear matrix equation Ax b as discussed in detail above. Matrix A is formed by the set of overlap sums between pairs of reference signals. Vector b is formed by the set of overlap sums between each reference signal and the observed signal. Vector x contains the set of estimated relative abundances.

In FTMS matrix A is the identity matrix leaving x b where b is the Fourier transform of the signal. The Fourier transform is simply the collection of overlap sums with sinusoids of varying frequencies. In the present invention matrix A is often in a Toeplitz form as discussed above meaning that all elements in any band parallel to the main diagonal are the same. The Toeplitz form arises whenever the reference signals in an expansion are shifted versions of each other.

Let N be denote the number of time samples or RF cycles in the acquisition. In general the solution of Ax b has O N complexity the computation of A is O N and the computation of b is O N . Therefore the computation of x for the general deconvolution problem is O N . In FTMS A is constant the computation of b is O NlogN using the Fast Fourier Transform. Because Ax b has a trivial solution the computation is O NlogN . In the present invention the computation of A is O N because only 2N 1 unique values need to be calculated the computation of B is O N and the solution of Ax b is O N when A is a Toeplitz form. Therefore the computation of x the mass spectrum is O N .

The reduced complexity from O N to O N is beneficial for constructing a mass spectrum in real time. The computations are highly parallelizable and can be implemented on an imbedded GPU. Another way to reduce the computational burden is to break the acquisition into smaller time intervals or chunks . The solution of k chunks of size N k results in a k fold speed up for an O N problem. Chunking also addresses the problem that the time shift approximation for specifying reference signals may not be valid for m z values significantly different from the canonical reference signal.

The key metrics for assessing the performance of a mass spectrometer are sensitivity mass resolving power and the scan rate. As previously stated sensitivity refers to the lowest abundance at which an ion species can be detected in the proximity of an interfering species. MRP is defined as the ratio M DM where M is the m z value analyzed and DM is usually defined as the full width of the peak in m z units measured at half maximum i.e. FWHM . An alternative definition for DM is the smallest separation in m z for which two ions can be identified as distinct. This alternative definition is most useful to the end user but often difficult to determine

In the present invention the user can control the scan rate and the DC RF amplitude ratio. By varying these two parameters users can trade off scan rate sensitivity and MRP as described below. The performance of the present invention is also enhanced when the entrance beam is focused providing greater discrimination. Further improvement as previously stated can be achieved by displacing a focused beam slightly off center as it enters the quadrupole. When the ions enter off center the exit ion cloud undergoes larger oscillations leading to better discrimination of closely related signals. However it is to be noted that if the beam is too far off center fewer ions reach the detector resulting in a loss of sensitivity.

Scan rate is typically expressed in terms of mass per unit time but this is only approximately correct. As U and V are ramped increasing m z values are swept through the point q a lying on the operating line as shown above in . When U and V are ramped linearly in time the value of m z seen at the point q a changes linearly in time and so the constant rate of change can be referred to as the scan rate in units of Da s. However each point on the operating line has a different scan rate. When the mass stability limit is relatively narrow m z values sweep through all stable points in the operating line at roughly the same rate.

Fundamentally the sensitivity of a quadrupole mass spectrometer is governed by the number of ions reaching the detector. When the quadrupole is scanned the number of ions of a given species that reach the detector is determined by the product of the source brightness the average transmission efficiency and the transmission duration of that ion species. The sensitivity can be improved as discussed above by reducing the DC RF line away from the tip of the stability diagram. The average transmission efficiency increases when the DC RF ratio because the ion spends more of its time in the interior of the stability region away from the edges where the transmission efficiency is poor. Because the mass stability limits are wider it takes longer for each ion to sweep through the stability region increasing the duration of time that the ion passes through to the detector for collection.

When acquiring a full spectrum at any instant only a fraction of the ions created in the source are reaching the detector the rest are hitting the rods. The fraction of transmitted ions for a given m z value is called the duty cycle. Duty cycle is a measure of efficiency of the mass spectrometer in capturing the limited source brightness. When the duty cycle is improved the same level of sensitivity can be achieved in a shorter time i.e. higher scan rate thereby improving sample throughput. In a conventional system as well as the present invention the duty cycle is the ratio of the mass stability range to the total mass range present in the sample.

By way of a non limiting example to illustrate an improved duty cycle by use of the methods herein a user of the present invention can instead of 1 Da typical of a conventional system choose stability limits i.e. a stability transmission window of 10 Da as provided herein so as to improve the duty cycle by a factor of 10. A source brightness of 10 s is also configured for purposes of illustration with a mass distribution roughly uniform from 0 to 1000 so that a 10 Da window represents 1 of the ions. Therefore the duty cycle improves from 0.1 to 1 . If the average ion transmission efficiency improves from 25 to nearly 100 then the ion intensity averaged over a full scan increases 40 fold from 10 s 10 0.25 2.5 10to 10 s 10 1 10 s.

Therefore suppose a user of the present invention desires to record ions of an analyte in full scan mode wherein the analyte has an abundance of 1 ppm in a sample and the analyte is enriched by a factor of 100 using for example chromatography e.g. 30 second wide elution profiles in a 50 minute gradient . The intensity of analyte ions in a conventional system using the numbers above is 2.5 10 10 10 250 s. So the required acquisition time in this example is about 40 ms. In the present invention the ion intensity is about 40 times greater when using an example 10 Da transmission window so the required acquisition time in the system described herein is at a remarkable scan rate of about 1 ms.

Accordingly it is to be appreciated the beneficial sensitivity gain of the present invention as opposed to a conventional system comes from pushing the operating line downward away from the tip of the stability region as discussed throughout above and thus widening the stability limits. In practice the operating line can be configured to go down as far as possible to the extent that a user can still resolve a time shift of one RF cycle. In this case there is no loss of mass resolving power it achieves the quantum limit.

As described above the present invention can resolve time shifts along the operating line to the nearest RF cycle. This RF cycle limit establishes the tradeoff between scan rate and MRP but does not place an absolute limit on MRP and mass precision. The scan rate can be decreased so that a time shift of one RF cycle along the operating line corresponds to an arbitrarily small mass difference.

For example suppose that the RF frequency is at about 1 MHz. Then one RF period is 1 us. For a scan rate of 10 kDa s 10 mDa of m z range sweeps through a point on the operating line. The ability to resolve a mass difference of 10 mDa corresponds to a MRP of 100 k at m z 1000. For a mass range of 1000 Da scanning at 10 kDa s produces a mass spectrum in 100 ms corresponding to a 10 Hz repeat rate excluding interscan overhead. Similarly the present invention can trade off a factor of x in scan rate for a factor of x in MRP. Accordingly the present invention can be configured to operate at 100 k MRP at 10 Hz repeat rate slow scans at 1M MRP at 1 Hz repeat rate or fast scans at 10 k MRP at 100 Hz repeat rate. In practice the range of achievable scan speeds may be limited by other considerations such as sensitivity or electronic stability.

As one embodiment the present invention can be operated in MS full scan mode in which an entire mass spectrum is acquired e.g. a mass range of 1000 Da or more. In such a configuration the scan rate can be reduced to enhance sensitivity and mass resolving power MRP or increased to improve throughput. Because the present invention provides for high MRP at relatively high scan rates it is possible that scan rates are limited by the time required to collect enough ions despite the improvement in duty cycle provided by present invention over conventional methods and instruments.

As another embodiment the present invention can also be operated in a selected ion mode SIM in which one or more selected ions are targeted for analysis. Conventionally a SIM mode as stated previously is performed by parking the quadrupole i.e. holding U and V fixed. By contrast the present invention scans U and V rapidly over a narrow mass range and using wide enough stability limits so that transmission is about 100 . In selected ion mode sensitivity requirements often dictate the length of the scan. In such a case a very slow scan rate over a small m z range can be chosen to maximize MRP. Alternatively the ions can be scanned over a larger m z range i.e. from one stability boundary to the other to provide a robust estimate of the position of the selected ion.

As also stated previously hybrid modes of MSoperation can be implemented in which a survey scan for detection across the entire mass spectrum is followed by multiple target scans to hone in on features of interest. Target scans can be used to search for interfering species and or improve quantification of selected species. Another possible use of the target scan is elemental composition determination. For example the quadrupole of the present invention can target the A1 region approximately one Dalton above the monoisotopic ion species to characterize the isotopic distribution. For example with an MRP of 160 k at m z 1000 it is possible to resolve C 13 and N 15 peaks separated by 6.3 mDa. The abundances of these ions provide an estimate of the number of carbons and nitrogens in the species. Similarly the A2 isotopic species can be probed focusing on the C 13 S 34 and O 18 species.

In a triple quadrupole configuration the position sensitive detector used in the present invention as described above can be placed at the exit of Q3. The other two quadrupoles Q1 and Q2 are operated in a conventional manner i.e. as a precursor mass filter and collision cell respectively. To collect MSspectra Q1 and Q2 allow ions to pass through without mass filtering or collision. To collect and analyze product ions Q1 can be configured to select a narrow range of precursor ions i.e. 1 Da wide mass range with Q2 configured to fragment the ions and Q3 configured to analyze the product ions.

Q3 can also be used in full scan mode to collect full MS MS spectra at 100 Hz with 10 k MRP at m z 1000 assuming that the source brightness is sufficient to achieve acceptable sensitivity for 1 ms acquisition. Alternatively Q3 can be used in SIM mode to analyze one or more selected product ions i.e. single reaction monitoring SRM or multiple reaction monitoring MRM . Sensitivity can be improved by focusing the quadrupole on selected ions rather than covering the whole mass range.

It is to be understood that features described with regard to the various embodiments herein may be mixed and matched in any combination without departing from the spirit and scope of the invention. Although different selected embodiments have been illustrated and described in detail it is to be appreciated that they are exemplary and that a variety of substitutions and alterations are possible without departing from the spirit and scope of the present invention.

