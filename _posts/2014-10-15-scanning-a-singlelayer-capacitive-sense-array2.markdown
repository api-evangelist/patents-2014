---

title: Scanning a single-layer capacitive sense array
abstract: A method performs a scan operation for a single-layer sensor array that includes transmit (TX) electrodes and receive (RX) electrodes. The method includes determining whether to include a signal value for an RX electrode in a computation of a slope parameter value for a TX electrode. The method computes an index sum based on an index of the RX electrode when the signal value for the RX electrode is included in the computation of the slope parameter value for the TX electrode. The method computes a signal sum based on the signal value for the RX electrode when the signal value for the RX electrode is included in the computation of the slope parameter value for the TX electrode. The method then computes the slope parameter value for the TX electrode based on the signal sum and the index sum.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09542042&OS=09542042&RS=09542042
owner: PARADE TECHNOLOGIES, LTD.
number: 09542042
owner_city: Santa Clara
owner_country: US
publication_date: 20141015
---
This application is a continuation of U.S. patent application Ser. No. 14 038 423 filed Sep. 26 2013 which claims the priority and benefit of U.S. Provisional Application No. 61 785 131 filed on Mar. 14 2013 both of which are incorporated by reference herein U.S. patent application Ser. No. 14 038 423 is a continuation in part of U.S. patent application Ser. No. 13 800 468 filed on Mar. 13 2013 which claims the priority and benefit of U.S. Provisional Application No. 61 754 028 filed on Jan. 18 2013 both of which are incorporated by reference herein U.S. patent application Ser. No. 14 038 423 is also a continuation in part of U.S. patent application Ser. No. 13 405 071 filed on Feb. 24 2012 which claims the priority and benefit of U.S. Provisional Application No. 61 559 590 filed on Nov. 14 2011 and the priority and benefit of U.S. Provisional Application No. 61 446 178 filed on Feb. 24 2011 all of which are incorporated by reference herein.

This disclosure generally relates to the field of touch sensor devices and in particular to processing of touch sensor data.

Computing devices such as notebook computers personal digital assistants mobile communication devices portable entertainment devices e.g. handheld video games multimedia players etc. and set top boxes e.g. digital cable boxes digital video disc DVD players etc. may include user interface devices that facilitate interaction between a user and the computing device. One type of user interface device that has become common is a touch sensor device or touch input device that operates by way of capacitance sensing. A touch sensor device may be embodied as a touchscreen touch sensor pad touch sensor slider or touch sensor buttons and may include a touch sensor comprising an array of capacitive sensor elements. Capacitive sensing typically involves scan operations that periodically measure changes in capacitance associated with the capacitive sensor elements to determine a presence position and or movement of a conductive object e.g. a stylus a user s finger etc. relative to the touch sensor.

Touch sensors are an expensive part of a touch sensor device or the user interface system thereof. One reason for the high manufacturing cost of touch sensors is that conventional sensors use either multiple layers of electrode materials formed on multiple substrates or a single substrate with a series of jumpers to form electrical connection between the individual electrode segments and insulate them from the other electrodes that intersect them. One way to reduce the high cost of touch sensors is to route the trace portions or segments of electrodes tightly together on the active area of a single substrate without the use of jumpers . However this type of sensor construction leads to increased capacitive cross coupling between the electrodes e.g. especially in response to a conductive object touch thereby causing false touches inaccuracy and poor touch response linearity all of which limit the functionality of the touch sensor device and or lead to poor user experience.

The following description sets forth numerous specific details such as examples of specific systems components methods and so forth in order to provide a good understanding of various embodiments of the techniques described herein for correcting tail effects in single layer touch sensors e.g. such as touch sensors with SLIM electrode patterns . It will be apparent to one skilled in the art however that at least some embodiments may be practiced without these specific details. In other instances well known components or methods are not described in detail or are presented in a simple block diagram format in order to avoid unnecessarily obscuring the techniques described herein. Thus the specific details set forth hereinafter are merely exemplary. Particular implementations may vary from these exemplary details and still be contemplated to be within the spirit and scope of the present invention.

Reference in the description to an embodiment one embodiment an example embodiment some embodiments and various embodiments means that a particular feature structure or characteristic described in connection with the embodiment s is included in at least one embodiment of the invention. Further the appearances of the phrases an embodiment one embodiment an example embodiment some embodiments and various embodiments in various places in the description do not necessarily all refer to the same embodiment s .

The description includes references to the accompanying drawings which form a part of the detailed description. The drawings show illustrations in accordance with exemplary embodiments. These embodiments which may also be referred to herein as examples are described in enough detail to enable those skilled in the art to practice the embodiments of the claimed subject matter described herein. The embodiments may be combined other embodiments may be utilized or structural logical and electrical changes may be made without departing from the scope and spirit of the claimed subject matter. It should be understood that the embodiments described herein are not intended to limit the scope of the subject matter but rather to enable one skilled in the art to practice make and or use the subject matter.

Described herein are various embodiments of techniques for correcting tail effects in a touch sensor with transmit TX and receive RX electrodes that are arranged in the same e.g. single layer of the substrate of the touch sensor. Unless expressly specified otherwise touch sensors are also referred to herein as sensor arrays touch sensor arrays touch panels touch sensor panels and the like.

As used herein contact refers to a physical touch of a conductive object e.g. a stylus a user s finger and the like on the touch surface of a touch sensor and or to a hover in which the conductive object is sufficiently proximate to affect the sensor elements of the touch sensor without being in physical touch with the touch surface of the sensor. As used herein sensor element refers to a discrete unit or location area e.g. adjacency of electrodes from which a measurement or signal can be obtained that is separate and distinct from measurements signals obtained from other units or location areas in the touch sensor.

In single layer touch sensors that use interleaved electrodes without jumpers a conductive object may affect portions also referred to as segments from multiple electrodes thereby causing a change in the capacitance even of electrodes that are not directly under the contact by conductive object and that should not register or otherwise detect the contact. Such parasitic signal coupling outside of the actual touch sensor area affected by the contact causes a parasitic signal increase or a parasitic signal decrease e.g. depending on the type of sensing mechanism used by the touch sensor . Such parasitic signal increase or decrease in one or more sensor elements of a touch sensor is referred to herein as a tail effect .

In one example embodiment a device comprises a sensor coupled with a processing logic. The sensor is configured to measure a plurality of measurements from a sensor array during a scan operation where the plurality of measurements is representative of a conductive object that is in contact with or proximate to the sensor array. The sensor array comprises a plurality of RX electrodes and a plurality of TX electrodes where the plurality of RX electrodes and the plurality of TX electrodes are interleaved without intersecting each other in a single layer on a substrate of the sensor array. The processing logic is configured to determine a set of adjustment values that correspond to a tail effect associated with the plurality of measurements and to generate adjusted measurements corresponding to the plurality of measurements based on the set of adjustment values where the adjusted measurements correct a parasitic signal change of the tail effect. In some aspects of this embodiment the tail effect comprises a parasitic signal increase or a parasitic signal decrease that is caused by parasitic coupling between a primary trace of a RX electrode and a TX electrode that are affected by the conductive object where the primary trace of the RX electrode is routed adjacent to the TX electrode. The primary trace of the RX electrode and a shaped portion of the RX electrode are disposed in a touch sensing area of the sensor array but the shaped portion of the RX electrode is not affected by the conductive object.

In another example embodiment a method for correcting tail effects comprises the steps of receiving a plurality of measurements that are measured from a sensor array where the plurality of measurements are representative of a conductive object that is in contact with or proximate to the sensor array and where the sensor array comprises a plurality of RX electrodes and a plurality of TX electrodes that are interleaved without intersecting each other in a single layer on a substrate of the sensor array a processing device determining a set of adjustment values that correspond to a tail effect associated with the plurality of measurements and generating adjusted measurements corresponding to the plurality of measurements based on the set of adjustment values where the adjusted measurements correct a parasitic signal change of the tail effect. In some aspects of this embodiment the plurality of measurements include signal values for sensor elements formed by a particular TX electrode of the sensor array and determining the adjusted measurements comprises the steps of computing a sum of indices of RX electrodes that form the sensor elements along the particular TX electrode computing a sum of the signal values for the sensor elements along the particular TX electrode computing a parameter value based on the sum of indices and the sum of the signal values and adjusting each signal value of the signal values to obtain a corresponding adjusted value based at least on said each signal value the parameter value and an index of a corresponding RX electrode.

In another example embodiment a system comprises a capacitive sensor array coupled with a capacitive sensor and a processing logic coupled with the capacitive sensor. The capacitive sensor array comprises a plurality of RX electrodes and a plurality of TX electrodes where the plurality of RX electrodes and the plurality of TX electrodes are interleaved without intersecting each other in a single layer on a substrate of the capacitive sensor array. The capacitive sensor is configured to measure a plurality of measurements from the plurality of RX electrodes where the plurality of measurements is representative of a conductive object that is in contact with or proximate to the capacitive sensor array. The processing logic is configured to determine a set of adjustment values that correspond to a tail effect associated with the plurality of measurements and to generate adjusted measurements corresponding to the plurality of measurements based on the set of adjustment values where the adjusted measurements correct a parasitic signal change of the tail effect.

In the example embodiment of the touch sensor includes sensor electrodes N where N is a positive integer that are interleaved without intersecting each other e.g. in a SLIM pattern on a single layer of a substrate. The touch sensor is coupled to pins N of the processing device via one or more analog buses transporting multiple signals. For illustration purposes in this embodiment each electrode N is represented as a capacitor. The self capacitance of each electrode in touch sensor is measured by a capacitance sensor in the processing device . Depending on the type of touch sensor in some embodiments the capacitance sensor may be configured to detect the mutual capacitance of an electrode when a conductive object e.g. stylus user s finger etc. is in contact with one or more electrodes.

Capacitance sensor also referred to as just sensor may include a relaxation oscillator or other means to convert a capacitance into a measured value. Capacitance sensor may also include a counter or timer to measure the oscillator output. The capacitance sensor may further include software components to convert the count value e.g. capacitance value into a detection decision also referred to as switch detection decision or relative magnitude. In some embodiments the measured value obtained by capacitance sensor may be a signal value that represents one or more characteristics of a signal in addition or instead of in some embodiments a signal value may be a value that is derived from the measured value based on a signal characteristic e.g. such as voltage and or current magnitude raw capacitance and the like. It should be noted that there are various known methods for measuring capacitance such as current versus voltage phase shift measurement resistor capacitor charge timing capacitive bridge divider charge transfer successive approximation sigma delta modulators charge accumulation circuits field effect mutual capacitance frequency shift or other capacitance measurement algorithms. It should also be noted that instead of evaluating the raw counts relative to a threshold a capacitance sensor may be evaluating other measurements to determine the user interaction. For example in a capacitance sensor having a sigma delta modulator the capacitance sensor may be evaluating the ratio of pulse widths of the output instead of the raw counts being over or under a certain threshold.

In the example embodiment of processing device further includes processing logic . Operations of processing logic may be implemented in firmware alternatively they may be implemented in hardware or software. Processing logic is configured to perform operations that implement the techniques for correcting tail effects as described herein. For example processing logic may receive measurements from capacitance sensor adjust the measurements to compensate eliminate tail effects and then use the adjusted measurements to determine the state of touch sensor such as whether an object e.g. a finger a stylus or the like is detected on or in proximity to the touch sensor e.g. determining the presence of the object where the object is detected on the touch sensor e.g. determining the location of the object tracking the motion of the object or other information related to an object detected at the touch sensor.

In another embodiment instead of performing the operations of the processing logic in a processing device e.g. such as processing device the processing device may send the raw data or partially processed data to a host e.g. such as host . As illustrated in host may include decision logic that performs some or all of the operations described above for processing logic . Operations of decision logic may be implemented in firmware hardware software or a combination thereof. Host may include a high level Application Programming Interface API in applications that perform routines on the received data such as compensating for sensitivity differences other compensation algorithms baseline update routines start up and or initialization routines interpolation operations scaling operations and or operations that implement the techniques for correcting tail effects as described herein. The operations described with respect to the processing logic may be implemented in the decision logic the applications or in other hardware software and or firmware external to the processing device . In some other embodiments the processing device may be the host .

In another embodiment processing device may also include a non sensing actions block . This block may be used to process and or receive transmit data to and from the host . For example additional components may be implemented to operate with the processing device along with touch sensor e.g. keyboard keypad mouse trackball LEDs displays or other peripheral devices .

Processing device may reside on a common carrier substrate such as for example an integrated circuit IC die substrate or a multi chip module substrate. Alternatively the components of the processing device may be one or more separate integrated circuits and or discrete components. In one embodiment processing device may be a programmable system on a chip that is manufactured on a single IC die such as for example the Programmable System on a Chip PSoC processing device developed by Cypress Semiconductor Corporation San Jose Calif. Alternatively processing device may be one or more other processing devices known by those of ordinary skill in the art such as a microprocessor or central processing unit a controller a special purpose processor a digital signal processor DSP an application specific integrated circuit ASIC a field programmable gate array FPGA or other programmable device. In an alternative embodiment for example processing device may be a network processor having multiple processors including a core unit and multiple micro engines. Additionally processing device may include any combination of general purpose processing device s and special purpose processing device s .

In one embodiment electronic system is implemented in a device that includes touch sensing surface as the user interface such as handheld electronics portable and or smart telephones cellular telephones notebook computers personal computers personal data assistants PDAs kiosks keyboards televisions remote controls monitors handheld multimedia devices handheld video players gaming devices control panels of a household or industrial appliances or other computer peripheral or input devices. Alternatively electronic system may be used in other types of devices. It should be noted that the components of electronic system may include all the components described above. Alternatively electronic system may include only some of the components described above or include additional components not listed herein.

Capacitance sensor includes multiplexer control demultiplexer and multiplexer clock generator signal generator demodulation circuit and analog to digital converter ADC . ADC is further coupled with touch coordinate converter . Touch coordinate converter outputs a signal to processing logic .

The transmit and receive electrodes in matrix may be arranged so that each of the transmit electrodes is interleaved with the receive electrodes on the same e.g. a single substrate layer but without intersecting the receive electrodes and while maintaining electrical e.g. galvanic isolation from them. Thus each transmit electrode may be capacitively coupled with each of the receive electrodes. For example transmit electrode is capacitively coupled with receive electrode at sensor element area of matrix where the E shaped portion of receive electrode is interleaved with the comb shaped portion of transmit electrode . In the electrode pattern illustrated in matrix the E shaped portions at the same horizontal level are electrically coupled to each other in the bezel portion not shown of touch sensor to form a single horizontal receive electrode while each transmit electrode is comb shaped and runs vertically from the top to the bottom of matrix .

In some embodiments a capacitance sensor e.g. such as sensor in may be configured to use mutual capacitance sensing technique according to which a mutual capacitance present at the sensor element area of two electrodes can be measured by a processing device e.g. such as processing device in . The change in this mutual capacitance at one or more sensor element areas allows a processing logic to determine the location of a contact on the touch sensor. With mutual capacitance sensing one set of electrodes e.g. such as the column electrodes are designated as transmit TX electrodes. The transmit electrodes are driven with a TX signal that is applied to the transmit electrodes by a transmit multiplexer. Another set of electrodes e.g. such as the row electrodes are designated as receive RX electrodes. The mutual capacitance of the sensor elements formed at the areas where the rows and columns of electrodes are interleaved with each other may be measured by sampling a signal on each of the receive electrodes. In some embodiments a receive multiplexer may be used to sample the signal on one or more of the receive electrodes and to provide the receive measurement signal back to the processing logic and or to another component of the processing device .

Referring back to clock generator supplies a clock signal to signal generator which produces a transmit TX signal to be supplied to the transmit electrodes of touch sensor . In one embodiment signal generator includes a set of switches that operate according to the clock signal from clock generator . The switches may generate a TX signal by periodically connecting the output of signal generator to a first voltage and then to a second voltage where said first and second voltages are different.

The output of signal generator is connected with demultiplexer which allows a TX signal to be applied to any of the M transmit electrodes of touch sensor . In one embodiment multiplexer control controls demultiplexer so that the TX signal is applied to each transmit electrode in a controlled sequence. Demultiplexer may also be used to ground float or connect an alternate signal to the other transmit electrodes to which the TX signal is not currently being applied.

Because of the capacitive coupling between the transmit electrodes and the receive electrodes a TX signal applied to each transmit electrode induces a current within each of the receive electrodes. For instance when the TX signal is applied to transmit electrode through demultiplexer the TX signal induces a receive RX signal on the receive electrodes in matrix . The RX signal on each of the receive electrodes can then be measured in sequence by using multiplexer to connect each of the N receive electrodes to demodulation circuit in sequence.

The mutual capacitance associated with each sensor element e.g. the area where a given TX electrode is interleaved with a given an RX electrode can be sensed by selecting every available combination of TX electrode and RX electrode using demultiplexer and multiplexer . To improve performance multiplexer may also be segmented to allow more than one of the receive electrodes in matrix to be routed to additional demodulation circuits . In an optimized configuration where there is a 1 to 1 correspondence of instances of demodulation circuit with receive electrodes multiplexer may not be present in the system.

When an object such as a finger approaches electrode matrix the object causes a decrease in the mutual capacitance between only some of the electrodes. For example if a finger is placed near sensor element area where transmit electrode is interleaved with receive electrode the presence of the finger will decrease the mutual capacitance between electrodes and . Thus the location of the finger on touch sensor can be determined by identifying the one or more receive electrodes having a decreased mutual capacitance and by identifying the transmit electrode to which the TX signal was applied at the time the decreased mutual capacitance was measured on the one or more receive electrodes.

By determining the mutual capacitances associated with each sensor element formed by the transmit and receive electrodes in matrix the locations of one or more touch contacts may be determined. The determination may be sequential in parallel or may occur more frequently at commonly used electrodes.

In some embodiments other methods for detecting the presence of a finger or conductive object may be used where the finger or conductive object causes an increase in capacitance at one or more electrodes which may be arranged in a particular interleaved pattern. For example a finger placed near an electrode of a touch sensor may introduce an additional capacitance to ground that increases the total capacitance between the electrode and ground. The location of the finger can be determined from the locations of one or more electrodes at which an increased capacitance is detected.

The induced current signal is rectified by demodulation circuit . The rectified current output by demodulation circuit can then be filtered and converted to a digital code by ADC .

The digital code may then be converted to touch location coordinates indicating a position of an input on touch sensor by touch coordinate converter . The touch location coordinates are transmitted as an input signal to processing logic . In one embodiment the input signal is received at an input to processing logic . In one embodiment the input may be configured to receive capacitance measurements indicating a plurality of row coordinates and a plurality of column coordinates. Alternatively the input may be configured to receive row coordinates and column coordinates.

In some embodiments processing logic may be configured to generate or to receive e.g. from touch coordinate receiver capacitance measurements that represent diff signals also referred to herein as diff signal values . For example processing logic may be configured to determine a diff signal for a given sensor element as the difference between the settled baseline e.g. expected or fully charged capacitance of a sensor element e.g. when a conductive object is not in contact with the touch sensor and the touch sensor is not being scanned and the capacitance of the sensor element that is measured as part of a scan operation e.g. when a conductive object may or may not be in contact with the touch sensor . The capacitance used to compute a diff signal for a sensor element may be a self capacitance and or a mutual capacitance of the sensor element.

In various embodiments the processing logic may compute the diff signals for each of the sensor elements in a touch sensor based on capacitance measurements that represent the self capacitances and or the mutual capacitances of the sensor elements. For example a self capacitance of a given sensor element may include a capacitance formed between the sensor element and a reference voltage e.g. such as ground . A mutual capacitance of a given sensor element may include a capacitance formed between the transmit and receive electrodes that form the sensor element and or one or more conductive objects e.g. such as a stylus or user s finger that are electrically insulated from the capacitive sensor element.

Attempts have been made in the past to reduce the number of layers and thus the manufacturing costs of touch sensors. In some embodiments single layer touch sensors are suited only for single touch reception. These touch sensors typically use a series of electrodes the width of which linearly change from one end to the other end of an electrode. Using the signal variation along the electrode s length the coordinate along the electrode s axis is determined. The coordinate in the perpendicular direction to the electrode s axis is determined by a conventional digitization method. In other embodiments a single layer multiple touch sensor uses an array of pads filling the sensor area and each of the pads or electrodes are sensed individually in a self capacitance sensing mode. Such embodiments usually require independent traces for each of the sensing pads and a very large number of measuring channels and pins on the controller chip to get an acceptable accuracy for even a small size sensor.

In some embodiments a touch sensor device includes a touch sensor that has a single layer active area. Additionally the touch sensor device is provided with a wiring scheme that minimizes the number of wires as well as the traces required to simultaneously detect multiple contacts e.g. such as touches . As a result the overall manufacturing costs of the touch sensor and correspondingly of the touch sensor device can be reduced.

An array of electrodes is formed on central portion of substrate which includes a first set or plurality of electrodes also referred to as first electrodes and a second set or plurality of electrodes also referred to as second electrodes . First electrodes and second electrodes are all formed on the same e.g. a single layer of substrate but without intersecting each other and while maintaining electrical e.g. galvanic isolation from each other. In some embodiments in order to form the first and second electrodes a layer of transparent conductive material such as indium tin oxide ITO or a silver nano particle film may be deposited on or over substrate . As will be described in more detail hereinafter first electrodes may be used as transmit TX electrodes and second electrodes may be used as receive RX electrodes during scan operations that are performed on touch sensor . It should be understood however that these TX and RX roles are merely exemplary and may be reversed in various other embodiments.

First electrodes are substantially comb shaped having comb members facing leftward as shown in . In the portion of touch sensor depicted in three first electrodes e.g. and and two second electrodes e.g. and are included. The three first electrodes are arranged substantially vertically and extend along substantially the entire length of central portion of substrate . It should be understood though that other embodiments may use different numbers of first electrodes that may extend in directions other than vertical and that in other embodiments one subset of the first electrodes may extend only about half way down the length of the central portion with another subset of the first electrodes extending upward from a bezel portion at the bottom of the substrate.

According to the techniques for correcting tail effects described herein a second electrode comprises one or more shaped portions one or more primary traces and at least one secondary trace where the primary trace s and the shaped portion s are routed in the active touch sensing area of the touch sensor. As used herein a primary trace is also referred to as a line or a trace line . A shaped portion of an electrode has width that is greater than the width of a primary trace and a geometric shape that is different from a substantially straight line. A shaped portion is electrically connected to a respective primary trace and each primary trace is electrically coupled to the secondary trace in a non active non sensing area of the touch sensor. A primary trace of a given second electrode is routed in the active area of the touch sensor along at least a portion of one or more other primary traces of one or more other second electrodes that are formed further away from a non active area e.g. a bezel portion of the touch sensor than the given second electrode. Further a primary trace of a given second electrode is routed in the active area along at least a portion of a given first electrode. A secondary trace which electrically couples the primary trace s of a given second electrode is routed in the non active area e.g. such as a bezel portion of the touch sensor. Thus a primary trace of a given second electrode can be affected by a contact from a conductive object which can contribute to changes in the signals measured from the given second electrode during a scan operation because the primary trace is routed in the active touch sensing area of the touch sensor. On the other hand a secondary trace is typically not affected by such contact because the secondary trace is routed in the non active non sensing area of the touch sensor and therefore does not have an effect on the signals measured from the second electrode during the scan operation.

As an illustration in first electrodes are arranged in columns and second electrodes are arranged in rows where each of the columns includes one of the first electrodes and each of the rows includes one of the second electrodes . Each of second electrodes includes substantially E shaped portions that extend rightward as shown in . Each of the E shaped portions of a given second electrode is interleaved with a respective one of the first electrodes e.g. in an interdigitated pattern . Within each row the E shaped portions of a given second electrode are electrically coupled to each other and each E shaped portion is interleaved e.g. inter digitated with the comb shaped members of a respective first electrode . For example second electrode includes three E shaped portions e.g. each of which is electrically connected to a respective primary trace e.g. correspondingly where all the respective primary traces are electrically coupled to each other over a secondary trace e.g. in the bezel portion . It is noted that the specific electrode patterns shown in are merely exemplary and thus other electrode shapes and interleave patterns which may not be inter digitated are possible and within the scope of the techniques described herein.

In the primary traces coupled to the shaped portions of the second electrodes are routed substantially in parallel and adjacent to each other. The primary traces of second electrodes that are further away from bezel portion are longer and are routed adjacent to more shaped portions of other second electrodes than primary traces of second electrodes that are closer to the bezel portion.

The first electrodes the second electrodes and the primary traces may be made of indium tin oxide ITO and may be formed in a substantially planar manner on the same e.g. a single substrate layer. That is although not specifically shown in the first electrodes the second electrodes and the primary traces may have substantially the same thickness e.g. 300 Angstroms and may lay in substantially the same plane.

As illustrated in an insulating material or body or layer is formed or otherwise attached to the bezel outer portion of substrate . The insulating material covers the end portions of the primary traces that extend onto the bezel portion but it should be noted that the insulating material does not extend over the central portion of substrate . The insulating material may be made of for example an epoxy or resin material and have a thickness of for example between 5 and 25 micrometers m that is deposited on substrate . In some embodiments the insulating material may be a flexible substrate such as a flexible printed circuit FPC attached to substrate . The insulating material electrically separates a given secondary trace from at least some of the primary traces . For example in the insulating material insulates the secondary trace from the primary traces connected to second electrode and from the primary traces of those second electrodes that are different from electrode

The secondary traces or plurality of conductors are formed on the insulating material in the bezel portion of substrate . In one embodiment the secondary traces are made of silver. Of interest in the embodiment of is that a given secondary trace is electrically connected to all of primary traces that are associated with a given second electrode in a given one and only one of rows . Further in the embodiment of a separate secondary trace is electrically coupled to a corresponding one of first electrodes . For example secondary trace is coupled to first electrode . To reduce the routing area in the bezel portion in some embodiments the trace width and spacing of the secondary traces in the bezel area may be minimized. For example a metal trace line width of 10 50 m and a spacing of 10 50 m may be used in the bezel area.

It should be understood that touch sensor may include an additional set of traces not shown in . For example an additional set of ground traces may be formed in the active area of touch sensor and may be routed substantially in parallel to the first electrodes . Such ground trace may be used to provide a ground in order to electrically isolate a given first electrode from the immediately neighboring adjacent primary traces that are connected to second electrodes . As such each of the ground traces may be electrically connected to at least one of the secondary traces that is coupled to the system ground.

In operation the secondary traces are coupled to e.g. are in operable communication with an electronic system e.g. such as the system illustrated in in order to perform scan operations on touch sensor . In a scan operation touch sensor is operated by providing a signal to each one referred to as the driven TX electrode of the first electrodes in turn while grounding the remaining first electrodes . Signals are induced in those second electrodes RX electrodes that have shaped portions interleaved with the driven TX electrode because of the capacitive coupling therebetween. The signals induced in the RX electrodes are measured and or recorded by a processing logic in the electronic system. The measured recorded signals may change from pre determined baseline value s due to the presence of a conductive object e.g. such a finger or stylus that is in contact with a portion of touch sensor . A signal change e.g. from a baseline value measured on the RX electrodes is indicative of change in the capacitance e.g. in the mutual capacitance between one or more of the RX electrodes and the driven TX electrode. After measuring the signals on the RX electrodes the scan operation continues by providing a signal to the next TX electrode and measuring the corresponding RX electrodes in the same manner.

In some embodiments different materials may be used to form the sensor e.g. first and second electrodes such as copper aluminum silver or any suitable conductive material that may be appropriately patterned. Furthermore an FPC may be used to form the sensor electrodes. In such embodiments the various conductive layers in the FPC may be appropriately configured to form the array of first and second electrodes as described above as well as to form the primary traces thereof. As such it should be understood that the electrodes the traces and the insulating material or body may all be formed by a single appropriately configured FPC. As will be appreciated by one skilled in the art such embodiments may be particularly applicable to non transparent devices such as mouse pads track pads touch pads etc. Additionally in some embodiments the substrate may be made of other materials such as any suitable plastic including vinyl and polyamide which may not be transparent depending on the particular device.

In some embodiments a touch sensor may be formed by laying out the sensor electrodes using alternative conductive materials such as metal mesh. In such embodiments the sensor electrodes are formed by disposing metal mesh electrodes on PET substrate. In alternative embodiments the metal mesh sensor electrodes may be disposed on glass substrate. In other embodiments the sensor electrodes may be formed with silver nano wires on PET or silver nano wire on glass substrate. In other embodiments a touch sensor may be formed by bonding a glass or other transparent insulating lens onto another glass with the sensor electrode pattern disposed on. In yet other embodiments the touch sensor may be formed by bonding glass or other transparent insulating material onto a sheet of PET containing the sensor pattern.

Thus embodiments described herein provide a touch sensor device with a single layer structure in the active area or portion of the touch sensor in the device while a multi layer structure may be used in the bezel or other non sensing portions of the touch sensor for routing the traces. Such multi layer routing allows the repeated use of the traces so that the touch sensor uses the minimum number of traces and the minimum number of pins on the electronic system which drives the touch sensor device thereby reducing the associated manufacturing costs.

The tail effect in a single layer touch sensor may be a parasitic signal increase or a parasitic signal decrease in one or more sensor elements in response to a contact by a conductive object e.g. a stylus a user s finger etc. with the touch sensor. In some embodiments the tail effect for a given sensor element is caused by a parasitic signal coupling between a TX electrode and the primary trace of an RX electrode whose shaped portion is outside the actual contact area and is thus not affected by the contact.

The techniques for correcting tail effect described herein provide for analyzing the signal profile from a specific section of a touch sensor. The analysis uses linear approximation e.g. based on the measured derived signal values of sensor elements that are below some tail effect threshold value to compute adjustment values that correct the parasitic signal change of the tail effect and subtracts the adjustment values from the measured derived signal values before performing position calculation to compute the location coordinates of the contact.

Specifically RX electrode includes shaped portion that is electrically connected to primary trace and shaped portion that is electrically connected to primary trace . Similarly RX electrode includes shaped portion that is electrically connected to primary trace and shaped portion that is electrically connected to primary trace . RX electrode includes shaped portion that is electrically connected to primary trace and shaped portion that is electrically connected to primary trace . RX electrode includes shaped portion that is electrically connected to primary trace and shaped portion that is electrically connected to primary trace . RX electrode includes shaped portion that is electrically connected to primary trace and shaped portion that is electrically connected to primary trace . Finally RX electrode includes shaped portion that is electrically connected to primary trace and shaped portion that is electrically connected to primary trace .

As illustrated in there is extra parasitic coupling on the primary traces of the RX electrodes whose shaped portions are not actually covered by the contact. However these not affected by the contact shaped portions are interleaved with the shaped members of the corresponding TX electrodes to form the sensor elements from which distinct signal values are obtained. Thus the tail effect causes more sensor elements to falsely register the contact because the primary traces connected to these sensor elements are directly affected by the contact even though the sensor elements themselves are not in the area of the contact . Further since the same primary traces are routed adjacent next to each TX electrode the more TX electrodes are covered by the contact the higher the tail effect will be.

As also illustrated in the tail effect is seen or registered by downstream RX electrodes and their sensor elements when the routing of the RX electrodes goes from the top of the touch sensor to the bottom. The opposite will be true if the RX electrodes are routed from the bottom of the touch sensor to the top. In some embodiments in order to minimize the total width of the area occupied by the primary traces of the RX electrodes e.g. such as the width of parasitic coupling areas and a touch sensor e.g. such as a SLIM touch panel may be double routed e.g. from a top bezel non sensing area and from a bottom bezel non sensing area of the touch sensor. This means that about half of the RX electrodes will have primary traces routed e.g. extending down from a top bezel with the remaining RX electrodes having their primary traces routed e.g. extending up from a bottom bezel of the touch sensor.

An example of a double routed single layer touch sensor panel is illustrated in . In the example embodiment of touch sensor includes top bezel non sensing area top active touch sensing area bottom active touch sensing area and bottom bezel non sensing area . The RX electrodes in the top active area are routed from the top bezel area while the RX electrodes in the bottom active area are routed from the bottom bezel area . In the embodiment illustrated in the TX electrodes in the top active area and the bottom active area are both routed from the top bezel area . In other embodiments similarly to the RX electrodes the TX electrodes may also be spilt and double routed from opposite non sensing areas e.g. if there is a need to reduce the RC constant of the sensor elements.

In the case of a double routed touch sensor panel such as the panel in a contact by a conductive object will cause a separate tail effect on each side of the panel. For example a contact placed in the top active area of touch sensor will create a tail effect in sensor elements down from the contact area and towards the middle line where the routing changes to bottom bezel routing. Similarly a contact placed in the bottom active area of touch sensor will create a tail effect in sensor elements up from the contact area and toward the middle line .

An example of a separate tail effect on each side of a double routed single layer touch sensor panel is illustrated in . Specifically illustrate an example data structure that stores signal values reflecting tail effects caused by conductive objects on each side of a double routed touch sensor panel according to an example embodiment.

In the sensor elements of the sensor array are represented logically as boxes formed by 11 TX electrodes and 19 RX electrodes. A sensor or processing logic not shown that operates the sensor array stores associates a separate index value for each separate TX electrode where the index values are arranged in a sequence representing a physical arrangement of the TX electrodes in the sensor array similarly the sensor or processing logic also stores associates a separate index value for each separate RX electrode where the index values are arranged in a sequence representing a physical arrangement of the RX electrodes in the sensor array.

For example in TX index is a sequence of integer values ranging from 0 to 10 that represent the 11 TX electrodes similarly RX index is a sequence of integer values ranging from 0 to 18 that represent the 19 RX electrodes. In the embodiment illustrated in RX electrodes with index values 0 to 9 are routed from the top non sensing area thereby forming the top portion of the sensor array while the remaining RX electrodes with index values 10 to 18 are routed from the bottom non sensing area thereby forming the bottom portion of the sensor array.

In the diff values for the sensor elements represented in data structure are obtained by a scan operation at a given point in time. The diff values indicate that a contact is present on the touch surface in the bottom portion of the sensor array. The diff values also indicate that tail effect is also present in the bottom portion of the array only. It is noted that the diff values represent the state of the sensor elements of the sensor array at the time the scan operation is performed thus the contact illustrated in may be a stationary contact e.g. such as a tap or may be part of a more complex gesture e.g. such as a scrolling gesture .

In the diff values for the sensor elements represented in data structure are obtained by a scan operation that is different than the scan operation reflected in e.g. at a different point in time . Referring to the diff values indicate that a contact is present on the touch surface in the top portion of the sensor array. The diff values also indicate that tail effect is also present in the top portion of the sensor array only. The contact illustrated in may be a stationary contact e.g. such as a tap or may be part of a more complex gesture e.g. such as a scrolling gesture .

It is noted that various different sensor designs are prone to the parasitic tail effect described above except that the degree to which the tail effect is exhibited may vary from design to design. Thus in various embodiments the techniques for correcting tail effect described herein may be implemented for sensor arrays that were constructed according to various different design technologies. Such designs and technologies include but are not limited to single solid diamond design MH3 and metal mesh.

The tail effect in single layer touch sensors is proportional to the RX index of the RX electrodes under a contact with the presumption that the RX index values increase in the direction away from the side of the touch sensor from which the RX electrodes are routed. For example the further away the shaped portion of an RX electrode is from the actual contact the more tail effect signal from parasitic coupling it gets. Referring to as an example even though shaped portions and are farther away from the contact RX electrode gets the most signal from parasitic coupling when compared to the other depicted RX electrodes at least because 1 the primary trace portions and run a longer length along TX electrodes and respectively and 2 when the conductive object is present it reduces the signal from all four shaped portions of RX electrodes that are directly affected proportionally with respect to the baselines of the corresponding sensor elements and thus the bottom RX electrode still gets the most signal from the parasitic coupling. To put it differently RX electrode gets the smallest signal increase because of parasitic coupling under contact because this RX electrode has the shortest primary traces.

According to the techniques for correcting tail effect described herein a given scan operation also referred to as a scan frame or cycle obtains measurements for all sensor elements in the sensor array e.g. by powering the TX electrodes and reading the signal on the RX electrodes . In some embodiments obtaining the measurements may involve multiplexing several or all of the RX electrodes at the same time when obtained the set of measurements from all RX electrodes represents the measurements of a single scan operation. A processing logic determines the diff signal values from the measurements obtained by the scan operation for example by comparing the obtained measurements to the baseline values that are stored for the corresponding sensor elements. Then assuming all sensor elements with signal strength below some threshold are caused by a tail effect the techniques described herein provide for building determining the parameters of an approximation line based on the determined diff signal values using the determined parameters to compute for each affected sensor element an adjustment value that corresponds to the tail effect and subtracting each computed adjustment value from the signal value of the corresponding sensor element thereby correcting for the tail effect.

It is noted that in double routed touch sensor designs which provide a touch sensor with two separately routed portions a separate approximation line with its own separate parameters may be used when correcting for tail effect in each of the two separately routed portions. Such separate parameters would indicate approximation lines with different angles starting on the edge of each portion of the touch sensor and ending in the middle of the touch sensor. An example of such double approximation lines is illustrated in .

In some embodiments the tail effect threshold may depend either on a contact threshold setting for the touch sensor or on absolute peak signal as a certain percentage of it. In some embodiments it makes more sense to make the tail effect threshold value dependent on absolute peak signal as the tail effect is proportional to the absolute peak signal value. For example in one particular embodiment the tail effect threshold is set as a percentage of the contact determination threshold of the touch sensor. In this particular embodiment the determination contact threshold is adaptive and depends on the maximum peak value detected by the underlying scan operation and a typical setting for the tail effect threshold is two thirds of the adaptive contact threshold value.

More generally if a touch sensor is intended to be operated with small objects e.g. such as small fingers or styli then a dynamic adaptive type of threshold is preferably used since the differences between the scan operation measurements e.g. raw counts from an actual touch and from a tail effect are not that big. For example a contact from a 4 mm finger may generate a signal that is about the same in magnitude as the signal from the tail effect of a larger finger e.g. a 20 mm finger . Thus the use of a dynamic adaptive contact determination threshold is useful initially a very low detection threshold may be set to detect the contact by the small finger and thereafter the contact determination threshold may be dynamically adjusted specifically for this contact based on the maximum peak signal value e.g. raw counts that is actually measured for the contact. In this example the tail effect threshold may be set as 50 less than the maximum peak signal actually detected. In this manner the tail effect threshold is adapted for each contact that is detected.

In some embodiments if a touch sensor is intended to be operated with bigger objects e.g. such as normal or fat fingers then a fixed tail effect threshold is preferably used since the differences between the magnitude of an actual touch and the magnitude of the tail effect signal due to parasitic coupling are significant. For example threshold in represents a fixed threshold value of about 55 that may be used to determine tail effect signals e.g. diff signal values that are above 0 and below 55 may be considered as tail effect signals.

According to the techniques for correcting tail effect described herein the diff signals of the sensor elements that are below a fixed or adaptive tail effect threshold are used in the linear approximation computation for the given TX electrode along which these sensor elements are formed.

In some embodiments equation 1 below is used to determine a linear approximation e.g. such as a best fit line of the dependence between diff signals due to the tail effect and the index values of RX electrodes that form the sensor elements corresponding to the diff signals Index 1 where 

b is an intercept or offset parameter equal or approximately equal to 0 since the tail effect signal does not exist or is negligible at the edge of the touch sensor from which the RX electrodes are routed e.g. because RX electrodes at that edge do not have a significant length of primary traces exposed to the contact 

rxIndex is the RX index value of one e.g. the i RX electrode that forms one e.g. the i individual sensor element along a given TX electrode 

a is a constant slope or angle parameter value that defines the skew slope of the approximation best fit line for the given TX electrode it is noted that the slope parameter value is unique for each TX electrode and for each portion of the touch sensor from which RX electrodes are routed if a double routed touch sensor design is used and

Srepresents the adjustment value for one e.g. the i individual sensor element where this adjustment value corresponds to the tail effect signal at the isensor element as determined based on the approximation best fit line and should be subtracted from the diff signal of that sensor element in order to correct for the tail effect.

In some embodiments the value of slope parameter or coefficient a may be determined by using equation 2 below 

sis the diff signal value obtained from one e.g. the i individual sensor element formed by one e.g. the i RX electrode along the given TX electrode 

i is the RX index value of one e.g. the i individual sensor element along the given TX electrode whose diff signal value sis greater than 0 and less than the tail effect threshold that is being used 

N is the number of sensor elements along the given TX electrode that have diff signal values greater than 0 and less than the tail effect threshold 

 sis the sum of the diff signal values for the sensor elements along the given TX electrode that have diff signal values greater than 0 and less than the tail effect threshold and

 i is the sum of the RX index values of the sensor elements along the given TX electrode that have diff signal values greater than 0 and less than the tail effect threshold. Thus according to equation 2 only sensor elements with diff signals having values between 0 and threshold are used to determine the parameters of the approximation best fit line with the rest of the sensor elements and their RX index value being skipped from the calculation.

An example of an approximation best fit line for a double routed touch sensor is illustrated in e.g. such as best fit line . As illustrated in only the sensor elements corresponding to the diff signal values indicated by reference numeral are used in determining the parameters of the best fit line

In some embodiments after the slope parameter or coefficient a is determined e.g. according to equation 2 above for a given TX electrode the adjustment value Sis computed for the corresponding e.g. i sensor element e.g. according to equation 1 above . The tail effect is then corrected by subtracting the adjustment value Sfrom the diff signal value sobtained for the corresponding e.g. i sensor element by using equation 3 below DiffIndex 3 

a rxIndex e.g. S is the adjustment value that corresponds to the tail effect for the sensor element formed along the given TX electrode by the RX electrode with RX index value of rxIndex e.g. the isensor element 

S e.g. s is the originally obtained diff signal value for the for the sensor element formed along the given TX electrode by the RX electrode with RX index value of rxIndex e.g. the isensor element and

Diff e.g. S is the tail effect corrected diff signal value for the sensor element formed along the given TX electrode by the RX electrode with RX index value of rxIndex e.g. the isensor element .

In the example illustrated in the left side e.g. the top portion of the touch sensor has received almost no signal from a contact so the tail effect correction for this side is minimal. On the right side e.g. the bottom portion of the touch sensor a tail effect from a contact was observed and the signal from it needs to be subtracted based on the parameters of best fit line according to the techniques described herein. The resulting signal as corrected for the tail effect is plotted on the .

In some embodiments the tail effect correction is applied only for performing position calculation for a detected contact and the tail effect correction should be reverted after the position calculation is completed. This is needed in order to maintain the correct baseline values for the sensor elements in the touch sensor in reference to the actual measured signal from a given scan operation and make sure that the input data for the scan operation will have the same visible tail effect.

In some embodiments reverting the tail effect correction may be performed by using equation 4 below DiffIndex 4 

a rxIndex e.g. S is the adjustment value that corresponds to the tail effect for the sensor element formed along the given TX electrode by the RX electrode with RX index value of rxIndex e.g. the isensor element 

S e.g. s is the currently stored tail effect corrected diff signal value for the for the sensor element formed along the given TX electrode by the RX electrode with RX index value of rxIndex e.g. the isensor element and

Diff e.g. S is the reverted e.g. original diff signal value for the sensor element formed along the given TX electrode by the RX electrode with RX index value of rxIndex e.g. the isensor element .

This reversion of the tail effect correction is applied individually for each TX electrode and for each portion of the touch sensor from which RX electrodes are routed e.g. if a double routed touch sensor design is used .

An example of a tail effect corrected data which was obtained experimentally from a certain embodiment is illustrated in . Specifically illustrates data structure that stores diff signal values that reflect a tail effect caused by a conductive object on a double routed touch sensor. illustrates the same data structure that stores signal values that are adjusted with a correction for the tail effect. In the sensor elements of the touch sensor are represented logically as boxes formed by 11 TX electrodes and 19 RX electrodes where TX index is a sequence of integer values ranging from 0 to 10 that represent the 11 TX electrodes and RX index is a sequence of integer values ranging from 0 to 18 that represent the 19 RX electrodes. In the embodiment illustrated in RX electrodes with index values 0 to 9 are routed from a top non sensing area thereby forming the top portion of the touch sensor while the remaining RX electrodes with index values 10 to 18 are routed from a bottom non sensing area thereby forming the bottom portion of the touch sensor.

In the diff signal values for the sensor elements represented in data structure are obtained by a scan operation at a given point in time. The diff signal values indicate that a contact is present in contact area in the bottom portion of the touch sensor. The diff signal values also indicate that a tail effect is present tail effect area . In the diff values for the sensor elements represented in data structure have been corrected for the tail effect according to the techniques described herein. For example adjustment values corresponding for the tail effect have been computed for the sensor elements in the touch sensor and these adjustment values have been subtracted from the corresponding diff signal values stored in data structure . As a result in data structure stores the corrected diff signal values for the sensor elements in contact area and in the corrected tail area . Thus shows the initial signal map with the tail effect being present while shows the corrected signal map with the tail effect being eliminated according to the techniques described herein. After the tail effect correction is applied as illustrated in the position of the object in contact with the touch sensor is right in the middle of contact area

In embodiments that use double routed touch sensors the RX index value e.g. such as the rxIndex value used in equations 1 3 and 4 above should be always 0 at the end of the touch sensor even if this RX index value corresponds to the last RX electrode in the sequence and the closest RX electrode or sensor element to the middle of the touch sensor should have an RX index value equal to this RX electrode s incremental number from the edge of the touch sensor. In other words for the purpose of the tail effect correction computations the indexing of the RX electrodes should start from 0 and be incremented from that side of the touch sensor from which the RX electrodes are routed. Thus in the case of a double routed touch panel a re mapping of the RX index values of RX electrodes may be needed for the purposes of the tail effect correction computations described herein e.g. as in equations 1 3 and 4 above . For example with respect to the RX index values 10 to 18 for the bottom nine RX electrodes should be re mapped to values 9 to 0 respectively prior to computing the tail effect corrections. This is but one way in which the techniques described herein can preserve the dependency that exists between tail effect and RX index values in single layer touch sensors namely that the tail effect increases proportionally to the increase of the RX index values of the RX electrodes under a contact.

In blocks to a processing logic performs a scan operation. In block as part of the scan operation the processing logic receives a plurality of measurements that are measured from a sensor array. The measurements are affected by a contact at the touch surface of the sensor array by a conductive object e.g. such as a stylus or user s finger . In some embodiments the measurements received by the processing logic may include diff signal values for all or a portion of the sensor elements in the sensor array in other embodiments the processing logic may receive raw measurements e.g. raw signal counts from the sensor elements and may compute the corresponding diff signal values.

After receiving and or computing the diff signal values corresponding to the received measurements in block the processing logic performs an operation that initializes to zero a variable txIndex which denotes the TX index value of the current TX electrode for which computations are being performed.

In block the processing logic determines whether there are any remaining TX electrodes which need to be processed. For example the processing logic performs a comparison operation to compare the value stored in the txIndex variable to a variable or constant txLast which denotes the total number of TX electrodes that need to be processed as part of the scan operation e.g. such as the total number of TX electrodes in the sensor array . If the txIndex variable is less than the txLast variable then at least the current TX electrode still needs to be processed and the processing logic continues to perform the operations in blocks to . If the txIndex variable is not less than the txLast variable then the diff signal values for the sensor elements of all TX electrodes have been processed and the processing logic continues to perform the operations in block .

Block includes blocks to which include the operations that the processing logic performs to compute e.g. according to equation 2 above the slope parameter value a of the best fit line that approximates the tail effect signal for the current TX electrode that is indicated by the txIndex variable . If the sensor array is double routed the processing logic performs the operations in block e.g. the operations in blocks to twice i.e. once for each portion of the sensor array from which RX electrodes are routed. It is noted that when performing these operations for the bottom portion of the sensor array the RX index values of the RX electrodes routed from this portion may need to be re mapped as described above e.g. in order to preserve the dependency that exists between the tail effect and the RX index values .

In block the processing logic performs an operation that initializes to zero a variable rxIndex which denotes the RX index value of the current RX electrode along the current TX electrode for which computations are being performed.

In block the processing logic performs an operation that initializes to zero a variable snsSum which denotes the sum of the RX index values of the sensor elements formed along the current TX electrode that are included in computing the slope parameter or coefficient value a for the current TX electrode.

In block the processing logic determines whether there are any remaining RX electrodes that need to be processed for the current TX electrode. For example the processing logic performs a comparison operation to compare the value stored in the rxIndex variable to a variable or constant rxLast which denotes the total number of RX electrodes that need to be processed for the current TX electrode. If the rxIndex variable is less than the rxLast variable then at least the current RX electrode still needs to be processed and the processing logic continues to perform the operations in blocks to . If the rxIndex variable is not less than the rxLast variable then the diff signal values from all RX electrodes along the current TX electrode have been processed and the processing logic continues to perform the operations in block which compute the slope parameter value a for the current TX electrode .

In block the processing logic determines whether the diff signal value for the current RX electrode is to be included in the computation of the slope parameter value a for the current TX electrode. For example if the diff signal value for the current RX electrode is greater than 0 and less than the tail effect threshold the processing logic includes this diff signal value in the computation. It is noted that this diff signal value is actually the diff signal value for the current sensor element that is formed by the current RX electrode as indicated by the rxIndex variable and the current TX electrode as indicated by the txIndex variable . To make the determination the processing logic may perform the following operation which is a boolean operation with comparison operation operands Signal 0 and Signal

In block the processing logic determines the sum of the diff signal values of the sensor elements that are included in the computation of the slope parameter value a for the current TX electrode. For example the processing logic adds the diff signal value of the current sensor element which is formed by the current RX electrode indicated by the rxIndex variable and the current TX electrode indicated by the txIndex variable to the current running sum of diff signal values that have been processed so far for the current TX electrode. To perform the addition the processing logic may perform the following operation Sum Index Sum Index Signal where Sum txIndex is a variable that stores the running sum of diff signal values for the current TX electrode e.g. diff signal values for sensor elements formed by RX electrodes that have been processed so far for the current TX electrode and Signal is a variable that stores the diff signal value of the current sensor element that is being processed.

In block the processing logic determines the sum of the RX index values of the sensor elements that are included in the computation for the current TX electrode e.g. per equation 2 above. For example the processing logic adds the RX index value to the current running sum of the RX index values of the sensor elements formed along the current TX electrode that are included in computing the slope parameter value a for the current TX electrode. To perform the addition the processing logic may perform the following operation Num Num Index which adds the rxIndex variable to the snsNum variable thereby effectively adding the RX index value of the current electrode to the running sum of the RX index values of the sensor elements that have been processed so far for the current TX electrode.

In block the processing logic sets the RX index value of the next RX electrode that needs to be processed and continues to perform the operation in block . For example the processing logic performs the operation Index which adds 1 to the rxIndex variable in order to indicate that the next RX electrode now becomes the current RX electrode for processing thereafter the processing logic continues with the operation in block .

After the diff signal values from all RX electrodes along the current TX electrode have been processed in block the processing logic determines that the current rxIndex variable is not less than the rxLast variable. Thus the processing logic continues with the operations in block .

In block the processing logic computes the slope parameter value a for the current TX electrode and stores the value of this parameter in association with the current TX electrode. For example the processing logic performs the operation Coef Index Sum Index Num where Coef txIndex is a variable that stores the slope parameter value a for the current TX electrode Sum txIndex is the variable that stores the sum of the diff signal values for the sensor elements along the current TX electrode that are used to correct the tail effect and snsNum is the variable that stores the sum of the RX index values of the sensor elements that that are used to correct the tail effect for the current TX electrode.

In block the processing logic sets the TX index value of the next TX electrode that needs to be processed and continues to perform the operation in block . For example the processing logic performs the operation Index which adds 1 to the txIndex variable in order to indicate that the next TX electrode now becomes the current TX electrode for processing thereafter the processing logic continues with the operation in block .

After the diff signal values for all TX electrodes have been processed in block the processing logic determines that the current txIndex variable is not less than the txLast variable. Thus the processing logic continues with the operations in block .

In block the processing logic determines the adjustment values corresponding to the tail effect for the sensor elements on each TX electrode and then corrects the diff signal values for these sensor elements on each TX electrode by subtracting from each such diff signal value its respective adjustment value. Two example methods for adjusting the diff signal values of sensor elements for tail effect are described below with respect to .

In block the processing logic uses the tail effect corrected signal values to perform a localMax search and to calculate the location position of the conductive object on the sensor array. For example in some embodiments the processing logic may search a data structure that stores the tail effect corrected signal values for single local maximums that are over a certain local max threshold where a single local maximum is a signal value that is larger than the signal values surrounding it in the data structure. The processing logic may compare each signal value to each of its neighbors and may decide that a given signal value is a local maximum when none of its neighbors have a higher value. Thereafter the processing logic uses e.g. in a centroid location algorithm the information about the found local maximums in order to calculate the contact position e.g. such as touch coordinates and or location centroid of the conductive object on the sensor array.

In some embodiments the tail effect correction may be needed only in the phase that calculates the location position of the conductive object on the sensor array. Thus after position calculation is completed in these embodiments the processing logic may perform the operations in block to reverse the tail effect correction for each TX electrode. For example in these embodiments the processing logic may perform the computations described for equation 4 above in order to restore in the corresponding data structure the original diff signal values that were received obtained as part of the scan operation in block . Such tail effect reversion will ensure that any subsequent downstream processing based on the data stored in the data structure is performed correctly.

In some embodiments in block the processing logic may optionally update the baseline values that are stored for the sensor elements of the sensor array. Typically such baseline values are stored in firmware and are periodically maintained in order to ensure accurate operation of the sensor array. For example since the conditions e.g. temperature humidity etc. in which a device operates may change at least some scan operations may be configured to periodically compute and apply corrections to the stored baseline values.

After reversing the tail effect correction and or updating the baseline values the processing logic proceeds back to block and continues with processing the next scan operation.

At block the slope parameter or coefficient values a for the TX electrodes of the sensor array have already been computed and stored in association with their corresponding TX electrodes. For example as part of any given scan operation the processing logic may maintain in memory or on firmware storage an array that stores the parameter values that are computed e.g. per blocks of for the TX electrodes of the sensor array.

Referring to in block the processing logic performs an operation that initializes to zero a variable txIndex which denotes the TX index value of the current TX electrode for which computations are being performed.

In block the processing logic determines whether there are any remaining TX electrodes which need to be processed. For example the processing logic performs a comparison operation to compare the value stored in the txIndex variable to a variable or constant txLast which denotes the total number of TX electrodes that need to be processed for tail effect adjustment e.g. such as the total number of TX electrodes in the sensor array . If the txIndex variable is less than the txLast variable then at least the current TX electrode still needs to be processed and the processing logic continues to perform the operations in blocks A to . If the txIndex variable is not less than the txLast variable then the diff signal values for the sensor elements of all TX electrodes have been processed and the processing logic proceeds with the operations in block .

In block A the processing logic performs an operation that initializes to zero a variable rxIndex which denotes the RX index value of the current RX electrode along the current TX electrode for which computations are being performed.

In block the processing logic determines whether there are any remaining RX electrodes that need to be processed for the current TX electrode. For example the processing logic performs a comparison operation to compare the value stored in the rxIndex variable to a variable or constant rxLast which denotes the total number of RX electrodes that need to be processed for the current TX electrode. If the rxIndex variable is less than the rxLast variable then at least the current RX electrode still needs to be processed and the processing logic continues to perform the operations in blocks and . If the rxIndex variable is not less than the rxLast variable then the diff signal values from the RX electrodes along the current TX electrode have been processed and the processing logic continues to perform the operation in block which sets the next TX electrode for processing .

In block the processing logic adjusts the diff signal value of the current sensor element which is formed by the current RX electrode indicated by the rxIndex variable and the current TX electrode indicated by the txIndex variable for tail effect. For example the processing logic may perform the following operation Signal Signal Coef Index Index where Signal is a variable that stores the diff signal value of the current sensor element as adjusted for tail effect Signal is a variable that stores the measured obtained diff signal value of the current sensor element that is being processed and Coef txIndex is a variable that stores the slope parameter value a that has been computed and stored for the current TX electrode. It is noted that the value i.e. multiplication product Coef txIndex rxIndex represents the adjustment value that corrects the tail effect for the current sensor element.

In block the processing logic sets the RX index value of the next RX electrode that needs to be processed and continues with the operation in block . For example the processing logic performs the operation Index which adds 1 to the rxIndex variable in order to indicate that the next RX electrode now becomes the current RX electrode for processing thereafter the processing logic continues with the operation in block .

After the diff signal values from all RX electrodes along the current TX electrode have been processed in block the processing logic determines that the current rxIndex variable is not less than the rxLast variable. Thus the processing logic continues with the operations in block .

In block the processing logic sets the TX index value of the next TX electrode that needs to be processed and continues with the operation in block . For example the processing logic performs the operation Index which adds 1 to the txIndex variable in order to indicate that the next TX electrode now becomes the current TX electrode for processing thereafter the processing logic continues with the operation in block .

After the diff signal values for the sensor elements of all TX electrodes have been adjusted in the above manner in block the processing logic determines that the current txIndex variable is not less than the txLast variable. Thus the processing logic continues with the operations in block .

In block the processing logic performs the operations described for block in e.g. such as using the tail effect corrected signal values to calculate the location position of the conductive object on the sensor array .

In some embodiments the techniques for correcting tail effect described herein may provide for avoiding some of the downsides that may be caused by signal disparity in some operational situations.

For example in the case of poor grounding the signal under a large conductive object e.g. such as a fat finger may have a dip that makes sort of a donut contact area. When detected on a sensor array such donut shaped contact may cause some interior sensor elements to be considered as having a tail effect e.g. as having diff signal values below the tail effect threshold while in fact they are under the contact. In other words these diff signal values can be low enough to be under the tail effect threshold that is used in the best fit linear approximation. Thus when the tail effect correction is applied as described heretofore the dip donut hole in the signal values caused by the large conductive object will become larger and may increase the likelihood of contact area separation due to the subtraction of tail effect adjustments from already low diff signal values. However such contact area separation is generally undesirable since it may cause the detection and position calculation of two separate contacts instead of the actual single contact by the large conductive object e.g. such as the fat finger .

To address this downside in some embodiments the techniques described herein provide for correcting the tail effect of only those sensor elements that are downstream from the sensor element having the maximum RX index value. It is noted that in this context downstream refers to the direction away from the sensor array edge from which the RX electrodes are routed. 

The operations in the blocks of are described hereinafter as being performed by a processing logic e.g. such as processing logic in . It is noted however that various implementations and embodiments may use different and possibly multiple components to perform the method of . Thus the description hereinafter of the method in as being performed by a processing logic is to be regarded in an illustrative rather than a restrictive sense.

At block the slope parameter or coefficient values a for the TX electrodes of the sensor array have already been computed and stored in association with their corresponding TX electrodes. In block the processing logic performs an operation that initializes to zero the txIndex variable that denotes the TX index value of the current TX electrode. In block the processing logic determines whether there are any remaining TX electrodes which need to be processed. For example if the txIndex variable is less than the txLast variable then at least the current TX electrode still needs to be processed and the processing logic continues to perform the operations in blocks B to . If the txIndex variable is not less than the txLast variable then the diff signal values for the sensor elements of all TX electrodes have been processed and the processing logic proceeds with the operations in block .

In block B the processing logic selects for tail effect adjustment only those sensor elements whose RX electrodes are downstream from the RX electrode that detected the maximum diff signal value as part of the scan operation being processed. For example the processing logic initializes the rxIndex variable to a value that is higher than the value of a variable rxMax which denotes the RX index value of the RX electrode that detected the highest diff signal value along the current TX electrode. To perform this initialization the processing logic may perform the following operation Index Max 1 For the purposes of the above operation the rxMax variable for each TX electrode can be found and saved in association therewith during the linear approximation coefficient calculation e.g. as part of the operations in blocks to in . By setting the rxIndex variable in this manner the techniques described herein provide that diff signal values will be corrected only for those sensor elements whose RX index values are outside of the rxMax index values for all TX electrodes. If the sensor array is double routed then the operations in block B can be applied separately for each side of the sensor array from which RX electrodes are routed.

In block the processing logic determines whether there are any remaining RX electrodes that need to be processed for the current TX electrode. For example if the rxIndex variable is less than the rxLast variable then at least the current RX electrode still needs to be processed and the processing logic continues to perform the operations in blocks and . If the rxIndex variable is not less than the rxLast variable then the diff signal values from the RX electrodes along the current TX electrode have been processed and the processing logic continues to perform the operation in block which sets the next TX electrode for processing .

In block the processing logic adjusts the diff signal value of the current sensor element which is formed by the current RX electrode indicated by the rxIndex variable and the current TX electrode indicated by the txIndex variable for tail effect. For example the processing logic may perform the following operation Signal Signal Coef Index Index It is noted that the value i.e. multiplication product Coef txIndex rxIndex represents the adjustment value that corrects the tail effect for the current sensor element.

In block the processing logic sets the RX index value of the next RX electrode that needs to be processed and continues with the operation in block . After the diff signal values from the selected RX electrodes along the current TX electrode have been processed in block the processing logic determines that the current rxIndex variable is not less than the rxLast variable. Thus the processing logic continues with the operations in block . In block the processing logic sets the TX index value of the next TX electrode that needs to be processed and continues with the operation in block . After the diff signal values for the sensor elements of all TX electrodes have been adjusted in the above manner in block the processing logic determines that the current txIndex variable is not less than the txLast variable. Thus the processing logic continues with the operations in block . In block the processing logic performs the operations described for block in e.g. such as the operations that use the tail effect corrected signal values to calculate the location position of the conductive object on the sensor array .

In some embodiments a simple e.g. faster implementation of the techniques described herein may involve the computation of slope parameter values only for those TX electrodes that are in the middle of the contact area and the adjustment for tail effect of only those sensor elements that are formed by those TX electrodes. In these embodiments the methods for correcting tail effect would be similar to the methods illustrated in except that instead of looping through all of the TX electrodes these methods would provide for operations that select only a subset of the TX electrodes e.g. such as the subset including only those TX electrodes that are in the middle of the contact area .

In some embodiments the techniques for correcting tail effect described herein may be used not only for mutual capacitance sensor arrays but also for sensor arrays that have self capacitance designs. Such application of the techniques described herein would be possible for self capacitance sensor arrays because they also provide multiple sensors that can be activated and that can produce a signal profile that can be analyzed. Further the techniques described herein are not tied to capacitive sensing applications only but can be used with other sensing technologies e.g. to remove shadows in optical sensing applications and for any other types of designs that provide an array of sensor elements that can receive a parasitic signal coupling with linear profile.

Various embodiments of the techniques for correcting tail effect described herein may include various operations. These operations may be performed by hardware components software firmware or a combination thereof. As used herein the term coupled to may mean coupled directly or indirectly through one or more intervening components. Any of the signals provided over various buses described herein may be time multiplexed with other signals and provided over one or more common buses. Additionally the interconnection between circuit components or blocks may be shown as buses or as single signal lines. Each of the buses may alternatively be one or more single signal lines and each of the single signal lines may alternatively be buses.

Certain embodiments may be implemented as a computer program product that may include instructions stored on a non transitory computer readable medium e.g. such as volatile storage and or non volatile storage. These instructions may be used to program one or more devices that include one or more general purpose or special purpose processors e.g. such as Central Processing Units or CPUs or equivalents thereof e.g. such as processing cores processing engines microcontrollers and the like so that when executed by the processor s or the equivalents thereof the instructions cause the device s to perform the described operations for correcting tail effect described herein. A computer readable medium may also include one or more mechanisms for storing or transmitting information in a form e.g. software processing application that is readable by a machine e.g. such as a device or a computer . The non transitory computer readable storage medium may include but is not limited to electromagnetic storage medium e.g. floppy disks hard disks and the like optical storage medium e.g. CD ROM magneto optical storage medium read only memory ROM random access memory RAM erasable programmable memory e.g. EPROM and EEPROM flash memory or another now known or later developed type of medium that is suitable for storing information.

Although the operations of the method s herein are shown and described in a particular order the order of the operations of each method may be altered so that certain operations may be performed in an inverse order or so that certain operation may be performed at least in part concurrently with other operations. In other embodiments instructions or sub operations of distinct operations may be in an intermittent and or alternating manner.

In the foregoing specification the invention has been described with reference to specific exemplary embodiments thereof. It will however be evident that various modifications and changes may be made thereto without departing from the broader spirit and scope of the invention as set forth in the appended claims. The specification and drawings are accordingly to be regarded in an illustrative sense rather than a restrictive sense.

