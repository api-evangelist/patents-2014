---

title: Methods and apparatus for enforcing a common user policy within a network
abstract: In some embodiments, an apparatus includes a core network node configured to be operatively coupled to a set of wired network nodes and a set of wireless network nodes. The core network node is configured to receive, at a first time, a first data packet to be sent to a wired device operatively coupled to a wired network node from the set of wired network nodes. The core network node is configured to also receive, at a second time, a second data packet to be sent to a wireless device operatively coupled to a wireless network node from the set of wireless network nodes. The core network node is configured to apply a common policy to the first data packet and the second data packet based on an identifier of a user associated with both the wireless device and the wired device.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09374835&OS=09374835&RS=09374835
owner: Juniper Networks, Inc.
number: 09374835
owner_city: Sunnyvale
owner_country: US
publication_date: 20140807
---
This application is a continuation of U.S. patent application Ser. No. 13 252 856 filed Oct. 4 2011 entitled Methods and Apparatus for Enforcing a Common User Policy within a Network which is related to co pending U.S. patent application Ser. No. 13 252 852 filed Oct. 4 2011 and entitled Methods and Apparatus for a Converged Wired Wireless Enterprise Network Architecture U.S. patent application Ser. No. 13 252 860 filed Oct. 4 2011 and entitled Methods and Apparatus for Centralized Management of Access and Aggregation network Infrastructure U.S. patent application Ser. No. 13 252 857 filed Oct. 4 2011 and entitled Methods and Apparatus for a Scalable Network with Efficient Link Utilization U.S. patent application Ser. No. 13 252 854 filed Oct. 4 2011 and entitled Methods and Apparatus for a Self organized Layer 2 Enterprise Network Architecture each of which is incorporated herein by reference in its entirety.

Some embodiments described herein relate generally to enterprise networks and in particular to methods and apparatus for enforcing a common user policy within an enterprise network architecture.

Some known enterprise networks use different types of authentication to provide access to data resources for a user depending on the location of the user the type of the client device and the access method of the user. In such a known enterprise network policy management and enforcement is typically done in a distributed fashion such that user specific access controls are spread throughout multiple layers of the network. As a result user policies are configured independently at individual network elements across multiple layers of the network without much co ordination. Such a distributed method of enforcing user policies however typically requires each individual network element to be manually configured in accordance with its physical connectivity to other elements in the network which makes the work of a network administrator difficult and cumbersome. Moreover user policy configuration and enforcement is typically implemented separately in the wireless portion and the wired portion of such an enterprise network which adds another level of complexity to the job of the network administrator.

Accordingly a need exists for an enterprise network that allows for a common policy infrastructure to provide access to information and services independent of a user s location access method and client device being used such that user policies can be configured at a central point of the network.

In some embodiments an apparatus includes a core network node configured to be operatively coupled to a set of wired network nodes and a set of wireless network nodes. The core network node is configured to receive at a first time a first data packet to be sent to a wired device operatively coupled to a wired network node from the set of wired network nodes. The core network node is configured to also receive at a second time a second data packet to be sent to a wireless device operatively coupled to a wireless network node from the set of wireless network nodes. Such a wireless network node can be for example coupled to a wired network node from the set of wired network nodes. The core network node is configured to apply a common policy to the first data packet and the second data packet based on an identifier of a user associated with both the wireless device and the wired device.

In some embodiments an enterprise network includes a core network node operatively coupled to a set of wired network nodes and a set of wireless network nodes. In some embodiments a wired network node can be an access network node or an aggregation network node. In response to a user being operatively coupled to a first wired network node from the set of wired network nodes using a wired device operatively coupled to the first wired network node the core network node is configured to send an up link policy associated with the user to the first wired network node. Later the core network node is configured to receive a first data packet to be sent to the wired device and then apply a common policy to the first data packet based on an identifier of the user associated with the wired device. In some embodiments the common policy can be a down link policy. Furthermore in response to receiving the first data packet the core network node can be configured to send the first data packet to the first wired network node via a multiprotocol label switching MPLS tunnel through a second wired network node from the set of wired network nodes where the second wired network node does not store the common policy. In some embodiments the second wired network node is an aggregation network node from the set of wired network nodes. After the user is disconnected from the first wired network node the core network node is configured to send an instruction to remove the up link policy from the first wired network node.

Similarly in response to the user being operatively coupled to a wireless network node from the set of wireless network nodes using a wireless device operatively coupled to the wireless network node the core network node is configured to send the up link policy associated with the user to the wireless network node. Later the core network node is configured to receive a second data packet to be sent to the wireless device and then apply the common policy to the second data packet based on the identifier of the user associated with the wireless device. In some embodiments the common policy is a down link policy. In some embodiments the core network node includes a policy database that associates the common policy with the identifier of the user. In some embodiments the wireless device and the wired device are a single device. In some other embodiments the wireless device and the wired device are distinct devices.

In some embodiments an enterprise network includes a wired network node and a wireless network node. The wired network node is configured to receive from a core network node of the enterprise network a policy associated with a user based on the user being associated with a wired device operatively coupled to the wired network node when the user is associated with the wired device. In some embodiments the wired network node is configured to receive the policy from the core network node via a MPLS tunnel through an aggregation network node operatively coupled to the wired network node. In some embodiments the received policy is stored in a policy database included in the wired network node where the policy database associates the policy with an identifier of the wired device when the user is associated with the wired device. In some embodiments the policy is an up link policy and the wired network node is configured to apply the policy to a first data packet received from the wired device prior to sending the first data packet to the core network node. Later the core network node is configured to apply a down link policy associated with the user to a second data packet before sending the second data packet to the wired network node. A predetermined amount of time after the user is disassociated with the wired device or the wired device is operatively decoupled from the wired network node the wired network node is configured to remove the policy from the policy database at the wired network node.

Similarly in response to a user being operatively coupled to the wireless network node using a wireless device operatively coupled to the wireless network node the wireless network node is configured to send an initiation signal to the core network node. As a result the wireless network node is configured to receive from the core network node the policy associated with the user based on the user being associated with the wireless device. The wireless network node is further configured to apply the policy to a third data packet received from the wireless device prior to sending the third data packet to the core network node.

A core network node e.g. core network node core network node can be a high capacity switching device positioned in the physical core or backbone of an enterprise network e.g. the overlay enterprise network . In some cases a core network node is known as a core switch a tandem switch or a backbone switch. In the overlay enterprise network core network node and core network node are configured to connect the access devices e.g. access network node access point and WLAN controller with network such that access to information services e.g. persistent data and applications located at network can be provided to users that are coupled to the overlay enterprise network via wired or wireless devices e.g. wired device wired device wireless device . Specifically core network node and core network node operatively connect aggregation network node and aggregation network node with network and forward packets of wired and or wireless sessions between aggregation network node aggregation network node and network based on IP routing services. In other words core network node and core network node act as a router working in layer 3 i.e. network layer of the OSI open systems interconnection model for the overlay enterprise network . In the overlay enterprise network core network node and core network node are configured to manage wired sessions only including enforcing user policies for users of wired sessions only. On the other hand wireless sessions are managed by WLAN controller including enforcing user policies for users of wireless sessions.

Shown in network can be any network that is directly connected to the overlay enterprise network through one or more core network nodes. For example network can be a data center network including one or more data servers that provide information services. For another example network can be a WAN wide area network access network that is used to connect the overlay enterprise network to remote data resources. For yet another example network can be the Internet. Typically the overlay enterprise network acts as an access network providing for wired or wireless clients access to data resources applications and information services that are located at or provided from network .

In the overlay enterprise network the access network nodes e.g. access network node can be any device that can directly connect one or more wired devices e.g. wired device wired device to the overlay enterprise network such as a hub an Ethernet switch etc. In some cases an access network node is known as an access switch a network switch or a switching hub. Furthermore as described in detail herein access network node is configured to ensure packets are delivered between one or more aggregation network nodes one or more wired devices and or one or more access points that are coupled to the access network nodes. In the overlay enterprise network a wired device can be any device that can receive packets from and or send packets to an access network node through a wired connection such as a desktop computer a workstation a printer etc.

In the overlay enterprise network the aggregation network nodes e.g. aggregation network node can be any switching device that is used to aggregate multiple access network nodes and ensure packets are properly routed within the network such as a router a layer 3 switch etc. Furthermore as described in detail herein aggregation network node is configured to route packets received from one or more access network nodes to another access network node or a core network node based on the routing information provided in the packet and the routing policy implemented at aggregation network node . In some scenarios a collection of aggregation network nodes and associated access devices e.g. access network nodes access points having a common connection to a redundant set of core network nodes are referred to as a pod. As shown in aggregation network node with their associated access network node and access point comprise a pod.

In the overlay enterprise network core network node aggregation network node and access network node are configured collectively to manage and forward wired traffic for one or more wired devices that are operatively coupled to one or more access network nodes. Wired network nodes including access network nodes and aggregation network nodes are configured to switch or route packets of a wired session that are received from a wired device to another wired network node or a core network node based on a destination address e.g. a destination IP address a destination MAC address included in the packets. More specifically some wired traffic that is received at an aggregation network node from an access network node may be switched to another access network node from the aggregation network node if the traffic is destined to a destination device within the same pod. In contrast the wired traffic destined to a destination device located in another pod is forwarded to a core network node from which the traffic is forwarded into the other pod. For example if wired device sends a packet to access network node destined to wired device the packet can be first forwarded by access network node to aggregation network node . Then based on the destination IP address or MAC address included in the packet the packet is further forwarded by aggregation network node to access network node which finally sends the packet to wired device . For another example if wired device sends a packet to access network node destined to a device located in network the packet can be first forwarded by access network node to aggregation network node . Then based on the destination IP address or MAC address included in the packet the packet is further forwarded by aggregation network node to core network node which sends the packet into network for further routing.

In the overlay enterprise network wireless equipment including WLAN controller and access points forward wireless traffic that is received from one or more wireless devices e.g. wireless device . Specifically WLAN controller can be any device that can automatically handle the configuration of multiple access points and act as a centralized controller configured to manage wireless sessions in an overlay of the wired network portion of the overlay enterprise network . An access point can be any device that connects a wireless device to a wired network e.g. via an access network node as shown in using for example Wi Fi Bluetooth or other wireless communication standards. In some cases an access point can be located on the same device together with an access network node such as a wireless Ethernet router equipped with a wireless transceiver. In some other cases an access point can be a stand alone device such as a wireless access point WAP . Similar to a wired device a wireless device can be any device that can receive packets from and or send packets to an access point through a wireless connection such as for example a mobile phone a Wi Fi enabled laptop a Bluetooth earphone etc.

In the overlay enterprise network WLAN controller and access points are configured collectively to manage and forward wireless traffic through intervening wired network nodes and core network nodes. Specifically WLAN controller is configured to receive encapsulated packets of a wireless session from access point or access point via a layer 3 tunnel through intervening wired network nodes and core network nodes decapsulate the packets and then bridge the decapsulated packets to core network node or core network node from which the decapsulated packets are further forwarded to the destination. Similarly WLAN controller is configured to receive packets of the wireless session from core network node or core network node destined to access point or access point encapsulate the packets according to a layer 3 tunneling protocol and then send the encapsulated packets to access point or access point via a layer 3 tunnel through intervening wired network nodes and core network nodes where the encapsulated packets are decapsulated and forwarded to a wireless device. In some cases a layer 3 tunnel can be an Ethernet over layer 3 tunnel such as a CAPWAP control and provisioning of wireless access points tunnel a GRE generic routing encapsulation tunnel etc.

In the wired portion of the overlay enterprise network the core network nodes and the wired network nodes including the access network nodes and the aggregation network nodes are configured to enforce user policies for users accessing the overlay enterprise network through one or more wired devices that are operatively coupled to one or more access network nodes. Specifically access control policies e.g. to network resources to specific IP addresses for users accessing the overlay enterprise network through wired devices are individually maintained configured and enforced at core network nodes and or one or more wired network nodes of the overlay enterprise network depending on the network configuration. In some cases policy management and enforcement for the wired portion of the overlay enterprise network is done in a distributed fashion without much co ordination among the core network nodes and the wired network nodes. For example an access control policy that controls a user transferring files from wired device to a computer device in network can be configured and enforced at access network node . For another example another access control policy that restricts a user downloading video contents from a server in network to wired device can be configured and enforced at aggregation network node and aggregation network node .

On the other hand in the wireless portion of the overlay enterprise network the WLAN controller is configured to solely enforce user policies for users accessing the overlay enterprise network through one or more wireless devices e.g. wireless device that are operatively coupled to one or more wireless network nodes e.g. access point access point . Specifically access control policies for users accessing the overlay enterprise network through wireless devices are maintained configured and enforced at WLAN controller . In other words policy management and enforcement for the wireless portion of the overlay enterprise network is done in a centralized fashion at WLAN controller as all wireless traffic goes through WLAN controller before it is forwarded to the destination. For example access policies that control a user sending data packets from wireless device to a computer device in network and receiving data packets at wireless device from that computer device in network are both configured and enforced at WLAN controller .

As a result of lacking a centralized common policy infrastructure in the overlay enterprise network different user policies may be applied to provide access control to data resources for a user depending on the location of the user and or the access method of the user. For example access control policies can be enforced separately at WLAN controller and aggregation network node such that packets of a wireless session from a device in network destined to a user using wireless device cannot be forwarded by WLAN controller while packets of a wired session from the same device in network destined to the same user using wired device can be forwarded by aggregation network node . Thus the user cannot receive wireless traffic from that device in network via wireless device which is operatively coupled to access point but can receive wired traffic from the same device in network via wired device which is operatively coupled to access network node .

For another example access control policies can be enforced separately at access network node and access network node such that packets destined to a specific IP address in network that are received at access network node e.g. from wired device from a user cannot be forwarded by access network node while packets destined to the same IP address that are received at access network node e.g. from wired device from the same user can be forwarded by access network node . Thus the user can send packets to an entity associated with that specific IP address in network via wired device which is operatively coupled to access network node but cannot send packets to the entity associated with the same IP address via wired device which is operatively coupled to access network node .

In an enterprise network if every network device included in the enterprise network or a portion of the enterprise network can be controlled by one or more core network nodes then that enterprise network can be referred to as a homogeneous enterprise network or that portion of the enterprise network can be referred to as a homogeneous portion of the enterprise network. In such a homogeneous network or portion of the network it is possible to use MPLS tunneling technology to tunnel traffic e.g. wired or wireless traffic . If not every network node included in a portion of the enterprise network can be controlled by one or more core network nodes then that portion of the enterprise network is referred to as an overlay enterprise network portion. In some embodiments one or more network devices included in a homogeneous portion or an overlay enterprise network portion of an enterprise network can tunnel traffic using a layer 3 tunneling technology e.g. CAPWAP Ethernet in GRE . MPLS tunneling technology can be used only in the homogeneous portion. Furthermore in a homogeneous enterprise network or a homogeneous portion of an enterprise network a common tunneling technology e.g. MPLS a layer 3 tunneling technology can be used to forward both the wired traffic and the wireless traffic. More detail related to the tunneling technologies used to forward wired and or wireless traffic in an enterprise network is set forth in co pending U.S. patent application Ser. No. 13 252 852 filed Oct. 4 2011 entitled Methods and Apparatus for a Converged Wired Wireless Enterprise Network Architecture which is incorporated herein by reference in its entirety.

A core network node in a homogeneous enterprise network e.g. core network node or core network node in the homogeneous enterprise network can be for example upgraded from a core network node in an overlay enterprise network e.g. core network node or core network node in the overlay enterprise network . In such an upgrade the core network node in a homogeneous enterprise network e.g. core network node core network node is a single device that combines a switch a router and a controller which includes a control module e.g. control module for core network node as shown in configured to manage wired wireless network nodes and or wired wireless user sessions. In other words core network node is a consolidation of at least a WLAN controller e.g. WLAN controller and a core network node from an overlay enterprise network. On one hand similar to a core network node from an overlay enterprise network core network node is still able to forward packets of wired sessions between an aggregation network node and a network that is operatively coupled to core network node . On the other hand unlike a core network node within an overlay enterprise network core network node can establish a wired session with an access network node or establish a wireless session with an access point through intervening wired network nodes via a tunnel e.g. a MPLS tunnel a layer 3 tunnel . In some embodiments a core network node in a homogeneous enterprise network is referred to as a core SRC switch router and controller .

Similar to core network nodes all other devices in the homogeneous enterprise network including aggregation network node access network node and access point can be configured to operate in a homogeneous enterprise network. Specifically the functionality of access network node and aggregation network node includes multiplexing client traffic including packets of wired and wireless sessions to core network node or core network node without any need for local switching or complex forwarding and classification functionality. For example unlike aggregation network nodes in the overlay enterprise network aggregation network node does not need to be configured to switch or route a packet received from access network node to another access network node based on a destination address included in the packet. Instead aggregation network node can be configured to forward the packet through a portion of a tunnel between access network node and core network node shown as the tunnel represented by in to core network node from which the packet is further switched or routed to the destination. Similarly stated access network nodes are configured to transmit wired traffic to core network node or core network node via a tunnel e.g. the tunnel represented by in through intervening aggregation network nodes . Access points are configured to transmit wireless traffic to core network node or core network node via a tunnel e.g. a tunnel represented by in through intervening access network nodes and aggregation network nodes.

In an enterprise network the tunneling technology applied between a core network node and an access device e.g. an access network node an access point depends on the nature and or capabilities of the core network node the access device and the intermediate network device s e.g. aggregation network node present between the core network node and the access device. Particularly in a homogeneous enterprise network e.g. homogeneous enterprise network a tunneling protocol such as MPLS or a layer 3 tunneling protocol can be used to forward the wired traffic and or the wireless traffic.

For example if wireless device sends a packet to access point destined to wired device the packet is first encapsulated according to MPLS or a layer 3 tunneling protocol e.g. CAPWAP Ethernet in GRE at access point and then transmitted to core network node via a MPLS tunnel or a layer 3 tunnel through access network node and aggregation network node shown as the tunnel represented by in . Next the encapsulated packet is decapsulated according to MPLS or the layer 3 tunneling protocol at core network node . Then based on a destination IP address or a destination MAC address included in the packet the packet is encapsulated again according to MPLS or a layer 3 tunneling protocol at core network node and the encapsulated packet is forwarded by core network node to access network node via another MPLS tunnel or another layer 3 tunnel through aggregation network node shown as the tunnel represented by in . Finally the encapsulated packet is decapsulated according to MPLS or the layer 3 tunneling protocol at access network node from which the decapsulated packet is delivered to wired device .

For another example if wired device sends a packet to access network node destined to an IP address located in network the packet is first encapsulated according to MPLS or a layer 3 tunneling protocol at access network node and then transmitted to core network node via a MPLS tunnel or a layer 3 tunnel through aggregation network node shown as the tunnel represented by in . Next the encapsulated packet is decapsulated according to MPLS or the layer 3 tunneling protocol at core network node . Finally based on a destination IP address included in the packet the decapsulated packet is forwarded by core network node to network and further delivered to the destination entity associated with the destination IP address in network .

In the homogeneous enterprise network unlike in the overlay enterprise network wired network nodes and wireless network nodes are no longer individually configured and managed. In particular the access control policy for a given user e.g. to network resources to specific IP addresses is no longer individually maintained configured and enforced at each aggregation network node access network node access point or a WLAN controller. Instead a common user policy for a given user is maintained and configured at one or more core network nodes and applied automatically by the enterprise network at an access network node or an access point as needed depending on where and how the user connects to the network. More specifically down link policy enforcement can be centralized at core network nodes where for example a complete view of all user traffic is available for monitoring and policing. In contrast most up link policies can be downloaded to and enforced at access devices e.g. access network nodes access points to avoid wasting bandwidth in the enterprise network. Particularly the access device is an access network node if the user accesses the homogeneous enterprise network through a wired device and the access device is an access point if the user accesses the homogeneous enterprise network through a wireless device.

For example as shown in a common user policy for a user is maintained and configured at core network nodes of the homogeneous enterprise network . Specifically down link policies for all users that are connected or potentially connected to the homogeneous enterprise network including users accessing through wireless device and wired device are maintained in a policy table stored in core network node and or core network node and enforced at the core network nodes. On the other hand up link policies for users accessing the homogeneous enterprise network through wireless device and wired device are downloaded to and enforced at access point and access network node respectively after the users are connected to the access devices. Further details on down link policies up link policies and policy tables are described with respect to .

In some embodiments maintaining and configuring a common user policy at one or more core network nodes of a homogeneous enterprise network enables a user policy including an up link policy and a down link policy to be enforced solely dependent on the user regardless of the access method e.g. via a wired connection via a wireless connection adopted by the user. In other words the same user policy is applied to a user when the user accesses the homogeneous enterprise network through different access devices e.g. an access point an access network node and or via different types of connections e.g. a wired connection a wireless connection . In some embodiments a user can be identified by a homogeneous enterprise network using a unique combination of a user ID and a password. For example as shown in a user using wireless device accesses access point by providing a combination of a user ID and a password and then is engaged in a wireless session at a first time. As a result an up link policy for the user is applied at access point and a down link policy for the user is applied at core network node . Note that access network node and aggregation network node need not have the up link policy for the user because access point tunnels through access network node and aggregation network node to reach core network node . At a second time the same user using wired device accesses access network node by providing the same combination of the user ID and the password and then is engaged in a wired session. As a result again the same up link policy for the user is applied at access network node and the same down link policy for the user is applied at core network node . Note that aggregation network node need not have the up link policy for the user because access network node tunnels through aggregation network node to reach core network node .

In some embodiments a common user policy can be enforced solely dependent on the user communication device e.g. a wired device a wireless device used by a user regardless of the access method adopted by the user. In other words the same user policy can be applied to a user communication device when the user communication device is connected to the homogeneous enterprise network through different access devices and or via different types of connections. In some embodiments a user communication device can be identified by a homogeneous enterprise network using a unique identifier associated with the user communication device such as a MAC address. For example as shown in a user communication device e.g. a Wi Fi enabled laptop is connected to access point and recognized by its MAC address and then is engaged in a wireless session at a first time. As a result an up link policy for the user communication device is applied at access point and a down link policy for the user communication device is applied at core network node . At a second time the same user communication device is connected to access network node and recognized by its MAC address again and then is engaged in a wired session. As a result again the same up link policy for the user communication device is applied at access network node and the same down link policy for the user communication device is applied at core network node .

In some embodiments a centralized core architecture can provide a single point of configuration and management for services within the enterprise network as well as a single logic node of interaction for visibility and monitoring applications. As a result various types of service modules can be aggregated and or consolidated at one or more core network nodes such as firewall intrusion detection policy IDP virtual private network VPN termination load balancing etc. In such a homogeneous enterprise network services no longer need to be distributed at various levels in the network and users can be given consistent policy that is independent of their access mechanism as described in detail above.

In some embodiments access point can communicate with a wireless device e.g. a Wi Fi enabled laptop a mobile phone using any suitable wireless communication standard such as for example Wi Fi Bluetooth and or the like. Specifically access point can be configured to receive data and or send data through RF transceiver when communicating with a wireless device. Furthermore in some embodiments an access point of an enterprise network uses one wireless communication standard to wirelessly communicate with a wireless device operatively coupled to the access point while another access point of the enterprise network uses a different wireless communication standard to wirelessly communicate with a wireless device operatively coupled to the other access point. For example as shown in access point can receive data packets through its RF transceiver from wireless device e.g. a Wi Fi enabled laptop based on the Wi Fi standard while access point can send data packets from its RF transceiver to another wireless device e.g. a Bluetooth enabled mobile phone not shown in based on the Bluetooth standard.

In some embodiments access point can be operatively coupled to an access network node by implementing a wired connection between communications interface and the counterpart e.g. a communications interface of the access network node. The wired connection can be for example twisted pair electrical signaling via electrical cables fiber optic signaling via fiber optic cables and or the like. As such access point can be configured to receive data and or send data through communications interface which is connected with the communications interface of an access network node when access point is communicating with the access network node. Furthermore in some embodiments an access point of an enterprise network implements a wired connection with an access network node operatively coupled to the access point while another access point of the enterprise network implements a different wired connection with an access network node operatively coupled to the other access point. For example as shown in access point can implement one wired connection such as twisted pair electrical signaling to connect with access network node while access point can implement a different wired connection such as fiber optic signaling to connect with access network node .

In some embodiments as described with respect to access point can be configured to prepare a packet e.g. a data packet a control packet received from a wireless device operatively coupled to access point and send the packet to another network device such as a core network node via a tunnel e.g. a layer 3 tunnel a MPLS tunnel . Access point can also be configured to decapsulate a packet received via a tunnel from another network device such as a core network node before forwarding the decapsulated packet to a wireless device operatively coupled to access point . Specifically upon receiving a packet from a wireless device operatively coupled to access point tunnel module is configured to encapsulate the packet e.g. add a header portion a footer portion and or modify any other identifiers included within the packet according to a predetermined tunneling protocol e.g. a layer 3 tunneling protocol MPLS . The encapsulated packet is then sent through communications interface to an access network node connected to access point from which the encapsulated packet is forwarded along the tunnel to a network device at the end of the tunnel. On the other hand upon receiving a packet from an access network node connected to access point that is sent through a tunnel from a network device tunnel module is configured to decapsulate the packet e.g. remove a header portion a footer portion and or modify any other identifiers included within the packet according to a predetermined tunneling protocol e.g. the layer 3 tunneling protocol MPLS . The decapsulated packet is then sent by RF transceiver to a wireless device operatively coupled to access point .

In some embodiments as described with respect to access point can be configured to receive and implement an up link policy for a user accessing a homogeneous enterprise network through a wireless device operatively coupled to access point . Specifically after a wireless device associated with a user is operatively coupled to access point access point can be configured to send an initiation signal to a core network node operatively coupled to access point notifying the core network node that the user is connected to access point via the wireless device. In response to the initiation signal received at the core network node an up link policy associated with the user is downloaded from the core network node to access point and stored in policy table in memory of access network node . Similar to transmitting data packets between the core network node and access point the up link policy can be sent from the core network node to access point via a MPLS tunnel or a layer 3 tunnel through one or more intervening wired network nodes such as an access network node and or an aggregation network node to which the core network node and access point are operatively coupled. Particularly the up link policy is not stored at any of the intervening wired network nodes. With the up link policy downloaded to policy table processor of access network node is configured to apply the up link policy stored in policy table to control forwarding packets received from the wireless device. Specifically processor is configured to forward packets received from the wireless device to the wired network node e.g. an access network node connected to access point if such a forwarding is allowed by the up link policy associated with the user or drop the packets if such a forwarding is denied by the up link policy associated with the user.

In some embodiments access point can be configured to remove an up link policy associated with a user from policy table after the user is disassociated with access point . A user can be disassociated with access point in various manners. For example a user is disassociated with access point when the user is disassociated with the wireless device operatively coupled to access point such as the user logs off from the wireless device. For another example a user is disassociated with access point after the wireless device associated with the user is operatively decoupled from access point . In some embodiments access point can be configured to automatically remove an up link policy associated with a user from policy table for example a predetermined amount of time after the user is disassociated with access point . In some other embodiments access point can be configured to remove an up link policy associated with a user from policy table based on an instruction signal received from a core network node operatively coupled to access point .

For example after a user is disassociated with access point access point can be configured to send a signal to the core network node from which access point downloaded the up link policy associated with the user indicating the disassociation of the user from access point . The core network node can then send an instruction signal to access point instructing access point to remove the up link policy associated with the user from its memory. For another example after a core network node can be notified by a different access device e.g. an access network node an access point that a user is operatively coupled to that access device the core network node can send an instruction to access point instructing access point to remove the up link policy associated with the user from its memory. In other words if the user is operatively coupled to a different access device then the user is no longer operatively coupled to access point . As a result of receiving an instruction signal from the core network node access point can be configured to remove the up link policy associated with the user from policy table in memory .

In some embodiments memory can be for example a random access memory RAM e.g. a dynamic RAM a static RAM a flash memory a removable memory and or so forth. In some embodiments data other than up link policies stored in policy table that is related to operations of access point can also be stored in other portion of memory . For example MAC addresses of potential user communication devices can be stored in memory such that a user communication device can be recognized by access point upon being operatively coupled to access point . For another example information associated with tunneling packets to a core network node can be stored in memory such that establishing a tunnel such as a MPLS tunnel or a layer 3 tunnel with the core network node can be initialized by access point .

In some embodiments communications interface of access network node includes at least two ports not shown in that can be used to implement one or more wired connections between access network node and one or more access points wired devices and or aggregation network nodes. The wired connection can be for example twisted pair electrical signaling via electrical cables fiber optic signaling via fiber optic cables and or the like. As such access network node can be configured to receive data and or send data through one or more ports of communications interface which are connected to the communications interfaces of one or more access points wired devices and or aggregation network nodes.

Furthermore in some embodiments access network node can implement a wired connection with one of an access point a wired device or an aggregation network node that is operatively coupled to access network node through one port of communications interface while implementing a different wired connection with another access point wired device or aggregation network node that is operatively coupled to access network node through another port of communications interface . For example as shown in access network node can implement one wired connection such as twisted pair electrical signaling to connect with access point while implementing a different wired connection such as fiber optic signaling to connect with aggregation network node .

In some embodiments as described with respect to and access network node can be one of the intervening wired network nodes between an access point and a core network node through which a tunnel e.g. a MPLS tunnel a layer 3 tunnel is established between the access point and the core network node. In such embodiments access network node can be configured to forward a tunneled packet e.g. a packet encapsulated according to a layer 3 tunneling protocol or MPLS which is received from one end of the tunnel and sent to the other end of the tunnel. For example as shown in access network node can forward a tunneled packet encapsulated according to a layer 3 tunneling protocol or MPLS which is received from access point to aggregation network node along the layer 3 tunnel or the MPLS tunnel shown as the tunnel represented by in between access point and core network node .

In some embodiments as described with respect to access network node can be configured to prepare a packet e.g. a data packet a control packet received from a wired device operatively coupled to access network node and send the packet to another network device such as a core network node via a layer 3 tunnel or a MPLS tunnel. Access network node can also be configured to decapsulate a packet received via a layer 3 tunnel or a MPLS tunnel from another network device such as a core network node before forwarding the decapsulated packet to a wired device operatively coupled to access network node . Specifically upon receiving a packet from a wired device operatively coupled to access network node tunnel module is configured to encapsulate the packet e.g. add a header portion a footer portion and or modify any other identifiers included within the packet according to a layer 3 tunneling protocol or MPLS. The encapsulated packet is then sent through a port of communications interface to an aggregation network node connected to access network node from which the encapsulated packet is forwarded along the layer 3 tunnel or the MPLS tunnel to a core network node. On the other hand upon receiving a packet from an aggregation network node connected to access network node that is sent through a layer 3 tunnel or a MPLS tunnel from a core network node tunnel module is configured to decapsulate the packet e.g. remove a header portion a footer portion and or modify any other identifiers included within the packet according to the layer 3 tunneling protocol or MPLS. The decapsulated packet is then sent through a port of communications interface to a wired device operatively coupled to access network node .

In some embodiments as described with respect to access network node can be configured to receive and implement an up link policy for a user accessing a homogeneous enterprise network via a wired device operatively coupled to access network node . Specifically after a wired device associated with a user is operatively coupled to access network node access network node can be configured to send an initiation signal to a core network node operatively coupled to access network node notifying the core network node that the user is connected to access network node via the wired device. In response to the initiation signal received at the core network node an up link policy associated with the user is downloaded from the core network node to access network node and stored in policy table in memory . Similar to transmitting data packets between the core network node and access network node the up link policy can be sent from the core network node to access network node via a layer 3 tunnel or a MPLS tunnel through one or more intervening wired network nodes such as an aggregation network node to which the core network node and access network node are operatively coupled. Particularly the up link policy is not stored in any of the intervening wired network nodes. With the up link policy downloaded to policy table processor of access network node is configured to apply the up link policy stored in policy table to control forwarding packets received from the wired device. Specifically processor is configured to forward packets received from the wired device to the wired network node e.g. an aggregation network node connected to access network node if such a forwarding is allowed by the up link policy associated with the user or drop the packets if such a forwarding is denied by the up link policy associated with the user.

In some embodiments access network node can be configured to remove an up link policy associated with a user from policy table after the user is disassociated with access network node . A user can be disassociated with access network node in various manners. For example a user is disassociated with access network node when the user is disassociated with the wired device operatively coupled to access network node such as the user logs off from the wired device. For another example a user is disassociated with access network node after the wired device associated with the user is operatively decoupled from access network node . In some embodiments access network node can be configured to automatically remove an up link policy associated with a user from policy table for example a predetermined amount of time after the user is disassociated with access network node . In some other embodiments access network node can be configured to remove an up link policy associated with a user from policy table based on an instruction signal received from a core network node operatively coupled to access network node .

For example after a user is disassociated with access network node access network node can be configured to send a signal to the core network node from which access network node downloaded the up link policy associated with the user indicating the disassociation of the user from access network node . The core network node can then send an instruction signal to access network node instructing access network node to remove the up link policy associated with the user from its memory. For another example after a core network node can be notified by a different access device e.g. an access network node an access point that a user is operatively coupled to that access device the core network node can send an instruction to access network node instructing access network node to remove the up link policy associated with the user from its memory. In other words if the user is operatively coupled to a different access device then the user is no longer operatively coupled to access network node . As a result of receiving an instruction signal from the core network node access network node can be configured to remove the up link policy associated with the user from policy table in memory .

In some embodiments memory can be for example a random access memory RAM e.g. a dynamic RAM a static RAM a flash memory a removable memory and or so forth. In some embodiments data other than up link policies stored in policy table that is related to operations of access network node can also be stored in other portion of memory . For example MAC addresses of potential user communication devices can be stored in memory such that a user communication device can be recognized by access network node upon being operatively coupled to access network node . For another example information associated with tunneling packets to a core network node can be stored in memory such that establishing a MPLS tunnel or a layer 3 tunnel with the core network node can be initialized by access network node .

As shown in core network node includes communications interface memory which contains policy table and processor which contains tunnel module and control module . Each operation of communications interface e.g. transmit receive data tunnel module e.g. encapsulate decapsulate packets and control module e.g. manage a user session as well as each manipulation on policy table e.g. modify an entry or any other portion of memory are controlled by processor .

In some embodiments communications interface of core network node includes at least two ports not shown in that can be used to implement one or more wired connections between core network node and one or more aggregation network nodes other core network nodes and or devices of other networks. The wired connections can be for example twisted pair electrical signaling via electrical cables fiber optic signaling via fiber optic cables and or the like. As such core network node can be configured to receive data and or send data through one or more ports of communications interface which are connected with the communications interfaces of one or more aggregation network nodes other core network nodes and or devices of other networks.

Furthermore in some embodiments core network node can implement a wired connection with one of an aggregation network node another core network node or a device of another network that is operatively coupled to core network node through one port of communications interface while implementing a different wired connection with another aggregation network node core network node or device of another network that is operatively coupled to core network node through another port of communications interface . For example as shown in core network node can implement one wired connection such as twisted pair electrical signaling to connect with aggregation network node aggregation and core network node while implementing a different wired connection such as fiber optic signaling to connect with a device of network .

In some embodiments as described with respect to core network node can be configured to prepare a packet e.g. a data packet a control packet to be sent to an access device e.g. an access point an access network node via a tunnel e.g. a tunnel according to a layer 3 tunneling protocol or MPLS . Core network node can also be configured to receive and decapsulate an encapsulated packet from an access device via a tunnel. Similar to core network nodes in overlay enterprise network shown in core network node can be configured to forward packets to and or receive packets from other network devices that are operatively coupled to core network node including other core network nodes and or devices in other networks without using any tunneling technology. Additionally core network node can be configured to forward or drop packets of a user session based on a user policy associated with the user that is stored in policy table . Particularly control module of core network node is configured to manage both wired and wireless user sessions and apply user policies to forward or drop packets for one or more users and or for one or more user communication devices.

More specifically upon receiving a packet associated with a user session at a port of communications interface via a tunnel tunnel module is configured to decapsulate the packet e.g. remove a header portion a footer portion and or modify any other identifiers included within the packet according to the protocol for that tunnel. Alternatively core network node can receive a packet associated with a user session at a port of communications interface from another network device operatively coupled to core network node such as another core network node or a device in another network. Control module is then configured to apply a user policy associated with the user which is stored in policy table on the received packet. If the user session is allowed by the user policy control module is configured to forward the packet. If the user session is denied by the user policy control module is configured to drop the packet. If the user session is identified by the user policy as being restricted or otherwise affected by the user policy control module is configured to retrieve more information associated with the packet and or the user session to make a decision.

To forward the received packet control module is configured to check the destination IP address or the destination MAC address included in the packet. If the packet is not destined to a user in a pod that is directly connected to core network node e.g. destined to a network device in a pod that is not connected to core network node destined to a user in another network control module is configured to forward the packet from a port of communications interface to a network device that is operatively coupled to core network node . For example control module can be configured to forward the packet to another core network node operatively coupled to core network node via a tunnel between the two core network nodes. For another example control module can be configured to forward the packet to a network device in another network operatively coupled to core network node without using any tunneling technology. If the packet is destined to a user in a pod that is directly connected to core network node tunnel module is configured to encapsulate the packet e.g. add a header portion a footer portion and or modify any other identifiers included within the packet according to the protocol for the tunnel. Meanwhile control module is configured to establish a tunnel connecting core network node to the access device e.g. an access network node an access point that is operatively coupled to the user communication device if such a tunnel is not established yet . Finally control module is configured to send the encapsulated packet from a port of communications interface to the access device through the tunnel.

As described with respect to and shown in a common user policy e.g. a down link policy an up link policy for a user is stored in policy table which is maintained and configured at core network node . Policy table is located within a portion of memory . In some embodiments memory can be for example a random access memory RAM e.g. a dynamic RAM a static RAM a flash memory a removable memory and or so forth. In some embodiments data other than user policies that is related to operations of core network node can also be stored in memory . For example combinations of user IDs and passwords of potential users can be stored in memory such that the identification of a user can be verified by core network node upon a user ID and a password entered by the user being provided to core network node . For another example information associated with tunneling packets to one or more access devices can be stored in memory such that establishing a MPLS tunnel or a layer 3 tunnel with one of the access devices can be initialized by core network node .

Specifically the first column user contains user identifiers e.g. A B C D E each of which uniquely identifies a user e.g. a person identified by a combination of a user ID and a password or a user communication device e.g. a device identified by a MAC address that is associated with a user session in a homogeneous enterprise network e.g. homogeneous enterprise network . The second column user IP address contains IP addresses e.g. 192.168.120.1 192.168.120.2 192.168.120.3 192.168.x.x where x represents any integer value between 0 and 255 each of which identifies one IP address or a group of IP addresses for a wired device or a wireless device used by the user to access the homogeneous enterprise network. The third column remote IP address contains IP addresses e.g. 192.168.120.100 192.168.x.x each of which identifies one IP address or a group of IP addresses for the other entity that communicates with the user in a user session. The fourth column direction contains direction identifiers e.g. down up bi each of which indicates the direction for the traffic of the user session that is defined. As shown in direction identifiers down and up indicate the policy is a down link policy or an up link policy respectively and direction identifier bi indicates the policy can be both a down link policy and an up link policy. The fifth column policy contains control keywords e.g. allow deny restrict each of which indicates a policy for controlling packets associated with a user session. As shown in control keyword allow indicates packets associated with the user session should be forwarded control keyword deny indicates packets associated with the user session should be dropped and control keyword restrict indicates packets associated with the user session should be forwarded under one or more certain restrictions such as a maximum number of packets that can be forwarded a maximum total size of packets that can be forwarded etc. In some embodiments information associated with the restrictions on certain user sessions that are indicated in one or more user policies in a policy table can be stored within the policy table not shown in policy table . In some other embodiments such information can be stored in a different data structure in the device e.g. a core network node an access network node an access point that hosts the policy table and can be located by information associated with the user policies e.g. a combination of user identifier user IP address and remote IP address or a pointer linked to one of the user policies that is stored in the policy table not shown in policy table .

Although not shown in it should be understood that a policy table can include other identifies and types of information to identify a policy. For example a policy can be identified by such identifiers or information as for example a source port identifier a destination port identifier a protocol identifier an application identifier etc.

In a homogeneous enterprise network as described herein a common user policy can be applied to a user in a given user session independent of the user s location and access method. In other words a user policy e.g. a down link policy an up link policy for a user in a user session can be dependent on the user identifier and the remote IP address of the user session but need not be dependent on the user IP address. For example the first entry of user policies stored in policy table is a down link policy for user A which defines that packets from a remote IP address 192.168.120.101 destined to any device associated with user A should be dropped regardless of the user IP address for user A as indicated by the user IP address x.x.x.x. For another example the fifth entry of user policies stored in policy table is an up link policy for user C which defines that packets from any device associated with user C destined to a remote IP address 192.168.120.200 should be forwarded regardless of the user IP address for user C as indicated by the user IP address x.x.x.x.

Furthermore as described herein a down link policy can be enforced at a core network node to drop forward or restrict packets destined to a user within the homogeneous enterprise network. After a user is operatively coupled to an access device e.g. an access network node an access point of the homogeneous enterprise network using a user communication device e.g. a wired device a wireless device an IP address is assigned to the user communication device by the homogeneous enterprise network. A core network node e.g. core network node in is then configured to update one or more down link policy entries associated with the user in a policy database e.g. policy table in stored in the core network node. Specifically the core node is configured to replace a default user IP address e.g. x.x.x.x or any other form of user IP address in the down link policy entries with the IP address assigned to the user communication device such that the down link policies can be implemented at the core network node to control traffic sent to the user through the core network node. Additionally one or more up link policy entries associated with the user are downloaded from the policy database to the access device of the user such that the up link policies can be implemented at the access device to control traffic sent from the user.

For example as shown in the second entry of policy table the user IP address in the down link policy for user B is updated to 191.168.120.2 which is assigned to user B when user B is operatively coupled to the homogeneous enterprise network. As a result a core network node is configured to enforce this down link policy for user B such that packets from an entity associated with the remote IP address 191.168.120.100 destined to the user IP address 192.168.120.2 i.e. the IP address of user B are forwarded by the core network node based on the control keyword allow .

For another example as shown in the fourth entry of policy table the user IP address in the down link policy for user C is updated to 191.168.120.1 which is assigned to user C when user C is operatively coupled to the homogeneous enterprise network. As a result a core network node is configured to enforce this down link policy for user C such that packets from an entity associated with the remote IP address 191.168.1.x destined to the user IP address 192.168.120.1 i.e. the IP address of user C are dropped by the core network node based on the control keyword deny .

In some embodiments after a user is disassociated with the homogeneous enterprise network e.g. a user is disassociated with a user communication device a user communication device associated with a user is operatively decoupled from an access device a core network node is configured to change the user IP address in the down link policy entries associated with the user from the IP address assigned to the user communication device back to a default value. In the example of after user B logs off from a user communication device e.g. a wired device a wireless device operatively coupled to the homogeneous enterprise network the core network node is configured to change the user IP address in the down link policy associated with user B i.e. the second entry of policy table from 192.168.120.2 back to the default value of x.x.x.x.

In some other embodiments after a user is disassociated with the homogeneous enterprise network the user IP address in the down link policy entries associated with the user in the policy database remains unchanged. Later when the user is associated with the homogeneous enterprise network and assigned a new IP address again the core network node is configured to change the user IP address in the down link policy entries associated with the user from the previous value to a value of the IP address newly assigned to the user. In the example of after the user communication device associated with user C is operatively decoupled from the homogeneous enterprise network the user IP address in the down link policy associated with user C i.e. the fourth entry of policy table remains unchanged as 192.168.120.1.

In contrast to the down link policies enforced at the core network nodes an up link policy can be downloaded to and enforced at an access device to drop forward or restrict packets originated from a user within the homogeneous enterprise network. After a user is operatively coupled to an access device e.g. an access network node an access point of the homogeneous enterprise network using a user communication device e.g. a wired device a wireless device the access device is configured to send an initiation signal to a core network node e.g. core network node in operatively coupled to the access device indicating the association of the user with the access device. In response to receiving the initiation signal the core network node is configured to determine one or more up link policies associated with the user in a policy database e.g. policy table in stored in the core network node based on a user identifier of the user or the user communication device. The core network node is then configured to send the up link policies associated with the user to the access device operatively coupled to the user. Thus the up link policies associated with the user are downloaded to a policy database e.g. policy table in policy table in stored in the access device and enforced at the access device on packets sent from the user. Accordingly the access device can enforce the up link policies associated with the user before forwarding a packet received from a user communication device to the core network node via a tunnel as described in more detail in reference to .

As described above with respect to an up link policy can be downloaded to and enforced at an access device. Specifically an up link policy associated with a user can be retrieved from a policy database e.g. policy table stored in a core network node downloaded to a policy database e.g. up link policy table up link policy table stored in an access device associated with the user and operatively coupled to the core network node and enforced at the access device.

For example up link policy table can be stored as a policy database in an access network node e.g. policy table in access network node in of the homogeneous enterprise network and policy table can be stored as a policy database in a core network node e.g. policy table in core network node in operatively coupled to the access network node. After user B is operatively coupled to the access network node using a wired device the wired device is assigned an IP address 192.168.120.2 as reflected by the second entry of policy table in . The third entry stored in policy table is determined as an up link policy associated with user B based on the user identifier of user B. The up link policy associated with user B is then downloaded from the core network node to the access network node and stored as the first entry in up link policy table . Thus this up link policy is enforced at the access network node such that any packet sent from the wired device associated with the IP address 192.168.120.2 destined to an entity associated with the IP address 192.168.120.200 is dropped by the access network node based on the control keyword deny .

Similarly stated for another example up link policy table can be stored as a policy database in an access point e.g. policy table in access point in of the homogeneous enterprise network and policy table can be stored as a policy database in a core network node operatively coupled to the access point. After user C is operatively coupled to the access point using a wireless device the wireless device is assigned an IP address 192.168.120.1 as reflected by the fourth entry of policy table in . The fifth entry stored in policy table is determined as an up link policy associated with user C based on the user identifier of user C. The up link policy associated with user C is then downloaded from the core network node to the access point and stored as the first entry in up link policy table . Thus this up link policy is enforced at the access point such that every packet sent from the wireless device associated with the IP address 192.168.120.1 destined to an entity associated with the IP address 192.168.120.200 is forwarded by the access point based on the control keyword allow .

In some embodiments as shown and described with respect to a bi directional user policy stored in a policy database in a core network node can be both a down link policy and an up link policy. For example the sixth and the seventh entry in policy table are identified as bi directional policies for user D and user E respectively. When a user associated with a bi directional policy is operatively coupled to the homogeneous enterprise network the bi directional policy is enforced as a down link policy for the user at a core network node and also downloaded to and enforced as an up link policy for the user at an access device associated with the user and operatively coupled to the core network node.

For example as shown in and after a user communication device associated with user E is operatively coupled to the access point that user C is currently connected to user E is assigned an IP address 192.168.120.3 as reflected by the seventh entry of policy table in . The seventh entry stored in policy table is determined as a bi directional policy associated with user E based on the user identifier of user E. As a result the user IP address of the policy entry associated with user E is replaced by the IP address assigned to user E 192.168.120.3. A core network node hosting policy table and operatively coupled to the user communication device for user E is configured to enforce this policy as a down link policy for user E at the core network node such that packets from an entity associated with an IP address 192.168.x.x and destined to the user communication device associated with the IP address 192.168.120.3 are forwarded by the core network node under certain restrictions based on the control keyword restrict . On the other hand the same policy associated with user E is downloaded to the access point and stored as the second entry of up link policy table in the access point. Thus the policy is enforced as an up link policy for user E at the access point such that every packet sent from the user communication device associated with the IP address 192.168.120.3 destined to an entity associated with an IP address 192.168.x.x is forwarded by the access point under certain restrictions based on the control keyword restrict .

As shown in when a user is operatively coupled to access network node using wired device A access network node is configured to send an initiation signal AA to core network node indicating the association of the user with access network node . In response to receiving the initiation signal AA core network node is configured to send an up link policy associated with the user to access network node using a signal BB over the tunnel . Thus access network node is configured to store the received up link policy associated with the user in a policy database e.g. policy table in in access network node and further enforce the up link policy for the user at access network node . Meanwhile core network node is configured to enforce one or more down link policies associated with the user on packets received at core network node that are destined to the user at wired device A.

Later the user is disassociated with access network node and then operatively coupled to access point using wireless device B shown as path CC in . In some embodiments wired device A and wireless device B can be two distinct devices such as a desktop computer and a mobile phone respectively. In such embodiments the user can be disassociated with wired device A and then be associated with wireless device B. For example the user logs off from a user session on the desktop and then logs onto a user session again using the mobile phone. In some other embodiments wired device A and wireless device B can be a single device such as a Wi Fi enabled laptop. In such embodiments the device i.e. wired device A or equivalently wireless device B can be operatively decoupled from access network node and then operatively coupled to access point . For example the user disconnects the Wi Fi enabled laptop from a port of an access network node of a wired local area network LAN and then connects the Wi Fi enabled laptop to a wireless access point WAP of the wired local area network.

After the user is operatively coupled to access point using wireless device B access point is configured to send an initiation signal DD to core network node indicating the association of the user with access point . In response to receiving the initiation signal DD the core network node is configured to send the up link policy associated with the user to access point using a signal EE over the tunnel . The up link policy sent to access point using signal EE is same as the up link policy sent to access network node using signal BB. Thus access point is configured to store the received up link policy associated with the user in a policy database e.g. policy table in in access point and further enforce the up link policy for the user at access point . Meanwhile core network node is configured to enforce one or more down link policies associated with the user on packets received at core network node that are destined to the user at wireless device B.

As described in detail with respect to in some embodiments access network node can be configured to automatically remove the up link policy associated with the user from the policy database in access network node for example a predetermined amount of time after the user is disassociated with access network node . In some other embodiments access network node can be configured to remove the up link policy associated with the user from the policy database in access network node based on an instruction signal FF received from core network node as shown in . The instruction signal FF can be sent from core network node to access network node as a result of core network node being notified by the initiation signal DD that the user is no longer associated with access network node . In this case core network node is configured to send the instruction signal FF after receiving the instruction signal DD. Alternatively core network node can be configured to send the instruction signal FF to access network node after receiving a signal not shown in from access network node indicating that the user is no longer associated with access network node e.g. inactive for a predetermined period of time . In this case the instruction signal FF is sent by core network node independent of the instruction signal DD.

In the example of when a user is associated with wired device A operatively coupled to access network node during a first time period a first data packet sent from a remote device in network to wired device A is received at core network node . The first data packet is associated with a first user session and is to be sent from the remote device associated with a remote IP address to a user associated with a first user IP address when the user is associated with wired device A during the first time period.

At a policy can be applied by the core network node to the first data packet based on a user identifier being associated with the wired device during the first time period. After the user is initially operatively coupled to the wired device and assigned the first user IP address one or more down link policy entries stored in the policy database in the core network node and associated with the user can be determined based on an identifier of the user e.g. user identifier in policy table . The user IP addresses in these down link policy entries are then updated to the first user IP address based on the user identifier being associated with the wired device during the first time period. After the first data packet is received at the core network node a down link policy entry associated with the first user session that includes the first data packet can be determined based on the source IP address and the destination IP address included in the first data packet matching the remote IP address and the user IP address stored in the down link policy entry respectively. As a result the core network node is configured to apply this down link policy to the first data packet.

In the example of after the user is initially operatively coupled to wired device A and assigned the first user IP address one or more down link policy entries stored in the policy database in core network node and associated with the user can be determined based on an identifier of the user. The user IP addresses in these down link policy entries are then updated to the first user IP address based on the user identifier being associated with wired device A during the first time period. After the first data packet is received at core network node a down link policy entry associated with the first user session that includes the first data packet can be determined based on the source IP address and the destination IP address included in the first data packet matching the remote IP address and the user IP address stored in the down link policy entry respectively. As a result core network node is configured to apply this down link policy to the first data packet.

At a second data packet to be sent to a wireless device operatively coupled to a wireless network node can be received at a core network node during a second time period. Specifically the user associated with the wired device during the first time period can be associated with the wireless device during the second time period. For example the user can log off from the wired device and later log on to the wireless device. The second data packet can be associated with a second user session i.e. to be sent from a remote device associated with the same remote IP address and destined to the same user associated with a second user IP address. In some embodiments the remote device in the second user session can be a different device from the remote device in the first user session and the two remote devices can be associated with the same remote IP address during two different time periods i.e. the first time period and the second time period respectively. The second user IP address is the IP address assigned to the wireless device when the user is associated with the wireless device during the second time period.

In the example of when the user is disassociated with wired device A and associated with wireless device B operatively coupled to access point during a second time period a second data packet sent from a remote device in network to wireless device B is received at core network node . The second data packet is associated with a second user session and is to be sent from the remove device associated with the same remote IP address as the one in the first user session to the same user assigned a second user IP address when the user is associated with wireless device B during the second time period.

At the policy can be applied by the core network node to the second data packet based on the user identifier being associated with the wireless device during the second time period. Similar to the step of after the user is initially operatively coupled to the wireless device and assigned the second user IP address the user IP addresses in the down link policy entries associated with the user are updated to the second user IP address based on the user identifier being associated with the wireless device during the second time period. After the second data packet is received at the core network node a down link policy entry associated with the second user session that includes the second data packet can be determined based on the source IP address and the destination IP address included in the second data packet matching the remote IP address and the user IP address stored in the down link policy entry respectively. The determined down link policy entry for the second user session is essentially the same as the down link policy entry for the first user session based on the same user identifier and remote IP address. As a result the core network node is configured to apply the same down link policy to the second data packet as the one applied to the first data packet.

In the example of after the user is initially operatively coupled to wireless device B and assigned the second user IP address the user IP addresses in the down link policy entries associated with the user are updated to the second user IP address based on the user identifier being associated with wireless device B during the second time period. After the second data packet is received at core network node a down link policy entry associated with the second user session that includes the second data packet can be determined based on the source IP address and the destination IP address included in the second data packet matching the remote IP address and the user IP address stored in the down link policy entry respectively. The determined down link policy entry for the second user session is essentially the same as the down link policy entry for the first user session based on the same user identifier and remote IP address. As a result core network node is configured to apply the same down link policy to the second data packet as the one applied to the first data packet.

While various embodiments have been described above it should be understood that they have been presented by way of example only not limitation and various changes in form and details may be made. Any portion of the apparatus and or methods described herein may be combined in any combination except mutually exclusive combinations. The embodiments described herein can include various combinations and or sub combinations of the functions components and or features of the different embodiments described.

While shown and described above with respect to as aggregation network nodes with their associated access network nodes and access points comprising a pod in other embodiments a pod can include less than two or more than two aggregation network nodes and their associated access devices e.g. access network nodes access points . As described herein a pod is defined as a collection of aggregation network nodes and associated access devices having a common connection to a redundant set of core network nodes. Furthermore while shown and described above with respect to as a redundant set of core network nodes connected to a pod including two core network nodes in other embodiments such a redundant set of core network nodes can include more than two core network nodes. For example a cluster of any number e.g. 3 4 5 etc. of core network nodes can be coupled to a pod of aggregation network nodes and their associated access devices. Each core network node in the cluster of core network nodes can function as a controller a hop and or a switch for the network devices included in the pod associated with the cluster of core network nodes.

While shown and described above with respect to as control module being included in core network node in other embodiments a control module can be separate from and operatively coupled to a core network node. In some embodiments a control module can be located on a separate device that is operatively coupled to a core network node. In such an example the control module can be configured to manage wired and or wireless sessions and apply user policies to wired and or wireless sessions by sending signals e.g. control signals to and receiving signals from the core network node. For example the control module can send a control signal to a tunnel module in the core network node instructing the tunnel module to encapsulate or decapsulate a received packet according to a predetermined tunneling protocol e.g. a layer 3 tunneling protocol MPLS . For another example the control module can send a control signal to a processor of the core network node instructing the processor to compare information associated with a user session with data stored in a policy table within the core network node such that an appropriate user policy can be determined and applied on the user session.

While shown and described above with respect to as policy table policy table and policy table being stored within access point access network node and core network node respectively in other embodiments a policy table can be stored in a memory separate from and operatively coupled to an access point an access network node or a core network node. For example a policy table can be stored in a memory located at a separate device that is operatively coupled to a core network node. In such an example the core network node can be configured to access and manipulate the policy table by sending signals to and receiving signals from the device that hosts the policy table. Specifically the core network node can be configured to receive signals containing information of a specific policy entry in the policy table from the device. The core network node can also be configured to send signals to the device instructing a specific user IP address in one or more policy entries in the policy table to be changed.

While shown and described above with respect to where policy table and up link policy table include data for each of the multiple fields for each user a user policy entry can include data for less than all of the fields. That is a user policy entry does not necessarily need to include data for all of the fields i.e. user identifier user IP address remote IP address direction identifier except for the policy field for the user policy entry to be stored in a policy table or an up link policy table and to be applied by an entity e.g. a core network node an access device . For example a user policy entry with a user identifier F a direction identifier down and a policy keyword deny and without data for the user IP address or remote IP address indicates all down link packets destined to a user associated with the user identifier F should be dropped regardless of the user IP address or the remote IP address of the packets. For another example a user policy entry with a user IP address 192.168.120.10 a direction identifier up and a policy keyword allow and without data for the user identity or the remote IP address indicates all up link packets from a device associated with the IP address 192.168.120.10 should be forwarded regardless of the user identifier or the remote IP address of the packets.

Some embodiments described herein relate to a computer storage product with a computer readable medium also can be referred to as a processor readable medium having instructions or computer code thereon for performing various computer implemented operations. The media and computer code also can be referred to as code may be those designed and constructed for the specific purpose or purposes. Examples of computer readable media include but are not limited to magnetic storage media such as hard disks floppy disks and magnetic tape optical storage media such as Compact Disc Digital Video Discs CD DVDs Compact Disc Read Only Memories CD ROMs and holographic devices magneto optical storage media such as optical disks carrier wave signal processing modules and hardware devices that are specially configured to store and execute program code such as Application Specific Integrated Circuits ASICs Programmable Logic Devices PLDs and read only memory ROM and RAM devices.

Examples of computer code include but are not limited to micro code or micro instructions machine instructions such as produced by a compiler code used to produce a web service and files containing higher level instructions that are executed by a computer using an interpreter. For example embodiments may be implemented using Java C or other programming languages e.g. object oriented programming languages and development tools. Additional examples of computer code include but are not limited to control signals encrypted code and compressed code.

