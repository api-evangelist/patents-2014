---

title: Increased communication security
abstract: A method of increasing communication security may include receiving, from a first computer system at a second computer system, a message including a data portion, wherein the data portion is associated with a security token, and wherein the data portion includes a session key. The method may also include performing, at the second computer system, processing associated with the message. The method may further include accessing, responsive to the processing, the session key from the data portion.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09602486&OS=09602486&RS=09602486
owner: EXILANT Technologies Private Limited
number: 09602486
owner_city: Bangalore
owner_country: IN
publication_date: 20140827
---
The present application is a continuation in part of U.S. patent application Ser. No. 14 231 625 filed Mar. 31 2014 entitled INCREASED COMMUNICATION SECURITY naming Vishnu Sharma as the inventor. That application is incorporated herein by reference in its entirety and for all purposes.

The present application is related to U.S. patent application Ser. No. 14 470 896 filed Aug. 27 2014 entitled INCREASED COMMUNICATION SECURITY naming Vishnu Sharma as the inventor. The present application is also related to U.S. patent application Ser. No. 14 470 906 filed Aug. 27 2014 entitled INCREASED COMMUNICATION SECURITY naming Vishnu Sharma as the inventor. The present application is also related to U.S. patent application Ser. No. 14 470 917 filed Aug. 27 2014 entitled INCREASED COMMUNICATION SECURITY naming Vishnu Sharma as the inventor. Those applications are incorporated herein by reference in their entirety and for all purposes.

The Constrained Application Protocol CoAP is a protocol for allowing computer systems or devices to communicate by exchanging messages. The protocol specifies certain parameters related to message format and message exchange rules. Messages sent over CoAP can be relatively small in size and therefore CoAP allows communication between computer systems or devices with limited processing resources and or limited storage resources. These computer systems or devices are sometimes referred to as constrained nodes or constrained devices. 

To address security concerns associated with communication via CoAP messages it has been suggested that messages sent over CoAP use Datagram Transport Layer Security DTLS . Although DTLS can increase the security of communications it does not provide for authentication of the sender of the CoAP message.

Embodiments disclosed herein are directed to increased security for communication of messages between computer systems or devices.

In one embodiment a method of increasing communication security may include receiving from a first computer system at a second computer system a message including a data portion wherein the data portion is associated with a security token and wherein the data portion includes a session key. The method may also include performing at the second computer system processing associated with the message. The method may further include accessing responsive to the processing the session key from the data portion.

In another embodiment an apparatus may include a communication interface configured to receive a message including a data portion wherein the data portion is associated with a security token and wherein the data portion includes a session key. The apparatus may also include a security component configured to perform processing associated with the message wherein the security component may be further configured to access responsive to the processing the session key from the data portion.

In yet another embodiment an apparatus may include means for receiving from a first computer system at a second computer system a message including a data portion wherein the data portion is associated with a security token and wherein the data portion includes a session key. The apparatus may also include means for performing at the second computer system processing associated with the message. The apparatus may further include means for accessing responsive to the processing the session key from the data portion.

Reference will now be made in detail to embodiments of the present invention examples of which are illustrated in the accompanying drawings. While the present invention will be discussed in conjunction with the following embodiments it will be understood that they are not intended to limit the present invention to these embodiments alone. On the contrary the present invention is intended to cover alternatives modifications and equivalents which may be included with the spirit and scope of the present invention as defined by the appended claims. Furthermore in the following detailed description of the present invention numerous specific details are set forth in order to provide a thorough understanding of the present invention. However embodiments of the present invention may be practiced without these specific details. In other instances well known methods procedures components and circuits have not been described in detail so as not to unnecessarily obscure aspects of the present invention.

Some regions of the detailed descriptions which follow are presented in terms of procedures logic blocks processing and other symbolic representations of operations on data bits within a computer memory. These descriptions and representations are the means used by those skilled in the art to most effectively convey the substance of their work to others skilled in the art. In the present application a procedure logic block process or the like is conceived to be a self consistent sequence of steps or instructions leading to a desired result. The steps are those requiring physical manipulations of physical quantities. Usually although not necessarily these quantities take the form of electrical or magnetic signals capable of being stored transferred combined compared and otherwise manipulated in a computer system.

It should be borne in mind however that all of these and similar terms are to be associated with the appropriate physical quantities and are merely convenient labels applied to these quantities. Unless specifically stated otherwise as apparent from the following discussions it is appreciated that throughout the present invention discussions utilizing the terms such as aborting accepting accessing activating adding adjusting allocating allowing analyzing applying assembling assigning authenticating authorizing balancing blocking calculating capturing causing changing charging combining comparing collecting communicating comparing configuring controlling converting correlating creating deactivating debugging decreasing decrypting defining delivering depicting detecting determining discharging displaying downloading enabling encrypting establishing executing forwarding flipping generating grouping hiding identifying ignoring increasing initiating instantiating interacting measuring modifying monitoring moving outputting parsing performing placing presenting processing programming providing provisioning querying receiving reformatting regulating removing rendering repeating resuming retaining sampling simulating selecting sending sorting storing subtracting suspending tracking transcoding transforming transmitting unblocking using validating verifying or the like may refer to the action and or processes of a computer system or similar electronic computing device that manipulates and transforms data represented as physical electronic quantities within the computer system s registers and memories into other data similarly represented as physical quantities within the computer system memories or registers or other such information storage transmission and or display devices.

As shown in CoAP message may include portion associated with a header portion associated with a token portion associated with at least one option portion associated with a payload marker and portion associated with a payload or some combination thereof. Authentication data may be included in portion in one embodiment.

Portion may include one or more sub portions of data. For example as shown in portion may include portion associated with a version portion associated with a message type portion associated with a token length portion associated with a code portion associated with a message identifier some combination thereof etc.

Portion may be data associated with a CoAP version number. In one embodiment portion may be two bits in length. And in other embodiments portion may be larger or smaller than two bits in length.

As shown in portion may be data associated with a message type of CoAP message . For example the message type associated with portion may be confirmable non confirmable acknowledgement reset etc.

In one embodiment portion may be two bits in length. And in other embodiments portion may be larger or smaller than two bits in length.

Portion may be data associated with a length of a token e.g. the length of portion of of CoAP message . In one embodiment portion may be four bits in length. And in other embodiments portion may be larger or smaller than four bits in length.

As shown in portion may be data associated with a code. In one embodiment the code associated with portion may be a method code. For example the code associated with portion may be GET POST PUT DELETE etc. In one embodiment the code associated with portion may be a response code. For example the code associated with portion may be Created Deleted Valid Changed Content Bad Request Unauthorized Bad Option Forbidden Not Found etc.

In one embodiment portion may be eight bits in length. And in other embodiments portion may be larger or smaller than eight bits in length.

Portion may be data associated with a message identifier. The message identifier associated with portion may be used to match or group CoAP messages based on message type e.g. to match or group a confirmable or non confirmable CoAP message with an acknowledgement or reset CoAP message in one embodiment. For example a confirmable or non confirmable CoAP message may be matched or grouped with an acknowledgement or reset CoAP message.

In one embodiment the message identifier associated with portion may be used e.g. in conjunction with a nonce to distinguish a properly re sent message e.g. with a different nonce than a previous message with the same message identifier from a replay attack e.g. resulting from the sending of a message with the same nonce and the same message identifier .

In one embodiment portion may be 16 bits in length. And in other embodiments portion may be larger or smaller than 16 bits in length.

Although shows portion with a specific number and type of portions it should be appreciated that portion may include a different number and or type of portions in other embodiments. For example portion may include fewer portions or at least one additional portion. As another example a plurality of portions of portion may be combined into a smaller number of portions. Although shows portion with a specific organization of portions it should be appreciated that portion may include a different organization of portions in other embodiments.

Turning back to portion may be associated with a token. The token associated with portion may be used to match or group at least one request e.g. one or more CoAP messages to at least one response e.g. one or more other CoAP messages in one embodiment.

In one embodiment portion may be at most eight bits in length. The length of portion may be associated with and or dictated by portion in one embodiment. And in other embodiments portion may be larger than eight bits in length.

As shown in portion may be associated with at least one option. The at least one option associated with portion may include a unique identifier in one embodiment. For example the at least one option associated with portion may include a unique identifier associated with a sender of a CoAP message e.g. computer system computer system etc. . In one embodiment the unique identifier may be included in portion as an option associated with a query e.g. a Uri Query option .

In one embodiment the at least one option associated with portion may include an authentication mechanism identifier. The term authentication mechanism identifier as used herein may be any data or metadata that identifies or is otherwise associated with an authentication mechanism.

For example the at least one option associated with portion may include an authentication mechanism identifier associated with an authentication mechanism used to generate authentication data . In one embodiment the authentication mechanism identifier may be included in portion as an option associated with a query e.g. a Uri Query option .

The at least one option associated with portion may include a nonce in one embodiment. The nonce may be a random number a pseudorandom number a sequential or incremental number e.g. a number with a predetermined offset from the nonce of a previously transmitted CoAP message a timestamp etc. In one embodiment the nonce may be included in portion as an option associated with a query e.g. a Uri Query option .

In one embodiment the at least one option associated with portion may include a max age value. For example the max age value may be used to indicate that the message is not to be cached by an intermediary system or device e.g. situated between the sender of the CoAP message and the ultimate recipient of the CoAP message such as a proxy server or other type of computer system or device.

The at least one option associated with portion may include other data in one embodiment. For example the at least one option associated with portion may include data associated with a host data associated with a port data associated with a path some combination thereof etc. As another example the at least one option associated with portion may include data associated with a query e.g. including at least one parameter . In one embodiment each parameter of the query may be encoded in portion as a respective option.

In one embodiment portion may include one or more respective sub portions of data associated with each option of the at least one option. For example as shown in for each option of the at least one option e.g. etc. portion may include a respective portion associated with an option identifier e.g. etc. a respective portion associated with an option length e.g. etc. a respective portion associated with an option value e.g. etc. etc.

A portion associated with an option identifier e.g. etc. may include data associated with an option number corresponding to an option associated with the portion e.g. option option option etc. . For example where option is associated with a port e.g. a Uri Port option portion may include data associated with a numerical value of 7 e.g. where 7 is the option number corresponding to an option associated with a port as the option identifier. As another example where option is associated with a path e.g. a Uri Path option portion may include data associated with a numerical value of 11 e.g. where 11 is the option number corresponding to an option associated with a path as the option identifier. And as yet another example where option is associated with a query e.g. a Uri Query option portion may include data associated with a numerical value of 15 e.g. where 15 is the option number corresponding to an option associated with a query as the option identifier.

In one embodiment a portion associated with an option identifier e.g. etc. may include data associated with an option delta corresponding to an option associated with the portion e.g. option option option etc. . An option delta may be the difference between the current option number and the option number of the preceding option in one embodiment. For the first option a numerical value of 0 may be used for the option number of the preceding option. A delta of 0 may be used for subsequent instances of the same option.

For example where portion is associated with an option number corresponding to 7 and option is the first option then portion may include data associated with a numerical value of 7 e.g. the delta or difference between 0 and 7 as the option identifier. As another example where portion is associated with an option number corresponding to 7 and portion is associated with an option number corresponding to 11 then portion may include data associated with a numerical value of 4 e.g. the delta or difference between 7 and 11 as the option identifier. As yet another example where portion is associated with an option number corresponding to 11 and portion is associated with an option number corresponding to 15 then portion may include data associated with a numerical value of 4 e.g. the delta or difference between 11 and 15 as the option identifier.

A portion associated with an option length e.g. etc. may include a length of a corresponding portion associated with an option value e.g. etc. . For example where portion includes data associated with a port of 5683 portion may include data associated with a length of two bytes e.g. where two bytes are used to encode a numerical value of 5683 . As another example where portion includes data associated with a path of temperature portion may include data associated with a length of 11 bytes e.g. where 11 bytes are used to encode the path of temperature . As yet another example where portion includes data associated with a unique identifier of uid cs110 portion may include data associated with a length of 9 bytes e.g. where 9 bytes are used to encode the unique identifier of uid cs110 .

Although shows at least one option with a specific number and type of portions it should be appreciated that at least one option may include a different number and or type of portions in other embodiments. For example at least one option may include fewer portions e.g. a smaller number of options a smaller number of respective sub portions associated with each option etc. or at least one additional portion e.g. a larger number of options a larger number of respective sub portions associated with each option etc. . As another example a plurality of portions of at least one option may be combined into a smaller number of portions. Although shows at least one option with a specific organization of portions it should be appreciated that at least one option may include a different organization of portions in other embodiments.

Turning back to portion may be associated with a payload marker. Portion may be included in CoAP message if portion e.g. associated with a payload is included in CoAP message .

Portion may be associated with a payload. In one embodiment portion may include only authentication data . In this case the payload associated with portion may include only authentication data and no other data content etc. Alternatively portion may include data and or content in addition to authentication data . In this case authentication data may be included in the last portion of portion e.g. with other data and or content of the payload preceding authentication data the first portion of portion e.g. with other data and or content of the payload following authentication data an intermediary portion of portion e.g. with other data and or content of the payload both preceding and following authentication data etc.

In one embodiment CoAP message may be associated with a request sent from at least one computer system to at least one other computer system. In this case CoAP message may include data associated with a request for the at least one recipient to perform at least one operation.

Alternatively CoAP message may be associated with a response sent from at least one computer system to at least one other computer system. In this case CoAP message may include data and or content associated with a corresponding request e.g. of a previously communicated CoAP message . For example CoAP message may include data and or content accessed as a result of performing at least one operation requested via a previously communicated CoAP message.

A first CoAP message e.g. associated with a request and a second CoAP message e.g. associated with a response to the request of the first CoAP message may share a common message identifier e.g. associated with data of portion of in one embodiment. A first CoAP message e.g. associated with a request and a second CoAP message e.g. associated with a response to the request of the first CoAP message may share a common token e.g. associated with data of portion of in one embodiment.

In one embodiment where a first CoAP message is associated with a request and a second CoAP message is associated with a response to the request e.g. of the first CoAP message a message type e.g. associated with data of portion as shown in associated with the second CoAP message may correspond to and or be determined by a message type e.g. associated with data of portion as shown in associated with the first CoAP message. For example where the first CoAP message is associated with a message type of confirmable the second CoAP message may be associated with a message type of confirmable or acknowledgement. 

In one embodiment where a first CoAP message is associated with a request and a second CoAP message is associated with a response to the request e.g. of the first CoAP message a response code e.g. associated with data of portion as shown in associated with the second CoAP message may correspond to and or be determined by a method code e.g. associated with data of portion as shown in associated with the first CoAP message. For example where the first CoAP message is associated with a method code of GET the second CoAP message may be associated with a response code of Content e.g. including the data and or content requested using the first CoAP message .

CoAP message A may include data associated with at least one option. For example CoAP message A may include data associated with a host e.g. an option value of www.example.com data associated with a port e.g. an option value of 5683 data associated with a path e.g. an option value of sensors an option value of temperature etc. some combination thereof etc. In this case at least one option associated with CoAP message A may correspond to a URI of coap www.example.com 5683 sensors temperature coap www.example.com sensors temperature coaps www.example.com 5683 sensors temperature coaps www.example.com sensors temperature some combination thereof etc.

As another example CoAP message A may include data associated with a max age value e.g. an option value of 0 . In this case a max age value of 0 may be used to indicate that CoAP message A is not to be cached by an intermediary system or device e.g. situated between the sender of the CoAP message A and the ultimate recipient of the CoAP message A such as a proxy server or other type of computer system or device.

As a further example CoAP message A may include data associated with a query e.g. including one or more parameters . An option value of uid cs110 e.g. associated with a first parameter may be associated with a unique identifier e.g. cs110 of a sender of CoAP message A e.g. computer system . An option value of hs256 1 e.g. associated with a second parameter may be associated with an authentication mechanism e.g. hash based message authentication code HMAC utilizing a hash function of SHA256 used to generate the authentication data e.g. Authentication Data included in CoAP message A. An option value of nonce 1 e.g. associated with a third parameter may be associated with a nonce e.g. with a value of 1 included in CoAP message A.

In one embodiment one or more portions of CoAP message A may be associated with a URI including at least one parameter of a query. For example CoAP message A may be associated with a URI of coap www.example.com 5683 sensors temperature uid cs110 hs256 1 nonce 1 or coaps www.example.com 5683 sensors temperature uid cs110 hs256 1 nonce 1 .

CoAP message A may include data associated with at least one option length. For example CoAP message A may include data associated with a first option length e.g. 15 bytes corresponding to data associated with a first option value e.g. www.example.com a second option length e.g. 2 bytes corresponding to data associated with a second option value e.g. 5683 a third option length e.g. 7 bytes corresponding to data associated with a third option value e.g. sensors etc.

As shown in CoAP message A may include data associated with at least one option identifier. The at least one option identifier may include data associated with an option number and or an option delta in one embodiment. For example CoAP message A may include data associated with a first numerical value e.g. 3 as a first option identifier corresponding to a first option e.g. associated with a host where the first numerical value e.g. 3 may be the delta or difference between the current option number e.g. 3 and the option number of the preceding option e.g. 0 in this case since this is the first option . As such the first numerical value of 3 may correspond to an option number of 3. 

As another example CoAP message A may include data associated with a second numerical value e.g. 4 as a second option identifier corresponding to a second option e.g. associated with a port where the second numerical value e.g. 4 may be the delta or difference between the current option number e.g. 7 and the option number of the preceding option e.g. 3 . As such the second numerical value of 4 may correspond to an option number of 7. 

As a further example CoAP message A may include data associated with a third numerical value e.g. 4 as a third option identifier corresponding to a third option e.g. associated with a path where the third numerical value e.g. 4 may be the delta or difference between the current option number e.g. 11 and the option number of the preceding option e.g. 7 . As such the third numerical value of 4 may correspond to an option number of 11. 

As shown in CoAP message A may include data associated with a payload marker e.g. 0xFF . CoAP message A may include data associated with a payload where the data associated with a payload may include authentication data e.g. Authentication Data .

Although shows CoAP message A with a specific number and type of portions it should be appreciated that CoAP message A may include a different number and or type of portions in other embodiments. For example CoAP message A may include fewer portions or at least one additional portion. As another example a plurality of portions of CoAP message A may be combined into a smaller number of portions. Although shows CoAP message A with a specific organization of portions it should be appreciated that CoAP message A may include a different organization of portions in other embodiments.

In one embodiment data associated with at least one option may be excluded from CoAP message A. For example data e.g. associated with a host a port a path a max age value or some combination thereof used by intermediary systems or devices e.g. situated between the sender of CoAP message A and the ultimate recipient of CoAP message A such as a proxy server or other type of computer system or device may be excluded in one or more embodiments where intermediary systems or devices do not exist or are unlikely to exist.

CoAP message B may include data associated with at least one option. For example CoAP message B may include data associated with a max age value e.g. an option value of 0 . In this case a max age value of 0 may be used to indicate that CoAP message B is not to be cached by an intermediary system or device e.g. situated between the sender of the CoAP message B and the ultimate recipient of the CoAP message B such as a proxy server or other type of computer system or device.

As another example CoAP message B may include data associated with a query e.g. including one or more parameters . An option value of uid cs120 e.g. associated with a first parameter may be associated with a unique identifier e.g. cs120 of a sender of CoAP message B e.g. computer system . An option value of hs256 1 e.g. associated with a second parameter may be associated with an authentication mechanism e.g. hash based message authentication code HMAC utilizing a hash function of SHA256 used to generate the authentication data e.g. Authentication Data included in CoAP message B. An option value of nonce 1 e.g. associated with a third parameter may be associated with a nonce e.g. with a value of 1 included in CoAP message B.

CoAP message B may include data associated with at least one option length. For example CoAP message B may include data associated with a first option length e.g. 1 byte corresponding to data associated with a first option value e.g. 0 a second option length e.g. 9 bytes corresponding to data associated with a second option value e.g. uid cs120 a third option length e.g. 7 bytes corresponding to data associated with a third option value e.g. hs256 1 etc.

As shown in CoAP message B may include data associated with at least one option identifier. The at least one option identifier may include data associated with an option number and or an option delta in one embodiment. For example CoAP message B may include data associated with a first numerical value e.g. 14 as a first option identifier corresponding to a first option e.g. associated with a max age value where the first numerical value e.g. 14 may be the delta or difference between the current option number e.g. 14 and the option number of the preceding option e.g. 0 in this case since this is the first option . As such the first numerical value of 14 may correspond to an option number of 14. 

As another example CoAP message B may include data associated with a second numerical value e.g. 1 as a second option identifier corresponding to a second option e.g. associated with a query where the second numerical value e.g. 1 may be the delta or difference between the current option number e.g. 15 and the option number of the preceding option e.g. 14 . As such the second numerical value of 1 may correspond to an option number of 15. 

As a further example CoAP message B may include data associated with a third numerical value e.g. 0 as a third option identifier corresponding to a third option e.g. associated with a query where the third numerical value e.g. 0 may be the delta or difference between the current option number e.g. 15 and the option number of the preceding option e.g. 15 . As such the third numerical value of 0 may correspond to an option number of 15. 

As shown in CoAP message B may include data associated with a payload marker e.g. 0xFF . CoAP message B may include data associated with a payload where the data associated with a payload may include authentication data e.g. Authentication Data and or other data or content e.g. 22.5 C .

In one embodiment CoAP message A e.g. associated with a request and CoAP message B e.g. associated with a response to the request may share a common message identifier e.g. 0xbc90 . CoAP message A e.g. associated with a request and CoAP message B e.g. associated with a response to the request may share a common token e.g. 0x71 in one embodiment.

In one embodiment a message type associated with CoAP message B e.g. ACK or acknowledgement may correspond to and or be determined by a message type associated with CoAP message A e.g. CON or confirmable . And in one embodiment a response code associated with CoAP message B e.g. Content may correspond to and or be determined by a method code associated with CoAP message A e.g. GET . In this case CoAP message B may include the data or content requested using CoAP message A e.g. the temperature of 22.5 C .

Although shows CoAP message B with a specific number and type of portions it should be appreciated that CoAP message B may include a different number and or type of portions in other embodiments. For example CoAP message B may include fewer portions or at least one additional portion. As another example a plurality of portions of CoAP message B may be combined into a smaller number of portions. Although shows CoAP message B with a specific organization of portions it should be appreciated that CoAP message B may include a different organization of portions in other embodiments.

In one embodiment data associated with at least one option may be excluded from CoAP message B. For example data e.g. associated with a host a port a path a max age value or some combination thereof used by intermediary systems or devices e.g. situated between the sender of CoAP message B and the ultimate recipient of CoAP message B such as a proxy server or other type of computer system or device may be excluded in one or more embodiments where intermediary systems or devices do not exist or are unlikely to exist.

Although shows CoAP message with a specific number and type of portions it should be appreciated that CoAP message may include a different number and or type of portions in other embodiments. For example CoAP message may include fewer portions or at least one additional portion. As another example a plurality of portions of CoAP message may be combined into a smaller number of portions. Although shows CoAP message with a specific organization of portions it should be appreciated that CoAP message may include a different organization of portions in other embodiments. For example authentication data may be included in at least one portion of CoAP message other than portion .

Turning back to computer system and computer system may each include a respective security component e.g. and configured to generate authentication data e.g. to be included in one or more CoAP messages to be communicated and or perform message validation e.g. with respect to at least one received CoAP message and or with respect to authentication data included in at least one received CoAP message . A message generation component e.g. message generation component of computer system message generation component of computer system etc. may generate CoAP messages e.g. including authentication data generated by security component security component etc. to be communicated.

In one embodiment a CoAP message e.g. A B etc. may be generated e.g. using message generation component message generation component etc. based on a uniform resource identifier URI . As an example the URI may be formatted as follows 

The CoAP message e.g. A B etc. including authentication data e.g. Authentication Data Authentication Data etc. may be communicated using Datagram Transport Layer Security DTLS in one embodiment. In this case the CoAP message e.g. A B etc. may be generated e.g. using message generation component message generation component etc. based on a URI that begins with coaps . 

Computer system and computer system may each include a respective operation component e.g. and in one embodiment. An operation component e.g. etc. may be configured to perform at least one operation if a received CoAP message is determined to be valid e.g. based on message validation performed using security component security component etc. .

In one embodiment the at least one operation may include at least one operation associated with a method code e.g. associated with data of portion as shown in in the CoAP message e.g. A B etc. and or at least one operation associated with an option e.g. associated with data of portion as shown in of the CoAP message e.g. A B etc. . For example where a CoAP message e.g. A is associated with a request to get a temperature e.g. with a method code of GET and a Uri Path option of temperature as depicted in the at least one operation e.g. performed by operation component of computer system operation component of computer system etc. may include accessing a temperature e.g. reading a temperature accessing a stored temperature etc. . In this case the operation component e.g. etc. may include a temperature sensor.

The at least one operation may include communication of a second CoAP message e.g. B in one embodiment. For example responsive to determining that a first CoAP message e.g. A etc. is valid the second CoAP message may be communicated from the recipient of the first CoAP message to the sender of the first CoAP message.

In one embodiment the at least one operation may include an operation associated with a request code e.g. associated with data of portion as shown in of the CoAP message e.g. A B etc. . For example where a CoAP message e.g. B is associated with a response including data and or content e.g. with a response code of Content and a payload including data associated with a temperature as depicted in the at least one operation e.g. performed by operation component of computer system operation component of computer system etc. may include processing of the data e.g. to generate business intelligence for charting for analytics etc. performing one or more other operations etc.

If a received CoAP message is determined to be invalid e.g. based on message validation performed using security component security component etc. an operation component e.g. and of computer systems and may be configured to perform at least one other operation. For example the at least one other operation may include ignoring the received CoAP message e.g. not sending a reply to the received CoAP message performing no further processing related to the received CoAP message etc. . As another example the at least one other operation may include limiting access to the recipient e.g. to computer system where the CoAP message is received at computer system to computer system where the CoAP message is received at computer system etc. of the sender e.g. computer system computer system at least one other computer system or device etc. .

As shown in connection may be implemented using communication interface of computer system and communication interface of computer system . Communication interface and communication interface may each include respective hardware and or respective software allowing connection to be established and allowing communication of at least one CoAP message over connection . Communication interface and communication interface may allow unidirectional communication and or bidirectional communication over connection in one embodiment. And in one embodiment communication interface and communication interface may allow contemporaneous or simultaneous bidirectional communication e.g. full duplex communication over connection .

Connection between computer system and computer system may be a wired connection in one embodiment. For example connection may be a IEEE 1394 or FireWire connection PCI Express connection Ethernet connection SATA connection eSATA connection RS 232 connection IC connection etc. In one embodiment connection may be a wireless connection such as a Bluetooth connection Near Field Communication NFC connection infrared IR connection IEEE 802.XX connection cellular connection etc.

In one embodiment computer system and or computer system may have limited processing resources and or limited storage resources. As an example computer system and or computer system may be constrained nodes or constrained devices. In one embodiment a constrained device may be a computer system or device with no larger than an 8 bit microcontroller. And in one or more other embodiments a constrained device may be a computer system or device with at least one microcontroller larger or smaller than 8 bits in size.

As another example computer system and or computer system may communicate over a constrained network such as a 6LowPAN network. In this case connection may be used to implement and or be part of a constrained network. 

Computer system may be a client and computer system may be a server in one embodiment. In this case computer system may communicate requests e.g. CoAP message CoAP message A etc. to computer system and computer system may communicate responses e.g. CoAP message CoAP message B etc. to computer system .

Alternatively computer system may be a server and computer system may be a client in one embodiment. In this case computer system may communicate requests e.g. CoAP message CoAP message A etc. to computer system and computer system may communicate responses e.g. CoAP message CoAP message B etc. to computer system .

Although shows system with a specific number and type of systems or devices it should be appreciated that system may include a different number and or type of systems or devices in other embodiments. For example system may include more than one instance of computer system and or computer system in one or more other embodiments. Where system includes more than one instance of computer system each instance of computer system may communicate with computer system over a respective connection e.g. similar to connection . Where system includes more than one instance of computer system each instance of computer system may communicate with computer system over a respective connection e.g. similar to connection . As such embodiments can increase the security associated with communication of CoAP messages between any number of systems or devices.

Accordingly communication of messages between systems or devices in accordance with one or more embodiments can be used in one or more applications. For example in the context of home automation a first computer system e.g. may be used to communicate with and or control at least one home appliance or system e.g. a television computer display refrigerator microwave oven door lock security system heating or air conditioning system etc. . In this case each home appliance or system may include at least one respective instance of a second computer system e.g. . As another example in the context of remote data monitoring a first computer system e.g. may be used to remotely monitor at least one parameter e.g. temperature pressure humidity moisture wind speed etc. measured by at least one sensor. In this case each sensor may be included in e.g. as at least a portion of an operational component and or in communication with at least one instance of a second computer system e.g. . The data sent to the first computer system e.g. may be stored and collected e.g. in a database thereby allowing processing of the data e.g. to generate business intelligence for charting for analytics etc. .

As shown in step involves generating authentication data e.g. of Authentication Data of Authentication Data of etc. . In one embodiment the authentication data may be generated in step at a computer system e.g. by security component of computer system by security component of computer system etc. using an authentication mechanism such as HMAC OAuth OAuth 2.0 OpenID etc. And in one embodiment the authentication data e.g. of Authentication Data of Authentication Data of etc. may be generated in step based on message data e.g. accessed in step .

The authentication data may be generated in step based on a key in one embodiment. For example where the authentication mechanism used to generate the authentication data in step is HMAC the authentication data may be generated by performing a hash function e.g. MD5 SHA 1 SHA256 SHA512 etc. on the message data e.g. accessed in step using a key. And in one embodiment the CoAP message e.g. A B etc. may be free of a key used to generate the authentication data in step .

In one embodiment the key may be associated with the sender of the CoAP message e.g. generated in step . For example the key may be a secret key or private key that is unique to the sender e.g. computer system computer system etc. . Alternatively the key may be associated with the recipient of the CoAP message e.g. generated in step . For example the key may be a secret key or private key that is unique to the recipient e.g. computer system computer system etc. .

Where a key associated with the sender of the CoAP message e.g. generated in step is used to generate the authentication data in step the key may be stored locally at the sender in one embodiment. For example the key may be stored locally in a security component e.g. of computer system of computer system etc. in a memory e.g. of computer system of computer system etc. in a database e.g. of computer system of computer system etc. etc. Alternatively the key may be stored remotely e.g. at another system or device and accessed by the sender in a secure manner in one embodiment. Accordingly a key associated with the sender of the CoAP message may be accessed and used by the sender to securely generate the authentication data in step .

Where a key associated with the recipient of the CoAP message e.g. generated in step is used to generate the authentication data in step the sender may access the key based on information about the recipient in one embodiment. For example using data e.g. of which correlates or maps information about systems or devices e.g. unique identifiers to keys the sender e.g. computer system may access a key e.g. Key 2 associated with the recipient e.g. computer system based on information about the recipient e.g. the unique identifier of cs120 associated with computer system other information associated with computer system etc. . In one embodiment the data e.g. of may be stored locally in a security component e.g. of computer system of computer system etc. in a memory e.g. of computer system of computer system etc. in a database e.g. of computer system of computer system etc. etc. Alternatively the data e.g. of may be stored remotely e.g. at another system or device and accessed by the sender in a secure manner in one embodiment. Accordingly a key associated with the recipient of the CoAP message may be accessed and used by the sender to securely generate the authentication data in step .

Although shows data as including a particular amount of data it should be appreciated that a different amount of data may be included in data in other embodiments. Additionally although shows data as including a particular arrangement and type of data it should be appreciated that a different arrangement and or type of data may be included in data in other embodiments.

The size or length of the key e.g. used to generate the authentication data in step may be associated with the authentication mechanism used to generate the authentication data in step . For example where the authentication mechanism of HMAC utilizing a SHA256 hash function is used to generate the authentication data the length of the key may be 32 bytes. As another example where the authentication mechanism of HMAC utilizing a SHA512 hash function is used to generate the authentication data the length of the key may be 64 bytes.

In one embodiment multiple CoAP messages may each include respective authentication data generated based on a key associated with a common system or device. For example where a first CoAP message e.g. A is sent from a first computer system e.g. to a second computer system e.g. and where a second CoAP message e.g. B is sent from the second computer system e.g. to the first computer system e.g. the first CoAP message e.g. A and the second CoAP message e.g. B may each include respective authentication data e.g. Authentication Data and Authentication Data generated based on a key associated with the first computer system e.g. . It should be appreciated that the authentication data e.g. Authentication Data and Authentication Data included in the first and second CoAP messages may be different even though they are generated based on the same key associated with the first computer system since the respective data or content of each CoAP message may be different.

As another example where a first CoAP message e.g. A is sent from a first computer system e.g. to a second computer system e.g. and where a second CoAP message e.g. B is sent from the second computer system e.g. to the first computer system e.g. the first CoAP message e.g. A and the second CoAP message e.g. B may each include respective authentication data e.g. Authentication Data and Authentication Data generated based on a key associated with the second computer system e.g. . It should be appreciated that the authentication data e.g. Authentication Data and Authentication Data included in the first and second CoAP messages may be different even though they are generated based on the same key associated with the second computer system since the respective data or content of each CoAP message may be different.

As shown in step involves generating a CoAP message which includes the authentication data e.g. generated in step . The CoAP message e.g. A B etc. may be generated in step using a message generation component e.g. of the computer system of the computer system etc. in one embodiment. And in one embodiment step may be performed in accordance with process of .

As shown in step involves generating the CoAP message e.g. A B etc. including message data e.g. accessed in step and the authentication data e.g. accessed in step . The CoAP message e.g. A B etc. may be generated in step using a message generation component e.g. of computer system of computer system etc. in one embodiment. In one embodiment step may involve formatting the message data in accordance with CoAP e.g. into one or more portions of CoAP message . The authentication data may be included in or as the payload e.g. associated with portion of CoAP message of the CoAP message e.g. A B etc. in one embodiment.

In one embodiment step may involve further including a payload marker as part of the CoAP message generation. For example where the message data is free of data or content to be included as a payload e.g. and therefore is also free of a payload marker a payload marker may be included as part of the CoAP message in step since the authentication data e.g. accessed in step may be included as the payload e.g. the entire payload of the CoAP message.

In one embodiment step may involve generating a bit stream or byte stream including the message data e.g. accessed in step and the authentication data e.g. accessed in step . The bit stream or byte stream may be formatted in accordance with CoAP in one embodiment.

Although depicts process as including a specific number of steps it should be appreciated that process may include a different number of steps in other embodiments. Although depicts process as including a specific ordering of steps it should be appreciated that process may include a different ordering of steps in other embodiments.

Turning back to step involves communicating the CoAP message e.g. generated in step and or in accordance with one or more steps of process of . In one embodiment step may involve communicating the CoAP message from a first computer system e.g. to at least one other computer system e.g. one or more other systems or devices etc. . And in one embodiment step may involve communicating the CoAP message from a second computer system e.g. to at least one other computer system e.g. one or more other systems or devices etc. .

In one embodiment the CoAP message may be communicated in step over a connection e.g. between computer system and computer system . The CoAP message may be communicated in step as a bit stream or a byte stream in one embodiment. And in one embodiment step may involve communicating the CoAP message using a communication interface e.g. of computer system of computer system etc. .

Accordingly communication security can be increased by including authentication data in CoAP messages communicated between systems or devices. For example the recipient of the CoAP message e.g. A B etc. can perform message validation with respect to the authentication data e.g. included in the CoAP message to verify the authenticity of the sender of the CoAP message and or the integrity of the CoAP message. As another example where the CoAP message e.g. A B etc. includes a nonce e.g. in the data associated with portion in another portion of the CoAP message etc. communication security can be improved by allowing the recipient to detect and or act on a replay attack.

As shown in step involves receiving the CoAP message e.g. A B etc. . In one embodiment step may involve receiving the CoAP message at the second computer system e.g. from another computer system e.g. another system or device etc. . And in one embodiment step may involve receiving the CoAP message at the first computer system e.g. from another computer system e.g. another system or device etc. .

In one embodiment the CoAP message may be received in step over a connection e.g. between computer system and computer system . The CoAP message may be received in step as a bit stream or a byte stream in one embodiment. And in one embodiment step may involve receiving the CoAP message using a communication interface e.g. of computer system of computer system etc. .

Step involves optionally processing the CoAP message e.g. received in step . In one embodiment step may involve processing the CoAP message using a security component e.g. of computer system of computer system etc. . And in one embodiment step may be performed in accordance with process of .

Step may involve determining the length of the authentication data e.g. Authentication Data of CoAP message A Authentication Data of CoAP message B etc. based on the authentication mechanism identifier e.g. accessed in step . For example where the authentication mechanism identifier e.g. hs256 1 of CoAP message A is associated with an authentication mechanism of HMAC utilizing a SHA256 hash function the length of the authentication data may be determined in step to be 32 bytes. As another example where the authentication mechanism identifier is associated with an authentication mechanism of HMAC utilizing a SHA512 hash function the length of the authentication data may be determined in step to be 64 bytes.

As shown in step involves removing a portion of the CoAP message based on the length e.g. determined in step . The portion of the CoAP message removed in step may include at least a portion of the authentication data e.g. . In one embodiment the portion removed in step may be a predetermined portion e.g. the first portion the last portion an intermediary portion etc. of a payload of the CoAP message. For example where the length of the authentication data is determined to be 32 bytes in step step may involve removing the last 32 bytes of the CoAP message.

Step involves determining whether the CoAP message is free of a payload e.g. after removal of the portion in step . If it is determined in step that at least a portion of the payload remains e.g. the CoAP message is not free of the payload then step may be bypassed and process may terminate. Alternatively if it is determined in step that the CoAP message is free of the payload e.g. no other data or content remains after removal of the portion in step then the payload marker e.g. associated with portion of CoAP message may be removed from the CoAP message in step .

Accordingly in one embodiment the payload marker may be removed from the CoAP message where the payload of the CoAP message e.g. received in step includes only the authentication data e.g. Authentication Data of CoAP message A Authentication Data of CoAP message B etc. . This may be used to account for the situation where during message generation e.g. in step and or in accordance with one or more steps of process of the payload marker was included in the CoAP message since the authentication data was included as the payload e.g. the entire payload of the CoAP message.

Although depicts process as including a specific number of steps it should be appreciated that process may include a different number of steps in other embodiments. Although depicts process as including a specific ordering of steps it should be appreciated that process may include a different ordering of steps in other embodiments.

Turning back to step involves performing message validation based on the authentication data e.g. accessed from the CoAP message in step and or in step . In one embodiment the message validation may be used to verify the authenticity of the sender of the CoAP message e.g. A B etc. and or the integrity of the CoAP message e.g. A B etc. . Where the CoAP message e.g. A B etc. includes a nonce e.g. in data associated with portion in another portion of the CoAP message etc. the message validation may be used to detect a replay attack.

In one embodiment message validation may be performed in step by comparing second authentication data to the authentication data e.g. accessed from the CoAP message in step and or in step . The second authentication data may be generated e.g. in step based on at least a portion of the CoAP message e.g. received in step in one embodiment. For example the second authentication data may be generated based on data associated with a header e.g. included in portion of CoAP message data associated with a token e.g. included in portion of CoAP message data associated with at least one option e.g. included in portion of CoAP message data associated with a payload marker e.g. included in portion of CoAP message data associated with at least a portion of a payload e.g. included in portion of CoAP message some combination thereof etc. As another example the second authentication data may be generated based on at least a unique identifier e.g. associated with a sender of the CoAP message included in portion of CoAP message etc. an authentication mechanism identifier e.g. associated with an authentication mechanism used to generate the authentication data included in the CoAP message and or used to generate the second authentication data included in portion of CoAP message etc. a nonce e.g. included in portion of CoAP message etc. or some combination thereof. And as a further example the second authentication data may be generated based on at least a portion of the CoAP message excluding the authentication data e.g. of Authentication Data of Authentication Data of etc. .

The second authentication data may be generated e.g. in step based on a key in one embodiment. For example where the authentication mechanism used to generate the second authentication data is HMAC the second authentication data may be generated by performing a hash function e.g. MD5 SHA 1 SHA256 SHA512 etc. on at least a portion of the CoAP message using a key. And in one embodiment the CoAP message e.g. received in step may be free of a key used to generate the second authentication data.

In one embodiment the key may be associated with the sender of the CoAP message e.g. received in step . For example the key may be a secret key or private key that is unique to the sender e.g. computer system computer system etc. . Alternatively the key may be associated with the recipient of the CoAP message e.g. received in step . For example the key may be a secret key or private key that is unique to the recipient e.g. computer system computer system etc. .

In one embodiment at least one attribute of the generation of the second authentication data in step may be the same as at least one attribute of the generation of the authentication data e.g. in step . For example the second authentication data may be generated based on the same data as the authentication data the second authentication data may be generated based on the same key as the authentication data the second authentication data may be generated using the same authentication mechanism as the authentication data some combination thereof etc.

The message validation may be performed in step using a security component e.g. of computer system of computer system etc. in one embodiment. And in one embodiment step may be performed in accordance with process of .

Step involves optionally accessing a unique identifier from the CoAP message e.g. A B etc. . For example where the CoAP message includes authentication data generated using a key associated with the sender of the CoAP message a unique identifier e.g. associated with the sender of the CoAP message may be accessed from the CoAP message in step by the recipient. In one embodiment the unique identifier may be accessed in step from a portion of the CoAP message associated with at least one option e.g. portion of CoAP message .

As shown in step involves accessing a key. The key may be stored locally at the recipient in a security component e.g. of computer system of computer system etc. in a memory e.g. of computer system of computer system etc. in a database e.g. of computer system of computer system etc. etc. Alternatively the key may be stored remotely e.g. at a system or device other than the recipient and accessed by the recipient in step in a secure manner. As such in accordance with one or more embodiments the key may be accessed e.g. by the recipient in step while limiting other access to the key e.g. by at least one system or device other than the recipient .

The key may be associated with the sender of the CoAP message e.g. received in step in one embodiment. For example the key may be a secret key or private key that is unique to the sender e.g. computer system computer system etc. . Alternatively the key may be associated with the recipient of the CoAP message e.g. received in step . For example the key may be a secret key or private key that is unique to the recipient e.g. computer system computer system etc. .

Where the key is associated with the sender of the CoAP message the recipient may access the key in step based on information about the sender in one embodiment. For example the unique identifier e.g. associated with the sender of the CoAP message accessed in step may be used by the recipient to access the key e.g. associated with the sender in step .

In one embodiment the recipient may access the key e.g. associated with the sender of the CoAP message in step using data e.g. of which correlates or maps information about systems or devices e.g. unique identifiers to keys. The data e.g. of may be stored locally at the recipient in a security component e.g. of computer system of computer system etc. in a memory e.g. of computer system of computer system etc. in a database e.g. of computer system of computer system etc. etc. Alternatively the data e.g. of may be stored remotely e.g. at a system or device other than the recipient and accessed by the recipient in a secure manner.

Where the key is associated with the recipient of the CoAP message the key may be accessed locally by the recipient in step in one embodiment. For example the key e.g. associated with the recipient may be accessed from local storage in a security component e.g. of computer system of computer system etc. in a memory e.g. of computer system of computer system etc. in a database e.g. of computer system of computer system etc. etc. Alternatively the key e.g. associated with the recipient may be accessed remotely e.g. from another system or device in a secure manner by the recipient in step in one embodiment.

As shown in step involves determining whether at least one condition for message invalidity is met. In one embodiment step may be performed in accordance with process of .

If it is determined in step that the CoAP message does not include a unique identifier then it may be determined in step that at least one condition for message invalidity has been met and process may terminate. Alternatively if it is determined in step that the CoAP message includes a unique identifier then step may be performed.

As shown in step involves determining whether the CoAP message e.g. received in step includes a nonce. In one embodiment step may involve determining whether a portion of the CoAP message associated with at least one option e.g. portion of CoAP message includes a nonce.

If it is determined in step that the CoAP message does not include a nonce then it may be determined in step that at least one condition for message invalidity has been met and process may terminate. Alternatively if it is determined in step that the CoAP message includes a nonce then step may be performed.

As shown in step involves determining whether the nonce e.g. included in the CoAP message as determined in step is different from a previous nonce e.g. of a previously transmitted or previously received CoAP message . In one embodiment the recipient of the CoAP message may store at least one previous nonce e.g. from one or more previously transmitted or previously received CoAP messages for comparison with the nonce of the CoAP message.

In one embodiment it may be determined in step whether the nonce is different from another nonce of another CoAP message e.g. of a previously transmitted or previously received CoAP message from the same sender e.g. corresponding to the unique identifier associated with step . For example the recipient of the CoAP message may store at least one previous nonce corresponding to the sender of the CoAP message for comparison with the nonce of the CoAP message.

In one embodiment step may be used to increase communication security by detecting a replay attack. For example if it is determined in step that the nonce is the same as e.g. not different from a previous nonce then it may indicate a malicious re sending of the CoAP message or that the CoAP message is otherwise associated with a replay attack.

If it is determined in step that the nonce is not different from a previous nonce then it may be determined in step that at least one condition for message invalidity has been met and process may terminate. Alternatively if it is determined in step that the nonce is different from a previous nonce then step may be performed.

As shown in step involves determining whether a payload of the CoAP message e.g. received in step is at least a predetermined size. In one embodiment the predetermined size may correspond to an authentication mechanism used to generate authentication data e.g. of Authentication Data of Authentication Data of etc. included in the CoAP message and or an authentication mechanism identifier included in the CoAP message e.g. in a portion of the CoAP message associated with at least one option in portion of CoAP message in another portion etc. .

For example where an authentication mechanism e.g. used to generate the authentication data included in the CoAP message is HMAC utilizing a SHA256 hash function and or where an authentication mechanism identifier e.g. included in the CoAP message is associated with an authentication mechanism e.g. used to generate the authentication data included in the CoAP message of HMAC utilizing a SHA256 hash function the predetermined size used in step may be 32 bytes. As another example where an authentication mechanism e.g. used to generate the authentication data included in the CoAP message is HMAC utilizing a SHA512 hash function and or where an authentication mechanism identifier e.g. included in the CoAP message is associated with an authentication mechanism e.g. used to generate the authentication data included in the CoAP message of HMAC utilizing a SHA512 hash function the predetermined size used in step may be 64 bytes.

In one embodiment step may be used to increase communication security by identifying one or more security risks related to authentication data of the CoAP message. For example if it is determined in step that the payload of the CoAP message is not at least a predetermined size then it may indicate that the CoAP message does not include any authentication data and or that the authentication data is not proper e.g. not of the proper size or length based on an authentication mechanism used to generate the authentication data .

If it is determined in step that the payload of the CoAP message is not at least a predetermined size then it may be determined in step that at least one condition for message invalidity has been met and process may terminate. Alternatively if it is determined in step that the payload of the CoAP message is at least a predetermined size then step may be performed.

As shown in step involves determining if a key has been accessed e.g. in step of process . In one embodiment step may involve determining if a key associated with the recipient of the CoAP message has been accessed. And in one embodiment step may involve determining if a key associated with the sender of the CoAP message has been accessed e.g. based on a unique identifier or other information associated with the sender .

If it is determined in step that a key has not been accessed then it may be determined in step that at least one condition for message invalidity has been met and process may terminate. Alternatively if it is determined in step that a key has been accessed then it may be determined in step that at least one condition for message invalidity has not been met and process may terminate.

Although depicts process as including a specific number of steps it should be appreciated that process may include a different number of steps in other embodiments. For example one or more steps e.g. step or some combination thereof may be omitted in one or more embodiments. Although depicts process as including a specific ordering of steps it should be appreciated that process may include a different ordering of steps in other embodiments.

Turning back to if it is determined in step that at least one condition for message invalidity has been met then it may be determined in step that the CoAP message e.g. received in step is invalid. Alternatively if it is determined in step that at least one condition for message invalidity has not been met then step may be performed.

As shown in step involves generating second authentication data. In one embodiment the second authentication data may be generated in step using an authentication mechanism such as HMAC OAuth OAuth 2.0 OpenID etc. And in one embodiment the authentication mechanism used to generate the second authentication data in step may be the same as the authentication mechanism used to generate e.g. in step the authentication data e.g. included in the CoAP message received in step .

In one embodiment the authentication mechanism used to generate the second authentication data in step may be determined based on an authentication mechanism identifier included in the CoAP message e.g. in portion associated with at least one option . In one embodiment the authentication mechanism used to generate the second authentication data in step may be determined based on at least one other message e.g. including information about an authentication mechanism used to generate the authentication data and or the second authentication data where the at least one other message may be separate from the CoAP message e.g. including the authentication data and may be communicated before or after the CoAP message. And in one embodiment the authentication mechanism used to generate the second authentication data in step may be determined using data stored at the recipient e.g. in security component of computer system in another component of computer system in security component of computer system in another component of computer system in a component of another system or device etc. where the data may be supplied to the recipient by another system or device.

In one embodiment the second authentication data may be generated in step based on at least a portion of the CoAP message e.g. received in step . For example the second authentication data may be generated in step based on data associated with a header e.g. included in portion of CoAP message data associated with a token e.g. included in portion of CoAP message data associated with at least one option e.g. included in portion of CoAP message data associated with a payload marker e.g. included in portion of CoAP message data associated with at least a portion of a payload e.g. included in portion of CoAP message some combination thereof etc. As another example the second authentication data may be generated in step based on at least a unique identifier e.g. associated with a sender of the CoAP message included in portion of CoAP message etc. an authentication mechanism identifier e.g. associated with an authentication mechanism used to generate the authentication data included in the CoAP message and or used to generate the second authentication data in step included in portion of CoAP message etc. a nonce e.g. included in portion of CoAP message etc. or some combination thereof. And as a further example the second authentication data may be generated in step based on at least a portion of the CoAP message excluding the authentication data e.g. of Authentication Data of Authentication Data of etc. .

The second authentication data may be generated in step based on a key in one embodiment. For example where the authentication mechanism used to generate the second authentication data is HMAC the second authentication data may be generated in step by performing a hash function e.g. MD5 SHA 1 SHA256 SHA512 etc. on at least a portion of the CoAP message using a key e.g. accessed in step . And in one embodiment the CoAP message e.g. received in step may be free of a key used to generate the second authentication data in step .

In one embodiment the key may be associated with the sender of the CoAP message e.g. received in step . For example the key may be a secret key or private key that is unique to the sender e.g. computer system computer system etc. . Alternatively the key may be associated with the recipient of the CoAP message e.g. received in step . For example the key may be a secret key or private key that is unique to the recipient e.g. computer system computer system etc. .

Where a key associated with the recipient of the CoAP message e.g. received in step is used to generate the second authentication data in step the key may be stored locally at the recipient in one embodiment. For example the key may be stored locally in a security component e.g. of computer system of computer system etc. in a memory e.g. of computer system of computer system etc. in a database e.g. of computer system of computer system etc. etc. Alternatively the key may be stored remotely e.g. at another system or device and accessed by the recipient in a secure manner in one embodiment. Accordingly a key associated with the recipient of the CoAP message may be accessed and used by the recipient to securely generate the second authentication data in step .

Where a key associated with the sender of the CoAP message e.g. received in step is used to generate the second authentication data in step the recipient may access the key based on information about the sender in one embodiment. For example using data e.g. of which correlates or maps information about systems or devices e.g. unique identifiers to keys the recipient e.g. computer system may access a key e.g. Key 1 associated with the sender e.g. computer system based on information about the recipient e.g. the unique identifier of cs110 associated with computer system . In one embodiment the data e.g. of may be stored locally in a security component e.g. of computer system of computer system etc. in a memory e.g. of computer system of computer system etc. in a database e.g. of computer system of computer system etc. etc. Alternatively the data e.g. of may be stored remotely e.g. at another system or device and accessed by the recipient in a secure manner in one embodiment. Accordingly a key associated with the sender of the CoAP message may be accessed and used by the recipient to securely generate the second authentication data in step .

The size or length of the key e.g. used to generate the second authentication data in step may be associated with the authentication mechanism used to generate the second authentication data in step . For example where the authentication mechanism of HMAC utilizing a SHA256 hash function is used to generate the authentication data the length of the key may be 32 bytes. As another example where the authentication mechanism of HMAC utilizing a SHA512 hash function is used to generate the authentication data the length of the key may be 64 bytes.

As shown in step may involve determining whether the second authentication data e.g. generated in step correlates to the authentication data e.g. included in the CoAP message received in step . If the second authentication data does not correlate to the authentication data then it may be determined in step that the CoAP message e.g. received in step is invalid. Alternatively if the second authentication data correlates to the authentication data then it may be determined in step that the CoAP message e.g. received in step is valid.

In one embodiment message validation e.g. performed in accordance with one or more steps of process may be used to verify the authenticity of the sender of a CoAP message. For example where the authentication data and second authentication data are each generated using at least one key e.g. at least one secret key at least one private key at least one key which is accessible to authorized systems or devices some combination thereof etc. the authenticity of the sender of a CoAP message may be verified if it is determined that the CoAP message is valid in step .

In one embodiment message validation e.g. performed in accordance with one or more steps of process may be used to verify the integrity of a CoAP message. For example where the authentication data and second authentication data are each generated based on data included in the CoAP message e.g. message data other data etc. the integrity of the CoAP message may be verified if it is determined that the CoAP message is valid in step .

Although depicts process as including a specific number of steps it should be appreciated that process may include a different number of steps in other embodiments. Although depicts process as including a specific ordering of steps it should be appreciated that process may include a different ordering of steps in other embodiments.

Turning back to if it is determined in step that the CoAP message e.g. received in step is valid then at least one operation associated with the CoAP message may be performed in step . In one embodiment step may involve performing at least one operation using an operation component e.g. of computer system of computer system etc. .

In one embodiment the at least one operation performed in step may include at least one operation associated with a method code e.g. associated with data of portion as shown in in the CoAP message e.g. A B etc. and or at least one operation associated with an option e.g. associated with data of portion as shown in of the CoAP message e.g. A B etc. . For example where a CoAP message e.g. A is associated with a request to get a temperature e.g. with a method code of GET and a Uri Path option of temperature as depicted in the at least one operation performed in step may include accessing a temperature e.g. reading a temperature accessing a stored temperature etc. . In one embodiment where the at least one operation is performed in step using an operation component e.g. of computer system of computer system etc. the operation component may include a temperature sensor.

The at least one operation performed in step may include communication of a second CoAP message e.g. B in one embodiment. For example responsive to determining that a first CoAP message e.g. A etc. is valid e.g. in step the second CoAP message may be communicated in step from the recipient of the first CoAP message to the sender of the first CoAP message.

The at least one operation performed in step may include an operation associated with a request code e.g. associated with data of portion as shown in of the CoAP message e.g. A B etc. in one embodiment. For example where a CoAP message e.g. B is associated with a response including data and or content e.g. with a response code of Content and a payload including data associated with a temperature as depicted in the at least one operation performed in step may include processing of the data e.g. to generate business intelligence for charting for analytics etc. performing one or more other operations etc.

Alternatively if it is determined in step that the CoAP message e.g. received in step is not valid then at least one other operation associated with the CoAP message may be performed in step . In one embodiment step may involve performing at least one other operation using an operation component e.g. of computer system of computer system etc. .

In one embodiment step may involve acting responsive to a message validation failure such as a triggering of a message invalidity condition e.g. corresponding to one or more steps of process another message validation failure e.g. determined in step and or determined in step etc. etc. And in one embodiment step may involve acting on a suspected or detected replay attack.

In one embodiment the at least one other operation performed in step may include ignoring the received CoAP message e.g. not sending a reply to the received CoAP message performing no further processing related to the received CoAP message etc. . In one embodiment the at least one other operation performed in step may include limiting access to the recipient e.g. to computer system where the CoAP message is received at computer system to computer system where the CoAP message is received at computer system etc. of the sender e.g. computer system computer system at least one other system or device etc. .

In one embodiment one or more steps of process may be repeated with respect to at least one other CoAP message. For example where a first CoAP message is generated and communicated e.g. in accordance with one or more steps of process at least one other CoAP message may be generated and communicated e.g. in accordance with one or more steps of process . In one embodiment the first CoAP message may be a request and the at least one other CoAP message may be at least one response e.g. related to the request of the first CoAP message .

Although depict process as including a specific number of steps it should be appreciated that process may include a different number of steps in other embodiments. Although depict process as including a specific ordering of steps it should be appreciated that process may include a different ordering of steps in other embodiments.

In one embodiment computer system may be used to implement computer system computer system computer system of computer system of another system or device configured to communicate messages e.g. CoAP messages other types of messages etc. some combination thereof etc. And in one embodiment one or more components of computer system may be disposed in and or coupled with a housing or enclosure.

In one embodiment computer system may include at least one processor e.g. and at least one memory e.g. . Processor may be or include a central processing unit CPU or other type of processor. Depending on the configuration and or type of computer system environment memory may be or include volatile memory e.g. RAM non volatile memory e.g. ROM flash memory etc. some combination thereof etc. Additionally memory may be removable non removable etc.

In one embodiment computer system may include additional storage e.g. removable storage non removable storage etc. . Removable storage and or non removable storage may include volatile memory non volatile memory some combination thereof etc. Additionally removable storage and or non removable storage may include CD ROM digital versatile disks DVD other optical storage magnetic cassettes magnetic tape magnetic disk storage other magnetic storage devices or any other medium which can be used to store information for access by computer system .

As shown in computer system may communicate with other systems components or devices via communication interface . Communication interface may be used to implement at least one communication interface e.g. etc. of one or more components of system in one embodiment.

Communication interface may embody computer readable instructions data structures program modules or other data in a modulated data signal e.g. a carrier wave or other transport mechanism By way of example and not limitation communication interface may couple to and or communicate over wired media e.g. a wired network direct wired connection etc. and or wireless media e.g. a wireless network a wireless connection utilizing acoustic RF infrared or other wireless signaling etc. .

Communication interface may also couple computer system to one or more external input components e.g. a keyboard a mouse a trackball a joystick a pen a voice input device a touch input device etc. . In one embodiment communication interface may couple computer system to one or more external output components e.g. a display a speaker a printer etc. . And in one embodiment communication interface may include a plug receptacle cable slot or any other component capable of coupling to and or communicating with another component device system etc.

Input component may include any component capable of receiving or allowing the input of information. For example input component may be or include a keyboard at least one button or key a mouse a trackball a joystick a pen a voice input device a touch input device another type of input component etc. Output component may include any component capable of transmitting or allowing the output of information. For example output component may be or include a display a speaker a printer another type of output component etc.

As shown in graphics processor may perform graphics processing operations on graphical data stored in frame buffer or another memory e.g. etc. of computer system . Graphical data stored in frame buffer may be accessed processed and or modified by components e.g. graphics processor processor some combination thereof etc. of computer system and or components of other systems other devices etc. Additionally the graphical data may be accessed e.g. by graphics processor and displayed on an output device coupled to computer system in one embodiment.

In one embodiment a memory of computer system e.g. memory removable storage non removable storage frame buffer some combination thereof etc. may be a computer readable medium or computer usable medium or computer readable storage medium etc. and may include instructions that when executed by a processor e.g. etc. implement a method of increasing communication security e.g. in accordance with process of process of process of etc. generating a CoAP message e.g. in accordance with process of processing a CoAP message e.g. in accordance with process of performing message validation e.g. in accordance with process of process of etc. determining whether at least one condition for message invalidity is met e.g. in accordance with process of configuring permissions e.g. in accordance with process of generating a message associated with communication between a plurality of computer systems e.g. in accordance with process of performing processing associated with a message e.g. in accordance with process of process of process of etc. generating a message including a data portion associated with a security token e.g. in accordance with process of generating a message associated with successful access of a session key e.g. in accordance with process of some combination thereof etc. And in one embodiment a computer readable medium of computer system may be implemented in and or using at least one die of at least one integrated circuit e.g. at least one application specific integrated circuit ASIC at least one system on a chip SOC at least one programmable system on a chip PSOC another type of integrated circuit etc. .

As shown in step involves configuring permissions for a first computer system with respect to a second computer system. In one embodiment step may involve configuring permissions for a first computer system e.g. as shown in with respect to a second computer system e.g. as shown in using a third computer system e.g. computer system of . Step may be performed using a security component e.g. of computer system in one embodiment. And in one embodiment step may be performed in accordance with one or more steps of process of .

Step may involve communicating the first registration data from the computer system being registered in one embodiment. For example first registration data associated with the first computer system may be communicated from the first computer system e.g. to the third computer system e.g. . In one embodiment registration data may be communicated between the first and third computer systems over connection .

Alternatively step may involve communicating the first registration data from a computer system other than the computer system being registered. For example first registration data associated with the first computer system may be communicated from a fourth computer system e.g. computer system to the third computer system e.g. . The fourth computer system e.g. may be operated by the owner of or a user associated with the first computer system e.g. in one embodiment. In one embodiment registration data may be communicated in step between the third and fourth computer systems over connection . And in one embodiment step may be performed using a security component e.g. a communication interface e.g. some combination thereof etc.

As shown in step involves accessing second registration data associated with a second computer system. For example second registration data associated with the second computer system e.g. may be accessed by the third computer system e.g. in step . The second registration data may include a unique identifier associated with the second computer system credentials or other information associated with the second computer system etc.

Step may involve communicating the second registration data from the computer system being registered in one embodiment. For example second registration data associated with the second computer system may be communicated from the second computer system e.g. to the third computer system e.g. . In one embodiment registration data may be communicated between the second and third computer systems over connection .

Alternatively step may involve communicating the second registration data from a computer system other than the computer system being registered. For example second registration data associated with the second computer system may be communicated from the fourth computer system e.g. to the third computer system e.g. . The fourth computer system e.g. may be operated by the owner of or a user associated with the second computer system e.g. in one embodiment. In one embodiment registration data may be communicated in step between the third and fourth computer systems over connection . And in one embodiment step may be performed using a security component e.g. a communication interface e.g. some combination thereof etc.

In one embodiment the registration data e.g. the first registration data accessed in step the second registration data accessed in step some combination thereof etc. may be manually input by a user. For example the registration data may be manually input using the first computer system e.g. where the first computer system may communicate the registration data to the third computer system e.g. . As another example the registration data may be manually input using the second computer system e.g. where the second computer system may communicate the registration data to the third computer system e.g. . As another example the registration data may be manually input using a fourth computer system e.g. where the fourth computer system may communicate the registration data to the third computer system e.g. . In this example the fourth computer system e.g. may be operated by the owner of or a user associated with the first computer system e.g. and or the second computer system e.g. . And as yet another example the registration data may be manually input using the third computer system e.g. .

In one embodiment step and or step may involve performing a registration of at least one computer system. For example registration of a first computer system e.g. may be performed e.g. using the third computer system or computer system in step by accessing and or communicating registration data associated with the first computer system. As another example registration of a second computer system e.g. may be performed e.g. using the third computer system or computer system in step by accessing and or communicating registration data associated with the second computer system.

As shown in step involves accessing permissions data associated with permissions for the first computer system e.g. . The permissions data may be accessed in step at the third computer system e.g. in one embodiment. And in one embodiment step may be performed using a security component e.g. a communication interface e.g. some combination thereof etc.

The permissions data accessed in step may be associated with a request to allow the first computer system to communicate with the second computer system in one embodiment. The request may be from the second computer system e.g. from another computer system or device associated therewith etc.

In one embodiment the permissions data accessed in step may be associated with an approval of access provided responsive to a request for access. For example responsive to a request for access of the first computer system e.g. to the second computer system e.g. the permissions data accessed in step may be associated with an approval of access to the second computer system e.g. by the first computer system e.g. . In one embodiment the request for access may be from the first computer system e.g. or from another computer system associated therewith while the approval of access may be from the second computer system e.g. or from another computer system associated therewith.

As shown in step involves configuring based on the permissions data permissions for the first computer system with respect to the second computer system. Configuration of permissions may be performed in step at the third computer system e.g. in one embodiment. And in one embodiment step may be performed using a security component e.g. .

For example the third computer system e.g. may configure permissions for the first computer system in step thereby allowing the first computer system to communicate with and or connect to the second computer system. In this case the permissions data e.g. used to configure permissions for the first computer system may be a request to allow the first computer system to communicate with the second computer system or alternatively the permissions data may be an approval of access e.g. to the second computer system by the first computer system provided responsive to a request for access e.g. of the first computer system to the second computer system . In this manner the third computer system e.g. may handle permissions management or access control for the first computer system e.g. the second computer system e.g. at least one other computer system etc.

The permissions data e.g. accessed in step and or used to configure permissions for the first computer system in step may be manually input by a user in one embodiment. For example the permissions data may be manually input using the third computer system e.g. . As another example the permissions data may be manually input using a fourth computer system e.g. where the fourth computer system may communicate the permissions data to the third computer system e.g. . In this example the fourth computer system e.g. may be operated by the owner of or a user associated with the second computer system e.g. . And as yet another example the permissions data may be manually input using the second computer system e.g. where the second computer system may communicate the permissions data to the third computer system e.g. .

As shown in permissions configuration data may include a correlation or mapping of at least one computer system e.g. in column that is authorized to communicate with and or connect to at least one other computer system e.g. in column . For example a first set of computer systems e.g. corresponding to the unique identifiers of cs110 cs130 and cs140 may be authorized to communicate with and or connect to at least one other computer system e.g. corresponding to the unique identifier of cs120 . As another example a second set of computer systems e.g. corresponding to the unique identifiers of cs110 and cs160 may be authorized to communicate with and or connect to at least one other computer system e.g. corresponding to the unique identifier of cs150 . And as yet another example a particular computer system e.g. corresponding to the unique identifier of cs110 may be authorized to communicate with and or connect to at least one other computer system e.g. corresponding to the unique identifier of cs170 .

In one embodiment the unique identifiers in column may be associated with target systems and the unique identifiers in column may be associated with caller systems. In this manner permissions configuration data may include a correlation or mapping of at least one caller system e.g. in column that is authorized to communicate with and or connect to at least one target system e.g. in column .

Permissions configuration data e.g. may be generated or updated as a result of permission configuration in step of process in one embodiment. For example where permission configuration data already exists for the second computer system e.g. corresponding to the unique identifier cs120 a unique identifier e.g. cs110 corresponding to the first computer system e.g. may be added in step to a list of at least one other unique identifier e.g. cs130 cs140 etc. corresponding to at least one other computer system that is authorized to communicate with and or connect to the second computer system e.g. . As another example where permission configuration data does not yet exist for the second computer system e.g. permission configuration data may be generated in step that includes a correlation or mapping between at least a first unique identifier e.g. cs110 corresponding to the first computer system e.g. and a second unique identifier e.g. cs120 corresponding to the second computer system e.g. .

Although shows permissions configuration data as including a particular amount of data it should be appreciated that a different amount of data may be included in permissions configuration data in other embodiments. Additionally although shows permissions configuration data as including a particular arrangement and type of data it should be appreciated that a different arrangement and or type of data may be included in permissions configuration data in other embodiments.

Although depicts process as including a specific number of steps it should be appreciated that process may include a different number of steps in other embodiments. Although depicts process as including a specific ordering of steps it should be appreciated that process may include a different ordering of steps in other embodiments.

Turning back to communication interface may be used to implement at least one connection e.g. etc. . Communication interface may include hardware and or software allowing at least one connection e.g. etc. to be established and allowing communication of at least one message over the at least one connection. Communication interface may allow unidirectional communication and or bidirectional communication over at least one connection e.g. etc. with at least one other computer system e.g. etc. in one embodiment. And in one embodiment communication interface may allow contemporaneous or simultaneous bidirectional communication e.g. full duplex communication over at least one connection e.g. etc. with at least one other computer system e.g. etc. .

At least one connection of system e.g. connection connection connection connection some combination thereof etc. may be or include a wired connection in one embodiment. For example at least one connection e.g. some combination thereof etc. may be or include a IEEE 1394 or FireWire connection PCI Express connection Ethernet connection SATA connection eSATA connection RS 232 connection I2C connection etc. In one embodiment at least one connection of system e.g. connection connection connection connection some combination thereof etc. may be or include a wireless connection such as a Bluetooth connection Near Field Communication NFC connection infrared IR connection IEEE 802.XX connection cellular connection etc. And in one embodiment at least one connection of system e.g. connection connection connection connection some combination thereof etc. may be or include the Internet.

In one embodiment the first computer system e.g. may be a client within system and the second computer system e.g. may be a server within system . And in one embodiment the first computer system e.g. may be the caller system within system and the second computer system e.g. may be the target system within system .

Turning back to step involves generating a first message associated with communication between the first computer system e.g. and the second computer system e.g. . For example the first message may include data associated with a request from the first computer system e.g. to communicate with and or connect to the second computer system e.g. . As another example the first message may include data associated with a request by the first computer system e.g. for a security token and or session key or at least one instance thereof from the third computer system e.g. where the security token and or session key or at least one instance thereof may relate to communication between the first and second computer systems. And in one embodiment the first message may include data associated with a target system e.g. the second computer system or computer system corresponding to the request of the first message where the data associated with the target system may be or include a unique identifier associated with the target system.

In one embodiment step may involve generating the first message at the first computer system e.g. . And in one embodiment step may be performed using a message generation component e.g. of computer system a security component e.g. of computer system some combination thereof etc.

The first message may be a CoAP message e.g. A of in one embodiment. The CoAP message e.g. A may include data associated with a request from the first computer system e.g. to communicate with and or connect to the second computer system e.g. a request by the first computer system e.g. for a security token and or session key or at least one instance thereof from the third computer system e.g. some combination thereof etc. For example the data associated with the request may be included in the CoAP message as an option associated with a query e.g. a Uri Query option with an option value of communicationrequest as depicted in .

In one embodiment the CoAP message e.g. A may include data associated with a target system e.g. a unique identifier associated with the target system corresponding to the data associated with the request. For example the data associated with the target system e.g. the second computer system or computer system may be included in the CoAP message as an option associated with a query e.g. a Uri Query option with an option value of tid cs120 as depicted in . As such where cs120 is a unique identifier associated with the second computer system e.g. the CoAP message e.g. A may indicate a request from the first computer system e.g. to communicate with the second computer system e.g. a request from the first computer system e.g. to connect to the second computer system e.g. a request from the first computer system e.g. for a security token associated with communication with the second computer system e.g. a request from the first computer system e.g. for a session key or at least one instance thereof associated with communication with the second computer system e.g. some combination thereof etc.

CoAP message A may include data associated with at least one option. For example CoAP message A may include data associated with a host e.g. an option value of www.example.com data associated with a port e.g. an option value of 5683 data associated with a path e.g. an option value of communicationrequest some combination thereof etc. In this case at least one option associated with CoAP message A may correspond to a URI of coap www.example.com 5683 communicationrequest coap www.example.com communicationrequest coaps www.example.com 5683 communicationrequest coaps www.example.com communicationrequest some combination thereof etc.

The URI corresponding to at least one option associated with CoAP message A may be specific or unique to the third computer system e.g. in one embodiment. And in one embodiment data associated with a path e.g. an option value of communicationrequest at least one other option value etc. of CoAP message A may be specific or unique to the third computer system e.g. .

As another example CoAP message A may include data associated with a max age value e.g. an option value of 0 . In this case a max age value of 0 may be used to indicate that CoAP message A is not to be cached by an intermediary system or device e.g. situated between the sender of the CoAP message A and the ultimate recipient of the CoAP message A such as a proxy server or other type of computer system or device.

As a further example CoAP message A may include data associated with a query e.g. including one or more parameters . An option value of tid cs120 e.g. associated with a first parameter may be associated with a unique identifier e.g. cs120 of a target system e.g. the second computer system or computer system . An option value of uid cs110 e.g. associated with a second parameter may be associated with a unique identifier e.g. cs110 of a sender of CoAP message A and or a caller system e.g. the first computer system or computer system . An option value of hs256 1 e.g. associated with a third parameter may be associated with an authentication mechanism e.g. HMAC utilizing a hash function of SHA256 used to generate the authentication data e.g. Authentication Data A included in CoAP message A. An option value of nonce 1 e.g. associated with a fourth parameter may be associated with a nonce e.g. with a value of 1 included in CoAP message A.

In one embodiment one or more portions of CoAP message A may be associated with a URI including at least one parameter of a query. For example CoAP message A may be associated with a URI of coap www.example.com 5683 communicationrequest tid cs120 uid cs110 hs256 1 nonce 1 coap www.example.com communicationrequest tid cs120 uid cs110 hs256 1 nonce 1 coaps www.example.com 5683 communicationrequest tid cs120 uid cs110 hs256 1 nonce 1 coaps www.example.com communicationrequest tid cs120 uid cs110 hs256 1 nonce 1 some combination thereof etc.

CoAP message A may include data associated with at least one option length. For example CoAP message A may include data associated with a first option length e.g. 15 bytes corresponding to data associated with a first option value e.g. www.example.com a second option length e.g. 2 bytes corresponding to data associated with a second option value e.g. 5683 a third option length e.g. 20 bytes corresponding to data associated with a third option value e.g. communicationrequest etc.

As shown in CoAP message A may include data associated with at least one option identifier. The at least one option identifier may include data associated with an option number and or an option delta in one embodiment. For example CoAP message A may include data associated with a first numerical value e.g. 3 as a first option identifier corresponding to a first option e.g. associated with a host where the first numerical value e.g. 3 may be the delta or difference between the current option number e.g. 3 and the option number of the preceding option e.g. 0 in this case since this is the first option . As such the first numerical value of 3 may correspond to an option number of 3. 

As another example CoAP message A may include data associated with a second numerical value e.g. 4 as a second option identifier corresponding to a second option e.g. associated with a port where the second numerical value e.g. 4 may be the delta or difference between the current option number e.g. 7 and the option number of the preceding option e.g. 3 . As such the second numerical value of 4 may correspond to an option number of 7. 

As a further example CoAP message A may include data associated with a third numerical value e.g. 4 as a third option identifier corresponding to a third option e.g. associated with a path where the third numerical value e.g. 4 may be the delta or difference between the current option number e.g. 11 and the option number of the preceding option e.g. 7 . As such the third numerical value of 4 may correspond to an option number of 11. 

As shown in CoAP message A may include data associated with a payload marker e.g. 0xFF . CoAP message A may include data associated with a payload where the data associated with a payload may include authentication data e.g. Authentication Data A .

Although shows CoAP message A with a specific number and type of portions it should be appreciated that CoAP message A may include a different number and or type of portions in other embodiments. For example CoAP message A may include fewer portions or at least one additional portion. As another example a plurality of portions of CoAP message A may be combined into a smaller number of portions. Although shows CoAP message A with a specific organization of portions it should be appreciated that CoAP message A may include a different organization of portions in other embodiments.

In one embodiment data associated with at least one option may be excluded from CoAP message A. For example data e.g. associated with a host a port a path a max age value or some combination thereof used by intermediary systems or devices e.g. situated between the sender of CoAP message A and the ultimate recipient of CoAP message A such as a proxy server or other type of computer system or device may be excluded in one or more embodiments where intermediary systems or devices do not exist or are unlikely to exist.

Turning back to the first message may include authentication data in one embodiment. In this case step may be performed in accordance with process of .

As shown in step involves accessing message data associated with communication between a caller system e.g. the first computer system or computer system and a target system e.g. the second computer system or computer system . In one embodiment step may be performed using a message generation component e.g. of computer system .

In one embodiment the message data may include data associated with a request from the caller system e.g. the first computer system or computer system to communicate with and or connect to the target system e.g. the second computer system or computer system a request by the caller system e.g. the first computer system or computer system for a security token and or session key or at least one instance thereof from the third computer system e.g. some combination thereof etc. For example where the first message is a CoAP message e.g. A the message data accessed in step may include data associated with an option e.g. a Uri Query option with an option value of communicationrequest that identifies the request.

The message data may include data associated with a target system e.g. a unique identifier associated with the target system corresponding to the request in one embodiment. For example where the first message is a CoAP message e.g. A the message data accessed in step may include data associated with an option e.g. a Uri Query option with an option value of tid cs120 that identifies the target system corresponding to the data associated with the request.

In one embodiment the message data accessed in step may include data other than authentication data. For example the message data may include data associated with a header e.g. included in portion of CoAP message data associated with a token e.g. included in portion of CoAP message data associated with at least one option e.g. included in portion of CoAP message data associated with a payload marker e.g. included in portion of CoAP message data associated with at least a portion of a payload e.g. included in portion of CoAP message data other than the authentication data e.g. Authentication Data A of CoAP message A some combination thereof etc.

As shown in step involves generating authentication data. In one embodiment step may be performed using a security component e.g. of computer system .

In one embodiment the authentication data may be generated in step using an authentication mechanism such as HMAC OAuth OAuth 2.0 OpenID etc. The authentication data may be generated in step using a key in one embodiment. For example where the authentication mechanism used to generate the authentication data in step is HMAC the authentication data may be generated by performing a hash function e.g. MD5 SHA 1 SHA256 SHA512 etc. on message data e.g. accessed in step using a key. And in one embodiment the message data may be free of the key used to generate the authentication data in step .

A key associated with the caller system e.g. the first computer system or computer system may be used to generate the authentication data in step in one embodiment. For example the key may be a secret key or private key that is unique to the caller system e.g. the first computer system or computer system . The key may be stored locally at the first computer system e.g. in one embodiment. For example the key may be stored locally in a security component e.g. of computer system in a memory e.g. of computer system in a database e.g. of computer system etc. Alternatively the key may be stored remotely e.g. at another system or device and accessed by the first computer system e.g. in a secure manner in one embodiment. Accordingly a key associated with the caller system e.g. the first computer system or computer system may be securely accessed and used by the caller system to generate the authentication data in step in one embodiment.

As shown in step involves generating a message including the message data e.g. accessed in step and the authentication data e.g. generated in step . In one embodiment step may be performed using a message generation component e.g. of computer system .

In one embodiment where the message generated in step is a CoAP message e.g. A step may involve formatting the message data e.g. accessed in step in accordance with CoAP e.g. into one or more portions of CoAP message . The authentication data e.g. generated in step may be included in or as the payload e.g. associated with portion of CoAP message of the CoAP message in one embodiment. For example as shown in authentication data e.g. Authentication Data A may be included in or as the payload of CoAP message A.

Step may involve including a payload marker as part of the message in one embodiment. For example where the message data e.g. accessed in step is free of data or content to be included as a payload e.g. and therefore is also free of a payload marker a payload marker may be included as part of the message in step since the authentication data e.g. generated in step may be included as the payload e.g. the entire payload of the message.

In one embodiment step may involve generating a bit stream or byte stream including the message data e.g. accessed in step and the authentication data e.g. generated in step . The bit stream or byte stream may be formatted in accordance with CoAP in one embodiment.

Although depicts process as including a specific number of steps it should be appreciated that process may include a different number of steps in other embodiments. Although depicts process as including a specific ordering of steps it should be appreciated that process may include a different ordering of steps in other embodiments.

Turning back to step involves communicating the first message e.g. generated in step and or in accordance with one or more steps of process of from the first computer system e.g. to a third computer system e.g. . In one embodiment the first message may be communicated in step over a connection e.g. between computer system and computer system . The first message may be communicated in step as a bit stream or a byte stream in one embodiment. And in one embodiment step may involve communicating the first message using at least one communication interface e.g. of computer system of computer system etc. .

In one embodiment step may involve communicating the first message using Datagram Transport Layer Security DTLS . For example where the first message is a CoAP message e.g. A step may involve communicating the first message over CoAP using DTLS.

As shown in step involves performing first processing associated with the first message and responsive thereto generating a second message including a first data portion associated with a security token and a second data portion including an instance of a session key. In one embodiment step may involve performing the first processing associated with the first message at the third computer system e.g. . For example responsive to receiving the first message e.g. generated in step and communicated in step the third computer system e.g. may determine whether the first computer system e.g. is authorized to communicate with and or connect to the second computer system e.g. . As another example responsive to receiving the first message e.g. generated in step and communicated in step the third computer system e.g. may perform message validation. And in one embodiment the first processing may be performed using a security component e.g. .

Determination of whether the first computer system e.g. is authorized to communicate with and or connect to the second computer system e.g. may be performed in step based on permissions configuration data e.g. of generated and or updated in step generated and or updated in step of process etc. in one embodiment. For example permissions configuration data may be accessed e.g. using data included in the first message such as a unique identifier associated with the first computer system a unique identifier associated with the second computer system etc. to determine whether the first computer system e.g. is authorized to communicate with and or connect to the second computer system e.g. . In one embodiment the permissions configuration data may be stored at the third computer system e.g. stored remotely and accessible to the third computer system e.g. etc.

Where the first message includes authentication data message validation may be performed in step based on the authentication data. For example the third computer system e.g. may generate second authentication data based on at least a portion of the first message e.g. a header a token at least one option a payload marker a payload some combination thereof etc. . The second authentication data may be compared to the authentication data e.g. included in the first message to verify the authenticity of the first computer system e.g. verify the integrity of the first message detect and or act on a replay attack some combination thereof etc.

In one embodiment the second authentication data may be generated in step using an authentication mechanism such as HMAC OAuth OAuth 2.0 OpenID etc. The second authentication data may be generated in step using a key in one embodiment. For example where the authentication mechanism used to generate the second authentication data in step is HMAC the second authentication data may be generated by performing a hash function e.g. MD5 SHA 1 SHA256 SHA512 etc. on at least a portion of the first message e.g. a header a token at least one option a payload marker a payload some combination thereof etc. using a key. And in one embodiment the first message may be free of the key used to generate the second authentication data in step .

A key associated with the first computer system e.g. may be used to generate the second authentication data in step in one embodiment. For example the key may be a secret key or private key that is unique to the first computer system e.g. . The key may be stored locally at the third computer system e.g. in one embodiment. For example the key may be stored locally in a security component e.g. of computer system in a memory e.g. of computer system in a database e.g. of computer system etc. Alternatively the key may be stored remotely e.g. at another system or device and accessed by the third computer system e.g. in a secure manner in one embodiment. Accordingly a key associated with the first computer system e.g. may be securely accessed and used by the third computer system e.g. to generate the second authentication data in step in one embodiment.

Step may involve generating the second message e.g. including a first data portion associated with a security token and a second data portion including an instance of a session key at the third computer system e.g. in one embodiment. In one embodiment the second message may be generated using a message generation component e.g. alone or in combination with at least one other component e.g. security component etc. .

The second message may be generated based on the results of the first processing in one embodiment. For example if the first computer system e.g. is authorized to communicate with and or connect to the second system e.g. and or if the first message is valid then the second message may be generated in step .

In one embodiment the first data portion of the second message may include a first instance of a session key and the second data portion of the second message may include a second instance of the session key. The session key and or a plurality of instances thereof may be generated in step at the third computer system e.g. in one embodiment. In one embodiment the session key and or a plurality of instances thereof may be generated using a security component e.g. . In one embodiment the session key may be generated in step based on a random number pseudorandom number other data some combination thereof etc. A third instance of the session key may be stored at the third computer system e.g. in one embodiment.

As shown in data portion may include portion associated with a unique identifier of a caller system e.g. the first computer system or computer system portion associated with a unique identifier of a target system e.g. the second computer system or computer system portion associated with expiration data portion associated with an instance of a session key some combination thereof etc.

In one embodiment the unique identifier of the first computer system e.g. may be included in or otherwise associated with portion and the unique identifier of the second computer system e.g. may be included in or otherwise associated with portion . In one embodiment expiration data associated with portion may include a timestamp e.g. associated with creation of the security token and or session key a duration or lifetime e.g. of the security token and or session key other data some combination thereof etc. Where the expiration data includes a timestamp the timestamp may be a UTC timestamp unix timestamp epoch timestamp another type of timestamp etc. Where the expiration data includes a duration or lifetime the duration or lifetime may include a timeout.

The duration or lifetime may be set or determined by the second computer system e.g. or another computer system associated therewith in one embodiment. For example the second computer system e.g. or another computer system associated therewith may communicate information about the duration or lifetime to the third computer system e.g. where the third computer system may access and or store the information about the duration or lifetime e.g. for generation of and or inclusion in portion .

In one embodiment portion may be associated with an instance e.g. a first instance of the session key generated by the third computer system e.g. which may correspond to at least one other instance of the session key e.g. a second instance included in the second data portion of the second message a third instance stored at the third computer system etc. . And in one embodiment the expiration data e.g. associated with portion may correspond to the instance of the session key associated with portion and or at least one other instance of the session key .

Data portion may form the security token in one embodiment. For example portion portion portion and portion may form the security token. Alternatively one or more portions of data portion may form the security token in one embodiment. For example portion portion and portion may form the security token. As another example portion portion and portion may form the security token. As yet another example another combination of portions or any one portion alone may form the security token. In this manner one or more portions of data portion may be separate from the security token in one embodiment.

Although shows data portion as including a particular amount of data it should be appreciated that a different amount of data may be included in data portion in other embodiments. Additionally although shows data portion as including a particular arrangement and type of data it should be appreciated that a different arrangement and or type of data may be included in data portion in other embodiments.

Turning back to step may involve encrypting data to generate the first data portion associated with the security token in one embodiment. The data may include a first instance of the session key and or other data e.g. associated with the security token such as a first unique identifier associated with the caller system a second unique identifier associated with the target system expiration data associated with the security token and or session key etc. . And in one embodiment the first data portion may be generated by encrypting the data in step using AES Blowfish RC4 the Extended Tiny Encryption Algorithm XTEA scheme another symmetric key algorithm etc.

In one embodiment a key associated with the second computer system e.g. may be used to encrypt the data to generate the first data portion in step . For example the key may be a secret key or private key that is unique to the second computer system e.g. . The key may be stored locally at the third computer system e.g. in one embodiment. For example the key may be stored locally in a security component e.g. of computer system in a memory e.g. of computer system in a database e.g. of computer system etc. Alternatively the key may be stored remotely e.g. at another system or device and accessed by the third computer system e.g. in a secure manner in one embodiment. Accordingly a key associated with the second computer system e.g. may be securely accessed and used by the third computer system e.g. to encrypt data to generate the first data portion in step in one embodiment.

In one embodiment step may involve encrypting data to generate the second data portion in one embodiment. The data may include a second instance of the session key. And in one embodiment the second data portion may be generated by encrypting the data in step using AES Blowfish RC4 the Extended Tiny Encryption Algorithm XTEA scheme another symmetric key algorithm etc.

In one embodiment a key associated with the first computer system e.g. may be used to encrypt the data to generate the second data portion in step . For example the key may be a secret key or private key that is unique to the first computer system e.g. . The key may be stored locally at the third computer system e.g. in one embodiment. For example the key may be stored locally in a security component e.g. of computer system in a memory e.g. of computer system in a database e.g. of computer system etc. Alternatively the key may be stored remotely e.g. at another system or device and accessed by the third computer system e.g. in a secure manner in one embodiment. Accordingly a key associated with the first computer system e.g. may be securely accessed and used by the third computer system e.g. to encrypt data to generate the second data portion in step in one embodiment.

The first data portion and or the second data portion may be included in or as the payload of the second message in step in one embodiment. And in one embodiment the first data portion and or the second data portion may be included in or as another portion of the second message in step .

Step may involve generating authentication data to be included in the second message in one embodiment. The authentication data may be generated in step at the third computer system e.g. in one embodiment. And in one embodiment the authentication data may be generated in step using a security component e.g. of computer system .

In one embodiment the authentication data may be generated in step using an authentication mechanism such as HMAC OAuth OAuth 2.0 OpenID etc. The authentication data may be generated in step using a key in one embodiment. For example where the authentication mechanism used to generate the authentication data in step is HMAC the authentication data may be generated by performing a hash function e.g. MD5 SHA 1 SHA256 SHA512 etc. on message data e.g. a header a token at least one option a payload marker a payload the first data portion associated with a security token the second data portion including an instance of a session key some combination thereof etc. using a key. And in one embodiment the message data may be free of the key used to generate the authentication data in step .

A key associated with the first computer system e.g. may be used to generate the authentication data in step in one embodiment. For example the key may be a secret key or private key that is unique to the first computer system e.g. . The key may be stored locally at the third computer system e.g. in one embodiment. For example the key may be stored locally in a security component e.g. of computer system in a memory e.g. of computer system in a database e.g. of computer system etc. Alternatively the key may be stored remotely e.g. at another system or device and accessed by the third computer system e.g. in a secure manner in one embodiment. Accordingly a key associated with the first computer system e.g. may be securely accessed and used by the third computer system e.g. to generate the authentication data in step in one embodiment.

In one embodiment the authentication data may be included in or as the payload of the second message in step . And in one embodiment the authentication data may be included in or as another portion of the second message in step .

The second message may be a CoAP message e.g. B of in one embodiment. As shown in CoAP message B may include data associated with a header where the data associated with the header includes data associated with a version e.g. 1 a message type e.g. ACK or acknowledgement a token length e.g. 1 associated with a length of 1 byte a code e.g. a response code of Content and a message identifier e.g. 0x7d34 . Data associated with a token e.g. 0x72 may also be included in CoAP message B.

CoAP message B may include data associated with at least one option. For example CoAP message B may include data associated with a max age value e.g. an option value of 0 . In this case a max age value of 0 may be used to indicate that CoAP message B is not to be cached by an intermediary system or device e.g. situated between the sender of the CoAP message B and the ultimate recipient of the CoAP message B such as a proxy server or other type of computer system or device.

As another example CoAP message B may include data associated with a query e.g. including one or more parameters . An option value of uid cs1430 e.g. associated with a first parameter may be associated with a unique identifier e.g. cs1430 of a sender of CoAP message B e.g. computer system . An option value of hs256 1 e.g. associated with a second parameter may be associated with an authentication mechanism e.g. HMAC utilizing a hash function of SHA256 used to generate the authentication data e.g. Authentication Data B included in CoAP message B. An option value of nonce 1 e.g. associated with a third parameter may be associated with a nonce e.g. with a value of 1 included in CoAP message B.

CoAP message B may include data associated with at least one option length. For example CoAP message B may include data associated with a first option length e.g. 1 byte corresponding to data associated with a first option value e.g. 0 a second option length e.g. 10 bytes corresponding to data associated with a second option value e.g. uid cs1430 a third option length e.g. 7 bytes corresponding to data associated with a third option value e.g. hs256 1 etc.

As shown in CoAP message B may include data associated with at least one option identifier. The at least one option identifier may include data associated with an option number and or an option delta in one embodiment. For example CoAP message B may include data associated with a first numerical value e.g. 14 as a first option identifier corresponding to a first option e.g. associated with a max age value where the first numerical value e.g. 14 may be the delta or difference between the current option number e.g. 14 and the option number of the preceding option e.g. 0 in this case since this is the first option . As such the first numerical value of 14 may correspond to an option number of 14. 

As another example CoAP message B may include data associated with a second numerical value e.g. 1 as a second option identifier corresponding to a second option e.g. associated with a query where the second numerical value e.g. 1 may be the delta or difference between the current option number e.g. 15 and the option number of the preceding option e.g. 14 . As such the second numerical value of 1 may correspond to an option number of 15. 

As a further example CoAP message B may include data associated with a third numerical value e.g. 0 as a third option identifier corresponding to a third option e.g. associated with a query where the third numerical value e.g. 0 may be the delta or difference between the current option number e.g. 15 and the option number of the preceding option e.g. 15 . As such the third numerical value of 0 may correspond to an option number of 15. 

As shown in CoAP message B may include data associated with a payload marker e.g. 0xFF . CoAP message B may include data associated with a payload where the data associated with a payload may include authentication data e.g. Authentication Data B and or other data. In one embodiment the other data may be or include a first data portion associated with a security token e.g. First Data Portion Associated With Security Token a second data portion including an instance of a session key e.g. Second Data Portion Including Instance Of Session Key other data some combination thereof etc.

CoAP message A and CoAP message B may share a common message identifier e.g. 0x7d34 in one embodiment. CoAP message A and CoAP message B may share a common token e.g. 0x72 in one embodiment.

In one embodiment a message type associated with CoAP message B e.g. ACK or acknowledgement may correspond to and or be determined by a message type associated with CoAP message A e.g. CON or confirmable . And in one embodiment a response code associated with CoAP message B e.g. Content may correspond to and or be determined by a method code associated with CoAP message A e.g. GET . In this case CoAP message B may include data e.g. a first data portion associated with a security token a second data portion including an instance of a session key etc. associated with the request of CoAP message A e.g. a request for data associated with a security token data associated with a session key and or at least one instance thereof etc. .

Although shows CoAP message B with a specific number and type of portions it should be appreciated that CoAP message B may include a different number and or type of portions in other embodiments. For example CoAP message B may include fewer portions or at least one additional portion. As another example a plurality of portions of CoAP message B may be combined into a smaller number of portions. Although shows CoAP message B with a specific organization of portions it should be appreciated that CoAP message B may include a different organization of portions in other embodiments.

In one embodiment data associated with at least one option may be excluded from CoAP message B. For example data e.g. associated with a host a port a path a max age value or some combination thereof used by intermediary systems or devices e.g. situated between the sender of CoAP message B and the ultimate recipient of CoAP message B such as a proxy server or other type of computer system or device may be excluded in one or more embodiments where intermediary systems or devices do not exist or are unlikely to exist.

Turning back to step may involve formatting at least one data portion e.g. a first data portion associated with a security token a second data portion including an instance of a session key etc. of the second message in accordance with JSON JavaScript Object Notation in one embodiment. Alternatively at least one data portion e.g. a first data portion associated with a security token a second data portion including an instance of a session key etc. of the second message may be formatted in step in accordance with another format e.g. UTF 8 plain text link format XML octet stream etc. . Where the second message is a CoAP message e.g. B the second message may include data associated with a content format e.g. a Content Format option with an option value corresponding to a format of a payload of CoAP message B a format of a first data portion associated with a security token a format of a second data portion including an instance of a session key etc. in one embodiment.

Step may be performed in accordance with one or more steps of process of in one embodiment. show a flowchart of process for performing processing associated with a message in accordance with one embodiment. One or more steps of process may be performed at or by a third computer system e.g. in one embodiment.

As shown in step involves receiving a message. In one embodiment the message received in step may be the message generated in step generated in step communicated in step some combination thereof etc. Step may involve receiving the message at the third computer system e.g. from another computer system e.g. another system or device etc. in one embodiment.

In one embodiment the message may be received in step over a connection e.g. . The message may be received in step as a bit stream or a byte stream in one embodiment. And in one embodiment step may involve receiving the message using a communication interface e.g. .

As shown in step involves processing the message e.g. received in step . Authentication data may be accessed from the message in step in one embodiment. A unique identifier associated with the caller system e.g. the first computer system or computer system may be accessed from the message in step in one embodiment. In one embodiment step may involve processing the message using a security component e.g. of computer system . And in one embodiment where the message is a CoAP message step may be performed in accordance with step and or one or more steps of process of .

Step involves performing message validation e.g. with respect to the message received in step . The message validation may be used to verify the authenticity of the sender of the message and or the integrity of the message. Where the message includes a nonce the message validation may be used to detect a replay attack.

In one embodiment message validation may be performed in step based on authentication data e.g. accessed from the message in step . And in one embodiment message validation may be performed in step using at least one message invalidity condition.

Where message validation is performed based on authentication data message validation may be performed in step by comparing second authentication data to the authentication data in one embodiment. For example the third computer system e.g. may generate second authentication data based on at least a portion of the message e.g. a header a token at least one option a payload marker a payload some combination thereof etc. . The second authentication data may be compared to the authentication data e.g. included in the message and or accessed in step to verify the authenticity of the sender of the message e.g. the first computer system or computer system verify the integrity of the message detect and or act on a replay attack some combination thereof etc.

In one embodiment the second authentication data may be generated in step using an authentication mechanism such as HMAC OAuth OAuth 2.0 OpenID etc. The second authentication data may be generated in step using a key in one embodiment. For example where the authentication mechanism used to generate the second authentication data in step is HMAC the second authentication data may be generated by performing a hash function e.g. MD5 SHA 1 SHA256 SHA512 etc. on at least a portion of the message e.g. a header a token at least one option a payload marker a payload some combination thereof etc. using a key. And in one embodiment the message may be free of the key used to generate the second authentication data in step .

A key associated with the caller system e.g. the first computer system or computer system may be used to generate the second authentication data in step in one embodiment. For example the key may be a secret key or private key that is unique to the caller system e.g. the first computer system or computer system . The key may be stored locally at the third computer system e.g. in one embodiment. For example the key may be stored locally in a security component e.g. of computer system in a memory e.g. of computer system in a database e.g. of computer system etc. Alternatively the key may be stored remotely e.g. at another system or device and accessed by the third computer system e.g. in a secure manner in one embodiment. Accordingly a key associated with the caller system e.g. the first computer system or computer system may be securely accessed and used by the third computer system e.g. to generate the second authentication data in step in one embodiment.

Where message validation is performed using at least one message invalidity condition the message may be determined to be invalid in step if any of the at least one message invalidity condition is triggered in one embodiment. For example the message may be determined to be invalid in step responsive to a failure to access a unique identifier associated with the sender of the message e.g. the first computer system or computer system . As another example the message may be determined to be invalid in step responsive to a failure to access a nonce from the message. As a further example the message may be determined to be invalid in step responsive to determining that a nonce accessed from the message is not different from another nonce accessed from a previous message. As yet another example the message may be determined to be invalid in step responsive to determining that a payload of the message is not at least a predetermined size. And as another example the message may be determined to be invalid in step responsive to a failure to access a key e.g. associated with the first computer system or computer system used to generate the second authentication data or otherwise perform the message validation.

The message validation may be performed in step using a security component e.g. of computer system in one embodiment. And in one embodiment where the message is a CoAP message step may be performed in accordance with step one or more steps of process of one or more steps of process of some combination thereof etc.

As shown in step involves determining whether the message e.g. received in step is valid e.g. based on the results of the message validation performed in step . Step may be performed using a security component e.g. of computer system in one embodiment. If it is determined in step that the message e.g. received in step is valid then step may be performed.

Step involves accessing from the message a unique identifier associated with a target system e.g. the second computer system or computer system . Step may be performed using a security component e.g. of computer system in one embodiment.

As shown in step involves determining whether the caller system is authorized to communicate with and or connect to the target system. The caller system may be the sender of the message e.g. the first computer system or computer system and the target system may be the system or device associated with the unique identifier accessed in step e.g. the second computer system or computer system . In one embodiment step may be performed using a security component e.g. of computer system .

Determination of whether the caller system is authorized to communicate with and or connect to the target system may be performed in step based on permissions configuration data e.g. of generated and or updated in step generated and or updated in step of process etc. in one embodiment. For example permissions configuration data may be accessed to determine whether the first computer system e.g. is authorized to communicate with and or connect to the second computer system e.g. .

In one embodiment the permissions configuration data may be accessed in step using a unique identifier associated with the target system e.g. accessed in step using a unique identifier associated with the caller system e.g. accessed from the message in step in step as part of message validation etc. some combination thereof etc. And in one embodiment the permissions configuration data may be stored at the third computer system e.g. stored remotely and accessible to the third computer system e.g. etc.

If it is determined in step that the caller system is authorized to communicate with the target system then step may be performed. As shown in step involves generating a session key. In one embodiment step may involve generating a plurality of instances of the session key.

The session key and or a plurality of instances thereof may be generated in step using a security component e.g. in one embodiment. In one embodiment the session key and or a plurality of instances thereof may be generated in step based on a random number pseudorandom number other data some combination thereof etc. And in one embodiment at least one instance of the session key may be stored at the third computer system e.g. .

In one embodiment the session key and or a plurality of instances thereof may be stored in step . For example data associated with the session key and or a plurality of instances thereof e.g. data of may be stored at the third computer system e.g. .

Each session key in column may correspond to computer systems e.g. associated with unique identifiers in columns and that are authorized to communicate with and or connect to one another e.g. responsive to configuration of permissions in step of process and or one or more steps of process of in one embodiment. For example a first session key e.g. Session Key 1 may correspond to a first computer system e.g. associated with the unique identifier of cs110 in column and a second computer system e.g. associated with the unique identifier of cs120 in column that are authorized to communicate with and or connect to one another e.g. responsive to configuration of permissions in step of process and or one or more steps of process of . As another example a second session key e.g. Session Key 2 may correspond to another computer system e.g. associated with the unique identifier of cs130 in column and the second computer system e.g. associated with the unique identifier of cs120 in column that are authorized to communicate with and or connect to one another e.g. responsive to configuration of permissions in step of process and or one or more steps of process of .

In one embodiment the unique identifiers in column may be associated with target systems and the unique identifiers in column may be associated with caller systems. In this manner data may include a correlation or mapping of at least one caller system e.g. in column that is authorized to communicate with and or connect to at least one target system e.g. in column .

At least a portion of data may correlate to and or be the same as permissions configuration data e.g. of in one embodiment. For example column may correlate to and or be the same as column of permissions configuration data . As another example column may correlate to and or be the same as column of permissions configuration data . As such in one embodiment data of column may be added to permissions configuration data e.g. responsive to generation of and or updating of a session key or at least one instance thereof .

In one embodiment data may be stored locally at the third computer system e.g. . For example data may be stored locally in a security component e.g. of computer system in a memory e.g. of computer system in a database e.g. of computer system etc. Alternatively data may be stored remotely e.g. at another system or device and accessed by the third computer system e.g. in a secure manner in one embodiment. Accordingly a session key and or at least one instance thereof may be securely accessed e.g. from or using data and included in at least one portion e.g. a first data portion associated with a security token a second data portion including an instance of a session key etc. of a message e.g. the second message generated in step of process .

Data may be changed or updated in one embodiment. For example data may be changed or updated based on expiration data e.g. associated with portion of data portion such as a timestamp e.g. associated with creation of the security token and or session key a duration or lifetime e.g. of the security token and or session key etc. In this case a portion of data associated with at least one session key may be removed from data and or updated e.g. with new data corresponding to at least one new session key responsive to expiration of the security token and or the at least one session key.

Although shows data as including a particular amount of data it should be appreciated that a different amount of data may be included in data in other embodiments. Additionally although shows data as including a particular arrangement and type of data it should be appreciated that a different arrangement and or type of data may be included in data in other embodiments.

Turning back to step involves generating a first data portion including a first instance of the session key associated with a security token. In one embodiment step may be performed using a security component e.g. alone or in combination with at least one other component e.g. message generation component etc. .

In one embodiment the first data portion generated in step may include one or more portions of data portion . For example the first data portion may include a plurality of portions of data portion e.g. portion associated with an instance of the session key and at least one other portion such as portion associated with a unique identifier of a caller system portion associated with a unique identifier of a target system portion associated with expiration data some combination thereof etc. . As another example the first data portion may include only one portion of data portion e.g. portion associated with an instance of the session key .

The first data portion may include the first instance of the session key as part of the security token in one embodiment. Alternatively the first data portion may include the first instance of the session key separate from the security token.

In one embodiment a key associated with the target system e.g. the second computer system or computer system may be used to encrypt the data to generate the first data portion in step . For example the key may be a secret key or private key that is unique to the target system e.g. the second computer system or computer system . In one embodiment the first data portion may be generated by encrypting the data in step using AES Blowfish RC4 the Extended Tiny Encryption Algorithm XTEA scheme another symmetric key algorithm etc.

Where a key is used to encrypt the data to generate the first data portion the key may be stored locally at the third computer system e.g. in one embodiment. For example the key may be stored locally in a security component e.g. of computer system in a memory e.g. of computer system in a database e.g. of computer system etc. Alternatively the key may be stored remotely e.g. at another system or device and accessed by the third computer system e.g. in a secure manner in one embodiment. Accordingly a key associated with the target system e.g. the second computer system or computer system may be securely accessed and used by the third computer system e.g. to encrypt data to generate the first data portion in step in one embodiment.

As shown in step involves generating a second data portion including a second instance of the session key. In one embodiment step may be performed using a security component e.g. alone or in combination with at least one other component e.g. message generation component etc. .

Step may involve encrypting data to generate the second data portion in one embodiment. The data may include a second instance of the session key.

In one embodiment a key associated with the caller system e.g. the first computer system or computer system may be used to encrypt the data to generate the second data portion in step . For example the key may be a secret key or private key that is unique to the caller system e.g. the first computer system or computer system . In one embodiment the second data portion may be generated by encrypting the data in step using AES Blowfish RC4 the Extended Tiny Encryption Algorithm XTEA scheme another symmetric key algorithm etc.

Where a key is used to encrypt the data to generate the second data portion the key may be stored locally at the third computer system e.g. in one embodiment. For example the key may be stored locally in a security component e.g. of computer system in a memory e.g. of computer system in a database e.g. of computer system etc. Alternatively the key may be stored remotely e.g. at another system or device and accessed by the third computer system e.g. in a secure manner in one embodiment. Accordingly a key associated with the caller system e.g. the first computer system or computer system may be securely accessed and used by the third computer system e.g. to encrypt data to generate the second data portion in step in one embodiment.

As shown in step involves accessing message data including the first data portion e.g. generated in step and the second data portion e.g. generated in step . In one embodiment step may be performed using a message generation component e.g. .

In one embodiment the message data accessed in step may include data other than authentication data. For example the message data may include data associated with a header e.g. included in portion of CoAP message data associated with a token e.g. included in portion of CoAP message data associated with at least one option e.g. included in portion of CoAP message data associated with a payload marker e.g. included in portion of CoAP message data associated with at least a portion of a payload e.g. included in portion of CoAP message data other than the authentication data e.g. Authentication Data B of CoAP message B some combination thereof etc.

As shown in step involves generating authentication data. In one embodiment step may be performed using a security component e.g. of computer system .

In one embodiment the authentication data may be generated in step using an authentication mechanism such as HMAC OAuth OAuth 2.0 OpenID etc. The authentication data may be generated in step using a key in one embodiment. For example where the authentication mechanism used to generate the authentication data in step is HMAC the authentication data may be generated by performing a hash function e.g. MD5 SHA 1 SHA256 SHA512 etc. on message data e.g. accessed in step using a key. And in one embodiment the message data may be free of the key used to generate the authentication data in step .

A key associated with the caller system e.g. the first computer system or computer system may be used to generate the authentication data in step in one embodiment. For example the key may be a secret key or private key that is unique to the caller system e.g. the first computer system or computer system . The key may be stored locally at the third computer system e.g. in one embodiment. For example the key may be stored locally in a security component e.g. of computer system in a memory e.g. of computer system in a database e.g. of computer system etc. Alternatively the key may be stored remotely e.g. at another system or device and accessed by the third computer system e.g. in a secure manner in one embodiment. Accordingly a key associated with the caller system e.g. the first computer system or computer system may be securely accessed and used by the third computer system e.g. to generate the authentication data in step in one embodiment.

As shown in step involves generating a message including the message data e.g. accessed in step and the authentication data e.g. generated in step . In one embodiment step may be performed using a message generation component e.g. of computer system .

In one embodiment where the message generated in step is a CoAP message e.g. B step may involve formatting the message data e.g. accessed in step in accordance with CoAP e.g. into one or more portions of CoAP message . The authentication data e.g. generated in step may be included in or as the payload e.g. associated with portion of CoAP message of the CoAP message in one embodiment. For example as shown in authentication data e.g. Authentication Data B may be included in or as the payload of CoAP message B.

The first data portion e.g. generated in step and or the second data portion e.g. generated in step may be included in or as the payload of the message e.g. generated in step in one embodiment. For example as shown in the first data portion e.g. First Data Portion Associated With Security Token and or the second data portion e.g. Second Data Portion Including Instance Of Session Key may be included in or as the payload of CoAP message B in step . And in one embodiment the first data portion and or the second data portion may be included in or as another portion of the message in step .

Step may involve generating a bit stream or byte stream including the message data e.g. accessed in step and the authentication data e.g. generated in step in one embodiment. The bit stream or byte stream may be formatted in accordance with CoAP in one embodiment.

In one embodiment step may involve formatting at least one data portion e.g. a first data portion associated with a security token a second data portion including an instance of a session key etc. of the message in accordance with JSON JavaScript Object Notation . Alternatively at least one data portion e.g. a first data portion associated with a security token a second data portion including an instance of a session key etc. of the message may be formatted in step in accordance with another format e.g. UTF 8 plain text link format XML octet stream etc. . Where the message generated in step is a CoAP message e.g. B the message may include data associated with a content format e.g. a Content Format option with an option value corresponding to a format of a payload of CoAP message B a format of a first data portion associated with a security token a format of a second data portion including an instance of a session key etc. in one embodiment.

Turning back to step involves performing at least one operation associated with the message. In one embodiment the at least one operation may be performed in step if the message e.g. received in step is determined to be invalid in step . And in one embodiment the at least one operation may be performed in step if it is determined that the caller system e.g. the first computer system or computer system is not authorized to communicate with and or connect to the target system e.g. the second computer system or computer system in step . And in one embodiment step may involve performing at least one operation using an operation component e.g. of computer system .

In one embodiment step may involve acting responsive to a message validation failure such as a triggering of a message invalidity condition e.g. corresponding to one or more steps of process a failure to access a unique identifier associated with the sender of the message a failure to access a nonce from the message determining that a nonce accessed from the message is not different from another nonce accessed from a previous message determining that a payload of the message is not at least a predetermined size a failure to access a key used to generate the second authentication data or otherwise perform the message validation some combination thereof etc. another message validation failure e.g. determining that the second authentication data generated based on at least a portion of the message does not correlate to authentication data accessed from the message another message validation failure etc. etc. And in one embodiment step may involve acting on a suspected or detected replay attack.

The at least one operation performed in step may include ignoring the message e.g. received in step in one embodiment. For example another message may not be generated and or communicated in reply to the message e.g. received in step in step . As another example no further processing related to the message e.g. received in step may be performed in step . And in one embodiment the at least one operation performed in step may include limiting access to the recipient e.g. the third computer system or computer system of the sender e.g. the first computer system or computer system .

Although depict process as including a specific number of steps it should be appreciated that process may include a different number of steps in other embodiments. Although depict process as including a specific ordering of steps it should be appreciated that process may include a different ordering of steps in other embodiments. For example steps and may be performed after steps and in one embodiment.

Turning back to step involves communicating the second message e.g. generated in step and or in accordance with one or more steps of process of from the third computer system e.g. to the first computer system e.g. . In one embodiment the second message may be communicated in step over a connection e.g. between computer system and computer system . The second message may be communicated in step as a bit stream or a byte stream in one embodiment. And in one embodiment step may involve communicating the second message using at least one communication interface e.g. of computer system of computer system etc. .

In one embodiment step may involve communicating the second message using DTLS. For example where the second message is a CoAP message e.g. B step may involve communicating the second message over CoAP using DTLS.

As shown in step involves performing second processing associated with the second message and responsive thereto accessing an instance of the session key from the second message. In one embodiment step may involve performing the second processing associated with the second message at the first computer system e.g. . For example responsive to receiving the second message e.g. generated in step and communicated in step the first computer system e.g. may perform the second processing. And in one embodiment the second processing may be performed using a security component e.g. .

The second processing may involve performing message validation with respect to the second message in one embodiment. Message validation may be performed in step based on authentication data accessed from the second message in one embodiment. For example the first computer system e.g. may generate second authentication data based on at least a portion of the second message e.g. a header a token at least one option a payload marker a payload the first data portion associated with a security token the second data portion including an instance of a session key some combination thereof etc. . The second authentication data may be compared to the authentication data e.g. included in the second message to verify the authenticity of the third computer system e.g. verify the integrity of the second message detect and or act on a replay attack some combination thereof etc.

In one embodiment the second authentication data may be generated in step using an authentication mechanism such as HMAC OAuth OAuth 2.0 OpenID etc. The second authentication data may be generated in step using a key in one embodiment. For example where the authentication mechanism used to generate the second authentication data in step is HMAC the second authentication data may be generated by performing a hash function e.g. MD5 SHA 1 SHA256 SHA512 etc. on at least a portion of the second message e.g. a header a token at least one option a payload marker a payload the first data portion associated with a security token the second data portion including an instance of a session key some combination thereof etc. using a key. And in one embodiment the second message may be free of the key used to generate the second authentication data in step .

A key associated with the first computer system e.g. may be used to generate the second authentication data in step in one embodiment. For example the key may be a secret key or private key that is unique to the first computer system e.g. . The key may be stored locally at the first computer system e.g. in one embodiment. For example the key may be stored locally in a security component e.g. of computer system in a memory e.g. of computer system in a database e.g. of computer system etc. Alternatively the key may be stored remotely e.g. at another system or device and accessed by the first computer system e.g. in a secure manner in one embodiment. Accordingly a key associated with the first computer system e.g. may be securely accessed and used by the first computer system e.g. to generate the second authentication data in step in one embodiment.

In one embodiment the session key or an instance thereof may be accessed from the second message in step based on the results of the second processing. For example where the second processing includes performing message validation the session key or an instance thereof may be accessed in step if the second message is valid. In one embodiment the session key or an instance thereof may be accessed in step from the second data portion e.g. including an instance of the session key generated in step generated in step some combination thereof etc. of the second message.

Accessing the instance of the session key in step may involve decrypting the second data portion e.g. including an instance of the session key generated in step generated in step some combination thereof etc. of the second message in one embodiment. The second data portion of the second message may be decrypted in step using AES Blowfish RC4 the Extended Tiny Encryption Algorithm XTEA scheme another symmetric key algorithm etc.

In one embodiment a key associated with the first computer system e.g. may be used to decrypt the second data portion e.g. including an instance of the session key generated in step generated in step some combination thereof etc. of the second message in step . The key may be a secret key or private key that is unique to the first computer system e.g. in one embodiment. The key may be stored locally at the first computer system e.g. in one embodiment. For example the key may be stored locally in a security component e.g. of computer system in a memory e.g. of computer system in a database e.g. of computer system etc. Alternatively the key may be stored remotely e.g. at another system or device and accessed by the first computer system e.g. in a secure manner in one embodiment. Accordingly in one embodiment a key associated with the first computer system e.g. may be securely accessed and used by the first computer system e.g. to decrypt the second data portion to access an instance of the session key in step .

The key used to decrypt e.g. in step the second data portion of the second message at the first computer system e.g. may be the same key used to encrypt e.g. in step in step etc. data to form the second data portion at the third computer system e.g. in one embodiment. For example where a key associated with the first computer system e.g. a secret key or private key that is unique to the first computer system is used by the third computer system to encrypt the data to form the second data portion of the second message e.g. in step in step etc. the same key associated with the first computer system may be used by the first computer system to decrypt the second data portion e.g. in step . In this manner a symmetric key algorithm may be used to secure a session key or at least one instance thereof communicated using one or more messages.

In one embodiment step may be performed in accordance with one or more steps of process of . shows a flowchart of process for performing processing associated with a message in accordance with one embodiment. One or more steps of process may be performed at or by a caller system e.g. the first computer system or computer system in one embodiment.

As shown in step involves receiving a message. In one embodiment the message received in step may be the message generated in step generated in step communicated in step some combination thereof etc. Step may involve receiving the message at the caller system e.g. the first computer system or computer system from another computer system e.g. another system or device etc. in one embodiment.

In one embodiment the message may be received in step over a connection e.g. . The message may be received in step as a bit stream or a byte stream in one embodiment. And in one embodiment step may involve receiving the message using a communication interface e.g. .

As shown in step involves processing the message e.g. received in step . Authentication data may be accessed from the message in step in one embodiment. In one embodiment step may involve processing the message using a security component e.g. of computer system . And in one embodiment where the message is a CoAP message step may be performed in accordance with step and or one or more steps of process of .

Step involves performing message validation e.g. with respect to the message received in step . The message validation may be used to verify the authenticity of the sender of the message and or the integrity of the message. Where the message includes a nonce the message validation may be used to detect a replay attack.

In one embodiment message validation may be performed in step based on authentication data e.g. accessed from the message in step . And in one embodiment message validation may be performed in step using at least one message invalidity condition.

Where message validation is performed based on authentication data message validation may be performed in step by comparing second authentication data to the authentication data in one embodiment. For example the caller system e.g. the first computer system or computer system may generate second authentication data based on at least a portion of the message e.g. a header a token at least one option a payload marker a payload a first data portion associated with a security token a second data portion including an instance of a session key some combination thereof etc. . The second authentication data may be compared to the authentication data e.g. included in the message and or accessed in step to verify the authenticity of the sender of the message e.g. the third computer system or computer system verify the integrity of the message detect and or act on a replay attack some combination thereof etc.

In one embodiment the second authentication data may be generated in step using an authentication mechanism such as HMAC OAuth OAuth 2.0 OpenID etc. The second authentication data may be generated in step using a key in one embodiment. For example where the authentication mechanism used to generate the second authentication data in step is HMAC the second authentication data may be generated by performing a hash function e.g. MD5 SHA 1 SHA256 SHA512 etc. on at least a portion of the message e.g. a header a token at least one option a payload marker a payload a first data portion associated with a security token a second data portion including an instance of a session key some combination thereof etc. using a key. And in one embodiment the message may be free of the key used to generate the second authentication data in step .

A key associated with the caller system e.g. the first computer system or computer system may be used to generate the second authentication data in step in one embodiment. For example the key may be a secret key or private key that is unique to the caller system e.g. the first computer system or computer system . The key may be stored locally at the first computer system e.g. in one embodiment. For example the key may be stored locally in a security component e.g. of computer system in a memory e.g. of computer system in a database e.g. of computer system etc. Alternatively the key may be stored remotely e.g. at another system or device and accessed by the first computer system e.g. in a secure manner in one embodiment. Accordingly a key associated with the caller system e.g. the first computer system or computer system may be securely accessed and used by the caller system to generate the second authentication data in step in one embodiment.

Where message validation is performed using at least one message invalidity condition the message may be determined to be invalid in step if any of the at least one message invalidity condition is triggered in one embodiment. For example the message may be determined to be invalid in step responsive to a failure to access a unique identifier associated with the sender of the message e.g. the third computer system or computer system . As another example the message may be determined to be invalid in step responsive to a failure to access a nonce from the message. As a further example the message may be determined to be invalid in step responsive to determining that a nonce accessed from the message is not different from another nonce accessed from a previous message. As yet another example the message may be determined to be invalid in step responsive to determining that a payload of the message is not at least a predetermined size. And as another example the message may be determined to be invalid in step responsive to a failure to access a key e.g. associated with the caller system used to generate the second authentication data or otherwise perform the message validation.

The message validation may be performed in step using a security component e.g. of computer system in one embodiment. And in one embodiment where the message is a CoAP message step may be performed in accordance with step one or more steps of process of one or more steps of process of some combination thereof etc.

As shown in step involves determining whether the message e.g. received in step is valid e.g. based on the results of the message validation performed in step . Step may be performed using a security component e.g. of computer system in one embodiment. If it is determined in step that the message e.g. received in step is valid then step may be performed.

Step involves accessing a data portion from the message e.g. received in step . The data portion may include an instance of a session key. For example the data portion accessed in step may be or include the second data portion generated in step and or step . And in one embodiment the data portion accessed in step may be encrypted e.g. ciphertext .

As shown in step involves decrypting the data portion e.g. accessed in step to access an instance of a session key. Decryption of the data portion in step may involve generating a plaintext version or unencrypted version of the data portion where the plaintext version or unencrypted version of the data portion may include the instance of the session key. Step may be performed using a security component e.g. of computer system in one embodiment. The data portion may be decrypted in step using AES Blowfish RC4 the Extended Tiny Encryption Algorithm XTEA scheme another symmetric key algorithm etc.

In one embodiment the data portion e.g. accessed in step may be decrypted in step using a key associated with the caller system e.g. the first computer system or computer system . The key may be a secret key or private key that is unique to the first computer system e.g. in one embodiment. The key may be stored locally at the first computer system e.g. in one embodiment. For example the key may be stored locally in a security component e.g. of computer system in a memory e.g. of computer system in a database e.g. of computer system etc. Alternatively the key may be stored remotely e.g. at another system or device and accessed by the first computer system e.g. in a secure manner in one embodiment. Accordingly a key associated with the caller system e.g. the first computer system or computer system may be securely accessed and used by the caller system in step to decrypt the data portion e.g. accessed in step to access the instance of the session key in one embodiment.

As shown in step involves storing the instance of the session key e.g. accessed in step . In one embodiment the instance of the session key may be stored locally at a caller system e.g. the first computer system or computer system in step . For example the instance of the session key may be stored locally in a security component e.g. of computer system in a memory e.g. of computer system in a database e.g. of computer system etc. Alternatively the instance of the session key may be stored remotely e.g. at another system or device in step such that the instance of the session key may be accessed by a caller system e.g. the first computer system or computer system in a secure manner in one embodiment. And in one embodiment the instance of the session key may be stored in step as data of .

At least a portion of data may correlate to and or be the same as permissions configuration data e.g. of in one embodiment. For example the first row of column of data may correlate to and or be the same as the first row of permissions configuration data e.g. including the unique identifier of cs120 in column and the unique identifier of cs110 in column . As another example the second row of column of data may correlate to and or be the same as the fourth row of permissions configuration data e.g. including the unique identifier of cs150 in column and the unique identifier of cs in column . And as yet another example the third row of column of data may correlate to and or be the same as the sixth row of permissions configuration data e.g. including the unique identifier of cs170 in column and the unique identifier of cs110 in column .

In one embodiment data may be stored locally at a caller system e.g. the first computer system or computer system . For example data may be stored locally in a security component e.g. of computer system in a memory e.g. of computer system in a database e.g. of computer system etc. Alternatively data may be stored remotely e.g. at another system or device and accessed by a caller system e.g. the first computer system or computer system in a secure manner in one embodiment.

Data may be changed or updated in one embodiment. For example data may be changed or updated based on expiration data e.g. associated with portion of data portion such as a timestamp e.g. associated with creation of the security token and or session key a duration or lifetime e.g. of the security token and or session key etc. In this case a portion of data associated with at least one session key may be removed from data and or updated e.g. with new data corresponding to at least one new session key responsive to expiration of the security token and or the at least one session key.

Although shows data as including a particular amount of data it should be appreciated that a different amount of data may be included in data in other embodiments. Additionally although shows data as including a particular arrangement and type of data it should be appreciated that a different arrangement and or type of data may be included in data in other embodiments.

Turning back to step involves performing at least one operation associated with the message. In one embodiment step may be performed if the message e.g. received in step is determined to be invalid in step . And in one embodiment step may involve performing at least one operation using an operation component e.g. of computer system .

In one embodiment step may involve acting responsive to a message validation failure such as a triggering of a message invalidity condition e.g. corresponding to one or more steps of process a failure to access a unique identifier associated with the sender of the message a failure to access a nonce from the message determining that a nonce accessed from the message is not different from another nonce accessed from a previous message determining that a payload of the message is not at least a predetermined size a failure to access a key used to generate the second authentication data or otherwise perform the message validation some combination thereof etc. another message validation failure e.g. determining that the second authentication data generated based on at least a portion of the message does not correlate to authentication data accessed from the message another message validation failure etc. etc. And in one embodiment step may involve acting on a suspected or detected replay attack.

The at least one operation performed in step may include ignoring the message e.g. received in step in one embodiment. For example another message may not be generated and or communicated in reply to the message e.g. received in step in step . As another example no further processing related to the message e.g. received in step may be performed in step . And in one embodiment the at least one operation performed in step may include limiting access to the recipient e.g. the first computer system or computer system of the sender e.g. the third computer system or computer system .

Although depicts process as including a specific number of steps it should be appreciated that process may include a different number of steps in other embodiments. Although depicts process as including a specific ordering of steps it should be appreciated that process may include a different ordering of steps in other embodiments.

Turning back to step involves generating at the first computer system e.g. a third message including the first data portion e.g. associated with a security token including an instance of the session key including at least a portion of data portion generated in step generated in step some combination thereof etc. . In one embodiment the third message may be generated using a message generation component e.g. alone or in combination with at least one other component e.g. security component etc. .

In one embodiment the third message may be generated e.g. in step without decrypting the first data portion. For example the first data portion may be accessed from the second message as ciphertext and included in the third message e.g. as ciphertext without decryption of the first data portion e.g. at the first computer system .

The third message may be generated in step based on the results of the second processing e.g. performed in step in one embodiment. For example if the second message is valid then the third message may be generated in step .

In one embodiment the first data portion may be included in or as the payload of the third message in step . And in one embodiment the first data portion may be included in or as another portion of the third message in step .

Step may involve generating authentication data to be included in the third message in one embodiment. The authentication data may be generated in step at the first computer system e.g. in one embodiment. And in one embodiment the authentication data may be generated in step using a security component e.g. of computer system .

In one embodiment the authentication data may be generated in step using an authentication mechanism such as HMAC OAuth OAuth 2.0 OpenID etc. The authentication data may be generated in step using a key in one embodiment. For example where the authentication mechanism used to generate the authentication data in step is HMAC the authentication data may be generated by performing a hash function e.g. MD5 SHA 1 SHA256 SHA512 etc. on message data e.g. a header a token at least one option a payload marker a payload the first data portion associated with a security token some combination thereof etc. using a key. And in one embodiment the message data may be free of the key used to generate the authentication data in step .

An instance of the session key e.g. accessed and or stored in step accessed in step stored in step etc. may be used to generate the authentication data in step in one embodiment. The instance of the session key may be stored locally at the first computer system e.g. in one embodiment. For example the instance of the session key may be stored locally in a security component e.g. of computer system in a memory e.g. of computer system in a database e.g. of computer system etc. Alternatively the instance of the session key may be stored remotely e.g. at another system or device and accessed by the first computer system e.g. in a secure manner in one embodiment. Accordingly an instance of the session key may be securely accessed and used by the first computer system e.g. to generate the authentication data in step in one embodiment.

In one embodiment the authentication data may be included in or as the payload of the third message in step . And in one embodiment the authentication data may be included in or as another portion of the third message in step .

The third message may be a CoAP message e.g. A of in one embodiment. As shown in CoAP message A may include data associated with a header where the data associated with the header includes data associated with a version e.g. 1 a message type e.g. CON or confirmable a token length e.g. 1 associated with a length of 1 byte a code e.g. a method code of GET and a message identifier e.g. 0x7a10 . Data associated with a token e.g. 0x73 may also be included in CoAP message A.

CoAP message A may include data associated with at least one option. For example CoAP message A may include data associated with a host e.g. an option value of www.example.com data associated with a port e.g. an option value of 5683 data associated with a path e.g. an option value of keytransfer some combination thereof etc. In this case at least one option associated with CoAP message A may correspond to a URI of coap www.example.com 5683 keytransfer coap www.example.com keytransfer coaps www.example.com 5683 keytransfer coaps www.example.com keytransfer some combination thereof etc.

The URI corresponding to at least one option associated with CoAP message A may be specific or unique to a target system e.g. the second computer system or computer system in one embodiment. And in one embodiment at least one option e.g. corresponding to an option value of keytransfer corresponding to at least one other option value etc. associated with CoAP message A may be specific or unique to a target system e.g. the second computer system or computer system .

As another example CoAP message A may include data associated with a max age value e.g. an option value of 0 . In this case a max age value of 0 may be used to indicate that CoAP message A is not to be cached by an intermediary system or device e.g. situated between the sender of the CoAP message A and the ultimate recipient of the CoAP message A such as a proxy server or other type of computer system or device.

As a further example CoAP message A may include data associated with a query e.g. including one or more parameters . An option value of uid cs110 e.g. associated with a first parameter may be associated with a unique identifier e.g. cs110 of a sender of CoAP message A and or a caller system e.g. the first computer system or computer system . An option value of hs256 1 e.g. associated with a second parameter may be associated with an authentication mechanism e.g. HMAC utilizing a hash function of SHA256 used to generate the authentication data e.g. Authentication Data C included in CoAP message A. An option value of nonce 1 e.g. associated with a third parameter may be associated with a nonce e.g. with a value of 1 included in CoAP message A.

In one embodiment one or more portions of CoAP message A may be associated with a URI including at least one parameter of a query. For example CoAP message A may be associated with a URI of coap www.example.com 5683 keytransfer uid cs110 hs256 1 nonce 1 coap www.example.com keytransfer uid cs110 hs256 1 nonce 1 coaps www.example.com 5683 keytransfer uid cs110 hs256 1 nonce 1 coaps www.example.com keytransfer uid cs110 hs256 1 nonce 1 some combination thereof etc.

CoAP message A may include data associated with at least one option length. For example CoAP message A may include data associated with a first option length e.g. 15 bytes corresponding to data associated with a first option value e.g. www.example.com a second option length e.g. 2 bytes corresponding to data associated with a second option value e.g. 5683 a third option length e.g. 11 bytes corresponding to data associated with a third option value e.g. keytransfer etc.

As shown in CoAP message A may include data associated with at least one option identifier. The at least one option identifier may include data associated with an option number and or an option delta in one embodiment. For example CoAP message A may include data associated with a first numerical value e.g. 3 as a first option identifier corresponding to a first option e.g. associated with a host where the first numerical value e.g. 3 may be the delta or difference between the current option number e.g. 3 and the option number of the preceding option e.g. 0 in this case since this is the first option . As such the first numerical value of 3 may correspond to an option number of 3. 

As another example CoAP message A may include data associated with a second numerical value e.g. 4 as a second option identifier corresponding to a second option e.g. associated with a port where the second numerical value e.g. 4 may be the delta or difference between the current option number e.g. 7 and the option number of the preceding option e.g. 3 . As such the second numerical value of 4 may correspond to an option number of 7. 

As a further example CoAP message A may include data associated with a third numerical value e.g. 4 as a third option identifier corresponding to a third option e.g. associated with a path where the third numerical value e.g. 4 may be the delta or difference between the current option number e.g. 11 and the option number of the preceding option e.g. 7 . As such the third numerical value of 4 may correspond to an option number of 11. 

As shown in CoAP message A may include data associated with a payload marker e.g. 0xFF . CoAP message A may include data associated with a payload where the data associated with a payload may include authentication data e.g. Authentication Data C and or other data. In one embodiment the other data may be or include the first data portion e.g. associated with a security token including an instance of the session key including at least a portion of data portion generated in step generated in step some combination thereof etc. of the second message e.g. Data Portion Associated With Security Token .

Although shows CoAP message A with a specific number and type of portions it should be appreciated that CoAP message A may include a different number and or type of portions in other embodiments. For example CoAP message A may include fewer portions or at least one additional portion. As another example a plurality of portions of CoAP message A may be combined into a smaller number of portions. Although shows CoAP message A with a specific organization of portions it should be appreciated that CoAP message A may include a different organization of portions in other embodiments.

CoAP message A may be free of authentication data e.g. Authentication Data C in one embodiment. Where CoAP message A is free of authentication data CoAP message A may also be free of data associated with a max age value. Where CoAP message A is free of authentication data CoAP message A may be free of data associated with one or more query parameters. For example CoAP message A may be free of a query parameter associated with a unique identifier of a sender of CoAP message A and or a caller system a query parameter associated with an authentication mechanism used to generate authentication data a query parameter associated with a nonce some combination thereof etc.

In one embodiment data associated with at least one option may be excluded from CoAP message A. For example data e.g. associated with a host a port a path a max age value or some combination thereof used by intermediary systems or devices e.g. situated between the sender of CoAP message A and the ultimate recipient of CoAP message A such as a proxy server or other type of computer system or device may be excluded in one or more embodiments where intermediary systems or devices do not exist or are unlikely to exist.

Turning back to step may involve formatting at least one data portion e.g. a data portion associated with a security token of the third message in accordance with JSON JavaScript Object Notation in one embodiment. Alternatively at least one data portion e.g. a data portion associated with a security token of the third message may be formatted in step in accordance with another format e.g. UTF 8 plain text link format XML octet stream etc. . Where the third message is a CoAP message e.g. A the third message may include data associated with a content format e.g. a Content Format option with an option value corresponding to a format of a payload of CoAP message A a format of a data portion associated with a security token etc. in one embodiment.

Step may be performed in accordance with one or more steps of process of in one embodiment. shows a flowchart of process for generating a message including a data portion associated with a security token in accordance with one embodiment. One or more steps of process may be performed at or by a caller system e.g. the first computer system or computer system in one embodiment.

As shown in step involves accessing message data including a data portion associated with a security token. In one embodiment the data portion accessed in step e.g. as at least part of the message data may be or include the first data portion e.g. associated with a security token including an instance of the session key including at least a portion of data portion generated in step generated in step some combination thereof etc. of the second message e.g. received in step step etc. . Step may involve accessing the data portion as ciphertext without decryption of the data portion in one embodiment. And in one embodiment step may be performed using a message generation component e.g. .

In one embodiment the message data accessed in step may include data other than authentication data. For example the message data may include data associated with a header e.g. included in portion of CoAP message data associated with a token e.g. included in portion of CoAP message data associated with at least one option e.g. included in portion of CoAP message data associated with a payload marker e.g. included in portion of CoAP message data associated with at least a portion of a payload e.g. included in portion of CoAP message data other than the authentication data e.g. Authentication Data C of CoAP message A some combination thereof etc.

As shown in step involves optionally generating authentication data. In one embodiment step may be performed using a security component e.g. of computer system .

In one embodiment the authentication data may be generated in step using an authentication mechanism such as HMAC OAuth OAuth 2.0 OpenID etc. The authentication data may be generated in step using a key in one embodiment. For example where the authentication mechanism used to generate the authentication data in step is HMAC the authentication data may be generated by performing a hash function e.g. MD5 SHA 1 SHA256 SHA512 etc. on message data e.g. accessed in step using a key. And in one embodiment the message data may be free of the key used to generate the authentication data in step .

An instance of a session key e.g. accessed and or stored in step accessed in step stored in step etc. may be used to generate the authentication data in step in one embodiment. The instance of the session key may be stored locally at a caller system e.g. the first computer system or computer system in one embodiment. For example the instance of the session key may be stored locally in a security component e.g. of computer system in a memory e.g. of computer system in a database e.g. of computer system etc. Alternatively the instance of the session key may be stored remotely e.g. at another system or device and accessed by a caller system e.g. the first computer system or computer system in a secure manner in one embodiment. Accordingly an instance of the session key may be securely accessed and used by a caller system e.g. the first computer system or computer system to generate the authentication data in step in one embodiment.

As shown in step involves generating a message including the message data e.g. accessed in step . In one embodiment step may involve generating a message including the message data e.g. accessed in step and the authentication data e.g. generated in step . In one embodiment step may be performed using a message generation component e.g. of computer system .

In one embodiment where the message generated in step is a CoAP message e.g. A step may involve formatting the message data e.g. accessed in step in accordance with CoAP e.g. into one or more portions of CoAP message . The authentication data e.g. generated in step may be included in or as the payload e.g. associated with portion of CoAP message of the CoAP message in one embodiment. For example as shown in authentication data e.g. Authentication Data C may be included in or as the payload of CoAP message A.

Step may involve including the data portion associated with a security token e.g. accessed in step as at least part of the message data in or as the payload of the message in one embodiment. For example as shown in a data portion associated with a security token e.g. Data Portion Associated With Security Token may be included in or as the payload of CoAP message A in step . And in one embodiment a data portion associated with a security token e.g. Data Portion Associated With Security Token may be included in or as another portion of the message in step .

In one embodiment the message may be generated e.g. in step without decrypting the data portion associated with a security token e.g. accessed in step as at least part of the message data . For example where the data portion e.g. associated with a security token is accessed e.g. from the message received in step as ciphertext the data portion may be included in the message e.g. as ciphertext without decryption of the data portion in step .

Step may involve generating a bit stream or byte stream including the message data e.g. accessed in step in one embodiment. In one embodiment step may involve generating a bit stream or byte stream including the message data e.g. accessed in step and the authentication data e.g. generated in step . The bit stream or byte stream may be formatted in accordance with CoAP in one embodiment.

In one embodiment step may involve formatting at least one data portion e.g. a data portion associated with a security token of the message in accordance with JSON JavaScript Object Notation . Alternatively at least one data portion e.g. a data portion associated with a security token of the message may be formatted in step in accordance with another format e.g. UTF 8 plain text link format XML octet stream etc. . Where the message generated in step is a CoAP message e.g. A the message may include data associated with a content format e.g. a Content Format option with an option value corresponding to a format of a payload of CoAP message A a format of a data portion associated with a security token etc. in one embodiment.

Although depicts process as including a specific number of steps it should be appreciated that process may include a different number of steps in other embodiments. Although depicts process as including a specific ordering of steps it should be appreciated that process may include a different ordering of steps in other embodiments.

As shown in step involves communicating the third message e.g. generated in step and or in accordance with one or more steps of process of from the first computer system e.g. to the second computer system e.g. . In one embodiment the third message may be communicated in step over a connection e.g. between computer system and computer system . The third message may be communicated in step as a bit stream or a byte stream in one embodiment. And in one embodiment step may involve communicating the third message using at least one communication interface e.g. of computer system of computer system etc. .

In one embodiment step may involve communicating the third message using DTLS. For example where the third message is a CoAP message e.g. A step may involve communicating the third message over CoAP using DTLS.

Step involves performing third processing associated with the third message and responsive thereto accessing an instance of the session key from the third message. In one embodiment step may involve performing the third processing associated with the third message at the second computer system e.g. . For example responsive to receiving the third message e.g. communicated in step the second computer system e.g. may perform the third processing. And in one embodiment the third processing may be performed using a security component e.g. .

In one embodiment the third processing may involve determining whether a first unique identifier associated with a caller system e.g. the first computer system or computer system correlates to a second unique identifier associated with the caller system. The first unique identifier associated with the caller system may be accessed from a data portion e.g. associated with a security token including an instance of the session key including at least a portion of data portion generated in step generated in step some combination thereof etc. of the third message. For example the first unique identifier associated with the caller system may be accessed from a portion of the data portion associated with the caller system e.g. portion of data portion . The second unique identifier associated with the caller system e.g. the first computer system or computer system may be accessed from a portion of the third message other than the data portion. For example where the data portion is included in a payload of the third message the second unique identifier may be accessed from a portion of the third message other than the payload. As another example where the third message is a CoAP message e.g. A the second unique identifier may be accessed from data associated with an option e.g. a Uri Query option with an option value of uid cs110 .

The third processing may involve determining whether a third unique identifier associated with the target system e.g. the second computer system or computer system correlates to a fourth unique identifier associated with registration of the target system. The third unique identifier associated with the target system may be accessed from a data portion e.g. associated with a security token including an instance of the session key including at least a portion of data portion generated in step generated in step some combination thereof etc. of the third message. The fourth unique identifier associated with registration of the target system may correspond to registration data e.g. accessed in step of process associated with the target system in one embodiment. For example the fourth unique identifier or data correlating thereto may be provided by the target system e.g. the second computer system or computer system or another computer system associated therewith to the third computer system e.g. as part of registering the target system with the third computer system.

In one embodiment the third processing may involve determining whether a security token e.g. associated with a data portion of the third message and or a session key e.g. corresponding to an instance of the session key included in the data portion of the third message is valid. In one embodiment expiration data e.g. portion of data portion may be used to determine whether the security token and or session key is valid. For example a timestamp e.g. associated with creation of the security token and or session key and a duration or lifetime e.g. of the security token and or session key may be used to determine an expiration time of the security token and or session key where the expiration time may be compared to a current time to determine if the security token and or session key is valid e.g. not expired . In one embodiment the expiration data may be accessed from a data portion e.g. associated with a security token including an instance of the session key including at least a portion of data portion generated in step generated in step some combination thereof etc. of the third message.

The session key or an instance thereof may be accessed from the third message in step based on the results of the third processing in one embodiment. For example where the third processing includes evaluating at least one condition associated with the third message e.g. whether a first unique identifier associated with the first computer system correlates to a second unique identifier associated with the first computer system whether a third unique identifier associated with the second computer system correlates to a fourth unique identifier associated with the second computer system whether the security token and or session key is valid some combination thereof etc. the session key or an instance thereof may be accessed in step if the at least one condition is met. In one embodiment the session key or an instance thereof may be accessed in step from a data portion e.g. associated with a security token including an instance of the session key including at least a portion of data portion generated in step generated in step some combination thereof etc. of the third message.

In one embodiment accessing the instance of the session key in step may involve decrypting a data portion e.g. associated with a security token including an instance of the session key including at least a portion of data portion generated in step generated in step some combination thereof etc. of the third message to access the instance of the session key. The data portion of the third message may be decrypted in step using AES Blowfish RC4 the Extended Tiny Encryption Algorithm XTEA scheme another symmetric key algorithm etc.

In one embodiment a key associated with the second computer system e.g. may be used to decrypt the data portion of the third message in step . The key may be a secret key or private key that is unique to the second computer system e.g. in one embodiment. The key may be stored locally at the second computer system e.g. in one embodiment. For example the key may be stored locally in a security component e.g. of computer system in a memory e.g. of computer system in a database e.g. of computer system etc. Alternatively the key may be stored remotely e.g. at another system or device and accessed by the second computer system e.g. in a secure manner in one embodiment. Accordingly in one embodiment a key associated with the second computer system e.g. may be securely accessed and used by the second computer system e.g. to decrypt a data portion e.g. associated with a security token including an instance of the session key including at least a portion of data portion generated in step generated in step some combination thereof etc. of the third message to access the instance of the session key in step .

The key used to decrypt e.g. in step the data portion of the third message at the second computer system e.g. may be the same key used to encrypt e.g. in step in step etc. data to form the first data portion e.g. included in the second message at the third computer system e.g. in one embodiment. For example where a key associated with the second computer system e.g. a secret key or private key that is unique to the second computer system is used by the third computer system to encrypt the data to form the first data portion of the second message e.g. in step in step etc. the same key associated with the second computer system may be used by the second computer system to decrypt the data portion of the third message e.g. in step . In this manner a symmetric key algorithm may be used to secure a data portion e.g. associated with a security token including an instance of the session key including at least a portion of data portion generated in step generated in step some combination thereof etc. communicated using one or more messages.

In one embodiment step may be performed in accordance with one or more steps of process of . show a flowchart of process for performing processing associated with a message in accordance with one embodiment. One or more steps of process may be performed at or by a target system e.g. the second computer system or computer system in one embodiment.

As shown in step involves receiving a message. In one embodiment the message received in step may be the message generated in step generated in step communicated in step some combination thereof etc. Step may involve receiving the message at the target system e.g. the second computer system or computer system from another computer system e.g. another system or device etc. in one embodiment.

In one embodiment the message may be received in step over a connection e.g. . The message may be received in step as a bit stream or a byte stream in one embodiment. And in one embodiment step may involve receiving the message using a communication interface e.g. .

As shown in step involves accessing from the message e.g. received in step a data portion associated with a security token. In one embodiment the data portion accessed in step may include an instance of the session key include at least a portion of data portion be generated in step be generated in step some combination thereof etc. And in one embodiment step may be performed using a security component e.g. .

Step involves decrypting the data portion e.g. accessed in step . Decryption of the data portion in step may involve generating a plaintext version or unencrypted version of the data portion. Step may be performed using a security component e.g. of computer system in one embodiment. The data portion may be decrypted in step using AES Blowfish RC4 the Extended Tiny Encryption Algorithm XTEA scheme another symmetric key algorithm etc.

In one embodiment the data portion e.g. accessed in step may be decrypted in step using a key associated with the target system e.g. the second computer system or computer system . For example the key may be a secret key or private key that is unique to the second computer system e.g. . The key may be stored locally at the second computer system e.g. in one embodiment. For example the key may be stored locally in a security component e.g. of computer system in a memory e.g. of computer system in a database e.g. of computer system etc. Alternatively the key may be stored remotely e.g. at another system or device and accessed by the second computer system e.g. in a secure manner in one embodiment. Accordingly a key associated with the target system e.g. the second computer system or computer system may be securely accessed and used by the target system in step to decrypt the data portion e.g. accessed in step in one embodiment.

As shown in step involves accessing from the data portion e.g. accessed in step a first unique identifier associated with a caller system e.g. the first computer system or computer system . Step may be performed using a security component e.g. of computer system in one embodiment. In one embodiment step may involve accessing the first unique identifier from a plaintext version or unencrypted version of the data portion e.g. generated responsive to decryption of the data portion in step . And in one embodiment the first unique identifier may be accessed in step from a portion of the data portion associated with the caller system e.g. portion of data portion .

Step involves accessing from a portion of the message e.g. received in step other than the data portion e.g. accessed in step a second unique identifier associated with the caller system e.g. the first computer system or computer system . For example where the data portion e.g. accessed in step is included in a payload of the message the second unique identifier may be accessed in step from a portion of the message other than the payload. As another example where the message is a CoAP message e.g. A the second unique identifier may be accessed in step from data associated with an option e.g. a Uri Query option with an option value of uid cs110 . In one embodiment step may be performed using a security component e.g. of computer system .

As shown in step involves determining whether the first unique identifier e.g. accessed in step correlates to the second unique identifier e.g. accessed in step . In one embodiment step may be performed using a security component e.g. of computer system . If the first unique identifier correlates to the second unique identifier then step may be performed.

Step involves accessing from the data portion e.g. accessed in step a third unique identifier associated with a target system e.g. the second computer system or computer system . Step may be performed using a security component e.g. of computer system in one embodiment. In one embodiment step may involve accessing the third unique identifier from a plaintext version or unencrypted version of the data portion e.g. generated responsive to decryption of the data portion in step . And in one embodiment the third unique identifier may be accessed in step from a portion of the data portion associated with the target system e.g. portion of data portion .

As shown in step involves accessing a fourth unique identifier associated with registration of the target system e.g. the second computer system or computer system . The fourth unique identifier associated with registration of the target system may correspond to registration data e.g. accessed in step of process associated with the target system in one embodiment. For example the fourth unique identifier or data correlating thereto may be provided by the target system e.g. the second computer system or computer system or another computer system associated therewith to the third computer system e.g. as part of registering the target system with the third computer system.

Step may involve accessing the fourth unique identifier locally from a component of the target system e.g. security component a memory of computer system a database of computer system etc. remotely from another system or device accessible to the target system from the third computer system e.g. etc. In one embodiment step may be performed using a security component e.g. of computer system .

As shown in step involves determining whether the third unique identifier e.g. accessed in step correlates to the fourth unique identifier e.g. accessed in step . In one embodiment step may be performed using a security component e.g. of computer system . If the third unique identifier correlates to the fourth unique identifier then step may be performed.

Step involves accessing from the data portion e.g. accessed in step expiration data. In one embodiment step may be performed using a security component e.g. of computer system . And in one embodiment the expiration data may be accessed in step from a portion of the data portion associated with expiration data e.g. portion of data portion .

In one embodiment the expiration data may be associated with a security token e.g. associated with the data portion accessed in step and or a session key e.g. corresponding to an instance of a session key included in the data portion accessed in step . In one embodiment the expiration data may include a timestamp e.g. associated with creation of the security token and or session key a duration or lifetime e.g. of the security token and or session key other data some combination thereof etc. Where the expiration data includes a timestamp the timestamp may be a UTC timestamp unix timestamp epoch timestamp another type of timestamp etc. Where the expiration data includes a duration or lifetime the duration or lifetime may include a timeout.

The duration or lifetime may be set or determined by the target system e.g. the second computer system or computer system or another computer system associated therewith in one embodiment. For example the target system e.g. the second computer system or computer system or another computer system associated therewith may communicate information about the duration or lifetime to the third computer system e.g. where the third computer system may access and or store the information about the duration or lifetime e.g. for generation of and or inclusion in portion .

As shown in step involves determining whether the security token and or session key are valid. In one embodiment step may be performed using a security component e.g. of computer system . In one embodiment step may involve determining whether the security token and or session key are valid based on the expiration data e.g. accessed in step . If the security token and or session key are determined to be valid in step then step may be performed.

Step involves accessing from the data portion e.g. accessed in step an instance of a session key. In one embodiment step may be performed using a security component e.g. of computer system . And in one embodiment the instance of the session key may be accessed in step from a portion of the data portion associated with an instance of a session key e.g. portion of data portion .

As shown in step involves storing the instance of the session key e.g. accessed in step . In one embodiment the instance of the session key may be stored locally at a target system e.g. the second computer system or computer system in step . For example the instance of the session key may be stored locally in a security component e.g. of computer system in a memory e.g. of computer system in a database e.g. of computer system etc. Alternatively the instance of the session key may be stored remotely e.g. at another system or device in step such that the instance of the session key may be accessed by a target system e.g. the second computer system or computer system in a secure manner in one embodiment. And in one embodiment the instance of the session key may be stored in step as data of .

At least a portion of data may correlate to and or be the same as permissions configuration data e.g. of in one embodiment. For example the first row of column of data may correlate to and or be the same as the first row of permissions configuration data e.g. including the unique identifier of cs120 in column and the unique identifier of cs110 in column . As another example the second row of column of data may correlate to and or be the same as the second row of permissions configuration data e.g. including the unique identifier of cs120 in column and the unique identifier of cs130 in column . And as yet another example the third row of column of data may correlate to and or be the same as the third row of permissions configuration data e.g. including the unique identifier of cs120 in column and the unique identifier of cs140 in column .

In one embodiment data may be stored locally at a target system e.g. the second computer system or computer system . For example data may be stored locally in a security component e.g. of computer system in a memory e.g. of computer system in a database e.g. of computer system etc. Alternatively data may be stored remotely e.g. at another system or device and accessed by a target system e.g. the second computer system or computer system in a secure manner in one embodiment.

Data may be changed or updated in one embodiment. For example data may be changed or updated based on expiration data e.g. associated with portion of data portion such as a timestamp e.g. associated with creation of the security token and or session key a duration or lifetime e.g. of the security token and or session key etc. In this case a portion of data associated with at least one session key may be removed from data and or updated e.g. with new data corresponding to at least one new session key responsive to expiration of the security token and or the at least one session key.

Although shows data as including a particular amount of data it should be appreciated that a different amount of data may be included in data in other embodiments. Additionally although shows data as including a particular arrangement and type of data it should be appreciated that a different arrangement and or type of data may be included in data in other embodiments.

Turning back to step involves performing at least one operation associated with the message. In one embodiment step may be performed if it is determined in step that the first unique identifier does not correlate to the second unique identifier. In one embodiment step may be performed if it is determined in step that the third unique identifier does not correlate to the fourth unique identifier. And in one embodiment step may be performed if it is determined in step that the security token and or the session key are invalid e.g. expired . And in one embodiment step may involve performing at least one operation using an operation component e.g. of computer system .

The at least one operation performed in step may include ignoring the message e.g. received in step in one embodiment. For example another message may not be generated and or communicated in reply to the message e.g. received in step in step . As another example no further processing related to the message e.g. received in step may be performed in step . And in one embodiment the at least one operation performed in step may include limiting access to the recipient e.g. the second computer system or computer system of the sender e.g. the first computer system or computer system .

Although depict process as including a specific number of steps it should be appreciated that process may include a different number of steps in other embodiments. Although depict process as including a specific ordering of steps it should be appreciated that process may include a different ordering of steps in other embodiments.

Turning back to step involves optionally performing message validation with respect to the third message e.g. communicated in step . In one embodiment step may be performed if the third message includes authentication data whereas step may be bypassed or omitted if the third message does not include authentication data. In one embodiment step may be performed at the second computer system e.g. . In one embodiment the message validation may be performed in step using a security component e.g. . And in one embodiment step may be performed in accordance with one or more steps of process of .

As shown in step involves processing a message. In one embodiment the message processed in step may be the message generated in step generated in step communicated in step received in step some combination thereof etc. Processing of the message in step may involve accessing authentication data from the message in one embodiment. In one embodiment step may involve processing the message using a security component e.g. of computer system . And in one embodiment where the message is a CoAP message step may be performed in accordance with step and or one or more steps of process of .

Step involves performing message validation e.g. with respect to the message processed in step . The message validation may be used to verify the authenticity of the sender of the message and or the integrity of the message. Where the message includes a nonce the message validation may be used to detect a replay attack.

In one embodiment message validation may be performed in step based on authentication data e.g. accessed from the message in step . And in one embodiment message validation may be performed in step using at least one message invalidity condition.

Where message validation is performed based on authentication data message validation may be performed in step by comparing second authentication data to the authentication data in one embodiment. For example the target system e.g. the second computer system or computer system may generate second authentication data based on at least a portion of the message e.g. a header a token at least one option a payload marker a payload a data portion associated with a security token some combination thereof etc. . The second authentication data may be compared to the authentication data e.g. included in the message and or accessed in step to verify the authenticity of the sender of the message e.g. the first computer system or computer system verify the integrity of the message detect and or act on a replay attack some combination thereof etc.

In one embodiment the second authentication data may be generated in step using an authentication mechanism such as HMAC OAuth OAuth 2.0 OpenID etc. The second authentication data may be generated in step using a key in one embodiment. For example where the authentication mechanism used to generate the second authentication data in step is HMAC the second authentication data may be generated by performing a hash function e.g. MD5 SHA 1 SHA256 SHA512 etc. on at least a portion of the message e.g. a header a token at least one option a payload marker a payload a data portion associated with a security token some combination thereof etc. using a key. And in one embodiment the message may be free of the key used to generate the second authentication data in step .

An instance of a session key e.g. accessed and or stored in step accessed in step stored in step etc. may be used to generate the second authentication data in step in one embodiment. The instance of the session key may be stored locally at a target system e.g. the second computer system or computer system in one embodiment. For example the instance of the session key may be stored locally in a security component e.g. of computer system in a memory e.g. of computer system in a database e.g. of computer system etc. Alternatively the instance of the session key may be stored remotely e.g. at another system or device and accessed by a target system e.g. the second computer system or computer system in a secure manner in one embodiment. Accordingly an instance of a session key may be securely accessed and used by a target system e.g. the second computer system or computer system to generate the second authentication data in step in one embodiment.

Where message validation is performed using at least one message invalidity condition the message may be determined to be invalid in step if any of the at least one message invalidity condition is triggered in one embodiment. For example the message may be determined to be invalid in step responsive to a failure to access a unique identifier associated with the sender of the message e.g. the first computer system or computer system . As another example the message may be determined to be invalid in step responsive to a failure to access a nonce from the message. As a further example the message may be determined to be invalid in step responsive to determining that a nonce accessed from the message is not different from another nonce accessed from a previous message. As yet another example the message may be determined to be invalid in step responsive to determining that a payload of the message is not at least a predetermined size. And as another example the message may be determined to be invalid in step responsive to a failure to access a key e.g. an instance of the session key used to generate the second authentication data or otherwise perform the message validation.

The message validation may be performed in step using a security component e.g. of computer system in one embodiment. And in one embodiment where the message is a CoAP message step may be performed in accordance with step one or more steps of process of one or more steps of process of some combination thereof etc.

As shown in step involves determining whether the message e.g. processed in step is valid e.g. based on the results of the message validation performed in step . Step may be performed using a security component e.g. of computer system in one embodiment. If it is determined in step that the message e.g. processed in step is valid then step may be performed.

Step involves performing at least one operation associated with the message e.g. processed in step . In one embodiment step may involve performing at least one operation associated with communication between the caller system e.g. the first computer system or computer system and the target system e.g. the second computer system or computer system . And in one embodiment step may involve performing one or more steps of process e.g. step step step step another step of process some combination thereof etc. .

Alternatively if it is determined in step that the message e.g. processed in step is not valid then at least one other operation associated with the message may be performed in step .

In one embodiment step may involve acting responsive to a message validation failure such as a triggering of a message invalidity condition e.g. corresponding to one or more steps of process a failure to access a unique identifier associated with the sender of the message a failure to access a nonce from the message determining that a nonce accessed from the message is not different from another nonce accessed from a previous message determining that a payload of the message is not at least a predetermined size a failure to access a key used to generate the second authentication data or otherwise perform the message validation some combination thereof etc. another message validation failure e.g. determining that the second authentication data generated based on at least a portion of the message does not correlate to authentication data accessed from the message another message validation failure etc. etc. And in one embodiment step may involve acting on a suspected or detected replay attack.

The at least one other operation performed in step may include ignoring the message e.g. processed in step in one embodiment. For example another message may not be generated and or communicated in reply to the message e.g. processed in step in step . As another example no further processing related to the message e.g. processed in step may be performed in step . And in one embodiment the at least one other operation performed in step may include limiting access to the recipient e.g. the second computer system or computer system of the sender e.g. the first computer system or computer system .

In one embodiment where step is performed before the storing of an instance of a session key e.g. in step of process the at least one other operation performed in step may involve deleting destroying and or taking no further action with respect to the instance of the session key e.g. accessed in step . In this case step may be bypassed or omitted.

Although depicts process as including a specific number of steps it should be appreciated that process may include a different number of steps in other embodiments. Although depicts process as including a specific ordering of steps it should be appreciated that process may include a different ordering of steps in other embodiments.

Turning back to step involves optionally generating at the second computer system e.g. a fourth message associated with an indication of successful access of the session key from the third message e.g. in step in step etc. . In one embodiment the fourth message may be generated using a message generation component e.g. alone or in combination with at least one other component e.g. security component etc. .

In one embodiment the third message may be generated in step based on the results of the third processing e.g. performed in step and or the results of the optional message validation performed with respect to the third message e.g. in step . For example if at least one condition associated with the third message is met and or if the third message is valid then the fourth message may be generated in step .

In one embodiment data associated with an indication of successful access of the session key may be included in or as the payload of the fourth message in step . And in one embodiment data associated with an indication of successful access of the session key may be included in or as another portion of the fourth message in step .

Step may involve generating authentication data to be included in the fourth message in one embodiment. And in one embodiment the authentication data may be generated in step using a security component e.g. of computer system .

In one embodiment the authentication data may be generated in step using an authentication mechanism such as HMAC OAuth OAuth 2.0 OpenID etc. The authentication data may be generated in step using a key in one embodiment. For example where the authentication mechanism used to generate the authentication data in step is HMAC the authentication data may be generated by performing a hash function e.g. MD5 SHA 1 SHA256 SHA512 etc. on message data e.g. a header a token at least one option a payload marker a payload data associated with an indication of successful access of the session key some combination thereof etc. using a key. And in one embodiment the message data may be free of the key used to generate the authentication data in step .

An instance of the session key e.g. accessed and or stored in step accessed in step stored in step etc. may be used to generate the authentication data in step in one embodiment. The instance of the session key may be stored locally at the second computer system e.g. in one embodiment. For example the instance of the session key may be stored locally in a security component e.g. of computer system in a memory e.g. of computer system in a database e.g. of computer system etc. Alternatively the instance of the session key may be stored remotely e.g. at another system or device and accessed by the second computer system e.g. in a secure manner in one embodiment. Accordingly an instance of the session key may be securely accessed and used by the second computer system e.g. to generate the authentication data in step in one embodiment.

In one embodiment the authentication data may be included in or as the payload of the fourth message in step . And in one embodiment the authentication data may be included in or as another portion of the fourth message in step .

The fourth message may be a CoAP message e.g. B of in one embodiment. As shown in CoAP message B may include data associated with a header where the data associated with the header includes data associated with a version e.g. 1 a message type e.g. ACK or acknowledgement a token length e.g. 1 associated with a length of 1 byte a code e.g. a response code of Content and a message identifier e.g. 0x7a10 . Data associated with a token e.g. 0x73 may also be included in CoAP message B.

CoAP message B may include data associated with at least one option. For example CoAP message B may include data associated with a max age value e.g. an option value of 0 . In this case a max age value of 0 may be used to indicate that CoAP message B is not to be cached by an intermediary system or device e.g. situated between the sender of the CoAP message B and the ultimate recipient of the CoAP message B such as a proxy server or other type of computer system or device.

As another example CoAP message B may include data associated with a query e.g. including one or more parameters . An option value of uid cs120 e.g. associated with a first parameter may be associated with a unique identifier e.g. cs120 of a sender of CoAP message B e.g. computer system . An option value of hs256 1 e.g. associated with a second parameter may be associated with an authentication mechanism e.g. HMAC utilizing a hash function of SHA256 used to generate the authentication data e.g. Authentication Data D included in CoAP message B. An option value of nonce 1 e.g. associated with a third parameter may be associated with a nonce e.g. with a value of 1 included in CoAP message B.

CoAP message B may include data associated with at least one option length. For example CoAP message B may include data associated with a first option length e.g. 1 byte corresponding to data associated with a first option value e.g. 0 a second option length e.g. 9 bytes corresponding to data associated with a second option value e.g. uid cs120 a third option length e.g. 7 bytes corresponding to data associated with a third option value e.g. hs256 1 etc.

As shown in CoAP message B may include data associated with at least one option identifier. The at least one option identifier may include data associated with an option number and or an option delta in one embodiment. For example CoAP message B may include data associated with a first numerical value e.g. 14 as a first option identifier corresponding to a first option e.g. associated with a max age value where the first numerical value e.g. 14 may be the delta or difference between the current option number e.g. 14 and the option number of the preceding option e.g. 0 in this case since this is the first option . As such the first numerical value of 14 may correspond to an option number of 14. 

As another example CoAP message B may include data associated with a second numerical value e.g. 1 as a second option identifier corresponding to a second option e.g. associated with a query where the second numerical value e.g. 1 may be the delta or difference between the current option number e.g. 15 and the option number of the preceding option e.g. 14 . As such the second numerical value of 1 may correspond to an option number of 15. 

As a further example CoAP message B may include data associated with a third numerical value e.g. 0 as a third option identifier corresponding to a third option e.g. associated with a query where the third numerical value e.g. 0 may be the delta or difference between the current option number e.g. 15 and the option number of the preceding option e.g. 15 . As such the third numerical value of 0 may correspond to an option number of 15. 

As shown in CoAP message B may include data associated with a payload marker e.g. 0xFF . CoAP message B may include data associated with a payload where the data associated with a payload may include authentication data e.g. Authentication Data D and or other data. In one embodiment the other data may include data associated with an indication of successful access of the session key e.g. depicted in as the data or content of Key Transfer Successful .

CoAP message A and CoAP message B may share a common message identifier e.g. 0x7a10 in one embodiment. CoAP message A and CoAP message B may share a common token e.g. 0x73 in one embodiment.

In one embodiment a message type associated with CoAP message B e.g. ACK or acknowledgement may correspond to and or be determined by a message type associated with CoAP message A e.g. CON or confirmable . And in one embodiment a response code associated with CoAP message B e.g. Content may correspond to and or be determined by a method code associated with CoAP message A e.g. GET . In this case CoAP message B may include data associated with the request of CoAP message A e.g. data associated with an indication of successful access of the session key .

Although shows CoAP message B with a specific number and type of portions it should be appreciated that CoAP message B may include a different number and or type of portions in other embodiments. For example CoAP message B may include fewer portions or at least one additional portion. As another example a plurality of portions of CoAP message B may be combined into a smaller number of portions. Although shows CoAP message B with a specific organization of portions it should be appreciated that CoAP message B may include a different organization of portions in other embodiments.

CoAP message B may be free of authentication data e.g. Authentication Data D in one embodiment. Where CoAP message B is free of authentication data CoAP message B may also be free of data associated with a max age value. Where CoAP message B is free of authentication data CoAP message B may be free of data associated with one or more query parameters. For example CoAP message B may be free of a query parameter associated with a unique identifier of a sender of CoAP message B and or a target system a query parameter associated with an authentication mechanism used to generate authentication data a query parameter associated with a nonce some combination thereof etc.

In one embodiment data associated with at least one option may be excluded from CoAP message B. For example data e.g. associated with a host a port a path a max age value or some combination thereof used by intermediary systems or devices e.g. situated between the sender of CoAP message B and the ultimate recipient of CoAP message B such as a proxy server or other type of computer system or device may be excluded in one or more embodiments where intermediary systems or devices do not exist or are unlikely to exist.

Turning back to step may be performed in accordance with one or more steps of process of in one embodiment. shows a flowchart of process for generating a message associated with successful access of a session key in accordance with one embodiment. In one embodiment one or more steps of process may be performed at or by a target system e.g. the second computer system or computer system .

As shown in step involves accessing message data including data associated with an indication of successful access of the session key. In one embodiment step may be performed using a message generation component e.g. .

In one embodiment the message data accessed in step may include data other than authentication data. For example the message data may include data associated with a header e.g. included in portion of CoAP message data associated with a token e.g. included in portion of CoAP message data associated with at least one option e.g. included in portion of CoAP message data associated with a payload marker e.g. included in portion of CoAP message data associated with at least a portion of a payload e.g. included in portion of CoAP message data other than the authentication data e.g. Authentication Data D of CoAP message B some combination thereof etc.

As shown in step involves optionally generating authentication data. In one embodiment step may be performed using a security component e.g. of computer system .

In one embodiment the authentication data may be generated in step using an authentication mechanism such as HMAC OAuth OAuth 2.0 OpenID etc. The authentication data may be generated in step using a key in one embodiment. For example where the authentication mechanism used to generate the authentication data in step is HMAC the authentication data may be generated by performing a hash function e.g. MD5 SHA 1 SHA256 SHA512 etc. on message data e.g. accessed in step using a key. And in one embodiment the message data may be free of the key used to generate the authentication data in step .

An instance of a session key e.g. accessed and or stored in step accessed in step stored in step etc. may be used to generate the authentication data in step in one embodiment. The instance of the session key may be stored locally at a target system e.g. the second computer system or computer system in one embodiment. For example the instance of the session key may be stored locally in a security component e.g. of computer system in a memory e.g. of computer system in a database e.g. of computer system etc. Alternatively the instance of the session key may be stored remotely e.g. at another system or device and accessed by a target system e.g. the second computer system or computer system in a secure manner in one embodiment. Accordingly an instance of the session key may be securely accessed and used by a target system e.g. the second computer system or computer system to generate the authentication data in step in one embodiment.

As shown in step involves generating a message including the message data e.g. accessed in step . In one embodiment step may involve generating a message including the message data e.g. accessed in step and the authentication data e.g. generated in step . In one embodiment step may be performed using a message generation component e.g. of computer system .

In one embodiment where the message generated in step is a CoAP message e.g. B step may involve formatting the message data e.g. accessed in step in accordance with CoAP e.g. into one or more portions of CoAP message . The authentication data e.g. generated in step may be included in or as the payload e.g. associated with portion of CoAP message of the CoAP message in one embodiment. For example as shown in authentication data e.g. Authentication Data D may be included in or as the payload of CoAP message B.

Step may involve including the data associated with an indication of successful access of the session key e.g. accessed in step as at least part of the message data in or as the payload of the message in one embodiment. For example as shown in data associated with an indication of successful access of the session key e.g. the data or content of Key Transfer Successful may be included in or as the payload of CoAP message B in step . And in one embodiment data associated with an indication of successful access of the session key e.g. the data or content of Key Transfer Successful may be included in or as another portion of the message in step .

In one embodiment step may involve generating a bit stream or byte stream including the message data e.g. accessed in step . In one embodiment step may involve generating a bit stream or byte stream including the message data e.g. accessed in step and the authentication data e.g. generated in step . The bit stream or byte stream may be formatted in accordance with CoAP in one embodiment.

Although depicts process as including a specific number of steps it should be appreciated that process may include a different number of steps in other embodiments. Although depicts process as including a specific ordering of steps it should be appreciated that process may include a different ordering of steps in other embodiments.

Turning back to step involves optionally communicating the fourth message e.g. generated in step and or in accordance with one or more steps of process of from the second computer system e.g. to the first computer system e.g. . In one embodiment the fourth message may be communicated in step over a connection e.g. between computer system and computer system . The fourth message may be communicated in step as a bit stream or a byte stream in one embodiment. And in one embodiment step may involve communicating the fourth message using at least one communication interface e.g. of computer system of computer system etc. .

In one embodiment step may involve communicating the fourth message using DTLS. For example where the fourth message is a CoAP message e.g. B step may involve communicating the fourth message over CoAP using DTLS.

Step involves optionally performing fourth processing associated with the fourth message. In one embodiment step may involve performing the fourth processing associated with the fourth message at the first computer system e.g. . For example responsive to receiving the fourth message e.g. communicated in step the first computer system e.g. may perform the fourth processing. And in one embodiment the fourth processing may be performed using a security component e.g. .

Where the fourth message includes authentication data the fourth processing may involve performing message validation with respect to the fourth message in one embodiment. Message validation may be performed in step based on authentication data accessed from the fourth message in one embodiment. For example the first computer system e.g. may generate second authentication data based on at least a portion of the fourth message e.g. a header a token at least one option a payload marker a payload etc. . The second authentication data may be compared to the authentication data e.g. included in the fourth message to verify the authenticity of the second computer system e.g. verify the integrity of the fourth message detect and or act on a replay attack some combination thereof etc.

In one embodiment the second authentication data may be generated in step using an authentication mechanism such as HMAC OAuth OAuth 2.0 OpenID etc. The second authentication data may be generated in step using a key in one embodiment. For example where the authentication mechanism used to generate the second authentication data in step is HMAC the second authentication data may be generated by performing a hash function e.g. MD5 SHA 1 SHA256 SHA512 etc. on at least a portion of the fourth message e.g. a header a token at least one option a payload marker a payload some combination thereof etc. using a key. And in one embodiment the fourth message may be free of the key used to generate the second authentication data in step .

An instance of the session key e.g. accessed and or stored in step accessed in step stored in step etc. may be used to generate the second authentication data in step in one embodiment. The instance of the session key may be stored locally at the first computer system e.g. in one embodiment. For example the instance of the session key may be stored locally in a security component e.g. of computer system in a memory e.g. of computer system in a database e.g. of computer system etc. Alternatively the instance of the session key may be stored remotely e.g. at another system or device and accessed by the first computer system e.g. in a secure manner in one embodiment. Accordingly an instance of the session key may be securely accessed and used by the first computer system e.g. to generate the second authentication data in step in one embodiment.

In one embodiment step may be performed in accordance with one or more steps of process . In this case the one or more steps of process may be performed at or by a caller system e.g. the first computer system or computer system .

For example the fourth message may be processed e.g. in accordance with step in step . Message validation may be performed in step e.g. in accordance with step where the message validation may be performed based on authentication data e.g. included in the fourth message in one embodiment. If the fourth message is determined to be valid e.g. in accordance with step then at least one operation associated with the fourth message may be performed in step e.g. in accordance with step . Alternatively if the fourth message is determined to be invalid e.g. in accordance with step then at least one other operation associated with the fourth message may be performed in step e.g. in accordance with step .

As shown in step involves increasing the security of communications between the first and second computer systems using the session key. In one embodiment a respective instance of the session key may be used in step at each of the first and second computer systems to increase communication security. For example an instance of the session key e.g. accessed and or stored in step accessed in step stored in step etc. may be used at the first computer system e.g. whereas another instance of the session key e.g. accessed and or stored in step accessed in step stored in step etc. may be used at the second computer system e.g. .

In one embodiment communication security may be increased in step by using at least one instance of the session key to generate authentication data and or perform message validation based thereon. For example the first computer system e.g. may access and use an instance of the session key e.g. accessed and or stored in step accessed in step stored in step etc. to generate authentication data to be included in a message. Responsive to receiving the message the second computer system e.g. may use another instance of the session key e.g. accessed and or stored in step accessed in step stored in step etc. to perform message validation with respect to the message. In one embodiment message validation may be performed e.g. by the second computer system with respect to the message by generating second authentication data based on the message using the another instance of the session key and determining if the second authentication data correlates to authentication data accessed from the message. In this manner communication security may be increased by allowing the second computer system to verify the authenticity of the sender of the message e.g. the first computer system verify the integrity of the message detect and or act on a replay attack some combination thereof etc.

As another example the second computer system e.g. may access and use an instance of the session key e.g. accessed and or stored in step accessed in step stored in step etc. to generate authentication data to be included in a message. Responsive to receiving the message the first computer system e.g. may use another instance of the session key e.g. accessed and or stored in step accessed in step stored in step etc. to perform message validation with respect to the message. In one embodiment message validation may be performed e.g. by the first computer system with respect to the message by generating second authentication data based on the message using the another instance of the session key and determining if the second authentication data correlates to authentication data accessed from the message. In this manner communication security may be increased by allowing the first computer system to verify the authenticity of the sender of the message e.g. the second computer system verify the integrity of the message detect and or act on a replay attack some combination thereof etc.

Communication security may be increased in step by using at least one instance of the session key to encrypt and or decrypt at least a respective portion of one or more messages communicated between the first and second computer systems in one embodiment. For example at least a portion of a message generated by the first computer system e.g. may be encrypted using the an instance of the session key e.g. accessed and or stored in step accessed in step stored in step etc. and responsive to receiving the message the encrypted data may be decrypted by the second computer system e.g. using another instance of the session key e.g. accessed and or stored in step accessed in step stored in step etc. . As another example at least a portion of a message generated by the second computer system e.g. may be encrypted using the an instance of the session key e.g. accessed and or stored in step accessed in step stored in step etc. and responsive to receiving the message the encrypted data may be decrypted by the first computer system e.g. using another instance of the session key e.g. accessed and or stored in step accessed in step stored in step etc. . In one embodiment encryption and or decryption in step of at least a respective portion of one or more messages communicated between the first and second computer systems may be performed using AES Blowfish RC4 the Extended Tiny Encryption Algorithm XTEA scheme another symmetric key algorithm etc.

In one embodiment at least a portion of a message encrypted and or decrypted using the session key or at least one instance thereof in step may be the payload of the message. The portion of a message encrypted and or decrypted using the session key or at least one instance thereof in step may include authentication data generated using the session key or at least one instance thereof in one embodiment. And in one embodiment the portion of a message encrypted and or decrypted using the session key or at least one instance thereof in step may be free of authentication data e.g. generated using the session key or at least one instance thereof .

Step may involve communicating at least one message using DTLS in one embodiment. For example where the at least one message is a CoAP message e.g. A B etc. step may involve communicating the at least one message over CoAP using DTLS.

Where the session key or at least one instance thereof is generated by and or communicated from a third computer system e.g. the third computer system may be used to perform one or more operations on behalf of the second computer system e.g. . For example the third computer system e.g. may determine whether the first computer system e.g. is authorized to communicate with the second computer system e.g. verify the authenticity of the first computer system e.g. verify message integrity detect and or act on a replay attack some combination thereof etc. In this manner the third computer system e.g. may act as an intermediary or broker to assist the second computer system e.g. thereby increasing communication security.

In addition to increasing communication security use of the third computer e.g. system can provide other benefits. For example offloading operations to the third computer system e.g. can reduce the processing resources and or storage resources utilized by the second computer system e.g. for communication security. As another example where the storage resources of the third computer system e.g. exceed the storage resources of the second computer system e.g. use of the third computer system e.g. to store data e.g. registration data permissions data permissions configuration data at least one key at least one secret key at least one private key at least one session key at least one instance of at least one session key some combination thereof etc. associated with the operations e.g. offloaded to the third computer system can allow the second computer system e.g. to communicate with a larger number of computer systems or devices e.g. including computer system at least one other computer system or device etc. .

In one embodiment step may be performed in accordance with one or more steps of process of . show a flowchart of process for increasing communication security in accordance with one embodiment. In one embodiment one or more steps of process may be performed during and or define at least a portion of a session.

As shown in step involves accessing message data. In one embodiment step may be performed using a message generation component e.g. of computer system of computer system etc. .

In one embodiment the message data accessed in step may include data other than authentication data. For example the message data may include data associated with a header e.g. included in portion of CoAP message data associated with a token e.g. included in portion of CoAP message data associated with at least one option e.g. included in portion of CoAP message data associated with a payload marker e.g. included in portion of CoAP message data associated with at least a portion of a payload e.g. included in portion of CoAP message data other than the authentication data e.g. Authentication Data of CoAP message A Authentication Data of CoAP message B etc. some combination thereof etc.

As shown in step involves accessing a session key or an instance thereof . In one embodiment step may be performed using a security component e.g. of computer system of computer system etc. .

For example step may involve accessing an instance of a session key e.g. accessed and or stored in step accessed in step stored in step etc. at a caller system e.g. the first computer system or computer system . Step may involve accessing an instance of the session key that is stored locally at a caller system e.g. the first computer system or computer system in one embodiment. For example the instance of the session key may be accessed in step from a security component e.g. of computer system a memory e.g. of computer system a database e.g. of computer system etc. Alternatively the instance of the session key may be remotely accessed by a caller system e.g. the first computer system or computer system in step from another system or device in one embodiment.

As another example step may involve accessing an instance of a session key e.g. accessed and or stored in step accessed in step stored in step etc. at a target system e.g. the second computer system or computer system . Step may involve accessing an instance of the session key that is stored locally at the target system in one embodiment. For example the instance of the session key may be accessed in step from a security component e.g. of computer system a memory e.g. of computer system a database e.g. of computer system etc. Alternatively the instance of the session key may be remotely accessed by the target system in step from another system or device in one embodiment.

As shown in step involves generating authentication data using the session key e.g. accessed in step . In one embodiment step may be performed using a security component e.g. of computer system of computer system etc. .

In one embodiment the authentication data may be generated in step using an authentication mechanism such as HMAC OAuth OAuth 2.0 OpenID etc. Where the authentication mechanism used to generate the authentication data in step is HMAC the authentication data may be generated by performing a hash function e.g. MD5 SHA 1 SHA256 SHA512 etc. on message data e.g. accessed in step using the session key e.g. accessed in step . In one embodiment the message data may be free of the session key e.g. accessed in step .

As shown in step involves optionally generating encrypted data using the session key. Step may involve encrypting data to generate the encrypted data e.g. as or including ciphertext . In one embodiment the data encrypted in step may include at least a portion of the message data e.g. accessed in step at least a portion of the authentication data e.g. generated in step some combination thereof etc. And in one embodiment the encrypted data may be generated in step using AES Blowfish RC4 the Extended Tiny Encryption Algorithm XTEA scheme another symmetric key algorithm etc.

Where the encrypted data includes authentication data it should be appreciated that the encrypted authentication data e.g. as ciphertext may be generated by performing a plurality of operations using the session key or an instance thereof . For example the authentication data may be generated e.g. in step using an instance of the session key and the authentication data e.g. alone or with other data or content may be encrypted e.g. in step using the instance of the session key.

In one embodiment the data encrypted in step may include data or content associated with a payload. For example step may involve encrypting authentication data e.g. Authentication Data associated with and or to be included in a payload of a message e.g. CoAP message A . As another example step may involve encrypting authentication data e.g. Authentication Data and or other data e.g. the data or content of 22.5 C associated with and or to be included in a payload of a message e.g. CoAP message B .

As shown in step involves generating a message including the message data e.g. accessed in step and the authentication data e.g. generated in step . In one embodiment step may be performed using a message generation component e.g. of computer system of computer system etc. .

In one embodiment where the message generated in step is a CoAP message e.g. A B etc. step may involve formatting the message data e.g. accessed in step in accordance with CoAP e.g. into one or more portions of CoAP message . The authentication data e.g. generated in step may be included in or as the payload e.g. associated with portion of CoAP message of the CoAP message in one embodiment. For example as shown in authentication data e.g. Authentication Data may be included in or as the payload of CoAP message A. As another example as shown in authentication data e.g. Authentication Data may be included in or as the payload of CoAP message B.

Step may involve including other data or content e.g. accessed in step as at least part of the message data in or as the payload of the message in one embodiment. For example as shown in other data or content e.g. 22.5 C may be included in or as the payload of CoAP message B in step . And in one embodiment other data or content e.g. accessed in step as at least part of the message data may be included in or as another portion of the message in step .

Step may involve including encrypted data e.g. generated in step in or as the payload of the message in one embodiment. For example where encrypted data includes authentication data e.g. Authentication Data as depicted in step may involve including the authentication data as encrypted data e.g. as ciphertext in or as the payload of the message e.g. CoAP message A . As another example where encrypted data includes authentication data e.g. Authentication Data as depicted in and other data or content e.g. 22.5 C as depicted in step may involve including the authentication data and the other data or content as encrypted data e.g. as ciphertext in or as the payload of the message e.g. CoAP message B . And in one embodiment step may involve including encrypted data e.g. generated in step in or as another portion of the message in step .

In one embodiment step may involve generating a bit stream or byte stream including the message data e.g. accessed in step and the authentication data e.g. generated in step . In one embodiment step may involve generating a bit stream or byte stream including the encrypted data e.g. generated in step and or other data e.g. at least a portion of the message data at least a portion of the authentication data etc. . The bit stream or byte stream may be formatted in accordance with CoAP in one embodiment.

As shown in step involves communicating the message e.g. generated in step . Where the message is generated e.g. in step at a caller system e.g. the first computer system or computer system step may involve communicating the message from the caller system to a target system e.g. the second computer system or computer system . Alternatively where the message is generated e.g. in step at a target system e.g. the second computer system or computer system step may involve communicating the message from the target system to a caller system e.g. the first computer system or computer system .

In one embodiment the message may be communicated in step over a connection e.g. between computer system and computer system . The message may be communicated in step as a bit stream or a byte stream in one embodiment. And in one embodiment step may involve communicating the message using at least one communication interface e.g. of computer system of computer system etc. .

Step may involve communicating the message using Datagram Transport Layer Security DTLS in one embodiment. For example where the message is a CoAP message e.g. A B etc. step may involve communicating the message over CoAP using DTLS.

As shown in step involves receiving the message e.g. communicated in step . Where the message is communicated e.g. in step from a caller system e.g. the first computer system or computer system step may involve receiving the message at a target system e.g. the second computer system or computer system . Alternatively where the message is communicated e.g. in step from a target system e.g. the second computer system or computer system step may involve receiving the message at a caller system e.g. the first computer system or computer system .

In one embodiment the message may be received in step over a connection e.g. . The message may be received in step as a bit stream or a byte stream in one embodiment. And in one embodiment step may involve receiving the message using a communication interface e.g. of computer system of computer system etc. .

Step may involve receiving the message using Datagram Transport Layer Security DTLS in one embodiment. For example where the message is a CoAP message e.g. A B etc. step may involve receiving the message over CoAP using DTLS.

As shown in step involves accessing a session key or an instance thereof . And in one embodiment step may be performed using a security component e.g. of computer system of computer system etc. .

Where the message is received at a caller system e.g. the first computer system or computer system in step step may involve accessing an instance of a session key e.g. accessed and or stored in step accessed in step stored in step etc. at the caller system. Step may involve accessing an instance of the session key that is stored locally at a caller system e.g. the first computer system or computer system in one embodiment. For example the instance of the session key may be accessed in step from a security component e.g. of computer system a memory e.g. of computer system a database e.g. of computer system etc. Alternatively the instance of the session key may be remotely accessed by a caller system e.g. the first computer system or computer system in step from another system or device in one embodiment.

Where the message is received at a target system e.g. the second computer system or computer system in step step may involve accessing an instance of a session key e.g. accessed and or stored in step accessed in step stored in step etc. at the target system. Step may involve accessing an instance of the session key that is stored locally at a target system e.g. the second computer system or computer system in one embodiment. For example the instance of the session key may be accessed in step from a security component e.g. of computer system a memory e.g. of computer system a database e.g. of computer system etc. Alternatively the instance of the session key may be remotely accessed by a target system e.g. the second computer system or computer system in step from another system or device in one embodiment.

In one embodiment the session keys accessed in steps and may be different instances of the same session key. For example the session keys accessed in steps and may be different instances of the same session key generated e.g. at or by the third computer system or computer system in step in step etc.

As shown in step involves optionally determining whether the session key e.g. accessed in step is valid. In one embodiment step may be performed using a security component e.g. of computer system of computer system etc. .

In one embodiment step may involve determining whether the session key e.g. accessed in step is valid based on expiration data e.g. accessed in step . For example the session key may be determined to be valid in step if the session key is not expired e.g. as determined based on the expiration data . As another example the session key may be determined to be invalid in step if the session key is expired e.g. as determined based on the expiration data . If the session key is determined to be valid in step then step may be performed.

As shown in step involves optionally decrypting at least a portion of the message using the session key e.g. accessed in step . In one embodiment where the message includes encrypted data e.g. generated in step the at least a portion of the message decrypted in step may include the encrypted data. And in one embodiment the at least a portion of the message may be decrypted in step using AES Blowfish RC4 the Extended Tiny Encryption Algorithm XTEA scheme another symmetric key algorithm etc. And in one embodiment step may be performed using a security component e.g. of computer system of computer system etc. .

Step may involve decrypting at least a portion of the message e.g. as ciphertext to generate other data e.g. as or including plaintext or unencrypted data in one embodiment. The other data may include at least a portion of the message data e.g. accessed in step at least a portion of the authentication data e.g. generated in step the data used to generate the encrypted data e.g. in step some combination thereof etc.

The key used to decrypt at least a portion of the message e.g. in step and the key used to generate encrypted data e.g. in step may be different instances of the same session key e.g. each stored at and or accessible to a respective computer system in one embodiment. In this manner a symmetric key algorithm may be used to secure data e.g. used to generate the encrypted data in step and or generated as a result of the decryption performed in step communicated using one or more messages.

As shown in step involves optionally determining whether the decryption e.g. performed in step is successful. In one embodiment step may be performed using a security component e.g. of computer system of computer system etc. . If the decryption e.g. performed in step is determined to be successful in step then step may be performed.

As shown in step involves processing the message. In one embodiment step may involve processing the message as received in step . In one embodiment step may involve processing the message including other data generated as a result of decryption performed in step . And in one embodiment the other data e.g. generated as a result of decryption performed in step may be processed in step alone or in combination with at least one other portion of the message e.g. in the format or state as received in step .

Processing of the message in step may involve accessing authentication data from the message in one embodiment. In one embodiment step may involve processing the message using a security component e.g. of computer system of computer system etc. . And in one embodiment where the message is a CoAP message step may be performed in accordance with step and or one or more steps of process of .

As shown in Step involves performing message validation e.g. with respect to the message received in step processed in step etc. . The message validation may be used to verify the authenticity of the sender of the message and or the integrity of the message. Where the message includes a nonce the message validation may be used to detect a replay attack.

In one embodiment message validation may be performed in step based on authentication data e.g. accessed from the message in step . And in one embodiment message validation may be performed in step using at least one message invalidity condition.

Where message validation is performed based on authentication data message validation may be performed in step by comparing second authentication data to the authentication data in one embodiment. For example the recipient of the message e.g. computer system computer system etc. may generate second authentication data based on at least a portion of the message e.g. a header a token at least one option a payload marker a payload some combination thereof etc. . The second authentication data may be compared to the authentication data e.g. included in the message and or accessed in step to verify the authenticity of the sender of the message e.g. computer system computer system etc. verify the integrity of the message detect and or act on a replay attack some combination thereof etc.

In one embodiment the second authentication data may be generated in step using an authentication mechanism such as HMAC OAuth OAuth 2.0 OpenID etc. The second authentication data may be generated in step using a key in one embodiment. For example where the authentication mechanism used to generate the second authentication data in step is HMAC the second authentication data may be generated by performing a hash function e.g. MD5 SHA 1 SHA256 SHA512 etc. on at least a portion of the message e.g. a header a token at least one option a payload marker a payload some combination thereof etc. using a key. And in one embodiment the message may be free of the key used to generate the second authentication data in step .

An instance of a session key may be used to generate the second authentication data in step in one embodiment. For example where the message is received e.g. in step at a caller system e.g. the first computer system or computer system an instance of a session key e.g. accessed and or stored in step accessed in step stored in step etc. may be used by the caller system to generate the second authentication data in step . The instance of the session key may be stored locally at the caller system in one embodiment. For example the instance of the session key may be stored locally in a security component e.g. of computer system in a memory e.g. of computer system in a database e.g. of computer system etc. Alternatively the instance of the session key may be stored remotely e.g. at another system or device and accessed by the caller system in a secure manner in one embodiment. Accordingly an instance of a session key may be securely accessed and used by a caller system e.g. the first computer system or computer system to generate the second authentication data in step in one embodiment.

As another example where the message is received e.g. in step at a target system e.g. the second computer system or computer system an instance of a session key e.g. accessed and or stored in step accessed in step stored in step etc. may be used by the target system to generate the second authentication data in step . The instance of the session key may be stored locally at the target system in one embodiment. For example the instance of the session key may be stored locally in a security component e.g. of computer system in a memory e.g. of computer system in a database e.g. of computer system etc. Alternatively the instance of the session key may be stored remotely e.g. at another system or device and accessed by the target system in a secure manner in one embodiment. Accordingly an instance of a session key may be securely accessed and used by a target system e.g. the second computer system or computer system to generate the second authentication data in step in one embodiment.

Where message validation is performed using at least one message invalidity condition the message may be determined to be invalid in step if any of the at least one message invalidity condition is triggered in one embodiment. For example the message may be determined to be invalid in step responsive to a failure to access a unique identifier associated with the sender of the message. As another example the message may be determined to be invalid in step responsive to a failure to access a nonce from the message. As a further example the message may be determined to be invalid in step responsive to determining that a nonce accessed from the message is not different from another nonce accessed from a previous message. As yet another example the message may be determined to be invalid in step responsive to determining that a payload of the message is not at least a predetermined size. And as another example the message may be determined to be invalid in step responsive to a failure to access a key e.g. an instance of the session key used to generate the second authentication data or otherwise perform the message validation.

The message validation may be performed in step using a security component e.g. of computer system of computer system etc. in one embodiment. And in one embodiment where the message is a CoAP message step may be performed in accordance with step one or more steps of process of one or more steps of process of some combination thereof etc.

As shown in step involves determining whether the message e.g. received in step processed in step etc. is valid e.g. based on the results of the message validation performed in step . Step may be performed using a security component e.g. of computer system of computer system etc. in one embodiment. If it is determined in step that the message is valid then step may be performed.

Step involves performing at least one operation associated with the message e.g. received in step processed in step etc. . In one embodiment step may involve performing at least one operation using an operation component e.g. of computer system of computer system etc. .

In one embodiment the at least one operation performed in step may include at least one operation associated with a request of the message. For example where the message is associated with a request to obtain data or content e.g. a temperature a voltage etc. the at least one operation may involve accessing the requested data or content.

The at least one operation performed in step may include communication of another message in one embodiment. For example responsive to determining that the message is valid e.g. in step another message may be communicated in step from the recipient of the message. Another message may be communicated in step to the sender of the message e.g. received in step processed in step etc. to another computer system or device etc. In one embodiment where another message is generated and or communicated in step step may involve repeating or otherwise performing one or more steps of process .

In one embodiment the at least one operation performed in step may include at least one operation associated with a response of the message. For example where the message is associated with a response including data or content the at least one operation may include processing the data or content performing one or more other operations with respect to the data or content etc.

Step may be performed in accordance with step of process in one embodiment. And in one embodiment where the message e.g. received in step processed in step etc. is a CoAP message step may be performed in accordance with step of process .

Alternatively if it is determined in step that the message e.g. received in step processed in step etc. is not valid then at least one other operation associated with the message may be performed in step . In one embodiment step may involve performing at least one operation using an operation component e.g. of computer system of computer system etc. .

In one embodiment step may involve acting responsive to a message validation failure such as a triggering of a message invalidity condition e.g. corresponding to one or more steps of process a failure to access a unique identifier associated with the sender of the message a failure to access a nonce from the message determining that a nonce accessed from the message is not different from another nonce accessed from a previous message determining that a payload of the message is not at least a predetermined size a failure to access a key used to generate the second authentication data or otherwise perform the message validation some combination thereof etc. another message validation failure e.g. determining that the second authentication data generated based on at least a portion of the message does not correlate to authentication data accessed from the message another message validation failure etc. etc. And in one embodiment step may involve acting on a suspected or detected replay attack.

The at least one other operation performed in step may include ignoring the message e.g. received in step processed in step etc. in one embodiment. For example another message may not be generated and or communicated in reply to the message e.g. received in step processed in step etc. in step . As another example no further processing related to the message e.g. received in step processed in step etc. may be performed in step . And in one embodiment the at least one other operation performed in step may include limiting access to the recipient e.g. of the message received in step of the sender e.g. of the message communicated in step .

In one embodiment one or more steps of process may be repeated with respect to at least one other message. For example where a message is generated and communicated e.g. in accordance with one or more steps of process at least one other message may be generated and or communicated e.g. in accordance with one or more steps of process . In one embodiment the message may be associated with a request and the at least one other message may be associated with at least one response e.g. related to the request of the message .

Although depicts process as including a specific number of steps it should be appreciated that process may include a different number of steps in other embodiments. Although depicts process as including a specific ordering of steps it should be appreciated that process may include a different ordering of steps in other embodiments.

Although shows system with a specific number and type of systems or devices it should be appreciated that system may include a different number and or type of systems or devices in other embodiments. For example system may include more than one instance of computer system and or computer system in one or more other embodiments. Where system includes more than one instance of computer system each instance of computer system may communicate with computer system over a respective connection e.g. similar to connection . Where system includes more than one instance of computer system each instance of computer system may communicate with computer system over a respective connection e.g. similar to connection . As such embodiments can increase the security associated with communication of messages between any number of systems or devices.

Although depict process as including a specific number of steps it should be appreciated that process may include a different number of steps in other embodiments. Although depict process as including a specific ordering of steps it should be appreciated that process may include a different ordering of steps in other embodiments.

In the foregoing specification embodiments have been described with reference to numerous specific details that may vary from implementation to implementation. Thus the sole and exclusive indicator of what is and is intended by the applicant to be the invention is the set of claims that issue from this application in the specific form in which such claims issue including any subsequent correction thereto. Hence no limitation element property feature advantage or attribute that is not expressly recited in a claim should limit the scope of such claim in any way. Accordingly the specification and drawings are to be regarded in an illustrative rather than a restrictive sense.

