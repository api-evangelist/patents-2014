---

title: Systems, devices and methods for reducing switching time in a video distribution network
abstract: When switching sources, resolutions or refresh rates in a video distribution network, switching times are reduced by maintaining video lock and security authentication between a video switcher and a video sink. The scaler maintains video lock and security authentication by continuing to generate video timing data during switching events. The scaler also facilitates an aesthetically pleasing transition by generating image content data prior to and after the switching event.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09456236&OS=09456236&RS=09456236
owner: Crestron Electronics Inc.
number: 09456236
owner_city: Rockleigh
owner_country: US
publication_date: 20140929
---
The present invention relates generally to video distribution networks. More particularly the invention relates to methods and apparatuses for distributing video protected by a digital rights management scheme.

Video distribution networks are increasingly common installations in commercial and residential facilities. Components of a video distribution network are typically located throughout the facility and networked allowing video to be distributed from one or more video source to one or more video sinks. For example a typical video distribution network in a home may comprise a multitude of video sources such as Blu Ray Disc Players media servers digital video disc DVD players Digital Video Recorders DVR and cable boxes. These video sources may be centrally located such as in an equipment rack in a closet and distributed via a chain of switches and repeaters to various video sinks such as television displays computer monitors and projectors throughout the home.

However as the digital distribution of television movies and music expands content providers are growing increasingly concerned about the simplicity with which content pirates can copy and share copyrighted material. Various digital rights management DRM schemes have been developed to ensure that television shows movies and music can only be viewed or heard by authorized parties i.e. paying customers . One DRM scheme to protect digital content as it is transmitted over cables between devices is known as High Bandwidth Digital Content Protection HDCP . HDCP is a specified method developed by Digital Content Protection L.L.C. DCP for protecting copyrighted digital content as it travels across connection interfaces and protocols such as DisplayPort DP Digital Video Interface DVI High Definition Multimedia Interface HDMI . The HDMI specification defines an interface for carrying digital audiovisual content from a source such as a Blu Ray Disc player to a sink or display device such as a television TV .

There are three facets to HDCP. First there is the authentication protocol through which a source verifies that a given sink is licensed to receive HDCP content. With the legitimacy of the sink determined encrypted HDCP content may be transmitted between the two devices based on shared secrets established during the authentication protocol. The use of such shared secrets prevents eavesdropping devices from utilizing the content. Finally in the event that legitimate devices are compromised to permit unauthorized use of HDCP content renewability allows a source to identify such compromised devices and prevent the transmission of HDCP content.

The HDCP authentication protocol is an exchange between an HDCP compliant source and an HDCP compliant sink that affirms to the source that the sink is authorized to receive HDCP content by demonstrating knowledge of a set of secret device keys by transmitting a key selection vector KSV . Each HDCP device is provided with a unique set of these secret device keys referred to as the Device Private Keys from DCP. The communication exchange also provides for both the HDCP compliant source and sink to generate a shared secret value that cannot be determined by eavesdropping on that exchange. By having that shared secret information embedded into the demonstration of authorization the shared secret can then be used as a symmetric key to encrypt HDCP content intended only for the authorized device. Thus a communication path is established between the HDCP source and HDCP sink that only authorized devices can access.

In order for an HDCP compliant source to successfully transmit protected content to one or more HDCP compliant sinks through an HDCP compliant repeater a more involved authentication process must first occur. To affirm the downstream sinks to the upstream sources the HDCP repeater must pass along the KSVs of each downstream receiver to the upstream source. The HDCP source checks these KSVs against an HDCP Revocation List maintained by DCP LLC HDCP blacklist in order to determine if each of the downstream sinks are licensed to receive the protected content. If all the downstream sinks are determined to be licensed to receive the protected content the upstream source transmits the protected content to the HDCP repeater. It is the responsibility of the HDCP repeater to then establish and periodically manage authenticated links with each of its connected HDCP receivers.

While HDCP offers the benefit of encrypted content transmission the required authentication protocol increases the switching delay in video distribution networks. Each time a new path for video distribution is desired the links forming those paths must be authenticated. For example when a user desires to switch to a different video source not only must the new video source authenticate with the repeater but the repeater must also reauthenticate with the video sink. Increased switching times are disrupting and bothersome to users. In complex video distribution systems with multiple layers this problem is even more amplified. Additionally because HDCP scheme operates under the surface most users do not realize that the increased time is the result of copy protection schemes and often unfairly attribute them to the individual components in the video distribution network.

An additional factor in the high switching delay in video distribution units is caused by the need for processing in video distribution networks. Scalers are employed to change the resolution or refresh rate of distributed video and are common components in video distribution networks either as separate components or integrated into other components in the network. Each time a video scaler receives audiovisual data at a new resolution there is a delay before the scaler outputs any new video. The video scaler must load data and format before outputting scaled video. This is known as achieving video lock. During a switching event each scaler in the distribution path must achieve video lock in succession. In complex video distribution systems with multiple layers this delay is amplified.

Additionally dependent on the characteristics of the display viewers may be subjected to disrupting video artifacts or snow during switches. Manufacturers handle disrupted video in different ways. Some displays may show snow when video is disrupted. Other may display pixilated images or ghost images. Many viewers find these display responses disturbing and lead some to believe that there is a problem with their equipment when no such problem exists. Users may experience the authentication process as a delayed period with snow or disorienting video artifacts.

It is to be understood that both the general and detailed descriptions that follow are exemplary and explanatory only and are not restrictive of the invention.

Principles of the invention provide a device and method for reducing the actual and perceived switching time of a video distribution network by outputting a continuous stream of audiovisual data including a repeated frame of image content data on a downstream connection of a switcher device. For example in a first aspect of the invention a switcher device comprises at least two input boards a multiplexer and an output board. Each of the at least two input boards are configured for receiving audiovisual data from a video source. The multiplexer is communicatively coupled between the at least two input boards and a transmitter board and configured for dynamically routing audiovisual data from the at least input boards to the transmitter board. The output board is configured for transmitting audiovisual data comprising a repeated frame of video to a video sink.

According to a second aspect of the invention a switcher device comprises at least two input boards a multiplexer board and an output board. Each of the at least two input boards is configured for receiving audiovisual data from a video source. The multiplexer board comprises a multiplexer communicatively coupled between the at least two input boards and an output board and configured for dynamically routing audiovisual data from the at least two input boards to the output board and a processing unit in communication with the multiplexer and the output board and configured for transmitting a switch signal to the multiplexer and a prepare signal to the transmitter board prior to a switching event. The output board is configured for transmitting audiovisual data to a video sink and comprises a receiver configured for receiving audiovisual data routed from the multiplexer a scaler configured for converting audiovisual data received via the multiplexer to video to a native resolution of the video sink generating video timing data at the native resolution of the video sink during the switching event and generating image content data comprising a repeated frame of video for a period of time until achieving video lock in response to receiving the prepare signal and a transmitter configured for encrypting and transmitting generated audiovisual data to the video sink.

According to a third aspect of the invention an output board for a switcher device is configured for transmitting audiovisual data to a video sink. The output board comprises a receiver a scaler and a transmitter. The receiver is configured for receiving audiovisual data. The scaler is configured for converting the audiovisual data to a native resolution of the video sink and configured for generating audiovisual data comprising a repeated frame during a switching event. The transmitter is configured for encrypting and transmitting the output of the scaler.

According to a fourth aspect of the invention a method for reducing switching delay when switching sources in a video distribution network comprises the steps of receiving audiovisual data at a first input board from a first video sink routing audiovisual data from the first input board to an output board transmitting audiovisual data from the output board to a video sink receiving a user control signal to switch to a second video source generating video timing data at the output board during a delay between receiving audiovisual data from the first input board and receiving audiovisual data from the second input board to maintain authenticity of security protocol link between the output board and the video sink generating image content data at the output board during a delay between receiving audiovisual data from the first input board and achieving video lock with audiovisual data from the second input board receiving audiovisual data at a second input board from a second video sink routing audiovisual data from the second input board to the output board and transmitting audiovisual data from the output board to the video sink.

According to a fifth aspect of the invention a computer program product for reducing the switching time in a video distribution network the computer program product comprises a computer readable storage medium having computer readable code embodied therewith. The computer readable program code comprises computer readable program code configured to detect a user control signal to switch from a first video source to a second video source transmit a prepare signal to a processing unit of an output board in response to the detection of the user control signal detect the prepare signal instruct a scaler to generate audiovisual data comprising image content data further comprising a repeated frame of video in response to the detection of the prepare signal cease routing audiovisual data from a first video source to the output board continue generating video timing data at the scaler of the output board begin routing audiovisual data from a second video source to the input board cease generating image content data upon achieving video lock.

The present invention seeks to overcome or at least ameliorate one or more of several problems including but not limited to reducing the switching delay of a video distribution network transmitting video.

Authorized device An HDCP device that is permitted access to HDCP content. An HDCP transmitter may test if an attached HDCP receiver is an authorized device by successfully completing the first and when applicable second part of the authentication protocol. If the authentication protocol successfully results in establishing authentication then the other device is considered by the HDCP transmitter to be an authorized device.

Downstream Term used as an adjective to refer to being towards the sink display of the HDCP content stream.

DVI Short for Digital Video or Visual Interface a digital interface standard created by the Digital Display Working Group DDWG to accommodate both analog and digital monitors.

HDCP short for High Bandwidth Digital Content Protection a specified method developed by Digital Content Protection L.L.C. DCP for protecting copyrighted digital content as it travels across connection interfaces and protocols such as DisplayPort DP Digital Video Interface DVI High Definition Multimedia Interface HDMI .

HDCP content consists of audiovisual content that is protected by the HDCP system. HDCP content includes the audiovisual content in encrypted form as it is transferred from an HDCP transmitter to an HDCP receiver over an HDCP protected Interface.

HDCP device Any device that contains one or more HDCP protected interface ports and is designed in adherence to HDCP.

HDCP Encryption The encryption technology of HDCP when applied to the protection of HDCP content in an HDCP system.

HDCP protected Interface Port A connection point on an HDCP Device that supports an HDCP protected Interface.

HDCP receiver An HDCP device that can receive and decrypt HDCP content through one or more of its HDCP protected interface ports.

HDCP repeater An HDCP device that can receive and decrypt HDCP content through one or more of its HDCP protected interface ports and can also re encrypt and emit the HDCP content through one or more of its HDCP protected interface ports. An HDCP repeater may also be referred to as either an HDCP receiver or an HDCP transmitter when referring to either the upstream side or the downstream side respectively.

HDCP transmitter An HDCP device that can encrypt and emit HDCP content through one or more of its HDCP protected interface ports.

HDMI Short for High Definition Multimedia Interface an industry supported uncompressed all digital audio video interface.

Upstream Term used as an adjective to refer to being towards the source of the HDCP content stream. The antonym of downstream defined above.

Protection HDCP systems . Referring to the HDCP system encrypts the digital content transmission between a video source set top box computer DVD etc. and a sink or display Liquid Crystal Display television etc. via an interface such as a Digital Video Interface DVI a High Definition Multimedia Interface HDMI and a DisplayPort interface.

Device manufacturers typically buy HDCP chips from a DCP licensed silicon vendor. These chips usually also provides Transition Minimized Differential Signaling TMDS encoders or decoders and other HDMI specific features. Every transmitter will have at least one HDCP transmitter chip and every receiver will have at least one HDCP receiver chip. The HDCP transmitters and receivers frequently require a microprocessor to implement the authentication state machines. Transmitters are HDMI transmitters.

Part One The source authenticates with the sink display connected to its output. If successful encryption is enabled and audiovisual A V content transmission begins.

Part Two This part is used if the downstream device is a repeater . The repeater authenticates with the devices connected to its output s and passes the HDCP tree topology information up to the source . The source is the root and sinks display are the leaves while repeaters make up the branches of the tree.

Part Three The source performs periodic checks with the sink display to ensure that encryption is in sync. As mentioned above it is the repeater s responsibility to maintain its downstream connections. If any part of authentication fails or any revoked devices are found in the HDCP tree the transmitter must stop sending protected content and authentication starts over at Part One.

Part One of authentication is a key exchange protocol. The transmitter and receiver calculate a common secret session key to be used for encryption. If they cannot come up with the same key value authentication fails and the receiver will not be able to decrypt the content . The session key is derived from each device s private key according to the following protocol 

First the transmitter generates a random number An and sends it to the receiver . This value will be used later in the protocol. The devices then exchange KSVs. The receiver also sends its REPEATER bit a flag that indicates whether or not it is part of a repeater. Now each device has the other device s Key Selection Vector KSV . Each device uses the other device s Key Selection Vector to select twenty of its own keys. The forty bits in the KSV correspond to the indexes of each of the forty private keys. For every set bit in the received KSV the local private key at that index is selected. All KSVs have twenty set bits so twenty keys are selected. The devices then each add up their selected keys to come up with the sums Km and Km for the transmitter and receiver respectively . For authentication to succeed Km and Km must match. Each device tells the other which of its own unique secret keys to select and they both come up with the same sum. That may seem counter intuitive but it is the aforementioned mathematical relationship between the keys and the KSVs that accounts for this behavior. The source must determine whether Km and Km match. However they are secret values so they cannot be transmitted over the interface cable for the DDC. Each device feeds Km or Km the random number An and the REPEATER bit into their respective HDCP cipher engines in order for the transmitter to verify that the values match without sending them across the cable for everyone to see. The resulting data stream is split into three values 

R0 R0 This return value may be shared between the devices and is used to verify that authentication was successful.

M0 M This value is also kept private and is used in Part Two of authentication if the downstream device is a repeater .

The receiver sends R0 to the transmitter which compares it against its own R0 value. If they match that proves that the sums Km and Km matched and authentication is successful. Furthermore the session keys Ks and K match so the receiver will be able to decrypt the content encrypted by the transmitter. If Part One of authentication was successful the transmitter may begin sending encrypted content . If the downstream device is a repeater the repeater must authenticate with its own downstream device according to the same protocol. The transmitter then starts a 5 second timer to allow for the repeater to perform Part Two of authentication. If Part Two fails or times out authentication fails and the transmitter must stop transmitting the protected content .

Part Two of authentication only occurs if the downstream device is a repeater . The purpose of Part Two is to inform the source of all downstream devices and the HDCP tree depth. The source uses this information to ensure that the tree topology maximums have not been exceeded and to ensure that none of the downstream devices have been revoked by DCP. The repeater first assembles a list of the KSVs of all downstream devices as well as the device count and the tree depth. The repeater then passes this information up to the source . To ensure that this information hasn t been tampered with during transmission each device takes this list appends its secret value M0 M0 from Part One and calculates a SHA 1 hash of the whole thing. The transmitter reads the hash result from the receiver and compares it against its own. If they match Part Two of authentication is successful.

All HDCP devices are considered authenticated after successful completion of Authentication Parts One and Two. Part Three is simply a link integrity check to ensure that encryption is in sync between all transmitter receiver pairs in the tree. To support link integrity checks the return values Ri and Ri roll over to a new value every 128 frames. Recall that the initial Ri values R0 and R0 were generated during Part One of authentication. Every two seconds the transmitter compares the receiver s Ri value against its own Ri value to see if they match. If they don t encryption is out of sync and the receiver cannot correctly decrypt the content . The user will see a scrambled or snowy image on the screen. In this case the transmitter must restart authentication from the beginning.

The three part authentication process increases switching delay when switching sources in a video distribution network. Switching delay is the delay between switching an aspect of incoming audiovisual data to a video sink such as audiovisual data source audiovisual data resolution and audiovisual data refresh rate and the incoming audiovisual data being displayed on the video sink. Not only must devices authenticate the HDCP link before video transmission each time an upstream HDCP link is switched downstream HDCP links may be affected as well because audiovisual data transmission to downstream links is interrupted. Each time video transmission is interrupted between an HDCP transmitter and an HDCP receiver the HDCP link fails Part Three of the authentication process and the authentication process must be restarted from Part One. This includes downstream connections that were previously authenticated with each other.

For example in a video distribution network comprising a first HDCP compliant video source and a second HDCP compliant video source connected to an HDCP compliant video sink via an HDCP compliant video switcher when the video source transmitting HDCP content to the video sink is switched from the first video source to the second video source not only must the second video source authenticate with the video switcher but the downstream link between the video source and the video switcher must also be reauthenticated due to the disruption in video transmission. This despite the fact that the HDCP link between the video source and the video switcher was already authenticated. This issue becomes increasingly burdensome in expansive video distribution networks with many layers i.e. a large tree topology .

Additionally when video transmission is interrupted between an HDCP transmitter and an HDCP receiver due to upstream switching and HDCP authentication any downstream video scalers must lock back on the incoming audiovisual data before outputting any scaled audiovisual data. This introduces delay in addition to the delay introduced by the HDCP authentication process. For example each time video transmission to a sink is interrupted video scaler internal to the sink will take anywhere between two and ten seconds to lock onto the incoming audiovisual data again. Those skilled in the art will recognize that scaler operation is unpredictable and varies due to hardware and firmware specification. Often video scalers included in video sinks are not optimized for reducing switching delay. Also unpredictable is video sink response while embedded video scalers achieve video lock. Presented with interrupted video the video sink may display snow pixilated images video artifacts or a blank screen while internal scaler achieves video lock dependent on video sink manufacturer.

Because the HDCP authentication process operates in the background often unknown to the user long switching delays are unfairly blamed on video distribution components. Users may experience the authentication process as a delayed period with snow or disorienting video artifacts. This could result in undeserved user dissatisfaction with the manufacturer of the components in the video distribution network.

As will be explained below the present invention discloses systems apparatuses and methods for reducing the switching time in a video distribution network. The present invention discloses maintaining authentication of downstream link during a switching discontinuity minimizing the interruption of video transmission resulting from switching events. By outputting continuous video timing data to a sink over a downstream HDCP link even during switching discontinuities the downstream HDCP link satisfies the maintenance check in step three of HDCP authentication. Accordingly steps one and two of the HDCP authentication protocol need not be repeated. Additionally as a result of maintaining the authentication of the HDCP link by outputting continuous video timing data during switching discontinuities video scalers downstream of the HDCP link i.e. internal video sink scalers will not lose video lock with the incoming video stream thereby reducing delay times further. Finally by outputting black frames of image data the content displayed during switching events is controlled.

At least one sink includes an HDCP receiver such as an HDMI receiver. The source determines via the authentication process what content can be viewed recorded and shared based on sinks displays that support HDCP and sinks displays that does not support HDCP. The output of the source is connected to an input board for a switcher device through their HDCP protected interfaces and the switcher device serves as an HDCP repeater for HDCP compliant content. An output board for the switcher device is connected to the input of the sink display via another interface . The interface for the input board and the output board of the switcher device may be an HDMI cable that carries a variety of signals such as one or more Transition Minimized Differential Signaling TDMS data signals Digital Display Channel DDC Hot Plug Detect HPD and RxSense. As will be described later the interface for the input board and output board of the switcher device may also be a combination of one or more shielded twisted pairs STP and one or more unshielded twisted pairs UTP such as DigitalMedia DM cable available from Crestron Electronics Inc. of Rockleigh N.J.

When an HDCP source more specifically source detects an RxSense signal from an HDCP compliant sink display more specifically sink display the source will transmit HDCP content to the sink display after the authentication process is successful.

The audiovisual data is encoded into three data channels. These channels and a TMDS clock are carried over four differential pairs from the source to the sink display . The DDC is a communications interface similar to I2C. This interface provides two way communication in a master slave relationship. The upstream device is the DDC master and the downstream device is the DDC slave. The HDCP receiver indicates its presence to the HDCP transmitter with the HPD signal. The HDCP transmitter is the HDCP Device most upstream and receives the HDCP content from an upstream content control function .

The switcher device functioning as an HDCP repeater is a fully modular and expandable matrix switcher offering low latency digital video and audio switching and HD lossless multi room signal distribution for all types of A V sources. The switcher device may be a Crestron Digital Media Switcher available from Crestron Electronics Inc. of Rockleigh N.J.

The Crestron Digital Media Switcher is field configurable to handle but not limited to eight sixteen and thirty two audiovisual sources of virtually any type via input boards. The outputs are also field configurable to provide but not limited to eight sixteen and thirty two room outputs and or HDMI outputs in a single chassis. The chassis comprises slots for the insertion of input and output boards. As will be described later the input boards and output boards may be input boards and output boards respectively of the switcher device . Additionally the input boards and output boards may operate external of the chassis of the Digital Media Switcher and be coupled to the Digital Media Switcher via intermediate cards inserted into slots in the chassis.

The switcher device includes a multiplexer coupled in between the at least one input board collectively and at least one output board collectively . The multiplexer may be but is not limited to a mechanical switch electrically operated switch solid state relay latching relay reed relay Single Pole Single Throw SPST relay Single Pole Double Throw SPDT relay Double Pole Single Throw DPST relay and Double Pole Double Throw DPDT relay.

The multiplexer transmits an audiovisual data signal from one of the at least two input boards to a first output board . The multiplexer dynamically switches between the first input board and at least a second input board based on a user control signal that selects either the first video source or second video source to be displayed on the video sink . The output board is coupled to the at least one sink display via an interface cable . The interface cable may be an HDMI cable. The switcher further includes a processing unit coupled to the multiplexer . The processing unit includes at least one transceiver for bidirectional communications with an end user device e.g. in part to receive the user control signal . The end user device transmits the user control signal from a touch panel display via a control system . An end user may also transmit the user control signal from a wireless device . Software tools may be loaded onto the wireless device and or touch panel to assist the end user in selecting a desired source and the sink . In response to the user selecting the desired source for the sink the end user device transmits the user control signal to the switcher device .

Upon the user selecting the desired source for the at least one desired display the source will authenticate with the switcher device as described above. The switcher device will authenticate with the at least one desired downstream sinks as described above. Once the authentication is complete the source will transmit the HDCP content i.e. HDCP protected audiovisual data via the HDCP link between the source and the repeater. This HDCP link comprises the HDCP transmitter of the source an HDCP interface and an HDCP receiver of the first input board . The HDCP receiver of the input board receives the HDCP content and provides the audiovisual data unencrypted to the multiplexer . The multiplexer dependent on the user control signal routes the unencrypted audiovisual data to the desired output board . The output board processes and encrypts the audiovisual data and then transmits the HDCP content to the desired sink over an HDCP link between the output board and the video sink . The HDCP link between the output board and the video sink comprises an HDCP transmitter of the output board HDCP interface and HDCP receiver of the video sink.

The multiplexer is configured to dynamically route the audiovisual data according to the user control signal received at the processing unit . For example a user viewing content from a first source such as a cable tuner may desire to switch to a second source such as a Blu ray disc player. When the multiplexer switches from routing audiovisual data from the first source to routing audiovisual data from the second source the output board experiences a switching delay as a result of the delay caused by upstream HDCP authentication and multiplexer operation. A similar switching discontinuity may also result from a change in resolution or change in refresh rate of the received audiovisual data.

The output board of the inventive switcher device is configured to continuously output audiovisual data including video timing data and image content data during switching discontinuities such that the HDCP link between the output board and the video sink remains authenticated during the switch and an aesthetically pleasing display is shown during said switch. For example the output board may output black frames of audiovisual data during switching discontinuities. Switching delay in the video distribution network is minimized by maintaining the authentication of the HDCP link by continuously outputting video timing data. Additionally by continuously outputting video timing data to the video sink during switching discontinuities video lock is maintained in video processing devices such as scalers downstream from the output board i.e. scalers internal to video sink thereby further minimizing switching delay.

The output scaler receives the audiovisual data from the receiver and is configured to convert the received audiovisual data to a native resolution of the video sink . The output board may receive the native resolution of the video sink via an EDID channel. Those skilled in the art will recognize that the operation of video scalers embedded in end user devices are idiosyncratic depending on manufacturer and may perform substantially below par resulting in poor video quality and delayed performance. Advantageously by converting to the native resolution of the video sink video processing is minimized in downstream embedded video scalers.

In an embodiment of the invention the output scaler of the output board is configured for operating in a pass through mode in which the output scaler detects the resolution of the incoming audiovisual data via the video timing data. The output scaler passes the incoming audiovisual data through to the HDCP transmitter if the audiovisual data is routed to the output board already at a native resolution of the video sink.

The output scaler is further configured to generate audiovisual data comprising video timing data and image content data during switching discontinuities. For example during a switching discontinuity between receiving audiovisual data from a first source and audiovisual data from a second source the output scaler may output black frames. By outputting a continuous stream of audiovisual data more specifically video timing data to the HDCP transmitter the HDCP link between the output board and the source is maintained as authenticated during the switch. In addition by outputting black frames of audiovisual data more specifically image content data the end user experiences a clean transition from the first source to the second source . In other embodiments the output scaler may generate frames of image content data of a color other than black or may generate image content data comprising an image such as a corporate logo.

Prior to outputting audiovisual data from the second source the output scaler must receive a sufficient amount of audiovisual data from the second source . This is known as achieving video lock. Following a switching discontinuity the output scaler is further configured to generate image content data until video lock is achieved. By generating image content data until the output scaler achieves video lock the user is presented with a clean transition during switching events.

The output scaler is configured to operate in a free run mode by automatically generating video timing data during switching discontinuities.

The output scaler is configured to generate image content data in response to control signals from the output processing unit . Upon receiving the user control signal to switch the source of audiovisual data and prior to transmitting a switching signal to the multiplexer the switcher processing unit transmits a prepare signal to the output processing unit . The output processing unit in turn instructs the output scaler to generate black frames of audiovisual data.

The HDCP transmitter such as an HDMI transmitter converts and encodes the audiovisual data output from the output scaler to one or more TMDS signals for transmission to the video sink over the HDCP interface. In an embodiment of the invention the HDMI transmitter comprises an HDCP transmitter chip and may further comprise TMDS encoders or decoders and other HDMI specific features. The audiovisual data is reencrypted in accordance with the shared secret from authentication between the HCDP repeater and the HDCP sink. The HDCP transmitter receives the native resolution and the native refresh of the sink via a Display Data Channel DDC of the interface. The HDCP interface between transmitter and the HDCP receiver may be HDMI.

In this embodiment the output board is configured for receiving encrypted audiovisual data via an HDCP link. The extended transmission board is communicatively coupled between the multiplexer and the output board and is configured for encrypting the audiovisual data routed by the multiplexer and transmitting the encrypted audiovisual data to the output board via an HDCP link. The HDCP link comprises an HDCP transmitter of the extended transmission board an HDCP interface and an HDCP receiver of the output board . The HDCP interface may be one or more pairs of twisted cable or fiber optical cable such as DigitalMedia cable available from Crestron Electronics Inc. of Rockleigh N.J. Those skilled in the art will recognize that DigitalMedia cable is a multi generational family of interface cables particularly designed for media transmission for extended lengths.

Within a single plenum rated jacket original DigitalMedia cable contains one high bandwidth low crosstalk shielded 4 twisted pair STP cable one CAT5e unshielded 4 twisted pair UTP cable and one DMNet cable. The STP Audiovisual data cable is of a specialized construction designed to allow the longest possible cable lengths for transporting high definition digital video and audio. The Cat5e Data Management cable carries high speed Ethernet and other data plus 5V direct current DC power. Finally the DMNet cable carries additional proprietary control signals and 24V DC power. Original DigitalMedia cable is rated for up to 220 ft of audiovisual transmission.

In step a switcher device receives audiovisual data at a first input board via an HDCP link between a first video sink and the first input board

In step the output board transmits audiovisual data to a video sink over a security protocol link. In an embodiment of the invention the output board scales the audiovisual data received from the first input board to the native resolution of the video sink step prior to transmitting to the video sink .

In step the processing unit of the switcher device receives a control signal to switch from routing audiovisual data from the first input board to routing audiovisual data from the second input board

In an embodiment of the invention the switcher device processing unit transmits a prepare signal to the output board indicating that there will be a switching discontinuity step .

In an embodiment of the invention the output board generates image content data such as black frames of video in response to receiving the prepare signal from the switcher device processing unit step . The scaler outputs the generated image content data rather than the live image content data being routed to the output board from the multiplexer .

In step the output board continues generating video timing data at a native resolution during the delay between receiving audiovisual data from the first input board and receiving audiovisual data from the second input board . By outputting a continuous stream of video timing data the output board maintains the authenticity of the security link between the output board and the video sink .

In step the switcher device receives audiovisual data at a second input board via an HDCP link between a second video sink and the second input board

In step the output board continues generating and outputting image content data i.e. black frames of video until video lock is achieved.

In step the output board transmits live image content data routed from the second input board to the video sink over an HDCP link. In an embodiment of the invention the output board scales the audiovisual data received from the first input board to the native resolution of the video sink step prior to transmitting to the video sink .

The following is a pseudo code representation of the operation in accordance with an illustrative embodiment of the present invention.

Transmit a prepare signal to a processing unit of an output board in response to the detection of the user control signal

In an embodiment of the invention the video distribution system leverages a backdoor communication bus to prepare downstream devices such as an output board internal to the switcher device or external to the switcher device for a switching event.

Prior to a switching event the switcher processing unit transmits a prepare signal to downstream devices to prepare for a switching event. Each downstream device then relays the prepare signal to their downstream devices until the prepare signal is received at each necessary output board . For example downstream devices may comprise additional switcher devices output boards or intermediary relay devices and output boards may comprise output boxes and output cards outputting audiovisual data to a video sink.

Output scalers in the output boards then freeze the current video in anticipation of the switch by ceasing transmission of scaled live audiovisual data to the sink and instead generate and output audiovisual data comprising a repeated frame of image content data. The repeated frame of image content data may be a frame of image content data received from the first audiovisual source prior to the switching event. By generating a repeated frame of image content data from the first audiovisual source the video displayed on the video sink will appear to have momentarily frozen.

The switcher processing unit directs the multiplexer to perform the switching event subsequent to transmission of the prepare signal. The switcher processing unit may direct the multiplexer to perform the switch upon a predefined amount of time after transmitting the prepare signal or may direct the multiplexer subsequent to confirming reception of the prepare signal.

The output scaler generates and outputs the repeated frame of image content data until it has achieved video lock with the audiovisual data it receives subsequent to the switching event. By freezing and then unfreezing the video displayed on the video sink the output scaler achieves the look of an instant switch which is aesthetically pleasing to viewers and provides the perception of an instantaneous switch. In this embodiment while the video system may distribute secure content such as HDCP protected content the content does not necessarily need be protected content.

The output board may be a card configured for being inserted into the switcher device or may be external to the switcher device. In an embodiment of the invention there may be one or more intermediary devices between the multiplexer and the output board such as additional switcher devices and relay devices as shown in the video distribution system of . The output board comprises a receiver an output scaler an output processing unit and a transmitter . As discussed above the transmitter may be an HDCP transmitter. The receiver is configured to receive audiovisual data routed from the first input board or second input board via the multiplexer . The receiver may be an HDCP receiver configured for receiving HDCP encrypted content.

The output scaler receives the audiovisual data from the receiver and is configured to convert the received audiovisual data to a native resolution of the video sink. The output board may receive the native resolution of the video sink via an EDID channel. Those skilled in the art will recognize that the operation of video scalers embedded in end user devices are idiosyncratic depending on manufacturer and may perform substantially below par resulting in poor video quality and delayed performance. Advantageously by converting to the native resolution of the video sink video processing is minimized in downstream embedded video scalers.

In an embodiment of the invention the output scaler of the output board is configured for operating in a pass through mode in which the output scaler detects the resolution of the incoming audiovisual data via the video timing data. The output scaler passes the incoming audiovisual data through to the transmitter if the audiovisual data is routed to the output board already at a native resolution of the video sink.

The output scaler is further configured to generate audiovisual data comprising video timing data and image content data prior to and during switching discontinuities. The output scaler may further comprise a memory buffer and a frame buffer for generating and outputting a repeated frame of video to the video sink.

In this embodiment prior to and during a switching discontinuity from a switching event the output scaler may output a repeated frame of image content data from the audiovisual data received from the first source. For example upon receiving the prepare signal from the multiplexer the output scaler will freeze the video displayed on the video sink by generating and outputting a repeating frame of image content data from the audiovisual data received from the first source. The output scaler is configured for continuing to generate and output audiovisual data comprising video timing data and the repeated frame of image content data while the switcher device ceases routing audiovisual data from the first video source and begins routing audiovisual data from the second video source.

The output scaler must receive a sufficient amount of audiovisual data from the second source prior to outputting live audiovisual data from the second source . This is known as achieving video lock. Following a switching discontinuity the output scaler is further configured to generate the video timing data and repeated frame of image content data until video lock is achieved. Upon achieving video lock with the incoming video after the switching discontinuity the output scaler will then unfreeze the video by ceasing outputting the repeating frame and instead outputting the live scaled video. By repeating a frame of video the user is presented a cleaner and more aesthetically pleasing switch consisting of a momentarily and in some instances imperceptible frozen screen.

In addition to the aesthetic advantages and perceived reduction in switching time by the user the current invention reduces the switching time by maintaining scaler lock in any downstream scalars such as scalars embedded in video sinks. In HDCP systems switching time is further minimized. By outputting a continuous stream of audiovisual data more specifically video timing data to the HDCP transmitter the HDCP link between the output board and the source is maintained as authenticated during the switch.

The output scaler is configured to generate image content data in response to control signals from the output processing unit . The communication interface between the switcher processing unit and the output processing unit may be an Ethernet interface. In this embodiment the prepare signal may be a user datagram protocol UDP packet transmitted over the Ethernet interface. However the invention is not limited to UDP packets transmitted over Ethernet. In other embodiments of the invention the interface may be a serial peripheral interface SPI or may be an HDMI interface transmitting the prepare signal as an infoframe packet.

Upon receiving the user control signal to initiate a switching event and prior to transmitting a switching signal to the multiplexer the switcher processing unit transmits a prepare signal to the output processing unit via a communication interface. The output processing unit in turn instructs the output scaler to generate a repeated frame of audiovisual data.

In this embodiment the switcher processing unit may broadcast the prepare signal to each connected downstream device. Each downstream device may in turn process and broadcast the prepare signal to each of its connected downstream devices. As will be discussed below in a further embodiment of the invention the switcher processing unit may transmit directly to each necessary output scaler . The prepare signal may comprise an address such as a network address of an output card or output box.

The transmitter is configured for converting and encoding the audiovisual data from the output scaler for transmission to the video sink. In an embodiment of the invention the transmitter is an HDCP transmitter . The HDCP transmitter such as an HDMI transmitter converts and encodes the audiovisual data output from the output scaler to one or more TDMS signals for transmission to the video sink over the HDCP interface. In an embodiment of the invention the HDMI transmitter comprises an HDCP transmitter chip and may further comprise TMDS encoders or decoders and other HDMI specific features. The audiovisual data is reencrypted in accordance with the shared secret from authentication between the HCDP repeater and the HDCP sink. The HDCP transmitter receives the native resolution and the native refresh of the sink via a Display Data Channel DDC of the interface. The HDCP interface between transmitter and the HDCP receiver may be HDMI.

In step a switcher device receives audiovisual data at a first input board via an AV link between a first video sink and the first input board.

In step the output board transmits audiovisual data to a video sink over an AV link. In an embodiment of the invention the output board scales the audiovisual data received from the first input board to the native resolution of the video sink step prior to transmitting to the video sink.

In step the processing unit of the switcher device receives a control signal to switch from routing audiovisual data from the first input board to routing audiovisual data from the second input board.

In step the switcher device processing unit transmits a prepare signal to the output board indicating that there will be a switching discontinuity.

In step the output board generates image content data such as a repeating frame of video in response to receiving the prepare signal from the switcher device processing unit . The output scaler outputs the generated image content data rather than the live image content data being routed to the output board from the multiplexer .

In step the output board continues generating video timing data at a native resolution during the delay between receiving audiovisual data from the first input board and receiving audiovisual data from the second input board. By outputting a continuous stream of video timing data the output board may maintain the authenticity of any security link between the output board and the video sink.

In step the switcher device receives audiovisual data at a second input board via an AV link between a second video sink and the second input board.

In step the output board continues generating and outputting image content data i.e. repeating frame of video until video lock is achieved.

In step the output board transmits live image content data routed from the second input board to the video sink over an AV link. In an embodiment of the invention the output board scales the audiovisual data received from the first input board to the native resolution of the video sink step prior to transmitting to the video sink.

The following is a pseudo code representation of the operation in accordance with an illustrative embodiment of the present invention.

Transmit a prepare signal to a processing unit of an output board in response to the detection of the user control signal

In a further embodiment of the invention the switcher device processing unit is configured for determining the network topology of the video distribution network and transmitting an addressed prepare signal to each desired output device.

Certain video distribution networks such as those employed on corporate campuses or educational institutions may comprise one or more switcher devices connected in a complex topology. In addition to being coupled to one or more output boards i.e. output cards output boxes a switcher device may be communicatively coupled with one or more switcher devices to extend the reach and breadth of the video distribution network. In addition a single AV source may be routed to more than one AV sink. For example an AV source may be displayed in multiple conference rooms of a corporate facility. In this example a switcher device may have to route audiovisual data from the multiplexer to more than one output board .

Each successive device adds delay to the switching times during a switching event. Consider as an example a video distribution network in which the first switcher device receives audiovisual data at a first input card and routes to a video sink via an output card coupled to a second switcher device and third switcher device and an output box . In an embodiment in which the first switcher device processing unit transmits a prepare signal to each of its endpoints i.e. . . . which then process and transmit to each of their endpoints until it reaches the desired endpoint a noticeable delay will have been introduced to the switching process.

To reduce the delay caused by transmission of the prepare signal in an embodiment of the invention each switcher device is configured for determining and storing the topology of the video distribution network. The switcher devices may determine the topology upon being employed in the video distribution network upon other devices joining or leaving the video distribution network at periodic time intervals or at any other time. The switcher device may determine the topology of the video distribution network via a network scanning tool or other similar technology.

Upon receiving the control signal to initiate a switching event and prior to transmitting a switch command to the multiplexer the switching processing unit transmits a prepare signal addressed to one or more desired endpoints. A desired endpoint is each endpoint comprising a scalar and transmitting audiovisual data to desired sinks. The endpoint may comprise an output board such as an output card or an output box.

While the switcher processing unit must still transmit via intermediary devices the switcher processing unit need not broadcast to all downstream devices. Advantageously the prepare signal does not have to be processed at each intermediary node in the network which reduces latencies and reduces bandwidth.

In step a switcher device receives audiovisual data at a first input board via an AV link between a first video sink and the first input board.

In step the switcher device routes audiovisual data from the first input board to an output board. The output board may be coupled via intermediate devices such as other switcher devices and output boards.

In step the output board transmits audiovisual data to a video sink over an AV link. In an embodiment of the invention the output board scales the audiovisual data received from the first input board to the native resolution of the video sink step prior to transmitting to the video sink.

In step the processing unit of the switcher device receives a control signal to switch from routing audiovisual data from the first input board to the output board to routing audiovisual data from the second input board to the output board.

In step the switcher device processing unit determines the path to the output board including an output of the switcher device and a network address of the output board from a stored network topology. Using the above example in regard to to first switcher device may determine that the path to an endpoint comprises a third output board of the switcher device.

In step the switcher device processing unit transmits a prepare signal comprising the network address of the output board to the output board indicating that there will be a switching event. The switcher device transmits the addressed prepare signal to the appropriate downstream node according to the topology.

In step the output board generates image content data such as a repeating frame of video in response to receiving the prepare signal from the switcher device processing unit . Upon receiving the prepare signal the output scaler may freeze on a frame of video by continuously outputting that frame. The output scaler outputs the generated image content data rather than the live image content data being routed to the output board from the multiplexer .

In step the output board continues generating video timing data at a native resolution during the delay between receiving audiovisual data from the first input board and receiving audiovisual data from the second input board. By outputting a continuous stream of video timing data the output board maintains the authenticity of the security link between the output board and the video sink.

In step the switcher device receives audiovisual data at a second input board via an AV link between a second video sink and the second input board.

In step the output board continues generating and outputting image content data i.e. repeating frame of video until video lock is achieved.

In step the output board transmits live image content data routed from the second input board to the video sink over an AV link. In an embodiment of the invention the output board scales the audiovisual data received from the first input board to the native resolution of the video sink step prior to transmitting to the video sink.

The following is a pseudo code representation of the operation in accordance with an illustrative embodiment of the present invention.

Transmit a prepare signal comprising network address to a processing unit of the desired output board in response to the detection of the user control signal

The scaler receives input audiovisual data from the receiver comprising video timing data and image content data. The frame rate processing block is configured for receiving the asynchronous input video timing data and writing the incoming image content data into memory . The frame rate processing block is further configured for receiving the free running output video timing data and reading incoming video data from memory as required by the output resolution of the scaler i.e. native resolution of the video sink . The frame rate processing block is further configured for performing frame rate conversion if the input refresh rate and the output refresh rate of the audiovisual data differ.

The input scaling block is configured for receiving the asynchronous input video timing data and performing scaling if required. In certain applications depending on the input and output setups it is advantageous to perform input scaling before frame rate processing. In alternate applications it is advantageous to perform output scaling subsequent to frame rate processing. In these applications the output scaling block receives the free running output video timing data and performs scaling if required.

The free running output timing generator is configured for continuously generating a free running output video timing data used to give the downstream video sink a fixed resolution.

In embodiments in which the output scaler generates audiovisual data comprising a repeated frame of image content data the last frame of video received by the output scaler i.e. the frame to be repeated is repeatedly read from the memory and frame buffer and output by the output scaler . Upon the output scaler achieving scaler lock with audiovisual data from the second source a frame of image content data from audiovisual data received from the second source is read from the memory and frame buffer and output by the output scaler .

Any process descriptions or blocks in flow charts should be understood as representing modules segments or portions of code that include one or more executable instructions for implementing specific logic functions or steps in the process. Alternate implementations are included within the scope of the preferred embodiment of the present invention in which functions may be executed out of order from that shown or discussed including substantial concurrence or reverse order depending on the functionality involved as would be understood by those reasonably skilled in the art of the present invention. Also steps disclosed as separate may be performed concurrently or combined and a step shown as discrete may be performed as two or more steps. Furthermore numerical values and disclosures of specific hardware are illustrative rather than limiting. Moreover while the preferred embodiment has been disclosed in the context of HDMI the invention can be implemented for use with another suitable interface that uses HDCP such as DVI or any substantially HDMI like interface. Therefore the present invention should be construed as limited by only the appended claims.

In this description various functions and operations may be described as being performed by or caused by software code to simplify description. However those skilled in the art will recognize what is meant by such expressions is that the functions result from execution of the code by a processor or processing unit such as a microprocessor. Alternatively or in combination the functions and operations can be implemented using special purpose circuitry with or without software instructions such as using Application Specific Integrated Circuit ASIC or Field Programmable Gate Array FPGA . Embodiments can be implemented using hardwired circuitry without software instructions or in combination with software instructions. Thus the techniques are limited neither to any specific combination of hardware circuitry and software nor to any particular source for the instructions executed by the data processing system.

While some embodiments can be implemented in fully functioning computers and computer systems various embodiments are capable of being distributed as a computing product in a variety of forms and are capable of being applied regardless of the particular type of machine of computer readable media used to actually effect the distribution.

At least some aspects disclosed can be embodied at least in part in software. That is the techniques may be carried out in a computer system or other data processing system in response to its processor processing unit such as a microprocessor executing sequences of instructions contained in a memory such as ROM volatile RAM non volatile memory cache or a remote storage device.

Routines executed to implement the embodiments may be implemented as part of an operating system middleware service delivery platform SDK Software Development Kit component web services or other specific application component program object module or sequence of instructions referred to as computer programs . Invocation interfaces to these routines can be exposed to a software development community as an API Application Programming Interface . The computer programs typically comprise one or more instructions set at various times in various memory and storage devices in a computer and that when read and executed by one or more processors processing units in a computer cause the computer to perform operations necessary to execute elements involving the various aspects.

A machine readable medium can be used to store software and data which when executed by a data processing system causes the system to perform various methods. The executable software and data may be stored in various places including for example ROM volatile RAM non volatile memory and or cache. Portions of this software and or data may be stored in any of these storage devices. Further the data and instructions can be obtained from centralized servers or peer to peer networks. Different portions of the data and instructions can be obtained from different centralized servers and or peer to peer networks. Different portions of the data and instructions can be obtained from different communication sessions or in a same communication session. The data and instructions can be obtained in their entirety prior to the execution of the applications. Alternatively portions of the data and instructions can be obtained dynamically just in time when needed for execution. Thus it is not required that the data and instructions be on a machine readable medium in entirety at a particular instance of time.

Examples of computer readable media include but are not limited to recordable and non recordable type media such as volatile and non volatile memory devices read only memory ROM random access memory RAM flash memory devices floppy and other removable disks magnetic disk storage media optical storage media e.g. Compact Disc Read Only Memory CD ROM Digital Versatile Discs DVDs etc. among others. The instructions may be embodied in digital and analog communication links for electrical optical acoustical or other forms of propagated signals such as carrier waves infrared signals digital signals etc.

In general a machine readable medium includes any mechanism that provides i.e. stores and or transmits information in a form accessible by a machine e.g. a computer network device personal digital assistant manufacturing tool any device with a set of one or more processors etc. .

In various embodiments hardwired circuitry may be used in combination with software instructions to implement the techniques. Thus the techniques are neither limited to any specific combination or hardware circuitry and software nor to any particular source for the instructions executed by the data processing system.

Although some of the drawings illustrate a number of operations in a particular order operations which are not order dependent may be reordered and other operations may be combined or broken out. While some reordering or other groupings are specifically mentioned others will be apparent to those of ordinary skill in the art and so do not present an exhaustive list of alternatives. Moreover it should be recognized that the stages could be implemented in hardware firmware software or any combination thereof.

Although illustrative embodiments of the present invention have been described herein with reference to the accompanying drawings it is to be understood that the invention is not limited to those precise embodiments and that various other changes and modifications may be made therein by one skilled in the art without departing from the scope of the appended claims.

To solve the aforementioned problems the present invention is a unique device in which an output board with a output scaler minimizes switching delay in a video distribution network by outputting a continuous stream of audiovisual data during switching events.

Alternate embodiments may be devised without departing from the spirit or the scope of the invention. For example during switching events the output scaler may generate video information such that a switching graphic will be displayed on the screen or a color other than black.

