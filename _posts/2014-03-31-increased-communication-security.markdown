---

title: Increased communication security
abstract: Authentication data may be generated and included in a Constrained Application Protocol (CoAP) message communicated from a first computer system for delivery to a second computer system. The authentication data may allow the second computer system to perform message validation for verifying the authenticity of the first computer system and/or the integrity of the CoAP message. And in one embodiment, where the CoAP message includes a nonce, security can be improved by allowing the second computer system to advantageously detect and/or act on a replay attack.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09426136&OS=09426136&RS=09426136
owner: EXILANT Technologies Private Limited
number: 09426136
owner_city: Bangalore
owner_country: IN
publication_date: 20140331
---
The present application is related to U.S. patent application Ser. No. 14 231 625 filed Mar. 31 2014 entitled INCREASED COMMUNICATION SECURITY naming Vishnu Sharma as the inventor. The present application is also related to U.S. patent application Ser. No. 14 231 634 filed Mar. 31 2014 entitled INCREASED COMMUNICATION SECURITY naming Vishnu Sharma as the inventor. Those applications are incorporated herein by reference in their entirety and for all purposes.

The Constrained Application Protocol CoAP is a protocol for allowing computer systems or devices to communicate by exchanging messages. The protocol specifies certain parameters related to message format and message exchange rules. Messages sent over CoAP can be relatively small in size and therefore CoAP allows communication between computer systems or devices with limited processing resources and or limited storage resources. These computer systems or devices are sometimes referred to as constrained nodes or constrained devices. 

To address security concerns associated with communication via CoAP messages it has been suggested that messages sent over CoAP use Datagram Transport Layer Security DTLS . Although DTLS can increase the security of communications it does not provide for authentication of the sender of the CoAP message.

Embodiments disclosed herein are directed to increased security for communication of Constrained Application Protocol CoAP messages between computer systems or devices. Authentication data may be generated and included in a CoAP message communicated from a first computer system for delivery to a second computer system. The authentication data may allow the second computer system to perform message validation for verifying the authenticity of the first computer system and or the integrity of the CoAP message. And in one embodiment where the CoAP message includes a nonce security can be improved by allowing the second computer system to advantageously detect and or act on a replay attack.

In one embodiment an apparatus may include a security component configured to generate authentication data. The security component may be further configured to generate a Constrained Application Protocol CoAP message including the authentication data. The apparatus may also include a communication interface configured to communicate the CoAP message.

In another embodiment an apparatus may include a communication interface configured to receive a Constrained Application Protocol CoAP message including authentication data. The apparatus may also include a security component configured to perform message validation based on the authentication data. The apparatus may further include an operation component configured to perform if the CoAP message is valid at least one operation associated with the CoAP message.

And in one embodiment a system may include a first computer system and a second computer system. The first computer system may be configured to generate a Constrained Application Protocol CoAP message including authentication data. The first computer system may be further configured to communicate the CoAP message for delivery to the second computer system. The second computer system may be configured to perform message validation responsive to receiving the CoAP message based on the authentication data.

Reference will now be made in detail to embodiments of the present invention examples of which are illustrated in the accompanying drawings. While the present invention will be discussed in conjunction with the following embodiments it will be understood that they are not intended to limit the present invention to these embodiments alone. On the contrary the present invention is intended to cover alternatives modifications and equivalents which may be included with the spirit and scope of the present invention as defined by the appended claims. Furthermore in the following detailed description of the present invention numerous specific details are set forth in order to provide a thorough understanding of the present invention. However embodiments of the present invention may be practiced without these specific details. In other instances well known methods procedures components and circuits have not been described in detail so as not to unnecessarily obscure aspects of the present invention.

Some regions of the detailed descriptions which follow are presented in terms of procedures logic blocks processing and other symbolic representations of operations on data bits within a computer memory. These descriptions and representations are the means used by those skilled in the art to most effectively convey the substance of their work to others skilled in the art. In the present application a procedure logic block process or the like is conceived to be a self consistent sequence of steps or instructions leading to a desired result. The steps are those requiring physical manipulations of physical quantities. Usually although not necessarily these quantities take the form of electrical or magnetic signals capable of being stored transferred combined compared and otherwise manipulated in a computer system.

It should be borne in mind however that all of these and similar terms are to be associated with the appropriate physical quantities and are merely convenient labels applied to these quantities. Unless specifically stated otherwise as apparent from the following discussions it is appreciated that throughout the present invention discussions utilizing the terms such as aborting accepting accessing activating adding adjusting allocating allowing analyzing applying assembling assigning authenticating authorizing balancing blocking calculating capturing causing changing charging combining comparing collecting communicating configuring controlling converting creating deactivating debugging decreasing defining delivering depicting detecting determining discharging displaying downloading enabling establishing executing forwarding flipping generating grouping hiding identifying ignoring increasing initiating instantiating interacting measuring modifying monitoring moving outputting parsing performing placing presenting processing programming providing provisioning querying receiving reformatting regulating removing rendering repeating resuming retaining sampling simulating selecting sending sorting storing subtracting suspending tracking transcoding transforming transmitting unblocking using validating verifying or the like may refer to the action and or processes of a computer system or similar electronic computing device that manipulates and transforms data represented as physical electronic quantities within the computer system s registers and memories into other data similarly represented as physical quantities within the computer system memories or registers or other such information storage transmission and or display devices.

As shown in CoAP message may include portion associated with a header portion associated with a token portion associated with at least one option portion associated with a payload marker and portion associated with a payload or some combination thereof. Authentication data may be included in portion in one embodiment.

Portion may include one or more sub portions of data. For example as shown in portion may include portion associated with a version portion associated with a message type portion associated with a token length portion associated with a code portion associated with a message identifier some combination thereof etc.

Portion may be data associated with a CoAP version number. In one embodiment portion may be two bits in length. And in other embodiments portion may be larger or smaller than two bits in length.

As shown in portion may be data associated with a message type of CoAP message . For example the message type associated with portion may be confirmable non confirmable acknowledgement reset etc.

In one embodiment portion may be two bits in length. And in other embodiments portion may be larger or smaller than two bits in length.

Portion may be data associated with a length of a token e.g. the length of portion of of CoAP message . In one embodiment portion may be four bits in length. And in other embodiments portion may be larger or smaller than four bits in length.

As shown in portion may be data associated with a code. In one embodiment the code associated with portion may be a method code. For example the code associated with portion may be GET POST PUT DELETE etc. In one embodiment the code associated with portion may be a response code. For example the code associated with portion may be Created Deleted Valid Changed Content Bad Request Unauthorized Bad Option Forbidden Not Found etc.

In one embodiment portion may be eight bits in length. And in other embodiments portion may be larger or smaller than eight bits in length.

Portion may be data associated with a message identifier. The message identifier associated with portion may be used to match or group CoAP messages based on message type e.g. to match or group a confirmable or non confirmable CoAP message with an acknowledgement or reset CoAP message in one embodiment. For example a confirmable or non confirmable CoAP message may be matched or grouped with an acknowledgement or reset CoAP message.

In one embodiment the message identifier associated with portion may be used e.g. in conjunction with a nonce to distinguish a properly re sent message e.g. with a different nonce than a previous message with the same message identifier from a replay attack e.g. resulting from the sending of a message with the same nonce and the same message identifier .

In one embodiment portion may be 16 bits in length. And in other embodiments portion may be larger or smaller than 16 bits in length.

Although shows portion with a specific number and type of portions it should be appreciated that portion may include a different number and or type of portions in other embodiments. For example portion may include fewer portions or at least one additional portion. As another example a plurality of portions of portion may be combined into a smaller number of portions. Although shows portion with a specific organization of portions it should be appreciated that portion may include a different organization of portions in other embodiments.

Turning back to portion may be associated with a token. The token associated with portion may be used to match or group at least one request e.g. one or more CoAP messages to at least one response e.g. one or more other CoAP messages in one embodiment.

In one embodiment portion may be at most eight bits in length. The length of portion may be associated with and or dictated by portion in one embodiment. And in other embodiments portion may be larger than eight bits in length.

As shown in portion may be associated with at least one option. The at least one option associated with portion may include a unique identifier in one embodiment. For example the at least one option associated with portion may include a unique identifier associated with a sender of a CoAP message e.g. computer system computer system etc. . In one embodiment the unique identifier may be included in portion as an option associated with a query e.g. a Uri Query option .

In one embodiment the at least one option associated with portion may include an authentication mechanism identifier. The term authentication mechanism identifier as used herein may be any data or metadata that identifies or is otherwise associated with an authentication mechanism.

For example the at least one option associated with portion may include an authentication mechanism identifier associated with an authentication mechanism used to generate authentication data . In one embodiment the authentication mechanism identifier may be included in portion as an option associated with a query e.g. a Uri Query option .

The at least one option associated with portion may include a nonce in one embodiment. The nonce may be a random number a pseudorandom number a sequential or incremental number e.g. a number with a predetermined offset from the nonce of a previously transmitted CoAP message a timestamp etc. In one embodiment the nonce may be included in portion as an option associated with a query e.g. a Uri Query option .

In one embodiment the at least one option associated with portion may include a max age value. For example the max age value may be used to indicate that the message is not to be cached by an intermediary system or device e.g. situated between the sender of the CoAP message and the ultimate recipient of the CoAP message such as a proxy server or other type of computer system or device.

The at least one option associated with portion may include other data in one embodiment. For example the at least one option associated with portion may include data associated with a host data associated with a port data associated with a path some combination thereof etc. As another example the at least one option associated with portion may include data associated with a query e.g. including at least one parameter . In one embodiment each parameter of the query may be encoded in portion as a respective option.

In one embodiment portion may include one or more respective sub portions of data associated with each option of the at least one option. For example as shown in for each option of the at least one option e.g. etc. portion may include a respective portion associated with an option identifier e.g. etc. a respective portion associated with an option length e.g. etc. a respective portion associated with an option value e.g. etc. etc.

A portion associated with an option identifier e.g. etc. may include data associated with an option number corresponding to an option associated with the portion e.g. option option option etc. . For example where option is associated with a port e.g. a Uri Port option portion may include data associated with a numerical value of 7 e.g. where 7 is the option number corresponding to an option associated with a port as the option identifier. As another example where option is associated with a path e.g. a Uri Path option portion may include data associated with a numerical value of 11 e.g. where 11 is the option number corresponding to an option associated with a path as the option identifier. And as yet another example where option is associated with a query e.g. a Uri Query option portion may include data associated with a numerical value of 15 e.g. where 15 is the option number corresponding to an option associated with a query as the option identifier.

In one embodiment a portion associated with an option identifier e.g. etc. may include data associated with an option delta corresponding to an option associated with the portion e.g. option option option etc. . An option delta may be the difference between the current option number and the option number of the preceding option in one embodiment. For the first option a numerical value of 0 may be used for the option number of the preceding option. A delta of 0 may be used for subsequent instances of the same option.

For example where portion is associated with an option number corresponding to 7 and option is the first option then portion may include data associated with a numerical value of 7 e.g. the delta or difference between 0 and 7 as the option identifier. As another example where portion is associated with an option number corresponding to 7 and portion is associated with an option number corresponding to 11 then portion may include data associated with a numerical value of 4 e.g. the delta or difference between 7 and 11 as the option identifier. As yet another example where portion is associated with an option number corresponding to 11 and portion is associated with an option number corresponding to 15 then portion may include data associated with a numerical value of 4 e.g. the delta or difference between 11 and 15 as the option identifier.

A portion associated with an option length e.g. etc. may include a length of a corresponding portion associated with an option value e.g. etc. . For example where portion includes data associated with a port of 5683 portion may include data associated with a length of two bytes e.g. where two bytes are used to encode a numerical value of 5683 . As another example where portion includes data associated with a path of temperature portion may include data associated with a length of 11 bytes e.g. where 11 bytes are used to encode the path of temperature . As yet another example where portion includes data associated with a unique identifier of uid cs110 portion may include data associated with a length of 9 bytes e.g. where 9 bytes are used to encode the unique identifier of uid cs110 .

Although shows at least one option with a specific number and type of portions it should be appreciated that at least one option may include a different number and or type of portions in other embodiments. For example at least one option may include fewer portions e.g. a smaller number of options a smaller number of respective sub portions associated with each option etc. or at least one additional portion e.g. a larger number of options a larger number of respective sub portions associated with each option etc. . As another example a plurality of portions of at least one option may be combined into a smaller number of portions. Although shows at least one option with a specific organization of portions it should be appreciated that at least one option may include a different organization of portions in other embodiments.

Turning back to portion may be associated with a payload marker. Portion may be included in CoAP message if portion e.g. associated with a payload is included in CoAP message .

Portion may be associated with a payload. In one embodiment portion may include only authentication data . In this case the payload associated with portion may include only authentication data and no other data content etc. Alternatively portion may include data and or content in addition to authentication data . In this case authentication data may be included in the last portion of portion e.g. with other data and or content of the payload preceding authentication data the first portion of portion e.g. with other data and or content of the payload following authentication data an intermediary portion of portion e.g. with other data and or content of the payload both preceding and following authentication data etc.

In one embodiment CoAP message may be associated with a request sent from at least one computer system to at least one other computer system. In this case CoAP message may include data associated with a request for the at least one recipient to perform at least one operation.

Alternatively CoAP message may be associated with a response sent from at least one computer system to at least one other computer system. In this case CoAP message may include data and or content associated with a corresponding request e.g. of a previously communicated CoAP message . For example CoAP message may include data and or content accessed as a result of performing at least one operation requested via a previously communicated CoAP message.

A first CoAP message e.g. associated with a request and a second CoAP message e.g. associated with a response to the request of the first CoAP message may share a common message identifier e.g. associated with data of portion of in one embodiment. A first CoAP message e.g. associated with a request and a second CoAP message e.g. associated with a response to the request of the first CoAP message may share a common token e.g. associated with data of portion of in one embodiment.

In one embodiment where a first CoAP message is associated with a request and a second CoAP message is associated with a response to the request e.g. of the first CoAP message a message type e.g. associated with data of portion as shown in associated with the second CoAP message may correspond to and or be determined by a message type e.g. associated with data of portion as shown in associated with the first CoAP message. For example where the first CoAP message is associated with a message type of confirmable the second CoAP message may be associated with a message type of confirmable or acknowledgement. 

In one embodiment where a first CoAP message is associated with a request and a second CoAP message is associated with a response to the request e.g. of the first CoAP message a response code e.g. associated with data of portion as shown in associated with the second CoAP message may correspond to and or be determined by a method code e.g. associated with data of portion as shown in associated with the first CoAP message. For example where the first CoAP message is associated with a method code of GET the second CoAP message may be associated with a response code of Content e.g. including the data and or content requested using the first CoAP message .

CoAP message A may include data associated with at least one option. For example CoAP message A may include data associated with a host e.g. an option value of www.example.com data associated with a port e.g. an option value of 5683 data associated with a path e.g. an option value of sensors an option value of temperature etc. some combination thereof etc. In this case at least one option associated with CoAP message A may correspond to a URI of coap www.example.com 5683 sensors temperature coap www.example.com sensors temperature coaps www.example.com 5683 sensors temperature coaps www.example.com sensors temperature some combination thereof etc.

As another example CoAP message A may include data associated with a max age value e.g. an option value of 0 . In this case a max age value of 0 may be used to indicate that CoAP message A is not to be cached by an intermediary system or device e.g. situated between the sender of the CoAP message A and the ultimate recipient of the CoAP message A such as a proxy server or other type of computer system or device.

As a further example CoAP message A may include data associated with a query e.g. including one or more parameters . An option value of uid cs110 e.g. associated with a first parameter may be associated with a unique identifier e.g. cs110 of a sender of CoAP message A e.g. computer system . An option value of hs256 1 e.g. associated with a second parameter may be associated with an authentication mechanism e.g. hash based message authentication code HMAC utilizing a hash function of SHA256 used to generate the authentication data e.g. Authentication Data included in CoAP message A. An option value of nonce 1 e.g. associated with a third parameter may be associated with a nonce e.g. with a value of 1 included in CoAP message A.

In one embodiment one or more portions of CoAP message A may be associated with a URI including at least one parameter of a query. For example CoAP message A may be associated with a URI of coap www.example.com 5683 sensors temperature uid cs110 hs256 1 nonce 1 or coaps www.example.com 5683 sensors temperature uid cs110 hs256 1 nonce 1 .

CoAP message A may include data associated with at least one option length. For example CoAP message A may include data associated with a first option length e.g. 15 bytes corresponding to data associated with a first option value e.g. www.example.com a second option length e.g. 2 bytes corresponding to data associated with a second option value e.g. 5683 a third option length e.g. 7 bytes corresponding to data associated with a third option value e.g. sensors etc.

As shown in CoAP message A may include data associated with at least one option identifier. The at least one option identifier may include data associated with an option number and or an option delta in one embodiment. For example CoAP message A may include data associated with a first numerical value e.g. 3 as a first option identifier corresponding to a first option e.g. associated with a host where the first numerical value e.g. 3 may be the delta or difference between the current option number e.g. 3 and the option number of the preceding option e.g. 0 in this case since this is the first option . As such the first numerical value of 3 may correspond to an option number of 3. 

As another example CoAP message A may include data associated with a second numerical value e.g. 4 as a second option identifier corresponding to a second option e.g. associated with a port where the second numerical value e.g. 4 may be the delta or difference between the current option number e.g. 7 and the option number of the preceding option e.g. 3 . As such the second numerical value of 4 may correspond to an option number of 7. 

As a further example CoAP message A may include data associated with a third numerical value e.g. 4 as a third option identifier corresponding to a third option e.g. associated with a path where the third numerical value e.g. 4 may be the delta or difference between the current option number e.g. 11 and the option number of the preceding option e.g. 7 . As such the third numerical value of 4 may correspond to an option number of 11. 

As shown in CoAP message A may include data associated with a payload marker e.g. 0xFF . CoAP message A may include data associated with a payload where the data associated with a payload may include authentication data e.g. Authentication Data .

Although shows CoAP message A with a specific number and type of portions it should be appreciated that CoAP message A may include a different number and or type of portions in other embodiments. For example CoAP message A may include fewer portions or at least one additional portion. As another example a plurality of portions of CoAP message A may be combined into a smaller number of portions. Although shows CoAP message A with a specific organization of portions it should be appreciated that CoAP message A may include a different organization of portions in other embodiments.

In one embodiment data associated with at least one option may be excluded from CoAP message A. For example data e.g. associated with a host a port a path a max age value or some combination thereof used by intermediary systems or devices e.g. situated between the sender of CoAP message A and the ultimate recipient of CoAP message A such as a proxy server or other type of computer system or device may be excluded in one or more embodiments where intermediary systems or devices do not exist or are unlikely to exist.

CoAP message B may include data associated with at least one option. For example CoAP message B may include data associated with a max age value e.g. an option value of 0 . In this case a max age value of 0 may be used to indicate that CoAP message B is not to be cached by an intermediary system or device e.g. situated between the sender of the CoAP message B and the ultimate recipient of the CoAP message B such as a proxy server or other type of computer system or device.

As another example CoAP message B may include data associated with a query e.g. including one or more parameters . An option value of uid cs120 e.g. associated with a first parameter may be associated with a unique identifier e.g. cs120 of a sender of CoAP message B e.g. computer system . An option value of hs256 1 e.g. associated with a second parameter may be associated with an authentication mechanism e.g. hash based message authentication code HMAC utilizing a hash function of SHA256 used to generate the authentication data e.g. Authentication Data included in CoAP message B. An option value of nonce 1 e.g. associated with a third parameter may be associated with a nonce e.g. with a value of 1 included in CoAP message B.

CoAP message B may include data associated with at least one option length. For example CoAP message B may include data associated with a first option length e.g. 1 byte corresponding to data associated with a first option value e.g. 0 a second option length e.g. 9 bytes corresponding to data associated with a second option value e.g. uid cs120 a third option length e.g. 7 bytes corresponding to data associated with a third option value e.g. hs256 1 etc.

As shown in CoAP message B may include data associated with at least one option identifier. The at least one option identifier may include data associated with an option number and or an option delta in one embodiment. For example CoAP message B may include data associated with a first numerical value e.g. 14 as a first option identifier corresponding to a first option e.g. associated with a max age value where the first numerical value e.g. 14 may be the delta or difference between the current option number e.g. 14 and the option number of the preceding option e.g. 0 in this case since this is the first option . As such the first numerical value of 14 may correspond to an option number of 14. 

As another example CoAP message B may include data associated with a second numerical value e.g. 1 as a second option identifier corresponding to a second option e.g. associated with a query where the second numerical value e.g. 1 may be the delta or difference between the current option number e.g. 15 and the option number of the preceding option e.g. 14 . As such the second numerical value of 1 may correspond to an option number of 15. 

As a further example CoAP message B may include data associated with a third numerical value e.g. 0 as a third option identifier corresponding to a third option e.g. associated with a query where the third numerical value e.g. 0 may be the delta or difference between the current option number e.g. 15 and the option number of the preceding option e.g. 15 . As such the third numerical value of 0 may correspond to an option number of 15. 

As shown in CoAP message B may include data associated with a payload marker e.g. 0xFF . CoAP message B may include data associated with a payload where the data associated with a payload may include authentication data e.g. Authentication Data and or other data or content e.g. 22.5 C .

In one embodiment CoAP message A e.g. associated with a request and CoAP message B e.g. associated with a response to the request may share a common message identifier e.g. 0xbc90 . CoAP message A e.g. associated with a request and CoAP message B e.g. associated with a response to the request may share a common token e.g. 0x71 in one embodiment.

In one embodiment a message type associated with CoAP message B e.g. ACK or acknowledgement may correspond to and or be determined by a message type associated with CoAP message A e.g. CON or confirmable . And in one embodiment a response code associated with CoAP message B e.g. Content may correspond to and or be determined by a method code associated with CoAP message A e.g. GET . In this case CoAP message B may include the data or content requested using CoAP message A e.g. the temperature of 22.5 C .

Although shows CoAP message B with a specific number and type of portions it should be appreciated that CoAP message B may include a different number and or type of portions in other embodiments. For example CoAP message B may include fewer portions or at least one additional portion. As another example a plurality of portions of CoAP message B may be combined into a smaller number of portions. Although shows CoAP message B with a specific organization of portions it should be appreciated that CoAP message B may include a different organization of portions in other embodiments.

In one embodiment data associated with at least one option may be excluded from CoAP message B. For example data e.g. associated with a host a port a path a max age value or some combination thereof used by intermediary systems or devices e.g. situated between the sender of CoAP message B and the ultimate recipient of CoAP message B such as a proxy server or other type of computer system or device may be excluded in one or more embodiments where intermediary systems or devices do not exist or are unlikely to exist.

Although shows CoAP message with a specific number and type of portions it should be appreciated that CoAP message may include a different number and or type of portions in other embodiments. For example CoAP message may include fewer portions or at least one additional portion. As another example a plurality of portions of CoAP message may be combined into a smaller number of portions. Although shows CoAP message with a specific organization of portions it should be appreciated that CoAP message may include a different organization of portions in other embodiments. For example authentication data may be included in at least one portion of CoAP message other than portion .

Turning back to computer system and computer system may each include a respective security component e.g. and configured to generate authentication data e.g. to be included in one or more CoAP messages to be communicated and or perform message validation e.g. with respect to at least one received CoAP message and or with respect to authentication data included in at least one received CoAP message . A message generation component e.g. message generation component of computer system message generation component of computer system etc. may generate CoAP messages e.g. including authentication data generated by security component security component etc. to be communicated.

In one embodiment a CoAP message e.g. A B etc. may be generated e.g. using message generation component message generation component etc. based on a uniform resource identifier URI . As an example the URI may be formatted as follows 

The CoAP message e.g. A B etc. including authentication data e.g. Authentication Data Authentication Data etc. may be communicated using Datagram Transport Layer Security DTLS in one embodiment. In this case the CoAP message e.g. A B etc. may be generated e.g. using message generation component message generation component etc. based on a URI that begins with coaps . 

Computer system and computer system may each include a respective operation component e.g. and in one embodiment. An operation component e.g. etc. may be configured to perform at least one operation if a received CoAP message is determined to be valid e.g. based on message validation performed using security component security component etc. .

In one embodiment the at least one operation may include at least one operation associated with a method code e.g. associated with data of portion as shown in in the CoAP message e.g. A B etc. and or at least one operation associated with an option e.g. associated with data of portion as shown in of the CoAP message e.g. A B etc. . For example where a CoAP message e.g. A is associated with a request to get a temperature e.g. with a method code of GET and a Uri Path option of temperature as depicted in the at least one operation e.g. performed by operation component of computer system operation component of computer system etc. may include accessing a temperature e.g. reading a temperature accessing a stored temperature etc. . In this case the operation component e.g. etc. may include a temperature sensor.

The at least one operation may include communication of a second CoAP message e.g. B in one embodiment. For example responsive to determining that a first CoAP message e.g. A etc. is valid the second CoAP message may be communicated from the recipient of the first CoAP message to the sender of the first CoAP message.

In one embodiment the at least one operation may include an operation associated with a request code e.g. associated with data of portion as shown in of the CoAP message e.g. A B etc. . For example where a CoAP message e.g. B is associated with a response including data and or content e.g. with a response code of Content and a payload including data associated with a temperature as depicted in the at least one operation e.g. performed by operation component of computer system operation component of computer system etc. may include processing of the data e.g. to generate business intelligence for charting for analytics etc. performing one or more other operations etc.

If a received CoAP message is determined to be invalid e.g. based on message validation performed using security component security component etc. an operation component e.g. and of computer systems and may be configured to perform at least one other operation. For example the at least one other operation may include ignoring the received CoAP message e.g. not sending a reply to the received CoAP message performing no further processing related to the received CoAP message etc. . As another example the at least one other operation may include limiting access to the recipient e.g. to computer system where the CoAP message is received at computer system to computer system where the CoAP message is received at computer system etc. of the sender e.g. computer system computer system at least one other computer system or device etc. .

As shown in connection may be implemented using communication interface of computer system and communication interface of computer system . Communication interface and communication interface may each include respective hardware and or respective software allowing connection to be established and allowing communication of at least one CoAP message over connection . Communication interface and communication interface may allow unidirectional communication and or bidirectional communication over connection in one embodiment. And in one embodiment communication interface and communication interface may allow contemporaneous or simultaneous bidirectional communication e.g. full duplex communication over connection .

Connection between computer system and computer system may be a wired connection in one embodiment. For example connection may be a IEEE 1394 or FireWire connection PCI Express connection Ethernet connection SATA connection eSATA connection RS 232 connection IC connection etc. In one embodiment connection may be a wireless connection such as a Bluetooth connection Near Field Communication NFC connection infrared IR connection IEEE 802.XX connection cellular connection etc.

In one embodiment computer system and or computer system may have limited processing resources and or limited storage resources. As an example computer system and or computer system may be constrained nodes or constrained devices. In one embodiment a constrained device may be a computer system or device with no larger than an 8 bit microcontroller. And in one or more other embodiments a constrained device may be a computer system or device with at least one microcontroller larger or smaller than 8 bits in size.

As another example computer system and or computer system may communicate over a constrained network such as a 6LowPAN network. In this case connection may be used to implement and or be part of a constrained network. 

Computer system may be a client and computer system may be a server in one embodiment. In this case computer system may communicate requests e.g. CoAP message CoAP message A etc. to computer system and computer system may communicate responses e.g. CoAP message CoAP message B etc. to computer system .

Alternatively computer system may be a server and computer system may be a client in one embodiment. In this case computer system may communicate requests e.g. CoAP message CoAP message A etc. to computer system and computer system may communicate responses e.g. CoAP message CoAP message B etc. to computer system .

Although shows system with a specific number and type of systems or devices it should be appreciated that system may include a different number and or type of systems or devices in other embodiments. For example system may include more than one instance of computer system and or computer system in one or more other embodiments. Where system includes more than one instance of computer system each instance of computer system may communicate with computer system over a respective connection e.g. similar to connection . Where system includes more than one instance of computer system each instance of computer system may communicate with computer system over a respective connection e.g. similar to connection . As such embodiments can increase the security associated with communication of CoAP messages between any number of systems or devices.

Accordingly communication of CoAP messages between systems or devices in accordance with one or more embodiments can be used in one or more applications. For example in the context of home automation a first computer system e.g. may be used to communicate with and or control at least one home appliance or system e.g. a television computer display refrigerator microwave oven door lock security system heating or air conditioning system etc. . In this case each home appliance or system may include at least one respective instance of a second computer system e.g. . As another example in the context of remote data monitoring a first computer system e.g. may be used to remotely monitor at least one parameter e.g. temperature pressure humidity moisture wind speed etc. measured by at least one sensor. In this case each sensor may be included in e.g. as at least a portion of an operational component and or in communication with at least one instance of a second computer system e.g. . The data sent to the first computer system e.g. may be stored and collected e.g. in a database thereby allowing processing of the data e.g. to generate business intelligence for charting for analytics etc. .

As shown in step involves generating authentication data e.g. of Authentication Data of Authentication Data of etc. . In one embodiment the authentication data may be generated in step at a computer system e.g. by security component of computer system by security component of computer system etc. using an authentication mechanism such as HMAC OAuth OAuth 2.0 OpenID etc. And in one embodiment the authentication data e.g. of Authentication Data of Authentication Data of etc. may be generated in step based on message data e.g. accessed in step .

The authentication data may be generated in step based on a key in one embodiment. For example where the authentication mechanism used to generate the authentication data in step is HMAC the authentication data may be generated by performing a hash function e.g. MD5 SHA 1 SHA256 SHA512 etc. on the message data e.g. accessed in step using a key. And in one embodiment the CoAP message e.g. A B etc. may be free of a key used to generate the authentication data in step .

In one embodiment the key may be associated with the sender of the CoAP message e.g. generated in step . For example the key may be a secret key or private key that is unique to the sender e.g. computer system computer system etc. . Alternatively the key may be associated with the recipient of the CoAP message e.g. generated in step . For example the key may be a secret key or private key that is unique to the recipient e.g. computer system computer system etc. .

Where a key associated with the sender of the CoAP message e.g. generated in step is used to generate the authentication data in step the key may be stored locally at the sender in one embodiment. For example the key may be stored locally in a security component e.g. of computer system of computer system etc. in a memory e.g. of computer system of computer system etc. in a database e.g. of computer system of computer system etc. etc. Alternatively the key may be stored remotely e.g. at another system or device and accessed by the sender in a secure manner in one embodiment. Accordingly a key associated with the sender of the CoAP message may be accessed and used by the sender to securely generate the authentication data in step .

Where a key associated with the recipient of the CoAP message e.g. generated in step is used to generate the authentication data in step the sender may access the key based on information about the recipient in one embodiment. For example using data e.g. of which correlates or maps information about systems or devices e.g. unique identifiers to keys the sender e.g. computer system may access a key e.g. Key 2 associated with the recipient e.g. computer system based on information about the recipient e.g. the unique identifier of cs120 associated with computer system other information associated with computer system etc. . In one embodiment the data e.g. of may be stored locally in a security component e.g. of computer system of computer system etc. in a memory e.g. of computer system of computer system etc. in a database e.g. of computer system of computer system etc. etc. Alternatively the data e.g. of may be stored remotely e.g. at another system or device and accessed by the sender in a secure manner in one embodiment. Accordingly a key associated with the recipient of the CoAP message may be accessed and used by the sender to securely generate the authentication data in step .

Although shows data as including a particular amount of data it should be appreciated that a different amount of data may be included in data in other embodiments. Additionally although shows data as including a particular arrangement and type of data it should be appreciated that a different arrangement and or type of data may be included in data in other embodiments.

The size or length of the key e.g. used to generate the authentication data in step may be associated with the authentication mechanism used to generate the authentication data in step . For example where the authentication mechanism of HMAC utilizing a SHA256 hash function is used to generate the authentication data the length of the key may be 32 bytes. As another example where the authentication mechanism of HMAC utilizing a SHA512 hash function is used to generate the authentication data the length of the key may be 64 bytes.

In one embodiment multiple CoAP messages may each include respective authentication data generated based on a key associated with a common system or device. For example where a first CoAP message e.g. A is sent from a first computer system e.g. to a second computer system e.g. and where a second CoAP message e.g. B is sent from the second computer system e.g. to the first computer system e.g. the first CoAP message e.g. A and the second CoAP message e.g. B may each include respective authentication data e.g. Authentication Data and Authentication Data generated based on a key associated with the first computer system e.g. . It should be appreciated that the authentication data e.g. Authentication Data and Authentication Data included in the first and second CoAP messages may be different even though they are generated based on the same key associated with the first computer system since the respective data or content of each CoAP message may be different.

As another example where a first CoAP message e.g. A is sent from a first computer system e.g. to a second computer system e.g. and where a second CoAP message e.g. B is sent from the second computer system e.g. to the first computer system e.g. the first CoAP message e.g. A and the second CoAP message e.g. B may each include respective authentication data e.g. Authentication Data and Authentication Data generated based on a key associated with the second computer system e.g. . It should be appreciated that the authentication data e.g. Authentication Data and Authentication Data included in the first and second CoAP messages may be different even though they are generated based on the same key associated with the second computer system since the respective data or content of each CoAP message may be different.

As shown in step involves generating a CoAP message which includes the authentication data e.g. generated in step . The CoAP message e.g. A B etc. may be generated in step using a message generation component e.g. of the computer system of the computer system etc. in one embodiment. And in one embodiment step may be performed in accordance with process of .

As shown in step involves generating the CoAP message e.g. A B etc. including message data e.g. accessed in step and the authentication data e.g. accessed in step . The CoAP message e.g. A B etc. may be generated in step using a message generation component e.g. of computer system of computer system etc. in one embodiment. In one embodiment step may involve formatting the message data in accordance with CoAP e.g. into one or more portions of CoAP message . The authentication data may be included in or as the payload e.g. associated with portion of CoAP message of the CoAP message e.g. A B etc. in one embodiment.

In one embodiment step may involve further including a payload marker as part of the CoAP message generation. For example where the message data is free of data or content to be included as a payload e.g. and therefore is also free of a payload marker a payload marker may be included as part of the CoAP message in step since the authentication data e.g. accessed in step may be included as the payload e.g. the entire payload of the CoAP message.

In one embodiment step may involve generating a bit stream or byte stream including the message data e.g. accessed in step and the authentication data e.g. accessed in step . The bit stream or byte stream may be formatted in accordance with CoAP in one embodiment.

Although depicts process as including a specific number of steps it should be appreciated that process may include a different number of steps in other embodiments. Although depicts process as including a specific ordering of steps it should be appreciated that process may include a different ordering of steps in other embodiments.

Turning back to step involves communicating the CoAP message e.g. generated in step and or in accordance with one or more steps of process of . In one embodiment step may involve communicating the CoAP message from a first computer system e.g. to at least one other computer system e.g. one or more other systems or devices etc. . And in one embodiment step may involve communicating the CoAP message from a second computer system e.g. to at least one other computer system e.g. one or more other systems or devices etc. .

In one embodiment the CoAP message may be communicated in step over a connection e.g. between computer system and computer system . The CoAP message may be communicated in step as a bit stream or a byte stream in one embodiment. And in one embodiment step may involve communicating the CoAP message using a communication interface e.g. of computer system of computer system etc. .

Accordingly communication security can be increased by including authentication data in CoAP messages communicated between systems or devices. For example the recipient of the CoAP message e.g. A B etc. can perform message validation with respect to the authentication data e.g. included in the CoAP message to verify the authenticity of the sender of the CoAP message and or the integrity of the CoAP message. As another example where the CoAP message e.g. A B etc. includes a nonce e.g. in the data associated with portion in another portion of the CoAP message etc. communication security can be improved by allowing the recipient to detect and or act on a replay attack.

As shown in step involves receiving the CoAP message e.g. A B etc. . In one embodiment step may involve receiving the CoAP message at the second computer system e.g. from another computer system e.g. another system or device etc. . And in one embodiment step may involve receiving the CoAP message at the first computer system e.g. from another computer system e.g. another system or device etc. .

In one embodiment the CoAP message may be received in step over a connection e.g. between computer system and computer system . The CoAP message may be received in step as a bit stream or a byte stream in one embodiment. And in one embodiment step may involve receiving the CoAP message using a communication interface e.g. of computer system of computer system etc. .

Step involves optionally processing the CoAP message e.g. received in step . In one embodiment step may involve processing the CoAP message using a security component e.g. of computer system of computer system etc. . And in one embodiment step may be performed in accordance with process of .

Step may involve determining the length of the authentication data e.g. Authentication Data of CoAP message A Authentication Data of CoAP message B etc. based on the authentication mechanism identifier e.g. accessed in step . For example where the authentication mechanism identifier e.g. hs256 1 of CoAP message A is associated with an authentication mechanism of HMAC utilizing a SHA256 hash function the length of the authentication data may be determined in step to be 32 bytes. As another example where the authentication mechanism identifier is associated with an authentication mechanism of HMAC utilizing a SHA512 hash function the length of the authentication data may be determined in step to be 64 bytes.

As shown in step involves removing a portion of the CoAP message based on the length e.g. determined in step . The portion of the CoAP message removed in step may include at least a portion of the authentication data e.g. . In one embodiment the portion removed in step may be a predetermined portion e.g. the first portion the last portion an intermediary portion etc. of a payload of the CoAP message. For example where the length of the authentication data is determined to be 32 bytes in step step may involve removing the last 32 bytes of the CoAP message.

Step involves determining whether the CoAP message is free of a payload e.g. after removal of the portion in step . If it is determined in step that at least a portion of the payload remains e.g. the CoAP message is not free of the payload then step may be bypassed and process may terminate. Alternatively if it is determined in step that the CoAP message is free of the payload e.g. no other data or content remains after removal of the portion in step then the payload marker e.g. associated with portion of CoAP message may be removed from the CoAP message in step .

Accordingly in one embodiment the payload marker may be removed from the CoAP message where the payload of the CoAP message e.g. received in step includes only the authentication data e.g. Authentication Data of CoAP message A Authentication Data of CoAP message B etc. . This may be used to account for the situation where during message generation e.g. in step and or in accordance with one or more steps of process of the payload marker was included in the CoAP message since the authentication data was included as the payload e.g. the entire payload of the CoAP message.

Although depicts process as including a specific number of steps it should be appreciated that process may include a different number of steps in other embodiments. Although depicts process as including a specific ordering of steps it should be appreciated that process may include a different ordering of steps in other embodiments.

Turning back to step involves performing message validation based on the authentication data e.g. accessed from the CoAP message in step and or in step . In one embodiment the message validation may be used to verify the authenticity of the sender of the CoAP message e.g. A B etc. and or the integrity of the CoAP message e.g. A B etc. . Where the CoAP message e.g. A B etc. includes a nonce e.g. in data associated with portion in another portion of the CoAP message etc. the message validation may be used to detect a replay attack.

In one embodiment message validation may be performed in step by comparing second authentication data to the authentication data e.g. accessed from the CoAP message in step and or in step . The second authentication data may be generated e.g. in step based on at least a portion of the CoAP message e.g. received in step in one embodiment. For example the second authentication data may be generated based on data associated with a header e.g. included in portion of CoAP message data associated with a token e.g. included in portion of CoAP message data associated with at least one option e.g. included in portion of CoAP message data associated with a payload marker e.g. included in portion of CoAP message data associated with at least a portion of a payload e.g. included in portion of CoAP message some combination thereof etc. As another example the second authentication data may be generated based on at least a unique identifier e.g. associated with a sender of the CoAP message included in portion of CoAP message etc. an authentication mechanism identifier e.g. associated with an authentication mechanism used to generate the authentication data included in the CoAP message and or used to generate the second authentication data included in portion of CoAP message etc. a nonce e.g. included in portion of CoAP message etc. or some combination thereof. And as a further example the second authentication data may be generated based on at least a portion of the CoAP message excluding the authentication data e.g. of Authentication Data of Authentication Data of etc. .

The second authentication data may be generated e.g. in step based on a key in one embodiment. For example where the authentication mechanism used to generate the second authentication data is HMAC the second authentication data may be generated by performing a hash function e.g. MD5 SHA 1 SHA256 SHA512 etc. on at least a portion of the CoAP message using a key. And in one embodiment the CoAP message e.g. received in step may be free of a key used to generate the second authentication data.

In one embodiment the key may be associated with the sender of the CoAP message e.g. received in step . For example the key may be a secret key or private key that is unique to the sender e.g. computer system computer system etc. . Alternatively the key may be associated with the recipient of the CoAP message e.g. received in step . For example the key may be a secret key or private key that is unique to the recipient e.g. computer system computer system etc. .

In one embodiment at least one attribute of the generation of the second authentication data in step may be the same as at least one attribute of the generation of the authentication data e.g. in step . For example the second authentication data may be generated based on the same data as the authentication data the second authentication data may be generated based on the same key as the authentication data the second authentication data may be generated using the same authentication mechanism as the authentication data some combination thereof etc.

The message validation may be performed in step using a security component e.g. of computer system of computer system etc. in one embodiment. And in one embodiment step may be performed in accordance with process of .

Step involves optionally accessing a unique identifier from the CoAP message e.g. A B etc. . For example where the CoAP message includes authentication data generated using a key associated with the sender of the CoAP message a unique identifier e.g. associated with the sender of the CoAP message may be accessed from the CoAP message in step by the recipient. In one embodiment the unique identifier may be accessed in step from a portion of the CoAP message associated with at least one option e.g. portion of CoAP message .

As shown in step involves accessing a key. The key may be stored locally at the recipient in a security component e.g. of computer system of computer system etc. in a memory e.g. of computer system of computer system etc. in a database e.g. of computer system of computer system etc. etc. Alternatively the key may be stored remotely e.g. at a system or device other than the recipient and accessed by the recipient in step in a secure manner. As such in accordance with one or more embodiments the key may be accessed e.g. by the recipient in step while limiting other access to the key e.g. by at least one system or device other than the recipient .

The key may be associated with the sender of the CoAP message e.g. received in step in one embodiment. For example the key may be a secret key or private key that is unique to the sender e.g. computer system computer system etc. . Alternatively the key may be associated with the recipient of the CoAP message e.g. received in step . For example the key may be a secret key or private key that is unique to the recipient e.g. computer system computer system etc. .

Where the key is associated with the sender of the CoAP message the recipient may access the key in step based on information about the sender in one embodiment. For example the unique identifier e.g. associated with the sender of the CoAP message accessed in step may be used by the recipient to access the key e.g. associated with the sender in step .

In one embodiment the recipient may access the key e.g. associated with the sender of the CoAP message in step using data e.g. of which correlates or maps information about systems or devices e.g. unique identifiers to keys. The data e.g. of may be stored locally at the recipient in a security component e.g. of computer system of computer system etc. in a memory e.g. of computer system of computer system etc. in a database e.g. of computer system of computer system etc. etc. Alternatively the data e.g. of may be stored remotely e.g. at a system or device other than the recipient and accessed by the recipient in a secure manner.

Where the key is associated with the recipient of the CoAP message the key may be accessed locally by the recipient in step in one embodiment. For example the key e.g. associated with the recipient may be accessed from local storage in a security component e.g. of computer system of computer system etc. in a memory e.g. of computer system of computer system etc. in a database e.g. of computer system of computer system etc. etc. Alternatively the key e.g. associated with the recipient may be accessed remotely e.g. from another system or device in a secure manner by the recipient in step in one embodiment.

As shown in step involves determining whether at least one condition for message invalidity is met. In one embodiment step may be performed in accordance with process of .

If it is determined in step that the CoAP message does not include a unique identifier then it may be determined in step that at least one condition for message invalidity has been met and process may terminate. Alternatively if it is determined in step that the CoAP message includes a unique identifier then step may be performed.

As shown in step involves determining whether the CoAP message e.g. received in step includes a nonce. In one embodiment step may involve determining whether a portion of the CoAP message associated with at least one option e.g. portion of CoAP message includes a nonce.

If it is determined in step that the CoAP message does not include a nonce then it may be determined in step that at least one condition for message invalidity has been met and process may terminate. Alternatively if it is determined in step that the CoAP message includes a nonce then step may be performed.

As shown in step involves determining whether the nonce e.g. included in the CoAP message as determined in step is different from a previous nonce e.g. of a previously transmitted or previously received CoAP message . In one embodiment the recipient of the CoAP message may store at least one previous nonce e.g. from one or more previously transmitted or previously received CoAP messages for comparison with the nonce of the CoAP message.

In one embodiment it may be determined in step whether the nonce is different from another nonce of another CoAP message e.g. of a previously transmitted or previously received CoAP message from the same sender e.g. corresponding to the unique identifier associated with step . For example the recipient of the CoAP message may store at least one previous nonce corresponding to the sender of the CoAP message for comparison with the nonce of the CoAP message.

In one embodiment step may be used to increase communication security by detecting a replay attack. For example if it is determined in step that the nonce is the same as e.g. not different from a previous nonce then it may indicate a malicious re sending of the CoAP message or that the CoAP message is otherwise associated with a replay attack.

If it is determined in step that the nonce is not different from a previous nonce then it may be determined in step that at least one condition for message invalidity has been met and process may terminate. Alternatively if it is determined in step that the nonce is different from a previous nonce then step may be performed.

As shown in step involves determining whether a payload of the CoAP message e.g. received in step is at least a predetermined size. In one embodiment the predetermined size may correspond to an authentication mechanism used to generate authentication data e.g. of Authentication Data of Authentication Data of etc. included in the CoAP message and or an authentication mechanism identifier included in the CoAP message e.g. in a portion of the CoAP message associated with at least one option in portion of CoAP message in another portion etc. .

For example where an authentication mechanism e.g. used to generate the authentication data included in the CoAP message is HMAC utilizing a SHA256 hash function and or where an authentication mechanism identifier e.g. included in the CoAP message is associated with an authentication mechanism e.g. used to generate the authentication data included in the CoAP message of HMAC utilizing a SHA256 hash function the predetermined size used in step may be 32 bytes. As another example where an authentication mechanism e.g. used to generate the authentication data included in the CoAP message is HMAC utilizing a SHA512 hash function and or where an authentication mechanism identifier e.g. included in the CoAP message is associated with an authentication mechanism e.g. used to generate the authentication data included in the CoAP message of HMAC utilizing a SHA512 hash function the predetermined size used in step may be 64 bytes.

In one embodiment step may be used to increase communication security by identifying one or more security risks related to authentication data of the CoAP message. For example if it is determined in step that the payload of the CoAP message is not at least a predetermined size then it may indicate that the CoAP message does not include any authentication data and or that the authentication data is not proper e.g. not of the proper size or length based on an authentication mechanism used to generate the authentication data .

If it is determined in step that the payload of the CoAP message is not at least a predetermined size then it may be determined in step that at least one condition for message invalidity has been met and process may terminate. Alternatively if it is determined in step that the payload of the CoAP message is at least a predetermined size then step may be performed.

As shown in step involves determining if a key has been accessed e.g. in step of process . In one embodiment step may involve determining if a key associated with the recipient of the CoAP message has been accessed. And in one embodiment step may involve determining if a key associated with the sender of the CoAP message has been accessed e.g. based on a unique identifier or other information associated with the sender .

If it is determined in step that a key has not been accessed then it may be determined in step that at least one condition for message invalidity has been met and process may terminate. Alternatively if it is determined in step that a key has been accessed then it may be determined in step that at least one condition for message invalidity has not been met and process may terminate.

Although depicts process as including a specific number of steps it should be appreciated that process may include a different number of steps in other embodiments. For example one or more steps e.g. step or some combination thereof may be omitted in one or more embodiments. Although depicts process as including a specific ordering of steps it should be appreciated that process may include a different ordering of steps in other embodiments.

Turning back to if it is determined in step that at least one condition for message invalidity has been met then it may be determined in step that the CoAP message e.g. received in step is invalid. Alternatively if it is determined in step that at least one condition for message invalidity has not been met then step may be performed.

As shown in step involves generating second authentication data. In one embodiment the second authentication data may be generated in step using an authentication mechanism such as HMAC OAuth OAuth 2.0 OpenID etc. And in one embodiment the authentication mechanism used to generate the second authentication data in step may be the same as the authentication mechanism used to generate e.g. in step the authentication data e.g. included in the CoAP message received in step .

In one embodiment the authentication mechanism used to generate the second authentication data in step may be determined based on an authentication mechanism identifier included in the CoAP message e.g. in portion associated with at least one option . In one embodiment the authentication mechanism used to generate the second authentication data in step may be determined based on at least one other message e.g. including information about an authentication mechanism used to generate the authentication data and or the second authentication data where the at least one other message may be separate from the CoAP message e.g. including the authentication data and may be communicated before or after the CoAP message. And in one embodiment the authentication mechanism used to generate the second authentication data in step may be determined using data stored at the recipient e.g. in security component of computer system in another component of computer system in security component of computer system in another component of computer system in a component of another system or device etc. where the data may be supplied to the recipient by another system or device.

In one embodiment the second authentication data may be generated in step based on at least a portion of the CoAP message e.g. received in step . For example the second authentication data may be generated in step based on data associated with a header e.g. included in portion of CoAP message data associated with a token e.g. included in portion of CoAP message data associated with at least one option e.g. included in portion of CoAP message data associated with a payload marker e.g. included in portion of CoAP message data associated with at least a portion of a payload e.g. included in portion of CoAP message some combination thereof etc. As another example the second authentication data may be generated in step based on at least a unique identifier e.g. associated with a sender of the CoAP message included in portion of CoAP message etc. an authentication mechanism identifier e.g. associated with an authentication mechanism used to generate the authentication data included in the CoAP message and or used to generate the second authentication data in step included in portion of CoAP message etc. a nonce e.g. included in portion of CoAP message etc. or some combination thereof. And as a further example the second authentication data may be generated in step based on at least a portion of the CoAP message excluding the authentication data e.g. of Authentication Data of Authentication Data of etc. .

The second authentication data may be generated in step based on a key in one embodiment. For example where the authentication mechanism used to generate the second authentication data is HMAC the second authentication data may be generated in step by performing a hash function e.g. MD5 SHA 1 SHA256 SHA512 etc. on at least a portion of the CoAP message using a key e.g. accessed in step . And in one embodiment the CoAP message e.g. received in step may be free of a key used to generate the second authentication data in step .

In one embodiment the key may be associated with the sender of the CoAP message e.g. received in step . For example the key may be a secret key or private key that is unique to the sender e.g. computer system computer system etc. . Alternatively the key may be associated with the recipient of the CoAP message e.g. received in step . For example the key may be a secret key or private key that is unique to the recipient e.g. computer system computer system etc. .

Where a key associated with the recipient of the CoAP message e.g. received in step is used to generate the second authentication data in step the key may be stored locally at the recipient in one embodiment. For example the key may be stored locally in a security component e.g. of computer system of computer system etc. in a memory e.g. of computer system of computer system etc. in a database e.g. of computer system of computer system etc. etc. Alternatively the key may be stored remotely e.g. at another system or device and accessed by the recipient in a secure manner in one embodiment. Accordingly a key associated with the recipient of the CoAP message may be accessed and used by the recipient to securely generate the second authentication data in step .

Where a key associated with the sender of the CoAP message e.g. received in step is used to generate the second authentication data in step the recipient may access the key based on information about the sender in one embodiment. For example using data e.g. of which correlates or maps information about systems or devices e.g. unique identifiers to keys the recipient e.g. computer system may access a key e.g. Key 1 associated with the sender e.g. computer system based on information about the recipient e.g. the unique identifier of cs110 associated with computer system . In one embodiment the data e.g. of may be stored locally in a security component e.g. of computer system of computer system etc. in a memory e.g. of computer system of computer system etc. in a database e.g. of computer system of computer system etc. etc. Alternatively the data e.g. of may be stored remotely e.g. at another system or device and accessed by the recipient in a secure manner in one embodiment. Accordingly a key associated with the sender of the CoAP message may be accessed and used by the recipient to securely generate the second authentication data in step .

The size or length of the key e.g. used to generate the second authentication data in step may be associated with the authentication mechanism used to generate the second authentication data in step . For example where the authentication mechanism of HMAC utilizing a SHA256 hash function is used to generate the authentication data the length of the key may be 32 bytes. As another example where the authentication mechanism of HMAC utilizing a SHA512 hash function is used to generate the authentication data the length of the key may be 64 bytes.

As shown in step may involve determining whether the second authentication data e.g. generated in step correlates to the authentication data e.g. included in the CoAP message received in step . If the second authentication data does not correlate to the authentication data then it may be determined in step that the CoAP message e.g. received in step is invalid. Alternatively if the second authentication data correlates to the authentication data then it may be determined in step that the CoAP message e.g. received in step is valid.

In one embodiment message validation e.g. performed in accordance with one or more steps of process may be used to verify the authenticity of the sender of a CoAP message. For example where the authentication data and second authentication data are each generated using at least one key e.g. at least one secret key at least one private key at least one key which is accessible to authorized systems or devices some combination thereof etc. the authenticity of the sender of a CoAP message may be verified if it is determined that the CoAP message is valid in step .

In one embodiment message validation e.g. performed in accordance with one or more steps of process may be used to verify the integrity of a CoAP message. For example where the authentication data and second authentication data are each generated based on data included in the CoAP message e.g. message data other data etc. the integrity of the CoAP message may be verified if it is determined that the CoAP message is valid in step .

Although depicts process as including a specific number of steps it should be appreciated that process may include a different number of steps in other embodiments. Although depicts process as including a specific ordering of steps it should be appreciated that process may include a different ordering of steps in other embodiments.

Turning back to if it is determined in step that the CoAP message e.g. received in step is valid then at least one operation associated with the CoAP message may be performed in step . In one embodiment step may involve performing at least one operation using an operation component e.g. of computer system of computer system etc. .

In one embodiment the at least one operation performed in step may include at least one operation associated with a method code e.g. associated with data of portion as shown in in the CoAP message e.g. A B etc. and or at least one operation associated with an option e.g. associated with data of portion as shown in of the CoAP message e.g. A B etc. . For example where a CoAP message e.g. A is associated with a request to get a temperature e.g. with a method code of GET and a Uri Path option of temperature as depicted in the at least one operation performed in step may include accessing a temperature e.g. reading a temperature accessing a stored temperature etc. . In one embodiment where the at least one operation is performed in step using an operation component e.g. of computer system of computer system etc. the operation component may include a temperature sensor.

The at least one operation performed in step may include communication of a second CoAP message e.g. B in one embodiment. For example responsive to determining that a first CoAP message e.g. A etc. is valid e.g. in step the second CoAP message may be communicated in step from the recipient of the first CoAP message to the sender of the first CoAP message.

The at least one operation performed in step may include an operation associated with a request code e.g. associated with data of portion as shown in of the CoAP message e.g. A B etc. in one embodiment. For example where a CoAP message e.g. B is associated with a response including data and or content e.g. with a response code of Content and a payload including data associated with a temperature as depicted in the at least one operation performed in step may include processing of the data e.g. to generate business intelligence for charting for analytics etc. performing one or more other operations etc.

Alternatively if it is determined in step that the CoAP message e.g. received in step is not valid then at least one other operation associated with the CoAP message may be performed in step . In one embodiment step may involve performing at least one other operation using an operation component e.g. of computer system of computer system etc. .

In one embodiment step may involve acting responsive to a message validation failure such as a triggering of a message invalidity condition e.g. corresponding to one or more steps of process another message validation failure e.g. determined in step and or determined in step etc. etc. And in one embodiment step may involve acting on a suspected or detected replay attack.

In one embodiment the at least one other operation performed in step may include ignoring the received CoAP message e.g. not sending a reply to the received CoAP message performing no further processing related to the received CoAP message etc. . In one embodiment the at least one other operation performed in step may include limiting access to the recipient e.g. to computer system where the CoAP message is received at computer system to computer system where the CoAP message is received at computer system etc. of the sender e.g. computer system computer system at least one other system or device etc. .

In one embodiment one or more steps of process may be repeated with respect to at least one other CoAP message. For example where a first CoAP message is generated and communicated e.g. in accordance with one or more steps of process at least one other CoAP message may be generated and communicated e.g. in accordance with one or more steps of process . In one embodiment the first CoAP message may be a request and the at least one other CoAP message may be at least one response e.g. related to the request of the first CoAP message .

Although depict process as including a specific number of steps it should be appreciated that process may include a different number of steps in other embodiments. Although depict process as including a specific ordering of steps it should be appreciated that process may include a different ordering of steps in other embodiments.

In one embodiment computer system may be used to implement computer system computer system another system or device configured to communicate CoAP messages some combination thereof etc. And in one embodiment one or more components of computer system may be disposed in and or coupled with a housing or enclosure.

In one embodiment computer system may include at least one processor e.g. and at least one memory e.g. . Processor may be or include a central processing unit CPU or other type of processor. Depending on the configuration and or type of computer system environment memory may be or include volatile memory e.g. RAM non volatile memory e.g. ROM flash memory etc. some combination thereof etc. Additionally memory may be removable non removable etc.

In one embodiment computer system may include additional storage e.g. removable storage non removable storage etc. . Removable storage and or non removable storage may include volatile memory non volatile memory some combination thereof etc. Additionally removable storage and or non removable storage may include CD ROM digital versatile disks DVD other optical storage magnetic cassettes magnetic tape magnetic disk storage other magnetic storage devices or any other medium which can be used to store information for access by computer system .

As shown in computer system may communicate with other systems components or devices via communication interface . Communication interface may be used to implement at least one communication interface e.g. etc. of one or more components of system in one embodiment.

Communication interface may embody computer readable instructions data structures program modules or other data in a modulated data signal e.g. a carrier wave or other transport mechanism. By way of example and not limitation communication interface may couple to and or communicate over wired media e.g. a wired network direct wired connection etc. and or wireless media e.g. a wireless network a wireless connection utilizing acoustic RF infrared or other wireless signaling etc. .

Communication interface may also couple computer system to one or more external input components e.g. a keyboard a mouse a trackball a joystick a pen a voice input device a touch input device etc. . In one embodiment communication interface may couple computer system to one or more external output components e.g. a display a speaker a printer etc. . And in one embodiment communication interface may include a plug receptacle cable slot or any other component capable of coupling to and or communicating with another component device system etc.

Input component may include any component capable of receiving or allowing the input of information. For example input component may be or include a keyboard at least one button or key a mouse a trackball a joystick a pen a voice input device a touch input device another type of input component etc. Output component may include any component capable of transmitting or allowing the output of information. For example output component may be or include a display a speaker a printer another type of output component etc.

As shown in graphics processor may perform graphics processing operations on graphical data stored in frame buffer or another memory e.g. etc. of computer system . Graphical data stored in frame buffer may be accessed processed and or modified by components e.g. graphics processor processor some combination thereof etc. of computer system and or components of other systems other devices etc. Additionally the graphical data may be accessed e.g. by graphics processor and displayed on an output device coupled to computer system in one embodiment.

In one embodiment a memory of computer system e.g. memory removable storage non removable storage frame buffer some combination thereof etc. may be a computer readable medium or computer usable medium or computer readable storage medium etc. and may include instructions that when executed by a processor e.g. etc. implement a method of increasing communication security e.g. in accordance with process of generating a CoAP message e.g. in accordance with process of processing a CoAP message e.g. in accordance with process of performing message validation e.g. in accordance with process of determining whether at least one condition for message invalidity is met e.g. in accordance with process of some combination thereof etc. And in one embodiment a computer readable medium of computer system may be implemented in and or using at least one die of at least one integrated circuit e.g. at least one application specific integrated circuit ASIC at least one system on a chip SOC at least one programmable system on a chip PSOC another type of integrated circuit etc. .

In the foregoing specification embodiments have been described with reference to numerous specific details that may vary from implementation to implementation. Thus the sole and exclusive indicator of what is and is intended by the applicant to be the invention is the set of claims that issue from this application in the specific form in which such claims issue including any subsequent correction thereto. Hence no limitation element property feature advantage or attribute that is not expressly recited in a claim should limit the scope of such claim in any way. Accordingly the specification and drawings are to be regarded in an illustrative rather than a restrictive sense.

