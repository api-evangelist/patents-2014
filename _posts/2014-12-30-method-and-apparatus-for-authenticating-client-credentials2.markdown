---

title: Method and apparatus for authenticating client credentials
abstract: An apparatus and method for storing authentication information on an electronic device are provided. The method includes receiving, by the electronic device, a unique key and a certificate matching the unique key in a secure environment of the electronic device, storing the unique key and the certificate matching the unique key in a secure environment of the electronic device, and wherein at least one of the unique key and the certificate matching the unique key identifies the electronic device.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09635014&OS=09635014&RS=09635014
owner: Samsung Electronics Co., Ltd.
number: 09635014
owner_city: Suwon-si
owner_country: KR
publication_date: 20141230
---
This application claims the benefit under 35 U.S.C. 119 e of a U.S. Provisional application filed on Feb. 21 2014 in the U.S. Patent and Trademark Office and assigned Ser. No. 61 942 901 the entire disclosure of which is hereby incorporated by reference.

The present disclosure relates to an apparatus and method for generating and or storing client credentials in a secure area of an electronic device. The present invention also relates to an apparatus and method for generating client authenticating credentials secured by a private key that will never leave the device. In addition the present disclosure relates to an apparatus and method for generating and or authenticating client credentials using a hardware certificate.

As a result of the increasing rate of malicious attacks on networks and or applications current development focuses on improving security for networks and or applications. As part of the security for networks and or applications a user or device must be authenticated with the network and or application before the user or device is granted access to certain resources protected by the network and or application.

The above information is presented as background information only to assist with an understanding of the present disclosure. No determination has been made and no assertion is made as to whether any of the above might be applicable as prior art with regard to the present disclosure.

Aspects of the present disclosure are to address at least the above mentioned problems and or disadvantages and to provide at least the advantages described below. Accordingly an aspect of the present disclosure is to provide an apparatus and method for generating client credentials in an electronic device. Another aspect of the present disclosure is to provide an apparatus and method for authenticating a user using credentials stored in an electronic device.

In accordance with an aspect of the present disclosure an electronic device is provided. The electronic device includes a secure environment wherein the secure environment comprises a unique key a certificate matching the unique key and wherein at least one of the unique key and the certificate matching the unique key identifies the electronic device.

In accordance with another aspect of the present disclosure a method for storing authentication information on an electronic device is provided. The method includes receiving by the electronic device a unique key and a certificate matching the unique key in a secure environment of the electronic device and storing the unique key and the certificate matching the unique key in a secure environment of the electronic device wherein at least one of the unique key and the certificate matching the unique key identifies the electronic device.

In accordance with another aspect of the present disclosure a method for installing a client certificate to a client electronic device is provided. The method includes receiving by an authentication application running on the client electronic device a request for at least one of a client certificate and a key from a server generating by the authentication application at least one of a client certificate and a key communicating by the client electronic device at least one of the generated client certificate and the generated key to the server receiving by the authentication application at least one of a signed client certificate and a key from the server which signed the at least one of the client certificate and the key upon receipt thereof and installing by the authentication application at least one of the signed client certificate and the key.

Other aspects advantages and salient features of the disclosure will become apparent to those skilled in the art from the following detailed description which taken in conjunction with the annexed drawings discloses various embodiments of the disclosure.

Throughout the drawings it should be noted that like reference numbers are used to depict the same or similar elements features and structures.

Detailed descriptions of various aspects of the present disclosure will be discussed below with reference to the attached drawings. The descriptions are set forth as examples only and shall not limit the scope of the present disclosure.

The detailed descriptions with reference to the accompanying drawings are provided to assist in a comprehensive understanding of various embodiments of the disclosure as defined by the claims and their equivalents. It includes various specific details to assist in that understanding but these are to be regarded as merely exemplary. Accordingly those of ordinary skill in the art will recognize that various changes and modifications of the embodiments described herein can be made without departing from the scope and spirit of the disclosure. In addition descriptions of well known functions and constructions are omitted for clarity and conciseness.

The terms and words used in the following description and claims are not limited to the bibliographical meanings but are merely used by the inventor to enable a clear and consistent understanding of the disclosure. Accordingly it should be apparent to those skilled in the art that the following description of various embodiments of the present disclosure are provided for illustration purpose only and not for the purpose of limiting the disclosure as defined by the appended claims and their equivalents.

It is to be understood that the singular forms a an and the include plural referents unless the context clearly dictates otherwise. Thus for example reference to a component surface includes reference to one or more of such surfaces.

By the term substantially it is meant that the recited characteristic parameter or value need not be achieved exactly but that deviations or variations including for example tolerances measurement error measurement accuracy limitations and other factors known to those of skill in the art may occur in amounts that do not preclude the effect the characteristic was intended to provide.

Terms as used in the present disclosure are used to describe the various embodiments of the present disclosure and are not intended to limit the present disclosure. Singular terms are intended to include plural forms unless the context makes it clear that plural forms are not intended.

Unless defined differently all terms used in the present disclosure including technical or scientific terms have meanings that are understood generally by a person having ordinary skill in the art. Ordinary terms that may be defined in a dictionary should be understood to have the meaning consistent with their context and unless clearly defined in the present disclosure should not be interpreted to be excessively idealistic or formalistic.

According to various embodiments of the present disclosure an electronic device may include communication functionality. For example an electronic device may be a smart phone a tablet Personal Computer PC a mobile phone a video phone an e book reader a desktop PC a laptop PC a netbook PC a Personal Digital Assistant PDA a Portable Multimedia Player PMP an MP3 player a mobile medical device a camera a wearable device e.g. a Head Mounted Device HMD electronic clothes electronic braces an electronic necklace an electronic appcessory an electronic tattoo or a smart watch and or the like.

According to various embodiments of the present disclosure an electronic device may be a smart home appliance with communication functionality. A smart home appliance may be for example a television a Digital Video Disk DVD player an audio a refrigerator an air conditioner a vacuum cleaner an oven a microwave oven a washer a dryer an air purifier a set top box a TV box e.g. Samsung HomeSync Apple TV or Google TV a gaming console an electronic dictionary an electronic key a camcorder an electronic picture frame and or the like.

According to various embodiments of the present disclosure an electronic device may be a medical device e.g. Magnetic Resonance Angiography MRA device a Magnetic Resonance Imaging MRI device Computed Tomography CT device an imaging device or an ultrasonic device a navigation device a Global Positioning System GPS receiver an Event Data Recorder EDR a Flight Data Recorder FDR an automotive infotainment device a naval electronic device e.g. naval navigation device gyroscope or compass an avionic electronic device a security device an industrial or consumer robot and or the like.

According to various embodiments of the present disclosure an electronic device may be furniture part of a building structure an electronic board electronic signature receiving device a projector various measuring devices e.g. water electricity gas or electro magnetic wave measuring devices and or the like that include communication functionality.

According to various embodiments of the present disclosure an electronic device may be any combination of the foregoing devices. In addition it will be apparent to one having ordinary skill in the art that an electronic device according to various embodiments of the present disclosure is not limited to the foregoing devices.

According to the related art in order to enhance security of networks and or applications a method for authenticating a user or device uses smart cards or Common Access Cards CACs to support the authentication process. The smart cards or CACs provide trusted credentials that may be confirmed before granting access to certain resource protected by the network and or application. For example the smart cards or CACs may store a private key to be used in association with a public key for various authentication purposes.

A smart card is a physical card having integrated therewith an integrated circuit. Generally smart cards use a Public Key Infrastructure PKI wherein the Integrated Circuit Chip ICC on the smart card stores an encrypted digital certificate issued from a PKI provider. Smart cards are also equipped with tamper resistant technologies.

CACs are generally a subset of smart cards with additional security features. For example CACs may include a visual identification e.g. a picture of the owner a magnetic stripe an ICC a bar code and Radio Frequency Identification RFID technology.

In order to access resources protected by the network and or application which uses a smart card or CAC for authenticating a user a client electronic device with which the user will attempt to access the network and or application may be required to communicate with the applicable smart card or CAC in order to receive e.g. extract the appropriate certificates or to otherwise prove the identity of the smart card or CAC by using private keys stored on the smart card or CAC for authentication. Such an authentication mechanism may be inconvenient to a user because a user is generally required to carry the applicable smart card or CAC e.g. with the client electronic device which may be an enterprise issued electronic device . In addition such an authentication mechanism may require an enterprise to issue smart cards or CACs for users to gain access to the resources protected by the network and or application. The enterprise may also have to issue enterprise issued electronic devices with which a user may use to access the resources protected by the network.

Various embodiments of the present disclosure include an apparatus method and system for authenticating client credentials without smart cards CACs the associated card readers and or the like.

Various embodiments of the present disclosure include an apparatus method and system for authenticating client credentials without the server and or application having to determine whether a client electronic device is compromised. For example various embodiments of the present disclosure include an apparatus and method for authenticating client credentials without the server and or application having to determine whether an Operating System OS and or framework is compromised as a result of security vulnerabilities.

Various embodiments of the present disclosure include an apparatus method and system for authenticating client credentials in which a client electronic device generates certificate signing requests in a zone of the client electronic device which is secure e.g. an ARM TrustZone . Such a zone may be referred to as a secure zone. According to various embodiments of the present disclosure the client electronic device may generate private keys within the secure zone of the client electronic device and the client electronic device may be configured to ensure that the private keys never leave the secure zone of the client electronic device.

According to various embodiments of the present disclosure client credentials e.g. user specific and or application specific credentials may be generated in the secure zone e.g. the SEE of the electronic device using a high entropy hardware backed key generator. The client credentials may be randomly generated in the electronic device.

Various embodiments of the present disclosure include an apparatus method and system for storing client credentials in a secure zone of the client electronic device. For example in contrast to the related art in which the smart card stores an encrypted digital certificate issued from a PKI provider various embodiments of the present disclosure may include an apparatus method and system for storing an encrypted digital certificate in the secure zone of the client electronic device. The secure zone of the client electronic device may store one or more private keys and or certificates.

Various embodiments of the present disclosure include an apparatus and method for authenticating client credentials using a standard cryptographic module. For example the apparatus and method may be configured to use Public Key Cryptography Standards 11 PKCS11 for authenticating the client credentials. The apparatus and method may use a PKCS11 Application Programming Interface API for providing authentication. Because networks and or applications that use smart cards for authentication generally use PKCS11 APIs the apparatus and method according to various embodiments of the present disclosure may seamlessly integrate with such existing systems.

According to various embodiments of the present disclosure a non secure zone e.g. a Normal Execution Environment NEE may communicate with the secure zone e.g. the SEE using PKCS11 or similar protocol.

According to various embodiments of the present disclosure unique credentials may be installed on the electronic device e.g. the client electronic device . For example the unique credentials may be installed in a secure zone e.g. a special Secure Execution Environment SEE of the electronic device. The unique credentials may be installed during manufacture of the electronic device. The unique credentials may comprise a unique key and a corresponding certificate. The unique credentials may be accessible only within the secure zone e.g. the SEE . For example the unique credentials may be accessible only by applications e.g. SEE applications within the secure zone e.g. the SEE . The unique credentials may include data identifying the electronic device. For example the certificate of the unique credentials may include the data identifying the electronic device. The data may be human readable and or machine readable. According to various embodiments of the present disclosure the root certification authority may be the electronic device manufacture.

According to various embodiments of the present disclosure a remote enterprise or government Information Technology IT management system trusting the manufacturer may reliably identify the device based on the cryptographic evidence.

According to various embodiments of the present disclosure trust and reliability may be strengthened by SEE run time measurements that verify that the firmware is unaltered. For example the SEE may ensure that the electronic device is in an uncompromised state. In particular the SEE may ensure that the electronic device is in an uncompromised state when the SEE performs an authentication service.

According to various embodiments of the present disclosure a device manager such as an enterprise e.g. an enterprise network may create e.g. generate credentials for an electronic device e.g. a client electronic device or user thereof. For example after an electronic device is identified by an enterprise the enterprise may create user specific and or application specific credentials for the electronic device. The user specific and or application specific credentials may be securely stored e.g. installed in the secure zone e.g. the SEE of the electronic device.

According to various embodiments of the present disclosure a credential e.g. a certificate may be signed by an external Certification Authority CA and provisioned securely using an established protocol e.g. Simple Certificate Enrollment Protocol SCEP Certificate Management Protocol CMP Certificate Management over CMS CMC and or the like .

According to various embodiments of the present disclosure credentials stored e.g. installed in the secure zone e.g. the SEE will never leave the SEE. The secure zone e.g. the SEE will prevent communication of credentials stored therein to an entity e.g. an application an electronic device and or the like outside the secure zone e.g. the SEE .

According to various embodiments of the present disclosure credentials may be securely passed e.g. communicated to the secure zone e.g. the SEE of an electronic device. For example user credentials application credentials and or the like may be securely passed to the secure zone e.g. the SEE of the electronic device using a Trusted User Interface TUI .

According to various embodiments of the present disclosure passwords may be securely transferred e.g. communicated to the secure zone e.g. the SEE by controlling indirect access to the credentials. For example PKCS11 passwords may be securely transferred to the secure zone e.g. the SEE controlling indirect access to private keys stored therein.

According to various embodiments of the present disclosure keylogger attacks may be thwarted and failed login attempts may be securely recorded. For example a trusted user interface is used to access the credentials. In order to access the credentials a password may be required. Accordingly in order to ensure that the credentials remain secure the trusted user interface may prevent keylogging of the passwords and or the like particularly in relation to accessing the credentials.

According to various embodiments of the present disclosure credentials may be non transferable between electronic devices. For example the keys e.g. the private keys and certificates are non transferable from electronic device to electronic device. The keys e.g. the private keys and corresponding certificates may be device specific. According to various embodiments of the present disclosure cryptographic data may be safeguarded using device unique encryption. Cryptographic data can be protected in high security storage e.g. a Secure Element SE . Storing the cryptographic data in a high security storage may make the cryptographic data resistant to hardware based attacks.

Referring to a network environment includes an electronic device e.g. a client electronic device . The electronic device may include a bus a processor a memory an Input Output I O interface a display a communication interface a security module and or the like.

The bus may be circuitry that connect the foregoing components and allow communication between the foregoing components. For example the bus may connect components of the electronic device so as to allow control messages and or other information to be communicated between the connected components.

The processor may for example receive instructions from other components e.g. the memory the I O interface the display the communication interface the security module and or the like interpret the received instructions and execute computation or data processing according to the interpreted instructions.

The memory may for example store instructions and or data that are received from and or generated by other components e.g. the memory the I O interface the display the communication interface the security module and or the like . For example the memory may include programming modules such as a kernel a middleware an Application Programming Interface API an application and or the like. Each of the foregoing programming modules may include a combination of at least two of software firmware or hardware.

The kernel may control or manage system resources e.g. the bus the processor the memory and or the like that may be used in executing operations or functions implemented in other programming modules such as for example the middleware the API the application and or the like. The kernel may provide an interface for allowing or otherwise facilitating the middleware the API the application and or the like to access individual components of the electronic device .

The middleware may be a medium through which the kernel may communicate with the API the application and or the like to send and receive data. The middleware may control e.g. scheduling load balancing and or the like work requests by one or more applications . For example the middleware may control work requests by the one or more applications by assigning priorities for using system resources e.g. the bus the processor the memory and or the like of the electronic device to the one or more applications .

The API may be an interface that may control functions that the application may provide at the kernel the middleware and or the like. For example the API may include at least an interface or a function e.g. command for file control window control video processing character control and or the like.

According to various embodiments of the present disclosure the application may include a Short Message Service SMS application a Multimedia Messaging Service MMS application an email application a calendar application an alarm application a health care application e.g. an exercise amount application a blood sugar level measuring application and or the like an environmental information application e.g. an application that may provide atmospheric pressure humidity temperature information and or the like an instant messaging application a call application an internet browsing application a gaming application a media playback application an image video capture application a file management application and or the like. In addition to or as an alternative to the application may be an application that is associated with information exchange between the electronic device and an external electronic device e.g. electronic device . As an example the application that is associated with the information exchange may include a notification relay application that may provide the external electronic device with a certain type of information a device management application that may manage the external electronic device and or the like.

As an example the notification relay application may include a functionality that provides notification generated by other applications at the electronic device e.g. the SMS MMS application the email application the health care application the environmental information application the instant messaging application the call application the internet browsing application the gaming application the media playback application the image video capture application the file management application and or the like to an external electronic device e.g. the electronic device . In addition to or as an alternative to the notification relay application may provide for example receive notification from an external electronic device e.g. the electronic device and may provide the notification to a user.

As an example the device management application may manage enabling or disabling of functions associated with least a portion of an external electronic device e.g. the external electronic device itself or one or more components of the external electronic device in communication with the electronic device controlling of brightness or resolution of a display of the external electronic device an application operated at or a service e.g. a voice call service a messaging service and or the like provided by the external electronic device and or the like.

According to various embodiments of the present disclosure as an example the application may include one or more applications that are determined according to a property e.g. type of electronic device and or the like of the external electronic device e.g. the electronic device . For example if the external electronic device is an mp3 player the application may include one or more applications related to music playback. As another example if the external electronic device is a mobile medical device the application may be a health care related application. According to various embodiments of the present disclosure the application may include at least one of an application that is preloaded at the electronic device an application that is received from an external electronic device e.g. the electronic device a server an enterprise network and or the like and or the like.

The I O interface may for example receive instruction and or data from a user. The I O interface may send the instruction and or the data via the bus to the processor the memory the communication interface the security module and or the like. For example the I O interface may provide data associated with user input received via a touch screen to the processor . The I O interface may for example output instructions and or data received via the bus from the processor the memory the communication interface the security module and or the like via an I O device e.g. a speaker a display and or the like . For example the I O interface may output voice data e.g. processed using the processor via a speaker.

The display may display various types of information e.g. multimedia text data and or the like to the user. As an example the display may display a Graphical User Interface GUI with which a user may interact with the electronic device .

The communication interface may provide communication between the electronic device and one or more external electronic devices e.g. the electronic device the server and or the like . For example the communication interface may communicate with the external electronic device by establishing a connection with a network using wireless or wired communication. As an example wireless communication with which the communication interface may communicate may be at least one of Wi Fi Bluetooth Near Field Communication NFC Global Positioning System GPS cellular communication e.g. Long Term Evolution LTE LTE Advanced LTE A Code Division Multiple Access CDMA Wideband CDMA WDCMA Universal Mobile Telecommunications System UMTS Wireless Broadband WiBro Global System for Mobile Communications GSM and or the like Infrared Data Association IrDA technology and or the like. As an example wired communication with which the communication interface may communicate may be at least one of for example Universal Serial Bus USB High Definition Multimedia Interface HDMI Recommended Standard 232 RS 232 Plain Old Telephone Service POTS Ethernet and or the like.

According to various embodiments of the present disclosure the network may be a telecommunications network. As an example the telecommunications network may include at least one of a computer network the Internet the Internet of Things a telephone network and or the like. According to various embodiments of the present disclosure a protocol e.g. a transport layer protocol a data link layer protocol a physical layer protocol and or the like for communicating between the electronic device and an external electronic device may be supported by for example at least one of the application the API the middleware the kernel the communication interface and or the like.

The security module may for example process at least a part of information received from other components e.g. the processor the memory the I O interface the communication interface and or the like and provide various information services and or the like to the user in various manners. For example the security module may control via the processor or independently at least some of the functions of the electronic device to authenticate the electronic device in relation to another electronic device e.g. the electronic device the server and or the like . will provide additional information regarding the security module .

Referring to a secure zone may include the security module illustrated in . According to various embodiments of the present disclosure the security module may reside outside the secure zone .

According to various embodiments of the present disclosure the secure zone may be an area or environment of an electronic device with additional security relative to a normal zone of the electronic device. For example an electronic device may include a normal operating environment e.g. a normal zone and a secure operating environment e.g. a secure zone . The secure zone may have a hardware guarantee that integrity of the applications data and or the like within the secure zone are not compromised.

According to various embodiments of the present disclosure only preloaded applications may be loaded in the secure zone . For example only applications data and or the like that are installed by a manufacturer e.g. an Original Equipment Manufacturer OEM manufacturer of an electronic device may be executed in the secure zone thereof. In other words applications data and or the like that are not installed by the OEM manufacturer may not be executed in the secure zone e.g. other entities may not have the requisite permissions to install applications data and or the like in the secure zone . According to various embodiments of the present disclosure new information may be stored in the secure zone and such new information may be used by preexisting applications and or the like in the secure zone . For example a credential may be stored in the secure zone and an authentication application or the like which was installed in the secure zone by the OEM manufacturer may use the information newly stored in the secure zone .

According to various embodiments of the present disclosure an OEM manufacturer may install a unique credential and a matching certificate in the secure zone of the electronic device. For example the OEM manufacturer may install a unique key e.g. a private key and a matching certificate in the secure zone of the electronic device. The certificate may include may include specific device information e.g. a device IDentifier ID . The certificate may be signed by an OEM root key. Accordingly if an enterprise trusts the OEM manufacturer then the enterprise may use the factory generated certificate in the authentication process. Thereafter an enterprise manager may leverage e.g. use the unique key e.g. the private key and the certificate installed in the secure zone for a secondary authentication. As a result the need for an extra token in the process of secondary authentication that is required by related art is eliminated.

According to various embodiments of the present disclosure an enterprise does not need to worry about securely pushing a private key to the electronic device e.g. because the private key may be generated in the secure zone or may be installed by the OEM manufacturer at for example the time of manufacture of the electronic device . Otherwise if the enterprise is required to push or otherwise install the private key or other credential on the electronic device then the private key may be vulnerable to a compromise in the security thereof. For example from the time that the enterprise generates the private key to the time that the private key is installed in the secure zone a malicious party may intercept or otherwise compromise the security of the private key. Consequently generating the private key within the secure zone or installing the private key in the secure zone at the time of manufacture ensures that the private key is secure at all times. The electronic device may thereafter send a public key corresponding to the private key stored in the secure zone to the enterprise.

As illustrated in the security module may include a certificate installation module a key generation module a keyless file generation module and or the like.

According to various embodiments of the present disclosure the security module may be used for authenticating an electronic device e.g. a client electronic device . The security module may ensure that all services that the security module provides are trusted boot based services. According to various embodiments of the present disclosure the security module may accept installation of private keys and certificates e.g. from an OEM manufacturer an enterprise network a user and or the like . According to various embodiments of the present disclosure the security module may generate a key and issue a certificate signing request upon receipt of a request therefor. According to various embodiments of the present disclosure the security module may be accessible via a standard encryption module or protocol e.g. PKCS11 APIs . According to various embodiments of the present disclosure the security module may support Transport Layer Security TLS applications such as WiFi Extensible Authentication Protocol EAP TLS applications Virtual Private Network VPN applications e mail applications and or the like.

According to various embodiments of the present disclosure the certificate installation module may be configured to for example operatively receive a client certificate from a server and install a client certificate e.g. a signed client certificate to a secure zone of the client electronic device. The certificate installation module may wrap and store a private key and or certificate. The certificate installation module may determine whether a token directory exists for a specific client and create an applicable token directory if a token directory is determined not to exist for the specific client. The certificate installation module may create and wrap a PIN file in the token directory e.g. with a device key SHK PIN for the specific client. For example the certificate installation module may wrap and store a private key and or certificate so as to wrap e.g. with SHK PIN provided information and store the result in a new token file if the data types correspond to a specified data type e.g. TZ CCM RAW PRIV KEY TZ CCM CERT and or the like . As another example the certificate installation module may unwrap a private key and or certificate of a specific data type e.g. TZ CCM WRAP PRIV KEY and or the like and wrap the result with a certain wrapper e.g. SHK PIN . The certificate installation module may provide an indication of e.g. report on a success or internal errors.

According to various embodiments of the present disclosure the key generation module may be configured to for example generate a key. For example the key generation module may generate an RSA key pair. As another example the key generation module may multiplex or wrap a private key with a device key. The key generation module may return the private key wrapped with the device key along with a public key. The key general module may be configured to generate the key e.g. the private key such that the private key never exists or otherwise communicated outside the secure zone .

According to various embodiments of the present disclosure the keyless file generation module may be configured to for example create a file e.g. a keyless file that may be used to indicate that a registration has been made. The keyless file generation module may provide an indication of e.g. report on a success or internal errors.

According to various embodiments of the present disclosure the security module may be configured to perform a trusted boot check. The security module may perform a trusted boot check to confirm whether the electronic device was boot to a known state e.g. an uncompromised state . As an example the secure zone may include an application and or the like that detects whether the electronic device boots to a known state e.g. an uncompromised state . The application and or the like included in the secure zone may be considered a secure application because the application and or the like resides in the secure zone . If the electronic device is determined to not boot to a known state e.g. if the electronic device is determined to have boot to a compromised state then the electronic device may prevent performing any authentications encryptions decryptions and or the like using an application data and or the like residing in the secure zone . For example if the secure zone determines that the electronic device has boot to a compromised state e.g. that the electronic device is compromised then the secure zone may not perform any authentications encryptions decryptions and or the like using an application data and or the like residing in the secure zone . The secure zone may not use the privet key stored therein if the electronic device e.g. the secure zone determines that the electronic device was boot to an unknown state e.g. a compromised state .

Referring to a user may attempt to connect to an enterprise network with a client electronic device e.g. a smartphone via an approved electronic device e.g. a corporate liable laptop . For example the user may attempt to connect to the enterprise network to gain access to resources protected by the enterprise network

According to various embodiments of the present disclosure the client electronic device may communicate with the approved electronic device using at least one communication technology and or protocol. For example the client electronic device and the approved electronic device may communicate using Bluetooth technology WiFi Direct technology NFC technology IrDA technology and or the like.

The enterprise network may attempt to authenticate the user before granting the user access to the enterprise network . For example the enterprise network may request that the user prove the user s identity using a first factor authentication. As an example the first factor authentication may include the user entering user credentials.

The approved electronic device communicates with the client electronic device for performing a second factor authentication. For example the approved electronic device may communicate with the client electronic device in order to retrieve the applicable certificates e.g. security certificates and to satisfy requirements to prove the existence of the associated private keys. The approved electronic device may communicate the applicable certificates to the enterprise network

Referring to a user may attempt to connect to an enterprise network with a client electronic device e.g. a smartphone . For example the user may attempt to connect to the enterprise network to gain access to resources protected by the enterprise network

According to various embodiments of the present disclosure the client electronic device comprises trusted credentials that the enterprise network may use to authenticate the client electronic device to determine whether the client electronic device is an approved electronic device e.g. an electronic device permitted to gain access to the enterprise network . According to various embodiments of the present disclosure the enterprise network does not need to determine the level of security of the client electronic device e.g. determine whether security of the client electronic device is compromised . For example the trusted credentials may be stored in a secure zone e.g. a secure environment of the client electronic device . The authenticity and or security of the trusted credentials may be hardware guaranteed by the client electronic device

According to various embodiments of the present disclosure the client electronic device may be configured to include a hardware module that may enforce a separation of data that is identified as secure from data that is not identified as secure. For example the hardware module may isolate secure data from insecure data e.g. so as to create a secure environment storing and otherwise using secure data or applications associated therewith . The hardware module may secure memory storing secure data from software operations e.g. malicious software attacks . According to various embodiments of the present disclosure the client electronic device includes an integrated authentication module.

According to various embodiments of the present disclosure the client electronic device may include a zone of memory that may store secure data e.g. in isolation from insecure data .

According to various embodiments of the present disclosure an authentication application e.g. a Client Certificate Management CCM application may be stored in the zone of memory used to store secure data e.g. a memory of the secure zone . The authentication application may determine a security state of the client electronic device . For example the authentication application may determine whether the client electronic device is compromised. The authentication application may determine whether the client electronic device is compromised by performing a trusted boot check. According to various embodiments of the present disclosure the authentication application may determine whether to provide services according to the determination of the security state of the client electronic device . For example if the authentication application determines that the client electronic device is secure e.g. that the client electronic device is not compromised then the authentication application may determine to provide an applicable service e.g. an authentication service such as for example signing a certificate . In contrast if the authentication application determines that the client electronic device is not secure e.g. that the client electronic device is compromised then the authentication application may determine not to provide applicable services. For example in response to determining that the client electronic device is not secure the authentication application may prevent the client electronic device from performing an authentication service e.g. signing a certificate or otherwise using a private key stored in the secure zone .

According to various embodiments of the present disclosure the authentication application may be a virtual smartcard.

According to various embodiments of the present disclosure the secure zone may store a client certificate that may be installed by an enterprise network or an administrator thereof. For example the enterprise network or the administrator thereof may install the client certificate into the authentication application.

According to various embodiments of the present disclosure an enterprise network may securely authenticate a client electronic device that is performing an authentication process and that provides the applicable client certificate. For example because the authentication application may prohibit the authentication process or the communication of the client certificate when the client electronic device is in a compromised state the enterprise network may infer that a client electronic device performing the authentication process and providing the applicable client certificate is an authenticated device.

According to various embodiments of the present disclosure the enterprise network may use a certificate already loaded e.g. installed on the client electronic device . For example a client electronic device may be preloaded with a certificate signed by the OEM s root key. The certificate may comprise metadata that uniquely identifies the client electronic device e.g. an International Mobile Station Equipment Identity IMEI a WiFi Media Access Control MAC address and or the like . Accordingly rather than installing a client certificate into the client electronic device the enterprise network may register the client electronic device into the enterprise network using the certificate already loaded on the client electronic device . According to various embodiments of the present disclosure if the enterprise network registers the client electronic device using a certificate already loaded on the client electronic device then the enterprise network may ensure that the certificate comprises a unique identifier of the client electronic device e.g. the IMEI address the WiFi MAC address and or the like and or ensure that the certificate is signed by the applicable OEM root key.

Referring to at operation the client electronic device generates credential within the secure zone of the client electronic device. For example the client electronic device may generate a private key public key pair. The client electronic device may generate the private key public key pair within the secure zone of the client electronic device. The client electronic device may generate the private key public key pair in response to a request from an enterprise network e.g. a server . For example the client electronic device may generate the private key public key pair during a registration process in which the client electronic device registers with e.g. as an approved user of the enterprise network.

At operation the client electronic device may communicate a certificate signing request to the enterprise network. The client electronic device may communicate the public key e.g. that is associated with the generated private key to the enterprise network.

At operation the enterprise network may generate e.g. create a certificate for the private key public key pair. The enterprise network may generate the certificate using the public key.

At operation the enterprise network may communicate the certificate to the client electronic device. The enterprise network may communicate the certificate to the client electronic device as part of an authentication procedure e.g. to validate the electronic device . For example in response to an attempt to access the enterprise network the enterprise network may communicate the certificate to the client electronic device. As another example the enterprise network may communicate the certificate to the client electronic device during registration of the client electronic device with the enterprise network.

At operation the client electronic device may sign the certificate using the generated credential within the secure zone of the client electronic device. For example the client electronic device may sign the certificate using the generated private key stored within the secure zone of the client electronic device. The client electronic device may sign the certificate using the private key in response to a request from the enterprise network. For example the enterprise network may request a signed certificate from the client electronic device in response to a request to access the enterprise network.

At operation the client electronic device may communicate the signed certificate to the enterprise network.

At operation the enterprise network may validate the client electronic device using the signed certificate. For example the enterprise network may confirm that the certificate was signed by the private key. The enterprise network may use the public key to confirm that the certificate was signed by the private key. If the enterprise network determines that the certificate was signed by the private key e.g. that the client electronic device has been validated then the enterprise network may provide access thereto to the client electronic device.

Referring to at operation the client electronic device may operatively receive a request for a new client certificate from an enterprise e.g. an enterprise network such as a Mobile Device Management MDM server . For example an authentication application e.g. the CCM application installed on the client electronic device may receive the request for a new client certificate. The authentication application may be stored or otherwise installed in a secure zone of the client electronic device. For example the authentication application may be executed in a secure environment of the client electronic device. The authentication application may receive the request for a new client certificate directly from the enterprise network e.g. the MDM server or from the enterprise network e.g. the MDM server via a security agent e.g. a KNOX agent . The security agent e.g. the KNOX agent may reside on the client electronic device. For example the security agent e.g. the KNOX agent may reside in a non secure zone of the client electronic device e.g. the security agent may be executed in a normal operating environment of the client electronic device .

If the authentication application receives a request for a new client certificate at operation then the authentication application may generate a key. For example the authentication application may generate an RSA key pair e.g. an RSA key pair having 2048 bit 65537 exponent . The authentication application may return a public key and a wrapped private key. The wrapped private key may be a private key wrapped with a device key. The authentication application may return the public key and the wrapped private key through buffers managed by a caller.

According to various embodiments of the present disclosure the authentication application may load a key generator API e.g. tz ccm generate key when the authentication application receives the request for a new client certificate. According to various embodiments of the present disclosure the key generator API may generate the wrapped private key. The key generator API may be stored or otherwise installed in the secure zone of the client electronic device. The key generator API may be executed in the secure environment of the client electronic device.

Thereafter at operation the authentication application may communicate e.g. transmit the public key to the enterprise network e.g. the MDM server . The authentication application may communicate the public key to the enterprise network e.g. the MDM server via the security agent . According to various embodiments of the present disclosure the authentication application may communicate the public key along with a Certificate Signing Request CSR . According to various embodiments of the present disclosure the security agent e.g. the KNOX agent may communicate a CSR to the enterprise network e.g. the MDM server upon receiving the private key.

The enterprise network e.g. the MDM server or an applicable authenticating authority may sign the CSR and store the client certificate.

Thereafter at operation the enterprise network e.g. the MDM server may communicate the signed client certificate to the client electronic device e.g. the authentication application . The enterprise network e.g. the MDM server may communicate the signed client certificate to the client electronic device via a push communication technology.

According to various embodiments of the present disclosure upon receipt of the signed client certificate the client electronic device may store and or install the signed client certificate. As an example the authentication application may install the signed client certificate. The authentication application may load a certificate installation API e.g. tz ccm intall client ccm when the authentication application receives the signed client certificate. The certificate installation API may install the signed client certificate. The certificate installation API may install the signed client certificate with a private key. As an example the certificate installation API may install an x509 signed client certificate with a private key.

Thereafter at operation the client electronic device the enterprise network e.g. the MDM server may encrypt decrypt services provided to the authentication application through a specific encryption module or protocol e.g. using a PKCS11 interface .

According to various embodiments of the present disclosure the enterprise network e.g. the MDM server may communicate with the client electronic device e.g. the security agent and or the authentication application using a security protocol. For example the enterprise network e.g. the MDM server may communicate with the client electronic device e.g. the security agent and or the authentication application using a Secure Sockets Layer SSL protocol and the installed client certificate and a generated key e.g. generated by the authentication application . The enterprise network e.g. the MDM server may authenticate the client electronic device by validating the client certificate and the generated key.

According to various embodiments of the present disclosure the authenticating party e.g. the enterprise network such as the MDM server may authenticate a client electronic device using a certificate signed by the client electronic device using the private key stored in the secure zone of the client electronic device. For example the authenticating party may authenticate a client electronic device using a key pair e.g. a private key and a public key generated within a secure zone of the client electronic device. According to various embodiments of the present disclosure the combination of the enterprise signed certificate and the key generated within the client electronic device is unique to the client electronic device and the enterprise. As an example authentication of the client electronic device is based on the PIN UID established during installation of the signed client certificate. According to various embodiments of the present disclosure because of the unique combination of the enterprise signed certificate and the key generated within the client electronic device and the enterprise does not need to be concerned about securely pushing the signed client certificate to the client electronic device.

Referring to a token organization is illustrated. For example illustrates an organization and file structure of tokens stored in an authentication application installed in a secure zone of the client electronic device.

Table 1 illustrates a key file structure. For example Table 1 illustrates a structure of the key file for object storage.

According to various embodiments of the present disclosure the key file is wrapped with a key derived from a PIN and the device key SHK e.g. PIN SHK . According to various embodiments of the present disclosure the key files may be stored in a specific directory of the client electronic device. In particular the key files may be stored in a specific directory of the secure zone of the client electronic device. The key files may be stored in a directory associated with the authentication application installed in the secure zone of the client electronic device e.g. data misc tz ccm . According to various embodiments of the present disclosure at least one of a UID an object type and an object label to identify a file storing an object. According to various embodiments of the present disclosure the default key for the authentication application e.g. the default CCM key may have a different file structure.

Table 2 illustrates a PIN file structure. For example Table 2 illustrates a structure of the PIN file for object storage.

According to various embodiments of the present disclosure the PIN file may be wrapped with a key derived from a PIN and the device key SHK e.g. PIN SHK . According to various embodiments of the present disclosure the PIN files may be stored in a specific directory of the client electronic device. In particular the PIN files may be stored in a specific directory of the secure zone of the client electronic device. The PIN files may be stored in a directory associated with the authentication application installed in the secure zone of the client electronic device e.g. data misc tz ccm .

Table 3 illustrates a default key file structure. For example Table 3 illustrates a structure of the default key file for object storage.

According to various embodiments of the present disclosure the file structure of the default key file is similar to the file structure of other key files. According to various embodiments of the present disclosure a keyless file may be created in a specific directory of the secure zone of the client electronic device. For example the keyless file may be created in a directory associated with the authentication application installed in the secure zone of the client electronic device e.g. data misc tz ccm directory . According to various embodiments of the present disclosure the type field of the file structure may indicate whether the file is relevant to the default key. According to various embodiments of the present disclosure no key information is provided in the keyless file associated with the default key. The actual default key data may be stored in a location specified by a device manufacturer.

According to various embodiments of the present disclosure the default client certificate and key may be generated and maintained by a device manufacturer. For example the default client certificate and key may be generated only once for a respective client electronic device. According to various embodiments of the present disclosure the default client certificate and key may be encrypted by a client electronic device unique hardware key.

According to various embodiments of the present disclosure services may be encrypted decrypted using a specific encryption module or protocol e.g. using a PKCS11 interface .

According to various embodiments of the present disclosure an authentication application installed in a secure zone of the client electronic device may be configured to use a standard cryptography protocol for encrypting decrypting services. For example the authentication application may be configured to use PKCS11.

Table 5 illustrates a relationship between normal PKCS11 APIs e.g. PKCS11 APIs used according to the related art and PKCS11 APIs for encrypting decrypting services within the secure zone of the client electronic device.

According to various embodiments of the present disclosure the authentication application e.g. the CCM performs minimal trusted boot checks to determine a system state before any services are provided. The extent of the minimal trusted boot checks may be configurable on a per key basis. For example the extent of the minimal trusted boot checks may be configured during certificate installation to the secure zone of the client electronic device. The authentication application may perform the minimal trusted boot checks to confirm that the client electronic device has boot into a known state e.g. an uncompromised state .

According to various embodiments of the present disclosure a certificate and or key install and or generation request may indicate a security level. According to various embodiments of the present disclosure the authentication application may use the indicated security level to determine the extent of the minimal trusted boot checks that need to be performed before providing services. For example the authentication application uses the registered security level to determine the need to perform trusted boot checks.

According to various embodiments of the present disclosure the trusted boot checks may include a Warranty Violation WV fuse or WV string secure memory checks and a measurement validation.

According to various embodiments of the present disclosure the trusted boot checks may not include PKM dashboard and or RKP checks.

According to various embodiments of the present disclosure all tokens and metadata files may be stored in an Encrypting File System EFS using trustlet wrap APIs.

According to various embodiments of the present disclosure a security module e.g. SEAndroid may be implemented to prevent deletion and or modification of tokens and or metadata files stored in the EFS.

According to various embodiments of the present disclosure PIN files and or key files may be read into a specific location in the secure zone of the client electronic device. For example the PIN files and or key files may be read into a standard location in the secure zone of the client electronic device. As an example if the client electronic device transitions to an INIT e.g. initialize state then any PIN files and or key files may be wiped e.g. deleted from the secure zone of the client electronic device hence the need to read the PIN files and or key files into the secure zone of the client electronic device.

According to various embodiments of the present disclosure installation operations may follow trusted boot checks. According to various embodiments of the present disclosure installation operations may always follow trusted boot checks.

According to various embodiments of the present disclosure cryptography operations may follow trusted boot checks. For example cryptography operations may follow trusted boot checks if such minimal trusted boot checks are registered during the applicable installation operation.

According to various embodiments of the present disclosure the client electronic device may be configured to ensure that the private keys never leave the secure zone of the client electronic device.

According to various embodiments of the present disclosure the authentication application e.g. the CCM may be used for EAP TLS for enterprise WiFi e mail authentication VPN authentication e.g. with client certificates such as for example SSL .

According to various embodiments of the present disclosure EAP TLS may correspond to an authentication mechanism to authorize access to wireless networks e.g. WiFi . For example EAP TLS may support certificate based mutual authentication and key derivation. According to various embodiments of the present disclosure TLS may be more robust when used in connection with client certificates.

Referring to at operation default credentials are communicated to a client electronic device. The default credentials may correspond to a default certificate and default key e.g. a default private key . An enterprise e.g. an enterprise network may communicate the default credentials to the client electronic device.

At operation the client electronic device receives the default credentials. The client electronic device stores e.g. installs the default credentials in the secure zone of the client electronic device. The client electronic device may only store the default credentials in the secure zone of the client electronic device if the client electronic device is in an uncompromised state. For example the client electronic device may determine whether the client electronic device is in an uncompromised state before storing the default credentials in the secure zone of the client electronic device. The client electronic device may determine whether the client electronic device is in an uncompromised state by performing one or more trusted boot checks.

At operation the client electronic device communicates a request to enroll or otherwise register with the enterprise network. For example the client electronic device communicates a request to enroll or otherwise register with an authentication server of the enterprise network. The client electronic device may communicate the default credentials or a portion thereof to the enterprise network with the request to enroll register with the enterprise network. For example the client electronic device may communicate a default certificate to the enterprise network.

At operation authentication is performed between the client electronic device and the enterprise network using the default credentials. For example the client electronic device may sign the default certificate using the default private key stored in the secure zone of the client electronic device. The enterprise network may validate the client electronic device using a corresponding default public key.

At operation the enterprise e.g. the enterprise network may communicate client credentials e.g. enterprise credentials to the client electronic device. For example the enterprise may communicate the client credentials to the client electronic device in response to authenticating the client electronic device using the default credentials. The client credentials may be a private key and corresponding certificate associated with the enterprise network. The client credentials may be unique for the client electronic device e.g. the client credentials may be used for a unique identification of the client electronic device in relation to the enterprise network . The enterprise may communicate the credentials to the client electronic device only if the client electronic device is authenticated with the enterprise using the default credentials.

At operation the client electronic device receives the client credentials. The client electronic device may receive the client credentials from the enterprise e.g. the enterprise network . The client electronic device stores e.g. installs the client credentials in the secure zone of the client electronic device. The client electronic device may only store the client credentials in the secure zone of the client electronic device if the client electronic device is in an uncompromised state.

At operation the client electronic device may use the client credentials to access the enterprise network. For example the enterprise network may authenticate the client electronic device using the client credentials.

Referring to an example in which a connection between a client electronic device and a wireless network is authenticated.

At operation the client electronic device may operatively receive a request for a default client certificate from an enterprise network e.g. an EAP authenticator server . For example an authentication application e.g. the CCM application installed on the client electronic device may receive the request for a default client certificate. The authentication application may receive the request for a default client certificate directly from the enterprise network e.g. the EAP authenticator server or from the enterprise network e.g. the EAP authenticator server via a WiFi agent stored on the client electronic device. For example the WiFi agent may be stored and or executed outside the non secure zone of the client electronic device. The WiFi agent may be an application stored in the non secure zone of the client and executed in the normal operating environment.

If the authentication application receives a request for the default client certificate at operation the authentication application may perform the minimal trusted boot checks registered or otherwise associated with the requested default client certificate. For example the authentication application may perform the trusted boot checks to confirm that the client electronic device is in an uncompromised state. If the authentication application determines that the client electronic device is not in an uncompromised state e.g. that the client electronic device is in a compromised state then the client electronic device may be prevented from performing authentication services e.g. installing a private key signing a certificate using the private key stored in the secure zone of the client electronic device performing encryption decryption services and or the like .

According to various embodiments of the present disclosure if the authentication application determines that the minimal trusted boot checks satisfied the applicable validation criteria then at operation then the authentication application may request enrolment e.g. attempt to register with the enterprise network e.g. the EAP authenticator server . The default client certificate may be communicated with a request for enrollment. According to various embodiments of the present disclosure the default client certificate and or request for enrollment may be communicated to the enterprise network e.g. the EAP authenticator server directly from the authentication application or the default client certificate and or request for enrollment may be communicated to the enterprise network e.g. the EAP authenticator server via the WiFi agent

Thereafter at operation the enterprise network e.g. the EAP authenticator server and the authentication application may perform an authentication e.g. a validation . For example the authentication application may encrypt decrypt services provided to and or received from the WiFi agent using a specific encryption module or protocol e.g. using a PKCS11 interface . The enterprise network e.g. the EAP authenticator server and the authentication application may perform authentication using the default key set.

The enterprise network e.g. the EAP authenticator server may operatively establish an SSL connection between the enterprise network e.g. the EAP authenticator server and the client electronic device using the default client certificate and key.

Thereafter at operation the enterprise network e.g. the EAP authenticator server may communicate a client certificate and or key to the client electronic device. For example if the authentication application is authenticated with the enterprise network e.g. the EAP authenticator server then the enterprise network e.g. the EAP authenticator server may provide the client electronic device.

Upon receipt of the client certificate and or key from the enterprise network e.g. the EAP authenticator server the authentication application may install the client certificate and or key. For example the client electronic device may store and or install the client certificate and or key.

Referring to according to various embodiments of the present disclosure only one session may be allowed with the secure zone of the client electronic device at any given time. According to various embodiments of the present disclosure only one trustlet instance may exist at any given time.

According to various embodiments of the present disclosure the authentication application may not honor any other session requests until a current session is closed.

According to various embodiments of the present disclosure with reference to the function call C Intitialize when the client electronic device is currently in the INIT state and making the function call C OpenSession C Login or C Logout C CloseSession C Finalize will not be honored because doing so would honor more than one session at a current time.

Similarly according to various embodiments of the present disclosure the function call C Initialize C OpenSession C Login will not be honored when the client electronic device is in the IN SESSION state and making the C  Init or C Logout C CloseSession C Finalize function calls because doing so would honor more than one session at a current time.

Referring to according to various embodiments of the present disclosure FindObjects and cryptography operations may be treated different than other operations.

According to various embodiments of the present disclosure when the client electronic device e.g. the authentication application has completed a FindObject operation e.g. when the authentication application has found the object the client electronic device may transition to a crypto begin state.

According to various embodiments of the present disclosure when the client electronic device e.g. the authentication application transitions to a crypto begin state the client electronic device e.g. the authentication application may lose e.g. transitions away from a FindObject state.

With reference to the dotted lines associated with function calls and states are function calls and states of a client electronic device such as the client electronic device illustrated in . The dotted lines transpose the function calls and states associated with the client electronic device illustrated in onto the state diagram of the client electronic device described in connection with .

According to various embodiments of the present disclosure with reference to the function call C Intialize C OpenSession C Login C FindObjectsInit when the client electronic device is in the IN Service Begin state will not be honored because doing so would honor more than one session at a current time.

Similarly the function call C Intialize C OpenSession C Login C FindObjectsInit when the client electronic device is in the In Service Session state will not be honored because doing so would honor more than one session at a current time.

Similarly the function call C Intialize C OpenSession C Login C FindObjectsInit when the client electronic device is in the In Service Crypto Begin state will not be honored because doing so would honor more than one session at a current time.

According to various embodiments of the present disclosure a client electronic device may be configured to prevent the client electronic device from indefinitely remaining in a given state. For example the client electronic device e.g. the authentication application may perform an erroneous execution of an operation for less than a threshold number of times e.g. N 10 after which the client electronic device may unblock itself from performing another function call or initiating another e.g. alternative session.

According to various embodiments of the present disclosure the client electronic device e.g. the authentication application may monitor states lost during a reboot of the client electronic device. For example the client electronic device e.g. the authentication application may detect lost states by using consistency checks that are performed at an install sequence and or an initialization sequence. If the client electronic device e.g. the authentication application detects a lost state then the client electronic device e.g. the authentication application may resolve the lost state e.g. by fixing and or restoring the lost state . According to various embodiments of the present disclosure an existing token takes priority over new tokens.

At operation client credentials e.g. enterprise credentials are communicated to the client electronic device. An enterprise e.g. an enterprise network may communicate the client credentials to the client electronic device. According to various embodiments of the present disclosure the enterprise e.g. the enterprise network may communicate the client credentials directly to the client electronic device. According to various embodiments of the present disclosure the enterprise e.g. the enterprise network may communicate the client credentials to the client electronic device via a gateway. The client credentials may be a private key and corresponding certificate associated with the enterprise e.g. the enterprise network . The client credentials may be unique for the client electronic device e.g. the client credentials may be used for a unique identification of the client electronic device in relation to the enterprise network .

At operation the client electronic device receives the client credentials from the enterprise e.g. the enterprise network .

At operation the client electronic device determines whether the client electronic device is an uncompromised state. For example the client electronic device may determine whether the client electronic device is in an uncompromised state before storing the default credentials in the secure zone of the client electronic device. The client electronic device may determine whether the client electronic device is in an uncompromised state by performing one or more trusted boot checks.

At operation the client electronic device stores e.g. installs the client credentials in the secure zone of the client electronic device. The client electronic device may only store the client credentials in the secure zone of the client electronic device if the client electronic device is in an uncompromised state. For example the client electronic device may determine whether the client electronic device is in an uncompromised state before storing the client credentials in the secure zone of the client electronic device. The client electronic device may determine whether the client electronic device is in an uncompromised state by performing one or more trusted boot checks.

At operation the client electronic device uses the client credentials to access the enterprise network. For example the client electronic device and the enterprise network may perform an authentication procedure to validate the client electronic device using the client credentials.

Referring to at operation an enterprise network e.g. an MDM server may communicate a client certificate and or client key e.g. a private key corresponding to the client certificate . The enterprise network e.g. the MDM server may communicate the client certificate and or client key using a push communication technology. For example the enterprise network e.g. the MDM server may directly communicate the client certificate and or key to the client electronic device e.g. the authentication application stored on the client electronic device . As another example the enterprise network e.g. the MDM server may communicate the client certificate and or client key to the client electronic device via a gateway and or security agent e.g. a KNOX agent . For example the security agent e.g. the KNOX agent may be stored and or executed outside the non secure zone of the client electronic device. The security agent e.g. the KNOX agent may be an application stored in the non secure zone of the client and executed in the normal operating environment. The enterprise network e.g. the MDM server may generate the client certificate and corresponding private key e.g. client key . The enterprise network e.g. the MDM server may communicate the client certificate and or the client key using a secure or otherwise trusted connection.

According to various embodiments of the present disclosure upon receipt of the client certificate and or key from the enterprise network e.g. the MDM server the client electronic device may store e.g. install the client certificate and or client key e.g. private key . According to various embodiments of the present disclosure the client electronic device may confirm that the client electronic device is in an uncompromised state. The client electronic device may confirm that the client electronic device was boot to an uncompromised state. The client electronic device may determine whether the client electronic device is in an uncompromised state by performing one or more trusted boot checks. According to various embodiments of the present disclosure the client electronic device may only store the client certificate and client key in the secure zone of the client electronic device if the client electronic device determines that the client electronic device is an uncompromised state.

According to various embodiments of the present disclosure at operation the client electronic device e.g. the authentication application may communicate a request for enrollment with the enterprise network e.g. the MDM server or an associated enterprise network . For example the client electronic device may communicate the request for enrollment through the security agent e.g. the KNOX agent and or the gateway . The client electronic device may communicate the request for enrollment with the enterprise network e.g. the MDM server with a client certificate. The client certificate may be wrapped with identification information of the client electronic device.

Upon receipt of the request for enrollment the enterprise network e.g. the MDM server may store the client certificate.

Thereafter at operation the enterprise network e.g. the MDM server and the client electronic device e.g. the authentication application may perform authentication using the client credentials e.g. the client certificate the client key e.g. the private key and or the corresponding public key . The enterprise network e.g. the MDM server may validate the client electronic device e.g. in response to the client electronic device attempting to access the enterprise network associated with the enterprise network e.g. the MDM server . The authentication application e.g. via the security agent and the enterprise network e.g. the MDM server may perform an authentication process through a specific encryption module or protocol e.g. using a PKCS11 interface .

According to various embodiments of the present disclosure the enterprise network e.g. the MDM server may communicate with the security agent and or the client electronic device using a security protocol. For example the enterprise network e.g. the MDM server may communicate with the security agent and or client electronic device using a Secure Sockets Layer SSL protocol and the installed client certificate. The enterprise network e.g. the MDM server may authenticate the client electronic device by validating the client certificate and or the client key.

Referring to according to various embodiments of the present disclosure an enterprise may select to use credentials provided by a third party e.g. an OEM manufacturer . The enterprise may not want to have to provide a certificate or be required to manage and or process certificate signing requests. As an example default client certificates and keys may be used for authentication of a client electronic device.

At operation the client electronic device may store default credentials in the secure zone of the client electronic device. The default credentials may be provided by a third party such as for example the OEM manufacturer. The default credentials may correspond to a default certificate and a default private key. According to various embodiments of the present disclosure an enterprise e.g. an enterprise network an application and or the like may be registered for use with the default credentials e.g. the default certificate and or default key e.g. private key . According to various embodiments of the present disclosure the enterprise e.g. the enterprise network the application and or the like may be registered for use with the default credentials at time when the default credentials are stored in the secure zone of the client electronic device. According to various embodiments of the present disclosure the enterprise e.g. the enterprise network the application and or the like may be registered for use with the default credentials after the default credentials are stored in the secure zone of the client electronic device.

At operation the client electronic device may determine whether the client electronic device is an uncompromised state. For example the client electronic device may determine whether the client electronic device is in an uncompromised state before registering the enterprise e.g. the enterprise network the application and or the like may be registered for use with the default credentials. The client electronic device may determine whether the client electronic device is in an uncompromised state by performing one or more trusted boot checks.

At operation the client electronic device communicates a request to enroll or otherwise register with the enterprise e.g. the enterprise network . For example the client electronic device communicates a request to enroll or otherwise register with an authentication server of the enterprise network. The client electronic device may communicate the default certificate to the enterprise network with the request to enroll register with the enterprise e.g. the enterprise network . For example the client electronic device may communicate a default certificate to the enterprise network.

At operation the client electronic device uses the default credentials to access the enterprise network. For example the client electronic device and the enterprise network may perform an authentication procedure to validate the client electronic device using the default credentials.

Referring to according to various embodiments of the present disclosure at operation the client electronic device may operatively receive a request to register the client electronic device with an enterprise e.g. an enterprise network . The client electronic device may operatively receive a request including a default client certificate from an enterprise network e.g. an MDM server . For example an authentication application e.g. the CCM application installed on the client electronic device may receive the request including a default client certificate. The authentication application may receive the request for a default client certificate directly from the enterprise network e.g. the MDM server or from the enterprise network e.g. the MDM server via a gateway and or a security agent e.g. a KNOX agent .

If the authentication application receives a request including the default client certificate then the authentication application may perform the minimal trusted boot checks registered or otherwise associated with the requested default client certificate. For example the authentication application may confirm that the client electronic device is in an uncompromised state. The authentication application may confirm that the client electronic device is in an uncompromised state before storing the default client credentials e.g. the default client certificate and default client private key to ensure that the default client credentials are not compromised.

According to various embodiments of the present disclosure if the authentication application determines that the minimal trusted boot checks satisfied the applicable validation criteria then the authentication application may store the default client credentials.

At operation the client electronic device may communicate a request to enroll the client electronic device with the enterprise e.g. the enterprise network . The default client certificate e.g. signed with the default client private key may be communicated with a request for enrollment. According to various embodiments of the present disclosure the default client certificate and or request for enrollment may be communicated to the enterprise network e.g. the MDM server directly from the authentication application or the default client certificate and or request for enrollment may be communicated to the enterprise network e.g. the MDM server via the gateway and or a security agent e.g. a KNOX agent .

Thereafter at operation the client electronic device the security agent e.g. the KNOX agent the gateway and or the enterprise network e.g. the MDM server may encrypt decrypt services provided to the authentication application through a specific encryption module or protocol e.g. using a PKCS11 interface . The client electronic device and the enterprise network e.g. the MDM server may communicate over an encryption protocol to validate the client credentials e.g. to authenticate the client electronic device .

According to various embodiments of the present disclosure the enterprise network e.g. the MDM server may communicate with the gateway the security agent e.g. KNOX agent and or the client electronic device e.g. the authentication application using a security protocol. For example the enterprise network e.g. the MDM server may communicate with the security agent and or client electronic device using a Secure Sockets Layer SSL protocol and the installed client certificate. The enterprise network e.g. the MDM server may authenticate the client electronic device by validating the client certificate and or the key.

Referring to at operation the client electronic device may store default credentials in the secure zone of the client electronic device. The default credentials may be provided by a third party such as for example the OEM manufacturer. The default credentials may correspond to a default certificate and a default private key. According to various embodiments of the present disclosure an enterprise e.g. an enterprise network an application and or the like may be registered for use with the default credentials e.g. the default certificate and or default key e.g. private key . According to various embodiments of the present disclosure the enterprise e.g. the enterprise network the application and or the like may be registered for use with the default credentials at time when the default credentials are stored in the secure zone of the client electronic device. According to various embodiments of the present disclosure the enterprise e.g. the enterprise network the application and or the like may be registered for use with the default credentials after the default credentials are stored in the secure zone of the client electronic device.

At operation the client electronic device communicates a request to enroll or otherwise register with the enterprise e.g. the enterprise network and application and or the like. For example the client electronic device communicates a request to enroll or otherwise register with an authentication server of the enterprise network. The client electronic device may communicate the default certificate to the enterprise network with the request to enroll register with the enterprise e.g. the enterprise network . For example the client electronic device may communicate a default certificate to the enterprise network. The client electronic device may communicate information identifying the client electronic device e.g. a device ID to the enterprise. For example the request to enroll register with the enterprise may include the information identifying the client electronic device.

At operation client credentials may be generated. For example the enterprise e.g. the enterprise network may generate the client credentials. The client credentials may include a client certificate and private key. The client credentials may relate to a public credential such as a public key.

At operation client credentials e.g. enterprise credentials are communicated to the client electronic device. An enterprise e.g. an enterprise network may communicate the client credentials to the client electronic device. According to various embodiments of the present disclosure the enterprise e.g. the enterprise network may communicate the client credentials directly to the client electronic device. According to various embodiments of the present disclosure the enterprise e.g. the enterprise network may communicate the client credentials to the client electronic device via a gateway. The client credentials may be a private key and corresponding certificate associated with the enterprise network. The client credentials may be unique for the client electronic device e.g. the client credentials may be used for a unique identification of the client electronic device in relation to the enterprise network .

At operation the client electronic device receives the client credentials from the enterprise e.g. the enterprise network . Thereafter the client electronic device may store the client credentials in the secure zone of the client electronic device. The client electronic device may determine whether the client electronic device is an uncompromised state. For example the client electronic device may determine whether the client electronic device is in an uncompromised state before storing the default credentials in the secure zone of the client electronic device. The client electronic device may determine whether the client electronic device is in an uncompromised state by performing one or more trusted boot checks. The client electronic device may only store the client credentials in the secure zone of the client electronic device if the client electronic device is in an uncompromised state. For example the client electronic device may determine whether the client electronic device is in an uncompromised state before storing the client credentials in the secure zone of the client electronic device.

At operation the client electronic device uses the client credentials to access the enterprise network. For example the client electronic device and the enterprise network may perform an authentication procedure to validate the client electronic device using the client credentials.

Referring to according to various embodiments of the present disclosure at operation an authentication application stored in a secure zone of the client electronic device may operatively receive a request for a default client certificate from security agent e.g. an application stored in a non secure zone of the client electronic device and that is configured to interface or otherwise communicate with an enterprise e.g. an enterprise network such as an MDM server such as a KNOX agent . For example an authentication application e.g. the CCM application installed on the client electronic device may receive the request for a default client certificate.

If the authentication application receives a request for the default client certificate then the client electronic device e.g. the authentication application may confirm that the client electronic device is in an uncompromised state. For example the authentication application may perform the minimal trusted boot checks registered or otherwise associated with the requested default client certificate.

According to various embodiments of the present disclosure if the authentication application determines that the minimal trusted boot checks satisfied the applicable validation criteria then at operation the client electronic device may request enrollment with the enterprise e.g. the enterprise network . For example the authentication application may communicate a request for enrollment with the enterprise network and the default client certificate to the enterprise network e.g. the MDM server . According to various embodiments of the present disclosure the default client certificate and or request for enrollment may be communicated to the enterprise network e.g. the MDM server directly from the authentication application or the default client certificate and or request for enrollment may be communicated to the enterprise network e.g. the MDM server via the security agent e.g. the KNOX agent and or a gateway

At operation the enterprise network e.g. the MDM server may generate a client certificate and private key. The enterprise network may generate client credentials e.g. for access thereto .

According to various embodiments of the present disclosure the enterprise network may authenticate the client electronic device before generating the client credentials. The enterprise network may authenticate the client electronic device using the default credentials e.g. the default client certificate and default private key that may be stored in a secure zone of the client electronic device. For example the client electronic device e.g. the authentication application the security agent e.g. the KNOX agent the gateway and or the enterprise network e.g. the MDM server may perform encrypt decrypt services provided to the through a specific encryption module or protocol e.g. using a PKCS11 interface using the default credentials.

According to various embodiments of the present disclosure the enterprise network e.g. the MDM server may communicate the default credentials with the gateway the security agent e.g. the KNOX agent and or the client electronic device e.g. the authentication application using a security protocol. For example the enterprise network e.g. the MDM server may communicate the default credentials with the security agent e.g. the KNOX agent and or the client electronic device e.g. the authentication application using a Secure Sockets Layer SSL protocol and the installed client certificate. The enterprise network e.g. the MDM server may authenticate the client electronic device by validating the client certificate and or the key.

At operation upon receipt of the validated client certificate and or key e.g. the signed client certificate the client electronic device e.g. the authentication application may store e.g. install the client certificate. For example the client electronic device may store the client credentials in a secure zone of the client electronic device. The client electronic device may determine whether the client electronic device is an uncompromised state. For example the client electronic device may determine whether the client electronic device is in an uncompromised state before storing the default credentials in the secure zone of the client electronic device. The client electronic device may determine whether the client electronic device is in an uncompromised state by performing one or more trusted boot checks. The client electronic device may only store the client credentials in the secure zone of the client electronic device if the client electronic device is in an uncompromised state. For example the client electronic device may determine whether the client electronic device is in an uncompromised state before storing the client credentials in the secure zone of the client electronic device.

Referring to hardware may be for example a part or all of the electronic device . Referring to the hardware may include one or more Application Processors AP a communication module a Subscriber Identification Module SIM card a memory a sensor module an input module a display module an interface an audio module a camera module a power management module a battery an indicator a motor and or the like.

The AP may control one or more hardware or software components that are connected to AP perform processing or computation of data including multimedia data and or the like. As an example the AP may be implemented as a System on Chip SoC . The AP may include a Graphics Processing Unit GPU not shown .

The communication module e.g. the communication interface may transmit and receive data in communications between the electronic device and other electronic devices e.g. the electronic device the server and or the like . As an example the communication module may include one or more of a cellular module a Wi Fi module a Bluetooth module a GPS module a NFC module a Radio Frequency RF module and or the like.

The cellular module may provide services such as for example a voice call a video call a Short Messaging Service SMS internet service and or the like via a communication network e.g. LTE LTE A CDMA WCDMA UMTS WiBro GSM and or the like . As an example the cellular module may differentiate and authorize electronic devices within a communication network using a Subscriber Identification Module SIM card e.g. the SIM card . According to various embodiments of the present disclosure the cellular module may perform at least a part of the functionalities of the AP . For example the cellular module may perform at least a part of multimedia control functionality.

According to various embodiments of the present disclosure the communication interface and or the cellular module may include a Communication Processor CP . As an example the cellular module may be implemented as SoC.

Although illustrates components such as the cellular module e.g. CP the memory the power management module as components that are separate from the AP according to various embodiments of the present disclosure the AP may include or be integrated with one or more of the foregoing components e.g. the cellular module .

According to various embodiments of the present disclosure the AP the cellular module e.g. CP and or the like may process instructions or data received from at least one of non volatile memory or other components by loading in volatile memory. The AP the cellular module the communication interface and or the like may store at non volatile memory at least one of data that is received from at least one of other components or data that is generated by at least one of the other components.

Each of the Wi Fi module the Bluetooth module the GPS module the NFC module and or the like may for example include one or more processors that may process data received or transmitted by the respective modules. Although illustrates the cellular module the Wi Fi module the Bluetooth module the GPS module and the NFC module as separate blocks according to various embodiments of the present disclosure any combination e.g. two or more of the cellular module the Wi Fi module the Bluetooth module the GPS module the NFC module and or the like may be included in an Integrated Chip IC or an IC package. For example at least some of the processors corresponding to the respective the cellular module the Wi Fi module the Bluetooth module the GPS module the NFC module and or the like may be implemented as a single SoC. For example a CP corresponding to the cellular module and a Wi Fi processor corresponding to Wi Fi module may be implemented as a single SoC.

The RF module may for example transmit and receive RF signals. Although not shown the RF module may include a transceiver a Power Amp Module PAM a frequency filter a Low Noise Amplifier LNA and or the like. The RF module may include one or more components for transmitting and receiving Electro Magnetic EM waves e.g. in free space or the like such as for example conductors or conductive wires. Although illustrates that the cellular module the Wi Fi module the Bluetooth module the GPS module and the NFC module are sharing one RF module according to various embodiments of the present disclosure at least one of the cellular module the Wi Fi module the Bluetooth module the GPS module the NFC module and or the like may transmit and receive RF signals via a separate RF module.

The SIM card may be a card implementing a SIM and may be configured to be inserted into a slot disposed at a specified location of the electronic device. The SIM card may include a unique identifier e.g. Integrated Circuit Card IDentifier ICCID subscriber information e.g. International Mobile Subscriber Identity IMSI and or the like.

The memory e.g. the memory may include an internal memory an external memory or a combination thereof.

According to various embodiments of the present disclosure the internal memory may be for example at least one of volatile memory e.g. Dynamic Random Access Memory DRAM Static Random Access Memory SRAM or Synchronous Dynamic Random Access Memory SDRAM non volatile memory e.g. One Time Programmable Read Only Memory OTPROM Programmable Read Only Memory PROM Erasable and Programmable Read Only Memory EPROM Electrically Erasable and Programmable Read Only Memory EEPROM mask Read Only Memory ROM flash ROM NAND flash memory NOR flash memory and or the like.

According to various embodiments of the present disclosure the internal memory may be a Solid State Drive SSD . As an example the external memory may be a flash drive e.g. Compact Flash CF drive Secure Digital SD micro Secure Digital micro SD mini Secure Digital mini SD extreme Digital xD Memory Stick and or the like . The external memory may be operatively coupled to electronic device via various interfaces. According to various embodiments of the present disclosure the electronic device may include recording devices or recording media such as for example Hard Disk Drives HDD and or the like.

The sensor module may measure physical environmental properties detect operational states associated with electronic device and or the like and convert the measured and or detected information into signals such as for example electric signals or electromagnetic signals. As an example the sensor module may include at least one of a gesture sensor A a gyro sensor B an atmospheric pressure sensor C a magnetic sensor D an accelerometer E a grip sensor F a proximity sensor G an RGB sensor H a biometric sensor I a temperature humidity sensor J a luminosity sensor K a Ultra Violet UV sensor M and or the like. The sensor module may detect the operation state of the electronic device and or measure physical properties and convert the detected or measured information into electrical signals. Additionally or alternatively the sensor module may also include for example an electrical nose sensor not shown an electromyography EMG sensor not shown an electroencephalogram EEG sensor not shown an infrared IR sensor not shown an eye scanning sensor e.g. iris sensor not shown a fingerprint sensor and or the like. The sensor module may also include control circuitry for controlling one or more sensors included therein.

The input module may include a touch panel a digital pen sensor a key an ultrasonic input device and or the like.

As an example the touch panel may detect touch input using capacitive resistive infrared ultrasonic methods and or the like. The touch panel may also include a touch panel controller not shown . As an example a capacitive type touch panel may detect proximity inputs e.g. hovering input in addition to or as an alternative to physical touch inputs. The touch panel may also include a tactile layer. According to various embodiments of the present disclosure the touch panel may provide haptic feedback to the user using the tactile layer.

As an example the digital pen sensor may be implemented using methods identical to or similar to receiving a touch input from a user or using a separate detection sheet e.g. a digitizer .

As an example the ultrasonic input device may be a device configured to identify data by detecting using a microphone e.g. microphone ultrasonic signals generated by a device capable of generating the ultrasonic signal. The ultrasonic input device may detect data wirelessly.

According to various embodiments of the present disclosure the electronic device may receive user input from an external device e.g. a network computer or server connected to the electronic device using the communication module .

The display module e.g. the display may include a panel a hologram device a projector and or the like. As an example the panel may be for example a Liquid Crystal Display LCD an Active Matrix Organic Light Emitting Diode AM OLED display and or the like. As an example the panel may be configured to be flexible transparent and or wearable. The panel and the touch panel may be implemented as a single module. The hologram device may provide a three dimensional image. For example the hologram device may utilize the interference of light waves to provide a three dimensional image in empty space. The projector may provide image by projecting light on a surface e.g. a wall a screen and or the like . As an example the surface may be positioned internal or external to electronic device . According to various embodiments of the present disclosure the display module may also include a control circuitry for controlling the panel the hologram device the projector and or the like.

The interface may include for example one or more interfaces for a High Definition Multimedia Interface HDMI a Universal Serial Bus USB a projector or a D subminiature D sub and or the like. As an example the interface may be part of the communication interface . Additionally or alternatively the interface may include for example one or more interfaces for Mobile High definition Link MHL Secure Digital SD MultiMedia Card MMC Infrared Data Association IrDA and or the like.

The audio module may encode decode sound into electrical signal and vice versa. According to various embodiments of the present disclosure at least a portion of audio module may be part of the I O interface . As an example the audio module may encode decode voice information that is input into or output from the speaker the receiver the earphone the microphone and or the like.

The camera module may capture still images and or video. According to various embodiments of the present disclosure the camera module may include one or more image sensors e.g. front sensor module rear sensor module and or the like not shown an Image Signal Processor ISP not shown or a flash e.g. Light Emitting Diode flash LED xenon lamp and or the like not shown .

The power management module may manage electrical power of the electronic device . Although not shown the power management module may include for example a Power Management Integrated Circuit PMIC a charger Integrated Circuit charger IC a battery gauge a fuel gauge and or the like.

As an example the PMIC may be disposed in an integrated circuit or an SoC semiconductor. The charging method for the electronic device may include wired or wireless charging. The charger IC may charge a battery may prevent excessive voltage or excessive current from a charger from entering the electronic device and or the like. According to various embodiments of the present disclosure the charger IC may include at least one of a wired charger IC or a wireless charger IC. As an example the wireless charger IC may be a magnetic resonance type a magnetic induction type an electromagnetic wave type and or the like. As an example the wireless charger IC may include circuits such as a coil loop a resonance circuit a rectifier and or the like.

As an example the battery gauge may measure a charge level a voltage while charging a temperature of battery and or the like.

As an example the battery may supply power to the electronic device . As an example the battery may be a rechargeable battery a solar battery and or the like.

The indicator may indicate one or more states e.g. boot status message status charge status and or the like of the electronic device or a portion thereof e.g. AP . Motor may convert an electrical signal into a mechanical vibration.

Although not shown the electronic device may include one or more devices for supporting mobile television mobile TV e.g. a Graphics Processing Unit GPU and or the like. The devices for supporting mobile TV may support processing of media data compliant with for example Digital Multimedia Broadcasting DMB Digital Video Broadcasting DVB media flow and or the like.

It will be appreciated that various embodiments of the present disclosure according to the claims and description in the specification can be realized in the form of hardware software or a combination of hardware and software.

Any such software may be stored in a non transitory computer readable storage medium. The non transitory computer readable storage medium stores one or more programs software modules the one or more programs comprising instructions which when executed by one or more processors in an electronic device cause the electronic device to perform a method of the present disclosure.

Any such software may be stored in the form of volatile or non volatile storage such as for example a storage device like a Read Only Memory ROM whether erasable or rewritable or not or in the form of memory such as for example Random Access Memory RAM memory chips device or integrated circuits or on an optically or magnetically readable medium such as for example a Compact Disk CD Digital Versatile Disc DVD magnetic disk or magnetic tape or the like. It will be appreciated that the storage devices and storage media are various embodiments of non transitory machine readable storage that are suitable for storing a program or programs comprising instructions that when executed implement various embodiments of the present disclosure. Accordingly various embodiments provide a program comprising code for implementing apparatus or a method as claimed in any one of the claims of this specification and a non transitory machine readable storage storing such a program.

While the disclosure has been shown and described with reference to various embodiments thereof it will be understood by those skilled in the art that various changes in form and details may be made therein without departing from the spirit and scope of the disclosure as defined by the appended claims and their equivalents. Various embodiments of the present disclosure are described as examples only and are noted intended to limit the scope of the present disclosure. Accordingly the scope of the present disclosure should be understood as to include any and all modifications that may be made without departing from the technical spirit of the present disclosure.

