---

title: Medical thermal image processing for subcutaneous detection of veins, bones and the like
abstract: Medical thermal image processing for vein or other subsurface element detection and related methods is provided. A method for thermal image processing to enhance thermal scene information includes taking an output of an infrared camera and coupling the output to a spatial high pass filter. An output of the spatial high pass filter is then applied to a scene-based noise suppression module.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09552629&OS=09552629&RS=09552629
owner: BAE Systems Information and Electronic Systems Integration Inc.
number: 09552629
owner_city: Nashua
owner_country: US
publication_date: 20141016
---
This application claims benefit of U.S. Provisional Application Ser. No. 61 961 745 entitled Medical Thermal Imaging Processing for Vein Detection filed Oct. 21 2013 the entire disclosure of which is incorporated herein by reference.

This invention was made with United States government support under contract number H9400304D0002 0086 awarded by the U.S. Air Force. The United States government has certain rights in this invention.

This invention relates to thermal imaging and more particularly to medical thermal energy imaging for detection of veins bones and the like.

Various methods have been developed for the discernment of veins in the human body. However improved means are needed for the rapid discernment of veins across various body types skin colors and topical features by persons of various medical experience levels. While infrared data systems have been utilized in the past to detect subsurface structures such as veins bones and other biologic materials these systems have failed to provide sufficient resolution for the various body parts sought to be imaged.

In general scene based methods for low frequency spatial noise removal and dynamic range enhancement involve removing slowly varying or low spatial frequency image content which adds little value to the visual perception of veins or other important objects found in thermal imagery in general and in medical thermal imaging in particular. These slowly varying image components may be due to anomalies within the thermal camera or they may be characteristics of the actual scene. They degrade the overall image quality and reduce the information accessible to the human observer by reducing the image dynamic range available for more valuable higher spatial frequency image content.

High spatial frequency image non uniformity has an impact on the difficulty or ease with which veins and other important objects found in thermal imaging in general and in medical thermal imagery in particularly are perceived by a human observer. Noise and clutter also can have the same impact. For this reason the term spatial noise is often used to describe high spatial frequency image non uniformity and is the term used herein.

Thus a heretofore unaddressed need exists in the industry to address the aforementioned deficiencies and inadequacies.

Embodiments of the present disclosure can be viewed as providing a method for thermal image processing to enhance thermal scene information. In this regard one embodiment of such a method among others can be broadly summarized by the following steps taking an output of an infrared camera and coupling the output to a spatial high pass filter and applying an output of the spatial high pass filter to a scene based noise suppression module.

The present disclosure can also be viewed as providing a method of enhancing thermal imagery. In this regard one embodiment of such a method among others can be broadly summarized by the following steps applying at least one spatial bandpass filter to an image and suppressing scene based noise.

The present disclosure can also be viewed as providing a method of reducing fixed pattern or spatial noise from a frame sequence. In this regard one embodiment of such a method among others can be broadly summarized by the following steps subtracting a reference image from a frame sequence wherein the reference image is created from a portion of the frame sequence.

Other systems methods features and advantages of the present disclosure will be or become apparent to one with skill in the art upon examination of the following drawings and detailed description. It is intended that all such additional systems methods features and advantages be included within this description be within the scope of the present disclosure and be protected by the accompanying claims.

According to the present invention medical thermal image processing for vein bone or other subsurface element detection is accomplished by using a special band pass and scene based noise suppression filtering pedestal subtraction and thermal fusion image processing system. While prior art solutions apply a histogram based nonlinear transfer function to the image globally or they may apply a variable linear gain and offset function locally these solutions have not substantially enhanced the relevant thermal scene information revealed to the user.

On the other hand in the subject invention an infrared camera output is coupled to a spatial band pass filter having a band limitation such that the high pass cut on spatial frequency is equivalent to a radius of 6 to 60 pixels. This configuration limits the input of spatial frequencies to the next step in the scene based noise suppression system. In one embodiment spatial noise removal is accomplished by measuring or estimating the spatial noise image contained within the original image followed by subtracting the spatial noise image from the original image. In another embodiment the scene based method is used to measure estimate or create and then remove spatial image noise from the real time image sequence after an initial delay of a few seconds. After having removed spatial noise one can consider pedestal subtraction.

Image dynamic range available to the human observer through a display is limited by many factors. Visual perception of a particular object in the scene is improved by utilizing as much of the available display dynamic range as is possible without degrading the dynamic range of other objects in the scene. Display dynamic range must thus be shared between many different scene components. To strike a proper balance it is necessary to reduce the contrast of large and naturally high contrast scene elements prior to display in order to reserve display dynamic range for small but important scene elements that may be of low contrast in the scene.

Thermal fusion can also be used to emphasize subcutaneous objects. As to thermal fusion thermal imagery can be viewed as having two types of scene information. The first type of scene information is the size and shape of the various objects in the scene and the second type of scene information is temperature. By combining both size shape and temperature one can enhance various attributes of the subsurface objects so they can be readily visualized.

Further enhancements can be achieved by post processing. For example in one embodiment the captured 16 bit raw data is post processed with suitable image processing algorithms to produce a number of long wavelength infrared LWIR movies as well as the images appearing herein.

In the subject system the scene based noise suppression system has a low spatial frequency noise removal system operating with a spatial band pass filter frequency equivalent to a radius greater than 60 pixels to 480 pixels. The combination of these spatial frequency filters increases the dynamic range and contrast for the objects of interest. The scene based noise suppression system also has a high frequency fixed pattern a slowly varying pattern or a spatial noise removal system for the removal of unwanted image artifacts which degrade the visual experience of trying to resolve a vein or other subsurface features such as a bone. The spatial band pass filter in combination with the scene based noise suppression provides a thermal image processing system that enhances and enables more efficient coupling to the human visual system of the observer of the thermal scene information.

After the thermal image processing additional enhancement may be obtained through a pedestal subtraction system where a greater portion of the scene dynamic range is efficiently coupled to the observer through the display. Pedestal subtraction reduces the excess dynamic range of large naturally occurring high contrast scene elements thus enabling smaller low contrast and important scene elements such as veins to occupy a larger portion of the display dynamic range than would be possible without pedestal subtraction.

Further visualization of the subsurface structure may be provided by a fusion of enhanced thermal elements with non enhanced thermal elements so as to provide a combined thermal fusion image processing system which utilizes the shape of the subsurface element and its relative temperature in order to be able to distinguish the particular subsurface artifact or structure. In the thermal fusion image processing system care is taken to keep all parts of the image out of saturation so that vein structure and bone structure can be easily viewed not only for its position and shape but also for its color all of which correlates to its temperature.

Unsharp masking may also be utilized in which the unsharp masking technique utilizes an unusually large radius of 7 to 70 pixels to enhance a wide range of medium to high spatial frequency features that make the subsurface structures more visible and distinguished from the low frequency thermal background. The processing involved in rendering the image incorporates a real time full frame rate system which involves a scene based method for low frequency spatial noise removal and dynamic range enhancement in which slowly varying or low frequency image elements are removed by a spatial band pass filter that removes the low spatial frequency image components.

Secondly the scene based method for eliminating spatial or fixed pattern noise involves a method for eliminating high frequency spatial or so called fixed pattern noise meaning noise and clutter removal by removing a high spatial frequency filtered version of the image from the original image. This removal is done in one embodiment by measuring or estimating the spatial or fixed pattern noise within the image and subtracting it from the original image.

A specialized algorithm for removal of the spatial image involves first creating a frame stack SBN stack by applying a 3 to 12 pixel radius spatial high pass filter to the previous two or more frames. Secondly and in parallel a frame stack SBN mask stack is created by thresholding the 3 to 12 pixel radius variance of each of the previous two or more frames. The next step is to remove the residual scene content from each frame in the stack by applying the SBN mask stack as a mask to each frame in the SBN stack . The result is SBN masked stack. The next step is to create a spatial noise reference image SBNref image by computing the stack frame average of the masked stack. The final step is the removal of the spatial noise from each subsequent frame by subtracting the SBNref image from each subsequent frame.

After the scene based method for noise removal pedestal subtraction is utilized to preserve display dynamic range for small but important scene elements that may be of low contrast in the scene itself. This pedestal subtraction is done by reducing the contrast of large and naturally high contrast scene elements prior to display. The result is to preserve display high dynamic range for small but important scene elements that may be of low contrast.

After pedestal subtraction thermal fusion is utilized to meld the size and shape of objects with their temperatures such that the combination of the two parameters heightens the visibility of the particular elements so that they may be visualized easily from the display.

In addition to the above enhancements for the display of thermal imaging post processing in one embodiment captures 16 bit raw data linearly stretches the 16 bit data of a single frame and both provides a 16 frame moving average filtration and at the same time increases subject contrast so as to be able to pop out or make more visible the subcutaneous object required. Rather than utilizing thermal cameras which have minimal image processing built in namely just enough to be able to produce a linear level image or linear mapping of the thermal scene in the subject invention details in the thermal scene required to be enhanced so as to be easily detectable are provided by thermal image processing systems. These systems utilize spatial band pass and scene based noise suppression filtering as well as pedestal subtraction thermal fusion image processing and unsharp masking.

The output of the pedestal subtraction module is coupled to a thermal fusion image processing module . The output of thermal fusion image processing module is controlled at saturation controller to keep all parts of the image out of saturation such that veins or bone de burring structures are visible as indicated by boxes and . The resulting output of the thermal fusion image processing module is passed through an unsharp masking module to remove noncritical artifacts in the infrared camera output. Unsharp masking module is under control of control unit which restricts the unsharp masking to using an unusually large radius of 20 pixels. Thereafter the results are displayed on a display .

The scene based noise suppression module may include two different types of noise suppression systems. The first type utilizes a low frequency spatial noise removal system in which spatial noise of a low frequency nature is removed which simultaneously improves the dynamic range for those small indistinct subsurface elements of interest. The second type of system used by the scene based noise suppression module is a scene based high frequency spatial noise removal module which removes high frequency spatial noise.

Removal of scene based noise as well as providing a spatial band pass filter improves the enhancement of the subsurface objects within the human anatomy. However further enhancements may be obtained by utilizing a technique called pedestal subtraction. is a diagrammatic representation of the use of pedestal subtraction thermal fusion and post processing to increase the contrast invisibility of small subsurface objects in accordance with the first exemplary embodiment of the present disclosure. As is seen in pedestal subtraction provides for reserve time result to display high dynamic range for small but important scene elements that may be of low contrast in the scene. Pedestal subtraction may include reducing contrast of large and naturally high contrast scene elements prior to display as is shown at block . Reducing contrast may then allow for reserving a time result to display the high dynamic range for the small but important scene elements that may be of low contrast as is shown at block .

Next using a process of thermal fusion two different types of information may be taken into account in order to display the subsurface object as is shown at block . The first type is the size or shape of the object as well as its location and the second type is its temperature. By displaying these two simultaneously one can enhance the features that are sought after especially small subsurface objects that are not generally high contrast can be seen.

Subsequently at post processing further enhancements can be obtained. As is shown at block 16 bit raw data may be captured. Thereafter as shown at block the 16 bit data is linearly stretched corresponding to the stretching of a 16 bit data of a single frame. Next a 16 frame moving average filtration may be used simultaneously with a system for increasing the contrast of the object sought after as is shown at block and block respectively.

What is therefore shown is a system for enhancing thermal imaging to be able to visualize and enhance subsurface objects within a human or mammalian context in which thermal imaging cameras can be used with enhanced techniques to be able to make visible various small and non contrasted features that lie beneath the surface of the skin.

While the present invention has been described in connection with the preferred embodiments of the various Figures it is to be understood that other similar embodiments may be used or modifications or additions may be made to the described embodiment for performing the same function of this present invention without deviating therefrom. Therefore the present invention should not be limited to any single embodiment but rather construed in breadth and scope in accordance with the recitation of the appended claims.

