---

title: Flexible quasi out of band authentication architecture
abstract: To obtain user approval of network transactions at different levels of security, a network site selects a form in which a transaction with be presented to the user from a group of transaction presentation forms including presentation of the transaction in a browser pop-up window on a user network device, in a security software application window on the user network device, and in a security application window on another user network device. The network site also selects a type of approval of the transaction required from the user from a group of transaction approval types including approval requiring no action by the user after presentation of the transaction, the user to actively approve the presented transaction, and the user to sign the presented transaction. The transaction, the selected transaction presentation form, and the selected type of user transaction approval, are transmitted to obtain approval of the transaction by the user.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08887247&OS=08887247&RS=08887247
owner: Authentify, Inc.
number: 08887247
owner_city: Chicago
owner_country: US
publication_date: 20140520
---
This application is a continuation of application Ser. No. 13 081 150 filed Apr. 6 2011 which claims priority based on Provisional U.S. Application Ser. No. 61 334 776 filed May 14 2010. This application is related to issued application Ser. No. 13 081 067 filed Apr. 6 2011 now U.S. Pat. No. 8 719 905 and entitled SECURE AND EFFICIENT LOGIN AND TRANSACTION AUTHENTICATION USING IPHONES AND OTHER SMART MOBILE COMMUNICATION DEVICES which claims priority based on Provisional U.S. Application Ser. No. 61 327 723 filed Apr. 26 2010. This application is also related to pending application Ser. No. 12 938 161 filed Nov. 2 2010 and entitled A NEW METHOD FOR SECURE SITE AND USER AUTHENTICATION which claims priority based on Provisional U.S. Application Ser. No. 61 257 207 filed Nov. 2 2009 and entitled Project Seal . This application is also related to pending application Ser. No. 13 006 806 filed Jan. 14 2011 and entitled A NEW METHOD FOR SECURE USER AND SITE AUTHENTICATION which is a continuation of pending application Ser. No. 12 938 161. This application is also related to pending application Ser. No. 13 011 587 filed Jan. 21 2011 and entitled A NEW METHOD FOR SECURE USER AND TRANSACTION AUTHENTICATION AND RISK MANAGEMENT which claims priority based on Provisional U.S. Application Ser. No. 61 298 551 filed Jan. 27 2010 and entitled Authentication The Game Changer . This application is also related to application Ser. No. 13 011 739 filed Jan. 21 2011 and entitled A NEW METHOD FOR SECURE USER AND TRANSACTION AUTHENTICATION AND RISK MANAGEMENT which is a continuation in part of pending application Ser. No. 13 011 587. The contents of the above identified applications are hereby incorporated herein in their entirety by reference.

This invention relates to security and privacy. More particularly it relates to web based transaction authentication using a flexible quasi out of band authentication architecture.

The increasing sophistication of site specific attacks based on man in the middle MITM and man in the browser MITB techniques has profound implications for our current authentication techniques. Specifically the strength of the initial login authentication is increasingly becoming less relevant as these attacks manipulate transactions after the legitimate user has provided the initial credentials to login. In reaction to this trend leading organizations have begun deploying transaction authentication systems such as EMV CAP based token authenticators or have been using out of band authentication OOBA techniques to ensure that the user actually intended the transaction being seen at the back end. However such approaches are inherently not easy to use and consequently even when deployed are generally used only for high risk transactions or occasional events like profile changes. For the vast majority of transactions no current authentication solution provides a reasonable point in the How easy How secure How costly trade off.

In prior work see the related applications identified above we described innovations that address some of the problems with conventional authentication systems. Specifically we introduced the notion of using quasi out of band authentication QOOBA techniques to ensure that the user actually intended the transaction being seen at the back end. We also described how these techniques can be used to provide a user with a one time password OTP to enable login into a web site i.e. authentication of the user to the website based on a secret shared between the web site and a QOOBA security server. Thus these techniques can be used to provide the security of one time passwords but do not require a per user shared secret which all prior one time password systems have required.

The innovations described herein further extend our prior work to address the issue of providing an authentication solution for the vast majority of transactions at a reasonable point in the How easy How secure How costly trade off.

Accordingly it is an objective of the present invention is directed to provide an improved authentication architecture capable of handling the vast majority of transactions at a reasonable point in the How easy How secure How costly trade off.

It is another objective of the present invention to provide a quasi out of band authentication architecture for secure and efficient login and transaction authentication that is easily implemented and allows merchants banks and other website operators flexible control over the level of security.

Additional objects advantages novel features of the present invention will become apparent to those skilled in the art from this disclosure including the following detailed description as well as by practice of the invention. While the invention is described below with reference to preferred embodiment s it should be understood that the invention is not limited thereto. Those of ordinary skill in the art having access to the teachings herein will recognize additional implementations modifications and embodiments as well as other fields of use which are within the scope of the invention as disclosed and claimed herein and with respect to which the invention could be of significant utility.

First taking a network site perspective in accordance with aspects of the invention a network site such as a merchant or bank website on the Internet is operable to obtain approval by a user of network transactions such as product purchases or bank account transfers at different levels of security e.g. a high security level medium high security level and medium security level. For example a high level of security may be required because of the value of the transaction or the location from which the transaction is being made such an Internet Caf . A medium high level of security may be required for most transaction and a medium level of security may be required low value transaction made from the user s normal desktop computer.

User approval of the transaction is obtained by the network site selecting based on a predetermined security level for a transaction a form in which a transaction will be presented to the user from a group of transaction presentation forms including at least two of i a first form of presentation corresponding to presentation of the transaction in a browser pop up window on a first network device associated with the user such as the user s desktop executing a browser application like Internet Explorer ii a second form of presentation corresponding to presentation of the transaction in a security software application window on the first network device such as the user s desktop executing a security application and iii a third form of presentation corresponding to presentation of the transaction in a security application window on a second network device associated with the user and different than the first network device such as an Apple IPhone or other smart phone or indeed any mobile communications device executing a security application. It should be noted that such applications on mobile communication devices are commonly referred to as apps .

For example if it has been determined that a medium level of security applies to the transaction the first form of presentation may be selected. Whereas if it has been determined that a medium high level of security applies to the transaction the second form of presentation may instead be selected. However if it has been determined that a high level of security applies to the transaction the third form of presentation may instead be selected.

The network site also selects based on the predetermined security level for the transaction a type of approval of the transaction required from the user from a group of transaction approval types including at least two of i a first type approval requiring no action by the user after presentation of the transaction which can be viewed as a passive approval because the user need do nothing after the presentation of the transaction to approve that transaction and only needs to take action if he or she wishes to deny approval of that transaction ii a second type approval requiring the user to actively approve the presented transaction for example by using his or her mouse to click on an Approved button presented with the transaction and iii a third a third type approval requiring the user to sign the presented transaction e.g. with an electronic signature. These three types of approval are sometimes characterized as Inform Consent and Sign respectively.

The network site transmits the transaction the selected transaction presentation form and the selected type of user transaction approval to obtain approval of the transaction by the user. Preferably the transaction the selected transaction presentation form and the selected type of user transaction approval are transmitted to the user via a security server to obtain authorization of a user.

According to other preferred aspects of the invention if the selected type of user transaction approval is the third type approval the network site receives from the user a personal identification number PIN that serves as a signature of the user on the transaction. The network site computes a validation PIN based on a secret shared only by the network site and the security server and not by the user and compares the received PIN and the computed PIN. Only if the received PIN and the computed PIN match is the received PIN accepted by the network site as approval of the transaction by the user.

According to still other preferred aspects of the invention if the selected type of user transaction approval is the second type approval the network site receives an indication that the user has approved or denied approval of the presented transaction from the security server.

According to yet other preferred aspects of the invention the network site also transmits the transaction i.e. the unapproved transaction to the user for presentation in a browser window on the first network device e.g. the user s desktop. It should be understood that the browser window referred to here and the browser pop up window referred to above are two separate and distinct types of windows that can commonly be displayed by browser applications. If the network site receives comfort indicia of the user from the security server the network site also transmits the received comfort indicia and the approved transaction to the user for presentation in the browser window.

According to further aspects of the invention the above functionality can be implemented in an article of manufacture having processor readable storage medium with stored logic configured to be readable by a processor and thereby cause the processor to operate so as to perform the functions described above.

Now taking a security server rather than network site perspective in accordance with aspects of the invention a security server operates to present network transactions requiring different levels of security for approval by a user by initially receiving a transaction having a predetermined security level from a network site transacting with the user.

The security server presents the transaction to the user in one of a group of presentation forms including at least two of i a first form of presentation corresponding to presentation of the transaction in a browser pop up window on a network device associated with the user e.g. the user s desktop computer ii a second form of presentation corresponding to presentation of the transaction in a security software application window on the network device and iii a third form of presentation corresponding to presentation of the transaction in a security application window on another different network device associated with the user e.g. the user s mobile communication device. The one presentation form corresponds to a predetermined security level for the transaction.

The security server also requests one of a group of transaction approval types including at least two of i a first type approval requiring no action by the user after presentation of the transaction ii a second type approval requiring the user to actively approve the presented transaction and iii a third a third type approval requiring the user to sign the presented transaction selecting. The one transaction approval type also corresponds to the predetermined security level for the transaction.

Preferably the security server receives an identifier of the one transaction presentation form and the one transaction approval type from the network site 

According to other aspects of the invention if the one transaction approval type is the third type approval the security server computes a personal identification number PIN based on a secret shared only by the network site and the security server and not by the user and presents the computed PIN to the user for use as a signature of the user on the transaction.

According to still other aspects of the invention if the one transaction approval type is the second type approval the security server receives an identifier of the one transaction presentation form and the one transaction approval type from the network site It also receives an indication of approval of the presented transaction from the user and transmits the received indication of approval to the network site.

In accordance with yet other aspects of the invention the security server receives comfort indicia from the user and presents the received comfort indicia to the user in the one presentation form with the transaction.

Here again according to further aspects of the invention the above functionality relating to the operation of the security server can be implemented in an article of manufacture having processor readable storage medium with stored logic configured to be readable by a processor and thereby cause the processor to operate so as to perform the functions described above.

In prior work we have described how the introduction of a network based security server which has an independent channel to a window displayed on a user device can be used in conjunction with a user s browser computer software or smart phone or other mobile communications device application and the web site they are visiting to provide user authentication for login or transaction authorization via one or more user network device.

QOOBA is an innovative approach to create a solution that can be used to authenticate every transaction in a manner that will feel natural to users. The central idea is to create a small secure window the QOOBA Window that has an independent encrypted channel to a secure server the QOOBA Server . The QOOBA Window can be implemented as a zero download browser pop up the QOOBA Pop up Window as a small desktop application the QOOBA Software Window or as an app on a smart phone the QOOBA Phone Window . An important aspect to the innovation is that unlike as with soft tokens the QOOBA Window does not require secure storage of long term secrets. Rather it is activated during login by using out of band authentication. As a user transacts at a web site e.g. a merchant or bank website that is part of the QOOBA Network the transactions that the web site believes the user intends are sent securely via the user s browser to the QOOBA Server which displays the transaction in the QOOBA Window. The user is also optionally shown a transaction signature that the user can cut and paste from the QOOBA Window into their browser to authenticate to the website for login or transaction authorization purposes.

The QOOBA solution has the following benefits in terms of ease of use total cost of ownership and of particular interest here security.

First with regard to ease of use the user has no new device to carry or password to remember beyond having access to the phone used for out of band authentication. The user does not have to enter any cryptic transaction code into a device and type the result into the browser. Instead the user sees the entire transaction in their QOOBA Window and can copy and paste the transaction signature with a few clicks.

Second with regard to total cost of ownership the QOOBA architecture significantly reduces total lifecycle costs. It requires no new hardware and unlike a soft token does not require per user provisioning and management of secrets. Further as all communications between the web site and the QOOBA server can occur via the browser the integration requirements at the web site are extremely light. The overall costs of the QOOBA solution are designed to be significantly less than an equivalent soft token deployment and far less than that of a physical token.

Finally in terms of security as will be further discussed below the level of assurance depends on the form factor of the QOOBA Window that is used. The smartphone based QOOBA Window i.e. the QOOBA Phone Window provides the highest assurance but even the zero download pop up i.e. the QOOBA Pop up Window significantly raises the bar for an attacker. The software QOOBA window i.e. the QOOBA Software Window is likely to be satisfactory for almost all risk levels.

Further by implementing the QOOBA solution using the flexible architecture described below the web sites in the QOOBA Network are allowed to request or select the form factor appropriate for the transaction. For instance a user can simultaneously have a QOOBA Window on their smartphone as well as on their desktop. While most transactions can be sent to their desktop QOOBA Software Window which is far more convenient the highest risk transactions can be sent to their smartphone QOOBA Phone Window.

The flexible QOOBA architecture will now be described in greater detail and its security properties analyzed.

Referring now to the QOOBA system consists of a desktop personal computing device having the QOOBA Window and a Browser Window executing and displayed thereon an QOOBA Server and websites and each having the QOOBA Application Programming Interface API operable thereon. Also included in the system as shown is an OOBA Service which is utilized by the QOOBA Server to convey out of band communications e.g. authentication credentials to the user via the user s smart phone .

As described in more detail in the related applications referenced above the user activates the QOOBA Window typically by using out of band authentication and establishes a temporary session with the QOOBA Server . Websites participating in the QOOBA Network go through a onetime set up process to establish a shared secret with the QOOBA Server . When the user is at any of the websites he she can use the QOOBA API to request transaction authentication by sending the encrypted transaction to the QOOBA Server via user s Browser Window .

The QOOBA Server will display the transaction to the user in the QOOBA Window and if requested also display in the QOOBA Window a transaction signature derived from the transaction the secret shared between the QOOBA Server and the applicable website or and other information. The user is optionally given the choice of accepting or rejecting the transaction. Acceptance can be signaled passively by taking no action by clicking OK within the QOOBA Window or by copying and pasting the transaction signature from the QOOBA Window into the web application displayed in the Browser Window . If the transaction signature from the QOOBA Window is pasted into the web application displayed in the Browser Window the web site can verify the signature using the transaction the secret shared between the QOOBA Server and the applicable website or and other information as has been described in more detail in the related applications referenced above.

The user interface to the QOOBA Server remains largely constant regardless of the browser and or operating system OS being used and the form factor of the QOOBA Window . The only use case in which the user experience deviates is when the user is browsing on a smartphone where the QOOBA experience is optimized for the device.

As noted above the QOOBA Window can be implemented in one of at least three form factors a browser pop up which we commonly refer to as the QOOBA Pop up Window does not require any software download a small application that is installed on the desktop which we commonly refer to as the QOOBA Software Window or as a smart phone app which we commonly refer to as the QOOBA Phone Window.

The same user might well be using different form factors at different times. For instance a user who has the software QOOBA Window installed and uses that most of the time might use the browser pop up QOOBA Window while at some other desktop roaming . For certain high risk transactions the website might require showing the transaction on the smartphone QOOBA Window while most transactions are shown in the desktop window. The look and feel of the QOOBA Window is entirely customizable by the particular QOOBA Network. An implementation for a bank intended solely for its own websites might look and feel very different from an implementation by a payment service that offers authentication into various eCommerce websites . While we are describing numerous elements it should be understood that most of them are optional.

Unlike a soft token the QOOBA Window itself does not contain any user secrets. There is provision to personalize it for the user and perhaps eventually there will be QOOBA Windows with different skins . Depending on the form factor the QOOBA Window can be automatically started for the user at boot up time or must be manually started by the user clicking on an application icon e.g. for the software or smartphone versions or on a bookmark e.g. for the pop up version.

An example of this is shown in . The user activates the QOOBA Window by performing out of band authentication for instance by entering a PIN sent via a short messaging service SMS now more commonly referred to as a text messaging service to the user s mobile phone . The user enters the PIN in another not shown QOOBA Window and a keyed hash of it is sent to the QOOBA Server over an encrypted connection.

The encryption is at two levels. First all traffic is run over SSL. Second all traffic is also encrypted at the application level using a key derived from the PIN. We also note that other non OOBA forms of authentication can be used at this step for instance to integrate the QOOBA solution with existing one time password OTP deployments. The analysis here however assumes that OOBA is used.

As shown in at this point in addition to the activation button the QOOBA Window includes multiple other elements. One is a URL Bar showing the address of the QOOBA Server. Another is a personalization image which the user chooses in a one time step during the initial sign up for QOOBA authentication. The primary purpose of this personalization image is to increase the difficulty of attacks where an attacker attempts to mimic a browser pop up based QOOBA Window . Once activated the QOOBA Window will show users their transactions as they are performed on the websites that are part of that QOOBA Network i.e. websites 

It should be noted that as the QOOBA Window and the QOOBA Server will be communicating over SSL it is highly preferred and hence recommended that EV SSL certificates be used. Both SSL and EV SSL certificates are also well known and understood by those skilled in the art.

An example of a QOOBA Window displaying a transaction is depicted in . As shown in the QOOBA Window has a number of elements most of which are optional. These elements include the URL Bar showing the address of the QOOBA Server and the personalization image which the user chose during the initial sign up for QOOBA authentication. The elements additionally include a symbol that conveys the impression of flashing green when the user is transacting at a website that is part of the QOOBA Network e.g. website or . The elements also include a space where the name of the website the user is transacting at can appear. This website name can be the domain name as shown or the name of a merchant e.g. Hawk and Seal Bank Ltd. not shown . As shown in the space includes a display of the transaction the user is being asked to sign. The elements further include a comfort word which is a random dictionary word that will be shown to the user both in the QOOBA Window and next to the transaction displayed in the Browser Window . Finally the elements may include a transaction signature . As will be understood if this were an example of a QOOBA Window displaying a login rather than transaction screen the element might be characterized as an authentication PIN rather than transaction signature which likewise serves as a PIN. In any event as has been described above and will be further described below the PIN is computed at the QOOBA Server and sent to the QOOBA Window . The user simply cuts and pastes it from the Window into the part of the web application display in the Browser Window that asks for the signature. As discussed above the space occupied by the PIN can also be used to allow the user to signal to the QOOBA Server that the transaction is valid invalid for example by confirming that he she wishes to proceed with or refusing to confirm the transaction. However it should be recognized that the QOOBA Window can also be used to simply show the user the transaction. Thus the QOOBA Window can take different forms for example in one providing the user with a PIN for logging in to or signing a transaction with a website in another requesting the user s confirmation of a transaction and in still another simply presenting the user with a display of a transaction with out the user being required to do anything further.

It should be understood that there are two modes in which the QOOBA Window can operate. A PUSH mode in which the transaction and PIN are simply pushed to the QOOBA Window without any action from the user and a PULL mode in which the user must click on a get transaction button not shown to retrieve the transaction and PIN. While the former is more convenient for the user there are some situations where the PULL mode is more apropos.

For instance in the iPhone implementation of the QOOBA Window the PULL mode is used as smartphone apps in all except the most recent release of that OS does not permit multi tasking.

Turning now to the QOOBA Server . The QOOBA Server has two primary functions. The first is to interact with the user and OOBA Service to activate QOOBA Window for the user. The other is to interact with pre registered web sites to receive transactions and display them to the user in the QOOBA Window .

The QOOBA Server does not maintain any user information. This means that the QOOBA Server has to be provided the phone number e.g. the number of the smartphone for the user either by the user or by performing a look up based on a UserID of the user. The QOOBA Server will then interact with the OOBA service to send the user a QOOBA Server PIN not shown that is used to set up a secure session between the QOOBA Server and QOOBA Window .

Websites that are part of the QOOBA Network served by the QOOBA Server such as websites must be pre registered with the QOOBA Server . The QOOBA Server shares a secret key with the server at each of the pre registered websites . While we have not described the use of public key cryptography for key exchange the QOOBA Network is easily adaptable to make use of such cryptography. The QOOBA Server can be implemented as an on premise solution or as a service available through our OOBA partner.

Participating websites execute the QOOBA API to use the QOOBA network. The details of the QOOBA API will be well understood by those skilled in the art from the functional description provided above as well as below and can be easily implemented using well known and routinely used programming techniques. Accordingly the details are not described herein because they are unnecessary to those skilled in the relevant area of art and are therefore considered beyond the scope of this document.

