---

title: Identification of malicious activities through non-logged-in host usage
abstract: A system and associated computer program product for identifying malware. The system includes one or more processors, one or more computer-readable memories, one or more computer-readable storage devices, and program instructions stored on the one or more storage devices for execution by the one or more processors via the one or more memories. The program instructions include program instructions to receive a data communication simulating manual interaction between a user of the computer and the computer. The program instructions may determine that no user was interactively logged on to the computer approximately at a time the data communication was received by the computer, and in response, classify the data communication as a potential malware communication.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09069964&OS=09069964&RS=09069964
owner: International Business Machines Corporation
number: 09069964
owner_city: Armonk
owner_country: US
publication_date: 20140113
---
This application is a continuation application claiming priority to Ser. No. 13 335 270 filed Dec. 22 2011 now U.S. Pat. No. 8 631 485 issued Jan. 14 2014 which is a continuation application Ser. No. 12 335 824 filed Dec. 16 2008 Abandoned Apr. 23 2012.

The present invention generally relates to identifying malicious activities and more particularly to a system and method for identifying malicious activities or malware through non logged in host usage.

Malware a portmanteau word from the words malicious and software is software designed to infiltrate or damage a computer system without the owner s informed consent. The expression is a general term used by computer professionals to designate a variety of forms of hostile intrusive or annoying software or program code. Many computer users are unfamiliar with the term and often use computer virus for all types of malware including true viruses.

Software is considered malware based on the perceived intent of the creator rather than any particular features. Malware includes computer viruses worms trojan horses most root kits spyware dishonest adware crimeware and other malicious and unwanted software. Malware is not the same as defective software that is software which has a legitimate purpose but contains harmful bugs.

Many early infectious programs including the first Internet Worm and a number of MS DOS viruses were written as experiments or pranks generally intended to be harmless or merely annoying rather than to cause serious damage to computers. However since the rise of widespread broadband Internet access malicious software has come to be designed for a profit motive either more or less legal forced advertising or criminal. This can be taken as the malware authors choice to monetize their control over infected systems to turn that control into a source of revenue. For instance since 2003 the majority of widespread viruses and worms have been designed to take control of users computers for black market exploitation. Infected zombie computers are used to send email spam to host contraband data or to engage in distributed denial of service attacks as a form of extortion.

Another strictly for profit category of malware has emerged in spyware e.g. programs designed to monitor users web browsing display unsolicited advertisements or redirect affiliate marketing revenues to the spyware creator. Spyware programs do not spread like viruses they are generally installed by exploiting security holes or are packaged with user installed software such as peer to peer applications. It is not uncommon for spyware and advertising programs to install so many processes that the infected machine becomes unusable defeating the intention of the attack.

The best known types of malware viruses and worms are known for the manner in which they spread rather than any other particular behavior. The term computer virus is used for a program which has infected some executable software and which causes that software when run to spread the virus to other executable software. Viruses may also contain a payload which performs other actions often malicious. A worm on the other hand is a program which actively transmits itself over a network to infect other computers. A worm may also carry a payload.

The most costly form of malware in terms of time and money spent in recovery has been the broad category known as spyware. Spyware programs are commercially produced for the purpose of gathering information about computer users showing them pop up ads or altering web browser behavior for the financial benefit of the spyware creator. For instance some spyware programs redirect search engine results to paid advertisements. Others often called stealware by the media overwrite affiliate marketing codes so that revenue goes to the spyware creator rather than the intended recipient.

In order to coordinate the activity of many infected computers malware attackers have used coordinating systems known as botnets. In a botnet scenario the malware or malbot logs in to e.g. an internet relay chat IRC channel or other chat system. The malware attacker can then give instructions to all the infected systems simultaneously. Botnets can also be used to push upgraded malware to the infected systems keeping them resistant to anti virus software or other security measures.

As malware attacks become more frequent attention has begun to shift from viruses and spyware protection to malware protection and programs have been developed to specifically combat such malware attacks. Current anti malware programs can combat malware in two ways. First anti malware programs can provide real time protection against the installation of malware software on a user s computer. This type of spyware protection works the same way as that of anti virus protection in that the anti malware software scans all incoming network data for malware software and blocks any threats it comes across. Second anti malware software programs can be used solely for detection and removal of malware software that has already been installed onto a user s computer. This type of malware protection is normally much easier to use and more popular. This type of anti malware software scans the contents of the windows registry operating system files and installed programs on a computer and will provide a list of any threats found allowing a user to choose what they want to delete and what they want to keep or compare this list to a list of known malware components and removing files which match.

Thus malware remains an ongoing problem for e.g. computer users and or service providers. Accordingly there exists a need in the art to overcome the deficiencies and limitations described hereinabove.

In a first aspect of the invention a method for identifying malware activities implemented within a computer infrastructure includes receiving a data communication via a data channel and determining a user is not interactively logged in to a host. Additionally the method includes identifying the data communication as a potential malware communication in response to the determining the user is not interactively logged in to the host.

In another aspect of the invention a computer system for identifying malware comprises a storage a memory and a central processing unit. Additionally the computer system comprises first program instructions to receive a data communication via a data channel and second program instructions to determine a user is not interactively logged in to a host. Additionally the computer system comprises third program instructions to identify the data communication as a potential malware communication in response to the determining the user is not interactively logged in to the host. Furthermore the first second and third program instructions are stored in the storage for execution by the central processing unit via the memory.

In an additional aspect of the invention a computer program product comprising a computer usable storage medium having readable program code embodied in the medium is provided. The computer program product includes at least one component operable to receive a data communication via a data channel. Additionally the at least one component is operable to determine one of a user is not interactively logged in to a host and the user is interactively logged in to the host. Furthermore the at least one component is operable to identify the data communication as a potential malware communication in response to the determining the user is not interactively logged in to the host and identify the data communication as a non malware communication in response to the determining the user is interactively logged in to the host. The determining the user is not interactively logged in to the host comprises determining at least one of the user is not currently logged in to the host the host is in a screen saver mode the host is in a keyboard locked state and the host is in a screen powered down mode. The determining the user is interactively logged in to the host comprises determining comprises determining the user is currently logged in to the host host is not in the screen saver mode the host is not in the keyboard locked state and the host is not in the screen powered down mode.

The present invention generally relates to identifying malicious activities and more particularly to a system and method for identifying malicious activities or malware through non logged in host usage. In accordance with the invention by determining information about whether a user is interactively logged in to a host and or whether the host is currently in for example a screen saver mode keyboard locked state or screen powered down state it is possible to greatly assist the classification of whether an observed data channel is associated with an unauthorized command and control activity. That is if a user is interactively logged in to a host e.g. the user is currently logged in the host is not in a screen saver mode the host is not in a keyboard locked state and the host is not in a screen powered down state the command and control activity observed on a particular data channel is likely not malware. However if command and control activity is observed on a particular data channel while the user is not interactively logged in to a host e.g. the user is not currently logged in the host is in a screen saver mode the host is in a keyboard locked state and or the host is in a screen powered down mode the observed command and control activity is likely due to malware.

Current approaches to identifying malware are not operable to determine usage of command and control data channels when a user is not actively logged in to a host and associate this usage with potential malware. For example many classes of current malware and other unapproved software deployed within a network require specific command and control data channels to be created between the software controller e.g. the malware creator and the installed host. However the user of these command and control data channels can be difficult to identify due to obfuscation and impersonation techniques. That is whilst the communications may be identified as one type of traffic e.g. internet relay chat IRC ICQ an internet messaging computer program and or hyper text transfer protocol over secure socket layer HTTPS with current approaches it is non trivial to ascertain whether the communication is associated with permitted or malicious activities.

By implementing the present invention a system may detect whether an observed data channel is associated with an unauthorized command and control activity and thus detect malware. More specifically by determining whether a user is for example interactively logged in to the host and or whether the host is current in a screen saver or keyboard locked state the present invention is operable to determine that an observed data channel is associated with an unauthorized command and control activity. For example if an observed data channel is associated with command and control activity that is occurring while the user is for example not interactively logged in to the host and or when the host is currently in a screen saver or keyboard locked state the invention is operable to identify the data channel and its associated command and control activity as potentially malware activity. Additionally implementing the present invention will reduce the time money and resources expended on recovery due to malware.

As will be appreciated by one skilled in the art the present invention may be embodied as a system method or computer program product. Accordingly the present invention may take the form of an entirely hardware embodiment an entirely software embodiment including firmware resident software micro code etc. or an embodiment combining software and hardware aspects that may all generally be referred to herein as a circuit module or system. Furthermore the present invention may take the form of a computer program product embodied in any tangible medium of expression having computer usable program code embodied in the medium.

Any combination of one or more computer usable or computer readable medium s may be utilized. The computer usable or computer readable medium may be for example but not limited to an electronic magnetic optical electromagnetic infrared or semiconductor system apparatus device or propagation medium. More specific examples a non exhaustive list of the computer readable medium would include the following 

In the context of this document a computer usable or computer readable storage device may be any tangible device that can store the program for use by or in connection with the instruction execution system apparatus or device but does not include a propagation media. The term computer readable storage device does not encompass a signal propagation media such as a copper cable optical fiber and wireless transmission media.

Computer program code for carrying out operations of the present invention may be written in any combination of one or more programming languages including an object oriented programming language such as Java Smalltalk C or the like and conventional procedural programming languages such as the C programming language or similar programming languages. The program code may execute entirely on the user s computer partly on the user s computer as a stand alone software package partly on the user s computer and partly on a remote computer or entirely on the remote computer or server. In the latter scenario the remote computer may be connected to the user s computer through any type of network. This may include for example a local area network LAN or a wide area network WAN or the connection may be made to an external computer for example through the Internet using an Internet Service Provider .

The computing device includes a user host status identification UHSI tool . The UHSI tool is operable to receive data communications via a data channel determine whether a user is interactively logged in e.g. determine whether a user is currently logged in a host is not in screen saver mode the host not in keyboard locked state and the host not in screen powered down mode identify the data communication as a potential malware communication when the user is not interactively logged in identify the data communication as a non malware communication when the user is interactively logged in and store the identification and the associated data channel in a database e.g. the processes described herein. The UHSI tool can be implemented as one or more program code in the program control stored in memory A as separate or combined modules.

The computing device also includes a processor memory A an I O interface and a bus . The memory A can include local memory employed during actual execution of program code bulk storage and cache memories which provide temporary storage of at least some program code in order to reduce the number of times code must be retrieved from bulk storage during execution. In addition the computing device includes random access memory RAM a read only memory ROM and a CPU.

The computing device is in communication with the external I O device resource and the storage system B. For example the I O device can comprise any device that enables an individual to interact with the computing device or any device that enables the computing device to communicate with one or more other computing devices using any type of communications link. The external I O device resource may be for example a handheld device PDA handset keyboard etc.

In general the processor executes computer program code e.g. program control which can be stored in the memory A and or storage system B. Moreover in accordance with aspects of the invention the program control having program code controls the UHSI tool . While executing the computer program code the processor can read and or write data to from memory A storage system B and or I O interface . The program code executes the processes of the invention. The bus provides a communications link between each of the components in the computing device .

The computing device can comprise any general purpose computing article of manufacture capable of executing computer program code installed thereon e.g. a personal computer server etc. . However it is understood that the computing device is only representative of various possible equivalent computing devices that may perform the processes described herein. To this extent in embodiments the functionality provided by the computing device can be implemented by a computing article of manufacture that includes any combination of general and or specific purpose hardware and or computer program code. In each embodiment the program code and hardware can be created using standard programming and engineering techniques respectively.

Similarly the computing infrastructure is only illustrative of various types of computer infrastructures for implementing the invention. For example in embodiments the server comprises two or more computing devices e.g. a server cluster that communicate over any type of communications link such as a network a shared memory or the like to perform the process described herein. Further while performing the processes described herein one or more computing devices on the server can communicate with one or more other computing devices external to the server using any type of communications link. The communications link can comprise any combination of wired and or wireless links any combination of one or more types of networks e.g. the Internet a wide area network a local area network a virtual private network etc. and or utilize any combination of transmission techniques and protocols.

In embodiments a service provider such as a Solution Integrator could offer to perform the processes described herein for example on a subscription advertising and or fee basis. In this case the service provider can create maintain deploy support etc. the computer infrastructure that performs the process steps of the invention for one or more customers. These customers may be for example any business that uses technology. In return the service provider can receive payment from the customer s under a subscription and or fee agreement and or the service provider can receive payment from the sale of advertising content to one or more third parties.

In accordance with aspects of the invention the user host status identification UHSI tool is operable to identify a malicious agent or malware in a computer by its external communications. For example if the UHSI tool determines that a user is actively logged on to a host e.g. the user is currently logged on to the host the host is not in a screen saver mode the host is not in a locked keyboard status and the host is not in a screen powered down mode. The UHSI tool will identify those certain types of communications as valid not malicious. However if the UHSI tool determines that the user is not actively logged in to a host e.g. the user is not currently logged in the host is in a screen saver mode the host is in a keyboard locked state or the host is in a screen powered down mode then the UHSI tool may determine that all or a subset of the communications are potentially malicious.

For example malware botnet agents regularly employ internet relay chat IRC communications for centralized command and control. Legitimate IRC communications e.g. non malware communications require users to access the keyboard and interact. In accordance with aspects of the invention if the UHSI tool observes IRC communications and the UHSI tool determines that for example the host does not currently have a user interactively logged in it is almost certain that the host has been compromised and contains malware using IRC communications for command and control. Thus according to aspects of the invention the UHSI tool will identify the communication as a potential malware communication. Additionally in embodiments the UHSI tool may prompt a user for action regarding the identified communication which is likely a malware communication. For example in embodiments the UHSI tool may prompt a user for permission to delete the identified malware communication. In additional embodiments the UHSI tool may automatically remove the identified malware communication without any user input.

Additionally in embodiments the UHSI tool may determine command control traffic being observed while the screen keyboard etc. is inactive is not an authorized command control channel. An organization may for example use it s own remote control tools for updating hosts. Such legitimate command and control channels would already be known to the organization and may be identified e.g. in a database for example storage system B of . As such when the UHSI tool observes command control traffic on an unauthorized command control channel e.g. as identified in a database the UHSI tool is operable to identify the command control traffic as potential malware communications.

In embodiments the UHSI tool is operable to identify and or classify command control channels over a network. For example the UHSI tool may utilize network sniffing and monitoring devices to detect that certain types of command control traffic are in operation. This alert could then be passed back to a monitoring station that then checks to see if the host sending receiving the identified command control traffic is in an interactive state e.g. a user is actively logged on e.g. a user is currently logged on to the host the host is not in a screen saver mode the host is not in a locked keyboard status and the host is not in a screen powered down mode.

In accordance with further aspects of the invention the UHSI tool is operable to detect and maintain state information for example as to whether a user is currently logged on to the host whether the screen is currently in screen saver mode whether the keyboard is currently locked and or whether the screen is in a powered down mode amongst other state information. In embodiments the state information may be stored in a database e.g. storage system B of . By detecting and maintaining state information as to e.g. whether a user is currently logged on to the host whether the screen is currently in screen saver mode whether the keyboard is currently locked and or whether the screen is in a powered down mode the UHSI tool is able to determine if a user is interactively using the host. In embodiments the UHSI tool may utilize an operating system s application programming interfaces APIs to determine whether a user is currently logged on to the host whether the screen is currently in screen saver mode whether the keyboard is currently locked and or whether the screen is in a powered down mode amongst other parameters that may indicate whether a user is interactively logged in to a host. An API is a readable set of functions procedures methods or classes that an operating system library or service provides to support requests made by computer programs.

In additional embodiments the present invention may utilize a client software agent to determine e.g. whether a user is currently logged on to the host whether the screen is currently in screen saver mode whether the keyboard is currently locked and or whether the screen is in a powered down mode. That is as should be understood by those ordinarily skilled in the art a client software agent may be created to perform the detection role performed by an operating system s APIs.

In accordance with further aspects of the invention the UHSI tool is operable to combine the state information with the identification of external communication protocols unexpected or otherwise that are typically associated with interactive use to classify e.g. either directly or as part of a likelihood calculation whether the communication channel is associated with a malware or an unapproved command and control data channel. Moreover in embodiments the UHSI tool is operable to store the association of the data communication channel with the identified malware communication or the data communication channel with the identified non malware communication in a database e.g. storage system B of .

Furthermore the invention can take the form of a computer program product accessible from a computer usable or computer readable medium providing program code for use by or in connection with a computer or any instruction execution system. The software and or computer program product can be implemented in the environment of . For the purposes of this description a computer readable storage device or computer readable storage medium can be an apparatus that can store the program for use by or in connection with the instruction execution system apparatus or device. The storage device or medium can be an electronic magnetic optical electromagnetic or semiconductor system or apparatus or device . Examples of a computer readable storage device or medium include a semiconductor or solid state memory magnetic tape a removable computer diskette a random access memory RAM a read only memory ROM a rigid magnetic disk and an optical disk. Current examples of optical disks include compact disk read only memory CD ROM compact disc read write CD R W and DVD. The term computer readable storage device does not include signal propagation media such as copper cables optical fibers and wireless transmission media.

As shown in at step the UHSI tool receives a data communication via a data channel. At step the UHSI tool determines the user host status. As discussed above in embodiments the UHSI tool may determine the user host status using one or more APIs and or one or more client software agents. At step the UHSI tool determines whether a user is currently logged in to a host based on the determined user host status. If at step the UHSI tool determines that the user is currently logged in to the host then the process proceeds to step . If at step the UHSI tool determines that the user is not currently logged in to the host the process proceeds to step discussed further below.

At step the UHSI tool determines whether the host is in a screen saver mode based on the determined user host status. If at step the UHSI tool determines that the host is not in the screen saver mode then the process proceeds to step . If at step the UHSI tool determines that the host is in the screen saver mode then the process proceeds to step discussed further below.

At step the UHSI tool determines whether the host is in a keyboard locked state based on the determined user host status. If at step the UHSI tool determines that the host is not in the keyboard locked state then the process proceeds to step . If at step the UHSI tool determines that the host is in the keyboard locked state then the process proceeds to step discussed further below.

At step the UHSI tool determines whether the host is in a screen powered down mode based on the determined user host status. If at step the UHSI tool determines that the host is not in the screen powered down mode then the process proceeds to step . If at step the UHSI tool determines that the host is in the screen powered down mode then the process proceeds to step discussed further below. Those of skill in the art will recognize that other parameters to indicate whether a user is interactively logged in to a host are also contemplated by the present invention.

At step the UHSI tool identifies the data communication as a non malware communication. At step the UHSI tool stores the identified data communication and an association to the data channel in a database.

At step the UHSI tool identifies the data communication as a potential malware communication. At step the UHSI tool stores the identification and an association to the data channel in a database. At optional step the UHSI tool provides a user and or host with an option to delete the identified potential malware communication and or the detected potential malware. At optional step the UHSI tool deletes the potential malware communication and or the detected potential malware. As should be understood the dashed lines of steps and indicate that in embodiments steps and are optional steps.

The terminology used herein is for the purpose of describing particular embodiments only and is not intended to be limiting of the invention. As used herein the singular forms a an and the are intended to include the plural forms as well unless the context clearly indicates otherwise. It will be further understood that the terms comprises and or comprising when used in this specification specify the presence of stated features integers steps operations elements and or components but do not preclude the presence or addition of one or more other features integers steps operations elements components and or groups thereof.

The corresponding structures materials acts and equivalents of all means or step plus function elements in the claims if applicable are intended to include any structure material or act for performing the function in combination with other claimed elements as specifically claimed. The description of the present invention has been presented for purposes of illustration and description but is not intended to be exhaustive or limited to the invention in the form disclosed. Many modifications and variations will be apparent to those of ordinary skill in the art without departing from the scope and spirit of the invention. The embodiment was chosen and described in order to best explain the principals of the invention and the practical application and to enable others of ordinary skill in the art to understand the invention for various embodiments with various modifications as are suited to the particular use contemplated. Accordingly while the invention has been described in terms of embodiments those of skill in the art will recognize that the invention can be practiced with modifications and in the spirit and scope of the appended claims.

