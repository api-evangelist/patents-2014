---

title: Digitally controlled wide range pulse width modulator
abstract: The present invention provides a digitally controlled, current starved, pulse width modulator (PWM). In the PWM of the present invention, the amount of current from the voltage source to the ring oscillator is controlled by the proposed header circuit. By changing the header current, the pulse width of the switching signal generated at the output of the ring oscillator is dynamically controlled, where the duty cycle can vary between 50% and 90%. A duty cycle to voltage converter is used to ensure the accuracy of the system under process, voltage, and temperature (PVT) variations. The proposed pulse width modulator is appropriate for dynamic voltage scaling systems due to the small on-chip area and high accuracy under process, voltage, and temperature variations.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09007140&OS=09007140&RS=09007140
owner: University of Rochester
number: 09007140
owner_city: Rochester
owner_country: US
publication_date: 20140108
---
This application claims priority to U.S. Provisional Patent Application No. 61 750 072 entitled DIGITALLY CONTROLLED WIDE RANGE PULSE WIDTH MODULATOR filed on Jan. 8 2013 the contents of which are hereby incorporated by reference.

This invention was made with Government support under Grant No. CCF 0811317 awarded by the National Science Foundation NSF . The Government has certain rights in the invention.

Voltage controlled oscillators VCOs are widely used to generate a switching signal where some of the characteristics of the generated signal can also be controlled. Two types of VCOs are primarily used in high performance integrated circuits ICs inductor capacitor LC oscillators and ring oscillators. LC oscillators can operate at very high frequencies and exhibit superior noise performance. Alternatively ring oscillators occupy significantly smaller on chip area and have a wider tuning range. Due to these advantages ring oscillators have found widespread utilization in modern ICs.

A conventional ring oscillator consists of an odd number of inverters wherein the output of the last inverter is fed back to the input of the first inverter. The delay provided by each inverter in the chain of inverters provides a phase shift to the switching signal. The sum of these individual delays i.e. phase shifts and the feedback from the last to the first inverter provides a phase shift of 2 resulting in an oscillation. The frequency of this oscillation therefore depends upon the sum of the inverter delays within the chain.

The duty cycle of the generated switching signal is typically 50 for conventional ring oscillators when the PMOS p type metal oxide semiconductor and NMOS n type metal oxide semiconductor transistors within the inverters provide the same rise and fall transition slopes. The duty cycle of a ring oscillator can be changed by controlling the transition time of the inverters within the ring oscillator. Header and footer circuits are widely used to control the amount of current supplied to the PMOS and NMOS transistors within the ring oscillator inverter chain. It is desirable to be able to dynamically change the duty cycle of the ring oscillator thereby providing a dynamically changing input switching signal to an on chip voltage regulator. However the header and foot circuits currently known in the art do not provide a means for dynamically changing the duty cycle of the pulse width modulator.

Accordingly what is needed in the art is a pulse width modulator that provides a means for dynamic voltage scaling that can dynamically change the duty cycle of the input switching signal for on chip voltage regulators. It is desirable to have a pulse width modulator that will enable high granularity dynamic voltage scaling DVS at runtime and substantially reduce the reaction time from milliseconds to nanoseconds.

The present invention provides a digitally controlled pulse width modulator PWM which comprises a header circuit a ring oscillator and a duty cycle to voltage DC2V converter. The header circuit of the present invention controls the amount of current delivered to the PMOS transistors within the ring oscillator. Since the target specification is to vary the duty cycle between 50 and 90 no footer circuitry is used to control the current of the NMOS transistors. Contrary to the conventional header circuits where the header is connected to all of the inverters within the ring oscillator chain the proposed header circuit is connected to every other inverter stage to improve the dynamic range of the duty cycle. This header circuit provides high granularity duty cycle control which has a step size of 2 of the period. Additionally a DC2V converter which is based on a frequency to voltage converter is utilized to maintain the accuracy of the PWM under process voltage and temperature PVT variations. Under PVT variations the maximum change in the duty cycle is less than 1.5 of the period.

In one embodiment a pulse width modulator includes a ring oscillator comprising an odd plurality of delay stage inverters coupled in a sequential loop and a header circuit coupled between a power source and every other delay stage inverter of the odd plurality of delay stage inverters every other delay stage inverter including the first delay stage inverter and the last delay stage inverter of the sequential loop the header circuit configured to control a current flow from a power source to every other delay stage inverter of the ring oscillator.

In a particular embodiment the header circuit further includes a first transistor having a gate node coupled to an analog control signal a source node coupled to the power source and a drain node coupled to the ring oscillator a second transistor having a gate coupled to the analog control signal a source node coupled to the power source and a drain node coupled to a ground node through a resistor and a third transistor having a gate node coupled to the ground node through a resistor a source node coupled to the power source and a drain node coupled to the ring oscillator.

In an additional embodiment the third transistor further includes a plurality of parallel transistors each of the plurality of parallel transistors having a switch transistor coupled between the drain node and the ring oscillator.

The pulse width modulator further includes a duty cycle to voltage DC2V converter coupled between an output of the ring oscillator and the header circuit the DC2V converter to provide an analog control signal to an input of the header circuit the analog control signal to control a current flow from the header to the ring oscillator.

In operation of the invention a method of pulse width modulation is provided by controlling a current flow from a power source to every other delay stage inverter of a ring oscillator to change a transition slope of an input signal to generate an output signal having a modified duty cycle and by regulating the transition slope of the output signal from every other delay stage inverter of the ring oscillator.

As a result of the small on chip area of the circuitry fast control circuitry high accuracy under PVT variations and dynamic duty cycle control the proposed pulse width modulator can dynamically change the duty cycle of the input switching signal for on chip voltage regulators. The PWM circuitry will enable high granularity dynamic voltage scaling DVS at runtime and substantially reduce the reaction time from milliseconds to nanoseconds.

A diagram of a pulse width modulator in accordance with an embodiment of the present invention is shown with reference to . In this particular embodiment the pulse width modulator utilizes a seven stage ring oscillator . However it is within the scope of the present invention to utilize a ring oscillator comprising a different number of stages.

In the embodiment of the inverters are connected in a sequential loop to form the ring oscillator . In this embodiment the first third fifth and seventh stages of the ring oscillator are connected to the header circuit and the inverters in the second fourth and sixth stages of the ring oscillator are connected directly to V. Each of the inverter stages have a second input coupled to a ground node . In a ring oscillator the inverters at every other stage generate the same logic function with a phase shift. By having the header circuit connected to every other stage of the ring oscillator the charging time of the output nodes of these stages and are effectively increased. The inverters and which are not connected to the header regulate the transition slopes of the signal generated by stages and which have a modified duty cycle.

The pulse width modulator of further includes a digital control module coupled to the header circuit . The digital control module provides one or more digital control signals to the header circuit . The digital control signals are used to dynamically change the individual transistors of the header circuit to provide a high granularity duty cycle control. The pulse width modulator further includes a duty cycle to voltage DC2V converter coupled between the output of the ring oscillator and the header circuit . The duty cycle to voltage converter provides an analog control signal that is utilized to maintain a constant current flow from the header circuit to the ring oscillator under process voltage and temperature PVT variations. The pulse width modulator further includes an output inverter coupled to the output of the ring oscillator the output inverter to provide an output voltage from the pulse width modulator .

A diagram illustrating a header circuit of the pulse width modulator in accordance with an embodiment of the present invention is shown with reference to . As shown the header circuit is coupled to the ring oscillator to current starve every other stage in the ring oscillator inverter chain. The header circuit includes two input control signals a digital control signal C from a digital control module and an analog control signal C from a duty cycle to voltage converter as previously described with reference to . The digital control signal Cis to used to dynamically change the individual transistors to provide a high granularity duty cycle control whereas the analog control signal Cis utilized to maintain a constant current flow from the header to the ring oscillator under process voltage and temperature PVT variations. The digital control module may provide multiple digital control C signals to dynamically change the duty cycle and the duty cycle to voltage DC2V converter ensures the accuracy of the duty cycle by providing an analog control signal C to the header circuit under process voltage and temperature PVT variations.

In a specific embodiment an addition based current source as shown in is used as the header circuit to compensate for temperature and process variations by keeping the total current constant. In this specific embodiment the header circuit includes one common input voltage that controls the gate voltage of two transistors . The source nodes of the transistors are coupled to the source voltage . The drain node of the first transistor is coupled to the ring oscillator and the drain node of the second transistor is coupled to a ground node through a resistor . The drain node of the second transistor is additionally coupled to the gate node of a third transistor . The source node of the third transistor is coupled to the source voltage and the drain node of the third transistor is coupled to the ring oscillator . By controlling the gate voltage of transistor and the sum of the current delivered to the ring oscillator is kept constant for a wide range of temperature and process variations.

In an additional embodiment of the present invention an additional embodiment of the header circuit is illustrated with reference to . In this embodiment the duty cycle of the ring oscillator output is controlled by changing the transition time of the PMOS transistors at every other inverter stage within the ring oscillator . In this embodiment instead of having a single transistor whose gate is connected to the resistor as in transistor of multiple PMOS transistors are added in parallel in place of transistor in the proposed header circuit . As shown in the first transistor and the second transistor have a gate node coupled to a common input signal. Transistors and have a source node coupled to the source voltage . The drain node of transistor is coupled to the ring oscillator and the drain node of transistor is coupled to a ground node through a resistor . The gate nodes of transistors and are coupled to the ground node through the resistor and the source nodes of transistors and are coupled to the voltage source . Additionally each of the drain nodes of transistors and are coupled to a corresponding switching transistor . The drain nodes of the switching transistors are coupled to the ring oscillator . The gate nodes of each of the switching transistors and are coupled to one of the digital control signals generated by the digital control module as shown with reference to . As such all of the transistors and have approximately the same gate to source voltage but the voltage at the drain nodes are controlled by the additional switch transistors . The gate voltage of these switching transistors is controlled by the corresponding digital control signal from the digital control module to turn on and turn off individual header stages. Turning all the header stages to an on state allows maximum current to the ring oscillator thereby minimizing the duty cycle of the ring oscillator . In a particular embodiment the first two transistors in the header circuit are comparably large relative to the other transistors in the header circuit to minimize the mismatch. In a specific embodiment a minimum channel length of 150 nm is used for the two first input transistors as opposed to a 40 nm channel length for the remainder of the transistors.

In a particular embodiment a frequency to voltage converter is utilized as a duty cycle to voltage DC2V converter in the pulse width modulator PWM of the present invent. A circuit schematic of this DC2V converter is shown with reference to . In this embodiment there are primarily three different phases of the DC2V circuit. During the first phase a first capacitor is charged through a first transistor . The first transistor has a gate node coupled to an input switching signal from the ring oscillator a source node coupled to a source voltage through a resistor and a drain node coupled to the source node of a second transistor . A fourth transistor has a source node coupled to the source node of the first transistor a gate node coupled to the input switching signal from the rings oscillator and a drain node coupled to a ground node . In one embodiment the first transistor is a PMOS transistor and the fourth transistor is an NMOS transistor. The DC2V converter further includes a logic control module having an input coupled to the input switching signal of the ring oscillator a first output coupled to the gate node of a fifth transistor and a second output coupled to an input of an inverter and to the gate node of a second transistor . The output of the inverter is coupled to the gate of a third transistor . In the second phase the second transistor i.e. switch and the third transistor are turned on to allow charge sharing between the first capacitor and a second capacitor . In the third phase the first capacitor is discharged through the second transistor . The charging time of the first capacitor depends on the duty cycle of the input switching signal from the ring oscillator . A signal with a greater duty cycle causes more charge accumulation on the first capacitor thereby increasing the output voltage of the DC2V converter.

A timing diagram for an exemplary five stage ring oscillator in accordance with the present invention is shown with reference to . In the timing diagram of it is shown that each stage connected to the header circuit changes the transition slope of the input signal and each stage directly connected to the supply voltage V regulates the transition slope of the signal from the previous stage.

In an exemplary embodiment the proposed pulse width modulator was designed and implemented using the 22 nm CMOS predictive technology model PTM . Some of the related parameters in the technology model file were modified to include process corners such as typical typical TT slow slow SS and fast fast FF to the circuit simulation.

For the simulation results of the proposed circuit first the effect of the current which is provided by the header circuit to the ring oscillator on the duty cycle of the ring oscillator output is analyzed by using an ideal current source in place of the header circuit. When the current from the header circuit changes from 2 A to 50 A the duty cycle of the switching signal at the output of the ring oscillator changes from 93 to 25 . Although the relationship between the amount of header current and the duty cycle is not linear as shown in this relationship can be easily controlled by the digital control module.

The accuracy of the proposed PWM was also analyzed for different duty cycle ratios under PVT variations. The percent deviation of different duty cycle ratios is listed in the table of when the supply voltage varies 5 from the nominal 0.95 volts and the temperature varies from 27 C. to 80 C. The simulations have been performed for TT SS and FF process corners. The deviation of the duty cycle under the PVT variations is less than 1.5 of the total period of the switching signal. A transistor with a narrower gate width is more sensitive to PVT variations than a wider gate width transistor. Narrower transistors are turned on within the header circuitry when generating a greater duty cycle switching signal. The effect of PVT variations is therefore more prominent on the signals with a greater duty cycle in the proposed system. This trend can be observed in the table wherein the deviation for signals with 50 duty cycle is smaller than for the signals with 90 duty cycle.

In accordance with the present invention a digitally controlled PWM with a wide pulse width range of 50 to 90 is provided. An addition based header circuit is proposed to provide a greater range of header current. In the present invention the proposed header circuit is connected to every other stage of the ring oscillator to significantly improve the dynamic range of the pulse width of the output signal. A DC2V converter samples the duty cycle of the output signal and generates an analog voltage to control the header current. The PVT variations are compensated by the feedback loop generated by this DC2V converter. Under PVT variations the deviations in the pulse width are less than 1.5 of the switching signal period. The proposed pulse width modulator provides a means for dynamic voltage scaling systems due to the fast control circuitry high accuracy under PVT variations and dynamic duty cycle control

It will be seen that the advantages set forth above and those made apparent from the foregoing description are efficiently attained and since certain changes may be made in the above construction without departing from the scope of the invention it is intended that all matters contained in the foregoing description or shown in the accompanying drawings shall be interpreted as illustrative and not in a limiting sense.

It is also to be understood that the following claims are intended to cover all of the generic and specific features of the invention herein described and all statements of the scope of the invention which as a matter of language might be said to fall therebetween.

