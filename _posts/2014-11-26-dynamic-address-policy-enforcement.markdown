---

title: Dynamic address policy enforcement
abstract: Policy enforcement is disclosed. A first identity and second notification are respectively received from a network device at different first and second times. In response to the receipt of the second identity notification, a determination is made that an IP address associated with the network advice has changed from a first IP address to a second IP address. A mapping between an identifier associated with the device and the first IP address is updated to a mapping between the identifier and the second IP address. A policy is updated based on the updated mapping.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09461964&OS=09461964&RS=09461964
owner: Palo Alto Networks, Inc.
number: 09461964
owner_city: Santa Clara
owner_country: US
publication_date: 20141126
---
This application is a continuation of co pending U.S. patent application Ser. No. 13 246 472 now U.S. Pat. No. 8 930 529 entitled POLICY ENFORCEMENT WITH DYNAMIC ADDRESS OBJECT filed Sep. 27 2011 which is incorporated herein by reference for all purposes.

Devices such as firewalls are sometimes used to prevent individuals from accessing resources to which they are not authorized. As an example members of the public may be entitled to access content served by a web server but not authorized to access other services available on the server such as administrative tools. A firewall can enforce such policies such as through a set of rules that include static information about the server such as an IP address.

Increasingly businesses and other entities are using hosted computing resources instead of purchasing and maintaining computer hardware themselves. As one example instead of maintaining a set of dedicated physical machines e.g. to serve web pages businesses run virtual machines on leased hardware. In such a scenario if a particular physical machine fails the virtual machine image s running on that physical machine can be migrated to a new physical machine. Unfortunately the dynamic nature of virtual machine migration can pose problems for firewall rules which traditionally expect servers to be configured with static IP addresses.

The invention can be implemented in numerous ways including as a process an apparatus a system a composition of matter a computer program product embodied on a computer readable storage medium and or a processor such as a processor configured to execute instructions stored on and or provided by a memory coupled to the processor. In this specification these implementations or any other form that the invention may take may be referred to as techniques. In general the order of the steps of disclosed processes may be altered within the scope of the invention. Unless stated otherwise a component such as a processor or a memory described as being configured to perform a task may be implemented as a general component that is temporarily configured to perform the task at a given time or a specific component that is manufactured to perform the task. As used herein the term processor refers to one or more devices circuits and or processing cores configured to process data such as computer program instructions.

A detailed description of one or more embodiments of the invention is provided below along with accompanying figures that illustrate the principles of the invention. The invention is described in connection with such embodiments but the invention is not limited to any embodiment. The scope of the invention is limited only by the claims and the invention encompasses numerous alternatives modifications and equivalents. Numerous specific details are set forth in the following description in order to provide a thorough understanding of the invention. These details are provided for the purpose of example and the invention may be practiced according to the claims without some or all of these specific details. For the purpose of clarity technical material that is known in the technical fields related to the invention has not been described in detail so that the invention is not unnecessarily obscured.

Communications between ExampleCo s virtual servers and resources outside of ACME Hosting s data center e.g. communications from laptop via network pass through data appliance placed at the perimeter of data center . Such communications may take place using any appropriate communication protocol such as Hypertext Transfer Protocol HTTP Secure Sockets Layer SSL and File Transfer Protocol FTP . In the example shown in data appliance is a firewall and is configured to enforce policies also referred to herein as rules with respect to the communications it receives. Other types of devices can also be configured to provide the functionality described herein as being performed by data appliance . For example a router gateway intrusion detection system intrusion prevention system or other appropriate device can be configured to perform either or both of the identity management functionality and policy enforcement functionality. In some embodiments data appliance is also configured to enforce policies with respect to traffic that stays within ACME s data center .

As explained above data appliance is configured to enforce various policies. Such policies can apply to particular devices e.g. virtual server particular users and or groups e.g. of devices or users . As one example a policy can specify that access to virtual server via HTTPS is permitted by anyone including an arbitrary member of the public using laptop . As another example a policy can specify that access to virtual server via SSH is permitted by members of the Engineering group and denied to anyone else. Other types of actions can also be specified such as policies requiring that certain types of access be logged. Other types of policies can also be specified as applicable such as quality of service policies instead of or in addition to access security policies.

Also stored by data appliance is a repository of mappings between the unique device identifiers and the IP address of the devices. The mappings can be stored in a variety of forms such as in a database or as a set of one or more flat files. One example of a mapping is ACME VM 1 10.0.0.1 indicating that the IP address of the device having a unique identifier of ACME VM 1 i.e. virtual machine is 10.0.0.1. Other information can also be included in the mapping as applicable such as a timestamp at which the mapping was added or updated . As will be described in more detail below when the IP address of a particular device changes the mapping in the repository is updated and any firewall rules involving the particular device are updated as well.

Other events can also be used to trigger the sending of document to data appliance . For example suppose virtual machine is a virtualized desktop computer assigned to a member of the engineering group at ExampleCo. Each time the employee logs into virtual machine a script executes that sends document to data appliance .

At data appliance stores identifier and IP address in repository . As will be described in more detail below in some embodiments the identity notification is received indirectly from the network device by data appliance such as by an agent working in cooperation with the data appliance and or device .

At a policy is updated based on the received identity notification. As one example at the previously compiled version of policy is recompiled using the updated IP address . In various embodiments the identity notification is a push type notification and the receipt of a notification at automatically triggers recompilation at of any rules implicated by the received notification.

Finally at the updated policy is applied. As one example when virtual machine is migrated from host to users such as a user of client will be permitted to access virtual machine via HTTPS at its new IP address.

When components such as agent and directory service provider are included in an environment portions of the functionality provided by data appliance can be replicated by the agent and or directory service provider or may be provided by those components instead of being provided by data appliance . As one example directory service provider can be configured to provide API with devices such as virtual machine sending identity notifications to the directory service provider instead of to data appliance . Similarly directory service provider can be configured to store repository instead of the ID to IP address mappings being stored by data appliance . In such scenarios data appliance is configured to cooperate with directory service provider e.g. via agent as needed to update and enforce policies when IP addresses of devices change.

Also included in the environment shown in are two additional network devices node a computer within enterprise network and node a computer outside of network and data center . Either or both of nodes and may be configured to use dynamic IP addresses and can have pertinent policies included in data appliance in accordance with the techniques described herein. For example node can be configured to execute a script at startup that sends a document similar to document to data appliance or agent or directory service provider as applicable .

Although the foregoing embodiments have been described in some detail for purposes of clarity of understanding the invention is not limited to the details provided. There are many alternative ways of implementing the invention. The disclosed embodiments are illustrative and not restrictive.

