---

title: Optimization with a control mechanism using a mixed-integer nonlinear formulation
abstract: A method of optimizing production of wells using choke control includes generating, for each well, an intermediate solution to optimize the production of each well. The generating includes using an offline model that includes a mixed-integer nonlinear program solver and includes using production curves based on a choke state and a given wellhead pressure. The method further includes calculating, using a network model and the intermediate solution of each well, a current online wellhead pressure for each well. The method further includes setting the intermediate solution as a final solution based on determining that a difference between the current online wellhead pressure of each well and a prior online wellhead pressure of each well is less than a tolerance amount. The method further includes adjusting, using the final solution of each well, at least one operating parameter of the wells.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09104823&OS=09104823&RS=09104823
owner: Schlumberger Technology Corporation
number: 09104823
owner_city: Sugar Land
owner_country: US
publication_date: 20140206
---
This application is a continuation application of and thereby claims benefit under 35 USC. 120 to U.S. application Ser. No. 13 253 680 filed on Oct. 5 2011 and entitled GAS LIFT OPTIMIZATION WITH CHOKE CONTROL USING A MIXED INTEGER NONLINEAR FORMULATION and incorporated herein by reference. Further U.S. application Ser. No. 13 253 680 claims benefit under 35 U.S.C. 119 e of U.S. Provisional Patent Application No. 61 392 530 filed on Oct. 13 2010 and entitled GAS LIFT OPTIMIZATION WITH CHOKE CONTROL USING A MIXED INTEGER NONLINEAR FORMULATION which is hereby incorporated by reference.

An oilfield production network network includes a number of interconnected wells branches manifolds separators storage facilities and other elements to aid the extraction and transport of hydrocarbons from a source the reservoir via the wells to a sink a downstream delivery point . At times production engineers use computer models of the network for production operation purposes. Such models simulate multi phase flow behavior through the network and are used for investigation and prediction purposes such as but not limited to production monitoring facility design and sizing scenario analysis multi phase flow assurance and field pressure management to ensure hydrocarbon flow to a delivery sink.

From an operational point of view one objective is to maximize production or profit from the produced and saleable oil and gas components while minimizing production costs and meeting all existing operating constraints. The constraints include for example limits on storage fluid flow velocities through pipes to prevent erosion temperature levels for hydrate formation prevention budget and the availability of natural gas for artificial lift purposes. At times different procedures may be used to enhance production from one or more wells. For example changes in pressure at various locations in the network of wells through the use of flow control devices may induce additional hydrocarbons e.g. oil gas from a reservoir for extraction.

In general in one aspect the application relates to a method of optimizing production of wells using choke control. The method includes generating for each well an intermediate solution to optimize the production of each well. The generating includes using an offline model that includes a mixed integer nonlinear program solver and includes using production curves based on a choke state and a given wellhead pressure. The method further includes calculating using a network model and the intermediate solution of each well a current online wellhead pressure for each well where the current online wellhead pressure for each well is dependent upon each other well. The method further includes setting the intermediate solution as a final solution based on determining that a difference between the current online wellhead pressure of each well and a prior online wellhead pressure of each well is less than a tolerance amount. The final solution of each well identifies a value for the at least one operating parameter. The method further includes adjusting using the final solution of each well at least one operating parameter of the wells to generate an actual wellhead pressure of each well.

In general in one aspect the application relates to a system for optimizing production of a plurality of wells using choke control. The system includes a hardware processor sensors for collecting data from the wells an offline model executing on the hardware processor a network model operatively connected to the offline model and executing on the hardware processor and an optimization engine operatively connected to the offline model and the network model. The offline model generates for each well an intermediate solution to optimize the production of each well using the data collected by the sensors a mixed integer nonlinear program solver and production curves based on a choke state and a given offline wellhead pressure. The network model calculates using each intermediate solution of each well a current online wellhead pressure for each well. The current online wellhead pressure for each well is dependent upon each other well. The optimization engine sets the intermediate solution as a final solution based on determining that a difference between the current online wellhead pressure of each well and a prior online wellhead pressure of the each well is less than a tolerance amount. The final solution of each well identifies a value for the at least one operating parameter. The optimization engine further adjusts using final solution of each well at least one operating parameter of the wells to generate an actual wellhead pressure of each well.

In general in one aspect the application relates to a computer readable medium that includes computer readable program code embodied therein for generating for each well an intermediate solution to optimize the production of each well. The generating includes using an offline model that includes a mixed integer nonlinear program solver and includes using production curves based on a choke state and a given wellhead pressure. The computer readable program code embodied is further for calculating using a network model and the intermediate solution of each well a current online wellhead pressure for each well where the current online wellhead pressure for each well is dependent upon each other well. The computer readable program code embodied is further for setting the intermediate solution as a final solution based on determining that a difference between the current online wellhead pressure of each well and a prior online wellhead pressure of each well is less than a tolerance amount. The final solution of each well identifies a value for the at least one operating parameter. The computer readable program code embodied is further for adjusting using the final solution of each well at least one operating parameter of the wells to generate an actual wellhead pressure of each well.

This summary is provided to introduce a selection of concepts that are further described below in the detailed description. This summary is not intended to identify key or essential features of the claimed subject matter nor is it intended to be used as an aid in limiting the scope of the claimed subject matter.

Other aspects of lift gas optimization with choke control will be apparent from the following description and the appended claims.

Embodiments are shown in the above identified drawings and described below. In describing the embodiments like or identical reference numerals are used to identify common or similar elements. The drawings are not necessarily to scale and certain features may be shown exaggerated in scale or in schematic in the interest of clarity and conciseness.

Embodiments of the disclosure include a method system and computer readable medium for optimizing production of a network using lift gas optimization with choke control. Example systems and methods described herein enable users to modify operating parameters for one or more wells in the network to maximize production and or minimize cost. Specifically embodiments of the disclosure include an iterative offline online modeling procedure to optimize lift gas with choke control to meet an objective function e.g. increase production reduce cost for the network.

As used herein the terms lift gas gas lift lift gas and gas lift shall mean a gas that is injected into a production wellbore to induce hydrocarbons to enter the wellbore from a producing zone by reducing pressure at specific locations in the wellbore. Further as used herein an iterative online offline procedure or similarly worded procedure shall mean iteratively running an offline model defined below using the results of the offline model to run a network i.e. online model and if there is no acceptable convergence between the online and offline models repeating the process using the output of the network model from the previous iteration for input to the offline model in the subsequent iteration.

In order to establish a lift gas injection rate together with the settings of other components of concern in a network simulation a nonlinear optimization problem may be presented. Furthermore given that certain decision variables may be discrete e.g. block valves with on off states or fixed position chokes a mixed integer nonlinear program solver may be developed and implemented in one or more embodiments to achieve a specific goal stated by objective function.

In one or more embodiments lift gas is used to enhance production for a network of completed wells. Specifically individual well productivity for a network of wells may be improved by injection of lift gas e.g. natural gas at high pressure directly into a wellbore containing fluid from a reservoir or producing layer. The reduced density of the fluid column caused by the injection of the lift gas effectively lowers the flowing bottom hole pressure causing an increased pressure differential. The increased pressure differential induced across the sandface described below assists greater fluid production up to the surface. However as described below with respect to injecting too much lift gas may increase the frictional pressure drop and lower the possible production. One or more embodiments are configured to determine a desirable lift gas quantity and choke state i.e. choke position for each well in a network of wells to optimize production from each well.

In one or more embodiments the choke state of a choke at one or more wells in a network are used to restrict flow of produced hydrocarbons. As a result an additional layer of control may be used in addition to the lift gas injection to optimize the production of the network of wells and also to meet certain operating constraints. As explained above a network is a number of interconnected wells branches manifolds separators storage facilities and other elements to aid the extraction and transport of hydrocarbons from a source the reservoir via the wells to a sink a downstream delivery point . One or more embodiments simultaneously model both the lift gas rate and the choke state for each well. Further because of the offline definition described herein the offline problem posed is convex i.e. the optimal offline solution can be obtained with greater ease and used in the network model to aid convergence of the overall procedure .

As shown in the oilfield shows the completed well in a subterranean formation . In one or more embodiments the completed well is one of a network of wells in the oilfield . The subterranean formation of the oilfield includes several geological structures. As shown the formation has limestone layer 1 shale layer 1 sand layer 1 shale layer 2 sand layer 2 limestone layer 2 and a producing layer . In one or more embodiments various survey tools and or data acquisition tools are adapted to measure the formation and detect the characteristics of the geological structures of the formation before and during the exploration process.

As shown in the completed well includes casing inside of which is production tubing that extends into the producing layer . The production tubing has an annulus into which lift gas is injected from the surface . The lift gas travels down the annulus of the production tubing and exits through the lift gas valve into the wellbore . The lift gas valve in this instance is placed just above the producing layer in the second limestone layer . The lift gas valve may be placed at any layer in the subterranean formation depending on the well completion and the selected objective function for the network and is used to control an amount of lift gas that enters the well bore . In addition multiple lift gas valves may be placed at multiple levels in the annulus .

As the lift gas enters the wellbore the pressure inside the wellbore drops. As a result the pressure measured at the bottom of the wellbore i.e. the bottom hole pressure is less than the pressure inside the producing layer i.e. the in situ reservoir pressure . Because of the pressure differential the hydrocarbons in well are pushed to surface and more fluid from the producing layer is induced into the wellbore to become produced hydrocarbons . The produced hydrocarbons are then brought to the surface through the wellhead and into the production pipe .

Further as shown in the area where the bottom of the casing as well as in this case the bottom of the production tubing meets the producing layer is the sandface . The bottom hole pressure exists at the bottom of the wellbore at the sandface . The wellbore is capped at the surface by a wellhead which maintains a wellhead pressure to draw out the produced hydrocarbons .

Just below the surface at the top of the limestone layer a choke is placed inside annulus . The choke has an adjustable orifice that controls the flow rate of the fluid in the wellbore including the produced hydrocarbons to the surface . The choke may be adjusted to a fully open position a fully closed position or any position between fully open and fully closed.

Further as shown in a production pipe extends from the wellhead to transport the produced fluid e.g. including hydrocarbons that are brought to the surface from the subterranean formation . The wellhead pressure is maintained at a certain level in order to maintain a pressure differential with the bottom hole pressure.

In one or more embodiments the oilfield is associated with sensors production equipment e.g. pumps motors compressors and other elements used to produce hydrocarbons from the oilfield and is configured to perform wellbore operations such as fracturing production or other applicable operations. Generally production operations are referred to as field operations of the oilfield . These field operations are typically performed as directed by the surface unit .

In one or more embodiments the surface unit is operatively coupled to the completed well as well as other wells in the oilfield . In particular the surface unit is configured to communicate with one or more elements of the oilfield e.g. sensors production equipment to send commands to the elements of the oilfield and to receive data therefrom. For example the production equipment e.g. a pump used to inject the lift gas into the annulus choke state of the choke may be adjusted. e.g. to inject a greater amount of lift gas into the annulus or to control the flow rate in the well based on a command sent by the surface unit . In one or more embodiments the surface unit derives commands sent to the production equipment based on one or more final solutions described below generated by the iterative online offline procedure described herein. In particular the state of various production equipment such as choke position and amount of lift gas may be dictated by the final solution s generated by the iterative online offline procedure thereby adjusting the production of hydrocarbons in the oilfield.

The surface unit may be located at the oilfield and or remote locations. The surface unit may be provided with computer facilities for receiving storing processing and or analyzing data from the elements of the oilfield . The surface unit may also be provided with functionality for actuating elements at the oilfield . The surface unit may then send command signals to the oilfield in response to data received for example to control and or optimize production of the network of wells in the oilfield .

In one or more embodiments the data received by the surface unit represents characteristics of the subterranean formation and may include seismic data and or information related to porosity saturation permeability natural fractures stress magnitude and orientations elastic properties etc. collected prior to completion of a well during a drilling fracturing logging or during production operations of the wellbore at the completed well . Other data may also be collected including but not limited to historical data user inputs economic information other measurement data and other parameters of interest.

In one or more embodiments the surface unit is communicatively coupled to a production computer system described below with respect to . The data received by the surface unit may be sent to the production computer system far further analysis. Generally the production computer system is configured to analyze model control optimize or perform other management tasks of the aforementioned field operations based on the data provided from the surface unit . In one or more embodiments the production computer system is provided with functionality for manipulating and analyzing the data to identify geological surfaces in the subterranean formation or to perform simulation planning and optimization of production operations of the wellsite system . The result generated by the production computer system may be displayed for a user viewing using a 2 dimensional 2D display a 3 dimensional 3D display and or one or more other suitable displays. Although the surface unit is shown as separate from the production computer system in in other examples the surface unit and the production computer system may also be combined.

As shown in the production computer system includes a production optimization application a storage repository a processor memory an application interface and optionally a security module . The production optimization application includes an optimization engine a network model and an offline model . The storage repository includes production profiles solutions which include wellhead pressures and choke states and tolerances . The production computer system is also operatively connected with a user and a surface unit within an oilfield . The surface unit communicates with sensors and production equipment within the oilfield . Each of these elements is described below.

In one or more embodiments the production computer system is implemented according to a client server topology. The production computer system may correspond to enterprise software running on one or more servers and in some embodiments is implemented as a peer to peer system or resident upon a single computing system. In addition the production computer system may be accessible from other machines using one or more application programming interfaces and or user interfaces not shown . The production computer system may be accessible over a network connection not shown such as the Internet by one or more users e.g. engineer production supervisor . Further information and or services provided b the production computer system may also be stored and accessed over the network connection.

The production computer system may be a local computer system of the user . The production computer system may optionally not be implemented using a client server topology. For example the production computer system may correspond to a laptop computer desktop computer mobile device or another type of computing device or combination of multiple computing devices. Additionally or alternatively the production computer system may be a distributed computer system and or multi processor computer system in which the computer system includes multiple distinct computing devices.

Continuing with the user sends data to and receives data from the production computer system . Examples of data that the user may send to the production computer system include but are not limited to user preferences settings operating constraints and financial constraints. Examples of data that the user may receive from the production computer system include but are not limited to operating parameters including a choke state of one or more chokes production data production profiles and lift gas flow. The user may be an engineer a production supervisor an accountant a risk manager or some similar individual or software program involved in the production of the network of wells.

The production computer system may also be implemented as a browser extension. In such a scenario user software may interact directly with the production computer system as a browser extension.

Continuing with the production computer system is configured to interact with the user . Specifically the application interface of the production computer system is configured to receive data from and send data to the user . The device e.g. computer used by the user may include an interface to receive data from and send data to the computer system . Examples of an interface may include but are not limited to a graphical user interface an application programming interface a keyboard a monitor a mouse a web service a data protocol adapter some other hardware and or software or any suitable combination thereof.

The oilfield may be the same oilfield described above with respect to . The oilfield includes all of the land above at and under the surface materials equipment and any other elements used in the production of a network of wells. The surface unit of the oilfield may be the same as or have the same functionality as the surface unit described above with respect to . The surface unit may communicate with e.g. receive data from send instructions to adjust a mode of operation for the sensors and the production equipment .

In one or more embodiments the sensors are any measuring and or monitoring devices located anywhere in the oilfield . Examples of sensors include but are not limited to pressure gauges flow gauges gas monitors voltmeters and ammeters. Production equipment may include any device that is used to produce hydrocarbons from the oilfield. Examples of production equipment include but are not limited to pumps motors chokes production tubing casing and piping.

In one or more embodiments the production computer system includes the production optimization application having software instructions stored in memory and executing on the processor . The production optimization application includes functionality to communicate with the surface unit for receiving data from the surface unit and for managing e.g. adjust one or more operating parameters of production equipment analyze model control optimize and or perform other field operation tasks the aforementioned field operations based on the received data. In one or more embodiments the received data is stored in the data repository to be processed by the production optimization application .

In one or more embodiments the processing computer system is configured to use the optimization engine to retrieve and store production profiles solutions including wellhead pressures and choke states and tolerances in the storage repository in accordance with one or more embodiments. The production profiles are one or more production curves for a well. A production curve for a well represents production of a well under a range of values for two or more operating variables. For example a production curve may represent a flow rate of produced hydrocarbons based on a range of volumes and or pressures of lift gas. below describes production curves further.

In one or more embodiments solutions are values e.g. pressure choke state gas lift rates that are calculated as optimal values for an iteration of an offline model described below for a particular well in a network. Specifically a solution represents a value or range of values at which an element that controls the production of hydrocarbons in the oilfield operates at. For example the solution for injecting lift gas in a particular well in a network may be 3 million standard cubic feet per day MMscfd at 100 psi. As another example the solution for a choke state at a given well in the network may be 50 open. During the interation process the solution may be referred to herein as an intermediate solution. When convergence is achieved and the difference between a prior on hue wellhead pressure and a current a prior online wellhead pressure is less than a tolerance amount the current intermediate solution may be referred to as a final solution. In other words the word final with regards to solution means that the solution is the last solution generated before convergence of the iteration process is identified. The word final is not to imply that additional steps or iterations may not be performed.

In one or more embodiments wellhead pressures are a value of pressure at the wellhead. In one or more embodiments the gas lift allocation rates indicate the amount of lift gas injected into each well in a network. The wellhead pressures may be actual pressure values used in production operations and or values of pressures that were calculated during a previous iteration of the online offline procedure and to which the gas lift allocation rates corresponds.

In one or more embodiments of the invention the electronic submersible pump ESP rates for horsepower allocation. The ESP rates are the amount of horsepower used for each well in the network. In other words rather than gas lift allocation versus production the production curves may be based on horse power allocation versus production. Thus the gas lift rates may be replaced in the following discussion with ESP rates to obtain a final solution for electronic submersible pumps. Similar to gas lift rates and ESP rates other control variables that may be specified with production profiles for each well may be used without departing from the scope of the discussion herein. In other words the methodology disclosed herein may be used for other control variables.

In one or more embodiments choke states are a position of the choke to restrict production flow to the surface for each well in the network. A choke state may be fully open fully closed or some percentage of open or closed . The choke states may be actual choke states used in production operations and or choke states that were calculated during a previous iteration of the online offline procedure.

In one or more embodiments tolerances are one or more values used to determine whether an additional iteration in the online offline procedure should be performed. A tolerance may be a unitless number a percentage or some other value that represents whether a value or series of values from the offline model are sufficiently close to a value or series of values from the online model.

The storage repository and or any of the data stored therein may be a data store such as a database a file system one or more data structures e.g. arrays link lists tables hierarchical data structures configured in a memory an extensible markup language XML file any other suitable medium for storing data or any suitable combination thereof. The storage repository may be a device internal to the production computer system . The storage repository may also be an external storage device operatively connected to the production computer system .

The storage repository may be operatively connected to the production optimization application . Specifically the optimization engine of the production optimization application may be configured to retrieve data from and send data to the storage repository . Further in one or more embodiments the optimization engine of the production optimization application is configured to coordinate the operation of and the transfer of data with the network model and the offline model . The optimization engine may further be configured to test for convergence between the offline wellhead pressure and the online wellhead pressure arrays and communicate parameters to the surface unit for changing the state of one or more components of production equipment.

In one or more embodiments the network model executes a set of instructions using software and hardware to deliver a result. Specifically the network model performs one or more simulations while considering all wells in an integrated network. The network model may be referred to as an online model. The network model is a representation of the actual gathering system at prevailing time.

In general the simulation run by the network mode can be summarized as max where 0 1 . . . 0 1 . . . where X is the vector of continuous decision variables e.g. gas lift rates Y is the vector of discrete decision variables e.g. choke states nw stands for network describes the set of fixed model parameters e.g. network topology boundary conditions flow correlations fluid compositions etc. g X Y represents the j th inequality constraint and h X Y the k th equality constraint.

In one or more embodiments the network model receives a solution described below for each well from the offline model through the optimization engine . The network model uses the solutions to perform the calculations of the network model . The output or result of the network model may vary depending on the objective function. In one or more embodiments the network model calculates an online wellhead pressure for each well in the network given the lift gas allocation rates provided from the offline model .

In one or more embodiments the offline model executes a set of instructions using software and hardware to deliver a result. Specifically the offline model performs calculations for each well with wellhead pressure provided from the network model .

In general the calculations performed by the offline model can be summarized as max where 0 1 . . . 0 1 . . . where similarly X and Y are the vectors of continuous and discrete decision variables respectively as described above. However the number of variables and constraints N M J K defined in the offline model are not the same as the variables and constraints N M J K defined in the network model due to the difference in model definition.

In one or more embodiments the offline model generates production profiles for each well in a network. The production profiles may also be generated by the network model provided by the repository and or some other source e.g. the user a separate application . The production profiles may be one or more production curves for one or more of the wells in a network for a given sensitivity parameter e.g. gas lift rate ESP power etc. .

In one or more embodiments the offline model uses the online wellhead pressure solution for each well in a network. The offline wellhead pressure of a well represents the pressure at the wellhead for the well for the current iteration of the online offline procedure. The offline model may generate the offline gas lift allocation rates to each well given the wellhead pressure to set production profiles each well. The offline model may also generate the choke state of each well.

In one or more embodiments the offline model determines the production curve for each well in a network. The production curve may be one of the production curves among the production profiles described above. The production curve represents the operating conditions of the well in the current iteration of the online offline process. The offline model may select the appropriate production curve from the production curves in the production profile for the well. The offline model may determine the appropriate production curve for a well in part using the offline wellhead pressure of the well. If the appropriate production curve is not among the production profile then the offline model may generate the production curve by interpolation in embodiments of the invention.

A production curve may be described as smooth and instantaneous SI smooth and non instantaneous SNI non smooth and instantaneous NSI or non smooth and non instantaneous NSNI . The smooth and instantaneous production curve indicates when a well produces with no lift gas delivered to the well. The smooth and non instantaneous production curve indicates when some minimum level of lift gas injection is used before the flow of produced hydrocarbons commences in the well. The non smooth and instantaneous production curve indicates when the well produces with no lift gas delivered to the well but the production curve is non smooth. The non smooth and non instantaneous production curve indicates when some minimum level of lift gas injection is used before the flow of produced hydrocarbons commences in the well but when the production curve is non smooth.

In one or more embodiments the offline model generates an intermediate solution that optimizes the production over all wells. The offline model generates the intermediate solution for each well while taking the conditions of the network into account e.g. the wellhead pressures from the network model . The intermediate solution indicates the optimal decision variable values for both the gas lift rate and the choke state for each well for the current iteration of the online offline process. The offline model will use the production curve for the given wellhead pressure and choke state for each well in order to generate the prevailing solution in one or more embodiments.

The offline model may set a choke state for a well to fully closed in order to meet operating constraints. For example if the well is viewed to inhibit convergence or is deemed inefficient for operation based on a ranking procedure the well may be deactivated by setting the choke state to fully closed. The offline model may also set a choke state for a well to fully closed if the well ranks the lowest in the network after convergence of the online offline procedure. In such cases deactivating the lowest ranking well in the network increases stability in the online offline iteration process. In other words if a well is deemed to inhibit convergence between the online wellhead pressure and the offline wellhead pressure or is inefficient in practical operation then it will be deactivated by setting the choke state for that well to fully closed.

In one or more embodiments the offline model uses a mixed integer nonlinear program MINLP solver to generate the solution. The mixed integer nonlinear program solver may also solve a nonlinear program if no integer variables are assigned. The mixed integer nonlinear program solver may also solve a mixed integer linear program if the offline model is posed as linear problem with integer variables and as linear program solver if no integer variables are defined. In the linear case the nonlinear production profiles may be represented using piece wise linear segments. Thus the mixed integer nonlinear program solver can perform calculations using both binary and continuous variables depending on the definition of the offline model . In one or more embodiments the offline formulation of the offline model is convex. In other words the solution identified by the offline model is the best possible solution in one or more embodiments. Further in one or more embodiments the mixed integer nonlinear program solver may solve nonlinear and linear problems.

The following discussion provides an explanation of a mixed integer solver in accordance with one or more embodiments. The following table provides a definition of each symbol used in the discussion below.

Define a binary variable y admitting a value of 1 if i is set to choke position cp and the production is given by the smooth curve g x where t 1 2. The continuous variable x is similarly defined. Specifically the aforementioned binary variable and continuous variable are related to the original offline model variables by the following conditions 

The introduction of the auxiliary variables can alternatively be interpreted as follows. Well i is defined as being composed of 2k sub wells indexed as i cp t in which each has a smooth production curve defined by g x . Moreover only a given sub well is allowed to produce with the following bounds l x u. Therefore with n wells with k valid choke positions the offline model has 2nk continuous variables and 2nk binary variables at most in accordance with one or more embodiments. For example with smooth instantaneous SI wells only the offline model will have nk continuous variables and nk binary variables. More than 2 curve regions maybe defined per production well with t 1 2 . . . T in general case. For example more than two production curve regions may be defined if the production curve is modeled using piece wise linear segments.

With the foregoing definitions the relationship between the production function q and the decision variables may be stated as follows 

In the above formulation equation 1 relates the auxiliary variables to the original variable for lift gas injection. Equation 4 implies that the choke can be set to at most one non zero position and only one curve region can be used to evaluate production. Whenever y 0 for some cp and t then equation 3 implies that x 0. If y 0 for all i then x 0 for all cp and t and consequently x 0. If y 1 for some cp and t then x xin equation 1 . Also equation 2 and equation 4 imply that q q x . In addition equation 3 implies l x u whenever y 1 as desired.

Although qprovides a measure of the total oil production possible from a particular well qmay not account for the other components produced namely gas and water. If the provision is available the produced gas is a saleable quantity that can be appropriately processed and sold. Alternately produced gas may be treated as a by product that may be used for gas lift injection reservoir pressure support through injector wells or simply disposed of by flaring. Thus the gas has a process cost and a possible sale value. The produced water may be treated as an undesirable waste product that has a processing and disposal cost. A monetary value can therefore be assigned to each barrel of produced fluid using the following equation 1 1 5 where pis the profit per unit barrel of oil produced pis the profit per unit gas produced MM scfd cis the water processing cost per unit barrel is the Gas to Oil ratio GOR and is the water cut indicating the fraction of water present in the produced fluids. In addition if cis the cost per unit gas injection the composite objective function may be formulated using the following 

In addition operating constraints may exist. Specifically the operating constraints may include limits imposed at well manifold an internal node connecting a number of wells or at sink the terminating node comprising production from all wells level for capacity and storage limitations on the produced hydrocarbons. For example maximum liquid oil water and gas production constraints may be defined by the following 

In one or more embodiments the offline mixed integer nonlinear formulation is solved using the open source Bomnin Basic Open source Nonlinear Mixed INteger programming solver. In some cases the offline solution may differ slightly from the online solution at convergence due to the offline curve modeling process. This slight difference may be due to the quality of the performance curves established i.e. the number of samples and the quantity of curves with varying wellhead pressure and to a lesser extent the quality of the production curves modeled. In addition network effects imposed by interconnected wells may not be readily captured by the single well analysis used to elicit the performance curves during pre processing in .

As a consequence of the aforementioned issues especially when operating constraints are present a solution that may be feasible in the offline model may actually be infeasible in the online model. In such a case a bootstrapping procedure may be included that updates the properties of the constraints for example in the constraint matrix U by a ratio of mismatches observed between the offline and online constrained solution from the most recent iteration for each well. By updating the properties of the constraints in this way the online solution may match the offline solution more closely and helps ensure that the solution obtained is feasible.

Wells connected to the same manifold may actually have slightly different well head pressures. The network simulator i.e. online model may be configured to tolerate small differences due to the convergence conditions imposed leading to slightly different values. As this variability may cause the offline online procedure to take longer to converge the wellhead pressures of wells connected to common manifolds may be averaged so that for modeling purposes all wells have the same wellhead pressure across a given manifold. Further the modified pressure profile may be denoted by Ptilde over of length n which may be obtained by averaging wellhead pressures over common manifolds. The use of Ptilde over in the offline model may enhance the stability and convergence rate of the online offline procedure.

Continuing with the processor within the production computer system is configured to execute software in accordance with one or more embodiments. Specifically the processor may be configured to execute the production computer system or any of the engines models and repositories described above and shown in as well as software used by the user . The processor may be an integrated circuit a central processing unit a multi core processing chip a multi chip module including multiple multi core processing chips or other hardware processor. The processor may be known by other names including but not limited to a computer processor a microprocessor a hardware processor and a multi core processor.

In one or more embodiments the processor is configured to execute software instructions stored in memory . The memory may include one or more cache memories main memory and or any other suitable type of memory. The memory may be discretely located on the production computer system relative to the processor . In certain configurations the memory may also be integrated with the processor .

Optionally in one or more embodiments the security module is configured to secure interactions between the production computer system and the user . More specifically the security module may be configured to authenticate communication from software based on security keys verifying the identity of the source of the communication. For example user software may be associated with a security key enabling the user software to interact with the production computer system . Further the security module may be configured to restrict requests for information e.g. a solution as well as access to information.

In the iterative online offline process described in this an element e.g. an intermediate solution online wellhead pressure array that is determined and or calculated may be an initial element for the first iteration a final element for the final iteration and a previous element for each other iteration between the first iteration and the final iteration. In one or more embodiments a particular computing device as described for example in below is used to perform one or more of the elements described below with respect to .

Initially in of production profiles are generated for each well in a network of wells. The network of wells may be production wells. The production profiles may be generated in terms of flow rate an amount of lift gas some other suitable operating parameter or any combination thereof. The production profiles may be calculated using the network model and data collected from a number of sensors collecting various data from the oilfield and each wellbore. Examples of data collected by the sensors include but are not limited to pressure data conductivity data seismic data log data and formation characteristic data. In one or more embodiments once production profiles for is well are generated the production profiles may be used without modification for each iteration of the method described herein.

In of an offline wellhead pressure of each well in the network is defined. The offline wellhead pressure may be defined using an initial wellhead pressure array or the wellhead pressure solution from a previous modeling of the network.

In of a production curve is determined for each well in the network. In one or more embodiments a production curve for a well is determined using wellhead pressure stipulated in above for an initial iteration of the online offline process. The production curve for a well may also be determined using the wellhead pressure indicated by below from the previous iteration of the online offline process. The production curve represents the current operating conditions of the well in the current iteration of the method described herein. The production curve may be selected from among the production profiles for a well in the network generated in a pre processing step in . The production curve may also be generated by interpolation using data from for example one or more production curves in the production profile for the well. An example of a production curve in terms of flow rate and an amount of lift gas for a well is shown in .

In of an intermediate solution to optimize production of each well is generated. In one or more embodiments the intermediate solution for a well is generated for each well in the network. The intermediate solution for each well may be generated using the offline model with a mixed integer nonlinear program solver. The intermediate solution for a well may also be generated using the production curve for the well as calculated in above based on the offline wellhead pressure and the choke state for the well. The intermediate solution for each well may be expressed in terms of gas lift rates as a continuous decision variable and or choke settings as a discrete decision variable . In the iterative online offline process the intermediate solution may be an initial solution for the first iteration a final solution for the final iteration and a previous solution for each other iteration between the first and last iterations.

In of an online wellhead pressure for each well is established. In one or more embodiments the online wellhead pressure for each well is calculated using a multiphase network simulator using the last intermediate solution given for each well. By using the network model the online wellhead pressure that is calculated for a well in the network may be dependent upon one or more other wells in the network. The online wellhead pressure for each well may depend on one or more fixed model parameters including but not limited to network topology boundary conditions flow correlations and fluid compositions.

In of a determination is made as to whether the difference between a prior online wellhead pressure and a current online wellhead pressure for each well is less than a tolerance amount. In other words a determination is made as to whether there is convergence of online wellhead pressures for each well. A convergence may be found for example if the difference between the online wellhead pressure generate in an immediate prior iteration of and the online wellhead pressure generate in the current iteration is less than a tolerance amount. The tolerance amount may vary depending on one or more of a number of factors including but not limited to network characteristics production goal production limitations cost goal and cost limitations. If the difference between a prior online wellhead pressure and a current online wellhead pressure is greater than the tolerance amount then the method proceeds to . If the difference between the a prior online wellhead pressure and a current online wellhead pressure is less than the tolerance amount then the method proceeds to .

In of the offline wellhead pressure of each well is equated to the online wellhead pressure as calculated in above of the respective well. When is complete the method reverts to where another iteration of the method is performed to achieve convergence.

In of the intermediate solution generated in in the current iteration is set as the final solution. In at least one operating parameter of the network of wells is adjusted using the final solution of each well to generate an actual wellhead pressure of each well. Specifically in one or more embodiments the final solution of each well identifies a value for each operating parameter that is adjusted. Adjusting a parameter may include changing a state of at least one piece of production equipment at a well to match the value of the operating parameter. The result of the state change may be to change the amount of production of hydrocarbons at the well. Adjusting one or more operating parameters of the network of wells may be based on one or more constraints including but not limited to a financial value of the network and a financial cost of the network. When is completed the method ends.

In algorithmic form the above described process may be summarized as 1 1 2 3 4 5 6 If 1 Goto step 3. Else return Stop where is the error norm on the wellhead pressure vectors and P is a vector of wellhead pressures and k is the iteration number.

Initially in every well w1 through w26 is set to a gas injection rate of 1 million standard cubic feet per day. All choke states are initially open because none of the wells have an initial gas lift injection rate of zero. After the first iteration the flow rates of all wells w1 through w26 are changed. Notably the flow rate for w3 is reduced to a fraction above zero. At iteration 3 the choke state for w3 changes from open to closed as the gas lift injection rate for w3 becomes zero.

The initial gas lift injection rate from iteration 1 and the final gas lift from iteration 6 are shown on a line graph for each well in . The graph in confirms by virtue of zero gas lift injection rate that the choke state for wells 3 and 22 are fully closed when convergence is reached between the online and offline models.

Computing device includes one or more processors or processing units one or more memory and or storage components one or more input output I O devices and a bus that allows the various components and devices to communicate with one another. Bus represents one or more of any of several types of bus structures including a memory bus or memos controller a peripheral bus an accelerated graphics port and a processor or local bus using any of a variety of bus architectures. Bus can include wired and or wireless buses.

Memory storage component represents one or more computer storage media. Component can include volatile media such as random access merrier RAM and or nonvolatile media such as read only memory ROM flash memory optical disks magnetic disks and so forth . Component can include fixed media e.g. RAM ROM a fixed hard drive etc. as well as removable media e.g. a Flash memory drive a removable hard drive an optical disk and so forth .

One or more input output devices allow a user to enter commands and information to computing device and also allow information to be presented to the user and or other components or devices. Examples of input devices include a keyboard a cursor control device e.g. a mouse a microphone a scanner and so forth. Examples of output devices include a display device e.g. a monitor or projector speakers a printer a network card and so forth.

Various techniques may be described herein in the general context of software or program modules. Generally software includes routines programs objects components data structures and so forth that perform particular tasks or implement particular abstract data types. An implementation of these modules and techniques may be stored on or transmitted across some form of computer readable media. Computer readable media can be any available non transitory medium or non transitory media that can be accessed by a computing device. By way of example and not limitation computer readable media may comprise computer storage media. 

 Computer storage media and computer readable medium include volatile and non volatile removable and non removable media implemented in any method or technology for storage of information such as computer readable instructions data structures program modules or other data. Computer storage media include but are not limited to computer recordable media such as RAM ROM EEPROM flash memory or other memory technology CD ROM digital versatile disks DVD or other optical storage magnetic cassettes magnetic tape magnetic disk storage or other magnetic storage devices or any other medium which can be used to store the desired information and which can be accessed by a computer.

The computer device may be connected to a network not shown e.g. a local area network LAN a wide area network WAN such as the Internet or any other similar type of network via a network interface connection not shown . Those skilled in the art will appreciate that many different types of computer systems exist e.g. desktop computer a laptop computer a personal media device a mobile device such as a cell phone or personal digital assistant or any other computing system capable of executing computer readable instructions and the aforementioned input and output means may take other forms now known or later developed. Generally speaking the computer system includes at least the minimal processing input and or output means necessary to practice one or more embodiments.

Further those skilled in the art will appreciate that one or more elements of the aforementioned computer device may be located at a remote location and connected to the other elements over a network. Further embodiments may be implemented on a distributed system having a plurality of nodes where each portion of the implementation e.g. optimization engine network model offline model may be located on a different node within the distributed system. In one or more embodiments the node corresponds to a computer system. Alternatively the node may correspond to a processor with associated physical memory. The node may alternatively correspond to a processor with shared memory and or resources.

The systems and methods provided relate to the acquisition of hydrocarbons from an oilfield. It will be appreciated that the same systems and methods may be used for performing subsurface operations such as mining water retrieval and acquisition of other underground fluids or other geomaterials from other fields. Further portions of the systems and methods may be implemented as software hardware firmware or combinations thereof.

While lift gas optimization with choke control has been described with respect to a limited number of embodiments those skilled in the art having benefit of this disclosure will appreciate that other embodiments may be devised which do not depart from the scope of lift gas optimization with choke control as disclosed herein. Accordingly the scope of lift gas optimization with choke control should be limited only by the attached claims.

