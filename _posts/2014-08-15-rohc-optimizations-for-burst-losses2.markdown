---

title: RoHC optimizations for burst losses
abstract: Systems and methods are disclosed for optimizing Robust Header Compression (RoHC) to protect against context desynchronization resulting from a burst of lost packets. In one embodiment, a method of operation of a radio node to adapt a RoHC compressor of a radio node based on a transmit channel quality metric is provided. In another embodiment, systems and methods relating to improved RoHC SN decoding are disclosed. In one embodiment, a method of operation of a radio node includes determining a size of a Packet Data Convergence Protocol (PDCP) Sequence Number (SN) gap for a radio link between the radio node and a second radio node, and performing RoHC SN decoding based on the size of the PDCP SN gap.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09544404&OS=09544404&RS=09544404
owner: Telefonaktiebolaget L M Ericsson (publ)
number: 09544404
owner_city: Stockholm
owner_country: SE
publication_date: 20140815
---
This application is a 35 U.S.C. 371 national phase filing of International Application No. PCT IB2014 063941 filed Aug. 15 2014 the disclosure of which is incorporated herein by reference in its entirety.

The present disclosure relates to Robust Header Compression RoHC and in particular RoHC optimizations to protect against context desynchronization resulting from a burst of lost packets.

Robust Header Compression RoHC is used in 3Generation Partnership Project 3GPP Long Term Evolution LTE networks to minimize the amount of information transmitted over the air. RoHC is defined in Internet Engineering Task Force IETF Request for Comments RFC 3095 RObust Header Compression ROHC Framework and four profiles RTP UDP ESP and uncompressed. In particular in 3GPP LTE RoHC is utilized in the Packet Data Convergence Protocol PDCP layer to minimize the amount of information in Internet Protocol IP User Datagram Protocol UDP Real Time Protocol RTP headers by taking advantage of the repetitive correlated nature of some of the fields in the IP UDP RTP headers. This is particularly beneficial for Voice over IP VoIP traffic where the amount of data being transmitted is typically much smaller than the size of the uncompressed IP UDP RTP headers. RoHC defines a compressor which is the sender of RoHC compressed packets and a decompressor which is the receiver of the RoHC compressed packets.

RoHC uses a compression technique that eliminates or minimizes fields that have to be sent to the decompressor. In particular RoHC uses a compression technique that eliminates or minimizes fields that are static do not change or that are correlated to a field called Sequence Number SN which is more specifically referred to herein as a RoHC SN. Uncorrelated fields are sent as is or uncompressed . At all times the compressor and decompressor maintain state information that describes what fields are inferred and how those fields are correlated to the SN. This state information is also referred to as context information or as a context of the compressor decompressor. In consequence in the highest state of compression it is enough for the compressor to only send the SN and the uncorrelated fields to allow the decompressor to correctly reconstruct the original packet.

In RoHC the SN is also usually compressed in that the SN is not sent in its entirety. In particular for the SN field RoHC uses Window based Least Significant Bits W LSB encoding. In essence W LSB encoding sends only the last k c least significant bits of the SN field where k c is a computed value. The smaller the size of k c the more efficient the compression.

When the compressor and the decompressor operate at a compression level of k c least significant bits for the SN field a loss of a burst of 2packets will result in an incorrect inference of the value of bit k c 1 of the SN field at the decompressor and therefore an error in decompression or decoding of the true SN value. RFC 3095 Section 5.3.2.2.4 entitled Correction of SN LSB wraparound describes a repairing mechanism for the SN after a decompression failure. In particular after a decompression failure an attempt is made to add a value of 2to the last good reference SN at the decompressor i.e. the full SN value for the last successfully decompressed packet at the decompressor . The decompressor then retries decompression or decoding of the W LSB encoded SN using the new reference SN. As a consequence this standard repair mechanism protects against loss of a burst of 2packets. For the most efficient compression case where RoHC Packet Type UO 0 packets are sent the k c value is 4. Thus in this case the standard repair mechanism can protect against loss of a burst of at most 2 32 packets. Furthermore changes in the pattern of correlated fields may occur during the burst of lost packets. While the compressor will flag those changes to the decompressor the packets that are flagging the changes are lost. As a result the decompressor will not receive the changes in the correlation patterns which leads to some fields being incorrectly reconstructed during decompression while other fields may be correctly reconstructed during decompression.

For radio links in general and radio links in a cellular communications network in particular the communication channel is subject to temporary fading as well as interference from neighbor cells. As a result bursts of lost packets are a real possibility. In particular in a cellular communications network the possibility of bursts of lost packets increases as the user device or mobile terminal approaches the edge of a cell. Further in some cases the size of a burst of lost packets may exceed 2packets which leads to loss of synchronicity between the decompressor and the compressor i.e. the decompressor is no longer able to successfully decompress packets from the compressor . This is referred to as context desynchronization.

When the decompressor loses synchronicity with the compressor the RoHC standard defines a mechanism for recovery. The recovery mechanism entails an exchange of signals between the compressor and the decompressor followed by reverting to a state where packets are sent with little or no compression. This recovery mechanism is costly. In particular the recovery mechanism requires extra signaling between the decompressor and the compressor e.g. transmitting feedback negative acknowledgements to inform the compressor of the loss of synchronization. The compressor must then react by generating and transmitting less compressed RoHC packet types. In addition the recovery mechanism results in a delay before the compressor and the decompressor are able to return back to the RoHC peer to peer highest possible compression state due to round trip delays associated with signaling reaction to the received signals at the compressor and possibly acknowledgements sent to the new RoHC packet types generated by the compressor. The recovery mechanism also results in wasted radio link or air link bandwidth because end user packets are discarded while the compressor and the decompressor attempt to regain synchronicity and reach the highest compression state. Further the first few user packets sent by the compressor when attempting to regain synchronicity are sent in a less compressed form. In the worst case the first few user packets when attempting to regain synchronicity are sent as uncompressed Initialization and Refresh IR packets. The less compressed or uncompressed packets translate to wasted air link bandwidth. The recovery mechanism also requires a substantial amount of time to regain synchronicity between the compressor and the decompressor. Lastly the recovery mechanism results in a poor end user experience in terms of the percentage of correctly decompressed packets being received and the time taken to recover from a burst of lost packets.

In light of the discussion above there is a need for systems and methods for RoHC optimization to more efficiently and proactively protect against context desynchronization resulting from a burst of lost packets.

Systems and methods are disclosed for optimizing Robust Header Compression RoHC to protect against context desynchronization resulting from a burst of lost packets. In one embodiment a method of operation of a radio node to adapt a RoHC compressor of a radio node based on a transmit channel quality metric is provided. In one embodiment the method of operation of the radio node includes computing a value for a transmit channel quality metric based on channel quality information for a transmit channel between the radio node and a second radio node and adapting a RoHC compressor for a link between the radio node and the second radio node based on the value for the transmit channel quality metric. In this manner the RoHC compressor can be adapted based on the transmit channel quality metric to in some embodiments reduce the likelihood of context desynchronization between the RoHC compressor of the radio node and a RoHC decompressor of the second radio node when operating under poor or less than ideal transmit channel quality conditions.

In one embodiment adapting the RoHC compressor includes computing a number of least significant bits of a RoHC Sequence Number SN to be included in compressed RoHC packets generated by the RoHC compressor based on the value for the transmit channel quality metric. Further in one embodiment adapting the RoHC compressor further includes selecting a RoHC packet type for compressed RoHC packets generated by the RoHC compressor based on the number of least significant bits of the RoHC SN to be included in the compressed RoHC packets computed based on the value for the transmit channel quality metric.

In one embodiment adapting the RoHC compressor includes selecting a RoHC packet type for compressed RoHC packets generated by the RoHC compressor based on the value for the transmit channel quality metric.

In one embodiment the channel quality metric is indicative of a likelihood that a next transmitted compressed RoHC packet will not be received successfully by a RoHC decompressor of the second radio node. Further in one embodiment adapting the RoHC compressor includes receiving a new packet for RoHC compression with a value v for a RoHC SN used by the RoHC compressor and determining whether the likelihood that the next transmitted compressed RoHC packet will not be received successfully by the RoHC decompressor of the second radio node is greater than a threshold. Adapting the RoHC compressor further includes incrementing a counter of a number of compressed RoHC packets transmitted consecutively that have been determined to have likely been lost if the likelihood that the next transmitted compressed RoHC packet will not be received successfully by the RoHC decompressor of the second radio node is greater than the threshold and determining whether the counter of the number of compressed RoHC packets transmitted consecutively that have been determined to have likely been lost is greater than or equal to a lost packet threshold. Adapting the RoHC compressor further includes if the counter of the number of compressed RoHC packets transmitted consecutively that have been determined to have likely been lost is determined to be greater than or equal to the lost packet threshold determining a new value for k c based on a value v ref g of the RoHC SN for a last compressed RoHC packet determined to have likely been successfully decoded by the RoHC decompressor of the second radio node and the value v for the RoHC SN for the new packet for RoHC compression where k c is a number of least significant bits of the RoHC SN to be included in compressed RoHC packets. Adapting the RoHC compressor further includes selecting a RoHC packet type for compressed RoHC packets generated by the RoHC compressor of the radio node based on the new value for k c and processing the new packet to generate a new compressed RoHC packet of the selected RoHC packet type for transmission to the second radio node.

In one embodiment adapting the RoHC compressor further includes if the counter of the number of compressed RoHC packets transmitted consecutively that have been determined to have likely been lost is determined to not be greater than or equal to 2for the current value of k c determining the new value for k c based on a value v ref c of the RoHC SN for a last compressed RoHC packet and the value v for the RoHC SN for the new packet for RoHC compression. In one embodiment the threshold is 2for the current value of k c used by the RoHC compressor.

In one embodiment computing the value for the transmit channel quality metric includes computing the value for the transmit channel quality metric based on a current value of the channel quality information for the transmit channel and one or more previous values of the channel quality information for the transmit channel. Further in one embodiment the transmit channel quality metric is a number of complete Hybrid Automatic Repeat Request HARQ failures compared to HARQ successes or complete HARQ attempts and computing the value for the transmit channel quality metric based on the current value of the channel quality information for the transmit channel and the one or more previous values of the channel quality information for the transmit channel includes computing the value for the transmit channel quality metric as an exponentially weighted moving average of the number of complete HARQ failures compared to HARQ successes or complete HARQ attempts.

In one embodiment computing the value for the transmit channel quality metric includes obtaining a new value for the channel quality information for the transmit channel computing the value for the transmit channel quality metric based on the new value for the channel quality information and the one or more previous values for the channel quality information making the value for the transmit channel quality metric available to the RoHC compressor and repeating the steps of obtaining a new value for the channel quality information for the transmit channel computing the value for the transmit channel quality metric and making the value for the transmit channel quality metric available to the RoHC compressor.

In another embodiment a radio node is provided that operates according to any of the methods described above.

In another embodiment systems and methods relating to improved RoHC SN decoding are disclosed. In one embodiment a method of operation of a radio node includes determining the size of a receiving Packet Data Convergence Protocol PDCP SN gap for a radio link between the radio node and a second radio node and performing RoHC SN decoding based on the size of the PDCP SN gap. In one embodiment decoding the RoHC SN based on the size of the PDCP SN gap enables successful decoding of the RoHC SN even after a burst of more than 2lost packets.

In one embodiment performing RoHC SN decoding based on the size of the PDCP SN gap includes determining whether the size of the PDCP SN gap is greater than a threshold gap size and performing RoHC SN decoding for a received PDCP Protocol Data Unit PDU using the size of the PDCP SN gap if the size of the PDCP SN gap is greater than the threshold gap size. Further in one embodiment performing RoHC SN decoding based on the size of the PDCP SN gap further includes determining the RoHC SN for the received RoHC compressed PDCP PDU without using the size of the PDCP SN gap if the size of the PDCP SN gap is greater than the threshold.

In one embodiment the threshold gap size is 2for the current value of k d used by a RoHC decompressor of the radio node where k d is a number of least significant bits of the RoHC SN included in RoHC compressed PDCP PDUs processed by the RoHC decompressor.

In one embodiment performing RoHC SN decoding based on the size of the PDCP SN gap includes receiving a new RoHC compressed PDCP PDU for RoHC decompression determining whether the size of the PDCP SN gap is greater than a threshold gap size computing a value for a RoHC SN for the new RoHC compressed PDCP PDU based on the size of the PDCP SN gap if the size of the PDCP SN gap is greater than or equal to the threshold gap size and performing RoHC decompression based on the value computed for the RoHC SN for the new RoHC compressed PDCP PDU. Further in one embodiment computing the value for the RoHC SN for the new RoHC compressed PDCP PDU based on the size of the PDCP SN gap includes computing a predicted reference value as the sum of a value of the RoHC SN for a last successfully decoded RoHC compressed PDCP PDU the size of the PDCP SN gap and a value for a decompression failure counter the value for the decompression failure counter being a number of RoHC compressed PDCP PDUs that failed decompression since the last successfully decoded RoHC compressed PDCP PDU was received. Computing the value for the RoHC SN for the new RoHC compressed PDCP PDU further includes computing the value for the RoHC SN for the new RoHC compressed PDCP PDU based on the predicted reference value and Window based Least Significant Bit W LSB encoded RoHC SN value contained in the new RoHC compressed PDCP PDU.

In one embodiment the method of operation of the radio node further includes determining whether RoHC decompression failed for the new RoHC compressed PDCP PDU incrementing the value for the decompression failure counter if RoHC decompression failed and resetting the decompression failure counter if RoHC decompression succeeded.

In one embodiment performing RoHC decoding based on the size of the PDCP SN gap further includes computing the value of the RoHC SN for the new RoHC compressed PDCP PDU without using the size of the PDCP SN gap if the size of the PDCP SN gap is less than the threshold gap size.

In one embodiment performing RoHC SN decoding based on the size of the PDCP SN gap further includes prior to computing the value of the RoHC SN for the new RoHC compressed PDCP PDU determining whether k d is greater than or equal to a size of the PDCP SN where k d is a number of least significant bits of the RoHC SN included in RoHC compressed PDCP PDUs processed by the RoHC decompressor of the radio node. If k d is not greater than or equal to the size of the PDCP SN the method proceeds to perform the step of computing the value for the RoHC SN for the new RoHC compressed PDCP PDU based on the size of the PDCP SN gap if the size of the PDCP SN gap is greater than or equal to the threshold gap size. If k d is greater than or equal to the size of the PDCP SN the value of the RoHC SN for the new RoHC compressed PDCP PDU is computed without using the size of the PDCP SN gap if the size of the PDCP SN gap is less than the threshold gap size.

In one embodiment determining the size of the PDCP SN gap for the radio link between the radio node and the second radio node includes computing a count value for a received new PDCP PDU the count value being composed of a Hyper Frame Number HFN maintained by a PDCP entity of the radio node for the radio link between the radio node and the second radio node and a PDCP SN contained in the new PDCP PDU. The size of the PDCP SN gap is then computed as COUNT COUNT prev 1 where COUNT is the count value computed for the new PDCP PDU and COUNT prev is a count value computed for a previously received PDCP PDU.

In one embodiment performing RoHC SN decoding based on the size of the PDCP SN gap is performed by the RoHC decompressor of the radio node for the radio link between the radio node and the second radio node determining the size of the PDCP SN gap is performed by a PDCP entity of the radio node and the method further includes making the size of the PDCP SN gap determined by the PDCP entity available to the RoHC decompressor.

In another embodiment a radio node that operates according to any of the methods described above related to RoHC SN decoding is provided.

Those skilled in the art will appreciate the scope of the present disclosure and realize additional aspects thereof after reading the following detailed description of the embodiments in association with the accompanying drawing figures.

The embodiments set forth below represent information to enable those skilled in the art to practice the embodiments and illustrate the best mode of practicing the embodiments. Upon reading the following description in light of the accompanying drawing figures those skilled in the art will understand the concepts of the disclosure and will recognize applications of these concepts not particularly addressed herein. It should be understood that these concepts and applications fall within the scope of the disclosure and the accompanying claims.

Systems and methods are disclosed herein for optimizing Robust Header Compression RoHC to protect against context desynchronization resulting from a burst of lost packets. In this regard illustrates a cellular network that includes a base station and a wireless device that operate to provide RoHC compression and decompression according to some embodiments of the present disclosure. In the embodiments described herein the cellular network is a 3Generation Partnership Projection 3GPP Long Term Evolution LTE network and as such the base station may be referred to as an enhanced Node B eNB and the wireless device may be referred to as a User Equipment UE . Further the embodiments described herein specifically relate to RoHC within the Packet Data Convergence Protocol PDCP layer of the protocol stack of the wireless device and or the base station . Note however that the concepts disclosed herein are not limited to 3GPP LTE or RoHC within the PDCP layer of the LTE protocol stack. Rather the RoHC techniques disclosed herein may be implemented in any suitable type of cellular communications network any suitable wireless system or any other communication system that utilizes RoHC particularly over a lossy link.

The functionality of the PDCP layer for LTE is defined in 3GPP Technical Specification TS 36.323 V11.2.0 which is entitled Technical Specification Group Radio Access Network Evolved Universal Terrestrial Radio Access E UTRA Packet Data Convergence Protocol PDCP specification Release 11 . The PDCP layer supports functions such as for example header compression and decompression of Internet Protocol IP packets using the RoHC protocol transfer of data e.g. user plane data or control plane data maintenance of PDCP Sequence Numbers SNs in sequence delivery of upper layer Protocol Data Units PDUs at re establishment of lower layers ciphering and deciphering of user plane data and control plane data integrity protection and integrity verification of control plane data timer based discard etc. RoHC is defined in Internet Engineering Task Force IETF Request for Comments RFC 3095 RObust Header Compression ROHC Framework and four profiles RTP UDP ESP and uncompressed which while non essential for understanding and describing the systems and methods disclosed herein is hereby incorporated by reference in its entirety.

As illustrated the PDCP layer includes a number of PDCP entities each including at most one RoHC compressor and at most one RoHC decompressor . Thus a particular PDCP entity may include a RoHC compressor a RoHC decompressor or both a RoHC compressor and a RoHC decompressor . As defined in 3GPP TS 36.323 V11.2.0 each radio bearer i.e. Data Radio Bearer DRB and Service Radio Bearer SRB except SRB0 is associated with one PDCP entity . In other words each of the PDCP entities carries data for one radio bearer. Each PDCP entity is associated with either one or two RLC entities depending on the RLC mode and whether the radio bearer is unidirectional or bidirectional. Each PDCP entity is associated with either the control plane or the user plane depending on whether the corresponding radio bearer is carrying data for the control plane or the user plane.

The RoHC standard defines three modes of operation namely a Unidirectional Mode U MODE a bidirectional Optimistic Mode O MODE and a bidirectional Reliable Mode R MODE . Since LTE radio links are bidirectional the U MODE only occurs at initialization. R MODE is intended for lossy links while O MODE is designed for quality links. Transition between modes can be done on the fly following a negotiation between the RoHC compressor of the PDCP entity of the transmitting radio node e.g. the wireless device and the RoHC decompressor of the receiving PDCP entity of the receiving radio node e.g. the base station . R MODE is less efficient than O MODE. In particular R MODE requires more signaling between the RoHC compressor of the PDCP entity of the transmitting radio node and the RoHC decompressor of the receiving PDCP entity of the receiving radio node as well as more overhead associated with each user packet.

While O MODE is supported by the vast majority LTE networks R MODE is not considered an ideal mode because of its more intensive usage of the feedback channel which defeats the intent of using RoHC as a means to reduce bandwidth usage. If both end points of a radio link do not support R MODE then a transition to R MODE is not possible and both the RoHC compressor of the PDCP entity of the transmitting radio node and the RoHC decompressor of the receiving PDCP entity of the receiving radio node must operate in O MODE which provides less protection when operating in less than ideal conditions. The embodiments described herein can be utilized to improve performance when operating in both R MODE and O MODE. However the embodiments are particularly beneficial when operating in O MODE.

If the data to be transmitted is user plane data i.e. if the radio bearer is associated with the user plane and RoHC is configured for the radio bearer the transmitting PDCP entity and in particular the RoHC compressor of the transmitting PDCP entity performs RoHC header compression. In general the RoHC compressor operates to compress the IP UDP RTP headers by eliminating or minimizing fields from the IP UDP RTP headers that are static or correlated to a field referred to as a RoHC SN or Master SN MSN . Uncorrelated fields are sent as is or uncompressed because they cannot be compressed using RoHC. The RoHC compressor of the transmitting PDCP entity and the RoHC decompressor of the receiving PDCP entity maintain state information that describes what fields are eliminated and how those fields are correlated to the RoHC SN. This state information is also referred to as context information or a context of the compressor decompressor. In the highest state of compression rather than sending the full IP UDP RTP headers the RoHC compressor transmits only the RoHC SN in particular a compressed RoHC SN and the uncorrelated fields of the IP UDP RTP headers.

Importantly in RoHC the RoHC SN is also compressed in that the RoHC SN is not sent in its entirety. In particular for the RoHC SN field RoHC uses Window based Least Significant Bits W LSB encoding. In essence W LSB encoding sends only the last k c least significant bits of the RoHC SN field. The smaller the size of k c the more efficient the compression. Currently in LTE the value of k c may be 4 for UO 0 and UO 1 TS 6 UOR 2 7 UO1 ID EXT0 and UO1 ID EXT1 9 UOR 2 EXT0 and UOR 2 EXT1 12 UO1 ID EXT3 14 UOR 2 EXT3 or 16 IR .

Notably as used herein k c is the minimum number of RoHC SN bits to be used for the current RoHC compressed packet. As discussed below the value of k c is a computed value. The actual k number of bits that will actually be used for encoding may be larger than k c depending on the RoHC packet type that is ultimately selected for the RoHC compressed packet. In contrast k d which is discussed below is an actual number of bits in the RoHC SN for a received packet at the RoHC decompressor.

If the IP packet is associated to a PDCP Service Data Unit SDU the transmitting PDCP entity performs integrity protection for c plane data only and ciphering. The parameters that are required by PDCP for ciphering and deciphering are defined in 3GPP TS 33.401 Release 12 Version 12.11.0 which is entitled Technical Specification Group Services and System Aspects 3GPP System Architecture Evolution SAE Security architecture. The parameters required by PDCP for ciphering include 

As indicated above the COUNT parameter is formed by combining the HFN and the PDCP SN. Note that the COUNT parameter is itself a SN used for ciphering deciphering as well as integrity protection in the PDCP layer . A given SN COUNT is only to be used once for a given KEY on the same radio bearer in the same direction. The same SN COUNT can be used for both ciphering deciphering and integrity protection. Again the PDCP SN is a 5 7 or 12 bit value assigned to a PDCP PDU and PDCP PDUs transmitted from the transmitting PDCP entity to the receiving PDCP entity are assigned PDCP SNs in sequential order. The HFN is an overflow counter mechanism used in order to limit the actual number of PDCP SN bits that are needed to be sent over the air interface in the PDCP PDUs. The HFN needs to be synchronized between the transmitting PDCP entity and the receiving PDCP entity . In other words when the PDCP SN has reached its maximum value which in turn depends on the number of bits used for PDCP SN 5 7 or 12 bits the PDCP SN will be restarted from 0 and the HFN will be increased by one.

Ciphering is performed as follows. At the transmitting PDCP entity the input parameters are input to a ciphering algorithm that then outputs a ciphering keystream. The packet to be transmitted by the transmitting PDCP entity is then masked e.g. XOR operation by the ciphering keystream to provide a data part of a PDCP PDU that is transmitted to the receiving PDCP entity after addition of a PDCP header. Importantly the PDCP header includes the PDCP SN but does not include the PDCP HFN.

At the receiving PDCP entity the PDCP SN is extracted from the header of the PDCP PDU and combined with a PDCP HFN maintained locally by the receiving PDCP entity to provide the COUNT parameter for deciphering. The receiving PDCP entity then passes the COUNT parameter along with the other parameters required by PDCP to the ciphering algorithm that then outputs a ciphering keystream. This ciphering keystream should be the same as that used by the transmitting PDCP entity . The receiving PDCP entity then deciphers the PDCP PDU using the ciphering keystream to provide a deciphered PDCP PDU. For user plane data the deciphered PDCP PDU may be an IP packet or a RoHC compressed IP packet.

For a RoHC compressed IP packet the receiving PDCP entity and in particular the RoHC decompressor of the receiving PDCP entity performs header decompression. In particular the RoHC decompressor extracts the W LSB encoded RoHC SN from the RoHC compressed IP packet. The RoHC decompressor decompresses or decodes the W LSB encoded RoHC SN to obtain the full or decompressed RoHC SN. Then using the full i.e. decompressed RoHC SN and the stored context of the RoHC decompressor the RoHC decompressor reconstructs the full IP UDP RTP headers to thereby provide a decompressed IP UDP RTP packet. The receiving PDCP entity also performs delivery and duplicate detection in order for u plane data only .

One issue with current RoHC techniques is that they do not adequately protect against the loss of a large burst of packets. Specifically RFC 3095 Section 5.3.2.2.4 entitled Correction of SN LSB wraparound describes a repairing mechanism for the RoHC SN after a decompression failure due to a burst of lost packets. This repair mechanism protects against loss of a burst of at most 2packets. When using the most common RoHC packet type header type k d is 4 and as such the repair mechanism protects against a loss of a burst of at most 32 packets. However a loss of a burst of more than 32 packets is a very real possibility particularly in the cellular network when the wireless device operates near the edge of the cell served by the base station . When the RoHC SN cannot be repaired the RoHC compressor and the RoHC decompressor must typically perform a recovery procedure that is costly in terms of e.g. extra signaling delay and wasted radio link bandwidth and may result in a poor user experience.

In some embodiments the present disclosure relates to systems and methods for adapting the configuration of the RoHC compressor of the transmitting PDCP entity based on or as a function of a quality of the transmit channel. Specifically as discussed below in some embodiments the value of k c is increased as the quality of the channel decreases. By increasing the value of k c the RoHC decompressor is able to successfully decode the RoHC SN for larger bursts of lost packets. Further increasing the value of k c results in less aggressive RoHC compression which in turn decreases the likelihood of context desynchronization.

In particular RoHC defines various RoHC header types that use k c values of different sizes. Specifically as stated above in the current standard the value of k c may be 4 for UO 0 and UO 1 TS 6 UOR 2 7 UO1 ID EXT0 and UO1 ID EXT1 9 UOR 2 EXT0 and UOR 2 EXT1 12 UO1 ID EXT3 14 UOR 2 EXT3 or 16 IR . However the present disclosure is not limited to these particular values of k c or these particular modes. The size of k c represents a trade off between compression efficiency and protection of bursts of lost packets. Choosing an aggressive or smaller value for k c provides greater compression efficiency but offers less protection against bursts of lost packets. A small value of k c may be desired when the quality of the transmit channel and thus the transmit radio link is good. Conversely choosing a conservative or larger value for k c provides less compression efficiency but offers greater protection against bursts of lost packets. In other words increasing the value of k c increases the maximum number of packets in a burst of lost packets for which the RoHC SN can be repaired using the repair mechanism defined in RFC 3095. In addition as stated above increasing the value of k c also decreases the likelihood of context desynchronization due to pattern changes during a burst of lost packets.

In this regard illustrates a process for adapting the RoHC compressor according to one embodiment of the present disclosure. As illustrated a value for a channel quality metric q for the transmit channel between the transmitting radio node e.g. the wireless device and the receiving radio node e.g. the base station is computed step . In general the channel quality metric q is any metric that is indicative of the quality of the transmit channel. In some embodiments the channel quality metric q is a moving average of channel quality information values for the transmit channel e.g. number of complete Hybrid ARQ HARQ failures versus number of HARQ successes or number of HARQ attempts Signal to Noise Ratio SNR values Reference Signal Received Power RSRP values Reference Signal Received Quality RSRQ values Channel Quality Indictor CQI values Block Error Rate BLER values or the like . Still further in some embodiments the channel quality metric q is a moving weighted average of channel quality information values that gives greater weight to the most recent channel quality information value s . As discussed below the value for the channel quality metric q is in some embodiments computed by a layer in the protocol stack of the radio node below the PDCP layer e.g. the PHY layer the MAC layer or the RLC layer and made available to the PDCP layer and in particular the RoHC compressor via for example an Application Programming Interface API .

The PDCP layer and in particular the RoHC compressor adapts the RoHC compressor based on the value computed for the channel quality metric q step . In one embodiment the RoHC compressor adapts the value of k c i.e. the number of Least Significant Bits LSBs of the RoHC SN included in the compressed RoHC SN based on the value computed for the channel quality metric q such that the value of k c is inversely related to quality of the transmit channel as indicated by the value of the channel quality metric q i.e. the value of k c increases as the transit channel quality decreases as indicated by the value of the channel quality metric q and vice versa . As discussed below the value of k c is then used to select the RoHC header or packet type. In another embodiment the RoHC compressor adapts the RoHC header type and thus the value of k c based on the value of the channel quality metric q . By adapting the RoHC compressor based on the value of the channel quality metric q the value of k c and thus the RoHC header type is intelligently selected to increase the probability of successful decompression by the RoHC decompressor of the receiving PDCP entity . In other words the probability of the loss of a burst of more than 2packets is decreased. The adaptation of the RoHC compressor or more specifically the level of compression of the RoHC compressor is performed independently from the operation of the RoHC decompressor of the receiving PDCP entity and does not require any over the air signaling overhead.

In one embodiment during operation the RoHC compressor of the transmitting PDCP entity and the RoHC decompressor of the receiving PDCP entity operate in O MODE in all radio conditions as per the RoHC standard. If the quality of the transmit channel is good i.e. the value of the channel quality metric q is better than a threshold the highest compression state is reached in steady stand with the RoHC header that is selected as being the smallest possible RoHC header i.e. the mostly highly compressed RoHC header which is usually the UO 0 header type unless a change in pattern needs to be communicated from the RoHC compressor or the RoHC decompressor . When the quality of the transmit channel degrades to the point where a burst of lost packets is deemed to be likely i.e. the value of the channel quality metric q is worse than a threshold then the RoHC compressor is adapted to choose a RoHC packet type that contains a larger value for k c and in some embodiments other fields that may experience a pattern change during a burst of lost packets.

Next a new value for the channel quality metric q is computed based on the new value for the channel quality information c and one or more previous values for the channel quality information c if any step . The channel quality metric q is indicative of an instantaneous channel quality of the transmit channel. In one embodiment the new value for channel quality metric q is a moving weighted average of the new value for the channel quality information c and the one or more previous values for the channel quality information c where the most recent values for the channel quality information c are weighted more heavily than older values for the channel quality information c . In one example embodiment the channel quality metric q is an exponentially weighted moving average i.e. a type of moving average that is similar to a simple moving average except that more weight is given to the latest data of complete HARQ failures i.e. maxHarqTX reached without success . In general the new value for the channel quality metric q represents a probability or likelihood of failure or loss of the next transmitted RoHC compressed packet. Specifically a higher value or better value of the channel quality metric q represents a high channel quality and thus a lower probability or likelihood of loss of the next transmitted RoHC compressed packet and a lower value or worse value of the channel quality metric q represents lower channel quality and thus a higher probability or likelihood of loss of the next transmitted RoHC compressed packet.

Lastly the new value of the channel quality metric q is made available to the RoHC compressor step . In one embodiment the MAC layer computes the new value for the channel quality metric q and makes the new value for the channel quality metric q available to the RoHC compressor via for example an API. However this is just one example. The present disclosure is not limited thereto. The process then returns to step and is repeated. In this manner the value for the channel quality metric q is updated over time to reflect changing channel conditions. Notably if the transmitting PDCP entity is at the base station a separate value for the channel quality metric q for the transmit channel may be maintained for each wireless device for which RoHC is enabled.

Once the new value of the channel quality metric q is made available to the RoHC compressor the RoHC compressor utilizes the new value of the channel quality metric q to adapt the RoHC. In this regard illustrates the operation of the RoHC compressor to adapt RoHC based on the value of the channel quality metric q computed based on the channel quality information c as for example described above with respect to . As illustrated the RoHC compressor receives a new IP packet for RoHC compression step . The RoHC SN for the new IP packet is a value v . If the new IP packet contains a SN that is encoded in RoHC and used as the basis for the RoHC SN then this value is v. Typically for RoHC Profile 1 the RTP SN is used as the basis for the RoHC SN. If the IP packet type is an IP packet type that does not have a well formed SN e.g. Profile 2 UDP packet types then the RoHC compressor generates a 16 bit RoHC SN that increase by 1 for each IP packet received in the stream for RoHC compression.

The RoHC compressor obtains the current value of the channel quality metric q for the transmit channel and determines whether the value of the channel quality metric q is greater than or equal to a quality threshold Q step . Note that in this example a value of q that is greater than or equal to Q is indicative of the channel quality being better than the quality threshold Q . However for some types of channel quality metrics q a value of q that is less than or equal to the quality threshold Q may be indicative of a channel quality that is better than the quality threshold Q . Thus it should be understood that the comparison in step is more generally a comparison of whether the quality of the transmit channel is better than the quality threshold Q . The quality threshold Q may be statically configured e.g. during design or manufacturing. In this embodiment the quality threshold Q is configured such that if the value of the channel quality metric q is greater than or equal to the quality threshold Q then the RoHC compressed packet for the new IP packet is predicted to be successfully received i.e. decompressed by the RoHC decompressor of the receiving PDCP entity . Otherwise if the value of the channel quality metric q is less than the quality threshold Q then the RoHC compressed packet for the new IP packet is predicted to be lost i.e. not successfully received by the RoHC decompressor of the receiving PDCP entity .

If the value of the channel quality metric q is greater than or equal to the quality threshold Q i.e. the channel quality is better than the quality threshold Q then a lost packet counter u is set to 0 step . The lost packet counter u is a counter for the number of RoHC compressed packets transmitted in a row that are predicted to have been lost. The RoHC compressor also sets a reference RoHC SN value v ref g to the RoHC SN v for the new IP packet step . The reference RoHC SN value v ref g is a reference RoHC SN value that is indicative of a start of a burst or gap of lost RoHC compressed packets. The RoHC compressor then operates in the conventional manner by computing a value for k c as g v ref c v step . The function g is defined in RFC 3095 Section 4.5.1 as the function that returns the minimum value of k c such that v falls into the interval f v ref c k where f v ref c k is referred to as an interpretation interval for RoHC compression and is defined as f v ref c k v ref c p v ref c 2 p where p is an integer. Further v ref c is a reference RoHC SN value defined by RFC 3095 Section 4.5.1 as the last RoHC SN that has been compressed by the RoHC compressor . When only a few distinct values of k c are possible the RoHC compressor will instead pick the smallest k c that puts v in the interval f v ref c k c . This may occur for example due to limitations imposed by packet formats as described in RFC 3095 Section 5.7.

Once the value for k c is computed the RoHC compressor proceeds in the conventional manner. Specifically the RoHC compressor selects the RoHC packet type i.e. the RoHC header type based on the value computed for k c step . In one embodiment the algorithm or process for selecting the RoHC packet type based on the value computed for k c is the same as that defined in the RoHC standard. More specifically the RoHC packet type that is selected is the RoHC packet type that has the capability of transmitting at least k c bits of the RoHC SN. However variables other than the value of k c are also considered when selecting the RoHC packet type. For example if other fields in the packet changed from the previous packet those changes should be communicated and therefore this might influence RoHC packet type selection. The RoHC compressor then processes IP packet to generate a RoHC compressed packet of the selected RoHC packet type step .

Returning to step if the value of the channel quality metric q is less than the quality threshold Q i.e. the channel quality is worse than the quality threshold Q the RoHC compressor increments the lost packet counter u because the RoHC compressed packet for the new IP packet is predicted to be lost step . The RoHC compressor determines whether the lost packet counter u is greater than a lost packet threshold which in this example is 2 i.e. the current W LSB encoded RoHC SN window space step . For step the value of k c is the last determined value for k c for transmitting the W LSB encoded RoHC SN. If the lost packet counter u is less than the lost packet threshold the RoHC compressor proceeds to step and continues in the conventional manner.

If the lost packet counter u is greater than or equal to the lost packet threshold then the current value of k c is likely not large enough. Specifically if the lost packet threshold is 2and u 2for the current value of k c then the current value of k c is likely not large enough considering the number of consecutive packets predicted to have been lost. As such the RoHC compressor computes a new value for k c as k c g v ref g v where v ref g is the reference RoHC SN for the last RoHC compressed packet that was transmitted and predicted to be successfully received by the RoHC decompressor of the receiving PDCP entity step . By computing the value of k c based on v ref g rather than v ref c the RoHC compressor increases the value of k c as compared to the value of k c that would have been computed using the conventional technique i.e. k c g v ref c v .

Once k c is computed in step the RoHC compressor proceeds in the conventional manner. Specifically the RoHC compressor selects the RoHC packet type i.e. the RoHC header type based on the value computed for k c step . The RoHC compressor then processes the IP packet to generate a RoHC compressed packet of the selected RoHC packet type step . Importantly by computing k c based on the RoHC SN of the last RoHC compressed packet predicted to have been successfully received by the RoHC decompressor of the receiving PDCP entity the value of k c increases and as a result a less aggressive RoHC packet type is selected in step . This less aggressive packet type provides improved protection against a burst of lost packets due to increased value of k c and may also include fields that may experience pattern changes during the burst of lost packets. As a result when the channel quality improves after a burst of lost packets the next transmitted received RoHC compressed packet will include a W LSB encoded RoHC SN having a sufficient number of bits k c substantially increases the likelihood that the RoHC decompressor will be able to successfully decode the W LSB encoded RoHC SN. In addition by using a less aggressive RoHC packet type fields that may have experienced a pattern change during the burst of lost packets are more likely to be included in the RoHC compressed packet. As a result the RoHC decompressor is substantially more likely to be able to successfully decompress the first received RoHC compressed packet after a burst of lost packets and therefore can avoid the costly recovery mechanism required when context desynchronization occurs between the RoHC compressor of the transmitting PDCP entity and the RoHC decompressor of the receiving PDCP entity .

The RoHC compressor obtains the current value of the channel quality metric q for the transmit channel and determines whether the value of the channel quality metric q is greater than or equal to a quality threshold Q step . Note that in this example a value of q that is greater than or equal to Q is indicative of the channel quality being better than the quality threshold Q . However for some types of channel quality metrics q a value of q that is less than or equal to the quality threshold Q may be indicative of a channel quality that is better than the quality threshold Q . Thus it should be understood that the comparison in step is more generally a comparison of whether the quality of the transmit channel is better than the quality threshold Q . The quality threshold Q may be statically configured e.g. during design or manufacturing. In this embodiment the quality threshold Q is configured such that if the value of the channel quality metric q is greater than or equal to the quality threshold Q then the RoHC compressed packet for the new IP packet is predicted to be successfully received i.e. decompressed by the RoHC decompressor of the receiving PDCP entity . Otherwise if the value of the channel quality metric q is less than the quality threshold Q then the RoHC compressed packet for the new IP packet is predicted to be lost i.e. not successfully received by the RoHC decompressor of the receiving PDCP entity .

If the value of the channel quality metric q is greater than or equal to the quality threshold Q i.e. the channel quality is better than the quality threshold Q then a lost packet counter u is set to 0 step . The lost packet counter u is a counter for the number of RoHC compressed packets transmitted in a row that are predicted to have been lost. The RoHC compressor also saves or stores essential fields of the new IP packets as packet ref g including v ref g being set to the value of the RoHC SN v of the new IP packet step . This effectively saves the last packet before the next gap occurs or at least the values of the essential fields for the last packet before the next gap occurs. The essential fields are fields that are likely to change during a burst or gap of lost packets such as for example RTP timestamp or IP ID field of an IPv4 header. Note however that the essential fields may be configurable by e.g. the operator of the network based on e.g. the particularities of the deployment and empirical observations. The parameter packet ref g is therefore a packet that stores the last successfully compressed sent packet or at least the values of the essential fields from last successfully compressed sent packet before the gap or burst of lost packets is likely to have begun.

The RoHC compressor then operates in the conventional manner by computing a value for k c as g v ref c v step . The function g is defined in RFC 3095 Section 4.5.1 as the function that returns the minimum value of k c such that v falls into the interval f v ref c k c where f v ref c k c is referred to as an interpretation interval for RoHC compression and is defined as f v ref c k c v ref c p v ref c 2 p where p is an integer. Further v ref c is a reference RoHC SN value defined by RFC 3095 Section 4.5.1 as the last RoHC SN that has been compressed by the RoHC compressor . When only a few distinct values of k c are possible the RoHC compressor will instead pick the smallest k c that puts v in the interval f v ref c k c . This may occur for example due to limitations imposed by packet formats as described in RFC 3095 Section 5.7.

Once the value for k c is computed the RoHC compressor proceeds in the conventional manner. Specifically the RoHC compressor performs pattern change detection and RoHC packet type selection based on the value for k c the values of the fields in the header s of the new IP packet and packet ref c step . The parameter packet ref c is the last successfully sent packet or at least values of the essential fields of the last successfully sent packet. In one embodiment the algorithm or process for selecting the RoHC packet type based on the value computed for k c is the same as that defined in the RoHC standard. More specifically the RoHC packet type that is selected is the RoHC packet type that has the capability of transmitting at least k c bits of the RoHC SN. However variables other than the value of k c are also considered when selecting the RoHC packet type. For example if other fields in the packet changed from the previous packet those changes should be communicated and therefore this might influence RoHC packet type selection. The RoHC compressor then processes IP packet to generate a RoHC compressed packet of the selected RoHC packet type step .

Returning to step if the value of the channel quality metric q is less than the quality threshold Q i.e. the channel quality is worse than the quality threshold Q the RoHC compressor increments the lost packet counter u because the RoHC compressed packet for the new IP packet is predicted to be lost step . The RoHC compressor determines whether the lost packet counter u is greater than a lost packet threshold which in this example is 2 i.e. the current W LSB encoded RoHC SN window space step . For step the value of k c is the last determined value for k c for transmitting the W LSB encoded RoHC SN.

If the lost packet counter u is less than the lost packet threshold the RoHC compressor operates in the conventional manner by computing a value for k c as g v ref c v as discussed above with respect to step step . Conversely if the lost packet counter u is greater than or equal to the lost packet threshold then the current value of k c is likely not large enough. Specifically if the lost packet threshold is 2and u 2for the current value of k c then the current value of k c is likely not large enough considering the number of consecutive packets predicted to have been lost. As such the RoHC compressor computes a new value for k c as k c g v ref g v where v ref g is the reference RoHC SN for the last RoHC compressed packet that was transmitted and predicted to be successfully received by the RoHC decompressor of the receiving PDCP entity step . By computing the value of k c based on v ref g rather than v ref c the RoHC compressor increases the value of k c as compared to the value of k c that would have been computed using the conventional technique i.e. k c g v ref c v .

Once k c is computed in step or the RoHC compressor performs pattern change detection and RoHC packet type selection based on the value computed for k c the values of the fields in the header s of the new IP packet and packet ref g rather than packet ref c step . Again the parameter packet ref c stores the last successfully compressed sent packet or at least values for essential fields of a last successfully compressed sent packet. In contrast packet ref g stores value for fields of a last successfully compressed packet before the gap or burst of lost packets started. The standard RoHC packet type selection algorithm analyzes for pattern change differences between the last successfully sent compressed packet and the new packet. Where the standard RoHC packet type selection algorithm analyzes for pattern change differences between the packet ref c and the new packet step uses the same algorithm to analyze for pattern change differences between packet ref g and the new packet. If any pattern changes should be communicated to the RoHC compressor via fields of the RoHC packet the RoHC compressor selects a RoHC packet type that contains those fields. This insures that if the RoHC decompressor does receive the packet it will have the information needed for successful decompression.

By using packet ref g instead of packet ref c any pattern changes from the time that the gap or burst of lost packets likely started until the time of compression and transmission of this new IP packet that need to be communicated to the RoHC decompressor will be handled by using packet ref g for RoHC packet type selection. In particular the RoHC packet type selected is a RoHC packet type that includes all of the fields that need to be explicitly communicated to the RoHC decompressor . Note that for dynamically changing fields the RoHC compressor communicates the pattern of how the fields change relative to the RoHC SN. If for a new IP packet the pattern relative to the RoHC SN changes this change in pattern will be communicated to the RoHC decompressor . In this manner RoHC packet type selection is adapted to keep transmitting pattern changes that occur during the gap or burst of lost packets e.g. while the channel faded . This allows the RoHC decompressor to receive the correct value not only for the RoHC SN but also for other fields e.g. RTP time stamp that are correlated with the RoHC SN most of the time but experience a change in correlation e.g. when transitioning from Silence Insertion Descriptor SID to TALK to SID during a voice call .

The RoHC compressor then processes the IP packet to generate a RoHC compressed packet of the selected RoHC packet type as discussed above step . Processing of the IP packet includes saving the essential values of the fields in the header s of the IP packet as packet ref c.

Embodiments of a proactive adaptation scheme for the RoHC compressor are described above. These proactive adaptation schemes adapt the value of k c and thus the RoHC packet type based on the channel quality of the transmit channel. In doing so the likelihood of context desynchronization between the RoHC compressor of the transmitting PDCP entity and the RoHC decompressor of the receiving PDCP entity is substantially reduced which in turn results in a lower probability of end user traffic interruption. This is especially important for applications such as Voice over LTE VoLTE where fast recovery after fading is critical to the end user quality of experience.

The importance of maintaining context synchronization between the RoHC compressor of the transmitting PDCP entity and the RoHC decompressor of the receiving PDCP entity is augmented by the fact that transmitting the same amount of data requires more physical resource elements when operating at a cell edge due to reduced modulation and encoding efficiency. Falling back to the RoHC Initialization and Refresh IR state because of a loss of context synchronization effectively doubles the amount of VoLTE data thereby reducing the effective capacity of the cell. Thus by reducing the likelihood of context desynchronization the proactive adaptation schemes increase the effective capacity of the cell.

Further when operating near the cell capacity it is possible that some VoLTE UEs transitioning to the IR state may never be able to regain their media channel and the call would be dropped. In consequence the disclosed proactive adaptation schemes will increase retainability as well as the quality of experience of the end users.

The proactive adaptation schemes also dramatically reduce the need for the signaling intensive reactive slow Acknowledgement ACK Negative Acknowledgment NACK recovery mechanism provided by the RoHC standard. In other words the proactive adaptation schemes reducing the need of cooperation between the RoHC compressor of the transmitting PDCP entity and the RoHC decompressor of the receiving PDCP entity to resolve a context desynchronization. There are already mechanisms to measure the channel quality at lower layers that are built into the LTE standard e.g. HARQ CQI reports BLER measurement etc. that can be used to predict the likelihood that a packet loss will occur and focus on prevention rather than recovery.

When adapting and sending a more conservative RoHC header type RoHC packet type an additional benefit is that other fields of the original header are also included e.g. the RTP timestamp . Typically if a pattern change occurs in those fields the pattern change would be communicated from the RoHC compressor of the transmitting PDCP entity and the RoHC decompressor of the receiving PDCP entity very few times or only once after which the RoHC compressor would send a higher compressed packet. If the pattern change information is lost in a burst of lost packets the correct reconstruction of the field will fail even if the RoHC SN is correctly reconstructed. In contrast with the adaptive schemes described herein since the fields most likely to experience a pattern change are included in the more conservative RoHC header types RoHC packet types selected under poor channel quality conditions when using one of the adaptive schemes the RoHC decompressor will with much greater likelihood be able to correctly reconstruct both RoHC SN and the fields that experienced a pattern change during the burst of lost packets. When the conditions change such that the adaptive implementation is no longer necessary the standard RoHC algorithm may be used.

Another benefit of adapting the RoHC compressor is that by selecting a RoHC header type that contains a Cyclic Redundancy Check CRC encoded with a higher number of bits the probability of CRC collision is much lower leading to more protection against incorrectly updating the RoHC decompressor context due to a CRC collision. Notably while exemplary advantages and benefits of the proactive RoHC adaptation schemes are described above these examples are non limiting.

Thus far the description has focused on embodiments of an adaptation scheme for the RoHC compressor that reduce the likelihood of RoHC context desynchronization. The discussion will now turn to systems and methods for determining and utilizing a PDCP SN gap value during RoHC SN decoding to enabling repairing of the RoHC SN after a loss of a large burst of packets i.e. loss of a burst of more than 2packets . Typically the PDCP SN has more bits e.g. 7 or 12 bits than the W LSB encoded RoHC SN e.g. 4 bits . Therefore the size of a gap or burst of lost packets can be tracked in the PDCP layer by the receiving PDCP entity and used by the RoHC decompressor to decode the W LSB encoded RoHC SN of a received PDCP PDU particularly when the number of lost packets in the burst is greater than the window size of the W LSB encoded RoHC SN i.e. when there is a burst of more than 2lost packets .

In this regard is a flow chart that illustrates the operation of the receiving PDCP entity and the RoHC decompressor according to one embodiment of the present disclosure. First the receiving PDCP entity determines a value or size of a PDCP gap g step . The size of the PDCP gap is determined by the receiving PDCP entity using standard or conventional information available to the receiving PDCP entity e.g. COUNT values . In particular the receiving PDCP entity determines when there is a gap in the PDCP SN which indicates packet loss between the transmitting PDCP entity and the receiving PDCP entity . In one embodiment the size of the PDCP gap g is computed based on the COUNT value of the previous PDCP PDU received by the receiving PDCP entity and the COUNT value of the current PDCP PDU received by the receiving PDCP entity . The size of this PDCP gap can then be passed to or otherwise made available to the RoHC decompressor of the receiving PDCP entity .

The RoHC decompressor performs decoding or decompression of the W LSB encoded RoHC SN in the current PDCP PDU based on the size of the PDCP gap g step . In general if the size of the PDCP gap g is greater than a threshold PDCP gap size the size of the PDCP gap g is applied to a reference full or uncompressed RoHC SN corresponding to the last successfully received and decompressed RoHC packet. The modified reference RoHC SN is then used to decode the W LSB encoded RoHC SN. The threshold PDCP gap size is such that successful decoding of the W LSB encoded RoHC SN is unlikely if the size of the PDCP gap g is greater than the threshold PDCP gap size. Otherwise if the size of the PDCP gap g is not greater than a threshold PDCP gap size the W LSB encoded RoHC SN is decoded using conventional RoHC processing as defined in the RoHC standard.

The receiving PDCP entity then computes the size of the PDCP gap g as COUNT COUNT 1 where COUNT is the value of COUNT computed in step and COUNTis the COUNT value computed for the previous PDCP PDU received by the receiving PDCP entity step . In one embodiment during initialization of the receiving PDCP entity COUNTis initialized to 2 1 and g is initialized to 0. Once the size of the PDCP gap g is computed the receiving PDCP entity sets COUNTequal to the COUNT value computed for the current PDCP PDU step and makes the size of the PDCP SN gap g available to the RoHC decompressor of the receiving PDCP entity step . The size of the PDCP SN gap g may be made available to the RoHC decompressor using any suitable technique such as for example an API.

Returning to step if the current value of k d is less than the size of the PDCP SN then the RoHC decompressor determines whether the size of the PDCP SN gap g is greater than or equal to a threshold gap size which in this example is 2 step . If not the process again proceeds to step where the RoHC decompressor computes the value v for the RoHC SN in the conventional manner. However if the size of the PDCP SN gap g is greater than or equal to the threshold gap size then the RoHC decompressor will fail to successfully decompress the PDCP PDU using the conventional computation of the value v for the RoHC SN. As such the RoHC decompressor computes a predicted reference value v ref pred as  ref pred  ref  where v ref d is the full RoHC SN of the last successfully decompressed PDCP PDU g is the size of the PDCP SN gap and f is the number of consecutive RoHC compressed PDCP PDUs that have failed decompression since the v ref d was set i.e. since the last successfully decompressed PDCP PDU step . The initial value of f is 0. As discussed below v ref d is a prediction of what v ref d would have been if the burst of packets had not been lost or failed to be decompressed. The RoHC decompressor then computes the value v for the RoHC SN according to  ref pred W LSB encoded step . Normally the last successful full RoHC SN v ref d is used with the W LSB encoded RoHC SN of the received PDCP PDU to derive the full RoHC SN for the received PDCP PDU. However since there is a gap or burst of lost packets that is larger than the window space of the W LSB RoHC SN which is 2 attempting RoHC decompression using the value v computed in the conventional manner based on v ref d would fail. In order to decrease the likelihood of decompression failure the value v is instead computed based on v ref pred which is the sum of v ref d plus the size of the PDCP SN gap g plus f. As such v ref d is a prediction of what v ref d would have been if the burst of packets had not been lost or failed to be decompressed.

Next whether proceeding from step or step once the value v is computed the RoHC decompressor performs decompression processing according to the RoHC standard using the computed value v for the full RoHC SN of the received RoHC compressed PDCP PDU step . The RoHC decompressor then determines whether there was a decompression failure i.e. determines whether the RoHC compressed PDCP PDU was decompressed successfully step . If there was a compression failure the counter f for the number of decompression failures is incremented step . Otherwise if decompression was successful the RoHC decompressor resets the counter f to 0 step . Lastly whether proceeding from step or step the RoHC decompressor performs normal post RoHC processing step . More specifically if decompression fails the packet is dropped. If decompression is successful then in order delivery and duplicate detection processing is performed.

Note that while the description above describes embodiments at the RoHC compressor e.g. and embodiments at the RoHC decompressor e.g. it should be noted that the RoHC compressor embodiments and the RoHC decompressor embodiments are independent from one another. Thus in a particular implementation an embodiment of the proactive adaptation of the RoHC compressor may be implemented with or without an embodiment of the RoHC decompressor providing decoding of the RoHC SN based on the size of the PDCP SN gap and vice versa. However it should also be noted that an implementation may include both an embodiment of the proactive adaption of the RoHC compressor and an embodiment of RoHC SN decoding based on the size of the PDCP SN gap.

The radio node including the PDCP entitles and the RoHC compressor and or the RoHC decompressor can be implemented in any suitable hardware or combination of hardware and software. Using the base station and the wireless device of as examples is a block diagram of one embodiment of the base station and is a block diagram of one embodiment of the wireless device . As illustrated in the base station includes a baseband unit including a processor memory and a network interface and a radio unit including a transceiver coupled to one or more antennas . In one embodiment the functionality of the base station described herein particularly that of the PDCP layer the PDCP entities the RoHC compressor and the RoHC decompressor is implemented in software stored in the memory and executed by the processor . Additionally the base station may include additional components responsible for providing additional functionality including any of the functionality described above and or any functionality necessary to support the embodiments described herein.

As illustrated in the wireless device includes a processor memory and a transceiver coupled to one or more antennas . In one embodiment the functionality described above as being provided by the wireless device and in particular the PDCP layer the PDCP entities the RoHC compressor and the RoHC decompressor is implemented in software stored in the memory and executed by the processor . Alternative embodiments of the wireless device may include additional components responsible for providing additional functionality including any of the functionality identified above and or any functionality necessary to support the embodiments described above.

In one embodiment a computer program is provided that includes instructions which when executed on at least one processor cause the at least one processor to carry out any of the embodiments of the radio node e.g. the base station or the wireless device described above. In one embodiment a carrier containing the computer program is provided wherein the carrier is one of an electronic signal an optical signal a radio signal or a computer readable storage medium e.g. a non transitory computer readable medium .

Those skilled in the art will recognize improvements and modifications to the embodiments of the present disclosure. All such improvements and modifications are considered within the scope of the concepts disclosed herein and the claims that follow.

