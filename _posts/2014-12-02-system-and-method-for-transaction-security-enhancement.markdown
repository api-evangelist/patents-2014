---

title: System and method for transaction security enhancement
abstract: The present disclosure involves a system that includes a computer memory storage component configured to store computer programming instructions and a computer processor component operatively coupled to the computer memory storage component. The computer processor component is configured to run a secure operating system and a non-secure operating system in parallel. The secure and non-secure operating systems are isolated from each other. The computer processor component is configured to execute code to perform the following operations: receiving an authentication request from an application that is run by the non-secure operating system, wherein the authentication request contains credentials of the application; communicating with a secure applet that is run by the secure operating system, and wherein the communicating includes transferring the credentials of the application to the secure applet; and authenticating and vetting the application based on the credentials of the application.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09311641&OS=09311641&RS=09311641
owner: PayPal, Inc.
number: 09311641
owner_city: San Jose
owner_country: US
publication_date: 20141202
---
The present application is a continuation application of U.S. patent application Ser. No. 13 441 363 filed on Apr. 6 2012 now U.S. Pat. No. 8 914 876 issued Dec. 16 2014 which claims priority to U.S. Provisional Patent Application No. 61 482 927 filed on May 5 2011 the contents of each are herein incorporated by reference in their entirety.

The present disclosure generally relates to managing payments online and more particularly to payment security.

Online transactions are becoming more and more prevalent with an ever increasing number of online entities that may or may not have a physical real world counterpart. Furthermore the services offered by these online entities have been improving as well. The popularity of online transactions is partially attributable to the ease and convenience of making a transaction online instead of at a physical location. However payment security is a big concern in online payment systems and methods. What is needed is a secure payment platform and technology that can sufficiently address user concerns with respect to transactional security.

One of the broader forms of the present disclosure involves a system. The system includes a computer memory storage component configured to store computer programming instructions and a computer processor component operatively coupled to the computer memory storage component wherein the computer processor component is configured to run a secure operating system and a non secure operating system in parallel wherein the secure and non secure operating systems are isolated from each other and wherein the computer processor component is configured to execute code to perform the following operations receiving an authentication request from an application that is run by the non secure operating system wherein the authentication request contains credentials of the application communicating with a secure applet that is run by the secure operating system and wherein the communicating includes transferring the credentials of the application to the secure applet and authenticating and vetting the application based on the credentials of the application.

Another one of the broader forms of the present disclosure involves an apparatus comprising a non transitory tangible machine readable storage medium storing a computer program wherein the computer program contains machine readable instructions that when executed electronically by processors perform receiving an authentication request from an application that resides in a non secure portion of an electronic chip wherein the authentication request contains credentials of the application communicating with a secure applet that resides in a secure portion of the electronic chip wherein the secure portion is segregated from the non secure portion and wherein the communicating includes transferring the credentials of the application to the secure applet and authenticating and vetting the application based on the credentials of the application.

Yet another one of the broader forms of the present disclosure involves a method of performing authentication and vetting. The method includes receiving an authentication request from an application that resides in a non secure portion of an electronic chip wherein the authentication request contains credentials of the application communicating with a secure applet that resides in a secure portion of the electronic chip wherein the secure portion is segregated from the non secure portion and wherein the communicating includes transferring the credentials of the application to the secure applet and authenticating and vetting the application based on the credentials of the application.

It is to be understood that the following disclosure provides many different embodiments or examples for implementing different features of the present disclosure. Specific examples of components and arrangements are described below to simplify the present disclosure. These are of course merely examples and are not intended to be limiting. Various features may be arbitrarily drawn in different scales for simplicity and clarity.

As mobile computing and communication technologies continue to advance transactions involving mobile devices are becoming increasingly more prevalent. The popularity of making transactions through mobile devices is partially attributable to the ease and convenience of these transactions for example an online purchase instead of traditional transactions involving tangible funding instruments for example actual money or checks at a physical location. However as mobile transactions gain popularity attacks targeting these transactions are also on the rise. These attacks may involve attempts of trying to steal the user s identity or financial information or may involve malevolent entities trying to pose as legitimate merchants.

The present disclosure discloses methods and systems of that enhance the security of the mobile transactions so that the attacks discussed above are substantially prevented or reduced.

Referring to a simplified block diagram of an electronic chip is illustrated. The electronic chip may be implemented on a mobile device such as a mobile telephone handset a computer tablet a laptop or the like. In some embodiments the electronic chip includes a computer processor for example an Advanced RISC Machine ARM processor. The computer process unit may contain memory storage capable of storing computer instructions. In other embodiments the electronic chip includes a computer memory storage device for example Read Only Memory ROM FLASH Random Access Memory RAM hard disk optical disk magnetic disk or other suitable types of volatile and non volatile memory devices.

The electronic chip is a TrustZone enabled chip. TrustZone is a technology developed by the ARM Holdings company and offers a platform that supports a trusted environment where applications can be executed securely. In more detail the electronic chip includes a normal world A and a secure world B that are segregated from each other to prevent secure information from leaking from the secure world B to the normal world A. These two worlds A and B run parallel to each other on the same electronic chip . The secure world B is preloaded and validated prior to boot up time of a main operating system of the handset. In some embodiments the normal world A runs the main operating system of the handset while the secure world B runs a different and more secure operating system. Thus the secure world B can be used to verify the integrity of components or applications residing in the normal world A. In some embodiments such integrity verification may be accomplished by applying a set of control parameters against the last known or authorization configuration.

The normal world A and the secure world B may each contain one or more software applications. In some embodiments the software applications residing in the secure world B may also be referred to as applets. For example an application resides in the normal world and one or more secure applets resides in the secure world. In some embodiments the application includes a part of a computer software program developed by a payment provider entity as such PAYPAL INC of San Jose Calif. or another suitable financial institution capable of transferring funds to and from a user s account. The application may be offered and downloaded by a user through the Internet for example through GOOGLE PLAY or the APPLE APP STORE . The application may include functionalities and interfaces that help perform standard tasks that require low levels of security. For example the application may contain programming instructions that allow a user of the payment provider entity to perform standard management tasks with his account such as retrieving his purchasing history. In some other embodiments the application may be a part of a computer software program developed by a third party developer for example a merchant that offers sale of tangible or digital goods. In that case the application from the third party developer can also be downloaded through GOOGLE PLAY or the APPLE APP STORE .

The secure applets residing in the secure world B are program modules that are configured to perform secure tasks. In some embodiments the secure applets are another part of the computer software program developed by the payment provider entity. In other words in that scenario the secure applets residing in the secure world B and the application residing in the normal world A are two parts of a single downloadable application.

As the application resides in the normal world A having lower levels of security the application may request authentication or vetting services from the secure applets when tasks requiring high levels of security need to be performed. These secure tasks may include but are not limited to credential entry secure identification entry secure user interface key access or encryption decryption services. Since the normal world A and the secure world B are segregated a software module known as a monitor may be used to carry out communication between the normal world A and the secure world B. In some embodiments the monitor is the sole means of communication between the normal world A and the secure world B. For example the monitor may interface with the application without letting the application gain access to any entities in the secure world B. The monitor may then relay the request from the application to a target entity in the secure world B such as the secure applets . The monitor then gives feedback to the application sometimes along with a request resource such as a verification key or token.

In the embodiment illustrated however the monitor is largely or at least partially bypassed. Instead a hook A residing in the normal world A and a hook B residing in the secure world B may be used to carry out the communication between the normal world A and the secure world B instead. The hooks A and B may be a software module or a logical function that runs on top of the monitor . Whereas the monitor functions like a gateway between the two worlds A B and performs switching at an operating system level the hooks A B function as a door stop that effectively props open the gateway between the two worlds A B and performs switching at an application level. In some embodiments the hooks A B prop open the gateway for a single application. In other words when in use by one application another application not signed or recognized by the hooks A B cannot dump the original application from the priority list. Each hook can reside in its own space or within the application or applet in its respective world.

The hook B residing in the secure world B is implemented by the resources of a monitor toolkit . The monitor toolkit contains a full set of monitor functions. For a first time provisioning and activation the hook A and the hook B may still go through the monitor which is indicated by a pathway . Thereafter direct communication may be established between the hook A and the hook B which is indicated by a pathway . Therefore entities residing in the normal world A such as the application may communicate with the trusted entities residing in the secure world B such as the secure applets through the hooks A B while bypassing the monitor .

The system described in can be used to enhance security in mobile device transactions. For example if an application requesting authentication cannot seek verification by a remote secure entity which may be due to loss of network connections or other reasons then the secure applets in the secure world may be used to authenticate or vet the application. This is possible because the secure applets and other entities are already validated as being secure since they reside in the secure world B even if that secure world is local to a mobile device itself. In this sense the secure world B of the electronic chip is leveraged to perform tasks involving enhanced security.

For example a payment provider entity could provide to its partners a developer kit that would allow them to develop applications for various platforms with the security validation being done by the payment provider entity in the same way from the secure world. By providing the developer with a way to make sure its application is legit it will not only reassure the end user of the integrity of the transaction but also limit the risk for the developer to see a fraudulent transaction to go through. This can be done by creating a subset of functions from the mobile library of the payment provider entity to be leveraged to sign an application from a third party developer. The third party may take proper advantage of an application programming interface API from the payment provider and may provide its own user anti spoofing anti phishing experience.

At least two use cases apply. In an In App Payment use case the payment provider may provide its library to a third party developer such as a merchant. The application for example the application developed by the third party developer may contain the library from the payment provider which embeds a string of code in its library that will be understood only by the secure world module for example the secure applets residing in the secure world B of the payment provider. If a spoof application is trying to mimic the legitimate application from a third party developer it will fail at the launch of the payment module

In an In Flow Payment user case an application from a third party developer is in a stand alone mode as well as the application from the third party payment provider. There is a handover from one application to the other at the time of payment. A validation mechanism may be stored in the secure world B that would validate a call of that third party application to the payment provider application.

As an example to illustrate the above use cases suppose a merchant Big Mart develops a shopping application that is downloadable to a user s mobile device. Big Mart may be one of the partners of the payment provider entity. Thus the payment provider entity may offer its library to Big Mart. The library has an embedded security mechanism such as a key that can be matched to a counterpart key. In fact the payment provider may assign a chain of different keys to a plurality of its partner developers. The payment provider keeps track of which key is assigned to which developer and may maintain that information in its downloadable application.

A user of the payment provider downloads the application from the payment provider as well as the application from Big Mart on his mobile device. The user may make an online purchase using the application from Big Mart. At this time the Big Mart application may ask the user for sensitive information such as his name address and or credit card information. In traditional payment scenarios the user may not know that the application from Big Mart is legitimate or can be trusted. Here the Big Mart application can be authenticated and vetted by the secure applets residing on the secure world of the user s mobile device. In some embodiments authentication may refer to the process of validating the legitimacy and or the security of a particular application for itself and vetting may refer to the process of validating the legitimacy and or the security of a particular application to others. In other words the vetting of a particular application means it can be trusted by everyone else. Returning to the example the authentication and or vetting of the Big Mart application may be performed by the secure applets of the payment provider residing in the secure world. Specifically the Big Mart application submits its authentication or vetting credentials to the secure applets through the hooks. The authentication or vetting credentials may include the key given to the Big Mart application by the payment provider entity. The secure applets retrieve the key and tries to pairs it with a corresponding key stored within the secure world. If the key pairing is successful then that means the Big Mart application is legitimate and can be trusted thus the Big Mart application is authenticated and vetted. If the key pairing is unsuccessful then that indicates the Big Mart application may be a fake one and it will not be authenticated or vetted.

In some embodiments the authentication or vetting of the Big Mart application may be communicated to the user by a visual and or audio representation on the mobile device. For example the display screen of the mobile device may display a certain pattern to let the user known that the Big Mart application has been authenticated and vetted and that the user may go ahead and provide the sensitive information to the Big Mart application without concerns of theft or data loss.

The architecture also includes a normal world A and a secure world B that run parallel to but are isolated from each other. A trustlet a secure applet resides in the secure world B. The trustlet may be an application trusted by the payment provider for example the trustlet may be an application developed by the payment provider . The trustlet can directly communicate with the payment provider . An app which may include one or more applications resides in the secure world A. The app communicates with external entities that need secure operations to be performed thus requiring a switch to the secure world B. These secure operations may include credentials entry secure ID secure user interface key access or encryption decryption services.

A normal operating system runs the normal world A and a secure operating system runs the secure world. A secure monitor serves as a default gateway between the normal world A and the secure world B. However the operating system is implemented to be capable of controlling and maintaining a hook therein and the operating system is implemented to be capable of controlling and maintaining a hook where the hooks can be used to establish communication with the secure world B. In addition the normal operating system and the secure operating system are implemented to be capable of using the same hooks to talk back to applications from trusted application e.g. the trustlet residing in the secure world B and establish trust vetting for applications e.g. app residing in the normal world A. Thus an open flow exists between the normal world A and the payment provider . Stated differently the communication is not blocked by the monitor and applets and applications can be managed from the cloud i.e. the remote servers of the payment provider .

A TrustZone enabled ARM core processor is used to execute instructions for the normal operating system and the secure operating system . The TrustZone enabled ARM core processor contains a secure vault . Private keys and public keys can both be stored in the secure vault . Meanwhile a private key can be stored remotely in the servers of the payment provider as well. These private and public keys may be used to perform authentication and or vetting tasks for example for the app .

It is understood that the high level architecture described above is merely one of many example implementations of the concepts of the present disclosure. Other embodiments may have different implementation details without departing from the spirit and the scope of the present disclosure.

The method includes a step in which communication is performed with a secure applet that resides in a secure portion of the electronic chip. The secure portion is segregated from the non secure portion. The communication includes transferring the credentials of the application to the secure applet. In some embodiments the application is a software program from a third party developer and the secure applets are a portion of a software program from a payment provider. In other embodiments the application and the secure applets are both portions of a software program from a payment provider. The communication is also performed at least in part by at least partially bypassing a monitor that is configured as a gateway between the secure portion of the electronic chip and the non secure portion of the electronic chip.

The method includes a step in which the application is authenticated and vetted based on the credentials of the application. In certain embodiments the authenticating and the vetting are performed without accessing a remote server.

It is understood that additional method steps may be performed before during or after the steps discussed above. For the sake of simplicity however these additional steps are not specifically illustrated or discussed herein.

In accordance with various embodiments of the present disclosure the computer system such as a network server or a mobile communications device includes a bus component or other communication mechanisms for communicating information which interconnects subsystems and components such as a TrustZone enabled processing component e.g. processor micro controller digital signal processor DSP etc. system memory component e.g. RAM static storage component e.g. ROM disk drive component e.g. magnetic or optical network interface component e.g. modem or Ethernet card display component e.g. cathode ray tube CRT or liquid crystal display LCD input component e.g. keyboard cursor control component e.g. mouse or trackball and image capture component e.g. analog or digital camera . In one implementation disk drive component may comprise a database having one or more disk drive components.

In accordance with embodiments of the present disclosure computer system performs specific operations by the TrustZone enabled processor executing one or more sequences of one or more instructions contained in system memory component . Such instructions may be read into system memory component from another computer readable medium such as static storage component or disk drive component . In other embodiments hard wired circuitry may be used in place of or in combination with software instructions to implement the present disclosure.

Logic may be encoded in a computer readable medium which may refer to any medium that participates in providing instructions to TrustZone enabled processor for execution. Such a medium may take many forms including but not limited to non volatile media and volatile media. In one embodiment the computer readable medium is non transitory. In various implementations non volatile media includes optical or magnetic disks such as disk drive component and volatile media includes dynamic memory such as system memory component . In one aspect data and information related to execution instructions may be transmitted to computer system via a transmission media such as in the form of acoustic or light waves including those generated during radio wave and infrared data communications. In various implementations transmission media may include coaxial cables copper wire and fiber optics including wires that comprise bus .

Some common forms of computer readable media includes for example floppy disk flexible disk hard disk magnetic tape any other magnetic medium CD ROM any other optical medium punch cards paper tape any other physical medium with patterns of holes RAM PROM EPROM FLASH EPROM any other memory chip or cartridge carrier wave or any other medium from which a computer is adapted to read.

In various embodiments of the present disclosure execution of instruction sequences to practice the present disclosure may be performed by computer system . In various other embodiments of the present disclosure a plurality of computer systems coupled by communication link e.g. a communications network such as a LAN WLAN PTSN and or various other wired or wireless networks including telecommunications mobile and cellular phone networks may perform instruction sequences to practice the present disclosure in coordination with one another.

Computer system may transmit and receive messages data information and instructions including one or more programs i.e. application code through communication link and communication interface . Received program code may be executed by TrustZone enabled processor as received and or stored in disk drive component or some other non volatile storage component for execution.

Where applicable various embodiments provided by the present disclosure may be implemented using hardware software or combinations of hardware and software. Also where applicable the various hardware components and or software components set forth herein may be combined into composite components comprising software hardware and or both without departing from the spirit of the present disclosure. Where applicable the various hardware components and or software components set forth herein may be separated into sub components comprising software hardware or both without departing from the scope of the present disclosure. In addition where applicable it is contemplated that software components may be implemented as hardware components and vice versa.

Software in accordance with the present disclosure such as computer program code and or data may be stored on one or more computer readable mediums. It is also contemplated that software identified herein may be implemented using one or more general purpose or specific purpose computers and or computer systems networked and or otherwise. Where applicable the ordering of various steps described herein may be changed combined into composite steps and or separated into sub steps to provide features described herein.

It should be appreciated that like reference numerals are used to identify like elements illustrated in one or more of the figures wherein these labeled figures are for purposes of illustrating embodiments of the present disclosure and not for purposes of limiting the same.

The foregoing disclosure is not intended to limit the present disclosure to the precise forms or particular fields of use disclosed. As such it is contemplated that various alternate embodiments and or modifications to the present disclosure whether explicitly described or implied herein are possible in light of the disclosure. Having thus described embodiments of the present disclosure persons of ordinary skill in the art will recognize that changes may be made in form and detail without departing from the scope of the present disclosure. Thus the present disclosure is limited only by the claims.

