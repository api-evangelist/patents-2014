---

title: Selectable service node resources
abstract: In one example, a method includes receiving, by a service node, a request from an access node to establish a pseudowire to be used for sending subscriber traffic to the service node for application of services to the subscriber traffic at the service node, and, in response to receiving the request, sending a request message from the service node to a central server requesting both subscriber authentication and assignment of a forwarding component of the service node to which to anchor the pseudowire. The method also includes receiving, by the service node and from the central server, an authentication message in response to the request message, wherein the authentication message confirms subscriber authentication and indicates a forwarding component of the service node to which the service node should anchor the pseudowire.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09485192&OS=09485192&RS=09485192
owner: Juniper Networks, Inc.
number: 09485192
owner_city: Sunnyvale
owner_country: US
publication_date: 20140411
---
This application claims priority to European Patent Application No. EP14382099.1 filed Mar. 21 2014 the entire contents of which are incorporated by reference herein.

The disclosure relates to packet based computer networks and more particularly to forwarding packets within computer networks.

A computer network is composed of a set of nodes and a set of links that connect one node to another. For instance a computer network may be composed of a set of routers while the set of links may be cables between the routers. When a first node in the network sends a message to a second node in the network the message may pass through many links and many nodes. The links and nodes the message passes through while traveling from the first node to the second node is referred to as a path.

Packet based computer networks increasingly utilize label switching protocols for traffic engineering and other purposes. In a label switching network label switching routers LSRs use Multi Protocol Label Switching MPLS signaling protocols to establish label switched paths LSPs . The LSRs utilize MPLS protocols to receive MPLS label mappings from downstream LSRs and to advertise MPLS label mappings to upstream LSRs. When an LSR receives an MPLS packet from an upstream router it switches the MPLS label according to the information in its forwarding table and forwards the packet to the appropriate downstream LSR.

MPLS can be deployed in core and aggregation network and provides a mature and stable basis for large networks. MPLS can also be used in access networks e.g. such as mobile or Digital Subscriber Line DSL backhaul networks. MPLS is used on two different layers the Transport Layer and the Service Layer e.g. for MPLS virtual private networks VPNs . In both cases the protocols and the encapsulation are identical but the use of MPLS is different especially concerning the signaling the control plane the provisioning the scalability and the frequency of updates. On the service layer only service specific information is exchanged and every service can potentially deploy its own architecture and individual protocols. The services run on top of the transport layer.

A Seamless MPLS network is a network in which all forwarding of packets within the network from the time a packet enters the network until it leaves the network is done based on MPLS. The motivation of Seamless MPLS is to provide an architecture which supports a wide variety of different services on a single MPLS platform fully integrating access aggregation and core network. The architecture can be used for residential services mobile backhaul business services and supports fast reroute redundancy and load balancing. Seamless MPLS provides the deployment of service creation points which can be virtually everywhere in the network enabling network and service providers with a flexible service and service creation. Service creation can be done based on the existing requirements without the needs for dedicated service creation areas on fixed locations. With the flexibility of Seamless MPLS the service creation can be done anywhere in the network and easily moved between different locations.

In general this disclosure describes techniques for providing dynamically selectable service resources in a network. For example service nodes can expose their service resources and capabilities including the level of utilization of those service resources to other devices in a network by sending service resource information to a central data repository. In one example a routing protocol is extended to allow for advertising the service resource information via route update messages. In addition service nodes can update this information by sending further update messages as the service resources are consumed or released. In some examples a central server device can determine which service resource to assign to a requesting network device. Whichever network element is configured to make decisions based on the service selection database has access to that information and can make the appropriate choices such as selecting which service node to use for a session with the access node which PFE within a service node to use for anchoring a pseudowire with an access node which service node to use as backup if backup is needed or which PFE to use as backup for example.

In one example aspect a method includes receiving by a service node a request from an access node to establish a pseudowire to be used for sending subscriber traffic from the access node to the service node for application of services to the subscriber traffic at the service node and in response to receiving the request sending a request message from the service node to a central server requesting both subscriber authentication and assignment of a forwarding component of the service node to which to anchor the pseudowire. The method also includes receiving by the service node and from the central server an authentication message in response to the request message wherein the authentication message confirms subscriber authentication and indicates a forwarding component of the service node to which the service node should anchor the pseudowire in response to receiving the authentication message automatically establishing the pseudowire between the access node and the service node and anchoring the pseudowire to the forwarding component indicated by the authentication message.

In another example aspect a method includes receiving at a central server a request from a network device requesting both subscriber authentication and assignment of one of a plurality of service nodes in a network to which to establish a targeted label distribution protocol LDP session between an access node and the assigned one of the plurality of service nodes for transporting subscriber traffic and in response to receiving the request and by the central server assigning a service node based on a service selection database containing service resource information associated with the plurality of service nodes. The method also includes outputting an authentication message from the central server to the requesting network device in response to the request message wherein the authentication message confirms subscriber authentication and indicates the assigned service node.

In another example aspect a service node network device includes a hardware based processor an interface operable to receive a request from a network device requesting both subscriber authentication and assignment of one of a plurality of service nodes in a network to which to establish a targeted label distribution protocol LDP session between an access node and the assigned one of the plurality of service nodes for transporting subscriber traffic a service resource module operable by the processor to in response to receiving the request assign a service node based on a service selection database containing service resource information associated with the plurality of service nodes and an authorization module operable by the processor to output an authentication message from the central server to the requesting network device in response to the request message wherein the authentication message confirms subscriber authentication and indicates the assigned service node.

In a further example aspect a central server includes a hardware based processor an interface operable to receive a request from a network device requesting both subscriber authentication and assignment of one of a plurality of service nodes in a network to which to establish a targeted label distribution protocol LDP session between an access node and the assigned one of the plurality of service nodes for transporting subscriber traffic and a service resource module operable by the processor to in response to receiving the request assign a service node based on a service selection database containing service resource information associated with the plurality of service nodes. The central server further includes an authorization module operable by the processor to output an authentication message from the central server to the requesting network device in response to the request message wherein the authentication message confirms subscriber authentication and indicates the assigned service node.

In a further example aspect a computer readable storage medium includes instructions for causing a programmable processor to receive a request at a service node from an access node to establish a pseudowire to be used for sending subscriber traffic from the access node to the service node for application of services to the subscriber traffic at the service node and in response to receiving the request send a request message from the service node to a central server requesting both subscriber authentication and assignment of a forwarding component of the service node to which to anchor the pseudowire. The computer readable storage medium further includes instructions for causing the programmable processor to receive from the central server an authentication message in response to the request message wherein the authentication message confirms subscriber authentication and indicates a forwarding component of the service node to which the service node should anchor the pseudowire in response to receiving the authentication message automatically establish the pseudowire between the access node and the service node and anchor the pseudowire to the forwarding component indicated by the authentication message.

The techniques of this disclosure may provide one or more advantages. For example in some example aspects the techniques described herein can allow access nodes and service nodes to leverage the authorization process performed between themselves and a central server to obtain intelligent assignment of service resources.

The techniques of this disclosure can also allow for automating the process of establishing the connectivity between an access node and the determined service node after the service allocation decision has taken place. Many auto detection or auto creation features have been developed to ensure that no subscriber or service configuration is required such that service nodes e.g. Broadband Network Gateways BNGs are zero touch. With a basic configuration and upon reception of customer traffic e.g. detection of activity on a Virtual Local Area Network VLAN VLANs can be dynamically authenticated and created using information received from an AAA on central server and so are the dynamic subscriber interfaces. In the service node case there are new entities that may need to be created for signaling sessions towards access nodes e.g. pseudowires. In addition due to the nature of the Seamless MPLS architecture it may be unknown or non determined a priori which service nodes should serve a specific access node as this is the nature of this mode of operation. The techniques of this disclosure give the flexibility to select the service node based on any criteria new service node centralized for a specific service for example while maintaining the zero touch aspect of the operation.

The details of one or more examples are set forth in the accompanying drawings and the description below. Other features objects and advantages will be apparent from the description and drawings and from the claims.

In the example of service provider network comprises access network access network that provides connectivity to public network via service provider core network and gateway . Service provider core network and public network provide packet based services that are available for request and use by subscriber devices subscriber devices . As examples core network and or public network may provide for example bulk data delivery voice over Internet protocol VoIP Internet Protocol television IPTV Short Messaging Service SMS Wireless Application Protocol WAP service or customer specific application services. Packet data network may comprise for instance a local area network LAN a wide area network WAN the Internet a virtual LAN VLAN an enterprise LAN a layer virtual private network VPN an Internet Protocol IP intranet operated by the service provider that operates access network an enterprise IP network or some combination thereof. In various embodiments public network is connected to a public WAN the Internet or to other networks. Packet data network executes one or more packet data protocols PDPs such as IP IPv4 and or IPv6 X.25 or Point to Point Protocol PPP to enable packet based transport of public network services.

Subscriber devices connect to gateway via access network to receive connectivity to subscriber services for applications hosted by subscriber devices . A subscriber may represent for instance an enterprise a residential subscriber or a mobile subscriber. Subscriber devices may be for example personal computers laptop computers or other types of computing device associated with subscribers. In addition subscriber devices may comprise mobile devices that access the data services of service provider network via radio access network RAN . Example mobile subscriber devices include mobile telephones laptop or desktop computers having e.g. a 3G wireless card wireless capable netbooks video game devices pagers smart phones personal data assistants PDAs or the like. Each of subscriber devices may run a variety of software applications such as word processing and other office support software web browsing software software to support voice calls video games videoconferencing and email among others. Subscriber devices connect to access network via access links that comprise wired and or wireless communication link. The term communication link as used herein comprises any form of transport medium wired or wireless and can include intermediate nodes such as network devices. Each of access links may comprise for instance aspects of an asymmetric DSL network WiMAX a T 1 line an Integrated Service Digital Network ISDN wired Ethernet or a cellular radio link.

A network service provider operates or in some cases leases elements of access network to provide packet transport between subscriber devices and gateway . Access network represents a network that aggregates data traffic from one or more subscribers for transport to from service provider core network of the service provider. Access network includes network nodes that execute communication protocols to transport control and user data to facilitate communication between subscriber devices and gateway . Access network may include a broadband access network network a wireless LAN a public switched telephone network PSTN or other type of access network and may include or otherwise provide connectivity for cellular access networks such as radio access network RAN of . Examples of include networks conforming to a Universal Mobile Telecommunications System UMTS architecture an evolution of UMTS referred to as Long Term Evolution LTE mobile IP standardized by the Internet Engineering Task Force IETF as well as other standards proposed by the 3Generation Partnership Project 3GPP 3Generation Partnership Project 2 3GGP 2 and the Worldwide Interoperability for Microwave Access WiMAX forum.

Service provider core network hereinafter core network offers packet based connectivity to subscriber devices attached to access network for accessing public network . Core network may represent a public network that is owned and operated by a service provider to interconnect a plurality of networks which may include access network . Core network may implement Multi Protocol Label Switching MPLS forwarding and in such instances may be referred to as an MPLS network or MPLS backbone. In some instances core network represents a plurality of interconnected autonomous systems such as the Internet that offers services from one or more service providers. Public network may represent an edge network coupled to core network e.g. by a customer edge device such as customer edge switch or router. Public network may include a data center.

In examples of network that include a wireline broadband access network gateway may represent a Broadband Network Gateway BNG a Broadband Remote Access Server BRAS MPLS Provider Edge PE router core router or gateway or a Cable Modem Termination System CMTS for instance. In examples of network that include a cellular access network as access network gateway may represent a mobile gateway for example a Gateway General Packet Radio Service GPRS Serving Node GGSN an Access Gateway aGW or a Packet Data Network PDN Gateway PGW . In other examples the functionality described with respect to gateway may be implemented in a switch service card or other network element or component. In some examples gateway may itself be a service node.

A network service provider that administers at least parts of network typically offers services to subscribers associated with devices e.g. subscriber devices that access the service provider network. Services offered may include for example traditional Internet access Voice over Internet Protocol VoIP video and multimedia services and security services. As described above with respect to access network core network may support multiple types of access network infrastructures that connect to service provider network access gateways to provide access to the offered services. In some instances network system may include subscriber devices that attach to multiple different access networks having varying architectures.

In general any one or more of subscriber devices may request authorization and data services by sending a session request to gateway . In turn gateway may access central server to authenticate the subscriber device requesting network access. Central server may include functionality of an Authentication Authorization and Accounting AAA server as described in further detail below. Once authenticated any of subscriber devices may send subscriber data traffic toward service provider core network in order to access and receive services provided by public network and such packets may traverse gateway as part of at least one packet flow.

Flows illustrated in represent one or more upstream packet flows from any one or more subscriber devices and directed to public network . The term packet flow traffic flow or simply flow refers to a set of packets originating from a particular source device and sent to a particular destination device. A single flow of packets in either the upstream sourced by one of subscriber devices or downstream destined for one of subscriber devices direction may be identified by the 5 tuple for example. This 5 tuple generally identifies a packet flow to which a received packet corresponds. An n tuple refers to any n items drawn from the 5 tuple. For example a 2 tuple for a packet may refer to the combination of or for the packet. Moreover a subscriber device may originate multiple packet flows upon authenticating to service provider network and establishing a communication session for receiving data services.

As described herein service provider core network includes service nodes A C. Each of service nodes may represent a Broadband Network Gateway BNG a Broadband Remote Access Server BRAS MPLS Provider Edge PE router core router gateway router or a Cable Modem Termination System CMTS for instance. In examples of network that include a cellular access network as access network each of service nodes A C may represent a mobile gateway for example a Gateway General Packet Radio Service GPRS Serving Node GGSN an Access Gateway aGW or a Packet Data Network PDN Gateway PGW . In other examples the functionality described with respect to each of service nodes A C may be implemented in a switch service card or other network element or component.

As described herein service provider network also includes a services complex having a cluster of service nodes D N that provide an execution environment for the network services. In some examples each of service nodes D N represents a service instance. Collectively service nodes A N are referred to herein as service nodes . Each of service nodes may apply one or more services. As examples service nodes may apply firewall and security services carrier grade network address translation CG NAT media optimization voice video IPSec VPN services deep packet inspection DPI HTTP filtering counting accounting charging and or load balancing of packet flows or other types of services applied to network traffic.

Although illustrated as part of a services complex which may represent a data center service nodes D N may for instance be network devices coupled by one or more switches or virtual switches of core network . In one example each of service nodes D N may run as virtual machines in a virtual compute environment. Moreover the compute environment may comprise a scalable cluster of general computing devices such as x86 processor based servers. As another example service nodes D N may comprise a combination of general purpose computing devices and special purpose appliances. As virtualized individual network services provided by service nodes D N can scale just as in a modern data center through the allocation of virtualized memory processor utilization storage and network policies as well as horizontally by adding additional load balanced virtual machines.

As shown in gateway can steer individual subscriber packet flows through defined sets of services provided by service nodes D N. That is in some examples each subscriber packet flow may be forwarded through a particular ordered combination of services provided by service nodes D N each ordered set being referred to herein as a service chain. In the example of one or more subscriber packet flows are directed along a first service chain A and therefore receive services applied by service nodes F E and N in that order. Similarly one or more subscriber packet flows are directed along a second service chain B and therefore receive services applied by service nodes D E and N. In other examples subscriber packet flows may be directed along a service chain that includes any of service nodes .

In this way subscriber flows may be processed by service nodes as the packets flow between access network and public network according to service chains configured by the service provider. In the illustrated example service chain A identifies the ordered set of service nodes F E and N according to the listed ordering. Service chain B identifies the ordered set of service nodes D E and N. Accordingly packet flows processed according to service chain A follow a service path that traverses service nodes F E and finally service node N as the terminal node for the service chain A. A particular service node may support multiple service chains. In this example service node E supports both of service chains A B.

Once processed at a terminal node of the service chain i.e. the last service node to apply services to packets flowing along a particular service path the terminal node may direct the traffic back to gateway for further processing and or forwarding to public network . For example traffic engineered service paths may start and terminate with gateway .

Whereas a service chain defines one or more services to be applied in a particular order to provide a composite service for application to packet flows bound to the service chain a service tunnel or service path refers to a logical and or physical path taken by packet flows processed by a service chain along with the forwarding state for forwarding packet flows according to the service chain ordering. Each service chain may be associated with a respective service tunnel and packet flows associated with each subscriber device flow along service tunnels in accordance with a service profile associated with the respective subscriber. The arrows denoted as service chains A B illustrate respective paths taken by packet flows mapped to the service chains A or B. For example a given subscriber may be associated with a particular service profile which in turn is mapped to a service tunnel associated with service chain A. Similarly another subscriber may be associated with a different service profile which in turn is mapped to a service tunnel associated with service chain B. In some examples gateway may after authenticating and establishing access sessions for the subscribers direct packet flows for the subscribers along the appropriate service tunnels thereby causing service complex to apply the requisite ordered services for the given subscriber.

In some examples service nodes may implement service chains A B using internally configured forwarding state that directs packets of the packet flow long the service chains A B for processing according to the identified set of service nodes . Such forwarding state may specify tunnel interfaces for tunneling between service nodes using network tunnels such as Internet Protocol IP or Generic Route Encapsulation GRE tunnels or by using Virtual Local Area Networks VLANs Multiprotocol Label Switching MPLS techniques and so forth. In some instances real or virtual switches routers or other network elements that interconnect service nodes may be configured to direct packet flow to the service nodes according to service chains A B.

In some examples central server may be a software defined networking SDN controller that provides a high level controller for configuring and managing routing and switching infrastructure of service provider network e.g. gateway core network and service nodes . In some instances central server manages deployment of virtual machines within the operating environment of value added services complex . For example central server may interact with gateway to specify service chain A B information. For example the service chain information provided by central server may specify any combination and ordering of value added services provided by service nodes traffic engineering information e.g. labels or next hops for tunneling or otherwise transporting e.g. MPLS or IP tunnels packet flows along service paths rate limits Type Of Service TOS markings or packet classifiers that specify criteria for matching packet flows to a particular service chain A B. Further example details of an SDN controller are described in PCT International Patent Application PCT US13 44378 filed Jun. 5 2013 the entire contents of which are incorporated herein by reference.

Central server may be in some examples a Remote Authentication Dial In User Service RADIUS server that provides centralized Authentication Authorization and Accounting AAA management. The RADIUS protocol is described in Carl Rigney et al. Remote Authentication Dial In User Server RADIUS Network Working Group of the Internet Engineering Task Force IETF Request for Comments 2865 June 2000 which is incorporated by reference herein in its entirety referred to hereinafter as RFC 2865 . Authorization data in the RADIUS server are stored as vendor specific attributes VSAs . In another example central server may be a Lightweight Directory Access Protocol LDAP server.

One of the key advantages of Seamless MPLS is to turn the whole network into a Cloud of reachable resources. However this also means that there is flexibility in allocating resources to services access nodes and or subscribers. That flexibility needs to be articulated into some solution. When an access node AN e.g. access node needs to establish a pseudowire towards a service node SN such as one of service nodes for one or more subscribers such as subscriber devices in the absence of the techniques of this disclosure the AN must be explicitly configured e.g. by an administrator which SN is to be used as the destination. However the conditions that determine which is the appropriate SN may change over time for example there may be new services whose SN gets deployed in a centralized way specialized SNs overload conditions that require another SN to be used or failure scenarios that require other more remote SNs to be used. All those are situations that would require some intelligent decision about which is the appropriate SN. Likewise within a SN it also needs to take an intra SN decision about which specific service resource it will need to use i.e. which PFE . PFEs may be at a different degree of utilization. There is therefore a SN selection and PFE selection within a service node. Both fall into what we referred as Service Resource Selection . The SN Selection is relevant for the AN e.g. OLT DSLAM . The PFE Selection is relevant within the SN e.g. BNG PE . That decision can happen within the network element itself distributed or can happen in an external centralized entity. In either case for that decision to happen the decision maker needs to have the necessary information.

In the example of service nodes may communicate service resource information to central server to be stored by central server in service selection database . The service resource information indicates information regarding service resources available on each of service nodes such as types of services and may also indicate capacity information such as a number of packet forwarding engines PFEs in the respective service node and how much processing capacity the PFEs each have remaining for applying services to additional traffic for example. The service resource information can be expressed in a normalized fashion across the different service nodes . In some examples each of service nodes may send routing advertisements that include service resource information. A routing protocol such as an interior gateway protocol IGP e.g. IS IS or OSPF or the Border Gateway Protocol BGP for example may be extended to include service resource information in route update messages. For example service nodes may send routing protocol update messages A D routing protocol update messages to central server . In some examples update messages may be BGP update message that carry service resource information in network layer reachability information NLRI fields. Central server receives the routing protocol update messages and updates service selection database with the service resource information from the routing protocol update messages .

In this manner service nodes can expose their service resources and capabilities including the level of utilization of those service resources. In addition service nodes can update this information by sending further update messages as the service resources are consumed or released. Whichever network element is configured to make decisions based on the service selection database has access to that information and can make the appropriate choices such as selecting which service node to use for a session with the access node which PFE within a service node to use for anchoring a pseudowire with an access node which service node to use as backup if backup is needed or which PFE to use as backup for example.

The mechanism used to expose the service resources in this case may be for example the TE extensions of the IGP OSPF TE or ISIS TE or BGP TE. Extensions to a routing protocol to advertise service resource information may be similar to those extensions made for advertising link state information in BGP for example. For examples of advertising link state information in BGP see H. Gredler Advertising Link State Information in BGP Inter Domain Routing Internet Draft draft gredler bgp to 01 July 2011 the entire contents of which are incorporated by reference herein.

Service provider core network may comprise an Internet Protocol IP network that uses Multi Protocol Label Switching MPLS mechanisms to encapsulate packets of various network protocols for transport across network . MPLS protocols such as the Label Distribution Protocol LDP or the Resource Reservation Protocol with Traffic Engineering extensions RSVP TE enable routers to establish specific paths through network i.e. Label Switched Paths LSPs . A set of packets to be forwarded in a same manner along a same LSP is referred to as a forwarding equivalence class FEC . Typically a FEC definition includes the IP address of the egress router of the LSP. Using MPLS mechanisms data packets are assigned labels to identify the FEC to which the packets belong and forwarding decisions are made for the data packets based on the labels. The labels are included in MPLS headers used to encapsulate the packets for transport along the LSP. In some examples the labels are stacked to establish segmented LSP tunnels in which multiple LSPs are nested together in order to reach an egress router of the last LSP on the label stack. Label assignment in the MPLS architecture is described in more detail in Aggarwal R. MPLS Upstream Label Assignment and Context Specific Label Space RFC 5331 August 2008 the entire contents of which are incorporated by reference herein.

In network network devices may use LDP to distribute labels to other routers along the hop by hop IGP paths to establish LSPs. More specifically the routers may distribute LDP label mapping messages indicating assigned labels and associated FECs for the LSPs. Two routers that use LDP to exchange label mapping information are referred to as LDP peer routers. Directly connected neighbor routers may be LDP peer routers with a direct LDP session. In the case where non neighbor routers want to be LDP peer routers the non neighbor routers may establish a targeted LDP session between them. For example access node and service node may be LDP peer routers with a targeted LDP session . In the example of service node B may distribute a LDP label mapping message to access node along an IGP primary path to establish a targeted LDP session between access node and service node B for example. More information on LDP is described in Anderson L. LDP Specification RFC 5036 October 2007 the entire contents of which are incorporated by reference herein. More information on MPLS is described in Rosen E. Multiprotocol Label Switching Architecture RFC 3031 January 2001 the entire contents of which are incorporated by reference herein.

Access node may be for example an optical line terminal OLT a DLSAM or other access node device. In some examples in response to detecting one of various potential triggering events such as receiving traffic associated with a newly provisioned customer line access node checks with central server as to what access node should do with the traffic received for the new customer line e.g. by sending a request message to central server . To request access to a service a subscriber device connects to access node . Access node is a RADIUS client configured to communicate with a central server for the service provider network using the RADIUS protocol access node confirms that the subscriber device is authentic and is authorized to access the service by requesting the central server to validate the access request from the subscriber device e.g. by sending a RADIUS Authorization Request message . For example message may be a RADIUS Authorization Request message that access node sends to central server which may include additional information in vendor specific attributes of the RADIUS access request that requests central server to assign a service node to which access node should establish a targeted LDP session. Upon validating an access request the central server responds to access node with a RADIUS protocol message directing the access node to accept the access request and establish a session enabling connectivity between the subscriber device and the service provider network for the requested service.

Access node may receive a reply message from central server in response to the request message indicating one of service nodes to which access node should establish a targeted LDP session for setting up a pseudowire for traffic associated with the new customer line. For example after validating the RADIUS Authorization Request message against user profile database not shown using the subscriber credentials central server may return a RADIUS Authorization Accept message that includes a vendor specific attribute VSA that specifies a particular service node such as service node B to which to establish a targeted LDP session. Vendor specific attributes are described in RFC 2865 referenced above.

Alternatively or additionally a service node may send a request message to central server requesting central server to assign a service node to which the access node should establish a targeted LDP session and central server may respond to the service node or directly to the access node with a reply message assigning one of service nodes to which the access node should establish the targeted LDP session. The service node may send the request in response to one or more triggering events such as the service node receiving a label mapping message from the access node attempting to establish a targeted LDP session with that service node. In some examples the access node may select the nearest service node but this service node may send a request to the central server to assign a service node potentially the same or a different service node that is appropriate in view of the service information in service selection database .

Central server may check service selection database in response to receiving the request message from access node or a service node and central server may determine that service node B should be assigned as the service node to which access node should establish the targeted LDP session. For example central server may determine which service node to assign based on requirements of particular services to be applied to the subscriber traffic which may have been specified in the request message . For example if a given service is needed for a particular amount of subscriber traffic then central server will assign a service node capable of providing the given service and having the required capacity.

If access node does not already have a targeted LDP session established with the assigned service node B access node can initiate establishment of targeted LDP session with service node B after receiving the message indicating the assigned service node. Once established access node and service node B may send and receive periodic targeted Hello messages with each other. Access node may allocate a pseudowire label for a pseudowire and send a label binding to service node B in a label mapping message over targeted LDP session . Service node B receives the label mapping message and decodes the pseudowire label from the label mapping message.

In some examples in response to detecting one of various potential triggering events such as receiving a label mapping message with the pseudowire label from the access node service node B may check with central server to determine a particular internal forwarding component of service node B to which to anchor the pseudowire e.g. by sending a request message to central server . Service node B is a RADIUS client configured to communicate with central server as a RADIUS server for the service provider network using the RADIUS protocol and service node B confirms that the subscriber device is authentic and is authorized to access the service by requesting central server to validate the access request from the subscriber device e.g. by sending a RADIUS Authorization Request message . For example message may be a RADIUS Authorization Request message that service node B sends to central server which may include additional information in vendor specific attributes of the RADIUS access request that requests central server to assign a particular internal forwarding component of service node B to which service node B should anchor the pseudowire. Upon validating an access request central server responds to service node B with a RADIUS protocol message directing service node B to accept the access request and anchor pseudowire between access node and service node B to the assigned forwarding component of service node B for enabling connectivity between the subscriber device and the service provider network for the requested service.

Service node B may receive a reply message from central server in response to the request message indicating one of multiple packet forwarding engines PFEs of service node B to which service node B should anchor a pseudowire for traffic associated with the new customer line. For example after validating the RADIUS Authorization Request message against user profile database not shown using the subscriber credentials central server may return a RADIUS Authorization Accept message that includes a vendor specific attribute VSA that specifies a particular PFE of service node B to use.

For example central server may check service selection database in response to receiving the request message from service node B and central server may determine that a particular forwarding component of service node B should be assigned as the forwarding component to which service node B should anchor the pseudowire. For example central server may determine which internal forwarding component to assign based on requirements of particular services to be applied to the subscriber traffic which may have been specified in the request message . For example if a given service is needed for a particular amount of subscriber traffic then central server will assign a forwarding component capable of providing the given service and having the required capacity.

After determining an internal PFE to which to anchor the pseudowire being established service node B also allocates a pseudowire label for the pseudowire and sends a label binding to access node in a label mapping message over targeted LDP session . Access node receives the label mapping message and decodes the pseudowire label from the label mapping message. In this manner access node and service node B establish pseudowire .

In some examples gateway modifies packets of packet flows as the gateway steers the packets into appropriate service chains. For example gateway may prepend to each subscriber packet a traffic engineering header or label e.g. an additional IP header or MPLS label to form a tunnel packet in which the subscriber packet is encapsulated as a payload. At this time gateway selects the particular traffic engineering header based on the particular subscriber and more specifically selects the service chain to which the particular type of packet flow for the given subscriber is assigned. In other words the processing of subscriber packet flows by gateway to steer the packet flows may in some examples be session aware i.e. based on the particular subscriber from which the packet flow originated and may also be based on characteristics of the packet flow itself e.g. type of flow e.g. VoIP HTTP etc .

In this way in some example aspects the techniques described herein can allow access node and service nodes to leverage the authorization process performed between themselves and central server to obtain intelligent assignment of service resources. Different example embodiments may be implemented. For example in some aspects access node and or service nodes may access service selection database directly and make service allocation decisions based on the service resource information aggregated there by central server .

The techniques of this disclosure can provide a mechanism to model data model format the service resources available on a service node . This may turn into more detailed requirements depending on the type of service. A BNG may use Point to Point Protocol over Ethernet PPPoE or Dynamic Host Configuration Protocol DHCP for example. In some examples service nodes include some local logic upon having visibility of a Service Selection Database which determines which service resource to use. In some examples this could be based on just a local database of the service node as the PFE selection is an intra SN decision.

In some examples access node includes some local logic to decide upon having visibility of the Service Selection Database network wide which determines which service node to use. In some examples central server makes decisions on the appropriate service resource to use decisions on re optimization balancing and so on and central server may either interface with a separate AAA server not shown upon receiving requests or upon requests directly from an access node or service node by some other interface e.g. a communications protocol such as Extensible Messaging and Presence Protocol XMPP for example.

To achieve the zero touch goal for a subscriber to be served there is more logical infrastructure that needs to be created. A targeted LDP session may provide a transport LSPs between AN and SN. In other examples a transport LSP may be set up using RSVP TE and some explicit actions may be required to keep the zero touch. If pseudowire signaling sessions are based on BGP and there are route reflectors this may become just a one time issue network wide however if targeted LDP is used this requires an LDP session for every AN SN pair that requires pseudowires so this may require some relevant configuration effort and therefore some additional intelligence may be required to keep the network zero touch. Customer traffic flows inside pseudowires between AN and SN and some explicit configuration signaling is required for them to be activated. It is therefore necessary to embed some additional intelligence for the pseudowires to be created with a zero touch approach.

Based on FIB forwarding component in the data plane forwards packets received from inbound links A N to outbound links A N that correspond to next hops associated with destinations of the packets. U.S. Pat. No. 7 184 437 provides details on an exemplary embodiment of a router that utilizes a radix tree for route resolution. The entire contents of U.S. Pat. No. 7 184 437 are incorporated herein by reference.

In one example forwarding component is a rich and dynamic shared forwarding plane optionally distributed over a multi chassis router. Moreover forwarding component may be provided by dedicated forwarding integrated circuits normally associated with high end routing components of a network router.

Routing component in the control plane primarily provides an operating environment for one or more control plane protocols . In the example of protocols include Multiprotocol Label Switching MPLS protocols for allocation and distribution of labels for the LSPs such as LDP A and RSVP TE B. In some examples RSVP TE may generate and maintain a traffic engineering database TED including bandwidth reservations for paths associated with MPLS LSPs. Constrained Shortest Path First CSPF process may compute a shortest path or paths for an MPLS LSP based on specified constraints and bandwidth availability information associated with the links within the network. As another example Label Distribution Protocol LDP A may send and receive label mapping messages for establishing a LSP.

In the example of access node has a reduced control plane that does not execute a routing protocol such as an interior gateway protocol IGP or Border Gateway Protocol BGP . In some examples routing component may generate and program forwarding component with FIB that associates network destinations with specific next hops and corresponding interfaces ports of IFCs . Routing component may generate FIB in the form of a radix tree having leaf nodes that represent destinations within the network for example. In other examples forwarding component may receive updates to FIB and label FIB LFIB from a central controller such as an SDN controller.

Access node is capable to retrieve for a user ingress interface upon initial reception of traffic an indication of what access node should do with the traffic. Service resource selection module may in some examples include logic to decide which service node to use. For example service resource selection module may decide which of service nodes to use based on information accessed at service selection database . In other examples service resource selection module receives information specifying which service node to use from a central server such as central server .

If the architecture used in the service provider network includes zero touch functionality for access node there would be an additional set of requirements for the access node as access node would need to react upon new lines provisioned or traffic coming from the subscriber triggering both the creation of the interfaces as well as the signaling of the LDP sessions and or pseudowire if necessary towards the right Service Node. Thus in accordance with the techniques of this disclosure access node may include zero touch functionality such as VLAN interface authentication into AAA via central server upon receipt of subscriber packet retrieving from the central server indication of the right Service Node to connect to the capability to auto initiate LDP sessions and the capability to auto initiate pseudowires.

Upon initially receiving subscriber traffic for example access node can create a VLAN apply a particular Quality of Service QoS profile and initiate set up of a targeted LDP session and pseudowire or use an existing pseudowire if available. Service resource selection module can request from a RADIUS server or from another centralized element such as central server an indication of the specific service node to which access node should set up the pseudowire based on certain constraints. Example constraints may include Expected bandwidth for the pseudowire Expected number of users sessions when applicable PPPOE DHCP Max latency acceptable Type of redundancy required e.g. stateful stateless intra chassis inter chassis and Backup Service Node. For example service resource selection module may send a RADIUS authentication message that includes these constraints in vendor specific attributes VSAs . Service resource selection module may receive from central server a RADIUS message in reply confirming subscriber authentication and specifying a service node to use in VSAs.

In one embodiment forwarding component may comprise one or more dedicated processors hardware and or computer readable media storing instructions to perform the techniques described herein. The architecture of access node illustrated in is shown for example purposes only. In other embodiments access node may be configured in a variety of ways. In one embodiment for example control unit and its corresponding functionality may be distributed within IFCs .

Control unit may be implemented solely in software or hardware or may be implemented as a combination of software hardware or firmware. For example control unit may include one or more processors which execute software instructions. In that case the various software modules of control unit may comprise executable instructions stored on a computer readable medium such as computer memory or hard disk.

In the example of service node includes control unit in which routing component provides control plane functionality for service node . Service node also includes a plurality of packet forwarding engines A N PFEs and a switch fabric that collectively provide a data plane for forwarding network traffic. PFEs receive and send data packets via interface cards IFCs . In other embodiments each of PFEs may comprise more or fewer IFCs. Although not shown PFEs may each comprise a central processing unit CPU and a memory. In this example routing component is connected to each of PFEs by a dedicated internal communication link . For example dedicated link may comprise a Gigabit Ethernet connection. Switch fabric provides a high speed interconnect for forwarding incoming data packets between PFEs for transmission over a network. U.S. Patent Application 2008 0044181 entitled MULTI CHASSIS ROUTER WITH MULTIPLEXED OPTICAL INTERCONNECTS describes a multi chassis router in which a multi stage switch fabric such as a 3 stage Clos switch fabric is used as a high end forwarding plane to relay packets between multiple routing nodes of the multi chassis router. The entire contents of U.S. Patent Application 2008 0044181 are incorporated herein by reference.

Routing component provides an operating environment for execution of various protocols that may comprise software processes having instructions executed by a computing environment. As described in further detail below protocols provide control plane functions for storing network topology in the form of routing tables or other structures executing routing protocols to communicate with peer routing devices and maintain and update the routing tables and providing management interface s to allow user access and configuration of service node . Control unit provides an operating environment for routing component and may be implemented solely in software or hardware or may be implemented as a combination of software hardware or firmware. For example control unit may include one or more processors which execute software instructions. In that case routing component may include various software modules or daemons e.g. one or more routing protocol processes user interfaces and the like and control unit may include a computer readable storage medium such as computer memory or hard disk for storing executable instructions.

Command line interface daemon CLI provides an interface by which an administrator or other management entity may modify the configuration of service node using text based commands. Simple Network Management Protocol daemon SNMP comprises an SNMP agent that receives SNMP commands from a management entity to set and retrieve configuration and management information for service node . Using CLI and SNMP one or more management entities may enable disable and configure services install routes enable disable and configure rate limiters and configure interfaces for example.

One or more routing protocols such as IGP maintains routing information in the form of routing information base RIB that describes a topology of a network and derives a forwarding information base FIB in accordance with the routing information. In general the routing information represents the overall topology of the network. IGP interacts with kernel e.g. by way of API calls to update RIB based on routing protocol messages received by service node . RIB may include information defining a topology of a network including one or more routing tables and or link state databases. Typically the routing information defines routes i.e. series of next hops through a network to destinations prefixes within the network learned via a distance vector routing protocol e.g. BGP or defines the network topology with interconnected links learned using a link state routing protocol e.g. IS IS or OSPF . In contrast FIB is generated based on selection of certain routes within the network and maps packet key information e.g. destination information and other select information from a packet header to one or more specific next hops and ultimately to one or more specific output interface ports of IFCs . Routing component may generate the FIB in the form of a radix tree having leaf nodes that represent destinations within the network. Details on an example embodiment of a router that utilizes a radix tree for route resolution are provided in U.S. Pat. No. 7 184 437 the entire contents of which are incorporated herein by reference.

Routing component also provides an operating environment of one or more traffic engineering protocols to establish tunnels for forwarding subscriber packets through the ordered set of service nodes associated with different service chains. For example RSVP TE may execute the Resource Reservation Protocol with Traffic Engineering extensions to exchange traffic engineering TE information such as MPLS labels for enabling label based packet forwarding. As another example routing component may use GRE or IP based tunneling protocols to establish traffic engineered tunnels. Routing component may maintain for example a traffic engineering database TED to store the traffic engineering data.

Routing component communicates data representative of a software copy of the FIB into each of PFEs to control forwarding of traffic within the data plane. This allows the software FIB stored in memory e.g. RAM in each of PFEs to be updated without degrading packet forwarding performance of service node . In some instances routing component may derive separate and different software FIBs for each respective PFEs . In addition one or more of PFEs include application specific integrated circuits ASICs that PFEs program with a hardware copy of the FIB based on the software FIBs i.e. hardware versions of the software FIBs copied to each respective PFE .

For example kernel executes on master microprocessor and may comprise for example a UNIX operating system derivative such as Linux or Berkeley Software Distribution BSD . Kernel processes kernel calls from IGP and RSVP TE to generate forwarding information in the form of FIB based on the network topology represented in RIB i.e. performs route resolution and path selection. Typically kernel generates FIB in the form of radix or other lookup trees to map packet information e.g. header information having destination information and or a label stack to next hops and ultimately to interface ports of interface cards associated with respective PFEs . FIB may associate for example network destinations with specific next hops and corresponding IFCs . For MPLS related traffic forwarding FIB stores for a given FEC label information that includes an incoming label an outgoing label and a next hop for a packet.

Master microprocessor executing kernel programs PFEs to install copies of the FIB . Microprocessor may comprise one or more general or special purpose processors such as a digital signal processor DSP an application specific integrated circuit ASIC a field programmable gate array FPGA or any other equivalent logic device. Accordingly the terms processor or controller as used herein may refer to any one or more of the foregoing structures or any other structure operable to perform techniques described herein.

In this example ASICs are microcode controlled chipsets i.e. forwarding circuits programmably configured by a slave microprocessor executing on each of PFEs . When forwarding packets control logic with each ASIC traverses the forwarding information FIB received from routing component and upon reaching a FIB entry for the packet e.g. a leaf node microcode implemented control logic automatically selects a forwarding next hop and processes the packets in accordance with the operations defined within the next hop. In this way ASICs of PFEs process packets by performing a series of operations on each packet over respective internal packet forwarding paths as the packets traverse the internal architecture of service node . Operations may be performed for example on each packet based on any of a corresponding ingress interface an ingress PFE an egress PFE an egress interface or other components of service node to which the packet is directed prior to egress such as one or more service cards. PFEs each include forwarding structures that when executed examine the contents of each packet or another packet property e.g. incoming interface and on that basis make forwarding decisions apply filters and or perform accounting management traffic analysis and load balancing for example.

In one example each of PFEs arranges forwarding structures as next hop data that can be chained together as a series of hops along an internal packet forwarding path for the network device. In many instances the forwarding structures perform lookup operations within internal memory of ASICs where the lookup may be performed against a tree or trie search a table or index search. Other example operations that may be specified with the next hops include filter determination and application or a rate limiter determination and application. Lookup operations locate within a lookup data structure e.g. a lookup tree an item that matches packet contents or another property of the packet or packet flow such as the inbound interface of the packet. The result of packet processing in accordance with the operations defined by the next hop forwarding structure within ASICs determines the manner in which a packet is forwarded or otherwise processed by PFEs from its input interface on one of IFCs to its output interface on one of IFCs .

In general kernel may generate FIB and thereby program ASICs to store forwarding structures associated with each service chain. For example ASICs may be configured with forwarding information that specifies traffic engineering information such as IP header information or MPLS labels as well as operations for causing programmable ASICs to encapsulate subscriber packets in accordance with the forwarding information. In this way ASICs may process subscriber packets to select particular service paths for each packet and encapsulate the subscriber packets in accordance with the selected service paths. Routing component may generate RIB and FIB to associate subscriber packet flows with particular service paths based on one or more service profiles associated with each subscriber as may be received from an Authentication Authorization and Accounting AAA server a policy controller SDN controller or other network element.

Services A N services applied by PFEs respectively may include one or more services such as firewall and security services carrier grade network address translation CG NAT media optimization voice video Internet Protocol Security IPSec or Virtual Private Network VPN services deep packet inspection DPI hypertext transport protocol HTTP filtering counting accounting charging and or load balancing of packet flows or other types of services applied to network traffic.

Service resource selection module and BGP TE module coordinate to advertise service resource information to the SSD such as information about capacity of PFEs and identification of services provided by the different ones PFEs . For example service resource selection module may advertise information such as a number of queues maintained by PFEs an amount of available memory of PFES and other metrics that relate to the availability and capacity of PFEs for application of services to subscriber traffic. Control unit also executes BGP TE module to peer with BGP speakers and BGP listeners to exchange routing information including SSD NLRI in accordance with techniques described herein. That is routing component executes BGP TE module to advertise service resource information about the service node such as by using an SSD NLRI in attributes e.g. MP REACH NLRI of BGP UPDATE messages . BGP TE module may refresh this information at the SSD at a configured time interval by sending a new BGP update message and or may send a new BGP update message when there has been some change in availability of PFE resources e.g. due to a new reservation being made .

In some examples service node may be configured for Targeted LDP session auto sensing i.e. to set up an LDP session without local configuration upon reception of LDP session request signaling messages. LDP module can receive an LDP label mapping message from an access node sent to initiate establishment of a targeted LDP session. Alternatively RSVP TE module can receive a RESV request for setting up an RSVP TE LSP. As described herein the creation of the targeted LDP session or other LSP may trigger some Authentication Authorization and Accounting AAA process where the session is authenticated and the appropriate parameters attributes received from central server using new service resource VSAs. LDP module or RSVP TE module can communicate with service resource selection module to initiate sending a RADIUS message as described herein.

As described herein service node may be configured for LDP pseudowire auto sensing i.e. to set up a pseudowire without local configuration upon reception of the pseudowire request signaling messages within an established LDP session. For example service node may be configured for triggering the creation on the local side of the pseudowire based on the received pseudowire signaling packets. The received pseudowire signaling packets may indicate a pseudowire identifier PW id and an IP address of the requesting access node. As described herein the creation of a pseudowire may be based on some AAA process where the pseudowire is authenticated and the appropriate parameters attributes received from central server using new VSAs.

In accordance with the techniques described herein service resource selection module is capable to upon reception of a signaling request either for a LDP session or a pseudowire send a message requesting information from the central server as to what the service node should do with the request. For example service resource selection module may query the central server via a RADIUS message for instructions to authenticate and create an LDP session or instructions to authenticate and create pseudowires upon reception of signaling requests from an access node. Service resource selection module may build the RADIUS message using information contained in the pseudowire signaling message such as the PW id.

In response to the RADIUS request message service resource selection module may receive instructions specifying a PFE to which service node should anchor a pseudowire and service characteristics e.g. whether to provide redundancy . The central server s RADIUS LDAP feature may have access to information about how many subscriber devices are behind an OLT or DSLAM access node and so the central server knows how many subscribers are likely to be able to send traffic through the pseudowire and can load balance the requests appropriately across different PFEs for example. After anchoring the pseudowire to a given PFE according to the instructions received from the central server service resource selection module can then update the service resources available and expose the updated information to the rest of the network e.g. via extended BGP .

In some examples service resource selection module may itself include logic to decide which service resource to use. For example service resource selection module may decide which of PFEs to use based on information accessed at service selection database . In some examples service resource selection module may maintain an internal data structure not shown indicating service resource information about PFEs and services and may use this for determining which PFE to use. In other examples as described above service resource selection module receives information specifying which service resource to use e.g. which of PFEs from a central server such as central server .

In some examples service node may use the techniques described herein in the context of service chaining. For example service node may receive from central server an indication of a next service node to which to set up another pseudowire and the process may repeat for each service node and service in the service chain.

The architecture of service node illustrated in is shown for example purposes only. This disclosure is not limited to this architecture. In other examples service node may be configured in a variety of ways. In one example some of the functionally of control unit may be distributed within IFCs . Control unit may be implemented solely in software or hardware or may be implemented as a combination of software hardware or firmware. For example control unit may comprise one or more of a processor a programmable processor a general purpose processor an integrated circuit an Application Specific Integrated Circuit ASIC a Field Programmable Gate Array FPGA or any type of hardware unit capable of implementing the techniques described herein. Control unit may further include one or more processors which execute software instructions stored on a computer readable storage medium such as random access memory RAM read only memory ROM programmable read only memory PROM erasable programmable read only memory EPROM electronically erasable programmable read only memory EEPROM non volatile random access memory NVRAM flash memory a hard disk a CD ROM a floppy disk a cassette magnetic media optical media or other computer readable storage media. In some instances the computer readable storage medium may include instructions that cause a programmable processor to perform the techniques described herein.

Central server includes a control unit coupled to a network interface to exchange packets with other network devices by inbound link and outbound link . Control unit may include one or more processors not shown in that execute software instructions such as those used to define a software or computer program stored to a computer readable storage medium again not shown in such as non transitory computer readable mediums including a storage device e.g. a disk drive or an optical drive or a memory such as Flash memory or random access memory RAM or any other type of volatile or non volatile memory that stores instructions to cause the one or more processors to perform the techniques described herein. Alternatively or additionally control unit may comprise dedicated hardware such as one or more integrated circuits one or more Application Specific Integrated Circuits ASICs one or more Application Specific Special Processors ASSPs one or more Field Programmable Gate Arrays FPGAs or any combination of one or more of the foregoing examples of dedicated hardware for performing the techniques described herein.

Control unit provides an operating environment for network services applications path computation element RADIUS module LDAP module BGP TE module and service resource module . In one example these modules may be implemented as one or more processes executing on one or more virtual machines of one or more servers. That is while generally illustrated and described as executing on a single central server aspects of these modules may be delegated to other computing devices.

Network services applications represent one or more processes that provide services to clients of a service provider network that includes central server to manage connectivity in an aggregation domain alternatively referred to as the path computation domain according to techniques of this disclosure. Network services applications may provide for instance include Voice over IP VoIP Video on Demand VOD bulk transport walled open garden IP Mobility Subsystem IMS and other mobility services and Internet services to clients of the service provider network. Network services applications use services provided by path computation element such as node management session management and policy enforcement. Each of network services applications may include client interface by which one or more client applications request services. Client interface may represent a command line interface CLI or graphical user interface GUI for instance. Client may also or alternatively provide an application programming interface API such as a web service to client applications.

Network services applications issue path requests to path computation element to request paths in a path computation domain controlled by central server . For example a path request may include a required bandwidth or other constraint and two endpoints representing an access node and an edge node or service node that communicate over the path computation domain managed by central server . Path requests may further specify time date during which paths must be operational and CoS parameters for instance bandwidth required per class for certain paths .

Path computation element accepts path requests from network services applications to establish paths between the endpoints over the path computation domain. Paths may be requested for different times and dates and with disparate bandwidth requirements. Path computation element reconciling path requests from network services applications to multiplex requested paths onto the path computation domain based on requested path parameters and anticipated network resource availability.

To intelligently compute and establish paths through the path computation domain path computation element includes topology module to receive topology information describing available resources of the path computation domain including access aggregation and edge nodes interfaces thereof and interconnecting communication links.

Path computation module of path computation element computes requested paths through the path computation domain. In general paths are unidirectional. Upon computing paths path computation module schedules the paths for provisioning by path provisioning module . A computed path includes path information usable by path provisioning module to establish the path in the network. Provisioning a path may require path validation prior to committing the path to provide for packet transport.

Control unit also executes Border Gateway Protocol with Traffic Engineering extensions BGP TE module to peer with BGP speakers and BGP listeners to exchange routing information including service selection data SSD NLRI in accordance with techniques described herein. BGP TE module receives advertised service resource information in BGP UPDATE messages issued by BGP peers that incorporate the SSD NLRI capability described herein. BGP TE module decodes SSD NLRI and stores service resource information from the SSD NLRI to service selection database . BGP TE module and BGP peers may perform a capability exchange e.g. mutual advertisement as part of the peering process to determine respective SSD NLRI capabilities of the BGP peers.

Network service providers typically deploy one or more servers to manage authentication authorization and accounting AAA functionality for networks that offer services to one or more subscribers. The protocol most commonly used by the servers to communicate with clients is the Remote Authentication Dial In User Service RADIUS protocol. In the example of AAA functionality may be incorporated in central server in the form of authorization module which maintains a user profile database . User profile database may include for example subscriber login credentials and other user profile information for subscribers. In other examples central server may not include AAA functionality but may request AAA operations from an external AAA server.

Upon receipt of a RADIUS Authorization Request message e.g. received from an access node or a service node authorization module confirms that subscriber device is authentic and is authorized to access the service with reference to user profile database . Upon validating an access request the RADIUS server responds to the requesting device with a RADIUS protocol message directing the requesting device to accept the access request and establish a session or pseudowire enabling connectivity between the subscriber device and the service provider network for the requested service. For example after validating the RADIUS Authorization Request message against user profile database using the subscriber credentials authorization module returns a RADIUS Authorization Accept message that includes a vendor specific attribute VSA that specifies which service resource to use e.g. which service node or PFE . Service resource module may determine which service resource to use based on service selection database . In some examples service selection database may be external to central server . Authorization module may cooperate with service resource module to determine what service resource information to include within the VSAs of the reply message.

A routing protocol such as BGP TE module executes on central server to establish a BGP peering session with a BGP speaker e.g. another network device such as one of service nodes of . As part of establishing the BGP peering session BGP TE module and the BGP speaker may exchange an SSD NLRI capability value to indicate to one another a mutual ability to originate and or receive SSD NLRI in BGP UPDATE messages .

BGP TE module receives from the BGP speaker in the BGP peering session a BGP UPDATE message that includes an SSD NLRI . BGP TE module decodes the SSD NLRI to identify service resource information such as information about the service node including characteristics of one or more forwarding components of the service node for example. BGP TE module installs the service resource information to service selection database . Subsequently central server receives a request for service assignment which may be included in an authentication request e.g. a RADIUS message . The request may specify requirements of the subscriber traffic to be serviced such as particular services required to be applied to the subscriber traffic amount of subscriber traffic expected and the like. In response to receiving the request service resource module checks service selection database and determines based on the service resource information of service selection database a service resource to assign that satisfies the requirements of the request . For example service resource module can assign a particular service node or PFE within a service node that is capable of providing the particular services needed for the subscriber traffic. Service resource module then sends a reply providing information regarding the determined service resource in response to the request . The information may include a destination address for a service node or a PFE for example.

When the access node detects that a new resource has been provisioned e.g. a new subscriber line or OLT the access node may send a request to a central server to request an assignment of which service node in the network to use for the newly provisioned resource . In some examples the request may indicate one or more constraints for the service node requested. The central server receives this request for a service node assignment and checks the SSD to determine which service node to assign based at least in part on the constraints indicated in the request . The central server selects the service node based on the SSD and the indicated constraints . In some examples the central server may use a selection algorithm that takes into account the various constraints and characteristics of the candidate service nodes. The central server sends a message that includes an indication of the assigned service node to the access node . In some examples the message also includes information for the access node to use in setting up a targeted LDP session. The central server may update the SSD based on the assignment of the service node. The access node receives the message from the central server and initiates setup of the targeted LDP session with the assigned service node based on the information in the message from the central server .

The service node sends a routing protocol advertisement to the SSD with service resource information associated with the service node . For example the routing protocol advertisement may be a BGP advertisement where BGP has been extended to allow for advertising service resource information. The service resource information may include information about one or more PFEs of the service node for example. At some point the service node receives a request from an access node for a targeted LDP session . In response to receiving the request the service node sends a message to the central server requesting assignment of a service node for the targeted LDP session . The message may be an authentication message e.g. in accordance with the RADIUS protocol that also requests subscriber authentication. The service node receives from the central server a message e.g. a RADIUS message including a VSA with service resource information for the targeted LDP session to be created . In some examples the RADIUS message may be an authentication reply message that confirms subscriber authentication and also includes a VSA specifying the service resource information. The central server may assign the requesting service node or a different service node. If the central server assigns the requesting service node then that service node can then proceed to complete setup of the targeted LDP session with the access node such as by sending an LDP label mapping message to the access node . The label mapping message may be generated based on information that was specified in the RADIUS VSA received from the central server. If a service node other than the requesting service node is assigned then the central server may send a reply message directly to the access node with information for the targeted LDP session to be created.

The service node may also receive a request from the access node to establish a pseudowire with a service node . In response to receiving the request from the access node in some examples the service node may send an inquiry to the central server to learn the PFE of the service node to which the service node should anchor the pseudowire . The service node may receive a RADIUS message having a VSA indicating which PFE the service node should use for anchoring the pseudowire . The service node can then proceed to complete establishment of the pseudowire between the PFE and the access node such as by sending a communication to the access node .

The techniques described in this disclosure may be implemented at least in part in hardware software firmware or any combination thereof. For example various aspects of the described techniques may be implemented within one or more processors including one or more microprocessors digital signal processors DSPs application specific integrated circuits ASICs field programmable gate arrays FPGAs or any other equivalent integrated or discrete logic circuitry as well as any combinations of such components. The term processor or processing circuitry may generally refer to any of the foregoing logic circuitry alone or in combination with other logic circuitry or any other equivalent circuitry. A control unit comprising hardware may also perform one or more of the techniques of this disclosure.

Such hardware software and firmware may be implemented within the same device or within separate devices to support the various operations and functions described in this disclosure. In addition any of the described units modules or components may be implemented together or separately as discrete but interoperable logic devices. Depiction of different features as modules or units is intended to highlight different functional aspects and does not necessarily imply that such modules or units must be realized by separate hardware or software components. Rather functionality associated with one or more modules or units may be performed by separate hardware or software components or integrated within common or separate hardware or software components.

The techniques described in this disclosure may also be embodied or encoded in a computer readable medium such as a computer readable storage medium containing instructions. Instructions embedded or encoded in a computer readable medium may cause a programmable processor or other processor to perform the method e.g. when the instructions are executed. Computer readable media may include non transitory computer readable storage media and transient communication media. Computer readable storage media which is tangible and non transitory may include random access memory RAM read only memory ROM programmable read only memory PROM erasable programmable read only memory EPROM electronically erasable programmable read only memory EEPROM flash memory a hard disk a CD ROM a floppy disk a cassette magnetic media optical media or other computer readable storage media. It should be understood that the term computer readable storage media refers to physical storage media and not signals carrier waves or other transient media.

Various aspects of this disclosure have been described. These and other aspects are within the scope of the following claims.

