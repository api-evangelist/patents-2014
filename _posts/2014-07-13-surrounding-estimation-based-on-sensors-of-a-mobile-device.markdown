---

title: Surrounding estimation based on sensors of a mobile device
abstract: Techniques are disclosed for estimating a surrounding in which a mobile device is situated based on sensors of the mobile device. The sensors can be typical sensors currently existing on mobile devices and not dedicated for surrounding detection purposes. One embodiment includes a method which comprises retrieving a weather condition from a remote server; deriving, based on the weather condition, a plurality of weights for sensors on the mobile device; applying each weight to an output of a corresponding sensor on the mobile device; and determining whether the mobile device is likely to be indoor or outdoor based on one or more weighted outputs from the sensors. Among other advantages, embodiments disclosed herein increased accuracy to estimate the mobile device's surrounding without the need of dedicated sensors or other modification to mobile network infrastructures, thereby providing the benefit of surrounding sensing without incurring the cost.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09326097&OS=09326097&RS=09326097
owner: Seven Networks, LLC
number: 09326097
owner_city: Marshall
owner_country: US
publication_date: 20140713
---
Because mobile devices such as smartphones or tablet computers often operate on limited amount of battery power it is desirable to detect a surrounding in which the mobile devices are situated. The information regarding the mobile devices surrounding can help service operators e.g. a telephone service company a third party company or other suitable entities and software applications analyze as well as enhance the effectiveness of their behaviors.

Conventional approaches rely on dedicated devices to assist with surrounding detection. However the deployment cost of such infrastructure based approaches significantly limits the flexibility and scalability for general purpose detection.

According to one or more embodiments a method for sensing a surrounding of a mobile device is provided. The method includes requesting a weather condition that is received from a remote server deriving based on the weather condition a plurality of weights for sensors on the mobile device applying each weight to an output of a corresponding sensor on the mobile device and determining whether the mobile device is likely to be indoor or outdoor based on one or more weighted outputs from the sensors.

According to one or more embodiments determining whether the mobile device is indoor or outdoor is based on more than one weighted outputs from the sensors.

According to one or more embodiments the method includes detecting whether the mobile device is in motion and adjusting a timing for determining whether the mobile device is indoor or outdoor based on whether a location change of the mobile device exceeds a threshold.

According to one or more embodiments detecting whether the mobile device is in motion includes using an accelerometer to detect if a user of the mobile device has traveled a predetermined number of steps within a given time period.

According to one or more embodiments the method includes if the user of the mobile device has traveled a predetermined number of steps within a given time period using a global positioning satellite GPS receiver to determine how many satellites signals can be received by the GPS receiver and determining that the mobile device is likely to be indoor if a number of satellites with receivable signals is below a threshold.

According to one or more embodiments detecting whether the mobile device is in motion includes using wireless network circuitry on the mobile device to estimate the mobile device is changing location.

According to one or more embodiments the wireless network circuitry comprises a wireless telephony circuit and a wireless local area network WLAN circuit.

According to one or more embodiments the sensors includes a light sensor and the method includes statistically calculating a background light intensity from the light sensor. The statistical calculating is based on the plurality of weights derived based on the weather condition determining that the mobile device is likely to be indoor if the background light intensity is below a first number and determining that the mobile device is likely to be outdoor if the background light intensity is above a second number.

According to one or more embodiments the sensors include a temperature sensor and determining whether the mobile device is likely to be indoor or outdoor further includes statistically calculating a background temperature from the temperature sensor where the statistical calculating is based on the plurality of weights derived based on the weather condition and determining that the mobile device is likely to be indoor if the background temperature is above a first number and determining that the mobile device is likely to be outdoor if the background temperature is below a second number.

According to one or more embodiments the sensors include a proximity sensor the method includes using the proximity sensor to detect whether the mobile device is in condition a a pocket of a user or b in close proximity to the user s body so as to affect the outputs from the sensors and if the mobile device is in a or b condition excluding outputs from a light sensor and a temperature sensor from the determining process.

According to one or more embodiments the sensors include a wireless local area network WLAN circuit and determining further includes measuring a received signal strength indication RSSI number using the WLAN circuit determining that the mobile device is likely to be indoor if the RSSI number is above a first number and determining that the mobile device is likely to be outdoor if the RSSI number is below a second number.

According to one or more embodiments the sensors comprise a battery status sensor to retrieve a charging state of a battery of the mobile device and the method further includes adjusting the plurality of weights based on the charging state.

According to one or more embodiments adjusting of the plurality of weights includes decreasing a background temperature as being statistically calculated from a temperature sensor so as to compensate for a temperature increase caused by the mobile device s battery being charged or discharged.

According to one or more embodiments a mobile device that senses its surrounding is provided. The mobile device includes a processor and a memory coupled to the processor and storing instructions thereon which when executed by the processor cause the processor to perform steps including requesting a weather condition that is received from a remote server deriving based on the weather condition a plurality of weights for sensors on the mobile device applying each weight to an output of a corresponding sensor on the mobile device and determining whether the mobile device is likely to be indoor or outdoor based on one or more weighted outputs from the sensors.

The same reference numbers and any acronyms identify elements or acts with the same or similar structure or functionality throughout the drawings and specification for ease of understanding and convenience.

Techniques are disclosed for estimating a surrounding in which a mobile device is situated based on sensors of the mobile device. The sensors can be typical sensors currently existing on mobile devices and not dedicated for surrounding detection purposes. One embodiment includes a method which comprises retrieving a weather condition from a remote server and deriving based on the weather condition a plurality of weights for sensors on the mobile device. The method further comprises applying each weight to an output of a corresponding sensor on the mobile device and determining whether the mobile device is likely to be indoor or outdoor based on one or more weighted outputs from the sensors.

Among other advantages embodiments disclosed herein increase accuracy to estimate the mobile device s surrounding e.g. whether indoor or outdoor without the need of dedicated sensors or other modification to mobile network infrastructures thereby providing the benefit of surrounding sensing without incurring the cost.

The following description and drawings are illustrative and are not to be construed as limiting. Numerous specific details are described to provide a thorough understanding of the disclosure. However in certain instances well known or conventional details are not described in order to avoid obscuring the description. References to one or an embodiment in the present disclosure can be but not necessarily are references to the same embodiment and such references mean at least one of the embodiments.

Reference in this specification to one embodiment or an embodiment means that a particular feature structure or characteristic described in connection with the embodiment is included in at least one embodiment of the disclosure. The appearances of the phrase in one embodiment in various places in the specification are not necessarily all referring to the same embodiment nor are separate or alternative embodiments mutually exclusive of other embodiments. Moreover various features are described which may be exhibited by some embodiments and not by others. Similarly various requirements are described which may be requirements for some embodiments but not other embodiments.

The terms used in this specification generally have their ordinary meanings in the art within the context of the disclosure and in the specific context where each term is used. Certain terms that are used to describe the disclosure are discussed below or elsewhere in the specification to provide additional guidance to the practitioner regarding the description of the disclosure. For convenience certain terms may be highlighted for example using italics and or quotation marks. The use of highlighting has no influence on the scope and meaning of a term the scope and meaning of a term is the same in the same context whether or not it is highlighted. It will be appreciated that same thing can be said in more than one way.

Consequently alternative language and synonyms may be used for any one or more of the terms discussed herein nor is any special significance to be placed upon whether or not a term is elaborated or discussed herein. Synonyms for certain terms are provided. A recital of one or more synonyms does not exclude the use of other synonyms. The use of examples anywhere in this specification including examples of any terms discussed herein is illustrative only and is not intended to further limit the scope and meaning of the disclosure or of any exemplified term. Likewise the disclosure is not limited to various embodiments given in this specification.

Without intent to limit the scope of the disclosure examples of instruments apparatus methods and their related results according to the embodiments of the present disclosure are given below. Note that titles or subtitles may be used in the examples for convenience of a reader which in no way should limit the scope of the disclosure. Unless otherwise defined all technical and scientific terms used herein have the same meaning as commonly understood by one of ordinary skill in the art to which this disclosure pertains. In the case of conflict the present document including definitions will control.

The mobile device and server are coupled in communication for data transmission over the network . For example the components may be connected via a twisted pair cabling network a coax cable network a telephonic network or any suitable type of connection network. In some embodiments the network may be wireless. The technologies supporting the communications between the mobile device and server may include Ethernet and or other suitable types of area network technologies. One of ordinary skill in the art will understand that the components of are just one implementation of the computer network environment within which present embodiments may be implemented and the various alternative embodiments are within the scope of the present disclosure. For example the network may include intervening devices e.g. switches routers hubs etc. in the network . In some examples the network comprises the Internet. Depending on the embodiments mobile device can be connected directly to the server or via the network or both.

The weather server may be one or more server computers or work stations that are employed for hosting websites that provide weather information services such as weather forecast current weather and or historical weather for given geographical locations. The server typically includes at least one processor and a memory and may be further connected to one or more computers not shown in for simplicity that provide other weather related functions via the network . The mobile device which may be used by a customer user to communicate with the server in performing the surrounding estimation e.g. through the techniques disclosed herein may include a laptop a tablet a personal computer a personal digital assistant PDA a smart phone and the like. As said in some examples the server may be a host server that facilitates management of traffic content caching and or resource conservation e.g. the host server described in below or another server that is separate from the host server . Depending on the embodiments this separate server may be a portion of the host server or it may be hosted by a third party e.g. the weather server .

The mobile device typically includes a display not shown in for simplicity and may include suitable input devices not shown for simplicity such as a keyboard a mouse or a touchpad. In some embodiments the display may be a touch sensitive screen that includes input functionalities.

Sensors e.g. sensors A N are example sensors equipped on the mobile device . Sensors can provide typical or legacy sensing functionalities that are not dedicated to identify in which surrounding the mobile device is located such as light intensity room temperature a charging status of a battery on the mobile device global positioning satellite GPS signals accelerometer gyroscope and so forth. Sensors can also include hardware on the mobile device that is not primarily sensory in function such as wireless communication circuitry including wireless telephony circuits e.g. GPRS 3G HSPA or LTE and wireless local area network WLAN e.g. WiFi circuits. As used throughout the present disclosure the term dedicated sensor s refers to a sensor system dedicated to recognize which surrounding the mobile device is in for example the dedicated sensor system may require a companion sensor or an identifier that is not located within the mobile device so as to identify a surrounding.

As previously mentioned it is recognized in the present disclosure that although the conventional dedicated sensor s can fairly accurately recognize the surrounding they increase the cost to the mobile device e.g. by adding an additional hardware sensor on the device as well as to the infrastructure e.g. by installing those companion sensors or identifiers .

Accordingly the mobile device includes a surrounding evaluation engine which can determine detect the surrounding in which the mobile device is situated based on sensors on the mobile device . An example of the surrounding detection is whether the mobile device is indoor or outdoor. The sensors used for the disclosed techniques can be typical sensors on the mobile device which do not require additional infrastructure. Also because the disclosed techniques can be based on existing sensors on the mobile device the surrounding detection can be performed at the application layer and does not require an administrative privilege e.g. root admin or OEM integration to operate that is to say an application implementing the disclosed techniques can be easily installed by an end user thereby reducing the time and effort to deploy such application.

More specifically some embodiments of the surrounding evaluation engine include an indoor outdoor determination logic which can include a sensor output weighting module . The surrounding evaluation engine can receive the weather reports from the weather server . The surrounding evaluation engine also has pre evaluated sensor profiles which record how outputs from different sensors as present on the mobile device should be adjusted or weighted under various weather conditions in determining the mobile device s physical surrounding. The sensor profiles can be mobile device and or sensor specific. Based on the weather information and the pre evaluated sensor profiles the surrounding evaluation engine can use the output from various sensors for gathering defined weightages which are aggregated by the indoor outdoor determination logic to generate the best estimation of whether the mobile device is indoor or outdoor.

In one implementation the surrounding evaluation engine retrieves a weather condition from the weather server . Then the sensor output weighting module derives a plurality of weights for sensors on the mobile device based on the weather condition and applies each weight to an output of a corresponding sensor on the mobile device . Thereafter the indoor outdoor determination logic determines whether the mobile device is likely to be indoor or outdoor based on one or more weighted outputs from the sensors .

In some variations the surrounding evaluation engine detects whether the mobile device is in motion and the surrounding detection is only performed upon or after a location change of the mobile device . Among others this can increase the possibility that the detection generates meaningful results and avoid undesirable power drain. These and various other embodiments and implementations of the disclosed surrounding evaluation techniques are described in more details below.

The client devices can be any system and or device and or any combination of devices systems that is able to establish a connection including wired wireless cellular connections with another device a server and or other systems such as host server and or application server content provider . Client devices typically include a display and or other output functionalities to present information and data exchanged between among the devices and or the host server and or application server content provider . The application server content provider can by any server including third party servers or service content providers further including advertisement promotional content publication or electronic coupon servers or services. Similarly separate advertisement servers A promotional content servers B and or e Coupon servers C as application servers or content providers are illustrated by way of example.

For example the client devices can include mobile hand held or portable devices wireless devices or non portable devices and can be any of but not limited to a server desktop a desktop computer a computer cluster or portable devices including a notebook a laptop computer a handheld computer a palmtop computer a mobile phone a cell phone a smart phone a PDA a Blackberry device a Palm device a handheld tablet e.g. an iPad or any other tablet a hand held console a hand held gaming device or console any SuperPhone such as the iPhone and or any other portable mobile hand held devices or fixed wireless interface such as a M2M device etc. In one embodiment the client devices host server and application server are coupled via a network and or a network . In some embodiments the devices and host server may be directly connected to one another.

The input mechanism on client devices can include touch screen keypad including single touch multi touch gesture sensing in 2D or 3D etc. a physical keypad a mouse a pointer a track pad motion detector e.g. including 1 axis 2 axis 3 axis accelerometer etc. a light sensor capacitance sensor resistance sensor temperature sensor proximity sensor a piezoelectric device device orientation detector e.g. electronic compass tilt sensor rotation sensor gyroscope accelerometer or a combination of the above.

Signals received or detected indicating user activity at client devices through one or more of the above input mechanism or others can be used in the disclosed technology in acquiring context awareness at the client device . Context awareness at client devices generally includes by way of example but not limitation client device operation or state acknowledgement management user activity behavior interaction awareness detection sensing tracking trending and or application e.g. mobile applications type behavior activity operating state etc.

Context awareness in the present disclosure also includes knowledge and detection of network side contextual data and can include network information such as network capacity bandwidth traffic type of network connectivity and or any other operational state data and or mobile application loading and or activities. Network side contextual data can be received from and or queried from network service providers e.g. cell provider and or Internet service providers of the network and or network e.g. by the host server and or devices . In addition to application context awareness as determined from the client side the application context awareness may also be received from or obtained queried from the respective application service providers by the host and or client devices .

The host server can use for example contextual information obtained for client devices networks applications e.g. mobile applications application server provider or any combination of the above to manage the traffic in the system to satisfy data needs of the client devices e.g. to satisfy application or any other request including HTTP request . In one embodiment the traffic is managed by the host server to satisfy data requests made in response to explicit or non explicit user requests and or device application maintenance tasks. The traffic can be managed such that network consumption for example use of the cellular network is conserved for effective and efficient bandwidth utilization. In addition the host server can manage and coordinate such traffic in the system such that use of device side resources e.g. including but not limited to battery power consumption radio use processor memory use are optimized with a general philosophy for resource conservation while still optimizing performance and user experience.

For example in context of battery conservation the device can observe user activity for example by observing user keystrokes backlight status or other signals via one or more input mechanisms etc. and alters device behaviors. The device can also request the host server to alter the behavior for network resource consumption based on user activity or behavior.

In one embodiment the traffic management for resource conservation and or surrounding evaluation are performed using a distributed system between the host server and client device . The distributed system can include proxy server and cache components on the server side and on the device client side for example as shown by the server cache on the server side and the local cache on the client side.

Functions and techniques disclosed for context aware traffic management and or surrounding evaluation for resource conservation in networks e.g. network and or and devices can reside in a distributed proxy and cache system. The proxy and cache system can be distributed between and reside on a given client device in part or in whole and or host server in part or in whole. The distributed proxy and cache system are illustrated with further reference to the example diagram shown in . Notably in some embodiments of such systems the host server can include the server the application server can include the third party servers and or the mobile device can include the mobile device .

In one embodiment client devices communicate with the host server and or the application server over network which can be a cellular network and or a broadband network. To facilitate overall traffic management and or surrounding evaluation between devices and various application servers content providers to implement network bandwidth utilization and device resource e.g. battery consumption the host server can communicate with the application server providers over the network which can include the Internet e.g. a broadband network .

In general the networks and or over which the client devices the host server and or application server communicate may be a cellular network a broadband network a telephonic network an open network such as the Internet or a private network such as an intranet and or the extranet or any combination thereof. For example the Internet can provide file transfer remote log in email news RSS cloud based services instant messaging visual voicemail push mail VoIP and other services through any known or convenient protocol such as but is not limited to the TCP IP protocol UDP HTTP DNS FTP UPnP NSF ISDN PDH RS 232 SDH SONET etc.

The networks and or can be any collection of distinct networks operating wholly or partially in conjunction to provide connectivity to the client devices and the host server and may appear as one or more networks to the serviced systems and devices. In one embodiment communications to and from the client devices can be achieved by an open network such as the Internet or a private network broadband network such as an intranet and or the extranet. In one embodiment communications can be achieved by a secure communications protocol such as secure sockets layer SSL or transport layer security TLS .

In addition communications can be achieved via one or more networks such as but are not limited to one or more of WiMax a Local Area Network LAN Wireless Local Area Network WLAN a Personal area network PAN a Campus area network CAN a Metropolitan area network MAN a Wide area network WAN a Wireless wide area network WWAN or any broadband network and further enabled with technologies such as by way of example Global System for Mobile Communications GSM Personal Communications Service PCS Bluetooth WiFi Fixed Wireless Data 2G 2.5G 3G 4G IMT Advanced pre 4G LTE Advanced mobile WiMax WiMax 2 WirelessMAN Advanced networks enhanced data rates for GSM evolution EDGE General packet radio service GPRS enhanced GPRS iBurst UMTS HSPDA HSUPA HSPA UMTS TDD 1 RTT EV DO messaging protocols such as TCP IP SMS MMS extensible messaging and presence protocol XMPP real time messaging protocol RTMP instant messaging and presence protocol IMPP instant messaging USSD IRC or any other wireless data networks broadband networks or messaging protocols.

The distributed proxy and cache system can include for example the proxy server e.g. remote proxy and the server cache components on the server side. The server side proxy and cache can as illustrated reside internal to the host server . In addition the proxy server and cache on the server side can be partially or wholly external to the host server and in communication via one or more of the networks and . For example the proxy server may be external to the host server and the server cache may be maintained at the host server . Alternatively the proxy server may be within the host server while the server cache is external to the host server . In addition each of the proxy server and the cache may be partially internal to the host server and partially external to the host server . The application server content provider can by any server including third party servers or service content providers further including advertisement promotional content publication or electronic coupon servers or services. Similarly separate advertisement servers A promotional content servers B and or e Coupon servers C as application servers or content providers are illustrated by way of example.

The distributed system can also include in one embodiment client side components including by way of example but not limitation a local proxy e.g. a mobile client on a mobile device and or a local cache which can as illustrated reside internal to the device e.g. a mobile device .

In addition the client side proxy and local cache can be partially or wholly external to the device and in communication via one or more of the networks and . For example the local proxy may be external to the device and the local cache may be maintained at the device . Alternatively the local proxy may be within the device while the local cache is external to the device . In addition each of the proxy and the cache may be partially internal to the host server and partially external to the host server .

In one embodiment the distributed system can include an optional caching proxy server . The caching proxy server can be a component which is operated by the application server content provider the host server or a network service provider and or any combination of the above to facilitate network traffic management for network and device resource conservation. Proxy server can be used for example for caching content to be provided to the device for example from one or more of the application server provider host server and or a network service provider . Content caching can also be entirely or partially performed by the remote proxy to satisfy application requests or other data requests at the device .

In context aware traffic management and optimization for resource conservation in a network e.g. cellular or other wireless networks characteristics of user activity behavior and or application behavior at a mobile device e.g. any wireless device can be tracked by the local proxy and communicated over the network to the proxy server component in the host server for example as connection metadata. The proxy server which in turn is coupled to the application server provider provides content and data to satisfy requests made at the device .

In addition the local proxy can identify and retrieve mobile device properties including one or more of battery level network that the device is registered on radio state or whether the mobile device is being used e.g. interacted with by a user . In some instances the local proxy can delay expedite prefetch and or modify data prior to transmission to the proxy server when appropriate.

The local database can be included in the local proxy or coupled to the local proxy and can be queried for a locally stored response to the data request prior to the data request being forwarded on to the proxy server . Locally cached responses can be used by the local proxy to satisfy certain application requests of the mobile device by retrieving cached content stored in the cache storage when the cached content is still valid.

Similarly the proxy server of the host server can also delay expedite or modify data from the local proxy prior to transmission to the content sources e.g. the application server content provider . In addition the proxy server uses device properties and connection metadata to generate rules for satisfying request of applications on the mobile device . The proxy server can gather real time traffic information about requests of applications for later use in optimizing similar connections with the mobile device or other mobile devices.

In general the local proxy and the proxy server are transparent to the multiple applications executing on the mobile device. The local proxy is generally transparent to the operating system or platform of the mobile device and may or may not be specific to device manufacturers. In some instances the local proxy is optionally customizable in part or in whole to be device specific. In some embodiments the local proxy may be bundled into a wireless model a firewall and or a router.

In one embodiment the host server can in some instances utilize the store and forward functions of a short message service center SMSC such as that provided by the network service provider in communicating with the device in achieving network traffic management. Note that can also utilize any other type of alternative channel including USSD or other network control mechanisms. The host server can forward content or HTTP responses to the SMSC such that it is automatically forwarded to the device if available and for subsequent forwarding if the device is not currently available.

In general the disclosed distributed proxy and cache system allows optimization of network usage for example by serving requests from the local cache the local proxy reduces the number of requests that need to be satisfied over the network . Further the local proxy and the proxy server may filter irrelevant data from the communicated data. In addition the local proxy and the proxy server can also accumulate low priority data and send it in batches to avoid the protocol overhead of sending individual data fragments. The local proxy and the proxy server can also compress or transcode the traffic reducing the amount of data sent over the network and or . The signaling traffic in the network and or can be reduced as the networks are now used less often and the network traffic can be synchronized among individual applications.

With respect to the battery life of the mobile device by serving application or content requests from the local cache the local proxy can reduce the number of times the radio module is powered up. The local proxy and the proxy server can work in conjunction to accumulate low priority data and send it in batches to reduce the number of times and or amount of time when the radio is powered up. The local proxy can synchronize the network use by performing the batched data transfer for all connections simultaneously.

Client Side Proxy a component installed in the Smartphone mobile device or wireless device that interfaces with device s operating system as well as with data services and applications installed in the device. The client side proxy is typically compliant with and able to operate with standard or state of the art networking protocols.

The server side proxy can include one or more servers that can interface with third party application servers e.g. mobile operator s network which can be proxy or an additional server that is not illustrated and or the client side proxy . In general the server side proxy can be compliant with and is generally able to operate with standard or state of the art networking protocols and or specifications for interacting with mobile network elements and or third party servers.

Reporting and Usage Analytics Server The Reporting and Usage Analytics system or component can collect information from the client side and or the server side and provides the necessary tools for producing reports and usage analytics can used for analyzing traffic and signaling data. Such analytics can be used by the proxy system in managing reducing network traffic or by the network operator in monitoring their networks for possible improvements and enhancements. Note that the reporting and usage analytics system component as illustrated may be a server separate from the server side proxy or it may be a component of the server side proxy residing partially or wholly therein.

The client side components can include software components or agents installed on the mobile device that enables traffic optimization and performs the related functionalities on the client side. Components of the client side proxy can operate transparently for end users and applications . The client side proxy can be installed on mobile devices for optimization to take place and it can effectuate changes on the data routes. Once data routing is modified the client side proxy can respond to application requests to service providers or host servers in addition to or instead of letting those applications access data network directly. In general applications on the mobile device do not notice that the client side proxy is responding to their requests. Some example components of the client side proxy are described as follows 

Device State Monitor The device state monitor can be responsible for identifying several states and metrics in the device such as network status display status battery level etc. such that the remaining components in the client side proxy can operate and make decisions according to device state acting in an optimal way in each state.

Surrounding Evaluation Engine Similar to what are mentioned with regard to the surrounding evaluation engine can perform the surrounding evaluation e.g. indoor outdoor detection techniques disclosed herein. In the embodiment shown in the surrounding evaluation engine is coupled to the device state monitor to receive application activity battery network status as well as user selection an administrator s selection and or other suitable information. The surrounding evaluation engine can also receive readings from light sensors temperature sensors charging status sensors e.g. aforementioned battery sensor GPS sensors or receivers WLAN antennas accelerometer etc. The surrounding evaluation engine also received weather information in determining the weightings for the sensor readings in performing the mobile device surrounding evaluation. In some embodiments the surrounding evaluation engine can also communicate with the server side proxy for reporting and statistical purposes.

Traffic Recognizer The traffic recognizer analyzes all traffic between the wireless device applications and their respective host servers in order to identify recurrent patterns. Supported transport protocols include for example DNS HTTP and HTTPS such that traffic through those ports is directed to the client side proxy . While analyzing traffic the client side proxy can identify recurring polling patterns which can be candidates to be performed remotely by the server side proxy and send to the protocol optimizer .

Protocol Optimizer The protocol optimizer can implement the logic of serving recurrent request from the local cache instead of allowing those request go over the network to the service provider application host server. One is its tasks is to eliminate or minimize the need to send requests to the network positively affecting network congestion and device battery life.

Local Cache The local cache can store responses to recurrent requests and can be used by the Protocol Optimizer to send responses to the applications .

Traffic Scheduler The traffic scheduler can temporally move communications to optimize usage of device resources by unifying keep alive signaling so that some or all of the different applications can send keep alive messages at the same time traffic pipelining . Traffic scheduler may also decide to delay transmission of data that is not relevant at a given time for example when the device is not actively used .

Policy Manager The policy manager can store and enforce traffic optimization and reporting policies provisioned by a Policy Management Server PMS . At the client side proxy first start traffic optimization and reporting policies policy profiles that is to be enforced in a particular device can be provisioned by the Policy Management Server.

Watch Dog The watch dog can monitor the client side proxy operating availability. In case the client side proxy is not working due to a failure or because it has been disabled the watchdog can reset DNS routing rules information and can restore original DNS settings for the device to continue working until the client side proxy service is restored.

Reporting Agent The reporting agent can gather information about the events taking place in the device and sends the information to the Reporting Server. Event details are stored temporarily in the device and transferred to reporting server only when the data channel state is active. If the client side proxy doesn t send records within twenty four hours the reporting agent may attempt to open the connection and send recorded entries or in case there are no entries in storage an empty reporting packet. All reporting settings are configured in the policy management server.

Push Client The push client can be responsible for the traffic to between the server side proxy and the client side proxy . The push client can send out service requests like content update requests and policy update requests and receives updates to those requests from the server side proxy . In addition push client can send data to a reporting server e.g. the reporting and or usage analytics system which may be internal to or external to the server side proxy .

The proxy server has a wide variety of uses from speeding up a web server by caching repeated requests to caching web DNS and other network lookups for a group of clients sharing network resources. The proxy server is optional. The distributed proxy and cache system and or allows for a flexible proxy configuration using either the proxy additional proxy s in operator s network or integrating both proxies and an operator s or other third party s proxy.

The server side of the distributed system can include for example a relay server which interacts with a traffic harmonizer a polling server and or a policy management server . Each of the various components can communicate with the client side proxy or other third party e.g. application server service provider and or other proxy and or a reporting and usage analytics system. Some example components of the server side proxy is described as follows 

Relay Server The relay server is the routing agent in the distributed proxy architecture. The relay server manages connections and communications with components on the client side proxy installed on devices and provides an administrative interface for reports provisioning platform setup and so on.

Notification Server The notification server is a module able to connect to an operator s SMSC gateways and deliver SMS notifications to the client side proxy . SMS notifications can be used when an IP link is not currently active in order to avoid the client side proxy from activating a connection over the wireless data channel thus avoiding additional signaling traffic. However if the IP connection happens to be open for some other traffic the notification server can use it for sending the notifications to the client side proxy . The user database can store operational data including endpoint MSISDN organization and Notification server gateway for each resource URIs or URLs .

Traffic Harmonizer The traffic harmonizer can be responsible for communication between the client side proxy and the polling server . The traffic harmonizer connects to the polling server directly or through the data storage and to the client over any open or proprietary protocol such as the 7TP implemented for traffic optimization. The traffic harmonizer can be also responsible for traffic pipelining on the server side if there s cached content in the database for the same client this can be sent over to the client in one message.

Polling Server The polling server can poll third party application servers on behalf of applications that are being optimized . If a change occurs i.e. new data available for an application the polling server can report to the traffic harmonizer which in turn sends a notification message to the client side proxy for it to clear the cache and allow application to poll application server directly.

Policy Management Server The policy management server PMS allows administrators to configure and store policies for the client side proxies device clients . It also allows administrators to notify the client side proxies about policy changes. Using the policy management server each operator can configure the policies to work in the most efficient way for the unique characteristics of each particular mobile operator s network.

Reporting and Usage Analytics Component The Reporting and Usage Analytics component or system collects information from the client side and or from the server side and provides the tools for producing reports and usage analytics that operators can use for analyzing application signaling and data consumption.

Most mobile applications regularly poll their application servers to check for new data. Often there is no new data or the content has not changed so the exchange of data through the mobile network is unnecessary. As the number of mobile phones and their applications increase the amount of this needless polling grows. Since applications are not coordinated and poll at different times and intervals any given phone may frequently generate signal traffic. This causes multiple unnecessary radio activations consuming power and shortening battery life.

In one embodiment the signaling optimizer reduces network requests to a minimum by caching content in the client and letting its own server poll for changes in the network. When a mobile phone s client side proxy e.g. local proxy detects a recurring pattern for a resource such as an email application its response content is stored locally in a client cache so similar requests from that application get their response from the local cache rather than signaling the network.

In another embodiment systems and methods of intelligent alarm tracker and resource manipulator can be used to reduce network requests by consolidating or changing the timing of requests such that use of resources including network battery CPU memory and the like can be reduced.

In some embodiments features of the signaling optimizer and the intelligent alarm tracker and resource manipulator may be used together to obtain reduce resource usage by mobile applications on a mobile device.

As an example someone who typically gets only 10 emails a day may have phone s email application poll the network for new email every 15 minutes or 96 times a day with around 90 or more of the polls resulting in the same response there are no new emails. The client side proxy e.g. local proxy can recognize this request response pattern and intercepts the application s poll requests returning the locally cached response of no new emails . This way the device radio is not turned on by this particular application and the poll doesn t use any network resources. The server e.g. host server proxy server located in the network can monitor the email application server on behalf of the user s email application. When new email is available the server can notify the user s client side proxy to not use the cached no new emails response for the next poll request. Instead of going to the local client cache the email application polls its application server over the network and receives the new content.

The signaling optimizer can be configured and managed using different rule sets for different device types user types wireless networks and applications. Optimization rules can be updated at any time so the changes can be applied immediately when an application upgrades or changes happen in the mobile network. The protocols that can be optimized include but are not limited to HTTP HTTPS and DNS.

In the client server architecture the client side proxy e.g. local proxy is residing on the mobile or client devices. The client side proxy can communicate both directly to the Internet usually via an operator proxy and to the server side proxy e.g. proxy server or the host server . The proxy server communicates to the Internet and to the operator s SMSC .

As depicted the client side proxy can send a request directly to the Internet. This can happen after requests have been analyzed to detect optimizable patterns for example. The client side proxy can in one implementation send a request to the server e.g. host server proxy server for example to initiate server polling to reports logs or to get new configuration. The proxy server can send a request to the Internet to for example validate cached content. In one implementation the proxy server can send a request to the SMSC for example to send a cache invalidate message or policy update message to the client side proxy .

In one implementation the client side proxy may not maintain an open connection with the proxy server but may connect to the proxy server only in case there s a need to start polling an origin server to report logs or to get new configuration. For signaling optimizer feature the proxy server can notify the client side proxy when the content that has been polled has changed. The proxy server can send a request to invalidate cache in the client side proxy . When the application connects to that particular origin server e.g. content server the next time it can first fetch the latest content from the proxy server and then directly connect to the origin server . For the policy enforcer and or the network protector features the proxy server can notify the client side proxy when there s new configuration to be fetched from the server. When the proxy server needs to communicate with the client side proxy it can use a connection that is already open for some other request. If the connection is not open the proxy server can send a notification e.g. SMS to the client side proxy .

In one implementation non optimized application traffic flow such as traffic from App1 can completely bypass the client side proxy components and proceed directly through the operating system layer e.g. the Android OS layer and Network Access Layer to the wireless network. Traffic that that is not optimized can include but is not limited to rich media like video and audio as well as traffic from networks and applications that has been configured to bypass optimization and traffic pending optimization and the like. In one embodiment all traffic can be configured to bypass the client side server side proxy.

In another implementation optimized application traffic such as traffic from App2 can be redirected from the application to the client side proxy . By default this can be traffic on ports 80 HTTP and 53 DNS and selected traffic on port HTTPS for example. However traffic to other ports can be configured to be directed to the client side proxy.

In yet another implementation traffic flow can be between the client side proxy and the origin servers e.g. content server via the Internet and or between the client side proxy and the server side proxy e.g. proxy server .

The device which can be a portable or mobile device e.g. any wireless device such as a portable phone generally includes for example a network interface an operating system a context API and mobile applications which may be proxy unaware or proxy aware . Note that the device is specifically illustrated in the example of as a mobile device such is not a limitation and that device may be any wireless broadband portable mobile or non portable device able to receive transmit signals to satisfy data requests over a network including wired or wireless networks e.g. WiFi cellular Bluetooth LAN WAN etc. .

The network interface can be a networking module that enables the device to mediate data in a network with an entity that is external to the host server through any known and or convenient communications protocol supported by the host and the external entity. The network interface can include one or more of a network adaptor card a wireless network interface card e.g. SMS interface WiFi interface interfaces for various generations of mobile communication standards including but not limited to 2G 3G 3.5G 4G LTE etc. Bluetooth or whether or not the connection is via a router an access point a wireless router a switch a multilayer switch a protocol converter a gateway a bridge a bridge router a hub a digital media receiver and or a repeater.

Device can further include client side components of the distributed proxy and cache system which can include a local proxy e.g. a mobile client of a mobile device and a cache . In one embodiment the local proxy includes a user activity module a proxy API a request transaction manager a caching policy manager having an application protocol module a traffic shaping engine and or a connection manager . The traffic shaping engine may further include an alignment module and or a batching module the connection manager may further include a radio controller . The request transaction manager can further include an application behavior detector and or a prioritization engine the application behavior detector may further include a pattern detector and or and application profile generator . Additional or less components modules engines can be included in the local proxy and each illustrated component.

As used herein a module a manager a handler a detector an interface a controller a normalizer a generator an invalidator or an engine includes a general purpose dedicated or shared processor and typically firmware or software modules that are executed by the processor. Depending upon implementation specific or other considerations the module manager handler detector interface controller normalizer generator invalidator or engine can be centralized or its functionality distributed. The module manager handler detector interface controller normalizer generator invalidator or engine can include general or special purpose hardware firmware or software embodied in a computer readable storage medium for execution by the processor.

As used herein a computer readable medium or computer readable storage medium is intended to include all mediums that are statutory e.g. in the United States under 35 U.S.C. 101 and to specifically exclude all mediums that are non statutory in nature to the extent that the exclusion is necessary for a claim that includes the computer readable storage medium to be valid. Known statutory computer readable mediums include hardware e.g. registers random access memory RAM non volatile NV storage to name a few but may or may not be limited to hardware.

In one embodiment a portion of the distributed proxy and cache system for network traffic management resides in or is in communication with device including local proxy mobile client and or cache . The local proxy can provide an interface on the device for users to access device applications and services including email IM voice mail visual voicemail feeds Internet games productivity tools or other applications etc.

The proxy is generally application independent and can be used by applications e.g. both proxy aware and proxy unaware applications and or mobile applications to open TCP connections to a remote server. In some instances the local proxy includes a proxy API which can be optionally used to interface with proxy aware applications or applications e.g. mobile applications on a mobile device e.g. any wireless device .

The applications and can generally include any user application widgets software HTTP based application web browsers video or other multimedia streaming or downloading application video games social network applications email clients RSS management applications application stores document management applications productivity enhancement applications etc. The applications can be provided with the device OS by the device manufacturer by the network service provider downloaded by the user or provided by others.

One embodiment of the local proxy includes or is coupled to a context API as shown. The context API may be a part of the operating system or device platform or independent of the operating system as illustrated. The operating system can include any operating system including but not limited to any previous current and or future versions releases of Windows Mobile iOS Android Symbian Palm OS Brew MP Java 2 Micro Edition J2ME Blackberry etc.

The context API may be a plug in to the operating system or a particular client application on the device . The context API can detect signals indicative of user or device activity for example sensing motion gesture device location changes in device location device backlight keystrokes clicks activated touch screen mouse click or detection of other pointer devices. The context API can be coupled to input devices or sensors on the device to identify these signals. Such signals can generally include input received in response to explicit user input at an input device mechanism at the device and or collected from ambient signals contextual cues detected at or in the vicinity of the device e.g. light motion piezoelectric etc. .

In one embodiment the user activity module interacts with the context API to identify determine infer detect compute predict and or anticipate characteristics of user activity on the device . Various inputs collected by the context API can be aggregated by the user activity module to generate a profile for characteristics of user activity. Such a profile can be generated by the user activity module with various temporal characteristics. For instance user activity profile can be generated in real time for a given instant to provide a view of what the user is doing or not doing at a given time e.g. defined by a time window in the last minute in the last 30 seconds etc. a user activity profile can also be generated for a session defined by an application or web page that describes the characteristics of user behavior with respect to a specific task they are engaged in on the device or for a specific time period e.g. for the last 2 hours for the last 5 hours .

One embodiment of the local proxy further includes a request transaction manager which can detect identify intercept process manage data requests initiated on the device for example by applications and or and or directly indirectly by a user request. The request transaction manager can determine how and when to process a given request or transaction or a set of requests transactions based on transaction characteristics.

The request transaction manager can prioritize requests or transactions made by applications and or users at the device for example by the prioritization engine . Importance or priority of requests transactions can be determined by the request transaction manager by applying a rule set for example according to time sensitivity of the transaction time sensitivity of the content in the transaction time criticality of the transaction time criticality of the data transmitted in the transaction and or time criticality or importance of an application making the request.

The prioritization engine can also track network provider limitations or specifications on application or transaction priority in determining an overall priority status for a request transaction. Furthermore priority can in part or in whole be determined by user preferences either explicit or implicit. A user can in general set priorities at different tiers such as specific priorities for sessions or types or applications e.g. a browsing session a gaming session versus an IM chat session the user may set a gaming session to always have higher priority than an IM chat session which may have higher priority than web browsing session . A user can set application specific priorities e.g. a user may set Facebook related transactions to have a higher priority than LinkedIn related transactions for specific transaction types e.g. for all send message requests across all applications to have higher priority than message delete requests for all calendar related events to have a high priority etc. and or for specific folders.

The prioritization engine can track and resolve conflicts in priorities set by different entities. For example manual settings specified by the user may take precedence over device OS settings network provider parameters limitations e.g. set in default for a network service area geographic locale set for a specific time of day or set based on service fee type may limit any user specified settings and or application set priorities. In some instances a manual synchronization request received from a user can override some most or all priority settings in that the requested synchronization is performed when requested regardless of the individually assigned priority or an overall priority ranking for the requested action.

Priority can be specified and tracked internally in any known and or convenient manner including but not limited to a binary representation a multi valued representation a graded representation and all are considered to be within the scope of the disclosed technology.

Table I above shows for illustration purposes some examples of transactions with examples of assigned priorities in a binary representation scheme. Additional assignments are possible for additional types of events requests transactions and as previously described priority assignments can be made at more or less granular levels e.g. at the session level or at the application level etc.

As shown by way of example in the above table in general lower priority requests transactions can include updating message status as being read unread deleting of messages deletion of contacts higher priority requests transactions can in some instances include status updates new IM chat message new email calendar event update cancellation deletion an event in a mobile gaming session or other entertainment related events a purchase confirmation through a web purchase or online request to load additional or download content contact book related events a transaction to change a device setting location aware or location based events transactions or any other events request transactions initiated by a user or where the user is known to be expected to be or suspected to be waiting for a response etc.

Inbox pruning events e.g. email or any other types of messages are generally considered low priority and absent other impending events generally will not trigger use of the radio on the device . Specifically pruning events to remove old email or other content can be piggy backed with other communications if the radio is not otherwise on at the time of a scheduled pruning event. For example if the user has preferences set to keep messages for 7 days old then instead of powering on the device radio to initiate a message delete from the device the moment that the message has exceeded 7 days old the message is deleted when the radio is powered on next. If the radio is already on then pruning may occur as regularly scheduled.

The request transaction manager can use the priorities for requests e.g. by the prioritization engine to manage outgoing traffic from the device for resource optimization e.g. to utilize the device radio more efficiently for battery conservation . For example transactions requests below a certain priority ranking may not trigger use of the radio on the device if the radio is not already switched on as controlled by the connection manager . In contrast the radio controller can turn on the radio such a request can be sent when a request for a transaction is detected to be over a certain priority level.

The batching module can initiate batch transfer based on certain criteria. For example batch transfer e.g. of multiple occurrences of events some of which occurred at different instances in time may occur after a certain number of low priority events have been detected or after an amount of time elapsed after the first of the low priority event was initiated. In addition the batching module can initiate batch transfer of the cumulated low priority events when a higher priority event is initiated or detected at the device . Batch transfer can otherwise be initiated when radio use is triggered for another reason e.g. to receive data from a remote device such as host server or . In one embodiment an impending pruning event pruning of an inbox or any other low priority events can be executed when a batch transfer occurs.

In general the batching capability can be disabled or enabled at the event transaction level application level or session level based on any one or combination of the following user configuration device limitations settings manufacturer specification network provider parameters limitations platform specific limitations settings device OS settings etc. In one embodiment batch transfer can be initiated when an application window file is closed out exited or moved into the background users can optionally be prompted before initiating a batch transfer users can also manually trigger batch transfers.

In one embodiment the pattern detector can detect recurrences in application requests made by the multiple applications for example by tracking patterns in application behavior. A tracked pattern can include detecting that certain applications as a background process poll an application server regularly at certain times of day on certain days of the week periodically in a predictable fashion with a certain frequency with a certain frequency in response to a certain type of event in response to a certain type user query frequency that requested content is the same frequency with which a same request is made interval between requests applications making a request or any combination of the above for example.

Such recurrences can be used by traffic shaping engine to offload polling of content from a content source e.g. from an application server content provider that would result from the application requests that would be performed at the mobile device or wireless device to be performed instead by a proxy server remote from the device . Traffic shaping engine can decide to offload the polling when the recurrences match a rule. For example there are multiple occurrences or requests for the same resource that have exactly the same content or returned value or based on detection of repeatable time periods between requests and responses such as a resource that is requested at specific times during the day. The offloading of the polling can decrease the amount of bandwidth consumption needed by the mobile device to establish a wireless cellular or other wireless broadband connection with the content source for repetitive content polls.

As a result of the offloading of the polling locally cached content stored in the local cache can be provided to satisfy data requests at the device when content change is not detected in the polling of the content sources. As such when data has not changed application data needs can be satisfied without needing to enable radio use or occupying cellular bandwidth in a wireless network. When data has changed and or new data has been received the remote entity to which polling is offloaded can notify the device .

In one embodiment the local proxy can mitigate the need use of periodic keep alive messages heartbeat messages to maintain TCP IP connections which can consume significant amounts of power thus having detrimental impacts on mobile device battery life. The connection manager in the local proxy e.g. the heartbeat manager can detect identify and intercept any or all heartbeat keep alive messages being sent from applications.

The heartbeat manager can prevent any or all of these heartbeat messages from being sent over the cellular or other network and instead rely on the server component of the distributed proxy system e.g. shown in to generate the and send the heartbeat messages to maintain a connection with the backend.

The surrounding evaluation engine can perform the surrounding evaluation e.g. indoor outdoor detection techniques disclosed herein. The surrounding evaluation engine can receive application activity battery network status as well as user selection an administrator s selection and or other suitable information. The surrounding evaluation engine can also receive readings from light sensors temperature sensors charging status sensors e.g. aforementioned battery sensor GPS sensors or receivers WLAN antennas accelerometer etc. The surrounding evaluation engine also received weather information in determining the weightings for the sensor readings in performing the mobile device surrounding evaluation. In some embodiments the results from surrounding evaluation engine can assist for example the traffic shaping engine or the request transaction manager in performing their functionalities.

The local proxy generally represents any one or a portion of the functions described for the individual managers modules and or engines. The local proxy and device can include additional or less components more or less functions can be included in whole or in part without deviating from the novel art of the disclosure

The mobile device can include one or more sensors A N hereinafter referred to as the sensors other platform specific and or other modules such as network interface components other hardware components native applications etc. other components described in and the like. The surrounding evaluation engine in one embodiment can include a weather condition retriever module and an indoor outdoor determination module . The indoor outdoor determination module can include sensor output weighting module and a movement detector module . In some embodiments the sensor output weighting module can include weather profiles sensor specification profiles and an additional adjustment module . Additional or less modules or components can be included in the surrounding evaluation engine . Depending on the implementation one or more of the components can be consolidated into a single component and or a single component can be further divided into multiple components.

According to some embodiments the surrounding evaluation engine can determine detect the surrounding in which the mobile device is situated e.g. whether the mobile device is indoor or outdoor based on sensors on the mobile device . The sensors can be typical sensors on the mobile device which do not require additional infrastructure. Also as used throughout herein a sensor need not be a dedicated sensor any suitable circuit or component that can be used as a sensor e.g. WiFi or GSM antennas can be adapted to implement the disclosed techniques.

In some variations the surrounding evaluation engine first detects whether the mobile device is in motion and the surrounding detection is only performed upon or after a location change of the mobile device . As aforementioned this technique can increase the possibility that the detection generates meaningful results and avoid undesirable power drain. In these embodiments before the surrounding evaluation engine starts the surrounding evaluation e.g. by the indoor outdoor determination module the surrounding evaluation engine employs the movement detector to detect whether the mobile device is in motion. In some examples the determining is only performed upon or after a location change of the mobile device exceeds a threshold. Additionally or alternatively the timing of the determination can be adjusted based on the movement detection.

In some examples the surrounding evaluation engine only starts detection of the surroundings when the user has moved a number of steps within a given time period. The number of steps the user has traveled can be estimated by the movement detector by the readings from an accelerometer. For example the movement detector can use an accelerometer to detect if a user of the mobile device has traveled a predetermined number of steps within a given time period.

Additionally or alternatively coarse location update can be used to verify if the user is moving his or her location. In one or more embodiments the movement detector uses wireless network circuitry on the mobile device to estimate the mobile device is changing location. The wireless network circuitry can include a wireless telephony circuit and or a wireless local area network WLAN circuit. In some embodiments the surrounding evaluation engine only start taking inputs from various sensors and the above said surrounding evaluation process once the movement detector establishes that the user has moved the location.

Then the indoor outdoor determination module uses the reading outputs from the sensors and processes the outputs by the sensor output weighting module to get the estimation of whether the mobile device is indoor or outdoor. The weighting is based on the weather information. As such during normal operations the weather condition retriever first retrieves a weather condition from a remote server e.g. the weather server . The retrieval process can be either direct or indirect. In some embodiments the weather condition retriever can establish communication with the weather server to receive request weather condition. Additionally or alternatively the weather condition retriever can request receive the weather condition from an intermediary source including for example another software application e.g. a weather app running on the mobile device or a native source on the mobile device e.g. a weather service application programming interface API as provided by an operating system of the mobile device . The weather condition can include sunrise sunset or almanac timings for the whole day. In some embodiments this can be done once a day. In variations the information can include forecasted weather so that the disclosed techniques may still function when there is no Internet connections.

The indoor outdoor determination module derives e.g. via the sensor output weighting module a plurality of weights for the sensors on the mobile device . This weight deriving process is performed based on the weather condition. Specifically the sensor output weighting module can derive the weights based on the weather profiles and the sensor specification profiles . The weather profiles can document for example for each kind of weather whether and how each of the sensors should take part in the indoor outdoor determination algorithm. The sensor specification profiles can document what kinds of sensors the mobile device is equipped with and each sensor s specification e.g. manufacturer batch sensitivity etc. . Both profiles and are considered together with the retrieved weather information by the sensor output weighting module.

Then the indoor outdoor determination module applies each weight to an output of a corresponding sensor on the mobile device . That is to say the above derived weightings and other information are applied by the indoor outdoor determination module onto the sensor readings and the indoor outdoor determination module determines whether the mobile device is likely to be indoor or outdoor based on one or more weighted outputs from the sensors. The determination can be based on an indoor outdoor detection algorithm that calculates the likelihood of the mobile device being indoor or outdoor.

More specifically according to one or more examples the sensors which can be used in determining the mobile device s surroundings include by way of example and not limitation GPS status sensors light sensors WLAN or WiFi sensors accelerometers gyroscopes ambient temperature sensors and or battery sensors. Note that in the following description the likelihood of the surroundings is discussed with respect to readings from a sensor however according to the present disclosure the determining can be based on more than one weighted outputs from the sensors e.g. determining the likelihood from a totality of sensor outputs .

In some embodiments if the movement detector has determined that the user of the mobile device has traveled a predetermined number of steps within a given time period the indoor outdoor determination module uses readings from a global positioning satellite GPS receiver to determine how many satellites signals can be received by the GPS receiver. Based on the readings the indoor outdoor determination module evaluates that the mobile device is likely to be indoor if a number of satellites with receivable signals is below a threshold. In some of these examples the GPS receiver is only turned on when it is determined that the user has walked significant number of steps. GPS signals are then registered to update the location. The number of satellites that are visible to the GPS receiver is also registered by the movement detector . In one or more examples if the number of satellites visible is less than three then the probability of the mobile device being indoor is high.

Further in some examples the sensors include a light sensor. The indoor outdoor determination module can statistically calculate a background light intensity from the light sensor. The statistical calculating is based on the plurality of weights derived based on the weather condition by referring to weather profiles and sensor specification profiles . Then the indoor outdoor determination module evaluates that the mobile device is likely to be indoor if the background light intensity is below a first number. In a similar fashion the indoor outdoor determination module evaluates that the mobile device is likely to be outdoor if the background light intensity is above a second number. For example if the light intensity sensed by the light sensor is very high e.g. in the range of 1500 lumens after weighting adjustments then the mobile device is likely to be at outdoor. Likewise if the light intensity sensed by the sensor is very low e.g. in the range of 400 500 lumens after weighting adjustments then the mobile device is likely to be at indoor.

In some examples the sensors include a ambient temperature sensor. The indoor outdoor determination module can statistically calculate a background temperature from the temperature sensor. The statistical calculating is based on the plurality of weights derived based on the weather condition. Then the indoor outdoor determination module can evaluate that the mobile device is likely to be indoor if the background temperature after weighting adjustments is above a first number. Similarly the indoor outdoor determination module can evaluate that the mobile device is likely to be outdoor if the background temperature after weighting adjustments is below a second number. For example if the weather outside is cold then the indoor outdoor determination module can assume that the temperature indoors may be higher e.g. if the mobile device is located in a geographic area where heaters are extensively used . Conversely if the weather outside is hot then the indoor outdoor determination module can assume that the temperature indoors may be lower e.g. if the mobile device is located in a geographic area where air conditioners are extensively used . The indoor outdoor determination module can observe this rise or fall in temperature and use this input to determine the mobile device s surrounding. In some embodiments the rate at which the temperature drops can be considered as well.

Moreover in some embodiments the sensors comprise a proximity sensor and the surrounding evaluation engine uses the proximity sensor to detect whether the mobile device is in condition a a pocket of a user or condition b in close proximity to the user s body so as to affect the outputs from the sensors e.g. when the user is making a phone call by placing the mobile device close to the user s face. In one or more implementations if the mobile device is in a or b condition the surrounding evaluation engine excludes outputs from a light sensor and a temperature sensor from the determining process.

In some embodiments the sensors comprise a wireless local area network WLAN circuit and the indoor outdoor determination module measures a received signal strength indication RSSI number using the WLAN circuit. If the RSSI number is above a first number the indoor outdoor determination module evaluates that the mobile device is likely to be indoor. If the RSSI number is below a second number the indoor outdoor determination module evaluates that the mobile device is likely to be outdoor. For example if the measured signal strength is less that 78 dB then the mobile device is more likely to be at outdoor as compared to indoor. Conversely if the measured signal strength is more than 74 dB then the mobile device is more likely to be at indoor as compared to outdoor.

In some embodiments the sensors comprise a battery status sensor to retrieve a charging state of a battery of the mobile device . The indoor outdoor determination module can adjust the plurality of weights based on the charging state. That is to say the indoor outdoor determination module can use the battery sensor to retrieve the current charging state of the device and assign different weights to the sensor readings for detection algorithm based on the retrieved state. For example in some embodiments the indoor outdoor determination module can decrease a background temperature as being statistically calculated from a temperature sensor so as to compensate for a temperature increase caused by the mobile device s battery being charged or discharged.

As an optional feature the additional adjustment module can learn from past or historical surrounding estimation and can adjust the profiles and so that the accuracy of future surrounding estimation can be increased. In one example the additional adjustment module can prompt the user to correct or verify the estimation during a training period.

In this way among other benefits the surrounding evaluation techniques disclosed herein increase accuracy to estimate the mobile device s surrounding e.g. whether indoor or outdoor without the need of dedicated sensors or other modification to mobile network infrastructures thereby providing the benefit of surrounding sensing without incurring the cost.

As previously discussed the surrounding evaluation engine can determine detect the surrounding in which the mobile device is situated e.g. whether the mobile device is indoor or outdoor based on sensors on the mobile device . The sensors can be typical sensors on the mobile device which do not require additional infrastructure. Also as used throughout herein a sensor need not be a dedicated sensor any suitable circuit or component that can be used as a sensor e.g. WiFi or GSM antennas can be adapted to implement the disclosed techniques.

The indoor outdoor determination module uses the reading outputs from the sensors and processes the outputs by the sensor output weighting module to get the estimation of whether the mobile device is indoor or outdoor. The weighting is based on the weather information. As such during normal operations the weather condition retriever first retrieves a weather condition from a remote server e.g. the weather server . The weather condition can include sunrise sunset or almanac timings for the whole day. In some embodiments this can be done once a day. In variations the information can include forecasted weather so that the disclosed techniques may still function when there is no Internet connections.

The indoor outdoor determination module derives e.g. via the sensor output weighting module a plurality of weights for the sensors on the mobile device . This weight deriving process is performed based on the weather condition. Specifically the sensor output weighting module can derive the weights based on the weather profiles and the sensor specification profiles . The weather profiles can document for example for each kind of weather whether and how each of the sensors should take part in the indoor outdoor determination algorithm. The sensor specification profiles can document what kinds of sensors the mobile device is equipped with and each sensor s specification e.g. manufacturer batch sensitivity etc. . Both profiles and are considered together with the retrieved weather information by the sensor output weighting module.

Then the indoor outdoor determination module applies each weight to an output of a corresponding sensor on the mobile device . That is to say the above derived weightings and other information are applied by the indoor outdoor determination module onto the sensor readings and the indoor outdoor determination module determines whether the mobile device is likely to be indoor or outdoor based on one or more weighted outputs from the sensors. The determination can be based on an indoor outdoor detection algorithm that calculates the likelihood of the mobile device being indoor or outdoor.

In some variations the surrounding evaluation engine first detects whether the mobile device is in motion and the surrounding detection is only performed upon or after a location change of the mobile device . As aforementioned this technique can increase the possibility that the detection generates meaningful results and avoid undesirable power drain. In these embodiments before the surrounding evaluation engine starts the surrounding evaluation e.g. by the indoor outdoor determination module the surrounding evaluation engine employs the movement detector to detect whether the mobile device is in motion. In some examples the determining is only performed upon or after a location change of the mobile device exceeds a threshold.

Additionally or alternatively the timing of the determination can be adjusted based on the movement detection. In some examples the surrounding evaluation engine only starts detection of the surroundings when the user has moved a number of steps within a given time period. The number of steps the user has travelled can be estimated by the movement detector by the readings from an accelerometer. For example the movement detector can use an accelerometer to detect if a user of the mobile device has traveled a predetermined number of steps within a given time period.

In the example of the computer system includes a processor memory non volatile memory and an interface device. Various common components e.g. cache memory are omitted for illustrative simplicity. The computer system is intended to illustrate a hardware device on which any of the components depicted in the example of and any other components described in this specification can be implemented. The computer system can be of any applicable known or convenient type. The components of the computer system can be coupled together via a bus or through some other known or convenient device.

The processor may be for example a conventional microprocessor such as a microprocessor. One of skill in the relevant art will recognize that the terms machine readable storage medium or computer readable storage medium include any type of device that is accessible by the processor.

The memory is coupled to the processor by for example a bus. The memory can include by way of example but not limitation random access memory RAM such as dynamic RAM DRAM and static RAM SRAM . The memory can be local remote or distributed.

The bus also couples the processor to the non volatile memory and drive unit. The non volatile memory is often a magnetic floppy or hard disk a magnetic optical disk an optical disk a read only memory ROM such as a CD ROM EPROM or EEPROM a magnetic or optical card or another form of storage for large amounts of data. Some of this data is often written by a direct memory access process into memory during execution of software in the computer . The non volatile storage can be local remote or distributed. The non volatile memory is optional because systems can be created with all applicable data available in memory. A typical computer system usually include at least a processor memory and a device e.g. a bus coupling the memory to the processor.

Software is typically stored in the non volatile memory and or the drive unit. Indeed for large programs it may not even be possible to store the entire program in the memory. Nevertheless it should be understood that for software to run if necessary it is moved to a computer readable location appropriate for processing and for illustrative purposes that location is referred to as the memory in this paper. Even when software is moved to the memory for execution the processor typically make use of hardware registers to store values associated with the software and local cache that ideally serves to speed up execution. As used herein a software program is assumed to be stored at any known or convenient location from non volatile storage to hardware registers when the software program is referred to as implemented in a computer readable medium. A processor is considered to be configured to execute a program when at least one value associated with the program is stored in a register readable by the processor.

The bus also couples the processor to the network interface device. The interface can include one or more of a modem or network interface. It will be appreciated that a modem or network interface can be considered to be part of the computer system. The interface can include an analog modem isdn modem cable modem token ring interface satellite transmission interface e.g. direct PC or other interfaces for coupling a computer system to other computer systems. The interface can include one or more input and or output devices. The I O devices can include by way of example but not limitation a keyboard a mouse or other pointing device disk drives printers a scanner and other input and or output devices including a display device. The display device can include by way of example but not limitation a cathode ray tube CRT liquid crystal display LCD or some other applicable known or convenient display device. For simplicity it is assumed that controllers of any devices not depicted reside in the interface.

In operation the computer system can be controlled by operating system software that includes a file management system such as a disk operating system. One example of operating system software with associated file management system software is the family of operating systems known as Windows from Microsoft Corporation of Redmond Wash. and their associated file management systems. Another example of operating system software with its associated file management system software is the Linux operating system and its associated file management system. The file management system is typically stored in the non volatile memory and or drive unit and causes the processor to execute the various acts required by the operating system to input and output data and to store data in the memory including storing files on the non volatile memory and or drive unit.

Some portions of the detailed description may be presented in terms of algorithms and symbolic representations of operations on data bits within a computer memory. These algorithmic descriptions and representations are the means used by those skilled in the data processing arts to most effectively convey the substance of their work to others skilled in the art. An algorithm is here and generally conceived to be a self consistent sequence of operations leading to a desired result. The operations are those requiring physical manipulations of physical quantities. Usually though not necessarily these quantities take the form of electrical or magnetic signals capable of being stored transferred combined compared and otherwise manipulated. It has proven convenient at times principally for reasons of common usage to refer to these signals as bits values elements symbols characters terms numbers or the like.

