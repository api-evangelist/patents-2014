---

title: Method for securing credentials in a remote repository
abstract: A method of securing user credentials in a remote repository is provided. In accordance with one embodiment, there is provided a method comprising generating a first private key and a first public key pair from a registered password; generating a second private key and a second public key pair; generating a storage key from the second private key and the first public key; encrypting a set of credentials using the storage key; creating a encrypted credential signature from the encrypted set of credentials and the first private key; and storing the encrypted set of credentials, the encrypted credential signature, and the second public key in the remote repository.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09455830&OS=09455830&RS=09455830
owner: Certicom Corp.
number: 09455830
owner_city: Mississauga
owner_country: CA
publication_date: 20140613
---
The present application is a continuation of U.S. patent application Ser. No. 12 902 638 filed Oct. 12 2010 entitled A METHOD FOR SECURING CREDENTIALS IN A REMOTE REPOSITORY the contents of which are hereby incorporated by reference into the DETAILED DESCRIPTION OF EXAMPLE EMBODIMENTS below.

The present disclosure relates to the field of electronic credential management and more particularly to the field of electronic credential management in a remote repository.

With an increasing number of services and information being made available through online networks users are required to authenticate their identities and privileges through the use of electronic credentials. These credentials may include usernames passwords encryption keys tokens or any other information used in authorization or authentication processes.

These credentials are often stored locally on the computer or electronic device from which a user is accessing the associated services. When users reset or change electronic devices they must re enter or repopulate their credentials.

In accordance with one aspect of the present disclosure there is provided a method of securing user credentials in a remote repository. The method includes generating a first private key and a first public key pair from a registered password generating a second private key and a second public key pair generating a storage key from the second private key and the first public key encrypting a set of credentials using the storage key creating a encrypted credential signature from the encrypted set of credentials and the first private key and storing the encrypted set of credentials the encrypted credential signature and the second public key in the remote repository.

In accordance with another aspect of the present disclosure there is provided a method of authenticating a request to access user credentials in a remote repository the remote repository having stored thereon a unique user identification UID and an authentication token generated from the UID and a password. The method includes receiving a user login identification and a first random number from a communication device sending a second random number to the communication device receiving a response token from the communication device the response token having been generated from the first random number the second random number the user login identification and the password generating a verification token from the first random number the second random number and the authentication token and verifying the response token matches the verification token.

In accordance with yet another aspect of the present disclosure there is provided a method of accessing secured user credentials in a remote repository. The method includes receiving an encrypted set of credentials an encrypted credential signature and a second public key from the remote repository generating a first private key from a user entered password verifying the encrypted credential signature from the encrypted set of credentials and the first private key generating a storage key from the first private key and the second public key and decrypting the encrypted set of credentials using the storage key.

Reference is first made to which shows in block diagram form a communication system in which example embodiments of the present disclosure can be applied. The communication system comprises a number of mobile communication devices mobile devices which may be connected to the remainder of system in any of several different ways. Accordingly several instances of mobile communication devices are depicted in employing different example ways of connecting to system . Mobile communication devices are connected to a wireless communication network which may comprise one or more of a Wireless Wide Area Network WWAN and a Wireless Local Area Network WLAN or other suitable network arrangements. In some embodiments the mobile communication devices are configured to communicate over both the WWAN and WLAN and to roam between these networks. In some embodiments the wireless network may comprise multiple WWANs and WLANs .

The WWAN may be implemented as any suitable wireless access network technology. By way of example but not limitation the WWAN may be implemented as a wireless network that includes a number of transceiver base stations one of which is shown in where each of the base stations provides wireless Radio Frequency RF coverage to a corresponding area or cell. The WWAN is typically operated by a mobile network service provider that provides subscription packages to users of the mobile communication devices . In some embodiments the WWAN conforms to one or more of the following wireless network types Mobitex Radio Network DataTAC GSM Global System for Mobile Communication GPRS General Packet Radio System TDMA Time Division Multiple Access CDMA Code Division Multiple Access CDPD Cellular Digital Packet Data iDEN integrated Digital Enhanced Network EvDO Evolution Data Optimized CDMA2000 EDGE Enhanced Data rates for GSM Evolution UMTS Universal Mobile Telecommunication Systems HSDPA High Speed Downlink Packet Access IEEE 802.16e also referred to as Worldwide Interoperability for Microwave Access or WiMAX or various other networks. Although WWAN is described as a Wide Area network that term is intended herein also to incorporate wireless Metropolitan Area Networks WMAN and other similar technologies for providing coordinated service wirelessly over an area larger than that covered by typical WLANs.

The WWAN may further comprise a wireless network gateway which connects the mobile communication devices to transport facilities and through the transport facilities to a wireless connector system . Transport facilities may include one or more private networks or lines the public internet a virtual private network or any other suitable network. The wireless connector system may be operated for example by an organization or enterprise such as a corporation university or governmental department which allows access to a network such as an internal or enterprise network and its resources or the wireless connector system may be operated by a mobile network provider. In some embodiments the network may be realised using the internet rather than an internal or enterprise network.

The wireless network gateway provides an interface between the wireless connector system and the WWAN which facilitates communication between the mobile communication devices and other devices not shown connected directly or indirectly to the WWAN . Accordingly communications sent via the mobile communication devices are transported via the WWAN and the wireless network gateway through transport facilities to the wireless connector system . Communications sent from the wireless connector system are received by the wireless network gateway and transported via the WWAN to the mobile communication devices .

The WLAN comprises a wireless network which in some embodiments conforms to IEEE 802.11x standards sometimes referred to as Wi Fi such as for example the IEEE 802.11a 802.11b and or 802.11g standard. Other communication protocols may be used for the WLAN in other embodiments such as for example IEEE 802.11n IEEE 802.16e also referred to as Worldwide Interoperability for Microwave Access or WiMAX or IEEE 802.20 also referred to as Mobile Wireless Broadband Access . The WLAN includes one or more wireless RF Access Points AP one of which is shown in that collectively provide a WLAN coverage area.

The WLAN may be a personal network of the user an enterprise network or a hotspot offered by an internet service provider ISP a mobile network provider or a property owner in a public or semi public area for example. The access points are connected to an access point AP interface which may connect to the wireless connector system directly for example if the access point is part of an enterprise WLAN in which the wireless connector system resides or indirectly via the transport facilities if the access point is a personal Wi Fi network or Wi Fi hotspot in which case a mechanism for securely connecting to the wireless connector system such as a virtual private network VPN may be required . The AP interface provides translation and routing services between the access points and the wireless connector system to facilitate communication directly or indirectly with the wireless connector system .

The wireless connector system may be implemented as one or more servers and is typically located behind a firewall . The wireless connector system manages communications including email messages to and from a set of managed mobile communication devices . The wireless connector system also provides administrative control and management capabilities over users and mobile communication devices which may connect to the wireless connector system .

The wireless connector system allows the mobile communication devices to access the network and connected resources and services such as a user identity server and service providers . The service providers may comprise a content server for providing content such as internet content or content from an organization s internal servers an application server for implementing server based applications such as email or any other system for providing services. When accessing these service providers a user may be required to enter or send credentials stored on his communication device to authenticate his identity and privileges associated with the service provider. In some embodiments the communication device may require certain credentials to just access the network on which the service providers reside.

In accordance with one aspect of the present disclosure the user identity server is configured to secure users credentials and to authenticate communication devices . In at least one embodiment the user identity server is implemented through computer program instructions that reside on a persistent storage on a computer system or server and which are executed by one or more microprocessors. In some embodiments the user identity server is implemented on the same computer as a service provider .

In an example embodiment the user identity server can communicate and exchange messages with mobile devices over the communication system using any of the example mobile device connections illustrated in or any other connection means suitable for exchanging messages with a mobile device. In some embodiments the user identity server is configured to send and receive messages for authentication or to upload or download credentials. In some embodiments these messages may be signed encrypted or otherwise secured.

In some embodiments the user identity server is communicably connected to a credentials repository . In some examples the credentials repository comprises credential information associated with a unique user identification. This information may include encrypted credentials timestamps signatures encryption keys or any other data that may be stored in association with encrypted information. The user identity server communicates with the credentials repository to upload and download credential information.

In the user identity server is illustrated as being directly connected to a credentials repository however in some embodiments the credentials repository may reside on the same system or computer as the user identity server . In other embodiments the credential repository may be situated at a different location on the network. In some embodiments there may be multiple credentials repositories on the network all communicably connected to the user identity server .

The wireless connector system typically provides a secure exchange of data e.g. email messages personal information manager PIM data and IM data with the mobile communication devices . In some embodiments communications between the wireless connector system and the mobile communication devices are encrypted. In some embodiments communications are encrypted using a symmetric encryption key implemented using Advanced Encryption Standard AES or Triple Data Encryption Standard Triple DES encryption. Private encryption keys are generated in a secure two way authenticated environment and are used for both encryption and decryption of data.

The wireless network gateway is adapted to send data packets received from the mobile device over the WWAN to the wireless connector system . The wireless connector system then sends the data packets to the appropriate connection point such as the user identity server service providers or other connected computers . Conversely the wireless connector system sends data packets received for example from the user identity server or service providers to the wireless network gateway which then transmit the data packets to the destination mobile device . The AP interfaces of the WLAN provide similar sending functions between the mobile device the wireless connector system and network connection point such as a content server an application server or any other service provider .

The network may comprise a private local area network metropolitan area network wide area network the public internet or combinations thereof and may include virtual networks constructed using any of these alone or in combination. Computers may be connected to the network directly or indirectly via an intermediate communication network such as the Internet . When computers connect to the network indirectly e.g. via the Internet a VPN or other mechanism for securely connecting to the network may be required. Computers may be of any suitable construction and include at least a processor and a display screen one or more user input devices and a memory each connected to the processor. The computers could be desktop computers laptop notebook netbook computers or combinations thereof and may have wired or wireless communication subsystems for connecting to the network .

A mobile device may alternatively connect to the wireless connector system using a computer via the network . In at least some embodiments for security purposes the computers with which the mobile devices can connect to the wireless connector system are limited to computers which are directly connected to the network . A link may be provided for exchanging information between the mobile device and computer connected to the wireless connector system . The link may comprise one or both of a physical interface and short range wireless communication interface. The physical interface may comprise one or combinations of an Ethernet connection Universal Serial Bus USB connection Firewire also known as an IEEE 1394 interface connection or other serial data connection via respective ports or interfaces of the mobile device and computer . The short range wireless communication interface may be a personal area network PAN interface. A personal area network is a wireless point to point connection meaning no physical cables are required to connect the two end points.

It will be appreciated that the above described communication system is provided for the purpose of illustration only and that the above described communication system comprises one possible communication network configuration of a multitude of possible configurations for use with the mobile communication devices . The teachings of the present disclosure may be employed in connection with any other type of network and associated devices that are effective in implementing or facilitating wireless communication. Suitable variations of the communication system are intended to fall within the scope of the present disclosure.

Reference is now made to which illustrates a mobile device in which example embodiments described in the present disclosure can be applied. The mobile device is a two way communication device having data and voice communication capabilities and the capability to communicate with other computer systems for example via the Internet. Depending on the functionality provided by the mobile device in various embodiments the device may be a multiple mode communication device configured for both data and voice communication a smartphone a mobile telephone or a PDA personal digital assistant enabled for wireless communication or a computer system with a wireless modem.

The mobile device includes a rigid case not shown housing the components of the device . The internal components of the device are constructed on a printed circuit board PCB . The mobile device includes a controller comprising at least one processor such as a microprocessor which controls the overall operation of the device . The processor interacts with device subsystems such as a wireless communication subsystem for exchanging radio frequency signals with the wireless network to perform communication functions. The processor interacts with additional device subsystems including a display screen such as a liquid crystal display LCD screen input devices such as a keyboard and control buttons flash memory random access memory RAM read only memory ROM auxiliary input output I O subsystems data port such as serial data port such as a Universal Serial Bus USB data port speaker microphone short range communication subsystem and other device subsystems generally designated as . Some of the subsystems shown in perform communication related functions whereas other subsystems may provide resident or on device functions.

The device may comprise a touchscreen display in some embodiments. The touchscreen display may be constructed using a touch sensitive input surface connected to an electronic controller and which overlays the display screen . The touch sensitive overlay and the electronic controller provide a touch sensitive input device and the processor interacts with the touch sensitive overlay via the electronic controller.

The mobile device may communicate with any one of a plurality of fixed transceiver base stations of the wireless network within its geographic coverage area. The mobile device may send and receive communication signals over the wireless network after the required network registration or activation procedures have been completed.

The processor operates under stored program control and executes software modules stored in memory such as persistent memory for example in the flash memory . As illustrated in the software modules comprise operating system software and software applications which may include an email messaging application an address book an instant messaging application a phone application and remote credential management module . In some example embodiments the functions performed by each of the applications and may each be realized as a plurality of independent elements and any one or more of these elements may be implemented as parts of other software applications . In some example embodiments one or more applications are configured to exchange authorization messages and user credentials with a user identity server .

For illustration purposes shows a remote credential management module . In some example embodiments the remote credential management module may be configured to generate various encryption keys create digital signatures and generate various authentication tokens.

In some embodiments the remote credential management module may be further configured to exchange authentication messages and tokens and once authenticated to exchange credential information with the user identity server .

Although the remote credential management module is shown as an individual module or application in many embodiments the functions of the remote credential management module described above and detailed further below may be implemented within individual applications such as the email messaging application or within the operating system and not necessarily using a separate module or application. The present application contemplates all such implementations.

The software modules or parts thereof may be temporarily loaded into volatile memory such as the RAM . The RAM is used for storing runtime data variables and other types of data or information. Although specific functions are described for various types of memory this is merely one example and different assignment of functions to types of memory could also be used.

In some embodiments the auxiliary input output I O subsystems may comprise an external communication link or interface for example an Ethernet connection. The mobile device may comprise other wireless communication interfaces for communicating with other types of wireless networks for example a wireless network such as an orthogonal frequency division multiplexed OFDM network or a GPS Global Positioning System subsystem comprising a GPS transceiver for communicating with a GPS satellite network not shown . The auxiliary I O subsystems may comprise a pointing or navigational tool input device such as a clickable trackball or scroll wheel or thumbwheel or a vibrator for providing vibratory notifications in response to various events on the device such as receipt of an electronic message or incoming phone call or for other purposes such as haptic feedback touch feedback .

In some embodiments the mobile device also includes a removable memory card typically comprising flash memory and a memory card interface . Network access typically associated with a subscriber or user of the mobile device via the memory card which may be a Subscriber Identity Module SIM card for use in a GSM network or other type of memory card for use in the relevant wireless network type. The memory card is inserted in or connected to the memory card interface of the mobile device in order to operate in conjunction with the wireless network .

The mobile device also stores other data in an erasable persistent memory which in one example embodiment is the flash memory . In various embodiments the data includes service data comprising information required by the mobile device to establish and maintain communication with the wireless network . The data may also include user application data such as email messages address book and contact information calendar and schedule information notepad documents image files and other commonly stored user information stored on the mobile device by its user and other data. The data stored in the persistent memory e.g. flash memory of the mobile device may be organized at least partially into a number of databases each containing data items of the same data type or associated with the same application. For example email messages contact records and task items may be stored in individual databases within the device memory.

The data stored in memory volatile or non volatile may include user credentials . In some embodiments the user credentials comprise data relating to the user s identities permissions and privileges associated with various services to which the mobile device connects. For example the user credentials may include usernames passwords encryption keys tokens or other information associated with the verification of identities and privileges.

In some embodiments some of the user credentials may be sent or received by the remote credential management module to or from a user identity server using one of the methods described herein.

The serial data port may be used for synchronization with a user s host computer system not shown . The serial data port enables a user to set preferences through an external device or software application and extends the capabilities of the mobile device by providing for information or software downloads to the mobile device other than through the wireless network . The alternate download path may for example be used to load an encryption key onto the mobile device through a direct reliable and trusted connection to thereby provide secure device communication.

In some embodiments the mobile device is provided with a service routing application programming interface API which provides an application with the ability to route traffic through a serial data i.e. USB or Bluetooth Bluetooth is a registered trademark of Bluetooth SIG Inc. connection to the host computer system using standard connectivity protocols. When a user connects their mobile device to the host computer system via a USB cable or Bluetooth connection traffic that was destined for the wireless network is automatically routed to the mobile device using the USB cable or Bluetooth connection. Similarly any traffic destined for the wireless network is automatically sent over the USB cable or Bluetooth connection to the host computer system for processing.

The mobile device also includes a battery as a power source which is typically one or more rechargeable batteries that may be charged for example through charging circuitry coupled to a battery interface such as the serial data port . The battery provides electrical power to at least some of the electrical circuitry in the mobile device and the battery interface provides a mechanical and electrical connection for the battery . The battery interface is coupled to a regulator not shown which provides power V to the circuitry of the mobile device .

The short range communication subsystem is an additional optional component which provides for communication between the mobile device and different systems or devices which need not necessarily be similar devices. For example the subsystem may include an infrared device and associated circuits and components or a wireless bus protocol compliant communication mechanism such as a Bluetooth communication module to provide for communication with similarly enabled systems and devices.

A predetermined set of applications that control basic device operations including data and possibly voice communication applications will normally be installed on the mobile device during or after manufacture. Additional applications and or upgrades to the operating system or software applications may also be loaded onto the mobile device through the wireless network the auxiliary I O subsystem the serial port the short range communication subsystem or other suitable subsystem . The downloaded programs or code modules may be permanently installed for example written into the program memory i.e. the flash memory or written into and executed from the RAM for execution by the processor at runtime. Such flexibility in application installation increases the functionality of the mobile device and may provide enhanced on device functions communication related functions or both. For example secure communication applications may enable electronic commerce functions and other such financial transactions to be performed using the mobile device .

The mobile device may provide two principal modes of communication a data communication mode and an optional voice communication mode. In the data communication mode a received data signal such as a text message an email message or Web page download will be processed by the communication subsystem and input to the processor for further processing. For example a downloaded Web page may be further processed by a browser application or an email message may be processed by the email messaging application and output to the display . A user of the mobile device may also compose data items such as email messages for example using the input devices in conjunction with the display screen . These composed items may be transmitted through the communication subsystem over the wireless network .

In the voice communication mode the mobile device provides telephony functions and operates as a typical cellular phone. The overall operation is similar except that the received signals would be output to the speaker and signals for transmission would be generated by a transducer such as the microphone . The telephony functions are provided by a combination of software firmware i.e. the voice communication module and hardware i.e. the microphone the speaker and input devices . Alternative voice or audio I O subsystems such as a voice message recording subsystem may also be implemented on the mobile device . Although voice or audio signal output is typically accomplished primarily through the speaker the display screen may also be used to provide an indication of the identity of a calling party duration of a voice call or other voice call related information.

Reference is now made to . shows in flowchart form a method of securing user credentials in a remote repository and illustrates an example data flow for the method .

The examples described herein use the language of static key pairs and ephemeral key pairs as commonly used in cryptography. A static key is commonly associated with an identity or device and may be certified by a public key infrastructure. An ephemeral key is commonly generated on the fly and is only used for a single session. Generally ephemeral denotes a lack of need to store the private key.

While the examples below describe static and ephemeral keys these terms are used by way of example and are not limiting to the type of public private key pairs that can be used.

Before the method begins a user registers with the user identity server a password and a unique user identification UID . The password can be any string of characters that can be used to generate an encryption key. The UID is a unique identifier such as an email address username or any other identifier that has not already been used in the user identity server .

On a periodic or user triggered basis the current set of credentials stored on a device can be backed up migrated or simply secured into a credentials repository . The method begins at event with the generation of a static private key dfrom the user s password . The static private key dmay be generated using any function such as a hash function and in some embodiments may combine other user information such as a UID.

In some embodiments the static public key Qis generated from the static private key d. In elliptic curve cryptography ECC Q dG wherein G is a point x y on an elliptic curve satisfying the equation y x ax b where a and b are constants. The details of standard elliptic curve cryptology can be found in the Standards for Efficient Cryptograph Group s Standards for Efficient Cryptography 1 Elliptic Curve Cryptography SEC1 . dand Qform a static public private key pair .

At event an ephemeral public private key pair d Q is also generated using elliptic curve cryptography. In some embodiments the ephemeral private key dis a random or pseudo random number and may be generated from an entropy source or a random number generator .

At event a storage key Kis generated from the private ephemeral key dand the public static key Qusing the elliptic curve Diffie Hellman ECDH scheme.

At event the storage key Kis used to encrypt a set of credentials CR stored on the communication device .

At event a signature SigCR for the encrypted credentials is generated with the static private key dusing a digital signature algorithm. In some embodiments the signature used is the elliptical curve digital signature algorithm ECDSA as described in the aforementioned SEC1.

At event the encrypted set of credentials EncCR the signature SigCR and the public ephemeral key Qare stored in the credentials repository in conjunction with the user s UID. In some embodiments the information stored in the credentials repository further comprises timestamps or version information which may be generated from a timesource or a revision management system. In some embodiments the encrypted set of credentials EncCR the signature SigCR the public ephemeral key Q and the optional timestamp or version information may be stored in the credentials repository together as a tuple .

When a communication device wishes to access or update the credentials stored in the credentials repository the communication device must first authenticate its identity to the user identity server by the example method illustrated in . Prior to the communication device s request the user s unique identification UID and an authentication token are registered with the user identity server . The authentication token is created from a hash of the UID and the password.

At event the communication device sends an access request to the user identity server with the UID and a random number R1. The user identity server responds at event by challenging the communication device with a second random number R2.

At event the communication device generates a response token and sends it to the user identity server . The response token is generated from the hash of the two random numbers R1 and R2 and the hash of the UID and password.

At event the user identity server generates a verification token from the hash of the two random numbers R1 and R2 and the authentication token.

If the response token and the verification token match the communication device is authenticated and is permitted to access the secured user credentials.

Once authenticated the user can access the credential information stored on the credentials repository as illustrated in . At event the user can receive encrypted credentials signatures public ephemeral keys and any other information associated with the user s UID.

At event the private static key dcan be re generated from the user s password by using the technique utilized to generate dat event .

At event the private static key dis used to verify the signature SigCR of the encrypted set of credentials EncCR. In some embodiments the signature verification used is the elliptical curve digital signature algorithm ECDSA verification function.

At event the storage key Kis re generated from the static private key dand the public ephemeral key Qusing the elliptic curve Diffie Hellman ECDH scheme. This storage key is identical to the storage key initially generated to encrypt the credentials as illustrated by the following equation K dQ ddG ddG dQ

At event the communication device can be populated with the credentials. In some embodiments the entire set of credentials can be populated onto the device while in other embodiments the user may populate the device with selected credentials only.

While the present disclosure is primarily described in terms of methods the present disclosure is also directed to various apparatus including components for performing at least some of the aspects and features of the described methods be it by way of hardware components software or any combination of the two or in any other manner. Moreover an article of manufacture for use with the apparatus such as a pre recorded storage device or other similar computer readable medium including program instructions recorded thereon. It is understood that such apparatuses or articles of manufacture also come within the scope of the present disclosure.

The various embodiments presented above are merely examples and are in no way meant to limit the scope of this disclosure. In particular features from one or more of the above described embodiments may be selected to create alternative embodiments comprised of a sub combination of features which may not be explicitly described above. In addition features from one or more of the above described embodiments may be selected and combined to create alternative embodiments comprised of a combination of features which may not be explicitly described above. Features suitable for such combinations and sub combinations would be readily apparent to persons skilled in the art upon review of the present application as a whole. The subject matter described herein and in the recited claims intends to cover and embrace all suitable changes in technology.

