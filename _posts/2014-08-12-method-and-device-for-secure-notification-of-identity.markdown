---

title: Method and device for secure notification of identity
abstract: A system, methods and devices for the secure notification of an identity in a communications network. The methods include sending or receiving a communication including a hash of a certificate of a device to notify or detect the presence of the device in a network. Each certificate is associated with an identity which is excluded from the communication of the hash of the certificate. The received hash is compared to hashes of certificates stored in an electronic device to determine an identity. The identity may represent an electronic device or a user of the electronic device.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09300655&OS=09300655&RS=09300655
owner: BlackBerry Limited
number: 09300655
owner_city: Waterloo
owner_country: CA
publication_date: 20140812
---
This application is a continuation of U.S. patent application Ser. No. 13 566 252 filed Aug. 3 2012. U.S. patent application Ser. No. 13 566 252 claimed benefit to U.S. Patent Application Ser. No. 61 566 410 filed Dec. 2 2011. The contents of both documents are hereby incorporated herein by reference.

Example embodiments relate to the fields of notification of presence in a communications network security and authentication and more specifically to the secure communication of an identity.

Some conventional communications systems involve a process of communication of an identity in a communications network. The identity may be a serial number account name or user name associated with an electronic device or associated with a user of an electronic device. The process of communicating an identity using current protocols is unsecure. Thus other devices can eavesdrop and monitor traffic on a computer network and determine the identities of users or devices or users and devices present in the network. It may be difficult to establish a link or communications between devices or between users of devices without other users and devices being able to monitor or receive the identity.

According to an embodiment of the present disclosure there is provided a method of secure notification of presence of an electronic device in a communications network the method comprising obtaining a certificate associated with an identity in an electronic device generating a hash of the certificate and sending a communication including the hash of the certificate to a communications network the communication excluding information regarding the identity.

According to another embodiment of the present disclosure there is provided an electronic device comprising a communication subsystem for sending and receiving communications over a network a memory storing a certificate associated with an identity and a processor configured to obtain the certificate generate a hash of the certificate and send a communication including the hash of the certificate to the communications network the communication excluding information regarding the identity.

According to another embodiment of the present disclosure there is provided a method of secure identification of a sending electronic device using a receiving electronic device the method comprising storing one or more certificates in a memory of a receiving electronic device each of the certificates associated with an identity receiving a communication from a communications network the communication including a received hash of a certificate of a sending device the communication excluding information regarding the identity comparing the received hash with hashes of the one or more stored certificates and on a condition that the received hash corresponds to one of the hashes of the stored certificates identifying the identity of the sending device as the identity associated with the received hash.

According to another embodiment of the present disclosure there is provided an electronic device comprising a communication subsystem for sending and receiving communications over a network a memory storing a plurality of certificates each certificate associated with an identity and a processor configured to receive a communication from the network the communication including a received hash of a certificate of a sending device and excluding information regarding an identity of the sending device compare the received hash with hashes of the plurality of store certificates and on a condition that the received hash corresponds to one of the hashes of the stored certificates identify the identity of the sending device as the identity associated with the received hash.

According to another embodiment of the present disclosure there is provided a system for secure communications the system comprising a communications network a sending electronic device configured to obtain a certificate associated with an identity of the sending electronic device and send a communication including a hash of the certificate to the communications network the communication excluding information regarding the identity a receiving electronic device configured to store a plurality of certificates associated with one or more identities in a memory of the receiving device receive the communication including the hash from the sending device compare the received hash with hashes of the plurality of stored certificates and on a condition that the received hash corresponds to one of the hashes of the stored certificates identify the identity of the sending device as the identity associated with the received hash.

In one embodiment the system comprises a server configured to store a plurality of certificates and associated identities and to communicate with sending and receiving electronic devices. In one embodiment the server is configured to respond to queries based on identity. In one embodiment the sending electronic device is configured to send a multicast message containing an address location identifying where to retrieve the hash the receiving device is configured to send a request for the hash at the address location in response to receiving the multicast message and the sending device is configured to send the hash of the certificate of the sending device in response to the request from the receiving device. In one embodiment the multicast message comprises an SSDP NOTIFY message the address location comprises a URL address of a location of the hash certificate of the sending device and wherein the request comprises an HTTP GET request of URL address. In another embodiment the receiving electronic device is configured to obtain a certificate and associate the certificate with an identity of the receiving electronic device and the identity of the sending electronic device and the identity of the receiving electronic device are associated with a user identity.

The present disclosure generally relates to a system for the secure notification of an identity of an electronic device in a communications network as well as methods and devices for sending transmissions to advertise the presence of an electronic device in the communications network and for receiving such transmissions from an electronic device . The identity may be associated with an electronic device or with a user of the electronic device . The identities of peer devices or of peer users of devices may be stored in a memory of the electronic device to permit the device to identify notifications from its known peers.

For example purposes the electronic devices may be described herein as a sending device which sends one or more transmissions to communicate the presence of the electronic device in the network and as a receiving device which receives transmissions and communications regarding the presence of other electronic devices in the network . It will be appreciated that each of the sending device and receiving device may be configured to send receive or send and receive communications according to the embodiments described herein.

In example embodiments the electronic device is a portable electronic device . It will be understood that the present application is not limited to portable electronic devices and may be implemented using non portable electronic devices such as personal or desktop computers. Examples of portable electronic devices include mobile or handheld wireless electronic devices such as pagers cellular phones cellular smart phones wireless organizers personal digital assistants wirelessly enabled notebook computers and so forth. The portable electronic device may also be a portable electronic device without wired communication capabilities such as a handheld electronic game device laptop or other device.

In an example embodiment the system supports encrypted communications and the electronic device may implement asymmetric keys which include related public key private key pairs wherein a key pair can be associated with a specified identity of a user or of a device. The electronic device may be configured to implement signing or verification or also encryption decryption using the associated keys.

For some applications a private key may be used by a sender to sign outgoing data and or to decrypt incoming data. A corresponding public key may be used by a recipient to verify a signature that is verify if the sender signed the data using the private key. In some cases a public key is used to encrypt outgoing data. A public key certificate includes the public key as well as the identity information of a device or of a user of a device. Such a public key certificate may be referred to as an identity key certificate or merely a certificate.

Various examples of verification and authentication processes are described in the ITU T X.509 standard version 11 2008 the contents of which are herein incorporated by reference. In an example implementation to sign data the sender creates a hash of the data and then signs the hash with the private key. The sender then sends the signed hash along with the data and the certificate. The recipient after receipt of these items can recreate the hash of the data verify the signed hash using the public key and finally verify the certificate. A certificate in accordance with the X.509 standard may sometimes be referred to as an X.509 certificate.

An electronic device in which example embodiments described in the present disclosure can be applied also is illustrated in . Depending on the functionality provided by the electronic device in various embodiments the device may be a multiple mode communications device configured for both data and voice communication. The communications subsystem provides for communications between the electronic device and different systems or devices which need not necessarily be similar devices.

The electronic device includes a controller such as a microprocessor which controls the overall operation of the electronic device . The controller interacts with other device components such as memory system software stored in memory input output subsystems and the communications subsystem . A power source such as one or more rechargeable batteries or a port to an external power supply powers the electronic device .

For illustration purposes shows a security module as a component of the system software . In some example embodiments the security module may perform security functions including the generation and management of private keys and or public keys. The security module may be used to perform the encryption decryption or the signing verification of data using such keys as described in detail herein.

In some example embodiments the electronic device is configured to implement encryption or verification using the associated keys. For example the electronic device may store within a key storage in memory one or more public keys one or more private keys or a combination of public keys and private keys. In some embodiments the electronic device is configured or operates as a web client and or as a server. When implementing or operating as the web server for signing the electronic device can store and use a private key to sign outgoing data. A corresponding public key may be used by a recipient or client to verify that the electronic device signed the data using the private key.

The key storage may include any portion of memory on the device . In some embodiments the memory may include a secure area in which sensitive data such as key and certificate material is stored. In some embodiments the secure area may itself be secured using cryptography to prevent unauthorized access.

In some example embodiments the security module may be used to create or store a key pair. The public key certificate may be a root certificate or a self signed certificate hereinafter root certificate for convenience . In such an instance the electronic device may be referred to as a certificate authority CA . The root certificate of a CA can be used to verify other public certificates for example in a chain of trust implementation. In some example embodiments the security module may be used to receive and store a certificate for the device generated by another entity such as a certificate authority.

An example application of a certificate is to secure a session or Internet session between parties for example using transport layer security TLS secure sockets layer SSL to implement hypertext transfer protocol secure HTTPS . Example applications include web browsing electronic mail Internet faxing instant messaging voice over IP VoIP virtual private networks VPN and peer to peer communications.

In example embodiments a thumbprint fingerprint or certificate hash represents the binary data e.g. hexadecimal representation produced by using a hashing algorithm on a certificate. Although the thumbprint uniquely identifies a certificate the thumbprint cannot be used to re create a certificate as hashing is a one way process.

Some example embodiments may be applied to a chain of trust environment. In a chain of trust certificates are issued and signed by certificate authorities that reside higher in the certificate hierarchy so that the validity and trustworthiness of a given certificate is determined by the corresponding validity of the certificate associated with the certificate authority that signed the given certificate. Thus there is often a root CA which provides the ultimate in attestation authority in that chain of trust scheme. Accordingly the root CA may be the trust anchor for the digital certificate.

Some example embodiments may be applied to a web of trust environment wherein there is no central CA and accordingly identity certificates for some or all of the clients may be self signed. In this case the additional signatures from some or all of the other clients are evaluated to determine whether a certificate should be accepted as correct. Each generated root certificate may be communicated between devices. For example at least the root certificate from the electronic device may be communicated to at least another client in the web of trust accordance with the described example embodiments. At least some of the remaining clients may similarly implement the described example embodiments.

The electronic device may store within a certificate storage in the memory a certificate of the device as well as one or more certificates of other devices . The certificates may comprise self signed certificates of the devices or certificates generated by another entity or a combination of self signed certificates and certificates generated by another entity. In one embodiment the certificates comprise certificates generated by a certificate authority CA for each device . Each certificate is associated with an identity which represents the device or which represents a user of the device . In some embodiments the identity may be included as part of the information in the certificate. Alternatively or additionally the certificates may be stored within certificate storage area along with an identity which represents the device or which represents a user of the device .

The system and electronic device support a discovery protocol to enable electronic devices to send communications to advertise the presence of the electronic device in the communications network and to receive communications regarding the presence of other electronic devices in the network . Such communications also may include an address such as a HTTP URL for a location storing an XML description of the device and services available from the device . Descriptions of the device and services available from the device may be stored in the memory of the device . Communications also may be sent in response to requests for information and to notify other devices of the withdrawal of the electronic device from the network . The discovery protocol may comprise a simple service discovery protocol SSDP a universal plug and play UPNP system a DLNA Digital Living Network Alliance service discovery and control protocol multicast DNS Domain Name System DNS SD Service Discovery a proprietary discovery or zero configuration networking protocol or other similar protocols.

The system includes a sending electronic device which is configured to send a secure notification of the presence of the device in the network . The electronic device is configured to send transmissions including a hash of a certificate of the electronic device . The certificate is associated with an identity which represents the sending device or a user of the sending device . The hash is received by a receiving electronic device which has stored in the memory of the receiving electronic device a plurality of certificates. The plurality of certificates and associated identities may represent peer or known devices or users in the network . The receiving device compares the received hash with hashes of the plurality of certificates stored in the memory of the receiving device . If the received hash corresponds to a hash of one of the plurality of certificates stored in the electronic device the identity associated with the certificate for the corresponding hash is used to identify the originator of the transmission as one of the peers or identities known to the device . The identity which may represent the identity of the sending device or the identity of a user of sending device and presence of the identity in the communications network is thus determined by the receiving device in a secure manner.

A method of secure notification of the presence of a device in the communications network is illustrated in and is described in further detail below. An electronic device obtains a certificate which is associated with an identity and which is stored in the certificate storage of the memory . In some embodiments the certificate includes the identity. In some embodiments the method includes associating the certificate with the identity. A hash of the certificate is generated and also may be stored in the certificate storage . The hash of the certificate of the sending device is sent to the communications network . The hash of the certificate may be sent as a broadcast or multicast message or it may be sent in response to a request to the sending device . The hash of the certificate is transmitted instead of transmitting an identity or an identifier of the electronic device such as a device serial number. Thus if the transmission is monitored by other devices or intercepted the identity is not likely to be compromised.

At the sending electronic device obtains a certificate. In some embodiments the certificate is obtained by the device by the security module generating a self signed certificate or root certificate. In some embodiments the certificate is obtained by the device from another device or entity such as a CA. The certificate is generated by the CA and may be transmitted to the device or downloaded by or to the device over a communications network or a communications network . In some embodiments the certificate from the CA may be configured in the device . In some embodiments the certificate is generated in accordance with the X.509 standard. The certificate is stored in the memory of the electronic device such as in the certificate storage .

In some embodiments the information in the certificate includes an associated identity. In some embodiments the certificate is associated with or linked to an identity. The identity comprises information identifying the device or information identifying a user of the device or information identifying both the device and a user of the device . The identity may comprise a serial number of the device an account number an identification number or user name. In one embodiment the identity comprises a BlackBerry ID BBID . The identity in turn may be associated with a user of the device . The identity can include a common name and a network identifier such as a MAC address or IP address. The common name can include personal information desired to remain secure or private such as a name email address employer corporation and the like. In one example embodiment the certificate is associated with one identity representing a user of the device . It will be appreciated that an identity such as an identity representing a user may be associated with more than one certificate and more than one device . In one example embodiment the identity is associated with a first device of a user such as a mobile phone or smart phone and also with a second device of the user such as a tablet computer. The certificate includes or is associated with an identity in order to permit a receiving device to determine the identity associated with a hash of the certificate as described below.

The certificates and associated identities may be received from and provided to the devices in a number of ways. In one embodiment a directory server is configured to store certificates and associated identities and to provide a directory service for identities. The directory service may receive a query from an electronic device requesting the certificates associated with one or more identities. The certificates and associated identities provided by the directory service may be stored in the electronic device such as in the certificate storage . As described above the identity may be included in the information in the certificate or the identity may comprise information separate from and associated with or linked to the certificate. In one embodiment a peer group may be defined comprising a number of identities which may receive the certificates of other identities in the peer group. The identities may be representative of peers or a known group of users of the devices . The directory service may be configured to accept and respond to queries based on permissions associated with the electronic device or a user of the electronic device or an identity for example to restrict requests for identities to members of a peer group. An electronic device or a user of an electronic device may belong to more than one peer group such as a group of coworkers organization members or friends.

The directory service may be maintained by the directory server in the communications network and may be accessed through a secure communication channel in the network . In some embodiments where the communications network does not support secure communications the directory server may be accessed through a separate secure communications network as illustrated in . In one embodiment an electronic device is configured to store certificates and associated identities and to provide a directory service for identities.

The certificates of one or more electronic devices may be associated with identities and entered and stored in the electronic device through other methods. The certificates and associated identities may be stored in the device during a configuration of the device . Alternatively two users of two electronic devices or one user of two electronic devices may exchange respective certificates and associated identities through a direct secure communication link between the two devices or through communication channels separate from the devices such as secure communications channels. Respective certificates and associated identities of two electronic devices may be exchanged through a secure communications network separate from communications network .

A hash of the certificate of the sending device is generated . The hash may be generated using known algorithms such as secure hash algorithm SHA1 or other message digest MD algorithms. The hash of the certificate of the sending device may be stored in the certificate storage of the sending device. In one embodiment the sending and receiving devices and the system are configured to employ the same algorithm for generating hashes of certificates. In one embodiment the hash algorithm is included in a communication from the sending device .

In one embodiment the sending device identifies itself and advertises or notifies other devices of its presence in the network by sending a message including the hash of the certificate of the sending device . In some embodiments the message comprises a broadcast or multicast message including the hash of the certificate of the sending device . In some embodiments a non secure communication channel initially may be established over the communications network for communication of the hash.

In another embodiment the sending device identifies itself and advertises its presence by sending multiple transmissions. A first transmission comprises a broadcast or multicast message which includes one or more device parameters of the sending device . The device parameters provide information regarding services available from the device but do not include information regarding an identity of the device or of a user of the device . In one embodiment the device parameters include an address which identifies a location of the sending device where device information regarding the sending device is stored and may be obtained. Such device information includes the hash of the certificate of the sending device as well as information including but not limited to descriptions of services available from the sending device and other functions identifiers or parameters. In response to the first transmission a receiving device may submit a request based on the device parameters such as a request for the information stored at an address location for the sending device. The sending device sends a second transmission which comprises a message to the receiving device including the hash of the certificate of the sending device . In one embodiment the message of the first or second transmission includes an identification of the algorithm used to create the hash of the certificate of the sending device .

With the communication of a hash of the certificate of the sending device the identity associated with the certificate and therefore an identity associated with the sending device may be determined by receiving devices as described below. In example embodiments in response to receiving the device information and hash which may be used by the receiving device to identify the sending device the receiving device may initiate further secure communications with the sending device .

In the examples provided above a client or receiving device may subsequently request an HTTPS connection with the server or sending device in order to validate the identity of the sending device . In the event that another electronic device for reference a spoofing device has attempted to use the identity associated with the sending device by using and sending the hash of the sending device as hash of the spoofing device the attempted HTTPS connection would fail since the spoofing device does not have the key used for the certificate of the sending device .

A method of secure identification of the presence of a device in the communications network is illustrated in and is described in further detail below. A receiving electronic device stores or pre stores a plurality of certificates in a memory of the device such as in the certificate storage . Each of the plurality of certificates is associated with an identity of a device or of a user of a device in the network . In some embodiments the certificates include the associated identity information. A message is received from the communications network which includes a hash of a certificate of a sending device . The received hash is compared with hashes of the certificates stored in the certificate storage of the receiving device . If a match is found between the received hash and the hashes of certificates stored in the receiving device the identity associated with the corresponding or matching hash is linked to the sending device . A receiving device configured with the certificates and identities of one or more devices in a network may identify the presence of a sending device in the network . Other devices not configured with the certificates and identities are unable to identify the presence of the sending device and the identity in the network .

In the method a number of certificates of devices and associated identities are stored in the receiving device . The certificates and associated identities may be stored in the certificate storage which may comprise a secure area of memory. In one embodiment the certificates and associated identities are stored in the receiving device during a configuration of the device . In another embodiment the receiving device is configured to send a query to a directory service provided by a directory server to request and receive copies certificates and associated identities. As described above the identities may be representative of peers or a known group of users of the devices . Alternatively two users of two electronic devices or one user of two electronic devices may exchange respective certificates and associated identities through a direct or indirect secure communication link between the two devices. Respective certificates and associated identities of two electronic devices may be exchanged through a secure communications channel in network or through a secure communications network separate from communications network . In some embodiments hashes of the stored certificates are generated using a predetermined algorithm such as secure hash algorithm SHA1 or other message digest MD algorithms. The generated hashes may also be stored in the certificate storage in association with the certificates and identities. In other embodiments hashes of the stored certificates are generated each time a comparison with a received hash is performed.

The receiving device receives communications from the network which include messages announcing the presence of other devices such as a sending device in the network . In one embodiment the received communication comprises a message which includes a hash of the certificate of the sending device . In another embodiment multiple communications occur and the first received communication comprises a broadcast or multicast message which includes one or more device parameters of the sending device . The device parameters provide information regarding services available from the device but do not include information regarding an identity of the device or of a user of the device . In one embodiment the device parameters include an address which identifies a location of the sending device where device information regarding the sending device is stored and may be obtained. Such device information includes the hash of the certificate of the sending device as well as information including but not limited to descriptions of services available from the sending device and other functions identifiers or parameters.

In response to the first received communication a receiving device may submit a request based on the device parameters to the sending device . For example a receiving device may submit a request for device information stored at an address location provided in the first received communication. A second communication is received which comprises a message to the receiving device including the hash of the certificate of the sending device the hash of the certificate of the sending device being stored at the address location. In one embodiment the message of the first or second received communication includes an identification of the algorithm used to create the hash of the certificate of the sending device .

The hash received from the sending device is compared with hashes which are generated for the certificates stored in the receiving device . In one embodiment hashes are generated for the certificates stored in the receiving device using the hash algorithm sent by the sending device . In some embodiments the hash received from the sending device is compared with hashes of the stored certificates which have been generated and stored along with the certificates and identities in the certificate storage .

If a match is found between the received hash and a hash of a certificate stored in the receiving device the identity associated with the stored certificate is used to identify the sending device as one of the peers or identities known to the receiving device . Accordingly some example embodiments may provide a secure reverse lookup of identities stored in the receiving device based on the received hash as the received hash does not itself include such device information of a user or of a device. In response to finding a match between the received hash and a hash of a certificate stored in the receiving device the receiving device may take further action such as initiating secure communications with the sending device . In one embodiment the receiving device may generate a notification to a user such as generating and displaying a message through I O subsystems to alert or inform a user of a receiving device of the identities of other devices or of other users of devices in the network . The notification of the presence of the sending device is secure since other devices in the communications network which do not have the certificate and associated identity stored in memory are not able to determine the identity associated with the sending device based only on the received hash. Such other devices may still communicate with the sending device which would be identified only by the hash of the certificate.

If no match is found between a received hash and a hash of a certificate stored in the receiving device an identity of the sending device or of a user of a sending device may be unknown. In one embodiment the receiving device is configured only to initiate further communications with a sending device where the identity is known. In other embodiments additional authentication identification or security measures may be employed to support communications between the receiving device and the unknown sending device . In one embodiment the receiving device may initiate communications with the sending device regardless of the known or unknown identity of the sending device .

In some embodiments the receiving device stores information to track the presence and identities of devices in the network including information regarding the services available from the devices . The receiving device may store other device parameters in association with the identity of the tracked devices such as a unique service name. In one embodiment if a sending device is no longer available operational or present in the network a communication may be sent to notify other devices in the network that the sending device is leaving the network . In one embodiment a broadcast or multicast message or multiple messages may be sent as described above to provide the identification of the sending device that is leaving the network . In another embodiment a broadcast or multicast message with an alternative device parameter such as a unique service name may be sent to notify receiving devices of the departure of the sending device . In another embodiment information stored to track a sending device in the network may be deleted after a predetermined time period has expired and for example additional communications or notifications from the sending device have not been received.

In some example embodiments of the methods devices and system the sending device generates a salted hash of the certificate of the sending device. A salted hash is generated by applying a hash function to a combination of the certificate of the sending device and a salt e.g. bytes of random numbers . The salted hash and the salt may be sent by the sending device in a broadcast or multicast message or provided with the device information. The receiving device similarly generates salted hashes of the certificates stored in the certificate storage in order to compare and determine whether there is a match with the received salted hash. The use of a salted hash changes the data which is transmitted as the hash of the certificate and prevents other devices from monitoring and gathering information about devices in the communications network based on repeated transmissions of the hash of a certificate.

In some example embodiments the receiving devices store in a certificate storage copies of one or more identities of peer or known devices and certificates of the peer or known devices such as identities and certificates configured in the receiving devices or obtained from a directory server as described above. In some embodiments the information in the certificate for a device includes the identity. The sending device obtains a certificate associated with an identity the identity being associated with the sending device or with a user of the sending device . The sending device generates a salted hash of the identity and sends a communication including the salted hash of the identity and the salt to the communications network . The receiving device receives the communication including the salted hash from the communications network . The receiving device compares the received salted hash with salted hashes of the identities stored in the certificate storage of the receiving device generated using the received salt and the hash algorithm. If the received salted hash corresponds to a salted hash of one of the stored identities the sending device is identified based the matching stored identity. In some embodiments the receiving device may subsequently request a secure connection with sending device in order to validate the identity of the sending device . In the event that another electronic device for reference a spoofing device has attempted to use the identity of sending device by using and sending the hash of the identity of the sending device as the hash of the identity of the spoofing device the attempted secure connection would fail since the spoofing device does not have the key used for the certificate of the sending device .

In example embodiments the sending device identifies itself and advertises its presence by sending multiple transmissions in accordance with a discovery protocol such as SSDP. In some embodiments the sending device comprises a web or HTTP server and the receiving device comprises a web or HTTP client. Examples of messages sent by example embodiments of a sending device and a receiving device according to the present disclosure are provided below.

The sending device sends a first transmission comprising a broadcast or multicast message to notify other devices of the presence of the sending device in the communications network. The first transmission may be formatted as an SSDP NOTIFY message. The message includes device parameters such as a unique service name USN and LOCATION parameter with an address consisting of a URL address where device information for the sending device is stored and may be obtained. The address may be an address of the sending device or to an external server or other electronic device which may temporarily or permanently store the device information. In some embodiments the sending device sends the first transmission or NOTIFY message on a periodic basis.

Upon receipt of the message above the receiving device may send a request based on the device parameters and specifically a request for the device information which is provided at the address indicated by the LOCATION parameter. An example request by a receiving device consisting of an SSDP GET message is provided below.

In response to the request from the receiving device the sending device sends a second transmission which comprises a message to the receiving device with the device information at the address specified in the LOCATION field. An example response is provided below.

In the example messages and embodiments provided above the device information includes the hash of the certificate of the sending device as the serial number parameter. In the above example the hash of the certificate of the sending device has a value of 2020202020202020202020202020202020202020. In an example embodiment an additional parameter is provided identifying the algorithm used to generate the hash of the certificate of the sending device .

In some embodiments communications may be sent by the sending device to announce the presence of the device in response to or after detecting that the device has entered a new network or has re entered a network . In some embodiments communications may be sent in response to a request for information. In one embodiment the sending device identifies itself and advertises its presence by sending a transmission in accordance with a discovery protocol such as MNDS DNS SD.

In one embodiment in response to a query for devices which support a specific service the sending device may send a response which includes a hash of the certificate. In one embodiment the sending device responds only to queries regarding services which are supported by the sending device . Rather than the sending device responding to a query with information such as IP address serial number or other identifying information which any other device may use to identify the sending device a response is transmitted by the sending device which includes a hash of the certificate of the sending device.

Example communications of an embodiment according to an MDNS DNS SD protocol are provided in the sample network captures below. An example network query sent by a device such as a receiving device for devices supporting the service tunnel is first illustrated.

In response to this query a reply is sent by the sending device . In one embodiment in place of an IP address identifying a service name a hash of a certificate of the sending device may be transmitted. As illustrated below in one embodiment in place of a service name or IP address identifying the sending device a communication is transmitted which includes a salt and a truncated salted hash of a certificate of the sending device .

In the sample message illustrated above the response includes the service name 0e1c72e42671d102578877cd90ba06 . The first 40 bits of the service name represents the salt and the remaining bits represent a truncated salted hash of the certificate of the sending device . The hash or salted hash of the sending device may be truncated due to size limitations in the service name parameter.

At the receiving device the truncated salted hash is compared with salted hashes of the certificates stored in the certificate storage of the receiving device . If a match is found between the received truncated salted hash and the first or a truncated portion of a salted hash of a certificate stored in the receiving device the identity associated with the corresponding or matching hash is linked to the sending device .

The WWAN may be implemented as any suitable wireless access network technology. By way of example but not limitation the WWAN may be implemented as a wireless network that includes a number of transceiver base stations one of which is shown in where each of the base stations provides wireless Radio Frequency RF coverage to a corresponding area or cell. The WWAN is typically operated by a mobile network service provider that provides subscription packages to users of the electronic devices . In some embodiments the WWAN conforms to one or more of the following wireless network types Mobitex Radio Network DataTAC GSM Global System for Mobile Communication GPRS General Packet Radio System TDMA Time Division Multiple Access CDMA Code Division Multiple Access CDPD Cellular Digital Packet Data iDEN integrated Digital Enhanced Network EvDO Evolution Data Optimized CDMA2000 EDGE Enhanced Data rates for GSM Evolution UMTS Universal Mobile Telecommunication Systems HSDPA High Speed Downlink Packet Access IEEE 802.16e also referred to as Worldwide Interoperability for Microwave Access or WiMAX or various other networks. Although WWAN is described as a Wide Area network that term is intended herein also to incorporate wireless Metropolitan Area Networks WMAN and other similar technologies for providing coordinated service wirelessly over an area larger than that covered by typical WLANs.

The WWAN may further comprise a wireless network gateway which connects the electronic devices to transport facilities and through the transport facilities to a wireless connector system . Transport facilities may include one or more private networks or lines the public internet a virtual private network or any other suitable network. The wireless connector system may be operated for example by an organization or enterprise such as a corporation university or governmental department which allows access to a network such as an internal or enterprise network and its resources or the wireless connector system may be operated by a mobile network provider. In some embodiments the network may be realised using the internet rather than an internal or enterprise network.

The wireless network gateway provides an interface between the wireless connector system and the WWAN which facilitates communication between the electronic devices and other devices not shown connected directly or indirectly to the WWAN . Accordingly communications sent via the electronic devices are transported via the WWAN and the wireless network gateway through transport facilities to the wireless connector system . Communications sent from the wireless connector system are received by the wireless network gateway and transported via the WWAN to the electronic devices .

The WLAN comprises a wireless network which in some embodiments conforms to IEEE 802.11x standards sometimes referred to as Wi Fi such as for example the IEEE 802.11a 802.11b and or 802.11g standard. Other communication protocols may be used for the WLAN in other embodiments such as for example IEEE 802.11n IEEE 802.16e also referred to as Worldwide Interoperability for Microwave Access or WiMAX or IEEE 802.20 also referred to as Mobile Wireless Broadband Access . The WLAN includes one or more wireless RF Access Points AP one of which is shown in that collectively provide a WLAN coverage area.

The WLAN may be a personal network of the user an enterprise network or a hotspot offered by an internet service provider ISP a mobile network provider or a property owner in a public or semi public area for example. The access points are connected to an access point AP interface which may connect to the wireless connector system directly for example if the access point is part of an enterprise WLAN in which the wireless connector system resides or indirectly via the transport facilities if the access point is a personal Wi Fi network or Wi Fi hotspot in which case a mechanism for securely connecting to the wireless connector system such as a virtual private network VPN may be required . The AP interface provides translation and routing services between the access points and the wireless connector system to facilitate communication directly or indirectly with the wireless connector system .

The wireless connector system may be implemented as one or more servers and is typically located behind a firewall . The wireless connector system manages communications including email messages to and from a set of managed electronic devices . The wireless connector system also provides administrative control and management capabilities over users and electronic devices which may connect to the wireless connector system .

The wireless connector system allows the electronic devices to access the network and connected resources and services such as a messaging server for example a Microsoft Exchange IBM Lotus Domino or Novell GroupWise email messaging server a directory server and optionally other servers . The other servers may comprise a content server for providing content such as internet content or content from an organization s internal servers to the electronic devices in the communication network an application server for implementing server based applications such as instant messaging IM applications or a web server for providing content accessible by a web browser.

For the purposes of the described example embodiments any server within an enterprise network such as a messaging server or any other server will be referred to as an enterprise server. A service may include one or more servers or enterprise servers.

The wireless connector system typically provides a secure exchange of data e.g. email messages personal information manager PIM data and IM data with the electronic devices . In some embodiments communications between the wireless connector system and the electronic devices are encrypted. In some embodiments communications are encrypted using a symmetric encryption key implemented using Advanced Encryption Standard AES or Triple Data Encryption Standard Triple DES encryption. Private encryption keys are generated in a secure two way authenticated environment and are used for both encryption and decryption of data.

Encryption keys used for communications or for encrypting data stored on the device can be protected via various means such as a password or hardware based protections such as those afforded by hardware based key stored mechanisms.

The wireless network gateway is adapted to send data packets received from the mobile communication device over the WWAN to the wireless connector system . The wireless connector system then sends the data packets to the appropriate connection point such as the messaging server or other servers . Conversely the wireless connector system sends data packets received for example from the messaging server or other servers to the wireless network gateway which then transmit the data packets to the destination mobile electronic device . The AP interfaces of the WLAN provide similar sending functions between the mobile communication device the wireless connector system and network connection point such as the messaging server or other servers .

The network may comprise a private local area network metropolitan area network wide area network the public internet or combinations thereof and may include virtual networks constructed using any of these alone or in combination.

A mobile communication device may alternatively connect to the wireless connector system using a computer such as desktop or notebook computer via the network . A link may be provided for exchanging information between the mobile communication device and computer connected to the wireless connector system . The link may comprise one or both of a physical interface and short range wireless communication interface. The physical interface may comprise one or combinations of an Ethernet connection Universal Serial Bus USB connection Firewire also known as an IEEE 1394 interface connection or other serial data connection via respective ports or interfaces of the mobile communication device and computer . The short range wireless communication interface may be a personal area network PAN interface. A personal area network is a wireless point to point connection meaning no physical cables are required to connect the two end points. The short range wireless communication interface may comprise one or a combination of an infrared IR connection such as an Infrared Data Association IrDA connection a short range radio frequency RF connection such as one specified by IEEE 802.15.1 or the Bluetooth special interest group or IEEE 802.15.3a also referred to as UltraWideband UWB or other PAN connection.

The communications networks and mobile devices support a discovery protocol to enable the mobile to send communications to advertise the presence of the electronic device in the communications network and to receive communications regarding the presence of other mobile devices in the network . Such communications also may include an address such as a HTTP URL for a location storing an XML description of the mobile communication device . Communications also may be sent in response to requests for information and to notify other devices of the withdrawal of the electronic device from the network . The discovery protocol may comprise a simple service discovery protocol SSDP a universal plug and play UPNP system a proprietary discovery protocol or other similar protocols.

It will be appreciated that the above described communication system is provided for the purpose of illustration only and that the above described communication system comprises one possible communication network configuration of a multitude of possible configurations for use with the mobile devices . The teachings of the present disclosure may be employed in connection with any other type of network and associated devices that are effective in implementing or facilitating communication including communication over networks which are wired wireless or a combination of wired and wireless. Suitable variations of the communication system will be understood to a person of skill in the art and are intended to fall within the scope of the present disclosure.

The mobile communication device is a two way communication device having at least data and possibly also voice communication capabilities and the capability to communicate with other computer systems for example via the Internet. Depending on the functionality provided by the mobile communication device in various embodiments the device may be a data communication device a multiple mode communication device configured for both data and voice communication a smartphone a mobile telephone or a PDA personal digital assistant enabled for wireless communication or a computer system with a wireless modem.

The mobile communication device includes a case not shown housing the components of the device . The internal components of the device are constructed on a printed circuit board PCB . The mobile communication device includes a controller comprising at least one processor such as a microprocessor which controls the overall operation of the mobile communication device . The processor interacts with device subsystems such as a communication subsystem for exchanging radio frequency signals with a network such as the communication network to perform communication functions. The processor interacts with additional device subsystems including a display screen such as a liquid crystal display LCD screen input devices such as a keyboard and control buttons flash memory random access memory RAM read only memory ROM auxiliary input output I O subsystems data port such as serial data port such as a Universal Serial Bus USB data port speaker microphone short range communication subsystem and other device subsystems generally designated as . Some of the subsystems shown in perform communication related functions whereas other subsystems may provide resident or on device functions.

The device may comprise a touchscreen display in some embodiments. The touchscreen display may be constructed using a touch sensitive input surface connected to an electronic controller and which overlays the display screen . The touch sensitive overlay and the electronic controller provide a touch sensitive input device and the processor interacts with the touch sensitive overlay via the electronic controller.

The mobile communication device may communicate with any one of a plurality of fixed transceiver base stations of the cellular communications network within its geographic coverage area. The mobile communication device may send and receive communication signals over the communication network after the required network registration or activation procedures have been completed.

The processor operates under stored program control and executes software modules stored in memory such as persistent memory for example in the flash memory . The software modules comprise operating system software and software applications which for example may include a text or instant messaging application a web browser a web server an email messaging application and a security module . In some example embodiments the functions performed by each of the applications and may each be realized as a plurality of independent elements and any one or more of these elements may be implemented as parts of other software applications . In some example embodiments one or more applications are configured to receive data such as files documents or other information from a server such as a messaging server or a web or other server . Non limiting examples of data received from a server may include email attachments files transferred via file transfer protocol FTP or any other protocol documents or files downloaded from a web page via a web browser or files sent via a text or instant messaging application. In some embodiments received data includes certificates and associated identities of other electronic devices received from a directory server . The software applications may among other things each be implemented through stand alone software applications or combined together in one or more of the operating system or one or more of the other software applications . In some embodiments the functions performed by each of the above identified modules may be realized as a plurality of independent elements rather than a single integrated element and any one or more of these elements may be implemented as parts of other software applications.

In some example embodiments the mobile communication device may be configured or operate as a web client via the web browser and or as a server via the web server . The mobile communication device may be configured to implement encryption or verification using the associated keys. For example the mobile communication device may store within a key storage one or more public keys one or more private keys or a combination of public keys and private keys. The key storage may include any portion of memory on the device . In some embodiments the memory may include a secure area in which sensitive data such as key material is stored. In some embodiments the secure area may itself be secured using cryptography to prevent unauthorized access. The electronic device may store within a certificate storage area in the memory a certificate of the device as well as one or more certificates of other devices in the network . Each of the certificates may be stored in association with an identity which represents an electronic device .

In some examples the software applications may be implemented using a number of services which define the communication protocols used to communicate between a server and an application on the communication device. Some applications may only connect to a single type of server using the same communication protocol settings and will therefore only operate using a single service while other applications may connect to a variety of servers using different communication protocols and will require multiple services. For example a banking application on a communication device may only require a single service defining the communication protocol for securely communicating with the bank s online banking server while a web browser may require many different services such as services for general web page browsing for secure web page browsing for streaming video for accessing corporate web email or for accessing online public email services.

For illustration purposes shows a security module as a component of the operating system . In some example embodiments the security module may perform security functions including the generation and management of private keys and or public. The security module may be used to perform the encryption decryption or the signing verification of data using such keys as described in detail herein. The security module may be used to create a certificate for the device .

The software modules or parts thereof may be temporarily loaded into volatile memory such as the RAM . The RAM is used for storing runtime data variables and other types of data or information as will be apparent to those skilled in the art. Although specific functions are described for various types of memory this is merely an example and a different assignment of functions to types of memory could also be used.

In some embodiments the auxiliary input output I O subsystems may comprise an external communication link or interface for example an Ethernet connection. The mobile communication device may comprise other wireless communication interfaces for communicating with other types of wireless networks for example a wireless network such as an orthogonal frequency division multiplexed OFDM network or a GPS transceiver for communicating with a GPS satellite network not shown . The auxiliary I O subsystems may comprise a pointing or navigational tool input device such as a clickable trackball or scroll wheel or thumbwheel a vibrator for providing vibratory notifications in response to various events on the mobile communication device such as receipt of an electronic communication or incoming phone call or for other purposes such as haptic feedback touch feedback .

In some embodiments the mobile communication device also includes a removable memory card typically comprising flash memory and a memory card interface . The mobile communication device can store data on the removable memory card in an erasable persistent memory which in one example embodiment is the flash memory or on both a removable memory card and in an erasable persistent memory. Network access typically associated with a subscriber or user of the mobile communication device via the memory card which may be a Subscriber Identity Module SIM card for use in a GSM network or other type of memory card for use in the relevant wireless network type. The memory card is inserted in or connected to the memory card interface of the mobile communication device in order to operate in conjunction with the communication network .

In various embodiments the data includes service data comprising information required by the mobile communication device to establish and maintain communication with the communication network . The data may also include user application data such as email messages address book and contact information calendar and schedule information word processor documents spreadsheets presentation slides image files audio and video files and other commonly stored user information stored on the mobile communication device by its user and other data. The data may include certificates and associated identities of other electronic devices . The data stored in the persistent memory e.g. flash memory of the mobile communication device may be organized at least partially into a number of databases each containing data items of the same data type or associated with the same application. For example email messages contact records and task items may be stored in individual databases within the device memory.

In some embodiments the mobile communication device is provided with a service routing application programming interface API which provides an application with the ability to route traffic through a serial data i.e. USB or Bluetooth Bluetooth is a registered trademark of Bluetooth SIG Inc. connection to the host computer system using standard connectivity protocols. When a user connects their mobile communication device to the host computer system via a USB cable or Bluetooth connection traffic that was destined for the communication network is automatically routed to the mobile communication device using the USB cable or Bluetooth connection. Similarly any traffic destined for the communication network is automatically sent over the USB cable Bluetooth connection to the host computer system for processing.

The serial data port may be used for synchronization with a user s host computer system not shown . The serial data port enables a user to set preferences through an external device or software application and extends the capabilities of the mobile communication device by providing for information or software downloads to the mobile communication device other than through the communication network . The alternate download path may for example be used to load an encryption key onto the mobile communication device through a direct reliable and trusted connection to thereby provide secure device communication. The alternate download path may be used to store certificates and associated identities in the mobile communications device . In some embodiments data received from a server include certificates and associated identities of other electronic devices .

The mobile communication device also includes a battery as a power source which is typically one or more rechargeable batteries that may be charged for example through charging circuitry coupled to a battery interface such as the serial data port . The battery provides electrical power to at least some of the electrical circuitry in the mobile communication device and the battery interface provides a mechanical and electrical connection for the battery . The battery interface is coupled to a regulator not shown which provides power V to the circuitry of the mobile communication device .

The short range communication subsystem is an additional optional component which provides for communication between the mobile communication device and different systems or devices which need not necessarily be similar devices. For example the subsystem may include an infrared device and associated circuits and components or a wireless bus protocol compliant communication mechanism such as a Bluetooth communication module to provide for communication with similarly enabled systems and devices.

A predetermined set of applications that control basic device operations including data and possibly voice communication applications will normally be installed on the mobile communication device during or after manufacture. Additional applications and or upgrades to the operating system or software applications may also be loaded onto the mobile communication device through the communication network the auxiliary I O subsystem the serial port the short range communication subsystem or other suitable subsystems or other wireless communication interfaces. The downloaded programs or code modules may be permanently installed for example written into the program memory i.e. the flash memory or written into and executed from the RAM for execution by the processor at runtime. Such flexibility in application installation increases the functionality of the mobile communication device and may provide enhanced on device functions communication related functions or both. For example secure communication applications may enable electronic commerce functions and other such financial transactions to be performed using the mobile communication device .

The mobile communication device may provide two principal modes of communication a data communication mode and an optional voice communication mode. In the data communication mode a received data signal such as a text message an email message or web page download will be processed by the communication subsystem and input to the processor for further processing. For example a downloaded web page may be further processed by a web browser module to parse the HTML structure and format of the web page and output the web page to the display . A user of the mobile device may also compose data items such as email messages for example using the input devices in conjunction with the display screen . These composed items may be transmitted through the communication subsystem over the communication network .

In the voice communication mode the mobile communication device provides telephony functions and operates as a typical cellular phone. The overall operation is similar except that the received signals would be output to the speaker and signals for transmission would be generated by a transducer such as the microphone . The telephony functions are provided by a combination of software firmware i.e. the voice communication module and hardware i.e. the microphone the speaker and input devices . Alternative voice or audio I O subsystems such as a voice message recording subsystem may also be implemented on the mobile communication device . Although voice or audio signal output is typically accomplished primarily through the speaker the display screen may also be used to provide an indication of the identity of a calling party duration of a voice call or other voice call related information.

While the present disclosure is primarily described in terms of methods a person of ordinary skill in the art will understand that the present disclosure is also directed to various apparatus such as a handheld electronic device including components for performing at least some of the aspects and features of the described methods be it by way of hardware circuits software or any combination of the two or in any other manner. Moreover an article of manufacture for use with the apparatus such as a pre recorded storage device or other similar computer readable medium including program instructions recorded thereon or a computer data signal carrying computer readable program instructions may direct an apparatus to facilitate the practice of the described methods. It is understood that such apparatus articles of manufacture and computer data signals also come within the scope of the present disclosure.

The term computer readable medium as used herein means any medium which can store instructions for use by or execution by a computer or other computing device including but not limited to a portable computer diskette a hard disk drive HDD a random access memory RAM a read only memory ROM an erasable programmable read only memory EPROM or flash memory an optical disc such as a Compact Disc CD Digital Versatile Disc DVD or Blu ray Disc and a solid state storage device e.g. NAND flash or synchronous dynamic RAM SDRAM .

Variations may be made to some example embodiments which may include combinations and sub combinations of any of the above. The various embodiments presented above are merely examples and are in no way meant to limit the scope of this disclosure. Variations of the innovations described herein will be apparent to persons of ordinary skill in the art having the benefit of the present disclosure such variations being within the intended scope of the present disclosure. In particular features from one or more of the above described embodiments may be selected to create alternative embodiments comprised of a sub combination of features which may not be explicitly described above. In addition features from one or more of the above described embodiments may be selected and combined to create alternative embodiments comprised of a combination of features which may not be explicitly described above. Features suitable for such combinations and sub combinations would be readily apparent to persons skilled in the art upon review of the present disclosure as a whole. The subject matter described herein intends to cover and embrace all suitable changes in technology.

While the present disclosure is described at least in part in terms of methods a person of ordinary skill in the art will understand that the present disclosure is also directed to the various components for performing at least some of the aspects and features of the described methods be it by way of hardware components software or any combination of the two or in any other manner. Moreover the present disclosure is also directed to a pre recorded storage device or other similar computer readable medium including program instructions stored thereon for performing the methods described herein.

The various embodiments presented above are merely examples and are in no way meant to limit the scope of this disclosure. Variations of the innovations described herein will be apparent to persons of ordinary skill in the art such variations being within the intended scope of the present disclosure. In particular features from one or more of the above described embodiments may be selected to create alternative embodiments comprised of a sub combination of features which may not be explicitly described above. In addition features from one or more of the above described embodiments may be selected and combined to create alternative embodiments comprised of a combination of features which may not be explicitly described above. Features suitable for such combinations and sub combinations would be readily apparent to persons skilled in the art upon review of the present disclosure as a whole. The subject matter described herein and in the recited claims intends to cover and embrace all suitable changes in technology.

