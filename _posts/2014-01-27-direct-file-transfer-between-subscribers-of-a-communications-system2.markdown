---

title: Direct file transfer between subscribers of a communications system
abstract: Systems and techniques for transferring a file from a first client associated with a first subscriber to a communications system to a second client associated with a second subscriber to the communications system by connecting from the first client to a communications system host; sending, through the communications system host, a request to the second client to establish a direct connection to the second client; when the second client accepts the request, establishing a direct connection to the second client that bypasses the communications system host; and transferring a file over the direct connection.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09571560&OS=09571560&RS=09571560
owner: FACEBOOK, INC.
number: 09571560
owner_city: Menlo Park
owner_country: US
publication_date: 20140127
---
This application is a continuation of U.S. application Ser. No. 14 164 716 filed Jan. 27 2014 which is a continuation of U.S. application Ser. No. 13 154 328 filed on Jun. 6 2011 which is a continuation of U.S. application Ser. No. 12 110 996 filed on Apr. 28 2008 and issued as U.S. Pat. No. 7 958 243 which is a continuation of U.S. application Ser. No. 09 597 784 filed on Jun. 16 2000 and issued as U.S. Pat. No. 7 366 779. Each of the afore mentioned applications and patents are hereby incorporated by reference in their entirety.

The present invention relates generally to transferring files between subscribers of a communications system.

Online service providers are constantly offering new services and upgrading existing services to enhance their subscribers online experience. Subscribers have virtually on demand access to news weather financial sports and entertainment services as well as the ability to transmit electronic messages and to participate in online discussion groups. For example subscribers of online service providers such as America Online or CompuServe may view and retrieve information on a wide variety of topics from servers located throughout the world. A server may be maintained by the service provider or by a third party provider who makes information and services available through the worldwide network of computers that make up the online service.

America Online has provided subscribers with the ability to send and receive instant messages. Instant messages are private online conversations between two or more people who have subscribed to the instant messaging service and have installed the necessary software. Because such online conversations take place virtually in real time instant messaging can provide immediate access to desired information. Instant messaging is becoming a preferred means of communicating among online subscribers.

In one general aspect a file is transferred from a first client associated with a first subscriber to a communications system to a second client associated with a second subscriber to the communications system by connecting from the first client to a communications system host sending through the communications system host a request to the second client to establish a direct connection to the second client when the second client accepts the request establishing a direct connection to the second client that bypasses the communications system host and transferring a file over the direct connection.

Implementations may include authenticating the request by the communications system host. The second client may accept the request based on indicated preferences of the second subscriber. The direct connection may be initiated by the second client. The direct connection may be established using an IP address of the second client. A graphical user interface may be displayed indicating that a direct connection to the second client is established. The communications system host may be an instant messaging host. The file may comprise a data file a text file a graphics file an audio file and or a video file. The direct connection may be a socket connection.

In another general aspect a file is transferred from a first client associated with a first subscriber to a communications system to a second client associated with a second subscriber to the communications system by connecting from the second client to a communications system host receiving through the communications system host a request from the first client to establish a direct connection accepting the request from the first client establishing a direct connection to the first client that bypasses the communications system host and receiving a file over the direct connection.

Implementations may include authenticating the request by the communications system host. The request may be accepted based on indicated preferences of the second subscriber. The second client may initiate the direct connection. The direct connection may be established by the first client using an IP address of the second client. A graphical user interface may be displayed indicating that a direct connection to the first client is established. The communications system host may be an instant messaging host. The file may be a data file a text file a graphics file an audio file and or a video file. The second client may receive an indication that the first subscriber using the first client is composing a message and then may receive the message composed by the first subscriber from the first client. The direct connection may be a socket connection.

Aspects of the present invention may be implemented by an apparatus and or by a computer program stored on a computer readable medium. The computer readable medium may comprise a disc a client device a host device and or a propagated signal.

In another general aspect a first client associated with a first subscriber to a communications system communicates with a second client associated with a second subscriber to the communications system by connecting from the second client to a communications system host establishing a direct connection to the client that bypasses the communications system host receiving an indication that the first subscriber using the first client is composing a message and receiving the message composed by the first subscriber from the first client.

The indication may be a text message and or an icon. The communications system host may be an instant messaging host.

Other features and advantages will be apparent from the following description including the drawings and from the claims.

For illustrative purposes describe a communications system for implementing techniques for transferring files between subscribers of an instant messaging host complex. For brevity several elements in the figures described below are represented as monolithic entities. However as would be understood by one skilled in the art these elements each may include numerous interconnected computers and components designed to perform a set of specified operations and or dedicated to a particular geographical region.

Referring to a communications system is capable of delivering and exchanging data between a client system and a host system through a communications link . The client system typically includes one or more client devices and or client controllers . For example the client system may include one or more general purpose computers e.g. personal computers one or more special purpose computers e.g. devices specifically programmed to communicate with each other and or the host system or a combination of one or more general purpose computers and one or more special purpose computers. The client system may be arranged to operate within or in concert with one or more other systems such as for example one or more LANs Local Area Networks and or one or more WANs Wide Area Networks .

The client device is generally capable of executing instructions under the command of a client controller . The client device is connected to the client controller by a wired or wireless data pathway capable of delivering data.

The client device and client controller each typically includes one or more hardware components and or software components. An example of a client device is a general purpose computer e.g. a personal computer capable of responding to and executing instructions in a defined manner. Other examples include a special purpose computer a workstation a server a device a component other equipment or some combination thereof capable of responding to and executing instructions. An example of client controller is a software application loaded on the client device for commanding and directing communications enabled by the client device . Other examples include a program a piece of code an instruction a device a computer a computer system or a combination thereof for independently or collectively instructing the client device to interact and operate as described herein. The client controller may be embodied permanently or temporarily in any type of machine component equipment storage medium or propagated signal capable of providing instructions to the client device .

The communications link typically includes a delivery network making a direct or indirect communication between the client system and the host system irrespective of physical separation. Examples of a delivery network include the Internet the World Wide Web WANs LANs analog or digital wired and wireless telephone networks e.g. PSTN ISDN or xDSL radio television cable satellite and or any other delivery mechanism for carrying data. The communications link may include communication pathways that enable communications through the one or more delivery networks described above. Each of the communication pathways may include for example a wired wireless cable or satellite communication pathway.

The host system includes a host device capable of executing instructions under the command and direction of a host controller . The host device is connected to the host controller by a wired or wireless data pathway capable of carrying and delivering data.

The host system typically includes one or more host devices and or host controllers . For example the host system may include one or more general purpose computers e.g. personal computers one or more special purpose computers e.g. devices specifically programmed to communicate with each other and or the client system or a combination of one or more general purpose computers and one or more special purpose computers. The host system may be arranged to operate within or in concert with one or more other systems such as for example one or more LANs Local Area Networks and or one or more WANs Wide Area Networks .

The host device and host controller each typically includes one or more hardware components and or software components. An example of a host device is a general purpose computer e.g. a personal computer capable of responding to and executing instructions in a defined manner. Other examples include a special purpose computer a workstation a server a device a component other equipment or some combination thereof capable of responding to and executing instructions. An example of host controller is a software application loaded on the host device for commanding and directing communications enabled by the host device . Other examples include a program a piece of code an instruction a device a computer a computer system or a combination thereof for independently or collectively instructing the host device to interact and operate as described herein. The host controller may be embodied permanently or temporarily in any type of machine component equipment storage medium or propagated signal capable of providing instructions to the host device .

Examples of each element within the communication system of are broadly described above with respect to . In particular the host system and communications link typically have attributes comparable to those described with respect to host system and communications link of . Likewise the client system of typically has attributes comparable to and illustrates one possible embodiment of the client system of .

The client device typically includes a general purpose computer having an internal or external storage for storing data and programs such as an operating system e.g. DOS Windows Windows 95 Windows 98 Windows 2000 Windows NT OS 2 or Linux and one or more application programs. Examples of application programs include authoring applications e.g. word processing database programs spreadsheet programs or graphics programs capable of generating documents or other electronic content client applications e.g. AOL client CompuServe client AIM client AOL TV client or ISP client capable of communicating with other computer users accessing various computer resources and viewing creating or otherwise manipulating electronic content and browser applications e.g. Netscape s Navigator or Microsoft s Internet Explorer capable of rendering standard Internet content.

The general purpose computer also includes a central processing unit CPU for executing instructions in response to commands from the client controller . In one implementation the client controller includes one or more of the application programs installed on the internal or external storage of the general purpose computer . In another implementation the client controller includes application programs externally stored in and performed by one or more device s external to the general purpose computer .

The general purpose computer typically will include a communication device for sending and receiving data. One example of the communication device is a modem. Other examples include a transceiver a set top box a communication card a satellite dish an antenna or another network adapter capable of transmitting and receiving data over the communications link through a wired or wireless data pathway . The general purpose computer also may include a TV television tuner for receiving television programming in the form of broadcast satellite and or cable TV signals. As a result the client device can selectively and or simultaneously display network content received by communications device and television programming content received by the TV tuner .

The general purpose computer typically will include an input output interface for wired or wireless connection to various peripheral devices . Examples of peripheral devices include but are not limited to a mouse a mobile phone a personal digital assistant PDA a keyboard a display monitor with or without a touch screen input and or a TV remote control for receiving information from and rendering information to subscribers.

Although illustrates devices such as a mobile telephone a PDA and a TV remote control as being peripheral with respect to the general purpose computer in another implementation such devices may themselves include the functionality of the general purpose computer and operate as the client device . For example the mobile phone or the PDA may include computing and networking capabilities and function as a client device by accessing the delivery network and communicating with the host system . Furthermore the client system may include one some or all of the components and devices described above.

Referring to a communications system is capable of delivering and exchanging information between a client system and a host system through a communication link . Client system typically includes one or more client devices and one or more client controllers for controlling the client devices . Host system typically includes one or more host devices and one or more host controllers for controlling the host devices . The communications link may include communication pathways enabling communications through the one or more delivery networks .

Examples of each element within the communication system of are broadly described above with respect to . In particular the client system and the communications link typically have attributes comparable to those described with respect to client systems and and communications links and of . Likewise the host system of may have attributes comparable to and illustrates one possible embodiment of the host systems and shown in respectively.

The host system includes a host device and a host controller . The host controller is generally capable of transmitting instructions to any or all of the elements of the host device . For example in one implementation the host controller includes one or more software applications loaded on the host device . However in other implementations as described above the host controller may include any of several other programs machines and devices operating independently or collectively to control the host device .

The host device includes a login server for enabling access by subscribers and routing communications between the client system and other elements of the host device . The host device also includes various host complexes such as the depicted OSP Online Service Provider host complex and IM Instant Messaging host complex . To enable access to these host complexes by subscribers the client system includes communication software for example an OSP client application and an IM client application. The OSP and IM communication software applications are designed to facilitate the subscriber s interactions with the respective services and in particular may provide access to all the services available within the respective host complexes.

Typically the OSP host complex supports different services such as email discussion groups chat news services and Internet access. The OSP host complex is generally designed with an architecture that enables the machines within the OSP host complex to communicate with each other and employs certain protocols i.e. standards formats conventions rules and structures to transfer data. The OSP host complex ordinarily employs one or more OSP protocols and custom dialing engines to enable access by selected client applications. The OSP host complex may define one or more specific protocols for each service based on a common underlying proprietary protocol.

The IM host complex is generally independent of the OSP host complex and supports instant messaging services irrespective of a subscriber s network or Internet access. Thus the IM host complex allows subscribers to send and receive instant messages whether or not they have access to any particular ISP. The IM host complex may support associated services such as administrative matters advertising directory services chat and interest groups related to the instant messaging. The IM host complex has an architecture that enables all of the machines within the IM host complex to communicate with each other. To transfer data the IM host complex employs one or more standard or exclusive IM protocols.

The host device may include one or more gateways that connect and therefore link complexes such as the OSP host complex gateway and the IM host complex gateway . The OSP host complex gateway and the IM host complex gateway may directly or indirectly link the OSP host complex with the IM host complex through a wired or wireless pathway. Ordinarily when used to facilitate a link between complexes the OSP host complex gateway and the IM host complex gateway are privy to information regarding the protocol type anticipated by a destination complex which enables any necessary protocol conversion to be performed incident to the transfer of data from one complex to another. For instance the OSP host complex and IM host complex generally use different protocols such that transferring data between the complexes requires protocol conversion by or at the request of the OSP host complex gateway and or the IM host complex gateway .

Referring to a communications system is capable of delivering and exchanging information between a client system and a host system through a communication link . Client system typically includes one or more client devices and one or more client controllers for controlling the client devices . Host system typically includes one or more host devices and one or more host controllers for controlling the host devices . The communications link may include communication pathways enabling communications through the one or more delivery networks . As shown the client system may access the Internet through the host system .

Examples of each element within the communication system of are broadly described above with respect to . In particular the client system and the communications link typically have attributes comparable to those described with respect to client systems and and communications links and of . Likewise the host system of may have attributes comparable to and illustrates one possible embodiment of the host systems and shown in respectively. However describes an aspect of the host system focusing primarily on one particular implementation of OSP host complex . For purposes of communicating with an OSP host complex the delivery network is generally a telephone network.

The client system includes a client device and a client controller . The client controller is generally capable of establishing a connection to the host system including the OSP host complex the IM host complex and or the Internet . In one implementation the client controller includes an OSP application for communicating with servers in the OSP host complex using exclusive OSP protocols. The client controller also may include applications such as an IM client application and or an Internet browser application for communicating with the IM host complex and the Internet .

The host system includes a host device and a host controller . The host controller is generally capable of transmitting instructions to any or all of the elements of the host device . For example in one implementation the host controller includes one or more software applications loaded on one or more elements of the host device . However in other implementations as described above the host controller may include any of several other programs machines and devices operating independently or collectively to control the host device .

The host system includes a login server capable of enabling communications with and authorizing access by client systems to various elements of the host system including an OSP host complex and an IM host complex . The login server may implement one or more authorization procedures to enable simultaneous access to the OSP host complex and the IM host complex . The OSP host complex and the IM host complex are connected through one or more OSP host complex gateways and one or more IM host complex gateways . Each OSP host complex gateway and IM host complex gateway may perform any protocol conversions necessary to enable communication between the OSP host complex the IM host complex and the Internet .

The OSP host complex supports a set of services from one or more servers located internal to and external from the OSP host complex . Severs external to the OSP host complex generally may be viewed as existing on the Internet . Servers internal to the OSP complex may be arranged in one or more configurations. For example servers may be arranged in large centralized clusters known as farms or in localized clusters known as pods .

Farms are groups of servers located at centralized locations within the OSP host complex . Farms generally are dedicated to providing particular functionality and services to subscribers and clients from a centralized location regardless of the location of the subscriber or client. Farms are particularly useful for providing services that depend upon other processes and services for information such as for example chat email instant messaging news newsgroups search stock updates and weather. Thus farms tend to rely on connections with external resources such as the Internet and or other servers within the OSP host complex . To reduce the time delays and congestion inherent in centralized processing some services offered by the OSP host complex are provided from localized servers generally known as pods . Each pod includes one or more interrelated servers capable of operating together to provide one or more services offered by the OSP host complex in a geographically localized manner the servers within a pod generally operating independently rather than relying on resources external to the pod to operate. A pod may cache content received from external sources such as farms or the Internet making frequently requested information readily available to local subscribers served by the pod . In this way pods are particularly useful in providing services that are independent of other processes and servers such as for example routing keywords and downloading certain software and graphical interface updates with reduced processing time and congestion. The determination of which servers and processes are located in the pod is made by the OSP according to load distribution frequency of requests demographics and other factors.

In addition to farms and pods the implementation of also includes one or more non podded servers . In general the non podded server may be dedicated to performing a particular service that relies on other processes and services for information and may be directly or indirectly connected to resources outside of the OSP host complex such as the Internet and the IM host complex through an OSP gateway . In the event that subscriber usage of the particular service is relatively high the non podded server may be included in a farm.

In the implementation of a pod shown in more detail includes a routing processor . In a packet based implementation the client system may generate information requests convert the requests into data packets sequence the data packets perform error checking and other packet switching techniques and transmit the data packets to the routing processor . Upon receiving data packets from the client system the routing processor may directly or indirectly route the data packets to a specified destination within or outside of the OSP host complex . In general the routing processor will examine an address field of a data request use a mapping table to determine the appropriate destination for the data request and direct the data request to the appropriate destination.

For example in the event that a data request from the client system can be satisfied locally the routing processor may direct the data request to a local server in the pod . In the event that the data request cannot be satisfied locally the routing processor may direct the data request internally to one or more farms one or more other pods or one or more non podded servers in the OSP host complex or may direct the data request externally to the Internet or the IM host complex through an OSP pod gateway .

The routing processor also may direct data requests and or otherwise facilitate communication between the client system and the Internet . In one implementation the client system uses an OSP client application to convert standard Internet content and protocols into OSP protocols and vice versa. For example when a browser application transmits a request in standard Internet protocol the OSP client application can intercept the request convert the request into an OSP protocol and send the converted request to the routing processor in the OSP host complex . The routing processor recognizes the Internet as the destination and routes the data packets to an IP Internet Protocol tunnel . The IP tunnel converts the data from the OSP protocol back into standard Internet protocol and transmits the data to the Internet . The IP tunnel also converts the data received from the Internet in the standard Internet protocol back into the OSP protocol and sends the data to the routing processor for delivery back to the client system . At the client system the OSP client application converts the data in the OSP protocol back into standard Internet content for communication with the browser application.

The IP tunnel may act as a buffer between the client system and the Internet and may implement content filtering and time saving techniques. For example the IP tunnel can check parental controls settings of the client system and request and transmit content from the Internet according to the parental control settings. In addition the IP tunnel may include a number a caches for storing frequently accessed information. If requested data is determined to be stored in the caches the IP tunnel may send the information to the client system from the caches and avoid the need to access the Internet .

In another implementation the client system may use standard Internet protocols and formatting to access the pod and the Internet . For example the subscriber can use an OSP TV client application having an embedded browser application installed on the client system to generate a request in standard Internet protocol such as HTTP HyperText Transport Protocol . In a packet based implementation data packets may be encapsulated inside a standard Internet tunneling protocol such as for example UDP User Datagram Protocol and routed to a web tunnel . The web tunnel may be a L2TP Layer Two Tunneling Protocol tunnel capable of establishing a point to point protocol PPP session with the client system . The web tunnel provides a gateway to the routing processor within the pod the Internet and a web proxy .

The web proxy can look up subscriber information from the IP address of the client system to determine the subscriber s parental controls settings and other demographic information. In this way the web proxy can tailor the subscriber s content and user interfaces. The web proxy can also perform caching functions to store certain URLs Uniform Resource Locators and other electronic content so that the web proxy can locally deliver information to the client system and avoid the need to access the Internet in the event that data requested by the client system has been cached.

Referring to a communications system is capable of delivering and exchanging information between a client system and a host system through a communication link . Client system typically includes one or more client devices and one or more client controllers for controlling the client devices . Host system typically includes one or more host devices and one or more host controllers for controlling the host devices . The communications link may include communication pathways enabling communications through the one or more delivery networks . As shown the client system may access the Internet through the host system .

Examples of each element within the communication system of are broadly described above with respect to . In particular the client system and the communications link typically have attributes comparable to those described with respect to client systems and and communications links and of . Likewise the host system of may have attributes comparable to and illustrates one possible embodiment of the host systems and shown in respectively. However describes an aspect of the host system focusing primarily on one particular implementation of IM host complex . For purposes of communicating with the IM host complex the delivery network is generally a telephone network.

The client system includes a client device and a client controller . The client controller is generally capable of establishing a connection to the host system including the OSP host complex the IM host complex and or the Internet . In one implementation the client controller includes an IM application for communicating with servers in the IM host complex utilizing exclusive IM protocols. The client controller also may include applications such as an OSP client application and or an Internet browser application for communicating with the OSP host complex and the Internet respectively.

The host system includes a host device and a host controller . The host controller is generally capable of transmitting instructions to any or all of the elements of the host device . For example in one implementation the host controller includes one or more software applications loaded on one or more elements of the host device . However in other implementations as described above the host controller may include any of several other programs machines and devices operating independently or collectively to control the host device .

The host system includes a login server capable of enabling communications with and authorizing access by client systems to various elements of the host system including an OSP host complex and an IM host complex . The login server may implement one or more authorization procedures to enable simultaneous access to the OSP host complex and the IM host complex . The OSP host complex and the IM host complex are connected through one or more OSP host complex gateways and one or more IM host complex gateways . Each OSP host complex gateway and IM host complex gateway may perform any protocol conversions necessary to enable communication between the OSP host complex the IM host complex and the Internet .

To access the IM host complex to begin an instant messaging session the client system establishes a connection to the login server . The login server typically determines whether the particular subscriber is authorized to access the IM host complex by verifying a subscriber identification and password. If the subscriber is authorized to access the IM host complex the login server employs a hashing technique on the subscriber s screen name to identify a particular IM server for use during the subscriber s session. The login server provides the client system with the IP address of the particular IM server gives the client system an encrypted key i.e. a cookie and breaks the connection. The client system then uses the IP address to establish a connection to the particular IM server through the communications link and obtains access to that IM server using the encrypted key. Typically the client system will be equipped with a Winsock API Application Programming Interface that enables the client system to establish an open TCP connection to the IM server .

Once a connection to the IM server has been established the client system may directly or indirectly transmit data to and access content from the IM server and one or more associated domain servers . The IM server supports the fundamental instant messaging services and the domain severs may support associated services such as for example administrative matters directory services chat and interest groups. In general the purpose of the domain servers is to lighten the load placed on the IM server by assuming responsibility for some of the services within the IM host complex . By accessing the IM server and or the domain server a subscriber can use the IM client application to view whether particular subscribers buddies are online exchange instant messages with particular subscribers participate in group chat rooms trade files such as pictures invitations or documents find other subscribers with similar interests get customized news and stock quotes and search the Web.

In the implementation of the IM server is directly or indirectly connected to a routing gateway . The routing gateway facilitates the connection between the IM server and one or more alert multiplexors for example by serving as a link minimization tool or hub to connect several IM servers to several alert multiplexors. In general an alert multiplexor maintains a record of alerts and subscribers registered to receive the alerts.

Once the client system is connected to the alert multiplexor a subscriber can register for and or receive one or more types of alerts. The connection pathway between the client system and the alert multiplexor is determined by employing another hashing technique at the IM server to identify the particular alert multiplexor to be used for the subscriber s session. Once the particular multiplexor has been identified the IM server provides the client system with the IP address of the particular alert multiplexor and gives the client system an encrypted key i.e. a cookie . The client system then uses the IP address to connect to the particular alert multiplexor through the communication link and obtains access to the alert multiplexor using the encrypted key.

The alert multiplexor is connected to an alert gate that like the IM host complex gateway is capable of performing the necessary protocol conversions to form a bridge to the OSP host complex . The alert gate is the interface between the IM host complex and the physical servers such as servers in the OSP host complex where state changes are occurring. In general the information regarding state changes will be gathered and used by the IM host complex . However the alert multiplexor also may communicate with the OSP host complex through the IM gateway for example to provide the servers and subscribers of the OSP host complex with certain information gathered from the alert gate .

The alert gate can detect an alert feed corresponding to a particular type of alert. The alert gate may include a piece of code alert receive code capable of interacting with another piece of code alert broadcast code on the physical server where a state change occurs. In general the alert receive code installed on the alert gate instructs the alert broadcast code installed on the physical server to send an alert feed to the alert gate upon the occurrence of a particular state change. Upon detecting an alert feed the alert gate contacts the alert multiplexor which in turn informs the client system of the detected alert feed.

In the implementation of the IM host complex also includes a subscriber profile server connected to a database for storing large amounts of subscriber profile data. The subscriber profile server may be used to enter retrieve edit manipulate or otherwise process subscriber profile data. In one implementation a subscriber s profile data includes for example the subscriber s buddy list alert preferences designated stocks identified interests and geographic location. The subscriber may enter edit and or delete profile data using an installed IM client application on the client system to interact with the subscriber profile server .

Because the subscriber s data is stored in the IM host complex the subscriber does not have to reenter or update such information in the event that the subscriber accesses the IM host complex using new or a different client system . Accordingly when a subscriber accesses the IM host complex the IM server can instruct the subscriber profile server to retrieve the subscriber s profile data from the database and to provide for example the subscriber s buddy list to the IM server and the subscriber s alert preferences to the alert multiplexor . The subscriber profile server also may communicate with other servers in the OSP host complex to share subscriber profile data with other services. Alternatively user profile data may be saved locally on the client device .

Referring to a communications system is capable of delivering and exchanging information between a client system and a host system through a communication link . Client system typically includes one or more client devices and one or more client controllers for controlling the client devices . Host system typically includes one or more host devices and one or more host controllers for controlling the host devices . The communications link may include communication pathways enabling communications through the one or more delivery networks .

Examples of each element within the communication system of are broadly described above with respect to . In particular the client system and the communications link typically have attributes comparable to those described with respect to client systems and and communications links and of . Likewise the host system of may have attributes comparable to and illustrates one possible embodiment of the host systems and shown in respectively. However describes an aspect of the host system focusing primarily on one particular implementation of IM host complex . For purposes of communicating with the IM host complex the delivery network is generally a telephone network.

The client system includes a client device and a client controller . The client controller is generally capable of establishing a connection to the host system including the IM host complex . In one implementation the client controller includes an IM application for communicating with servers in the IM host complex utilizing exclusive IM protocols.

The host system includes a host device and a host controller . The host controller is generally capable of transmitting instructions to any or all of the elements of the host device . For example in one implementation the host controller includes one or more software applications loaded on one or more elements of the host device . However in other implementations as described above the host controller may include any of several other programs machines and devices operating independently or collectively to control the host device .

The host system includes a login server capable of enabling communications with and authorizing access by client systems to various elements of the host system including the IM host complex . The IM host complex includes an IM server network and an alert multiplexor network . The IM server network is an interconnected network of IM servers and the alert multiplexor network is an interconnected network of alert multiplexors. Each IM server and each alert multiplexor can directly or indirectly communicate and exchange information with all of the IM servers in the IM server network and all of the alert multiplexors in the alert multiplexor network . Each of the alert multiplexors in the alert multiplexor network is connected to several alert gates that receive different types of alerts. In the implementation of the IM server network and the alert multiplexor network are interconnected by a routing gateway that serves as a common hub to reduce the number of connections.

A subscriber typically will be assigned to one IM server in the IM server network and to one alert multiplexor in the alert multiplexor network during a session based on one or more hashing techniques. However the IM servers and the alert multiplexors are capable of storing subscriber information and other electronic content that may be accessed by the other IM servers and alert multiplexors. In one implementation for example each IM server in the IM server network may be dedicated to serving a particular set of registered subscribers. Because all of the IM servers can communicate with each other all subscribers can communicate with each other through instant messaging. In another implementation each alert multiplexor in the alert multiplexor network may be dedicated to storing information about a particular set or subset of alerts. Because all of the alert multiplexors can communicate with each other all registered subscribers can receive all types of alerts. This networking arrangement enables the load to be distributed among the various servers in the IM host complex while still enabling a subscriber to communicate share information or otherwise interact with other subscribers and servers in the IM host complex .

Referring to a first client a second client and a host interact according to a procedure to transfer one or more files. The procedure may be implemented by any suitable type of hardware software device computer computer system equipment component program application code storage medium or propagated signal.

Examples of each element of are broadly described above with respect to . In particular the first client and the second client typically have attributes comparable to those described with respect to client devices and and or client controllers and . The host typically has attributes comparable to those described with respect to host device and and or host controllers and . The first client the second client and or the host may be directly or indirectly interconnected through a known or described delivery network.

Each of the clients is associated with a subscriber. To allow file transfers each subscriber sets certain preferences for permitting files to be transferred to and from other subscribers. For example a first subscriber may set transfer preferences governing which screen names or subscribers can send files to client . Likewise a second subscriber may set transfer preferences governing which screen names or subscribers and can send files to client . Typically each subscriber will be presented with a graphical UI User Interface that permits the subscriber to select among various transfer preferences. A subscriber s transfer preferences may be maintained locally or on the host .

In general the client and the client communicate over an open connection such as an open TCP connection established through the host . Typically both clients include a Winsock API for establishing an open TCP connection to the host and a client application for accessing the host . The client devices connect to the host to establish the connection.

The clients can use the connection to communicate with the host and with each other. The connection remains open during the time that the first client and the second client are accessing the host . To access the host each client sends a request to the host . The requests identify the associated subscribers to the host and to other subscribers using the subscribers unique screen names. The host verifies a subscriber s information e.g. screen name and password against data stored in a subscriber database. If the subscriber s information is verified the host authorizes access. If the subscriber s information is not verified the host denies access and sends an error message.

Upon accessing the host the client receives a list of the first subscriber s buddies that are currently online i.e. accessing the host . Buddies are subscribers or screen names designated for exchanging instant messages. In general the host informs the first subscriber as to whether designated buddies are online or offline. The host also informs any subscriber that has designated the first subscriber as a buddy that the first subscriber is online. The first subscriber can use an application running on the client the client application to view the online status of particular buddies exchange instant messages with online buddies participate in group chat rooms trade files such as pictures invitations or documents find other subscribers with similar interests get customized news and stock quotes and search the Web. Additionally the subscriber can use the client application to transfer one or more files to or from the client device of another subscriber.

In one implementation the first subscriber using the client selects to transfer one or more files to the client of the second subscriber. The first subscriber initiates the transfer by sending a connect request to the host step . The connect request includes for example the message type the screen name of the first subscriber the screen name of the second subscriber the IP address of the client and a randomly generated security number. The host authenticates that the connect request from the client is from a valid subscriber using for example a reverse look up table step . Once the connect request is verified the host sends the connect request to the client of the second subscriber step .

The client receives the connect request from the host step and then determines whether the first subscriber i.e. the sender of the connect request is allowed to connect step . The client then sends a message to the host based on whether the second subscriber has selected to give the first subscriber permission to connect. In the event that the first subscriber is not permitted to connect the client sends a refusal message to the host step . The host authenticates that the refusal message from the client is from a valid subscriber step and then sends the refusal message to the client of the first subscriber step . Upon receiving the refusal message the client displays a message to the first subscriber indicating that the connection cannot take place step .

In the event that the first subscriber is permitted to connect the client sends an accept message to the host step . The host authenticates that the accept file message from the client is from a valid subscriber step and then sends the accept message to the client of the first subscriber step . The client receives the accept message from the host step and then the client initiates the connection step .

Referring to the first client the second client and the host interact according to a procedure to initiate the connection step of . The procedure may be implemented by any suitable type of hardware software device computer computer system equipment component program application code storage medium or propagated signal.

In one implementation the client attempts to establish a direct socket connection e.g. a peer to peer socket connection to the client using the IP address of the client step . In some circumstances however the client may be unable to establish a direct socket connection to the client such as for example when the client is behind a firewall. In the event that the client cannot establish a direct socket connection to the client after a predetermined time period the client sends a connect message to the client through the host step . The connect message includes for example the message type the screen name of the first subscriber the screen name of the second subscriber the IP address of the client and a randomly generated security number. The host authenticates that the connect message from the client is from a valid subscriber step and then sends the connect message to the client step .

Upon receiving the connect message the client attempts to establish a direct socket connection to the client of the second subscriber using the IP address of the client step . If however the client is unable to establish a direct socket connection to the client such as for example when the client is behind a firewall the client displays a message indicating that the file transfer cannot take place step and sends an error message to the client through the host step . The host authenticates that the error message from the client is from a valid subscriber step and then sends the error message to the client of the second subscriber step . In response to the received error message the client displays a message indicating that the file transfer cannot take place step .

If a direct socket connection has been established between the client and the client in either step or step the client verifies that the client includes a valid client application by for example verifying the security number of the client application step . File transfer then proceeds according to the procedure illustrated in . The procedure may be implemented by any type of hardware software device computer computer system equipment component program application code storage medium or propagated signal.

The direct connection bypasses the connection between the client and the host . In one implementation the host limits the capacity of the connection to the client . As a result the client cannot transfer files larger than a threshold file size e.g. 8000 characters through the host . In contrast to the capacity of the connection between the client and the host the capacity of the direct socket connection between the client and the client is not limited. The client therefore may transfer relatively large files e.g. graphics files executable files to the client

After the connection is established the client sends a connected message to the client of the first subscriber step . The connected message includes for example text indicating that the second subscriber is directly connected. The client receives the connected message and then displays the connected message to the first subscriber step .

After being notified that a direct connection has been established the first subscriber may select and send a file to the client of the second subscriber step . The file may be selected from any directory on the client or from any other storage location. The file may be any collection of data stored in any type of format. Examples include but are not limited to data files text files graphics files audio files and video files. The client receives the file from the client over the direct connection step . Using the client the second subscriber may open execute and or save the file. In one implementation the file being transferred is opened executed and or otherwise displayed to the second subscriber in an instant messaging window.

After being notified that a direct connection is established the first subscriber also may use the client to compose a message to the second subscriber step . As the first subscriber composes the message the client indicates to the second subscriber that a message is being composed step . Because the second subscriber knows that the first subscriber is composing a message the second subscriber will be less likely to interrupt the first subscriber. This will facilitate exchanges between subscribers and allow conversational communication.

After the first subscriber has composed a message the first subscriber sends the composed message to the client of the second subscriber step . Using the client the second subscriber receives the composed message from the client over the direct connection step .

Referring to a UI includes one implementation of a preference box for allowing a subscriber to set certain preferences for transferring files. The preference box includes a Don t Display Start dialogue box to stop the start dialogue box see from appearing. The preference box also includes a Don t Display Status dialogue box to stop the status dialogue box from appearing. In general the instant messaging service will display the status of a file transfer by default. The preference box includes a Use Alternate Internet Address box to let the host use another internet address if there is a connection error when running the operating system software or using two network adapters.

The preference box also includes a field for setting certain preferences when others issue a direct transfer command. For users on the subscriber s buddy list the subscriber can select to allow the users on the buddy list to directly transfer files to cause the client to display a dialog box allowing the subscriber to accept or reject files or to specify that users in the buddy list cannot directly transfer files. For users who are not in the subscriber s buddy list the subscriber can select to allow the users to directly transfer files to cause the client to display a dialog box allowing the subscriber to accept or reject files or to specify that users not in the buddy list cannot directly transfer files.

Referring to a UI includes a screen name box for allowing the subscriber to designate the screen name of a subscriber to whom a file is to be transferred. In one example the UI is presented to the first subscriber. In order to directly connect to the client of the second subscriber the first subscriber enters the screen name of the second subscriber into the screen name box . Alternatively if the second subscriber is on the first subscriber s buddy list the first subscriber can open an instant message to the second subscriber and click on a direct transfer icon.

Referring to a UI includes a start dialog box displaying a warning to the sending subscriber. The warning indicates that objectionable files may be transferred over the direct connection. The start dialog box includes a Connect button to proceed with the direct connection and a Cancel button to abort the direct connection.

Referring to a UI includes an Accept dialog box displaying a warning to the receiving subscriber. The warning cautions the receiving subscriber to recognize the sending subscriber. The accept dialog box includes an Accept button to accept the direct connection a Reject button to reject the direct connection an Ignore button to ignore the request to directly connect and a Warn button to warn the sending subscriber not to attempt further direct connections.

Referring to a UI includes a direct instant message box presented to the receiving subscriber after the request to directly connect is accepted. The direct instant message box includes a reading field for reading instant messages and a writing field for composing instant messages. The direct instant message box also includes a typing message and a typing icon indicating that the sending subscriber is composing a message. The direct instant message box also includes an insert file icon .

Referring to a UI is displayed when the subscriber selects to insert a file into a direct instant message. The UI displays a listing of directories from which to select a stored file. The UI also includes a file name box for entering the name of a selected file.

Referring to a UI includes a direct instant message box . The direct instant message box includes a reading field and a writing field . The reading field includes an image . In this example a graphics file selected to be transferred is opened i.e. displayed in the direct instant message box .

