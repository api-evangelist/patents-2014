---

title: Method and apparatus for maintaining content view statistics in a named data network
abstract: A client device that obtains a data object for a local user, and can detect a check-in requirement in the data object that instructs the client device to share demographic information with a content broker. The client device generates a check-in message that indicates the data object, and includes identifying information for the local user or the local client device. The client device sends the check-in message to the content broker to share the identifying information. The content broker can analyze the check-in message to determine the user's identifying information, and to determine the data object being consumed by the user. The media broker then stores or aggregates the user's demographic information in a repository, in association with the data object. The media broker generates a response packet that grants the client device access to the data object's contents, and returns the response packet to the client device.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09147051&OS=09147051&RS=09147051
owner: PALO ALTO RESEARCH CENTER INCORPORATED
number: 09147051
owner_city: Palo Alto
owner_country: US
publication_date: 20140303
---
The subject matter of this application is related to the subject matter of the following applications 

U.S. patent application Ser. No. 14 092 680 entitled METHOD AND APPARATUS FOR SCALABLE DATA BROADCASTING by inventors Priya Mahadevan Roger C. Meike and Glenn C. Scott filed on 27 Nov. 2013 and

U.S. patent application Ser. No. 14 195 669 entitled Method and Apparatus for Streaming Advertisements in a Scalable Data Broadcasting System by inventors Priya Mahadevan Glenn C. Scott and Roger C. Meike filed on 3 Mar. 2014 

This disclosure is generally related to publishing digital content. More specifically this disclosure is related to gathering demographic information on users that consume a data stream over a network such as the Internet an Information Centric Network ICN a client server architecture or a peer to peer network.

In the modern digital economy content producers can publish their content in digital form through one or more streaming or broadcasting services to earn revenue through various revenue models. Music producers for example oftentimes license their music to online streaming radio stations that earn money by broadcasting advertisements to their listeners over a computer network. The music producers may also license their music content to music recommendation services that tailor song and advertisement selections to each consumer e.g. the Pandora streaming service from Pandora Media Inc. .

Similarly movie and television show producers can license their digital content to video streaming services that allow consumers to view movies or shows over the Internet. Some of these video streaming services negotiate a licensing fee with each producer and earn revenue by charging consumers a flat monthly fee e.g. Netflix Inc. and or by presenting advertising commercials to consumers e.g. Hulu.com .

These streaming services typically attempt to secure a publisher s digital content by requiring their customers to use the service s custom software application to receive the media stream. Netflix and Hulu for example deploy proprietary video streaming applications that make it difficult for a user to illegally copy a media stream by not allowing the user to save the media stream to a local disc. However it is possible for consumers to use third party applications that snoop on network traffic in order to save the media stream to disc. Once the consumer has saved a copy of the media stream it is possible for the consumer to illegally share the media stream anonymously given that the media streaming service typically transmits identical copies of the media stream to many consumers.

Cable and Satellite broadcasting companies on the other hand provide traditional television broadcasts to consumers over a secured digital infrastructure. A broadcasting company typically provisions a consumer s client device e.g. as a set top box device when the consumer subscribes to a service from the broadcasting company. This provisioning process verifies that the client device is associated with a paying customer and configures the device to detect and present the broadcasted media to the paying customer.

These broadcasting companies typically encrypt each media stream using a stream specific key before broadcasting each media stream to a group of subscribers. Each client device receives a key from the broadcasting company e.g. periodically and uses the key to decrypt the media stream just before presenting the media stream to the user. However it is possible for a consumer to save the broadcasted media stream to disk once the media stream has been decrypted for example by using a high definition multimedia interface HDMI capture card on a computer. Also because the broadcasting company transmits the same media stream to the group of consumers it is possible for the consumer to duplicate and illegally share the media stream with others anonymously.

One embodiment provides a data publishing system that facilitates broadcasting a data stream to a plurality of authorized client devices. A publisher can protect the data stream from unauthorized access by converting the data stream into an encoded data stream that by itself cannot be used to reproduce the original data stream. The publisher can also generate an encoding sauce that includes instructions for converting the encoded data stream into a new stream that can be used by authorized users.

The publisher can designate one or more brokers to authorize user access to the data stream. A broker can receive a request for the data stream from a user and can process the request to obtain authorization or identification information for the user. If the user can be allowed to access the data stream the broker can grant the user access to the data stream by generating a secret sauce that the user s computing device can use to decode the encoded data stream. In some embodiments the broker does not need to generate a unique secret sauce from the base sauce. For example some encoded data streams might not need a secret sauce to decode the stream. The broker can forward the encoding sauce to a client device which allows the client device to process the encoded data stream to reproduce the original data stream whose contents are not personalized for each client .

When the user s client device requests the data stream from the publisher the publisher can redirect the client device to a broker that controls access to the data stream s contents. The client device can obtain the encoded data stream from the publisher or from any other source and obtains a secret sauce stream from the broker. The client device processes the encoded data stream using the secret sauce stream to produce a personalized data stream that includes the data stream s contents. The broker can also provide advertisements and or personalized coupons to a user s client device as a way to pay for the data stream. If the user is presented with a coupon as an advertisement the user can redeem the coupon to obtain a product or a service at a discounted price or for free. For example the user can use a code printed on the coupon to redeem the coupon via a website or mobile application associated with the advertiser. Alternatively the user can print the digital coupon and can present the printed coupon at a brick and mortar venue associated with the advertiser.

When a media broker receives a check in message from a client device the media broker analyzes the check in message to determine identifying information for a user or the user s client device and to determine a data object being consumed by the user. The media broker then accounts for the user s demographic information in association with the data object. Also in response to receiving the check in message the media broker generates a response packet that grants the client device access to present the data object s contents to the user and returns the response packet to satisfy the check in message.

In some embodiments the media broker does not need to receive an explicit check in message from the client device to determine content view statistics. For example the media broker may receive a request from the client device for a secret sauce that includes instructions used by the client device to decode the data object. In response to receiving the request for the secret sauce the media broker can update content view statistics for the data object based on the request. The media broker also generates a response packet that includes the secret sauce and returns the response packet to satisfy the request.

In some embodiments while analyzing the check in message the broker obtains a unique identifier for the client device or the user. The unique identifier can include a public key or a secure identifier that is unique to the client device. Then to determine the demographic information the broker queries a demographic information repository based on the unique identifier.

In some embodiments while analyzing the check in message the broker obtains one or more demographic information attributes from the check in message. A respective demographic information attribute characterizes the client device or a user of the client device and can include one or more of location information demographic information and a session identifier.

In some variations on these embodiments while accounting for the demographic information the broker aggregates a respective demographic information attribute into a corresponding aggregated attribute value in a demographic information repository such that the aggregated attribute value aggregates demographic information from a plurality of users.

In some embodiments while accounting for the demographic information the broker stores the determined demographic information in a demographic information repository in association with the data object.

In some embodiments the response packet includes a secret sauce that includes instructions for decoding the data object.

In some embodiments the broker can receive an Interest that requests aggregated demographic information for the data object. In response to receiving the Interest the broker generates an analytics report that includes aggregated demographic information for clients that have consumed the data object. The broker can respond to the Interest by generating a Content Object whose payload includes the analytics report and disseminating the Content Object over a named data network to satisfy the Interest.

When the client device obtains a data object for a local user the client device can analyze the data object to determine whether the data object includes a check in requirement that instructs the client device to share demographic information with a broker. The check in requirement can include a reference to the broker that is tasked with maintaining aggregated demographic information on a plurality of client devices that consume the data object. In response to detecting the check in requirement the client device generates a check in message that includes a reference to the data object and identifying information for the local user or the local client device. The client device then sends the check in message to the content broker to share the identifying information with the content broker and presents the data object s contents to the local user.

In some embodiments the identifying information includes one or more of a unique identifier for the local client device a unique identifier for the local user demographic information for the local user and contextual information for the local client device.

In some embodiments the data object includes one or more of a web page a video stream an audio stream a file a document and executable code.

In some embodiments while sending the check in message the client device generates an Interest whose name includes a routable prefix for the content broker and includes the check in message and disseminates the Interest across a named data network. Also in response to disseminating the Interest the client device can receive a Content Object that grants the local device access to the data object s contents.

In some embodiments the Content Object can include a confirmation message that allows the client device to present the data object s contents to the local user or a decryption key for decompressing the data object s contents. The Content Object can also include one or more data blocks to insert into the data object to generate a personalized data object for the local user.

The following description is presented to enable any person skilled in the art to make and use the embodiments and is provided in the context of a particular application and its requirements. Various modifications to the disclosed embodiments will be readily apparent to those skilled in the art and the general principles defined herein may be applied to other embodiments and applications without departing from the spirit and scope of the present disclosure. Thus the present invention is not limited to the embodiments shown but is to be accorded the widest scope consistent with the principles and features disclosed herein.

Embodiments of the present invention provide a data publishing system that solves the problem of broadcasting a data stream across a computer network while only allowing authorized devices to consume the data stream. A data publisher can use the data publishing system to publish a data stream so that each authorized recipient obtains a personalized version of the data stream. The data stream can include a live video or audio stream a recorded video or audio stream an executable file e.g. binary code a digital document or image etc.

For example a publisher can broadcast a live or pre recorded media stream to a plurality of consumers in a secure way by encoding or damaging the media stream so that the stream s contents cannot be reproduced from the encoded stream alone. The publisher also configures one or more brokers to control access to the media stream by providing these brokers with an encoding sauce that indicates how to decode or fix the media stream in a way that generates a personalized stream for each recipient.

A broker can use the encoding sauce to generate a secret sauce for each valid recipient of a data stream. Each recipient s client device can receive segments of the encoded data stream from the publisher itself and or from any other network device that has cached the encoded data stream segments. These devices then use the secret sauce that they may have obtained from the broker to decode or fix the encoded data stream in a way that personalizes the data stream for that recipient. In some embodiments a personalized data stream can include a digital watermark that encodes an identifier of the stream s intended recipient. This allows a publisher to analyze a pirated data stream such as a movie to determine who has allowed the data stream to be copied illegally.

In some embodiments the publisher can generate the encoded data stream by extracting a plurality of small data segments that are critical for presenting or otherwise making use of the data stream. These extracted data segments can be provided to a client device via a secret sauce stream that requires a significantly lower bandwidth than the encoded data stream. The secret sauce stream can include instructions which indicate how the extracted data segments are to be inserted back into the encoded data stream. For example these instructions can map each data segment of the secret sauce stream to a byte offset of the encoded data stream. The client device can receive the high bandwidth encoded data stream from the publisher or from a data cache over an information centric networking ICN system or through any computer network now known or later developed. Also the client device can receive the low bandwidth secret sauce stream from the broker or from any other entity which the broker has designated to generate and or disseminate secret sauce streams for a given set of users or client devices.

Environment can include publishers brokers and client devices which can each be coupled to any wired or wireless computer network now known or later developed. A publisher can publish a data stream as an encoded data stream and only authorized clients can get access to the secret sauce from the broker. Any client device can access the encoded data stream directly from the publisher or from any other devices that store a copy of the encoded data stream e.g. a cache or other network devices . However only authorized devices e.g. client device can use the secret sauce to convert the encoded data stream into a personalized data stream. The encoded data stream is itself useless to client devices that do not have a valid secret sauce for decoding the stream.

Publisher can include a primary encoder that uses a base sauce to encode a data stream . Base sauce can be specific to data stream or can be re used for a plurality of data streams from publisher . Base sauce can include instructions for generating an encoded data stream and for generating an encoding sauce that can be provided to a trusted broker that processes requests from clients for the data stream. Encoded data stream can include a collection of data objects that can be provided to any client device or computer in a network without the risk of revealing the data stream s contents to unauthorized users. A user s client device cannot decode the original data stream from encoded data stream alone.

Publisher uses base sauce to generate encoded sauce for encoded data stream and provides encoding sauce to a broker over a trusted channel . Encoding sauce can include instructions used by broker to generating a secret sauce for a client device that has valid privileges. Broker is responsible for granting access to secret sauce only to users that have valid access privileges.

In some embodiments broker can include a secondary encoder that uses encoding sauce to generate secret sauce for client . Secondary encoder can generate secret sauce for client in advance e.g. before receiving a request for secret sauce or in response to receiving a request from client . For example when client device requests data stream from publisher publisher can respond to the request by providing encoded data stream to client and redirecting client to obtain secret sauce from broker .

In some embodiments client device can obtain encoded data stream from any network device that stores encoded data stream such as a cache sever a CDN server or any peer peer device. Client device can process encoded data stream by accessing secret sauce which is controlled by broker . Client can access secret sauce by sending a request to broker such that the request can include a client public key or identifier ID or any other form of authentication such as user id password for client .

If broker determines that client has valid access privileges secondary encoder can use encoding sauce to generate secret sauce based on the public key or the ID for client . Secret sauce includes instructions for modifying encoded data stream to produce a personalized data stream that is tailored to client . Broker then sends secret sauce to client .

Client includes a decoder that processes encoded data stream using secret sauce to generate personalized data stream . Personalized data stream can include a stream or collection of data objects whose contents may be personalized to client or a user of client . Personalized data stream can include digital watermarks that encode a unique ID for client or its user and or can include additional data that is tailored to the client device or its user.

In some embodiments a publisher can broadcast an encoded data stream to a plurality of devices over an information centric network. In ICN each piece of content is individually named and each piece of data is bound to a unique name that distinguishes the data from any other piece of data such as other versions of the same data or data from other sources. This unique name allows a network device to request the data by disseminating a request or an Interest that indicates the unique name and can obtain the data independent from the data s storage location network location application and means of transportation. Named data network NDN or a content centric network CCN are examples of ICN architecture the following terms describe elements of an NDN or CCN architecture 

In some embodiments the name can include a non hierarchical identifier such as a hash value that is derived from the Content Object s data e.g. a checksum value and or from elements of the Content Object s name. A description of a hash based name is described in U.S. patent application Ser. No. 13 847 814 entitled ORDERED ELEMENT NAMING FOR NAME BASED PACKET FORWARDING by inventor Ignacio Solis filed 20 Mar. 2013 which is hereby incorporated by reference. A name can also be a flat label. Hereinafter name is used to refer to any name for a piece of data in a name data network such as a hierarchical name or name prefix a flat name a fixed length name an arbitrary length name or a label e.g. a Multiprotocol Label Switching MPLS label .

In some embodiments the ICN system can include a content centric networking CCN architecture. However the methods disclosed herein are also applicable to other ICN architectures as well. A description of a CCN architecture is described in U.S. patent application Ser. No. 12 338 175 entitled CONTROLLING THE SPREAD OF INTERESTS AND CONTENT IN A CONTENT CENTRIC NETWORK by inventors Van L. Jacobson and Diana K. Smetters filed 18 Dec. 2008 which is hereby incorporated by reference.

Publisher can publish the data stream by generating an encoded data stream and disseminating encoded data stream over information centric network . Encoded data stream may be encoded for example by extracting every nbyte e.g. 100byte from the original data stream. Publisher can also generate an encoding sauce for encoded data stream and can provide encoding sauce to one or more of brokers over a trusted channel e.g. a secure network connection or a tangible storage device . Publisher can encrypt encoding sauce using a public key from a broker or using a private key that belongs to publisher and can sign encoding sauce using a digital certificate. Encoding sauce can include the data segments that have been extracted from the original data stream e.g. every 100byte of the original data stream as well as instructions indicating how these data segments are to be re inserted into encoded data stream . Encoding sauce can also indicate instructions for modifying one or more of the extracted data segments to generate digital watermarks for a user.

In some embodiments environment can also include a client device that can obtain encoded data stream via information centric network and can obtain a secret sauce for the data stream from broker . either via information centric network or via any other computer network now known or later developed. Client device can include a smartphone a tablet computer or any other computing device such as a laptop computer a desktop computer etc. To obtain encoded data stream device can disseminate a request for encoded data stream over information centric network or an Interest for encoded data stream over content centric network . Publisher can satisfy the request or Interest by returning a packet that includes a unique name for encoded data stream and identifies a broker e.g. broker . that is to control access to the data stream.

In some embodiments client device can disseminate one or more Interests for encoded data stream such that each Interest corresponds to a portion of encoded data stream . The Interest may be satisfied by publisher or by any device within information centric network . For example in some embodiments one or more of the Content Objects for encoded data stream may be cached within a content store CS within a router a cache server and or a peer client device . Recall that encoded data stream itself cannot be used to reproduce the data stream s contents. Hence in some embodiments any device within information centric network can cache Content Objects for encoded data stream without sacrificing its security and at the same time reducing the load on publisher as the number of Interests that need to be processed by publisher are significantly reduced.

Client device can gain access to the contents of encoded data stream by disseminating one or more Interests for the data stream s secret sauce stream. Broker . can use the publisher s encoding sauce to generate secret sauce Content Objects that satisfy these Interests e.g. secret sauce and that are customized for client device . Broker can encrypt each secret sauce Content Object using a public key from a client device or the broker s own private key and can sign these Content Objects using a local digital certificate. Client device then processes encoded data stream using the secret sauce stream e.g. secret sauce to generate a personalized data stream for the user.

In some embodiments broker . generates a plurality of secret sauce objects for the data stream such that each secret sauce object decodes a portion of the encoded data stream. For example broker . can generate a secret sauce object for each of the encoded data stream s Content Objects or for a set of media segments. As another example if the encoded data stream corresponds to a media stream publisher can partition the media stream into a plurality of media segments and broker . can generate a secret sauce Content Object for each media segment. This way broker . can require device to display a set of commercials before receiving a secret sauce object for a subsequent segment of the encoded media stream that are to be presented after the commercials.

Further given that broker . needs to generate a secret sauce stream for each client device that has valid access to the data stream broker . can restrict access to the data stream based on pre determined data restricting criteria and can keep track of various data access analytics for various data streams. For example broker . can restrict access to only client devices that have purchased the data stream that have subscribed into a data streaming service e.g. an online video streaming service such as Netflix and or that belong or do not belong to a predetermined demographic e.g. the recipient does not meet an 18 year old age requirement .

Broker . can also keep track of which client devices have accessed which data streams how much of a data stream they have accessed consumer demographic information for each data stream etc. When the data stream corresponds to a media stream broker . can also keep track of which advertisements have been viewed during each media stream or by each consumer a revenue amount that has been generated from each media stream or from each consumer etc. Broker . can use these analytics to bill users for the data streams they have accessed to bill users for a tiered subscription service to various data streams to determine a user s stream preference information etc.

Also given that each secret sauce stream can include executable instructions broker . can use the secret sauce stream and analytics information to insert user targeted advertisements into the media stream presented by the client device. Broker . can select a user targeted advertisement for a client device based on the analytics information and generates the secret sauce stream to include instructions that insert or embed the advertisement into an existing media stream. For example a movie may include an image of a soda bottle with a label. The label in the original media stream may be for a generic brand or for a brand that paid for product placement into the movie while the movie was being presented at movie theaters. However once the movie enters the video rental market other advertisers may pay to have their brand s label overlaid into the movie for a pre negotiated number of times and or for a predetermined audience demographic. Hence these advertisement inserting instructions can configure the client device to embed or overlay an image or media segment over one or more frames of the media stream so that the second brand s label is displayed on top of the bottle s initial label.

In some embodiments client device can include a data publisher and data brokering capabilities. For example a user can use a personal computing device tablet computer or cell phone to generate digital content e.g. a video file an audio file or a document . The user s computing device can encode this digital content and can broker which local users or which remote devices can have access to the digital content.

Any entity e.g. a person or organization that generates or owns digital content can utilize the data publishing system also referred to herein as a publisher to make the digital content available to others. These entities may include a film maker or movie producer that owns various movies or television programs a musician or music producer a software developer etc. The data publisher can generate encoded data streams for his digital content and to generate an encoding sauce that allows a broker to control access to the digital content.

The publisher also generates an encoding sauce for the data stream operation . This encoding sauce includes instructions that allow a data broker to generate a secret sauce for a recipient of the encoded data stream. In some embodiments the encoding sauce specifies instructions for generating watermarks that encode a recipient s identifier and specifies locations of the data stream where these watermarks are to be inserted. The publisher can select one or more brokers that are to broker access to the data stream operation and provides the encoding sauce to the one or more brokers operation . In some embodiments the publisher can provide the encoding sauce to a broker over a secure channel. Also in some embodiments the broker can designate one or more additional sub brokers that are to control access to the data stream. Each sub broker may for example be configured to respond to requests from a particular geographic region from a given set of client devices etc.

In some embodiments a publisher can analyze a pirated copy of the data stream that has been illegally copied to identify the copy s first recipient.

For example the encoding sauce may have configured a broker to perform an exclusive OR XOR operation between a user s unique identifier and various segments of the base data stream to generate various watermarks for the personalized data stream. Hence the publisher can obtain the user s identifier from the watermarks by deducing the user s identifier from one or more watermarks that have been inserted into various segments of the personalized data stream. To deduce the user s identifier the publisher can perform another XOR operation between a watermark and a segment of the data stream from which the watermark was generated. The publisher can then use this user identifier to determine personal identifying information for the user operation .

A data broker can include any online service that controls access to digital content. For example a large set of users may have registered with the broker to obtain digital content by either purchasing the digital content renting the digital content paying for a subscription to access the digital content or by agreeing to view periodic advertisements in exchange for access to the digital content. Publishers can sell their digital content to the broker or can engage in a business arrangement with the broker. The broker can use a publisher s digital content to generate revenue and can return a pre negotiated portion of this revenue to the publisher. This allows publishers regardless of their monetary or business resources to earn money from their digital content by leveraging the broker s access to advertisers and paying consumers.

In some embodiments the data broker and the publisher can reside on the same system. For example a publisher can deploy a data brokering service to control access to their digital content and to control how this digital content is leveraged to earn revenue. Some digital content can be broadcasted for free and without commercials while other digital streams require consumers to pay for the content and or to view commercials and product placements within the digital content.

In some embodiments a broker can generate a secret sauce for other sub brokers. Each broker generates an encoding sauce by signing and stamping the encoding sauce and inserting an identifier for a sub broker into the encoding sauce. For example a top level broker or a mid level broker can generate the encoding sauce to include a watermark for a sub broker and to include an encoding sauce for the sub broker. The top level broker then signs the encoding sauce before sending the encoding sauce to a sub broker. The sub broker can use the encoding sauce to generate a secret sauce for a client device or to generate an encoding sauce for another sub broker.

A sub broker can generate a secret sauce that includes the watermarks from the parent broker s encoding sauce e.g. watermarks for the local sub broker and other higher level brokers as well as additional watermarks for the client device. Hence when the client device processes the encoded data stream using the secret sauce the client device generates the personalized data stream by inserting watermarks for one or more brokers and for the client device into various locations of the personalized data stream as indicated by the secret sauce.

Recall that when a client device requests a data stream from publisher publisher can return a packet that indicates a name for the data stream and indicates a name for the data stream s secret sauce stream. This allows client device to obtain packets for the data stream and for the secret sauce stream from devices across an information centric network. In some embodiments when top level broker sends an encoding sauce for a data stream to sub broker . sub broker . advertises that it generate and return a secret sauce stream for this data stream. Hence when client device disseminates a request or an Interest for a secret sauce packet that corresponds to the data stream this request or Interest can flow to broker . over the information centric network.

In some embodiments each of data segments can be of equal size and can be evenly distributed across data stream . In some other embodiments segments together are approximately equal to the predetermined percentage of data stream and each of segments can be obtained from portions of data stream that are critical to reproducing the data stream s contents e.g. from I frames of a video file . Alternatively the publisher can randomly select individual bits or data blocks e.g. byte segments to extract from random locations of the data stream so that a predetermined percentage of data stream is extracted to generate encoded data stream .

The publisher can also generate checksums for encoded data stream such that each checksum corresponds to a segment of encoded data stream . The publisher can send checksums to a broker either within an encoding sauce or in addition to the encoding sauce. The broker can use checksums to generate a checksum for each personalized data stream or for a portion of the personalized data stream that the broker generates for each client device that has valid access to receive data stream . Also the publisher can generate the encoding sauce to include segments along with instructions for re inserting segments into the personalized data stream and instructions for generating and inserting one or more watermarks into the personalized data stream.

Specifically the broker can receive an encoding sauce that includes checksums for segments of an encoded data stream includes data segments that have been extracted from a base data stream and instructions for modifying segments to generate a plurality of watermarks .

In some embodiments the encoding sauce s instructions can indicate that the broker is to generate each watermark by using a user ID and a predetermined function to modify each data segment . For example the broker can generate each watermark by performing a bitwise operation e.g. an exclusive OR XOR operation between each data segment and user ID by performing an arithmetic operation or performing any other operation now known or later developed. User ID can indicate any unique identifier for a user that has requested access to the data stream such as a unique numeric identifier an account name or number an email address or any other identifier type now know or later developed.

Once the broker has generated the set of watermarks that are to be inserted into a user s personalized data stream the broker can compute a checksum for the personalized data stream itself. Recall that broker can receive checksums from the publisher such that checksums correspond to the data segments in the encoded data stream. Hence the broker can compute the checksum for the personalized data stream based on checksums along with watermarks that are to be inserted into the personalized data stream.

The broker then generates a secret sauce that includes watermarks checksum as well as the instructions from the publisher s encoding sauce that indicate how watermarks are to be inserted into the personalized data stream.

In some embodiments a broker can gather analytics information for viewers of digital content and generates a report for a producer of the digital content. The analytics information can indicate for example how many times a piece of digital content has been viewed viewership demographics etc. presents a flow chart illustrating a method for presenting a data stream to a user and providing demographic information to a broker in accordance with an embodiment. For example the client device can receive a request for a data stream from a user via an appropriate application on the user s device operation . The client device sends a request to obtain a broadcast of the data stream over a computer network operation and receives the encoded data stream operation .

In some embodiments the data stream may include one or more data segments that can be processed separately. These segments can include segments of an audio or video stream or can include a file or document in a data collection. The client device selects an encoded segment operation and determines whether it detects a check in requirement in the encoded segment operation . The check in requirement may correspond to a broker that is gathering demographic information for client devices that are consuming content from the broker. Alternatively the check in requirement may correspond to a content publisher that desires to understand statistical demographics for consumers that are interested in the publisher s content.

If the encoded segment does not include a check in requirement the client device can proceed to process the encoded data stream using the secret sauce to generate a personalized data segment operation and presents the personalized data segment to the user as usual operation . Otherwise the client device generates a check in message to a broker specified in the check in requirement and sends the check in message to the broker operation . The check in message can include demographic information for the client device a geographic location for the device information on the content being consumed by the client device and or any operations performed on the content by the client device e.g. pausing fast forwarding or rewinding an audio or video stream .

If the broker receives a valid check in message the broker can respond by providing a check in confirmation to the client device. This check in confirmation can include an acknowledgement that the broker received the client s check in message. In some embodiments the check in confirmation can include a secret sauce that the client device can use to process the encoded segment. The encoded data segment by itself is unusable so the client device processes the encoded data segment using the secret sauce to generate a usable data segment that the client device can present to the user. Once the client device receives the check in confirmation from the data broker operation the client device can proceed to operation to decode the encoded segment and present the personalized data segment to the user.

Alternatively the client device may receive the check in requirement directly from the broker and not from the encoded data stream. For example after the client device selects an encoded segment of the encoded stream s contents to process operation the client device can send a request for a secret sauce that allows the client device to decode the encoded segment. However instead of sending the secret sauce to the client device the broker can respond by sending a check in requirement to the user s client device without sending the secret sauce. This check in requirement requests that the client device provide personal information or demographic information about the user. After the client device receives the check in requirement the client device responds by sending the check in message to the broker that includes the user s personal and or demographic information. Then after the broker receives and verifies the check in message the broker can respond by providing the secret sauce to the client device. The client device can then proceed to use the secret sauce to generate the personalized data stream operation and to present the personalized data stream to the user operation .

The broker then uses the demographic information to account for the demographic information in association with the data object operation . For example the system can update a collection of aggregated or statistical demographic information for the data object to account for the client device s demographic information without explicitly storing the client device s demographic information. In some embodiments the aggregated or statistical information can include a set of statistical attributes that each represents an aggregated value e.g. a number of client devices that match the demographic attribute or statistical value e.g. a percentage of client devices that match the demographic attribute . These statistical attributes can each indicate a value for a given demographic information category. Hence while accounting for the client device s demographic information the broker can first extract a set of attribute values from the demographic information and can update the corresponding attribute values in the aggregated or statistical information to account for the client device.

The broker also generates a response packet to respond to the client device s check in message operation and returns the response packet to the client device operation . In some embodiments the client device may not be allowed to consume the digital content until the client device has checked in to share its demographic information with the broker. Hence the broker can generate the response packet to include a secret sauce that allows the client device to decode the data object and generate a personalized data object that can be presented to a user.

Also in some embodiments the broker and the client device can communicate over a named data network. The client device can generate an NDN packet that includes information to satisfy the check in requirement. For example the broker can request one or more client devices to check in by generating an Interest packet that includes a name associated with the check in requirement for a given data object. The broker can disseminate this Interest over the NDN to any client device that is consuming the data object. When the client device receives the Interest packet the client device can generate and return a Content Object that includes the information to satisfy the check in requirement.

As another example a client device can periodically check in by pushing to the broker any information required to satisfy the check in requirement. The client device can generate an Interest packet whose name includes a routable prefix that corresponds to the data object and or a data brokering service which monitors consumer demographics for the data object and can include a suffix that includes one or more demographic information attributes for the client device. The client device can disseminate this Interest packet over the NDN to check into any data brokering server that collects demographic information for the data object.

The Interest packet s name can also include a NONCE value to ensure that the Interest packet is forwarded to a server of the data brokering service. The NONCE value prevents routers along the named data network from returning a cached response to another check in Interest packet. Also the Interest packet s name can include a unique identifier that corresponds to the client device or its user session to ensure that an Interest packet is unique to each client device.

The broker can generate a Content Object packet that includes the response packet for the client device. The Content Object packet includes the same name as the Interest packet which allows routers along the named data network to forward the Content Object toward the client device that disseminated the Interest packet.

The broker then generates for each data segment instructions for embedding the data segment into the data stream operation . These instructions can include for example instructions for inserting the data segment into the data stream or for encoding the data segment into existing portions of the data stream. The broker then generates the secret sauce to include the data segments and the instructions operation and generates the response packet to include the secret sauce operation .

In some embodiments the broker can generate a report that includes statistical information for users clients and or programs that consume a data stream. For example as mentioned above the broker can obtain aggregate information from the client devices by sending check in requirements to these client devices. As another example even if the broker does not issue check in requirements e.g. does not receive explicit check in messages that specify demographic information from the client devices the broker can automatically keep track of content view statistics based on the requests received for the content s secret sauce. These content view statistics can include for example a number of views for a given page e.g. a web page a document page etc. or for a given media segment e.g. a portion of a video or audio file . The broker can compile the content view statistics that include aggregated viewership for a plurality of client devices and can provide a report that includes the content view statistics to an advertiser a publisher or any entity that is authorized to obtain the report.

The content view statistics can also include any aggregated statistical information that can be determined from a client device s request for the secret sauce such as an Internet service provider a network bandwidth a geographic region etc. If the user has established a profile with the broker the broker can obtain a user identifier from the client device s request for the secret sauce and can determine demographic information for the user based on the user s profile. The broker can aggregate this additional information from a plurality of client devices to generate statistical information about the users that are consuming the content and can include this statistical information in the report.

In some embodiments the request can indicate parameters for the analytics report such as a time window a set of demographic information categories of interest. The request can also specify values for one or more demographic information categories to narrow down the scope for the analytics report such as to learn about clients from a given geographic location e.g. North America or Europe or with a given interest Sports or NFL . In some embodiments the broker may maintain an analytics repository that stores aggregated demographic information for a fine grained time granularity such as for one minute time intervals. Doing so allows the broker to store meaningful user demographic information that does not reveal an individual user s personal behavior data. Thus the broker can obtain the aggregated demographic information for a given time window by compiling the aggregated information from a plurality of smaller time intervals.

Alternatively the broker can store raw behavior information for a plurality of users in the analytics repository which keeps track of the data objects and data streams consumed by each user or client device. The broker can use this raw behavior information to compile the aggregated demographic information for a given data object.

The broker then generates a response packet whose payload includes the analytics report operation and returns the response packet to satisfy the request operation . In some embodiments the broker and the remote device can communicate over a named data network. The remote device can generate an Interest packet that includes the request for the analytics report and can disseminate this Interest packet over the named data network to obtain the report from any broker or all brokers that is keeping track of consumer demographics for the data object. Similarly if a broker has designated sub brokers the broker can request and receive a report from all its sub brokers. The broker then combines all the reports and can send this aggregated report as well as individual sub reports to the publisher advertiser etc.

The Interest packet s name can include a routable prefix that corresponds to a data brokering service and can include a suffix that includes a NONCE value a name for the data object a desired time window and or any other parameters for the report. The NONCE value ensures that the Interest packet is forwarded to a server of the data brokering service by preventing routers along the named data network from returning a cached response to another check in Interest packet.

The broker can generate a Content Object packet that includes the analytics report. The Content Object packet includes the same name as the Interest packet which allows routers along the named data network to forward the Content Object toward the remote device that requested the analytics report.

Publisher can include a computing device that disseminates an encoded data stream over network . In some embodiments a broker . can control access to digital content from a publisher in a way that presents paid advertisements or personalized digital coupons to users that consume the digital content. This allows broker . to present advertisements on behalf of publisher and to earn money for publisher . For example broker . can receive an encoding sauce which broker . uses generate a secret sauce for a client device that desires to decode an encoded data stream from publisher and that has proven to have consumed a sufficient number of paid advertisements.

Client device may obtain encoded data stream either from publisher or from any device in network . However encoded data stream is encoded in a way that prevents client device from presenting the data stream to a local user. To present the data stream client device periodically requests a secret sauce from broker . that client device uses to decode a segment of encoded data stream before presenting the segment to the user. However broker . can ensure that clients are presenting advertisements to users by only providing secret sauce to client device once client device has proven to have retrieved and processed a sufficient number of advertisements.

If the user is presented with a personalized digital coupon as an advertisement the user can redeem the coupon to obtain a product or a service at a discounted price or for free. For example the user can use a code printed on the coupon to redeem the coupon via a website or mobile application associated with the advertiser. Alternatively the user can print the digital coupon and can present the printed coupon at a brick and mortar venue associated with the advertiser.

Advertisers typically design an advertising campaign with certain goals in mind such as a target time frame a target geographic location a target audience demographic etc. Hence they may create the advertisement with these goals in mind and they look for advertising opportunities that can meet these goals. For example a shaving cream advertisement that s directed to older men will have little effect when presented during a children s cartoon. Marketplace solves this problem by accepting an advertising opportunity from a set of brokers and by accepting advertising requirements from a set of advertisers. Each advertising opportunity specifies one or more attributes describing the advertising opportunity. These attributes can include a time interval during which the media broker is to provide access to the media stream information about a user demographic and keywords for the digital content over which the advertisement is to be presented. An advertiser s advertising requirements can indicate information regarding a target user demographic for a given advertisement. Once marketplace selects a bid from an advertiser for an advertising opportunity marketplace can establish a contract between the broker and the advertiser. Marketplace can terminate the contract once the advertising opportunity has expired or the advertising requirements have been satisfied.

In some embodiments a broker . can have a plurality of clients that typically use broker . to consume digital content. These clients may either have a subscription with broker . or broker . may be a free service that allows any client device to consume ad supported content. Broker . can collect information from these clients to compile demographic information to publishers and or advertisers that are partnered with or planning to partner with broker .. This collected information can include real time behavior data e.g. a user pausing fast forwarding or rewinding a media stream demographic information and geographic location data. Broker . can leverage its clients to sell advertising opportunities to advertisers via marketplace and discloses the typical client information to attract advertising bids.

Marketplace can establish a deal when broker . proposes an advertising opportunity and marketplace considers bids from a plurality of advertisers to select a winning bid e.g. from advertiser whose requirements are a closest match to the advertising opportunity s description. Alternatively marketplace can establish a deal when advertiser provides a description of an advertising campaign and marketplace selects a broker that can best satisfy the advertising campaign s requirements. Marketplace can select a best matching advertising opportunity for an advertiser s campaign based on an asking price set by a broker consumer demographics specified by the broker and or content keywords associated with the advertising opportunity.

The price for placing an ad during the advertising opportunity can be set either by advertisers trying to place their advertisement during a broker s advertising opportunity demand auction by brokers trying to win an advertiser s campaign supply auction or via a double auction. In either case the price is fixed once marketplace closes the deal. In some embodiments marketplace can finalize the deal using an English auction a Dutch auction or using any auction type now known or later developed. Once the deal is finalized marketplace receives a payment for the advertising campaign from advertiser and holds these funds in escrow until the advertising campaign is completed or the advertising opportunity ends.

Broker . presents the advertisement to clients that consume digital content associated with the advertising opportunity such as to client device consuming encoded data stream from publisher . For example if client device has not viewed enough advertisements to consume a segment of encoded data stream broker . can send the advertisement or a link to the advertisement to client device along with a challenge that client device needs to complete to prove that client device has consumed the advertisement.

After presenting the advertisement client device processes the challenge to produce a challenge response and sends challenge response to broker . and or marketplace . Marketplace verifies that challenge response is valid on behalf of advertiser and never discloses information about any specific client device to advertiser .

Broker . or marketplace can close the advertising opportunity once broker . has dispatched a predetermined number of advertisements to client devices and these client devices have returned valid challenge responses to broker . and or marketplace . Also if broker . does not dispatch enough advertisements to close the advertising campaign by the time the advertising opportunity s time window ends marketplace can cancel the advertising opportunity and returns any remaining funds to advertiser . In some embodiments marketplace can keep track of reputations on brokers and advertisers for example by computing a score that indicates how well they deliver on the terms they promised to deliver. Marketplace can display a broker s reputation to advertisers and can display an advertiser s reputation to brokers. Also when matching advertisers and brokers marketplace can give a higher priority to advertisers and or brokers that have a better reputation.

Marketplace can also send a report to advertiser which indicates how well the advertisement placement matched the advertising campaigns initial goals. This report can include aggregated demographic information for client devices that consumed the advertisement such as a number of client devices for each demographic information category.

In some embodiments marketplace and brokers facilitate providing targeted advertisements to clients of a satellite broadcast network. For example client device can receive encoded data stream via a satellite broadcast and can receive secret sauce via a network connection e.g. a land based computer network . A small number of advertisements can be streamed to client device via satellite and can be cached locally by client device . Then broker . can notify client device of which ads to play during which media streams e.g. via the network connection .

For example publisher can notify marketplace on content that is to be streamed to client devices in the near future or in the distant future and can indicate a description of the advertising opportunity. Advertisers can buy ad slots for this content presentation ahead of time. When a deal is made advertiser can provide the advertisement to the satellite system ahead of time e.g. to publisher to allow the advertisement to be streamed to and cached by the client devices that are likely to watch the content. When client device views the broadcast of this content broker . can configure client device to present the cached copy of the advertisement to the local user during a commercial break.

Given that a publisher may sell ad slots during a future advertising opportunity advertisers can get a better deal e.g. a lower price for ad slots during data streams that are to be broadcasted in the distant future e.g. next month or next year than for other ad slots in the nearer future e.g. during the next few minutes or hours . Also advertisers can get a better deal when purchasing ad slots for a movie or show that has not yet been created than for other movies or shows that have already been filmed and are scheduled to be streamed to client devices.

In some embodiments publisher can use marketplace to create an advertising opportunity for digital content that has not yet been created. Publisher can use any existing description of the content to create the advertising opportunity such as by using a script for a movie or show and a cast listing for the movie or show. Advertisers that buy ad slots for based on the preliminary description can get a lower price given the risk associated with possible changes to the script and or cast. Other possible risks include the content not meeting the advertiser s expectations the content may not appeal to their expected demographic and or the content and advertisements may not be viewed by the desired number of people.

The publisher s description of the advertising opportunity can indicate demographic information for the target audience a content type for the digital content e.g. TV show movie video music web page news article book etc. and a description of the content. The description can also indicate a progress timeline for the project such as a current state of development an expected presentation date and or a latest presentation date for the content.

If publisher has not yet raised the money necessary to create the digital content publisher can use a report of enlisted advertisers to raise investor money to create the content. These advertisers have promised to place ads during the content and have already placed funds in escrow. Investors may assign a higher valuation to a project that has attained significant interest from advertisers as it indicates marketability of the digital content s overall concept.

Advertisers can safely purchase advertising slots from marketplace for content that has not been created knowing that the advertiser s money is held in escrow by marketplace until the broker s advertising opportunity is completed or expires and or until the requirements from the advertisers advertising campaign are met. If publisher fails to create the digital content as promised marketplace can return the advertiser s funds to the advertiser.

As was mentioned earlier the digital content can include a web page. Client device can include a web browser application that can obtain an encoded data stream for the web page such that encoded data stream may be missing key information that allows the web browser to format the web page correctly. Alternatively encoded data stream may include certain content from the web page in encrypted form. The web browser can display the web page to the user by first downloading and presenting advertisements from broker . in the web page. Once client device has obtained and presented the advertisements client device can generate and send a challenge response for these advertisements to broker . thereby proving to the broker that client device consumed the ad. After broker . validates challenge response broker . can generates a secret sauce that includes the missing code that allows the web browser to display the web page properly or includes a decryption key that allows client device to decrypt certain content that was encrypted in encoded data stream . Broker . then sends secret sauce to client device to allow client device to display the web page properly to the user. Alternatively client device can send challenge response to marketplace . Marketplace verifies challenge response and sends a confirmation to broker . to send the secret sauce to client device .

The marketplace can receive bids for the advertising opportunity for a set of advertisers operation and selects a matching bid for the advertising opportunity operation . The marketplace can select the matching bid from an advertiser by matching attributes between the broker s description of the advertising opportunity and the advertiser s bid to purchase an ad slot.

The marketplace then establishes an advertising campaign contract between the advertiser and the data broker operation . While establishing the contract the market place receives funds for the advertising campaign from the advertiser and holds these funds in escrow until the advertiser satisfies a certain pre specified milestone. A milestone may include showing a single advertisement to a user a showing a predetermined number of advertisements to users or any other milestones agreed upon by the advertiser and the broker. For example the advertiser may require that these milestones are achieved on a given set of demographic information categories e.g. for clients from North America in order to be counted.

During the advertising campaign the marketplace can make a payment to the broker each time the broker achieves a milestone during the advertising opportunity. For example the marketplace can determine whether the advertising opportunity has expired operation . If so the marketplace cancels the contract operation and returns any remaining funds in escrow to the advertiser operation .

However if the advertising opportunity has not expired e.g. the data stream is still made accessible to users the marketplace determines whether the broker has reached an advertising milestone operation . If the broker has reached a milestone the marketplace transfers a payment for the milestone to the broker operation . Also in some embodiments the marketplace can retain a percentage of the payment as a service fee either from the payment itself or from the advertiser s funds in escrow.

In some embodiments the marketplace can re evaluate the advertising opportunity after a predetermined time interval or in response to an event e.g. in response to the broker presenting an advertisement to a user . For example if the marketplace determines that a new milestone has not been reached during operation the marketplace can return to operation to re evaluate the advertising opportunity.

The marketplace then holds the payment in escrow to pay for each milestone of the advertising campaign operation and sends the advertisement s reference to the data broker operation . After receiving the reference to the advertisement the data broker generates a challenge for consumers of the advertisement and generates an expected challenge response to the advertisement. The challenge can include for example instructions that cause a client device to obtain an nbyte in the advertisement object. The client device can execute the challenge s instructions to extract the nbyte from the advertisement and to generate a challenge response packet that includes the extracted nbyte.

The marketplace then receives the challenge and the expected challenge response value from the data broker operation . The data broker enters into a contract to fulfill the advertising campaign by sending the challenge response and expected values to the marketplace. In some embodiments the broker can compile a report that has challenge responses from a number of clients and send this report or a summary of this report to the marketplace. The marketplace can send a confirmation message to the advertiser stating that the advertising campaign has been established and can send the expected challenge response value to the advertiser in the confirmation message operation .

In some embodiments the marketplace can receive challenge response values from the client devices directly which the marketplace can use to verify that the broker is indeed providing the data stream and advertisements to client devices. In addition the marketplace can compute content view statistics based on the challenge response messages received from the client devices and can compile the content view statistics into a report to send to a publisher advertiser producer etc. In some cases the publisher or advertiser can request these statistics reports both from marketplace and the brokers and can compare the reports from the brokers and the marketplace to ensure the reports match.

The content view statistics can include for example a number of views for a given page e.g. a web page a document page etc. or for a given media segment e.g. a portion of a video or audio file or the complete file or a number of advertisements presented for a given data stream e.g. ads shown per streaming session or total number of ads shown across all users . The content view statistics can also include any aggregated statistical information that can be determined from a client device s request for the secret sauce such as an Internet service provider a network bandwidth a geographic region etc. If the user has established a profile with the broker the broker can obtain a user identifier from the client device s request for the secret sauce and can determine demographic information for the user based on the user s profile. The broker can use profile information from a set of users that have viewed the data stream to generate aggregated demographic information for the data stream and can include this aggregated demographic information in the report.

An advertisement token can include a data object that proves a client device has viewed an advertisement and either indicates a value e.g. a fixed number of credits or has an inherent value e.g. worth a number of credits as determined based on market supply and demand . For example when a user s client device presents an advertisement to a user the client device can process a challenge received from the broker to compute a challenge response based on the advertisement. The client device can create a token using the challenge response and signs the token using the client s private key. A broker can analyze tokens from the client device to determine a number of credits owned by the client device. The broker can accept tokens from the client device as payment to consume a data stream or can display advertisements to the client device to allow the client to generate new tokens.

The broker then determines a user account associated with the request operation and validates the user s access to the data stream operation . The user can have valid access to the data stream when the user has purchased a movie subscribed to a video streaming service or when the user has purchased or subscribed to any other digital content e.g. subscribing to a news website purchasing a software application etc. . Alternatively if the user has not purchased or subscribed to the data stream the user may access the data stream if the user has acquired a sufficient number of necessary credits. The user can earn the necessary number of credits by viewing one or more commercials or advertisements.

The broker then determines whether the user has valid access to the data stream operation . If so the broker can obtain an encoding sauce that corresponds to the encoded data stream either from a local repository or from the publisher operation . The broker uses the encoding sauce to generate a secret sauce for the user s client device operation and provides the secret sauce to the user s client device operation . The client device can use this secret sauce to process the encoded data stream to generate a personalized data stream. In some embodiments the broker does not need to generate a unique secret sauce from the encoding sauce. For example some encoded data streams might not need a secret sauce to decode the stream. Hence the broker can forward the encoding sauce to a client device during operation which allows the client device to process the encoded data stream to reproduce the original data stream whose contents are not personalized for the client device .

In some embodiments if the user does not have valid access to the data stream the broker can provide the client device with an opportunity to earn credits operation . For example if the data stream needs to be purchased or rented the broker can provide the user with a user interface that allows the user to pay for the data stream s contents. Once the user has paid the broker issues to the user a necessary number of credits for viewing the data stream. If the data stream requires a subscription to a streaming service such as a movie or music streaming service the broker can provide the user with an option to log into the streaming service as a way to validate that the user is a subscribed member. Alternatively the broker can present the user with an interface for subscribing to the streaming service.

In some embodiments the user can earn credits to access the data stream by viewing advertisements such as by viewing a media stream that presents a commercial to the user. When the user s client device presents an advertisement to a user the client device can process a challenge received from the broker to compute a challenge response based on the advertisement. The client device can create a new token for the user using the challenge response and signs the token using the client s private key. An advertisement token can either indicate a value e.g. a fixed number of credits or can have an inherent value e.g. worth a number of credits as determined based on market supply and demand .

Each advertiser can bid to display advertisements to the user and a portion of the payment for the advertisement can be used to purchase advertising tokens for the user. This way an advertiser can pay to purchase more tokens for a client as a way to reduce the number of other advertisers with which it needs to share a given commercial break. When the user views the advertisement the user s client device can process the challenge to generate a number of tokens paid for by the advertiser. The user is more likely to remember the advertisement if the user did not need to view additional advertisements before being allowed to continue viewing a movie or listening to music.

Hence during operation the broker can analyze advertising tokens from the client device to determine whether the user possesses a sufficient number of credits to gain access to a portion of an encoded data stream. If so the broker can proceed through operations to provide the user s client device with a secret sauce that allows the client device to decode the next segment of the encoded data stream. After providing the secret sauce to the client device the broker can return to operation to process a request for another segment of the data stream.

However if the user does not own a sufficient number of tokens the broker can provide a set of advertisements to the user that together provide the user with an opportunity to generate the necessary number of advertising tokens. Also after presenting these advertisements to the user and sending the generated tokens to the broker the user s client device can send another request to the data broker to attempt in accessing the data stream once again. Hence the broker can return to operation to process the client device s request.

The broker can receive a challenge response for an advertisement from the client device operation and determines whether the challenge response is valid operation . For example the broker or the marketplace can obtain a token generated by a user s client device verifies that the token is signed using the client s private key decrypts or decodes the token to obtain a challenge response message and verifies that this challenge response message is valid. In some embodiments the broker can send the challenge response message to the marketplace after the broker obtains the challenge response message from the client device s token.

If the challenge response message is valid the broker determines a number of credits associated with the token or the advertisement operation and can assign these credits to the client device operation . In some embodiments the broker receives a public key from the client device along with the challenge response. If the client device has earned a sufficient number of credits the broker can use the client s public key to generate a secret sauce that the client device can use to decode an encoded data stream.

On the other hand if the challenge response from the client device is not valid the broker can perform a remedial action operation . For example the broker can log information regarding the client device to compile a report of possible fraudulent activity. After processing the challenge response the broker can determine whether the client has earned a sufficient number of credits e.g. owns a sufficient number of tokens operation . If so the broker can proceed to allow the client device to access a data stream. However if the client device does not own a sufficient number of credits the broker can return to operation to provide more advertisements to the client device.

In some embodiments during operation the broker can use a set of labels to select advertisements for the client device. For example an advertisement stream can be associated with one or more tags. Each tag can include a combination of one or more labels that describe the particular advertisement stream. The broker can include a global tag repository that can contain a plurality of Tag Objects such that each Tag Object corresponds to a defined tag.

Each Tag Object includes references to a list of advertisement streams that are associated with the tag that the Tag Object represents. An advertiser can add an advertisement stream to the Tag Object by contacting the Tag Object owner e.g. the broker who adds the advertisement stream s name to the Tag Object in the global tag repository. This effectively adds the tag to the advertisement stream.

The broker can use the Tag Objects to search through a collection of advertisement streams to select a set of candidate advertisement streams to provide to a user s client device. For example the broker can obtain Tag Objects that correspond to a set of tags of interest such as tags that describe the user s demographics and or a movie being consumed by the user. The broker then produces a set of advertisement stream names from the intersection of the set of Tag Objects barring any null set .

For example the broker may need advertising streams that are tagged Cars Palo Alto and Red. The global tag repository may contain several Tag Objects corresponding to Cars and another corresponding to Palo Alto. However the global tag repository may not contain any Tag Objects corresponding to Red. Furthermore a car dealer Mike s Fast Cars may have submitted an advertising stream that it has associated with the Tag Objects Cars and Palo Alto. The broker can perform a search to obtain the Tag Objects Cars Palo Alto and Red. However the search results may only return Tag objects for Cars and Palo Alto as the Red Tag Object doesn t exist. The broker then computes the intersection of stream names from the non null Tag Objects which produces a set of advertising stream names that include Mike s Fast Cars as a candidate advertisement. The broker then provides the set of advertising stream names to the client device.

The stream referencing packet can indicate a link e.g. URL or name e.g. an NDN name for downloading the encoded data stream over an information centric network or over a peer to peer computer network as well as a link or name for downloading or obtaining the secret sauce from the broker. In some other embodiments the data stream may be broken down into a plurality of packets and the stream referencing packet can include an initial packet of the data stream. The stream referencing packet can include a header that indicates links or names for one or more brokers.

The client device parses the stream referencing packet to identify a link or name for the data stream and to identify a link or name for a data broker that brokers access to the data stream operation . The client device sends a request packet to obtain an encoded data stream operation and sends another request to the data broker to obtain a secret sauce stream for the data stream operation . The client device then receives a response packet from the broker operation and analyzes the response packet to determine the packet type operation . If the response packet includes an advertisement or a reference to an advertisement to present to the user the client device can present the advertisement to earn credits generate tokens that can be used to access the data stream operation .

On the other hand if the response packet includes a secret sauce the client device processes the encoded data stream using the secret sauce stream to generate a personalized data stream for the local user operation . For example the client device can process the encoded data stream by inserting watermarks from the secret sauce stream into locations of the encoded data stream indicated by the secret sauce stream. Alternatively the secret sauce stream can include instructions for generating the watermark which the client device uses to generate one or more watermarking data segments that are inserted into the encoded data stream. These watermark generating instructions may indicate operations for encoding a unique identifier of a local user into data segments provided in the secret sauce stream or into data segments of the encoded data stream.

The client device can also execute any other instructions from the secret sauce such as to perform analytics related computations or to present an advertisement. In some embodiments the advertisement presenting instructions can configure the client device to embed or overlay an image or media segment into a media stream. For example a movie may include an image of a soda bottle with a label. The label in the original media stream may be for a generic brand or for a brand that paid for product placement into the movie while the movie was being presented at movie theaters. However once the movie enters the video rental market other advertisers may pay to have their brand s label overlaid into the movie for a pre negotiated number of times and or for a predetermined audience demographic. Hence the instructions from the secret sauce can configure the client device to overlay an image or a media segment over one or more frames of the media stream to generate a personalized media stream so that the second brand s label is displayed on top of the bottle s initial label in the personalized media stream. These instructions can indicate an image and frame coordinate for each frame of the media stream which the client device uses to overlay these images onto the media stream so that the brand s label can shift and animate along with the bottle. These instructions can also replace or overlay audio segments within the media stream for example to replace a verbal mention of one brand with the verbal mention of the second brand that is to be advertised to the local user.

In some embodiments the client device can generate the personalized data stream in near real time while presenting the media stream to the user. For example the client device can receive the media stream as a sequence of stream segments and receives a secret sauce stream that includes a secret sauce segment for each media stream segment. This way the client device can process a media segment using a corresponding secret sauce segment to generate a personalized version of the media segment for the user while receiving other media segments and secret sauce segments for the remainder of the media stream.

The client device then presents the advertisement to the user operation and computes a challenge response for the challenge query from the advertisement operation . The challenge can include instructions that require the client device to process the advertisement in a way that produces a result that proves the client device has obtained and played back the advertisement. For example the challenge can include instructions that cause the client device to obtain an nbyte from the advertisement object. The client device can execute the challenge s instructions to extract the nbyte from the advertisement and to generate a challenge response that includes the extracted nth byte. The client device can generate a response packet that includes the challenge response the client s public key and an identifier for the broker and signs the response packet using the broker s public key operation . The client device can provide the response packet to the data broker and or to a marketplace that matched the advertiser with the broker s advertising opportunity operation . In some embodiments the client device encrypts the response packet using the broker s public key or its own private key. The broker decrypts the response packet and examines the challenge response to determine if the client device has presented the advertisement. If the challenge response is valid the broker can use the client s public key or the broker s own private key to generate a secret sauce that the client device can use to decode an encoded data stream.

The client device can disseminate the response packet across a named data network to reach the broker and the marketplace. For example the client device can generate an Interest packet that includes a routable name prefix associated with the broker and the marketplace and encodes the response packet as a suffix of the Interest s a name. This way when the client device disseminates the Interest packet across the NDN the NDN routers can use the Interest s name prefix to forward the Interest to the broker and the marketplace. The broker and the marketplace can then extract the response packet from the Interest s name suffix.

In some embodiments communication module can receive an Interest or request for a data stream or for a secret sauce stream for an encoded data stream. Base sauce generating module can generate a base sauce for encoding a data stream and encoded stream generating module can process the data stream using the base sauce to generate the encoded data stream. Encoding sauce generating module can generate an encoding sauce that indicates instructions for generating a data decoding secret sauce for a target entity.

Encoded sauce obtaining module can receive a decoding sauce from a remote device such as from a remote publisher. Data access validating module can process an Interest or request for the data stream s secret sauce to determine whether the target entity has valid access to the data stream. Secret sauce generating module can generate the secret sauce for the target entity responsive to data access validating module validating the target entity s access to the data stream.

Data broadcasting system can include instructions which when executed by computer system can cause computer system to perform methods and or processes described in this disclosure. Specifically data broadcasting system may include instructions for receiving an Interest or request for a data stream or for a secret sauce stream for an encoded data stream communication module . Further data broadcasting system can include instructions for generating a base sauce for encoding a data stream base sauce generating module and can also include instructions for processing the data stream using the base sauce to generate the encoded data stream encoded stream generating module .

Data broadcasting system can include instructions for generating an encoding sauce that indicates instructions for generating a data decoding secret sauce for a target entity encoding sauce generating module . Data broadcasting system can also include instructions for receiving a decoding sauce from a remote device such as from a remote publisher encoding sauce obtaining module .

Further data broadcasting system can include instructions for processing an Interest or request for the data stream s secret sauce to determine whether the target entity has valid access to the data stream data access validating module . Data broadcasting system can also include instructions for generating the secret sauce for the target entity responsive to determining that the target entity has valid access to the data stream secret sauce generating module .

Data can include any data that is required as input or that is generated as output by the methods and or processes described in this disclosure. Specifically data can store at least a base sauce for encoding a base data stream and an encoding sauce for the data stream. Data can also include the base data stream e.g. a media stream packets or Content Objects for the encoded data stream and or packets or Content Objects for a secret sauce stream corresponding to a target entity.

The data structures and code described in this detailed description are typically stored on a computer readable storage medium which may be any device or medium that can store code and or data for use by a computer system. The computer readable storage medium includes but is not limited to volatile memory non volatile memory magnetic and optical storage devices such as disk drives magnetic tape CDs compact discs DVDs digital versatile discs or digital video discs or other media capable of storing computer readable media now known or later developed.

The methods and processes described in the detailed description section can be embodied as code and or data which can be stored in a computer readable storage medium as described above. When a computer system reads and executes the code and or data stored on the computer readable storage medium the computer system performs the methods and processes embodied as data structures and code and stored within the computer readable storage medium.

Furthermore the methods and processes described above can be included in hardware modules. For example the hardware modules can include but are not limited to application specific integrated circuit ASIC chips field programmable gate arrays FPGAs and other programmable logic devices now known or later developed. When the hardware modules are activated the hardware modules perform the methods and processes included within the hardware modules.

The foregoing descriptions of embodiments of the present invention have been presented for purposes of illustration and description only. They are not intended to be exhaustive or to limit the present invention to the forms disclosed. Accordingly many modifications and variations will be apparent to practitioners skilled in the art. Additionally the above disclosure is not intended to limit the present invention. The scope of the present invention is defined by the appended claims.

