---

title: Network controller failover request to reduce network outages
abstract: A system is described that includes a first network controller and a second network controller. The first controller operates as a master controller and the second controller operates as a standby controller for a set of access points. Using a set of VRRP advertisements between the first and second controllers, the second controller may (1) determine that the first controller has failed independent of any determination by the access points and (2) send a failover request to the access points. The failover request may cause the access points to use previously established tunnels between the second controller and each of the access points. By transmitting a failover request message from the second controller to the access points upon the detection by the second controller that the first controller has failed and independent of any determination by the access points, the system reduces network access downtime for the access points.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09588850&OS=09588850&RS=09588850
owner: Aruba Networks, Inc.
number: 09588850
owner_city: Sunnyvale
owner_country: US
publication_date: 20141030
---
The present disclosure relates to the quick transition between master and standby controllers to reduce the duration of network outages for an access point following a failure of the master network controller. In particular the standby network controller may transmit a failover request to the access point upon detecting that the master controller has failed and without waiting for the access point to determine that the master network controller has failed.

Over the last decade there has been a substantial increase in the use and deployment of wireless client devices from dual mode smartphones to tablets capable of operating in accordance with a particular Institute of Electrical and Electronics Engineers IEEE standard. With wireless becoming the de facto medium for connectivity among users it has become increasingly important for network systems to intelligently manage connections.

For example access points may wirelessly associate with one or more client devices. These access points may establish tunnel connections via corresponding network controllers to provide network access to the one or more client devices. Accordingly these access points and associated client devices rely on the network controllers to be active and operating correctly such that network access may be maintained for each access point and client device while in tunnel mode.

The approaches described in this section are approaches that could be pursued but not necessarily approaches that have been previously conceived or pursued. Therefore unless otherwise indicated it should not be assumed that any of the approaches described in this section qualify as prior art merely by virtue of their inclusion in this section.

In the following description for the purposes of explanation numerous specific details are set forth in order to provide a thorough understanding. One or more embodiments may be practiced without these specific details. Features described in one embodiment may be combined with features described in a different embodiment. In some examples well known structures and devices are described with reference to a block diagram form in order to avoid unnecessarily obscuring the present invention.

Herein certain terminology is used to describe features for embodiments of the disclosure. For example the term digital device generally refers to any hardware device that includes processing circuitry running at least one process adapted to control the flow of traffic into the device. Examples of digital devices include a computer a tablet a laptop a desktop a netbook a server a web server an authentication server an authentication authorization accounting AAA server a Domain Name System DNS server a Dynamic Host Configuration Protocol DHCP server an Internet Protocol IP server a Virtual Private Network VPN server a network policy server a mainframe a television a content receiver a set top box a video gaming console a television peripheral a printer a mobile handset a smartphone a personal digital assistant PDA a wireless receiver and or transmitter an access point a base station a communication management device a router a switch and or a controller.

It is contemplated that a digital device may include hardware logic such as one or more of the following i processing circuitry ii one or more communication interfaces such as a radio e.g. component that handles the wireless data transmission reception and or a physical connector to support wired connectivity and or iii a non transitory computer readable storage medium e.g. a programmable circuit a semiconductor memory such as a volatile memory and or random access memory RAM or non volatile memory such as read only memory power backed RAM flash memory phase change memory or the like a hard disk drive an optical disc drive etc. or any connector for receiving a portable memory device such as a Universal Serial Bus USB flash drive portable hard disk drive or the like.

Herein the terms logic or logic unit are generally defined as hardware and or software. For example as hardware logic may include a processor e.g. a microcontroller a microprocessor a CPU core a programmable gate array an application specific integrated circuit etc. semiconductor memory combinatorial logic or the like. As software logic may be one or more software modules such as executable code in the form of an executable application an application programming interface API a subroutine a function a procedure an object method implementation an applet a servlet a routine source code object code a shared library dynamic load library or one or more instructions. These software modules may be stored in any type of a suitable non transitory storage medium or transitory computer readable transmission medium e.g. electrical optical acoustical or other form of propagated signals such as carrier waves infrared signals or digital signals .

Lastly the terms or and and or as used herein are to be interpreted as inclusive or meaning any one or any combination. Therefore A B or C or A B and or C mean any of the following A B C A and B A and C B and C A B and C. An exception to this definition will occur only when a combination of elements functions steps or acts are in some way inherently mutually exclusive.

The network system may be installed distributed in any region or area. For example the access points may be installed in an office building or another similar structure. In some embodiments the network controllers may provide tunneling mode capabilities for the client devices . In this tunnel mode data transmitted to from the client devices and the access points may be encapsulated while transmitted over another network. These tunnel encapsulated data segments may be managed by the network controllers prior to forwarding to from the client devices and the access points . Accordingly network access for the client devices and or the access points may rely on corresponding network controllers being active and responsive.

In some embodiments a master network controller may be assigned to an access point along with one or more standby network controllers . The master network controller may be utilized by the access point until the master network controller fails or otherwise becomes unresponsive. Upon detecting the failure of the master network controller the network system may cause one of the standby network controllers to transition to the role of master controller. As will be described in greater detail below the network system may ensure a quick transition between a master network controller and a standby network controller when the master network controller fails such that minimal network interruption is experienced by the access point and client devices associated with the access point .

Each element of the network system will now be described below by way of example. In one or more embodiments the network system may include more or less devices than the devices illustrated in which may be connected to other devices within the network system via wired and or wireless mediums.

The access points may be any device that can associate with the client devices to transmit and receive data over wireless channels. Each of the access points may operate on various wireless channels i.e. frequency segments . In one embodiment the access points may correspond to a network device such as a wireless access point a switch a router or any combination thereof. shows a component diagram of the access point according to one embodiment. In other embodiments the access points may include similar or identical components to those shown and described in relation to the access point .

As shown in the access point may comprise one or more of a hardware processor data storage an input output I O interface and device configuration logic . Each of these components of the access point will be described in further detail below.

The data storage of the access point may include a fast read write memory for storing programs and data during performance of operations tasks and a hierarchy of persistent memory such as Read Only Memory ROM Erasable Programmable Read Only Memory EPROM and or Flash memory for example for storing instructions and data needed for the startup and or operation of the access point . In one embodiment the data storage is a distributed set of data storage components. The data storage may store data that is to be transmitted from the access point or data that is received by the access point . For example the data storage of the access point may store data to be forwarded to the client devices or to one or more of the network controllers .

In one embodiment the I O interface corresponds to one or more components used for communicating with other devices e.g. the client devices the network controllers and or other access points via wired or wireless signals. The I O interface may include a wired network interface such as an IEEE 802.3 Ethernet interface and or a wireless interface such as an IEEE 802.11 WiFi interface. The I O interface may communicate with the client devices and the network controllers over corresponding wireless channels in the system .

In one embodiment the I O interface facilitates communications between the access point and one or more of the network controllers through the switching fabric . In one embodiment the switching fabric includes a set of network components that facilitate communications between multiple devices. For example the switching fabric may be composed of one or more switches routers hubs etc. These network components that comprise the switching fabric may operate using both wired and wireless mediums.

In some embodiments the I O interface may include one or more antennas for communicating with the client devices the network controllers and or other wireless devices in the network system . For example multiple antennas may be used for forming transmission beams to one or more of the client devices or the network controllers through adjustment of gain and phase values for corresponding antenna transmissions. The generated beams may avoid objects and create an unobstructed path to the client devices and or the network controllers .

In one embodiment the hardware processor is coupled to the data storage and the I O interface . The hardware processor may be any processing device including but not limited to a Microprocessor with Interlocked Pipeline Stages MIPS ARM class processor a microprocessor a digital signal processor an application specific integrated circuit a microcontroller a state machine a field programmable gate array FPGA or any type of similar type of programmable logic array.

In one embodiment the device configuration logic includes one or more functional units implemented using firmware hardware software or a combination thereof for configuring parameters associated with the access point . In one embodiment the device configuration logic may be configured to establish tunnels with one or more of the network controllers and or transmit Virtual Router Redundancy Protocol VRRP advertisements e.g. Hello messages to one or more of the network controllers .

As described above the other access points may be similarly configured and designed as described above in relation to the access point . For example the access points may each comprise a hardware processor data storage an input output I O interface and device configuration logic in a similar fashion as described above in relation to the access point .

In one embodiment the client devices may be any wireless or wired electronic devices capable of receiving and transmitting data over wired and or wireless mediums. For example the client devices may be one or more of personal computers laptop computers netbook computers wireless music players portable telephone communication devices smart phones set top boxes tablet computers and digital televisions. In one embodiment the client devices are digital devices that include a hardware processor memory hierarchy and inputloutput I O interfaces including a wired and or wireless interface such as an IEEE 802.3 interface. In one embodiment the configuration and design of the components within the client devices may be similar to those discussed above in relation to the access point . In other embodiments the client devices may include more or less components than those shown in in relation to the access point .

In one embodiment the network controllers are digital devices that include a hardware processor memory hierarchy and input output I O interfaces including a wired and or wireless interface such as an IEEE 802.3 interface.

In one embodiment the configuration and design of the components within the network controllers may be similar to those discussed above in relation to the access point . In other embodiments the network controllers may include more or less components than those shown in in relation to the access point .

In one embodiment the network controllers may be any set of devices that assist the access points in performing network tasks and operations. For example the network controllers may assist the access points in providing tunneling services to the client devices . In some embodiments the network controllers may provide redundancy to ensure that network access to the access points and the client devices is not severely impacted e.g. network access is not lost interrupted for an extended period of time due to a network controller failure.

For example as briefly described above in some embodiments master and standby network controllers may be assigned to a single access point or a single set of access points and corresponding client devices . For instance as shown in the network controller may be assigned as the master network controller and the network controller may be assigned as the standby network controller for the access point and the client devices which are associated with the access point . In this example when the master network controller fails or is otherwise unresponsive the standby network controller may assume the role and responsibilities of the master network controller . These responsibilities may include but are not limited to providing tunneling services to the access point and the client devices associated with the access point .

In one embodiment this determination that the master network controller has failed may be facilitated using the VRRP. In this embodiment a communication path may be established between the master network controller and the standby network controller as shown in . On this communication path the master network controller and the standby network controller may share a common Internet Protocol IP address. This common IP address may be known as the VRRP IP. Once VRRP is enabled on the master network controller and or the standby network controller the master network controller may send a VRRP advertisement e.g. a hello message to the standby network controller which indicates that the master network controller owns the VRRP IP. This ownership of the VRRP IP will ensure that the standby network controller does not flip state from standby to master since the VRRP IP can be owned by only one network controller . In one embodiment this VRRP advertisement may be transmitted by the master network controller to the standby network controller every second i.e. the VRRP Advertisement Interval set at default of one second .

VRRP operating on the standby network controller may be used for determining the state of the master network controller based on these VRRP advertisements. For example upon failing to receive VRRP advertisements from the master network controller for three consecutive seconds VRRP operating on the standby network controller may determine that the master network controller has failed or is otherwise unresponsive. VRRP operating on the network controller may thereafter 1 begin sending VRRP advertisements to the network controller indicating that the network controller owns the VRRP IP and consequently is the new master and 2 report this status to a service access point manager SAPM running within a station management STM process of the standby network controller .

In one embodiment a high availability manager i.e. HA mgr may be running on both the master network controller and the standby network controller . In this embodiment upon the access point connecting to the master network controller and setting up a set of corresponding tunnels the high availability manager running on the master network controller may pass the address e.g. the Internet Protocol IP address of the standby network controller to the access point . The access point may use the address of the standby network controller provided by the master controller to establish tunnels between the access point and the standby network controller . These tunnels between the access point and the standby network controller may remain inactive until the master network controller is determined to have failed based on communications using VRRP as described above and heartbeats from the access point .

For example after VRRP operating on the standby network controller reports a failure of the master network controller to the SAPM the network controller may change role from standby controller to master controller i.e. the network controller may take on the master role from the failed network controller as described above by taking ownership of the VRRP IP. However the new master network controller may not immediately activate tunnels between the network controller and the access point . Instead the activation of the tunnels between the network controller and the access point may await a failover request from the access point before this activation change is made.

In particular the access point may transmit a series of heartbeat messages to each of the network controllers and using separate respective heartbeat tunnels. The heartbeats may be transmitted at one second intervals to each of the network controllers and . Upon the access point failing to receive an acknowledgement in response to a predefined number of consecutively transmitted heartbeats the access point may conclude that the non responding controller has failed. For example in one embodiment the threshold may be set to eight heartbeats. In this example embodiment upon failing to receive acknowledgments to eight consecutive heartbeats transmitted to the network controller the access point may conclude that the network controller has failed and in response may transmit a failover request to the network controller .

Upon receiving the failover request the network controller which previously determined that the network controller had failed using VRRP advertisements and switched roles by taking ownership of the VRRP IP may activate previously established tunnels between the access point and the network controller . Accordingly the network controller may now be fully activated as the master network controller for the access point and associated client devices following 1 the determination that the network controller has failed based on the lack of VRRP advertisements transmitted between the network controller and the network controller and 2 the determination that the network controller has failed using heartbeats from the access point .

In this embodiment the access point may experience longer than necessary network outages caused by the failed controller as a result of the requirement that both the access point and the network controller must jointly determine that the network controller has failed before transitioning to the network controller . In particular as shown above the access point may only determine that the network controller has failed after the network controller fails to acknowledge eight heartbeats from the access point . Since heartbeats from the access point are transmitted at one second intervals the access point requires at least eight seconds to determine that the network controller has failed. In contrast using VRRP advertisements between the network controllers and the network controller may determine that the network controller has failed after three seconds i.e. failing to receive three VRRP advertisements from the network controller . Thus in this embodiment the access point and associated client devices may not have network access in tunnel mode for five additional seconds following the network controller determining that the network controller has failed. Different techniques and processes are discussed below for overcoming mitigating these inefficiencies to reduce network outages for access points .

Although each of the operations in the method is shown and described in a particular order in other embodiments the operations of the method may be performed in a different order. For example although the operations of the method are shown as being performed sequentially in other embodiments the operations of the method may be performed concurrently or during partially overlapping time periods.

The method will be described in relation to the network controllers and which provide network access to the access point and the client devices . However in other embodiments the method may be performed for any combination and of network controllers that operate in a master standby relationship to provide network access to access points and client devices .

In one embodiment the method may commence at operation with a Virtual Router Redundancy Protocol VRRP communication path being established between a first network controller and a second network controller . The VRRP communication path allows the transmission of VRRP advertisements e.g. hello messages between the first network controller and the second network controller such that the first and second network controllers may determine the status of the other respective device e.g. alive responsive or failed unresponsive . In one embodiment the VRRP on each of the network controllers and may communicate VRRP advertisements and establish determine the status of the other device.

At operation the access point may establish a connection with the first network controller . In one embodiment the network controller and the access point may establish one or more tunnels during this connection at operation . The tunnels may facilitate the transfer of data including heartbeats and keep alive messages between the first network controller and the access point . In one embodiment the number of tunnels established at operation may correspond to the number of virtual access points VAPs and or radios operating on the access point .

Following the establishment of a connection between the first network controller and the access point the network controller may transmit the address of a second network controller to the access point at operation . In this embodiment the first network controller may be initially used by the access point as a master network controller while the second network controller may be assigned as a standby network controller. As will be described in greater detail below upon the first network controller failing i.e. not responding to messages transmitted from other network devices in the network system the method may assign the second network controller to the role of master. In one embodiment the address transmitted between the first network controller and the access point at operation may be an Internet Protocol IP address that is transmitted through a tunnel established at operation .

At operation the access point may establish a set of tunnels with the second network controller based on the address received from the first network controller at operation . Similar to the tunnels established between the access point and the first network controller at operation the tunnels established at operation may facilitate the transfer of data including heartbeats and keep alive messages between the second network controller and the access point . Further the number of tunnels established at operation may correspond to the number of virtual access points VAPs and or radios operating on the access point . In one embodiment the tunnels between the second network controller and the access point may be set to be inactive while the tunnels between the access point and the first network controller may be set to be active. Accordingly the access point may initially utilize the first network controller to communicate in tunnel mode however as will be described in greater detail below upon failure of the first network controller the tunnels established with the second network controller may be utilized for network access.

At operation the second network controller may attempt to receive VRRP advertisements from the first network controller . In particular while properly operating the first network controller may continually transmit VRRP advertisements to the network controller over the VRRP communication path established at operation using VRRP . The messages transmitted from the first network controller to the second network controller may indicate that the first network controller is taking ownership of a shared VRRP IP address and consequently is the master. Further VRRP advertisements indicate that the transmitting network controller is operating properly. The VRRP advertisements may be transmitted at any interval including one second intervals two second intervals etc. Accordingly the second network controller may expect to receive VRRP advertisements at an established interval at operation .

At operation the second network controller may determine if VRRP advertisements have been received from the first network controller during a threshold time period using VRRP . For instance in some embodiments the threshold time period may be three seconds. In one embodiment in which VRRP advertisements are transmitted at one second intervals during a three second threshold time period the second network controller could receive up to three VRRP advertisements from the first network controller . Upon failing to receive any VRRP advertisements from the first network controller at operation during the threshold time period operation may determine that the first network controller has failed or is otherwise unresponsive i.e. is no longer able to transmit data . In this failed state the network controller may not properly operate as a master controller for the access point and or the client devices . In particular the failed network controller may be unable to transfer data in tunnel mode for the access point and or the client devices .

In response to receiving one or more VRRP advertisements during the threshold time period the method may return to operation . At operation the network controller may continue to attempt to receive VRRP advertisements such that operation may continue to determine the status of the network controller .

Conversely in response to not receiving VRRP advertisements during the predefined threshold time period and consequently determining that the first network controller has failed VRRP of the second network controller may switch the status of the second network controller from standby to master at operation . In one embodiment this switch of status may be performed by the second network controller transmitting VRRP advertisements over the VRRP communication path established at operation . These VRRP advertisements indicate that the second network controller 1 is taking ownership of the VRRP IP address and thus is now the master and 2 is operating properly. Accordingly after the first network controller has failed the second network controller may takeover master status for the access point and or the client devices at operation using VRRP . Immediately after or concurrent with the change of status at operation the second network controller may transmit a failover request to the access point at operation . The failover request transmitted from the second network controller informs the access point that the second network controller will now be operating as the master controller.

In response to the failover request the access point may transmit an acknowledgment ACK message to the second network controller at operation . In some embodiments the second network controller may retransmit the failover request to the access point upon failing to receive an acknowledgment message. Upon receipt of the acknowledgment message from the access point the second network controller may activate the tunnels between the access point and the second network controller which were established at operation using the high availability manager . Accordingly with the transfer of status at operation and the activation of the tunnels at operation the second network controller may now entirely operate as the master network controller for the access point and or the client devices . In particular the new master network controller may facilitate tunnel operations for the access point and or the client devices just as the network controller previously did.

By transmitting a failover request message from the second network controller to the access point upon the detection by the second network controller that the first network controller has failed the method reduces network access downtime for the access point and or the client devices . In particular although the access point may transmit heartbeat messages to the network controller to determine the status of this device i.e. determine whether the network controller has failed or is otherwise non responsive the method does not wait or rely on this determination before initiating a role transfer between the first network controller and the second network controller i.e. transfer of master role . Since the status determination made by the access point may take longer than the status determination made by the controller by not relying on this longer determination the method reduces the time before a role transfer may be initiated. For example the access point may require eight consecutive unacknowledged heartbeats that are each separated by one second before indicating a network controller failure while the network controller may only require failure to receive three VRRP advertisements each separated by a second from the network controller before indicating a network controller failure. By reducing the time period before triggering a role transition between the failed first network controller and the operating second network controller the method reduces network access down time for the access point and or the associated client devices while operating in a tunnel mode.

Although described in relation to a single access point associated with the first and second network controllers and which respectively function as master and standby controllers in other embodiments the method may operate in relation to multiple access point . In particular the first and second network controllers and may simultaneously operate as master and standby for two or more of the access points . In this embodiment the failover request transmitted at operation may be sent from the second network controller to each of the access points connected to the failed first network controller . In this fashion the method may efficiently operate to transition between a failed master network controller and a standby network controller to reduce network access downtime for multiple more access points and associated client devices .

An embodiment of the invention may be an article of manufacture in which a machine readable medium such as microelectronic memory has stored thereon instructions which program one or more data processing components generically referred to here as a processor to perform the operations described above. In other embodiments some of these operations might be performed by specific hardware components that contain hardwired logic e.g. dedicated digital filter blocks and state machines . Those operations might alternatively be performed by any combination of programmed data processing components and fixed hardwired circuit components. Also although the discussion focuses on uplink medium control with respect to frame aggregation it is contemplated that control of other types of messages are applicable.

Any combination of the above features and functionalities may be used in accordance with one or more embodiments. In the foregoing specification embodiments have been described with reference to numerous specific details that may vary from implementation to implementation. The specification and drawings are accordingly to be regarded in an illustrative rather than a restrictive sense. The sole and exclusive indicator of the scope of the invention and what is intended by the applicants to be the scope of the invention is the literal and equivalent scope of the set of claims that issue from this application in the specific form in which such claims issue including any subsequent correction.

