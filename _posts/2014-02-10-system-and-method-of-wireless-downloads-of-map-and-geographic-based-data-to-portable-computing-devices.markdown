---

title: System and method of wireless downloads of map and geographic based data to portable computing devices
abstract: Systems and methods of managing map data on electronic devices are disclosed. In one aspect, a method of downloading pushpin data for a map is disclosed. The method includes receiving, from an electronic network, an indication of a current map segment, the current map segment comprising map data for a current location of a device, the current map segment corresponding to a portion of a map displayed on the device, receiving pushpin criteria for the device, identifying pushpin data based on the current map segment and the pushpin criteria, the pushpin data indicating a pushpin location; and transmitting, on the electronic network, the pushpin data.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09137633&OS=09137633&RS=09137633
owner: TIERRAVISION, INC.
number: 09137633
owner_city: La Jolla
owner_country: US
publication_date: 20140210
---
This application is a continuation of U.S. patent application Ser. No. 13 464 654 filed May 4 2012 now U.S. Pat. No. 8 649 968 which is a continuation of U.S. patent application Ser. No. 13 185 052 filed Jul. 18 2011 now U.S. Pat. No. 8 195 389 which is a continuation of U.S. patent application Ser. No. 12 543 305 filed Aug. 18 2009 now U.S. Pat. No. 8 014 945 which is a continuation of U.S. patent application Ser. No. 11 222 208 filed Sep. 7 2005 now abandoned which claims the benefit of U.S. Provisional Application No. 60 607 895 filed Sep. 7 2004 and U.S. Provisional Application No. 60 627 393 filed Nov. 12 2004. Each of the aforementioned applications is incorporated by reference in its entirety.

The invention relates to management of map data and geographically related content on an electronic device. In addition the invention relates to sending and receiving map data from and to a mobile electronic device.

A variety of electronic devices such as mobile computers mobile wireless telephones global positioning system GPS units personal digital assistants PDAs or automobile navigation systems may provide map display and storage capabilities. In addition some electronic devices also include software for storing address books email Internet browsing or other applications that generate or organize map data and geographically related content. The term geographically related content may refer to any information e.g. related to a person place or object that has associated geographic references. A geographic reference may include a street address city zip code postal code municipality region county state province country coordinate latitude longitude pseudo coordinate or geographic index number.

However a need exists for improved systems and methods of integrating between the map and geographically related content display and storage capabilities of these devices and other software on the devices. Moreover a need exists for improved systems and methods of communicating or downloading map data and geographically related content to and from such devices.

The system method and devices of the invention each have several aspects no single one of which is solely responsible for its desirable attributes. Without limiting the scope of this invention some of its more prominent features will now be discussed briefly. After considering this discussion and particularly after reading the section entitled Detailed Description of Certain Inventive Embodiments one will understand how the features of this invention provide advantages that include sharing of geographically related data.

One embodiment is a method of processing geographically referenced content comprising geographical coordinate data in a portable computing device. The method includes receiving from a first source geographically referenced content comprising geographic coordinate data. The method further includes receiving a geographic map from a second source. The method further includes storing the received geographically referenced content in a first portion the data storage. The method further includes storing the geographical map in a second portion of the data storage. The method further includes retrieving the geographical map from the second portion of the data storage based at least in part on a geographical index of the geographical map. The method further includes retrieving geographically referenced content from the first portion of the data storage based at least in part on a geographical index of the geographically referenced content. The method further includes displaying the geographical map on a visual display. The method further includes displaying an icon on the displayed geographical map. The location of the icon on the geographical map corresponds to the geographical coordinate data of the retrieved geographically referenced content.

Another embodiment includes a system for processing geographically referenced content. The system includes means for receiving from a first source geographically referenced content comprising geographic coordinate data. The system further includes means for receiving a geographic map from a second source. The system further includes means for storing the received geographically referenced content. The system further includes means storing the geographical map. The system further includes means for retrieving the geographical map from the second portion of the storing means based at least in part on a geographical index of the geographical map. The system further includes means for retrieving geographically referenced content from the storing means based at least in part on a geographical index of the geographically referenced content. The system further includes means for displaying the geographical map and displaying an icon on the displayed geographical map. The location of the icon on the geographical map corresponds to the geographical coordinate data of the retrieved geographically referenced content.

Another embodiment includes a system for processing geographically referenced content. The system includes at least one transceiver configured to receive from a first source geographically referenced content comprising geographic coordinate data and receive a geographic map from a second source. The system further includes at least one storage configured to store the received geographically referenced content and store the geographical map. The system further includes a processor configured to retrieve the geographical map from the second portion of the storage based at least in part on a geographical index of the geographical map and retrieve geographically referenced content from the storage based at least in part on a geographical index of the geographically referenced content. The system further includes a display configured to display the geographical map and to display an icon on the displayed geographical map. The location of the icon on the geographical map corresponds to the geographical coordinate data of the retrieved geographically referenced content.

Another embodiment includes a method of sharing geographically referenced content. The method includes receiving geographically referenced content from a first mobile electronic device for a second mobile electronic device. Each of the first and second mobile electronic devices comprises a wireless communications transceiver. The method further includes sending data identifying the received geographically referenced content to the second mobile electronic device. The method further includes processing a request from the second mobile electronic device for the received geographically referenced content. The method further includes sending the received geographically referenced content to the second mobile electronic device in response to the request from the second mobile electronic device.

Another embodiment includes a network for transmitting data. The network includes a first communications link configured to communicate geographically referenced content between a first and second wireless device. The network further includes a second communications link configured to communicate the geographically referenced content between the second wireless device and a third wireless device. The geographically referenced content comprises geographic coordinate data of a location which is adapted to be selectively displayed as an icon on a map.

Another embodiment includes a method of sharing geographically referenced content. The method includes receiving a request for geographically referenced content from a first mobile electronic device on a second mobile device. The method further includes determining whether the first mobile device is authorized to receive the geographically referenced content. The method further includes sending the requested geographically referenced content to the first mobile electronic device in response to the request.

Another embodiment includes a system for sharing geographically referenced content The system includes means for communicating with a second mobile electronic device means for processing comprising means for receiving a request for geographically referenced content from the second mobile electronic device means for determining whether the first mobile electronic device is authorized to receive the geographically referenced content and means for the received geographically referenced content to the first mobile electronic device in response to the request.

Another embodiment includes a method of caching map data. The method includes storing a plurality of map segments in a cache. The method further includes associating each of the map segments with a rank. The method further includes updating the rank of at least one of the map segments when the at least one map segment is accessed. The method further includes selecting at least one map segment from the cache to be removed based at least in part on the rank of the at least one selected map segment. The method further includes removing the at least one selected map segment from the cache.

Another embodiment includes system for displaying map data. The system includes means for identifying each of a plurality of geographically referenced contents with an index that is determined based at least in part on geographic coordinates of the respective geographically referenced content means for displaying a representation of a map comprising a plurality of map segments at a selected zoom level on a display means for comparing the index of each of the geographically referenced contents to respective indices associated with each of the plurality of map segments means for selecting at least one of the geographically referenced contents based at least in part on results of the comparing and means for displaying the at least one of the geographically referenced contents on the display.

Another embodiment includes a method of storing map segments. The method includes storing at least one first map segment representing a geographic area at a first zoom level in a storage. The method further includes storing at least one map segment representing a portion of the geographic area at a second zoom level in the storage. The method further includes displaying the first segment on a display. The method fUrther includes visually representing the portion of the geographic area represented by the at least one stored map segment on the display. The at least one stored map segment is visually represented differently on the display from portions of the geographic area that correspond to map segments at the second zoom level that are absent from the storage.

Another embodiment includes a device for storing and displaying map data. The device includes a storage configure to store at least one first map segment representing a geographic area at a first zoom level and configured to store at least one map segment representing a portion of the geographic area at a second zoom level. The device further includes a display configured to display at least the at least one first segment and to visually represent the portion of the geographic area represented by the at least one stored map segment wherein the at least one stored map segment is visually represented differently on the display from portions of the geographic area that correspond to map segments at the second zoom level that are absent from the storage. The device further includes a processor configured to control display of the map segments.

Another embodiment includes a method of accessing map data. The method includes receiving a selection of map data from a user interface. The method further includes storing data indicative of the selected map data in association with data indicative of how to display the map data. The data indicative of the map data comprises at least one of a zoom level a map center location and at least one map layer to display.

Another embodiment includes a method of accessing preferred map locations. The method includes displaying a list of geographic regions. The method further includes displaying a list of types of geographically referenced content. The method further includes receiving geographically reference content in one of the geographic regions corresponding to at least one of the types of geographically referenced content. The method further includes storing the geographically referenced content and the type of geographically referenced content in association with the one of the geographic regions. The method further includes displaying a list of geographically referenced contents in the one of the geographic regions. The stored geographically referenced content is displayed differently than others of the geographically referenced contents.

Another embodiment includes a method of displaying labels associated with locations on a map comprising a plurality of map segments. The method includes ordering a plurality of locations based on respective ranks of the locations. The method further includes selecting a predetermined number of the locations for display within each of the plurality of map segments based on the order of the ranked locations. The method further includes displaying the selected locations. The predetermined number of locations is based at least in part on the zoom level of the map segments.

Another embodiment includes a system for providing directions on an electronic device. The system includes a display configured to display a map. The display is further configured to display a menu comprising a plurality of geographically referenced contents. The system further includes a input device configured to receive activation of a user interface control associated with at least one of the geographically referenced contents. The system further includes a locating determination device configured to determine a location of the system. The system further includes a processor configured to displaying directions on the display between the location of the system and the at least one of the geographically referenced contents associated with the activated control.

Another embodiment includes a system for creating geographically referenced content. The system includes means for receiving a selection of displayed text comprising an address means for identifying geographic coordinates associated with the address means for generating geographically referenced contents associating the address with the geographic coordinates and means for storing the geographically referenced contents.

Another embodiment includes system for identifying a portion of a map on a display. The system includes means for associating each of a plurality of regions of the map with a different color means for displaying each of the regions on the display in the associated color means for receiving a user selection of a pixel of the display means for determining the color of the pixel and means for identifying a selected region of the map by identifying the color of the pixel with the color associated with the selected region.

Another embodiment includes a method of preloading map data. The method includes storing map data on an electronic device. The method further includes determining the location of the electronic device. The method further includes predicting a direction of travel of the electronic device. The method further includes identifying map data along the direction of travel that is absent from the stored map data. The method further includes receiving the identified map data along the predicted direction of travel. The method further includes storing the identified map data.

Another embodiment includes a system for preloading map data. The system includes a storage configured to store map data on an electronic device. The system further includes a device configured to determine the location of the electronic device. The system further includes a transceiver configured to receive map data. The system further includes a processor configured to identify a route of travel of the electronic device identify map data along the route of travel that is absent from the stored map data and download the identified map data along the route of travel via the transceiver.

The following detailed description is directed to certain specific embodiments of the invention. However the invention can be embodied in a multitude of different ways as defined herein. In this description reference is made to the drawings wherein like parts are designated with like numerals throughout.

In one embodiment the electronic device is associated with a particular user or a vehicle. The device includes a data processor or microprocessor a memory or data storage an output device and one or more input devices . The microprocessor may be any conventional general purpose single or multi chip microprocessor such as a Pentium processor Pentium II processor Pentium III processor Pentium IV processor Pentium Pro processor a 8051 processor a MIPS processor a Power PC processor an ALPHA processor or any other suitable processor. In addition the microprocessor may be any conventional special purpose microprocessor such as a digital signal processor or programmable gate array.

Memory refers to electronic circuitry that allows information typically computer data to be stored and retrieved. Memory can refer to external devices or removable storage systems for example disk drives optical drives tape drives or non volatile memory devices. Memory can also refer to fast semiconductor storage chips for example Random Access Memory RAM or various forms of Read Only Memory ROM that are directly connected to the processor or removably connected to the processor. Removably connected memory may include memory on any standardized or proprietary device such as a memory card a secure digital memory card a memory stick or any other suitable removable memory device. In one embodiment the memory is a hierarchical memory model that includes for example. a secondary cache memory of faster memory. e.g. SRAM and a main memory. which may be a slower memory e.g. DRAM. In one embodiment the memory includes solid state persistent memory such as FLASH memory or magneto resistance RAM MRAM . In one embodiment the memory includes a disk drive e.g. a magnetic. optical or magneto optical drive.

The output device may include one or more video and audio output devices such as a display screen a printer or a voice synthesizer. The display screen may be any visual display device such as a liquid crystal display LCD a cathode ray tube CRT . plasma OLEO Organic Light Emitting Diode or any other suitable display device. The output device may include devices such as loudspeakers for producing sounds. In one such embodiment the audio output device may include a vibrator device or other device configured to provide a relatively inaudible signal to a user.

The input devices may be a keyboard rollerball pen and stylus mouse multidirectional navigation button or voice recognition system. The input device may also be a touch screen associated with the output device . The user may respond to prompts on the display by touching the screen. Textual or graphic information may be entered by the user through the input device.

The electronic device may communicate with other electronic devices through one or more network interface devices. The network interface devices may include a first wireless transceiver . In embodiment the first transceiver includes a relatively long range data communication interface such as a mobile telephone transceiver a wireless data transceiver a satellite data transceiver or another wireless network interface device. The electronic device may also include a second wireless transceiver . In one embodiment the second transceiver includes a shorter range communications interface including additional radio interface protocols such as Bluetooth IEEE 802.11 or other wireless protocols. In one embodiment the second wireless transceiver operates on an unlicensed spectrum band such as 2.5 GHz. In one embodiment the electronic device also includes a wired data interface such as Ethernet a serial port a universal serial bus USB port Firewire IEEE1394 a synchronization cradle coupled to a network or other computing device or an interface to a GPS receiver. In one embodiment the electronic device includes an infrared communications link or an optical frequency data link.

In one embodiment the electronic device includes a GPS receiver or other device configured to identify at least approximately the location of the device . In another embodiment the electronic device is configured to communicate with an external GPS device through one of the network interface devices such as a serial port embodiment of the wired data interface or through either or both of the wireless data transceivers and .

It is to be recognized that embodiments may include only a portion of the components . For example certain embodiments may only include a single wireless interface or . Another exemplary device may include only a wired interface .

In one embodiment the system includes a mapping application module that is configured to receive store transmit and manipulate mapping data and geographically referenced content. The mapping application module may communicate with other electronic or computing devices via a network interface module . In one embodiment the network interface module uses one or more of the network interface devices to communicate with a network . The network may include any type of electronically connected group of computers including for instance the following networks Internet Intranet Local Area Networks LAN Wide Area Networks WAN or Wireless Local Area Networks WLAN . In addition the connectivity to the network may be for example remote modem Ethernet IEEE 802.3 Token Ring IEEE 802.5 Fiber Distributed Datalink Interface FDDI or Asynchronous Transfer Mode ATM . Note that computing devices may be desktop server portable hand held set top embedded or any other desired type of configuration. As used herein the network includes network variations such as the public Internet a private network within the Internet a secure network within the Internet a private network a public network a value added network an intranet and the like.

The network may may provide communication to one or more other electronic devices that also include the map data and geographically referenced content system . The geographical map data geographically related content may be transmitted by any suitable data protocol such as Internet Protocol PI including application level protocols such SMTP SMS 1M or HTTP. The network may also provide communication with one or more servers . In one embodiment the server is a web server. In other embodiments the server may respond to any other suitable client server or peer to peer protocol. In one embodiment one or more other electronic devices that include the system are also in communication with the network .

Embodiments of the system may include a user interface module . In one embodiment the user interface includes a graphical user interface. The user interface may be output through the display device . In one embodiment the user interface may produce sounds or activate a vibrator device.

The mapping application module may be configured to interface with a geocoding engine module . The geocoding engine module is configured to translate between address data such as street addresses and geographic coordinate information such as latitude and longitude. In one embodiment the geocoding engine module is configured to translate between different geographic coding systems. For example in one embodiment the geocoding engine module is configured to translate between latitude and longitude and another Cartesian coordinate system. In one embodiment geographically related content includes a geographic index that associates a range of geographic coordinates with a portion of a map. In one embodiment map data is segmented into data portions that are each associated with a particular geographic index. In one embodiment the map data may be segmented differently at a number of zoom levels e.g. in more blocks at more detailed zoom levels and fewer blocks at higher zoom levels. For example a metropolitan area may be represented by a single map segment at the highest zoom least detailed level in 32 blocks at the next highest zoom level and in 256 blocks at the lowest most detailed level. In one such embodiment geographically referenced content having geographic coordinates that fall within a particular segment of map data are referenced by the geographic index of that map segment. In one embodiment geographically referenced content is referenced by geographic indices that identify the map segment and a zoom level of the map segment. One embodiment of a geographic index is discussed in more detail with reference to . More details of one embodiment of a map coordinate conversion scheme are disclosed in the above incorporated U.S. Pat. No. 6 703 947.

In one embodiment the mapping application module is configured to communicate with an application programming interface API module . The API module is configured to interface the mapping application module with other applications or data sources such as an email program an Internet browser a web server a contact manager or any other software application or information stored received or input to the device .

In one embodiment the mapping application module is also configured to communicate with a database module . The database module is configured to store search and retrieve stored data. In one embodiment the data is stored in the memory . In another embodiment the database module accesses the data by communicating with a remote database over the network .

In one embodiment the mapping application module is configured to communicate with one or more map and geographic based content servers to download map data and geographic based content as needed. In one embodiment the mapping application module maintains a local cache or store of map data. This data may be stored by the database module . More details of one embodiment of a map caching scheme are disclosed in U.S. Pat. No. 6 703 947 which is hereby incorporated by reference.

Various other data items may be associated with pushpins. For example a displayable layer may be associated with a pushpin. In one embodiment the mapping application module can be configured to selectively display pushpins that are associated with one or more layers. An icon image for displaying the geographically related content such as a pushpin on a map may also be associated with each pushpin. In one embodiment the mapping application module can be configured to selectively display only those pushpins associated with one or more icons images or data identifying an icon e.g. an icon index. In one embodiment the mapping application module can be configured to selectively display only those push pins associated with one or more icons images identifiers.

In one embodiment the mapping application module can be configured to selectively display only those pushpins associated with the particular data values contained in one or more of the data fields associated with a pushpin such as pushpin name pushpin comments pushpin data value pushpin attribute address zip code municipality country location index number map segment index coordinate range phone number Internet address email address user identifier device identifier etc.

Embodiments include methods of sending pushpins between one or more electronic devices . For example these methods include sending a message or instruction to a device that includes the system . This message or instruction starts the system if it is not already running in the background and then displays custom pushpin s at the position s requested and fills in all the associated the pushpin data fields. The originating device sends a message containing the information about the pushpin s and the identity of the destination device to the web server . The web server then sends a short message system SMS or other message or communication to the device telling it that there is a pushpin or set of pushpins to be received from the web server and gives the destination device an access code perhaps consisting of the web server address user account and a password . The destination device then accesses the web server with the user account and access code and downloads the information regarding the pushpin s .

One embodiment is a method of sending multiple pushpins from an Internet browser so that a user with access to the Internet can send one or more pushpins and associated data to any suitable destination device . In one such embodiment the Internet browser sends the pushpin information and information identifying the destination device to the intermediate web server . In one embodiment the web server then sends a message to the device notifying the destination device that there is a pushpin or set of pushpins to be received from the web server . In one embodiment the notification is an SMS message.

It is to be recognized that in other embodiments the notification message may be sent using any suitable communication protocol including those discussed herein. The notification message may also include an access code. In one exemplary embodiment the access code includes the web server address a user account and a password. The destination device then accesses the web server with access code and downloads the information regarding the pushpin s . In one embodiment software or hardware on the destination device starts the system if it was not already running. The system can then display the positions of the received push pins.

One embodiment is a method of sending multiple push pins via an intermediate website to other devices. This enables individual users to send their location to a central location register and retrieve the locations of other pushpins within a certain geographic region or with a specific set of search criterion. For example individual devices may send their pushpin locations and associated information to the intermediate website. Dependent on the location of the device the intermediate server may send back to the device a set of pushpins within a predetermined geographic area which meet the desired criteria. As the devices move around they may update their location for example with a frequency based upon the distance moved including data such as the current map segment index number the time between location updates etc.

Other embodiments include methods of sending multiple location pushpins via a peer to peer architecture. Individual users may send their locations directly to other users and retrieve the locations of yet other pushpins within a certain geographic region without going through a central server. In one embodiment users can ask for the location of another specific user and get that information from other users in the network that happen to know where that user is currently. Thus such embodiments do not include a central database or intermediate server.

Moving to decision block the pushpin data is checked for coordinate data. If no data is found the method proceeds to block . At block the mapping application module associates coordinate information with the pushpin using the geocoding engine module which may be located in the system on the device or on a remote web server . Next at block the pushpin data is imported into the appropriate displayable layers in the database module . Proceeding to block the pushpins are displayed using the user interface module e.g. to the display .

Another embodiment includes a method of communicating data from the mapping application to another application or data source such as an address or contact manager. In one embodiment a user selects a pushpin multiple pushpins or a layer of pushpins and invokes a user interface such as a menu button. In one embodiment the mapping application module sends the pushpin data to another application or data source via the API module . In one embodiment the user interface module provides a control such as a menu item that provides the user with an option to send one or more pushpins and their associated data in a selected map layer to another application or data source .

Next at block the intermediate server sends the pushpin file access data or pushpin database access data to the destination device . Moving to block the system receives the intermediate server access data on the destination device . Next at block the system either automatically or after prompting a user sends the intermediate server access data to the mapping application module . Next at decision block whether the mapping application module is executing or initialized is detected. If the mapping application module is not executing it is started at block . Next at block the mapping application uses the intermediate server access data to authorize retrieval of the pushpin data from the intermediate server. Moving to block the pushpin data is imported into the appropriate custom layers in the mapping application module and stored in database module . Proceeding to block the pushpins are displayed using the user interface module e.g. to the display .

Other embodiments include methods of an originating device to request pushpins from another destination device or an Internet server. In certain embodiments these methods include the originating device sending a message or instruction to the system on the destination device to request that the destination device running the system transmit a response message or instruction back to another predetermined location Internet server or device . The response message or instruction from the destination device may contain information for custom pushpins at some location of interest e.g. the current device location the future device position past device position position of other devices points of interest pushpin locations text message etc.

The requested pushpin data may be from a number of sources another application running on the destination device such as an email or SMS client address book calendar contact manager database program enterprise application inventory control dispatch asset tracking parcel shipping fleet management etc. another device running the system another device running another application such as an email or SMS client address book calendar contact manager database program enterprise application inventory control dispatch asset tracking parcel shipping fleet management etc. direct input to the device from a command console e.g. via serial port USB port etc. an Internet browser connecting to a website a central location register website e.g. as used in ICQ IM applications etc. an Internet server e.g. an FTP server a map data server an address lookup server etc.

As with pushpin data sent by embodiments of the methods described above the message data sent either from the intermediate server to the destination device or from the originating device may include an Internet command message e.g. HTTP ICQ proprietary Internet message format etc. a text file stored on a webpage a text file stored on an FTP server an email an SMS message or communication directly with the system running on the device after a remote connection has been established. Pushpin data may include pushpin name s e.g. single or multiple pushpin s start pushpin finish pushpin intermediate stop waypoint pushpins etc. pushpin comments pushpin icons pushpin addresses pushpin appointment times pushpin location e.g. coordinates pseudo coordinates etc. pushpin location index number pushpin phone number pushpin Internet address pushpin email address pushpin layer inter pushpin driving directions text and route segment coordinates or pseudo coordinates source device e.g. IP address SMS number email address phone number pseudo number identifier device user name vehicle identifier location identifier personal identifier etc. destination device e.g. IP address SMS number email. address phone number pseudo number identifier device user name personal identifier etc. or source device message type format.

Proceeding to decision block the mapping application module determines whether the originating device is authorized to request the pushpin data from the destination device. In one embodiment the authorization is based on comparing the originating device with a list of devices. In another embodiment a suitable cryptographic key exchange protocol may be used to determine whether the originating device is authorized. If not at block a message rejecting the request is returned to the originating device and the method ends. If the originating device is authorized to make a request the pushpin data is sent in a message from the destination device back to the originating device . Moving to block the message is received by the system of the originating device . Next at block the system either automatically or after prompting a user sends the pushpin data to the mapping application. The method then proceeds to block of and the method continues as described above with reference to .

The method begins at a block in which the system sends a communication such as an email SMS IM instant or Internet message from the originating device to the intermediate server to request pushpin information. Next at a block the intermediate server receives the communication. Moving to block the intermediate server determines whether the originating device is authorized to request the pushpin from a particular destination device . If the device is not authorized the method proceeds to a block in which the intermediate server sends a communication back to the origination device rejecting the request. The method then terminates. If the device is authorized the method proceeds to a block in which the intermediate server sends a communication including the request to the destination device for the pushpin information.

Next at a block the destination device receives the communication containing the request. Proceeding to a block the destination device sends instructions to the mapping application that includes the pushpin request information. In one embodiment the system on the device prompts the user to manually instruct the mapping application module to process the request. In another embodiment the system automatically instructs the mapping application module to process the request. In one embodiment the system executes the mapping application if needed.

Proceeding to block the mapping application module determines whether the intermediate server is authorized to request pushpin data from the destination device . In one embodiment the determination is based on a list of authorized servers . In another embodiment the determination is based on a comparison of request data with predetermined criteria established by the user such as the originating device a user of the originating device or on portions of the requested pushpin data. If the requestor is not authorized the method proceeds to a block in which the destination device sends a communication back to the intermediate server rejecting the request. If the requestor is authorized the method proceeds to a block in which the mapping application module retrieves the requested pushpin information.

Moving to a block the system communicates the requested information to the intermediate server . Next at a block the intermediate server communicates the requested pushpin information to the originating device

Proceeding to a block the system of the originating device receives the pushpin and either automatically or manually e.g. by prompting a user via a user interface provides the information to the mapping application module . In one embodiment the system executes the mapping application if needed. Next at a block the mapping application module receives the pushpin data and displays it at the appropriate location on a map.

Embodiments also include methods for performing pushpin commands. is a flow diagram illustrating a set of exemplary commands. The method begins at block where the system receives an input for example tapping on a custom pushpin to activate a menu. Next at block the system receives a command selection from the menu. Commands may include sending pushpin data and associated information to another device or remote location dialing a predetermined phone number starting an Internet browser at a predetermined URL sending an email to a predetermined location sending an SMS message to a predetermined address adding a contact to the address book of the device adding an appointment to the calendar of the device starting another application on the device and send it a command or instruction or downloading to the device a further map floor plan or other content relating to that pushpin for example.

Another embodiment includes a method of intelligently caching map segments. The method includes intelligently downloading and storing map segments on the electronic device to ensure that newly requested map segments get downloaded and cached and previously downloaded and cached map segments get retrieved and instantly displayed. In addition map segments which have not been viewed recently get discarded from the map cache first map segments which are rarely viewed get discarded first and segments with low significance based on last view date and time and number of views and lowest zoom level get deleted first such that the memory available to the device does not tend to get over filled. Thus as many map segments are stored as possible on the device and the most relevant map segments are deleted last from the map segment cache. Further map processing time or processor power can be reduced because only the map segments which are currently being downloaded or retrieved from cache need to have the counters indicating their respective map segment relevancy updated.

At a decision block the cache is checked for the desired map segments for each segment not in the cache the method proceeds to a block in which the map segments are downloaded. Next at a block each downloaded map segment is assigned a number of Activity Points . In one embodiment this value is set to be the current Time Period Since Install plus some Download Credit for example 365. If a map segment was retrieved from cache at the block then the method proceeds to block in which the number of Activity Points assigned to that segment is updated to the current Time Period Since Install plus some Cache Retrieval Credit for example 180. Next at bock the system updates a ranked table containing the map segment identifier and the corresponding number of Activity Points sorted by number of Activity Points . The table may also be sorted by zoom level of the map segments.

Next at a decision block the system determines whether the Cached Segment Memory exceeds a predefined threshold value Maximum Allowable Cached Segment Memory or if overall device memory falls below a threshold. If the thresholds are not exceeded the method terminates. If the thresholds are exceeded the method proceeds to a block in which the map segments with the lowest number of Activity Points gets deleted first until the Current Cached Segment Memory is reduced to a predefined Nominal Cached Segment Memory threshold. If multiple segments have the same lowest number of Activity Points the system deletes the segments with the lowest zoom level first i.e. those segments that cover the smallest geographic area. If multiple segments have the same Activity Points and the same lowest zoom level then the system deletes the segments with the lowest total of the 8 adjacent segment Activity Points . If multiple segments still have equal lowest number of Activity Points then the map segments may be deleted one by one in order until the Current Cached Segment Memory is reduced to the predefined acceptable Nominal Cached Segment Memory . The method then terminates.

Another embodiment includes a method of pushpin indexing. The method includes associating each pushpin with a geographic index number or a series of index numbers or identifiers. In one embodiment these index numbers are used to display only pushpins within the currently retrieved map segments or currently displayed map area or some other predefined geographic region. In one embodiment the index numbers are used to select pushpins within the currently retrieved map segments or currently displayed map area or some other predefined geographic region for query or download. In another embodiment pushpins are selected based on being associated with the predetermined identifier. The use of the index number in such embodiments tends to speed the selection and processing of the desired pushpin data and hence speeds the display of the pushpins of interest. In some embodiments as the map area is updated in cache the index numbers are used to automatically download cache or delete the pushpins for the corresponding map segments in the custom layers which are loaded in cache. The use of geographically based index numbers enormously speeds processing and display when viewing layers with very large numbers of pushpins e.g. nationwide store locations real estate databases yellow pages etc.

In one embodiment the pushpin indexes are calculated according to the equations in Table 1. In the equations below the values prefixed with TMB TMC and TMD refer to indexes at three particular zoom levels in order from highest to lowest zoom level. The equations prefixed by TV are used to convert from Latitude Longitude coordinates into a positive integer based coordinate scheme. More details of one embodiment of a map coordinate conversion scheme are disclosed in the above incorporated U.S. Pat. No. 6 703 947.

Another embodiment includes a method of multiple map segment download and deletion to enable the user to download multiple map segments inspect what map segments are in cache and to delete one or more of the map segments. The user can thus simply inspect what segments are stored in cache and delete them if required or if necessary do a large area map pre installation download. For example a user of a device may update the maps installed while it is in a network connected environment such as in its synchronization cradle or otherwise connected to a network so that the device has maps available for an intended trip in which the device may not always be connected to a network or otherwise have access to a map segment server . is a screen shot illustrating exemplary views associated with one embodiment in which cached segments are presented in a different color or shading from non cached segments . is a flowchart illustrating one embodiment of method of indicating the cache status of map segment data. Beginning at block the user selects the map of for example the US Canada or another smaller geographic area . Next at block a grid is displayed on the map corresponding to the geographic boundary of each of the segments at the different zoom levels e.g. TMB 32 km TMC 4 km or TMD 500 m as disclosed in the above incorporated U.S. Pat. No. 6 703 947. Moving to block all the map segments within the screen display area are queried to identify which map segments are stored in cache. Next at block if TMB TMC or TMD segments are identified as being stored in cache then various different colors and shading are displayed in the respective grid regions to represent the presence of the respective map segments in the map screen display area at the different zoom levels. Alternatively the user interface may provide the user with a control to toggle between the different grid and segment sizes i.e. the different map zoom levels to display which map segments are stored in cache. Thus the user may identify the segments in cache at any particular zoom level by looking at the shaded sizes and colors or just by toggling between the various grid and segment types i.e. map segment zoom levels .

Another embodiment includes a method of storing a particular presentation of a map in a list of favorites. Simply storing a particular map location does not allow a user to conveniently view a map using previously identified desirable settings. A handheld device may be used while walking or driving and may have more limited controls than a desktop computer or similar computing device. Thus it has been found that it is desirable to provide a user with a simple interface for storing some particular presentations of a map and geographic based content for later viewing. The elements of the presentation that may be saved include the current screen settings i.e. map center location zoom level custom layers etc. In one embodiment the user interface module provides an interface for the user to save the current screen settings i.e. map center location zoom level custom layers etc. by just selecting Add Favorite and then the current settings are saved to whatever name is preferred. For example a Favorite might be named San Diego Museums Toronto Libraries etc. are flowcharts that illustrate embodiments of methods of manipulating favorites. . is a flowchart depicting one embodiment of a method of creating a favorite via e.g. user interface module . The method begins at a block in which a user selects the desired settings data. This data may include one or more of a map center location a map screen zoom level a list of visible custom content layers specific pushpin or other suitable data. Moving to a block the user selects a name or enters a new name of a favorite. The user interface module receives the selected settings and stores these settings in association with the favorite.

Another embodiment includes a method of displaying a list of preferred locations such as cities and airports for regions states or provinces. In one embodiment the user interface provides a pull down list of cities and airports that can be found quickly e.g. a QuickFind list. In one embodiment rather than simply display the list of locations in a particular region or state using a sorting rule such as alphabetically the list of locations in a particular region state or province may be ordered based on the preferred locations such as the largest city and main airport that are within that selected region state or province. Thus the preferred locations are provided to the user for easier and quicker access to those preferred locations which are most likely to be selected by the user. In one embodiment the users quickly select the most likely locations they want to find by selecting the QuickFind feature and the desired region state or province and then the most likely selected Le. popular locations are listed first in the pull down list.

Another embodiment includes a method to display municipality names based on the number of cities and towns and other municipalities within the screen display area. In metropolitan areas the number of municipalities within the screen area is very high and the screen tends to become cluttered if too many location names are displayed. In rural areas the number of municipalities is typically lower. In an embodiment in which only cities or towns of a predetermined size or population are displayed small towns may not be displayed except at the highest zoom in levels. It is more desirable when displaying rural areas to display even the smallest towns. For example when driving across a desert with no large towns the display of even the smallest hamlet is helpful for a user to determine position estimate time of arrival confirm being on route etc.

Another embodiment includes a method of identifying pushpin data from text presented in any application on the device . In one embodiment this functionality is integrated with the system and the geocoding engine module used to associate geographic coordinates or pseudo coordinates with any pushpins so identified. Associating coordinate or pseudo coordinate data with pushpins identified from textual addresses or other information produces pushpin data that can be displayed on a map without further processing. This is desirable to allow efficient display of pushpins without having to look up for example the coordinates of a large database of pushpins at display time . Moreover such pushpins can be displayed on the electronic device even when the device does not include a full map database for geocoding addresses or is out of communication with the network .

Moving to block the mapping application module creates a pushpin including the geographic location data from the geocoding engine module . Next at block the mapping application module stores the pushpin and its associated coordinate or pseudo coordinate data. In one embodiment the mapping application module stores the pushpin via the database module .

Another embodiment includes a method of manually selecting a map area based in its display color rather than the position tapped on the display screen. Electronic devices increasingly include displays having higher color or grayscale bit resolution. For example a 16 bit display can display over 64 000 shades of color. In other embodiments the display color resolution ranges from 832 bits. Thus many if not most maps can be created such that each country region or other area on the map can be colored or shaded in a different color. Thus this embodiment is a method of efficiently determining which state country or other geographic region has been selected by a user based on the color of a selected display location. Identifying a map location based on the displayed color data may be particularly advantageous on devices that have limited processing or memory to avoid maintaining additional data structures for identifying a selected point with a map region or performing computationally intensive processing to identify a selected point with a map region.

Next at a block the mapping application module identifies map segments along the heading that are not stored on the electronic device . In one embodiment the mapping application module determines a vector based on the electronic devices heading and increases the length of the vector incrementally until it projects from the current location to a position for which the electronic device lacks map data. In one embodiment the increment of the vector length increase is based on the zoom level of the map. In one embodiment the increment is about equal to size e.g. width of each map data segment at the current zoom level. Next at a block the mapping application module downloads the identified map segments. In one embodiment the number of identified map segments that are downloaded is reduced to a number that fits within the storage space of the electronic device. In another embodiment the identified map segments are downloaded and may replace existing map segments in storage according to in one embodiment a cache replacement algorithm such as described with reference to .

Moving to a block the mapping application module may also download geographically referenced contents such as points of interest or pushpins associated with the newly identified and downloaded map segments. In one embodiment the points of interest are selected based on user preferences for data to be downloaded upon entering a new area. The points of interest data may include data such as traffic data traffic incident data or weather conditions in the newly identified map data segments. The method thus allows a device to preload map data that is likely to be needed so as to avoid download delays when the data is needed. In addition this preloaded data may be downloaded when the electronic device is in communication with map data management server so that it is available even if the device moves out of network communication. In one embodiment the downloaded data is deleted when for example the predicted heading changes or the device has moved beyond the corresponding map location along the route.

Depending on the embodiment the acts or events of the exemplary methods illustrated herein can be performed in different sequences can be merged or can be left out altogether. e.g. not all acts or events are necessary for the practice of the method unless the text specifically and clearly states otherwise. In addition the methods described herein can include additional acts or events unless the text specifically and clearly states otherwise. Moreover unless clearly stated otherwise acts or events may be performed concurrently e.g. through interrupt processing or multiple processors rather than sequentially. In one embodiment the mapping application module may also download points of interest or pushpins associated with the newly identified and downloaded map segments.

While the above detailed description has shown described and pointed out novel features of the invention as applied to various embodiments it will be understood that various omissions substitutions and changes in the form and details of the device or process illustrated may be made by those skilled in the art without departing from the spirit of the invention. As will be recognized the present invention may be embodied within a form that does not provide all of the features and benefits set forth herein as some features may be used or practiced separately from others.

Clearly other embodiments and modifications of this invention will occur readily to those of ordinary skill in the art in view of these teachings. The above description is illustrative and not restrictive. This invention is to be limited only by the following claims which include all such embodiments and modifications when viewed in conjunction with the above specification and accompanying drawings. The scope of the invention should therefore be determined not with reference to the above description but instead should be determined with reference to the appended claims along with their full scope of equivalents.

