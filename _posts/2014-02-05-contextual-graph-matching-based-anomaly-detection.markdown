---

title: Contextual graph matching based anomaly detection
abstract: Contextual graph matching based anomaly detection may include evaluating computer-generated log file data to create a master directed graph that specifies known events and transitions between the known events. The master directed graph may be processed to determine a plurality of decomposed master graph walks. Incoming computer-generated log file data may be evaluated to create an incoming directed graph that specifies unknown events and transitions between the unknown events. The incoming directed graph may be processed to determine a decomposed incoming walk. Overlap, distance difference, and correlation scores may be determined for each walk pair of a plurality of walk pairs including each of the plurality of decomposed master graph walks and the decomposed incoming walk. One of the decomposed master graph walks may be selected based on the overlap score, the difference score, and the correlation score, to detect an anomaly.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09367809&OS=09367809&RS=09367809
owner: ACCENTURE GLOBAL SERVICES LIMITED
number: 09367809
owner_city: Dublin
owner_country: IE
publication_date: 20140205
---
This application claims the benefit of Provisional Patent Application Ser. No. 61 889 722 filed Oct. 11 2013 which is expressly incorporated herein by reference.

Enterprise environments typically generate log files to record a variety of activities. Sifting through the log file data sources to find errors and anomalies can be a daunting task for example due to the extensive volume of such log files. Log content analytics LCA is the application of analytics and semantic technologies to consume and analyze heterogeneous computer generated log files to discover and extract relevant insights in a rationalized and structured form.

For simplicity and illustrative purposes the present disclosure is described by referring mainly to examples thereof. In the following description numerous specific details are set forth in order to provide a thorough understanding of the present disclosure. It will be readily apparent however that the present disclosure may be practiced without limitation to these specific details. In other instances some methods and structures have not been described in detail so as not to unnecessarily obscure the present disclosure.

Throughout the present disclosure the terms a and an are intended to denote at least one of a particular element. As used herein the term includes means includes but not limited to the term including means including but not limited to. The term based on means based at least in part on.

Data present in the contents of log files may be characterized by log traces with unique identifiers time stamps events and actions. These attributes may be indicative of underlying behaviors of applications the processes that may interact with applications and the subsequent patterns that exist and may have been created by a series of events. Through mining and correlation the information contained within log files may be modeled as a graph with statistics event states and transition probabilities between events. Learning the behavior of applications through log file traces and understanding the flow of events that occur within applications can facilitate performance of log content analytics for example with regard to an enterprise environment.

A contextual graph matching based anomaly detection system and a method for contextual graph matching based anomaly detection are disclosed herein and may generally provide for discovery of the existence of aberrations and other phenomena within log files as the aberrations and phenomena occur. The system and method disclosed herein may generally provide for extraction of correlations between trace events within log files and the information surrounding them such as probability of occurrence of trace log events probability of transitions between particular trace log events execution times of trace log events and anomalous occurrences of trace log events. The system and method disclosed herein may apply graph matching to log file mining and anomaly detection. The system and method disclosed herein may implement a scalable framework to facilitate learning of application behavior utilizing log files. Based on the mining of large data sets of log files a master directed graph i.e. a directed cyclic graph may be produced. The master directed graph may represent application behaviors through state probabilities transitions and other relevant features. The system and method disclosed herein may utilize feature extraction to measure similarity between weighted labeled and master directed graphs. The master directed graphs may provide context and intuition on the degree of fitness for a series of related events that a master directed graph generation module of the contextual graph matching based anomaly detection system may mine from log files.

The system and method disclosed herein may characterize how an incoming directed graph representing a set of events differs from a master directed graph that represents known or pre established events. A graph matching module of the contextual graph matching based anomaly detection system may calculate a bounded metric to characterize the degree of contextual fitness or anomalousness of a decomposed incoming walk compared to a decomposed master graph walk of the master directed graph. The computation of the metric may be based on the master directed graph structure providing a probabilistic insight on graph similarity. The system and method disclosed herein may provide information that may be used proactively and may further provide a metric for the contextual anomalousness of an event sequence when compared to the probability distribution of patterns present within an overall mined master directed graph.

According to an example a contextual graph matching based anomaly detection system is disclosed herein and may include a processor and a master directed graph generation module executed by the processor to evaluate computer generated log file data to create in a computer memory a master directed graph that specifies known events and transitions between the known events. A master directed graph decomposition module may process the master directed graph to identify a plurality of unique walks through the master directed graph and to decompose the plurality of unique walks into their probability distributions as a plurality of decomposed master graph walks. An incoming directed graph generation module may evaluate incoming computer generated log file data to create an incoming directed graph that specifies unknown events and transitions between the unknown events. An incoming directed graph decomposition module may process the incoming directed graph to identify an incoming walk through the incoming directed graph and to decompose the incoming walk into its probability distribution as a decomposed incoming walk. A graph matching module may determine an overlap score for each walk pair of a plurality of walk pairs including each of the plurality of decomposed master graph walks and the decomposed incoming walk and further determine a distance difference score and a correlation score for each walk pair of the plurality of walk pairs. An anomaly detection module may select one of the plurality of decomposed master graph walks based on the overlap score the difference score and the correlation score and detect an anomaly based on the selected one of the plurality of decomposed master graph walks.

According to an example a method for contextual graph matching based anomaly detection is disclosed herein and may include evaluating by a processor computer generated log file data to create in a computer memory a master directed graph that specifies known events and transitions between the known events. The method may further include processing the master directed graph to identify a plurality of unique walks through the master directed graph and to decompose the plurality of unique walks into their probability distributions as a plurality of decomposed master graph walks. The method may include evaluating incoming computer generated log file data to create an incoming directed graph that specifies unknown events and transitions between the unknown events. The method may further include processing the incoming directed graph to identify an incoming walk through the incoming directed graph and to decompose the incoming walk into its probability distribution as a decomposed incoming walk. The method may include determining an overlap score for each walk pair of a plurality of walk pairs including each of the plurality of decomposed master graph walks and the decomposed incoming walk by evaluating an intersection and a union of an edge set of one of the plurality of decomposed master graph walks and an edge set of the decomposed incoming walk and determining a distance difference score and a correlation score for each walk pair of the plurality of walk pairs. The method may further include selecting one of the plurality of decomposed master graph walks based on the overlap score the difference score and the correlation score to detect an anomaly based on the selected one of the plurality of decomposed master graph walks.

According to an example a non transitory computer readable medium having stored thereon machine readable instructions for contextual graph matching based anomaly detection is disclosed herein. The machine readable instructions that when executed cause a processor to evaluate computer generated log file data to create in a computer memory a master directed graph that specifies frequencies of state transitions within the master directed graph. The machine readable instructions that when executed may further cause the processor to process the master directed graph to identify a plurality of unique walks through the master directed graph and to decompose the plurality of unique walks into their probability distributions as a plurality of decomposed master graph walks. The machine readable instructions that when executed may further cause the processor to evaluate incoming computer generated log file data to create an incoming directed graph that specifies frequencies of state transitions within the incoming directed graph. The machine readable instructions that when executed may further cause the processor to process the incoming directed graph to identify an incoming walk through the incoming directed graph and to decompose the incoming walk into its probability distribution as a decomposed incoming walk. The machine readable instructions that when executed may further cause the processor to determine an overlap score for each walk pair of a plurality of walk pairs including each of the plurality of decomposed master graph walks and the decomposed incoming walk determine a distance difference score for each walk pair of the plurality of walk pairs and determine a correlation score for each walk pair of the plurality of walk pairs based on the frequencies of state transitions within the master directed graph and the frequencies of state transitions within the incoming directed graph. The machine readable instructions that when executed may further cause the processor to select one of the plurality of decomposed master graph walks based on the overlap score the difference score and the correlation score to detect an anomaly based on the selected one of the plurality of decomposed master graph walks.

The system and method disclosed herein may include learning capabilities whereby the known master directed graph generated from the log files may be evolved as more information related to the master directed graph becomes available. The system and method disclosed herein may be applicable in areas such as for example audit or regulatory compliance security policy compliance digital forensic investigation security incidence response anomaly detection error tracking application debugging fraud and or in situations where there is a need for active intelligence as to the operational behavior of applications and events for which guidance on proactive measures are sought. Generally the system and method disclosed herein may be applicable to any area that requires the understanding of data and application behavior. For example the log files and related log file data as described herein may be related to a user s interactions with a website for example to determine whether the interactions are intended to bypass a security mechanism related to the website. Based on the analysis of the log file data the system and method disclosed herein may detect anomalies related to the user s interaction with the website e.g. whether the user s interaction is a typical interaction or whether the user s interaction is unauthorized .

The system and method disclosed herein may apply trace mining techniques to discover the temporal relationships between log trace events. The system and method disclosed herein may further discover the probability of event occurrences discover the probability of transitions between events and detect and report anomalous states by analyzing the execution times of events. Further the system and method disclosed herein may cluster and group related events based on transition density and produce visualizations representing temporal rules. The output of the system and method disclosed herein may be fed into other processes for real time processing or enrichment. The system and method disclosed herein may be used as a plug in framework that has the capability to change backend connectors as the backend technology changes. Further the system and method disclosed herein may provide a reusable framework that can be called and reused as needed with no modification to the original source.

The system and method disclosed herein may provide for processing of logs and extraction of trace sequences at large volumes of data. As disclosed herein the system and method disclosed herein may further provide for performance of extraction with parallel map reduce processing production of graph outputs of information that may be used to seed real time analysis anomaly detection and discovery of root cause analysis. The system and method disclosed herein may include the capability of running locally on a local Hadoop cluster or in the cloud with elastic scaling. The system and method disclosed herein may provide for automatic detection of storage capabilities for the processing of relatively large datasets and filtering of data to provide targeted views of data of relevant interest in the output. The system and method disclosed herein may further include a configurable plug in architecture for extension with new techniques and include an extendable and reusable framework.

For the system and method disclosed herein matching of decomposed master graph walks to a decomposed incoming walk may account for intersection intersection strength intersection confidence and intersection type. With respect to intersection intersection may be defined as the existence of a mined trace sequence within a larger mined trace sequence graph i.e. the master directed graph . Intersection strength may be defined as the degree of fit of a mined trace sequence to a probability ranking. Intersection confidence may be defined as the highest correlation between a trace sequence i.e. the decomposed incoming walk and existing trace sequences i.e. the decomposed master graph walks within the master directed graph. Further intersection types may include converging or diverging intersection. For converging intersection a decomposed incoming walk may fit a known decomposed master graph walk with the same directionality. For diverging intersection a decomposed incoming walk may fit a known decomposed master graph walk with the opposite directionality.

The contextual graph matching based anomaly detection system and the method for contextual graph matching based anomaly detection disclosed herein provide a technical solution to technical problems related for example to anomaly detection in log file data. In many instances anomaly detection in log file data can be a daunting task for example due to the extensive volume of such log files. The system and method disclosed herein provide the technical solution of evaluating computer generated log file data to create in a computer memory a master directed graph that specifies known events and transitions between the known events. The master directed graph may be processed to identify a plurality of unique walks through the master directed graph and to decompose the plurality of unique walks into their probability distributions as a plurality of decomposed master graph walks. Incoming computer generated log file data may be evaluated to create an incoming directed graph that specifies unknown events and transitions between the unknown events. The incoming directed graph may be processed to identify an incoming walk through the incoming directed graph and to decompose the incoming walk into its probability distribution as a decomposed incoming walk. An overlap score may be determined for each walk pair of a plurality of walk pairs including each of the plurality of decomposed master graph walks and the decomposed incoming walk for example by evaluating an intersection and a union of an edge set of one of the plurality of decomposed master graph walks and an edge set of the decomposed incoming walk. Further a distance difference score and a correlation score may be determined for each walk pair of the plurality of walk pairs. One of the plurality of decomposed master graph walks may be selected based on the overlap score the difference score and the correlation score to detect an anomaly based on the selected one of the plurality of decomposed master graph walks.

As described herein the modules and other elements of the contextual graph matching based anomaly detection system may be machine readable instructions stored on a non transitory computer readable medium. In addition or alternatively the modules and other elements of the contextual graph matching based anomaly detection system may be hardware or a combination of machine readable instructions and hardware.

With respect to the master directed graph generally the log file data such as log content may be characterized by events with unique identifiers timestamps and actions. In order for the master directed graph generation module to generate the master directed graph the master directed graph generation module may extract information such as correlations between trace events probability of occurrence of trace log events probability of transitions between particular trace log events execution times of trace log events and anomalous occurrences of trace log events from the log file data . The master directed graph that is mined from the log files may represent behavioral patterns that describe temporal ordering and potential causality relationships between trace events that occur with a certain measure of probability. In order to compare a sequence of incoming events i.e. the decomposed incoming walk to a known model of events i.e. the master directed graph the incoming directed graph decomposition module may generate the decomposed incoming walk and represent the transitions from one event to another as a weighted and normalized probability. When comparing the decomposed incoming walk to the master directed graph the graph matching module may extract several features such as for example probability ranking of occurrence overlap distance and the correlation of the transition weights or probabilities to describe a time correlated series of log traces.

With respect to generation of the master directed graph from the log file data log files may store information in a transactional format from which trace events may be linked correlated against time and associated with unique identifiers. Information present in the log files may include location origination and other relevant information for some task or trace occurrence that has been logged. Over time information that is present in the log file may be mined to link events together discover time correlated groupings of events or behaviors and tracked according to frequency of occurrence and frequency of occurrence of transitions between events. With respect to mining of the log files and discovery of insights the master directed graph generation module may ingest and analyze the content of the log files and discover and extract the temporal causality behaviors of traces and events. The mined information may be viewable as the master directed graph for facilitating exploration. The master directed graph generation module may mine and process logs at scale for extraction of relationships in either full scale distributed mode or emulation mode data profiling filtering and exploration.

Referring to the master directed graph generation module may include a log file event management module to pull information from the log file data . The log file event management module may control the access and instruction set needed to provide a seamless transition of data between a provider of the log files and the framework of the log file event management module . A log ingestion module may receive and parse the log file data . The log ingestion module may also normalize the log file data into a vendor agnostic format for further analysis by the other modules of the master directed graph generation module . Normalization of the log file data may be performed via customizable connectors that allow for reuse. Additionally the log ingestion module may provide the capability to load and store models generated and used by the other modules of the master directed graph generation module . A query module may operate as a mediator or interface between the log file event management module and the log ingestion module and a data mining module an analytics module a filter module and a command and application programming interface API dispatcher module . The query module may provide an abstraction layer that is different from the underlying providers of the log file data and specific storage formats of the log file data . The data mining module may perform the data extraction and discovery of relationships within the log file data . The analytics module may perform the analysis of the log file data that has been mined and extracted for example using event clustering. The filter module may filter and pair down the log file data to reduce overall size of a model that is exported for example by event filtering edge strength filtering for trace sequence graphs etc. The command API dispatcher module may function as the primary interface into log content analytics framework of the master directed graph generation module . The command API dispatcher module may provide for the master directed graph generation module to be operated as a tool from a terminal prompt or utilized within another application as an API with all the configuration and extensibility of a command line application.

The master directed graph generation module may perform data mining in parallel and at scale by creating process flows utilizing for example the Hadoop Map Reduce framework. To provide for process mining in a distributed environment a plurality of the master directed graph generation modules may be used to read portions of one or more of the log files mine the information locally and then forward models to a reducer to aggregate information from all of the plurality of master directed graph generation modules . The log file data may be normalized according to the schema of the input log files and trace events may be correlated with other known trace events within the master directed graph generation module . For a distributed environment each of the master directed graph generation modules may receive streamed log trace information and deconstruct the information into a rationalized internal form for association with other related trace events according to a feature set including for example unique identifiers time stamps and trace event categories for the incoming log file data . As each trace event is extracted from a log trace the trace event may be correlated against previously mined and known trace events using its feature set and ordered temporally to create a unique sequence of trace events. This may be performed for every incoming log trace and subsequent extracted trace events to create multiple trace event sequences. Once the entire set of trace event sequences have been mined from the log files or a portion of the log files a Bayesian network may be constructed from the aggregate view of all trace sequences to generate the master directed graph . The master directed graph generation module may track information such as for example probability of event occurrence time durations and probability of transitions from one event to another.

Based on the foregoing aspects assuming independence of the underlying data the probability ranking for any walk i occurring may be specified as follows Equation 1 

For Equation 1 and n k w where n and k may be adjacent nodes within the master directed graph . For the master directed graph the basis for the assumption of independence may derive from a lack of knowledge of the underlying data collection process related to the log file data . Equation 1 may be revised to include conditional events as deemed necessary according to specific domain needs. For the example of the ranked unique walks through the master directed graph identified by the master directed graph decomposition module are specified in Table 2.

Since the master directed graph includes labeled events and transitions the labeled events and transitions may be used to calculate the degree to which a pair of walks has an overlap with the same events and transitions. During computations by the graph matching module utilization of an overlap metric may reduce the overall number of calculations required for performing a match. With a small amount of data or a small master directed graph the reduction in calculations may be negligible. However when analyzing large amounts of the log file data and a relatively large master directed graph the benefit becomes clear when removing those walks that have zero event and edge overlap. The graph matching module may compute a coverage metric to consider overlapping data points between the decomposed incoming walk and one of the decomposed master graph walks . When decomposed into their respective edge sets correlation of the decomposed incoming walk and one of the decomposed master graph walks may occur on the intersection of edges. Therefore as described in further detail herein the graph matching module may consider the degree of correlation coverage i.e. the correlation score or the Jaccard similarity metric of the comparing sets.

With respect to the overlap score i.e. a percentage overlap or O determined by the graph matching module given a master walk w e.g. one of the decomposed master graph walks and an incoming walk l e.g. the decomposed incoming walk the degree of overlap between and the similarity of walks wand lmay be determined by the Jaccard similarity of the edge sets. The Jaccard similarity of the edge sets may consider overlapping edges and events to produce a metric that represents the degree of coverage or overlap for the correlation. The percentage overlap function to determine the overlap score may be specified as follows 

The overlap score may characterize the existence of the same nodes and the same edges between the decomposed incoming walk and one of the decomposed master graph walks but disregard the distance between the respective probability distributions of their edge sets. For example illustrates an incoming walk through an incoming directed graph as identified by the incoming directed graph decomposition module and illustrates the corresponding decomposed incoming walk where the incoming directed graph decomposition module may decompose the incoming walk of into its probability distribution as the decomposed incoming walk of . For example walks 1 2 3 4 and 1 2 3 3 4 with their respective edge sets of 1 2 2 3 3 4 and 1 2 2 3 3 3 3 4 may have an overlap score of 0.75. This metric may consider intersection and the actual values of the corresponding edge transitions may differ. As such the distance or difference between decomposed walks may be considered as an additional metric. For the example of the overlap score for each of the pairs formed by the decomposed master graph walks e.g. see and the decomposed incoming walk e.g. see are specified in Table 3.

With respect to the difference score i.e. the distance difference or L given a master walk e.g. one of the decomposed master graph walks edge probability set and an incoming walk e.g. the decomposed incoming walk edge probability set distance difference for the edge sets for a walk pair may be specified as follows 

The distance difference for the edge sets may produce a bounded metric i.e. L representative of how much edge weights differ from one another. For Equation 3 may represent the kedge weight from a master walk edge set may represent the medge weight from an incoming walk edge set and may denote the cardinality. The kand mmay correspond to overlapping data points from the walk edge sets. For the example of the difference score for each of the pairs formed by the decomposed master graph walks e.g. see and the decomposed incoming walk e.g. see are specified in Table 4.

With respect to Equation 2 Equation 2 may disregard the start and stop nodes as these nodes are arbitrarily added. However Equation 3 includes the beginning and terminal edges as their composition in an incoming walk may affect the weight correlations. These aspects may be relevant when taking into consideration the terminal or last edge in a walk or sequence of events.

With respect to the correlation score i.e. the correlation coefficient or r the correlation score may be based on the Pearson s correlation coefficient. With respect to the correlation score for all and the correlation for the decompositions of a walk pair formed by the decomposed incoming walk and one of the decomposed master graph walks may be specified as follows 

Referring to the master directed graph may include self loops and cycles. A self loop may be defined as a node which has an edge going to itself and a cycle may be defined as a path such that the start and end nodes are the same. For example the master directed graph of may include a 2 node cycle that includes nodes 1 and 2. Since nodes 1 and 2 have edges towards each other in both directions the ordered set represented by wcannot be determined. Therefore an arbitrary start node may be added to avoid this ambiguity.

While self loops and cycles imply an infinite number of walks the graph matching module may consider up to the second iteration. This may prevent exponentially smaller probability rankings. Further the graph matching module may account for existence of the connections between states for the later decomposition of walks into their probability transitions as opposed to repetition.

The graph matching module may apply a kernel transformation function to Equations 2 and 3 to provide flexibility and refinement depending on the underlying data. The type of transformation chosen may facilitate computation if the master directed graph contains a relatively large number of nodes that may be similar and require additional differentiation. For example if the underlying distribution of the log file data is Gaussian a Gaussian kernel transformation may be applied e.g. see Equation 6 below . An application of the kernel transformations to any of the weights or metrics may provide flexibility.

With respect to the degree of fitness metric f since Equation 2 characterizes the nodes and edge presence contained in comparing walks and Equation 3 characterizes the similarity of the edge weights of the decomposed incoming walk in comparison to one of the decomposed master graph walks the degree of fitness metric of two walks may be determined by computing the following Equation 8 For Equation 8 fmay be denoted as the degree of fitness metric Omay represent the percentage overlap function to determine the overlap score and Lmay represent the difference score . For f the higher the degree of fitness metric the greater the fit of the decomposed incoming walk to one of the decomposed master graph walks . For the example of the degree of fitness metric ffor each of the pairs formed by the decomposed master graph walks e.g. see and the decomposed incoming walk e.g. see are specified in Table 7.

For two walks that have the same degree of fitness metric first the values from the degree of fitness metric set may be scaled to associate them with the appropriate percentile ranks of the comparison master walks. Secondly the graph matching module may use the maximal set of those scaled values. This results in the graph matching module favoring the more probable path. Execution of these operations may be limited to those incoming and master walk pairs e.g. pairs of the decomposed incoming walk and each one of the decomposed master graph walks that have maximal percentage overlap.

During the calculation for the probability of occurrence for the decomposed master graph walks the graph matching module may rank the decomposed master graph walks in descending order and assign a uniform distribution of equal probability mass to each rank. However other distributions of the assigned probability masses such as for example normal or Gaussian may be utilized for the probability ranking and modified to suit the need of the underlying data and desired output. To differentiate walk pairs with the same degree of fitness the graph matching module may assign a ranking coefficient Rfor a walk pair in accordance to the probability density of occurrence of the decomposed master graph walks to produce a scaled fitness metric i.e. a ranked anomaly metric set in Equation 9 . Equation 9 For Equation 9 fmay represent the degree of fitness metric from a master walk incoming walk pair and Rmay represent the ranking coefficient. Equation 9 may be used to identify the pairs formed by the decomposed incoming walk and the decomposed master graph walks with the best fitness. No two decomposed master graph walks may correspond to identical scaled fitness metrics while being in separate probability masses. For the example of the scaled fitness metric sfor each of the pairs formed by the decomposed master graph walks e.g. see and the decomposed incoming walk e.g. see are specified in Table 8.

In order to determine the probability that the decomposed incoming walk is anomalous within the context of a percentile ranking for an incoming walk land the master walk e.g. one of the decomposed master graph walks with the highest fitness metric or scaled fitness metric in case of ties w a scaled identified maximal walkpair fitness metric i.e. contextual anomalousness or fitness probability may be determined by scaling within the probability rank mass of the matched master walk using Equation 10 as follows Equation 10 For Equation 10 may represent the scaled identified maximal walkpair fitness metric within the matching master walk ranking. Further for Equation 10 Rmay represent the ranking coefficient of the maximally fitted master walk Rmay represent the coefficient of the next lowest ranking or zero if there is no lower ranking coefficient rmay represent the correlation score for a master incoming walk pair and may denote the cardinality. For the example of as discussed in further detail below the scaled identified maximal walkpair fitness metric within the matching master walk ranking may be 27.96 with a scaled fitness of 72.04 for walk pair w i.

With respect to convergence and divergence the decomposed incoming walk may converge or diverge from one of the decomposed master graph walks . Convergence and divergence may be indicative of high conformance in the case of convergence or similar structure yet differing edge weights in the case of divergence. For example while two walks have the same structure they may differ in their transition weights which is indicative of a pattern that is masking itself as another existing pattern.

With respect to the computation of Equation 10 the absolute value of the correlation coefficient may be used to prevent the sign of the correlation coefficient from skewing the result of the percentile ranking. However the sign of the correlation coefficient may be indicative of whether the decomposed incoming walk diverges from or converges to one of the decomposed master graph walks . For example respectively illustrate original and comparison converging walks with equivalent edge weights according to an example of the present disclosure. respectively illustrate original and comparison diverging walks with differing edge weights according to an example of the present disclosure. Based on the scalar value or sign the graph matching module may determine whether a walk pair is converging or diverging by computing its directionality in Equation 11 as follows 

With respect to a test for significance as more and more data points are acquired and more features are compared the importance of any correlation may grow or dwindle. In general as the number of points for the log file data increases the average of the fitness results will converge to an expected value. At smaller sample sizes shorter walks and smaller graph feature sets the fitness results may vary as opposed to larger sample sizes longer walks or larger graph feature sets when performing the graph matching by the graph matching module with the incoming and master walks e.g. the decomposed master graph walks or graphs e.g. the master directed graph . To compensate for any fluctuations that may occur a statistical method may be used for determining whether fitness between two feature sets of walk decompositions or graphs is generated by chance alone thus providing a confidence metric. Based on Pearson s correlation coefficient statistical significance may be tested for to provide a confidence metric. By constructing a sampling distribution for the correlation value and determining its standard error a determination may be made as to whether a concluded result is due to chance alone. For the example of the significance using t test and raw Pearson s value may be 0.101 for walk pair w i.

With respect to implementation of the contextual graph matching based anomaly detection system the foregoing graph similarity metrics may be used to determine anomalousness of an incoming potentially incomplete walk e.g. the decomposed incoming walk compared against the probability density distribution of all known decomposed master graph walks with respect to the most probable path of walks that reside within a comparison master graph e.g. the master directed graph .

As preprocessing at the pseudo code of may first obtain all the walks e.g. the decomposed master graph walks of the master directed graph i.e. the set of labels through a depth first search methodology. Next at the pseudo code of may compute the probability ranking i.e. Equation 1 for each master walk e.g. the decomposed master graph walks and sort the master walks in ascending order. At each master walk may be assigned into percentiles by associating a ranking coefficient Rto each master walk where each ranking has equal probability mass and the distribution is uniform. The number of master walks may determine the distribution of the ranking coefficients. In the case where more than one master walk has the same probability of occurrence such master walks may reside within the same probability mass and percentile ranking. At a decomposition of the incoming walk and master walks into their respective edge sets may be performed in order to compute the overlap distance and correlation coefficient i.e. Equation 4 . At generally the percentage overlap i.e. Equation 2 and distance difference i.e. Equation 3 metrics may be computed with each of the incoming e.g. the decomposed incoming walk and master walk pairs. The correlation of edge weights may occur on common edges that are present in both walk decompositions. As shown in data points are not inserted from one walk decomposition into another giving the inserted data points a value of zero to preserve the notion that the incoming walk may be a part of a larger walk. Furthermore inserting data points may skew the results towards divergence. Therefore Equation 4 is limited to considering those overlapping points within a data set.

At if an incoming walk does not share any edge with a master walk this results in a correlation of zero with an overlap of zero with the fitness metric being zero regardless of the distance difference value. Otherwise at the fitness value i.e. Equation 8 for an incoming walk with each of the master walks may be calculated. At the calculations of the fitness value may be limited to those sequences that have the highest overlap where the operation may be performed on the maximal overlap set of incoming walk and master walk pairs. The master walks with the highest fitness metric may be identified. At if more than one incoming walk and master walk pair have the same fitness value calculation from Equation 8 a scaled fitness value from Equation 9 may be obtained using the probability ranking coefficient for the master walk match as a multiplier. In some situations the scaled fitness calculation does not adequately differentiate one match from another and thus occurs if two master walks have the same probability of occurrence and reside within the same ranked probability mass. If such a situation arises then choosing either match is sufficient as they will calculate out to the same fitness value and have the same degree of anomalousness. At using the master walk with the highest scaled fitness at the rank of the master walk with the highest scaled fitness may be determined in the overall master walk s percentile distribution by using the best fitting master walk s ranking coefficient and the ranking coefficient of the next lowest rank from Equation 10 . At the directionality from Equation 11 may be determined between the master and incoming walk pairing. At the significance may be determined and the result of the computation may be returned at by the anomaly detection module .

According to an example for the master directed graph of a determination as to the anomalousness of the decomposed incoming walk of i.e. Start 1 2 3 3 Stop is described. Tables 10 and 11 illustrate the result of execution of the contextual graph matching based anomaly detection system which uses Equations 1 11. Specifically Table 10 illustrates the decomposed master graph walks in descending order according to their respective ranking coefficients along with overlap and kernel transformed distance metrics and Table 11 illustrates the decomposed master graph walks in descending order according to their respective ranking coefficients along with correlation fitness and scaled fitness metrics.

In order to determine the anomalousness of the decomposed incoming walk of for the master directed graph of a depth first search may be performed on the master directed graph to extract all unique possible master walks i.e. the decomposed master graph walks . As shown in this results in five master walks with w Start 6 Stop w Start 1 2 3 4 Stop w Start 1 2 3 3 4 Stop w Start 1 2 3 3 5 Stop and w Start 1 2 3 5 Stop.

For the example of the scaled fitness value may be calculated using the set of fvalues corresponding to those walk pairs which also reside in the maximal overlap set. As a result the scaled fitness metric favors the higher probability and the master walk with which an incoming walk matches. For the example of the closest master walk match is Start 1 2 3 3 4 Stop or w due to the scaled fitness metric result being the highest for that corresponding walk pair. For the example of the fitness within the probability mass ranking for wis 0.8 0.6 0.653 0.95 0.6 0.7204 with a directionality of 1 which implies convergence.

Based on the foregoing the anomaly detection module may indicate that the decomposed incoming walk of fits the master walk wof Start 1 2 3 3 4 Stop with 72.04 fitness and with respect to the overall probability density of the master directed graph of with respect to the most probable path has a 27.96 chance of being anomalous i.e. the anomaly is 27.96 . The anomaly detection module may further indicate that the decomposed incoming walk of converges with the particular master walk implying that it is following a known or detected pattern.

With respect to a time complexity by which the contextual graph matching based anomaly detection system decomposes the decomposed incoming walk and a master directed graph finds matching segments and is capable of producing scalable results the time complexity for these processes may be linear and on the order of O n . Further with respect to master directed graphs of increasing size and complexity and a plurality of the incoming walks evaluated against such master directed graphs the time complexity for these processes for evaluating multiple incoming walks evaluated against such master directed graphs may be on the order of O n .

Referring to at block the method may include evaluating computer generated log file data to create in a computer memory a master directed graph that specifies known events and transitions between the known events.

At block the method may include processing the master directed graph to identify a plurality of unique walks through the master directed graph and to decompose the plurality of unique walks into their probability distributions as a plurality of decomposed master graph walks .

At block the method may include evaluating incoming computer generated log file data to create an incoming directed graph that specifies unknown events and transitions between the unknown events.

At block the method may include processing the incoming directed graph to identify an incoming walk through the incoming directed graph and to decompose the incoming walk into its probability distribution as a decomposed incoming walk .

At block the method may include determining an overlap score i.e. Equation 2 for each walk pair of a plurality of walk pairs including each of the plurality of decomposed master graph walks and the decomposed incoming walk by evaluating an intersection and a union of an edge set of one of the plurality of decomposed master graph walks and an edge set of the decomposed incoming walk .

At block the method may include determining a distance difference score i.e. Equation 3 for each walk pair of the plurality of walk pairs for example by evaluating an edge weight from an edge set of one of the plurality of decomposed master graph walks and an edge weight from an edge set of the decomposed incoming walk .

At block the method may include determining a correlation score i.e. Equation 4 for each walk pair of the plurality of walk pairs for example by evaluating an edge belonging to an edge set of one of the plurality of decomposed master graph walks and an edge belonging to an edge set of the decomposed incoming walk .

At block the method may include selecting i.e. by the anomaly detection module one of the plurality of decomposed master graph walks based on the overlap score the difference score and the correlation score to detect an anomaly based on the selected one of the plurality of decomposed master graph walks .

According to an example the method may include ranking the plurality of unique walks through the master directed graph according to a probability of occurrence i.e. Equation 1 . The probability of occurrence may be based on an edge set of one of the plurality of decomposed master graph walks and adjacent nodes within the master directed graph .

According to an example the method may include evaluating a scaled fitness metric i.e. Equation 9 related to each walk pair of the plurality of walk pairs for selecting the one of the plurality of decomposed master graph walks . The scaled fitness metric may be based on a ranking coefficient Rrelated to the rank of the plurality of unique walks through the master directed graph and a degree of fitness metric frelated to each walk pair of the plurality of walk pairs.

According to an example the method may include determining a maximal anomaly metric e.g. see Table 9 from scaled fitness metrics related to each walk pair of the plurality of walk pairs for selecting the one of the plurality of decomposed master graph walks . A scaled fitness metric i.e. Equation 9 of the scaled fitness metrics is based on a ranking coefficient Rrelated to the rank of the plurality of unique walks through the master directed graph and a degree of fitness metric frelated to each walk pair of the plurality of walk pairs.

According to an example the method may include evaluating a scaled identified maximal walkpair fitness metric i.e. Equation 10 for each walk pair of the plurality of walk pairs for selecting the one of the plurality of decomposed master graph walks . The scaled identified maximal walkpair fitness metric may be based on a ranking coefficient related to the rank of the plurality of unique walks through the master directed graph a degree of fitness metric frelated to each walk pair of the plurality of walk pairs and the correlation score i.e. Equation 4 . The scaled identified maximal walkpair fitness metric may provide a percentage anomalousness of the decomposed incoming walk .

According to an example the method may include evaluating a kernel transformation function i.e. Equation 7 related to each walk pair of the plurality of walk pairs for selecting the one of the plurality of decomposed master graph walks .

According to an example the method may include evaluating a degree of fitness metric ffor each walk pair of the plurality of walk pairs for selecting the one of the plurality of decomposed master graph walks . The degree of fitness metric may be based on the kernel transformation function i.e. Equation 7 the overlap score and the distance difference score .

According to an example the method may include evaluating a directionality i.e. Equation 11 for each walk pair of the plurality of walk pairs for selecting the one of the plurality of decomposed master graph walks .

The computer system may include a processor that may implement or execute machine readable instructions performing some or all of the methods functions and other processes described herein. Commands and data from the processor may be communicated over a communication bus . The computer system may also include a main memory such as a random access memory RAM where the machine readable instructions and data for the processor may reside during runtime and a secondary data storage which may be non volatile and stores machine readable instructions and data. The memory and data storage are examples of computer readable mediums. The memory may include a contextual graph matching based anomaly detection module including machine readable instructions residing in the memory during runtime and executed by the processor . The contextual graph matching based anomaly detection module may include the modules of the system shown in .

The computer system may include an I O device such as a keyboard a mouse a display etc. The computer system may include a network interface for connecting to a network. Other known electronic components may be added or substituted in the computer system.

What has been described and illustrated herein is an example along with some of its variations. The terms descriptions and figures used herein are set forth by way of illustration only and are not meant as limitations. Many variations are possible within the spirit and scope of the subject matter which is intended to be defined by the following claims and their equivalents in which all terms are meant in their broadest reasonable sense unless otherwise indicated.

