---

title: Method and apparatus for use in a downloadable conditional access system
abstract: In a downloadable conditional access system (DCAS), preferably all DCAS-specific code is implemented in a configurable secure (CS) processor that is in communication with the host processor. Preferably, no DCAS-specific code is executed in the host processor. The host processor delivers commands to the CS processor, which the CS processor performs to configure itself in accordance with the particular DCAS encryption scheme used by the DCAS. Once configured, the CS processor executes a DCAS software module that has been downloaded to the CS processor, which looks for the corresponding EMMs and ECMs, processes them to obtain the CW, and then uses the CW to decrypt the content stream.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09031235&OS=09031235&RS=09031235
owner: ARRIS Technology, Inc.
number: 09031235
owner_city: Suwanee
owner_country: US
publication_date: 20140411
---
This application is a continuation of U.S. patent application Ser. No. 11 764 292 filed on Jun. 18 2007 entitled METHOD AND APPARUTUS FOR USE IN A DOWNLOADABLE CONDITIONAL ACCESS SYSTEM the contents of both which is incorporated herein by reference in its entirety.

The invention relates to conditional access CA systems for controlling access to content distributed in cable or satellite television networks. More particularly the invention relates to enabling different types of CA systems to be used by a set top box STB without having to implement CA system specific code in the host processor of the STB.

Control of access to content has become a vital aspect of many business models in the digital television broadcasting industry. Various conditional access CA systems are or have been used in the industry to control or limit access to digital television services such as for example pay per view programming services premium channel e.g. HBO programming services and video on demand programming services. CA systems prevent subscribers from accessing services unless certain conditions are met e.g. the subscriber has entered into an agreement to pay for a service .

CA systems encrypt digital content streams so that the streams can only be accessed by equipment at the subscriber s premises that has the proper hardware and or software configuration for decrypting the digital content stream. Therefore the CA system can be viewed as having a first portion external to the subscriber premises somewhere in the network that encrypts the digital content stream and a second portion located at the subscriber s premises which decrypts the digital content stream to enable the subscriber to acquire the service. The second portion is typically located in a STB at the subscriber s premises but may also be incorporated into a Cablecard or Smartcard that interfaces with a digital cable ready television or other device.

In the United States the first and second portions of a particular CA system have traditionally been specific to a particular manufacturer. The digital content stream is encrypted in accordance with a particular manufacturer s CA system encrypting scheme and that encryption scheme is proprietary and not available to the public. Therefore the decrypting hardware and or software configuration in the STB needs to be specifically designed or configured to decrypt the digital content stream. Consequently if a particular manufacturer s CA system is used at the headend the STB is typically provided by the same manufacturer. In Europe a single encryption scheme called the Common Scrambling Algorithm CSA is used to encrypt the content stream. The CSA technology is available for license by manufacturers of subscriber premises equipment.

Recently downloadable CA systems DCASs have been proposed that will enable STBs to be used with different CA systems provided the STBs employ standard DCAS capability. DCAS technology eliminates the need to implement a particular CA system specific hardware architecture in the STB or in a cable card at the subscriber s premises in order to decrypt the encrypted content stream. Instead a CA system software module is securely downloaded from the network to the subscriber s STB. The downloaded software module is executed by a programmable secure processor within the STB to enable the STB to decrypt the digital content stream to enable the user to access the content.

The CA system software module executed by the host processor controls sending and receiving of messages and commands to and from the secure processor and to and from a transport processor . The CA system software module executed by the secure processor responds to messages from the host processor . Commands received by the transport processor from the host processor are performed by the transport processor to cause the transport processor to configure itself to look for particular Entitlement Control Messages ECMs and Entitlement Management Messages EMMs that are transported either as part of the encrypted content stream or in logically related data streams. The ECM contains access criteria and a CAS encrypted content decryption key called a control word CW . The EMM is an encrypted message that contains private conditional access information about the authority a subscriber has to acquire content.

When the transport processor locates the EMM and ECM it forwards these messages to the host processor . The host processor forwards the ECM and EMM to the secure processor which is executing the downloaded CA system software module. The secure processor checks the EMM to determine whether the subscriber is authorized to access the content. If so the secure processor decrypts the ECM and obtains the CW which is then sent to the host processor . The host processor sends the CW to the transport processor which it uses to decrypt the content stream. If the EMM does not indicate that the subscriber has authorization to access the content the encrypted content stream will not be decrypted.

One of the disadvantages of the DCAS technology described above is that the host processor must be configured to execute some portion of the DCAS kernel. Different STBs use different types of host processors. Therefore a DCAS kernel designer is faced with potentially having to design a different DCAS kernel for each different type of host processor which increases the amount of work and the costs associated with implementing a given DCAS. Another disadvantage of the DCAS technology described above is that it allows CA system specific code to reside in the unsecure host processor . This increases the observability of certain aspects of the CA system and could potentially lead to the disclosure of security vulnerabilities that may be exploited by individuals who are attempting to break the CA system to gain unauthorized access. Another disadvantage of the DCAS technology described above is that because specific code must reside on the host processor the code cannot be written only once but must be ported for each instance of the host processor and operating system that will be encountered in the field.

In addition the control word CW is transmitted from the secure processor to the unsecure host processor and then to the transport processor . While in most instances the control word is transmitted in an encrypted form this code words is still accessible in this state to pirates and hackers. Thus it is possible that one could obtain the CW and potentially decrypt it and obtain the content inappropriately.

Accordingly a need exists for a downloadable CA system that does not require that the host processor execute CA system specific code or functionality and that is not vulnerable to security risks.

The invention provides a method and an apparatus for use in a downloadable conditional access system DCAS . The apparatus comprises a host processor and a configurable secure CS processor. The CS processor is configured to receive DCAS commands and stream processing commands from the host processor and to configure itself in accordance with the received commands. Once configured the CS processor executes a DCAS software module that has been downloaded to the CS processor which parses and decrypts the encrypted content stream.

In accordance with the method a first downloaded conditional access system DCAS software module is received in a configurable secure CS processor. A first set of DCAS commands and stream processing commands is received in the CS processor which are sent to the CS processor by the host processor. The CS processor configures itself in accordance with the CAS commands and stream processing commands. An encrypted content stream is received in the CS processor. The DCAS software module in the CS processor is executed which parses and decrypts the encrypted content stream.

The invention also provides a computer program for use in a DCAS. The program comprises instructions for receiving a first DCAS software module in a configurable secure CS processor instructions for receiving a first set of DCAS commands and stream processing commands in the CS processor sent by a host processor that cause the CS processor to configure itself instructions for receiving an encrypted content stream in the CS processor and instructions for executing the DCAS software module in the CS processor. When the CS processor executes the DCAS software module the CS processor parses and decrypts the encrypted content stream.

These and other features and advantages of the invention will become apparent from the following description drawings and claims.

In accordance with the preferred embodiment the host processor does not execute any DCAS specific code. Rather all DCAS specific code is implemented in a configurable secure CS processor that is in communication with the host processor. The host processor delivers commands to the CS processor which the CS processor performs to configure itself. The CS processor then executes a downloaded DCAS software module that looks for the corresponding EMMs and ECMs processes them to obtain the CW and then uses the CW to decrypt the content stream.

Because no DCAS specific code is implemented in the host processor the host processor is not vulnerable to security risks. In addition because it is not necessary for a DCAS kernel to be executed by the host processor different DCAS kernels do not have to be designed for different host processors. Consequently the amount of work and costs associated with implementing a given DCAS are reduced. Another benefit of the invention is that different DCASs can be implemented by simply reconfiguring the configurable CS processor in accordance with the new DCAS and downloading a new DCAS software module to the reconfigured CS processor.

The STB sends a request to download a DCAS software module to the DCAS downloading facility which may be the same as the DCAS downloading facility shown in . In response to this request the DCAS downloading facility transmits a DCAS software module to the STB which is downloaded into the CS processor of the invention. The host processor sends generic CAS commands and stream processing commands to the reconfigurable client processor which instruct the CS processor to configure itself to look for the EMMs and ECMs based on the DCAS and of the manner in which the encrypted content stream is to be processed.

Some exemplary generic CAS commands would include for example the following with their respective data returned from the CS processor CSP function to the host processor function making the API request.

A second exemplary command extract services would be used by the host processor to obtain a listing of services available to the CSP. In the case of MPEG data streams the service list would be represented by the presence of the Program Association Table PAT . After returning the service list to the host processor a consumer could make a selection from the list thus causing the host processor to communicate an acquire service message to the CSP. It is envisioned that the exemplary acquire service message would result in decryption of the encrypted content stream if the downloaded CAS client were authorized for the selected service. In cases where the client were not authorized the service status would return an appropriate error status.

Once configured the CS processor detects the corresponding EMM and ECM and analyzes the EMM to determine whether the subscriber is authorized to access the content. If the EMM indicates that the subscriber is authorized the CS processor decrypts the ECM and obtains the CW. The CS processor then uses the CW to decrypt the encrypted content stream. If the EMM does not indicate that the subscriber has authorization to access the content the encrypted content stream will not be decrypted.

It should be noted that unlike the known proposed DCAS system shown in in which the CWs are transmitted between the host processor IC and the transport processor IC and thus subject to being accessed by a hacker and used to obtain unauthorized access to restricted content the CWs are never transmitted outside of the CS processor . This makes it extremely difficult or impossible for a hacker to obtain access to the CWs and therefore makes the DCAS more secure and less vulnerable to attacks.

Likewise the host processor may be any device capable of performing the functions described herein with reference to the host processor including for example a microprocessor a microcontroller a field programmable gate array FPGA a programmable logic array etc. Also the host processor may be implemented in hardware software firmware or a combination of hardware software and or firmware. The host processor is typically a microprocessor. In addition it is not necessary for the host processor and the CS processor to be separate ICs. Rather the functionality performed by both processors and may be implemented in a single IC such as for example in a system on a chip SOC IC.

The CS processor typically includes an input output I O interface for communicating with the host processor a memory element for storing the downloaded DCAS software module and data a stream parsing component for parsing the encrypted content stream to locate the ECMs and EMMs and a decrypting component for decrypting the encrypted content stream.

The host processor and the CS processor are typically mounted on a printed circuit board PCB or the like and are in communication with each other via a PCB bus . The I O interface of the CS processor receives the CAS and stream processing commands sent over the bus from the host processor . Some of the commands are used by the CS processor to configure the stream parsing component . Some of the commands are used by the CS processor to configure the decrypting component . Commands and data are typically stored in memory element . The memory element also stores the downloaded DCAS software module which is typically received by the host processor from the DCAS downloading facility and communicated to the CS processor .

The stream parsing component executes code of the DCAS software module that enables it to parse the encrypted content stream to locate the EMMs and ECMs check the EMM to determine whether the subscriber is authorized to access the corresponding content and extract the CW from the ECM in cases where the EMM indicates that the subscriber is authorized to access the content. The extracted CW is sent to the decrypting component which uses the CW to decrypt the encrypted content stream and then outputs the decrypted content stream.

As stated above the CS processor is capable of being reconfigured if a new or different DCAS is to be used. To reconfigure the CS processor the host processor downloads the DCAS software module and forwards it to the CS processor which stores it in memory element . The host processor then sends commands that are specific to the DCAS to the CS processor which it uses to reconfigure the stream parsing and decrypting components and respectively. It should be noted that the CS processor may have multiple DCAS software modules corresponding to different DCASs stored in memory element . The host processor is capable of configuring the CS processor to execute any one of these DCAS software modules based on the encryption scheme being used at the headend.

For example if certain cable television headend signals are protected by two conditional access systems DCAS and DCAS and if a customer desires to tune between the services protected by DCAS and DCAS then the host processor will configure the CS processor to use the appropriate DCAS for each respective service and switch back and forth as required to respond to tuning requests by the customer. Furthermore if a customer wishes to view or record services protected by DCAS and DCAS simultaneously such as for the purpose of watching a service protected by DCAS while at the same time recording a service protected by DCAS then the host processor will configure the CS processor to simultaneously process services protected by DCAS and DCAS.

It should also be noted that the CS processor may be programmed with additional digital rights management DRM capabilities to enable it to support distribution tasks external to the device in which content is initially consumed.

The host processor executes an application programming interface API software program for communicating with the CS processor . This API analyzes the downloaded DCAS to determine how the CS processor needs to be configured to perform the stream parsing and decrypting operations. The API executed by the host processor preferably uses a command set that is generic to all available DCASs which enables the CS processor to be configured to perform the stream parsing and decrypting operations necessary for any DCAS. In addition the host processor is freed from having to perform any DCAS specific functions which reduces or eliminates security risks and eliminates the need to port a DCAS kernel into the host processor .

It should be noted that the invention has been described with reference to particular examples and that the invention is not limited to the examples described herein. For example although the CS processor has been described with reference to as being a single IC it may instead be made up of a combination of ICs or other devices that operate in conjunction with each other to perform the aforementioned operations. Those skilled in the art will understand that modifications may be made to the examples described above and that all such modifications are within the scope of the invention.

The process shown in may be implemented in a general multi purpose or single purpose secure processor. Such a processor will execute instructions either at the assembly compiled or machine level to perform that process. Those instructions can be written by one of ordinary skill in the art following the description of and stored or transmitted on a computer readable medium. The instructions may also be created using source code or any other known computer aided design tool. A computer readable medium may be any medium capable of carrying those instructions and include a CD ROM DVD magnetic or other optical disc tape silicon memory e.g. removable non removable volatile or non volatile packetized or non packetized wireline or wireless transmission signals.

