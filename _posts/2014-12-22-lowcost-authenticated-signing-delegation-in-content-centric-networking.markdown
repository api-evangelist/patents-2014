---

title: Low-cost authenticated signing delegation in content centric networking
abstract: One embodiment provides a system that delegates signature production in a CCN. During operation, a first content producing device monitors content objects created by a second content producing device. A content object can be identified by a name that is a hierarchically structured variable length identifier (HSVLI) which comprises contiguous name components ordered from a most general level to a most specific level. The first device retrieves the content objects and authenticates a message authentication code for each content object based on a key shared by the first and second device. The first device creates a manifest with a name and a content object hash value for each content object, produces a digital signature for the manifest based on a private key of the first device, and includes the digital signature in the manifest, thereby delegating signature production to the first device for content objects created by the second device.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09473475&OS=09473475&RS=09473475
owner: PALO ALTO RESEARCH CENTER INCORPORATED
number: 09473475
owner_city: Palo Alto
owner_country: US
publication_date: 20141222
---
This invention was made with U.S. Government support under Contract No. CNS 1040822 awarded by the National Science Foundation NSF Future Internet Architectures FIA program Named Data Networking NDN project. The U.S. Government has certain rights in this invention.

The subject matter of this application is related to the subject matter in the following applications 

This disclosure is generally related to distribution of digital content. More specifically this disclosure is related to delegating the signing of content from devices with limited resources to computationally powerful devices based on manifests and message authentication codes.

The proliferation of the Internet and e commerce continues to create a vast amount of digital content. Content centric network CCN architectures have been designed to facilitate accessing and processing such digital content. A CCN includes entities or devices such as network clients forwarders e.g. routers and content producers which communicate with each other by sending interest packets for various content items and receiving content object packets in return. CCN interests and content objects can be identified by their unique names which are typically hierarchically structured variable length identifiers HSVLI . An HSVLI can include contiguous name components ordered from a most general level to a most specific level. Each CCN content object can be cryptographically signed by its producer or publisher e.g. by creating an electronic signature based on asymmetric or public key cryptography. A requesting client can verify the digital signature of received content to ensure integrity original authentication and correctness. However producing a digital signature can be computationally expensive. Some devices e.g. Internet of Things IoT or sensor network applications may lack the resources to produce a digital signature due to limited memory computation power or energy supply.

One embodiment provides a system that delegates signature production in a CCN. During operation the system monitors by a first content producing device one or more content objects published by a second content producing device wherein a content object is identified by a name that is a hierarchically structured variable length identifier HSVLI which comprises contiguous name components ordered from a most general level to a most specific level. The first device retrieves the one or more content objects. In response to determining that the retrieved content objects indicate a message authentication code the first device authenticates the message authentication code for the retrieved content objects based on a key shared by the first and the second device. The first device creates a manifest that indicates a name for the manifest and a content object hash COH value for each of the retrieved content objects. The first device produces a digital signature for the manifest based on a private key of the first device and includes the digital signature in the manifest thereby facilitating delegation of signature production to the first content producing device for content objects published by the second content producing device.

In some embodiments in response to determining that the retrieved content objects do not indicate a message authentication code the first device authenticates the retrieved content objects based on one or more of a physical location of the first content producing device and the second content producing device and a network topology.

In some embodiments the first device retrieves the one or more content objects based on one or more of a name associated with each of the one or more content objects and a content object hash COH value for each of the one or more content objects.

In another variation on these embodiments during operation the system can generate by a second content producing device one or more content objects that indicate a message authentication code that is based on a key shared by the second content producing device and a first content producing device wherein a content object is identified by a name is a hierarchically structured variable length identifier HSVLI which comprises contiguous name components ordered from a most general level to a most specific level. The system delegates to the first content producing device a production of a digital signature for the one or more content objects.

In some embodiments each of the one or more content objects generated by the second content producing device indicates a name.

In some embodiments the system delegates the production of a digital signature to the first content producing device by authenticating by the first content producing device the MAC for the one or more content objects based on the shared key creating a manifest that indicates the one or more content objects and a COH value for each of the one or more content objects producing a digital signature for the manifest based on a private key of the first content producing device and including the digital signature in the manifest.

In some embodiments the one or more content objects further indicate a name for a manifest to be created by the first content producing device.

In some embodiments the manifest created by the first content producing device indicates the one or more content objects and a content object hash COH value for each of the one or more content objects.

The following description is presented to enable any person skilled in the art to make and use the embodiments and is provided in the context of a particular application and its requirements. Various modifications to the disclosed embodiments will be readily apparent to those skilled in the art and the general principles defined herein may be applied to other embodiments and applications without departing from the spirit and scope of the present disclosure. Thus the present invention is not limited to the embodiments shown but is to be accorded the widest scope consistent with the principles and features disclosed herein.

Embodiments of the present invention provide a system that solves the problem of authenticating content created by a device with limited resources by delegating digital signature production for the content to a more computationally powerful device. In CCN content can be digitally signed by a producer of the content so that an entity receiving the content e.g. a requesting client application can authenticate the content by verifying the digital signature. Digital signature production typically based on public key or asymmetric cryptography can be computationally expensive. As a result some devices may not have the resources to digitally sign their produced content. For example a sensor device in a bridge for detecting structural conditions or an Internet of Things IoT device like a Fitbit or a SmartWatch can produce content that another entity on the network wishes to retrieve. However these sensors and IoT devices may be limited in storage capacity computation power and battery supply which may further restrict the ability of these simple devices to digitally sign their content.

The present system allows a simple device e.g. a content producer with limited resources to delegate signature production to a more computationally powerful device e.g. a content publisher . The simple device and the content publisher share a secret key which is distributed based on a key exchange protocol e.g. symmetric cryptography . The simple device creates content objects and using the shared secret key includes a hash based message authentication code HMAC for each content object. The HMAC can be calculated by applying a cryptographic hash function in combination with the shared secret key to a content object. The publisher can verify the integrity and authentication of the content by calculating an HMAC based on the same cryptographic hash function and the shared key and comparing the calculated HMAC to the included HMAC. The publisher can then create a manifest which indicates all of the authenticated content objects digitally sign the manifest and publish the manifest over a CCN. Signing and verifying aggregates of content objects through the use of a secure content catalog e.g. a manifest is described in U.S. patent application Ser. No. 14 231 515 herein incorporated by reference. Hence by using HMACs and manifests the need for a simple content producing device to authenticate its content is obviated by the delegation of signature production to a content publisher.

In examples described in this disclosure each piece of content can be individually named and each piece of data can be bound to a unique name that distinguishes the data from any other piece of data such as other versions of the same data or data from other sources. This unique name allows a network device to request the data by disseminating a request or an Interest that indicates the unique name and can obtain the data independent from the data s storage location network location application and means of transportation. The following terms are used to describe the CCN architecture 

A single piece of named data which is bound to a unique name. Content Objects are persistent which means that a Content Object can move around within a computing device or across different computing devices but does not change. If any component of the Content Object changes the entity that made the change creates a new Content Object that includes the updated content and binds the new Content Object to a new unique name.

A name in a CCN is typically location independent and uniquely identifies a Content Object. A data forwarding device can use the name or name prefix to forward a packet toward a network node that generates or stores the Content Object regardless of a network address or physical location for the Content Object. In some embodiments the name may be a hierarchically structured variable length identifier HSVLI . The HSVLI can be divided into several hierarchical components which can be structured in various ways. For example the individual name components parc home ccn and test.txt can be structured in a left oriented prefix major fashion to form the name parc home ccn test.txt. Thus the name parc home ccn can be a parent or prefix of parc home ccn test.txt. Additional components can be used to distinguish between different versions of the content item such as a collaborative document. In some embodiments the name can include a non hierarchical identifier such as a hash value that is derived from the Content Object s data e.g. a checksum value and or from elements of the Content Object s name. A description of a hash based name is described in U.S. patent application Ser. No. 13 847 814. A name can also be a flat label. Hereinafter name is used to refer to any name for a piece of data in a name data network such as a hierarchical name or name prefix a flat name a fixed length name an arbitrary length name or a label e.g. a Multiprotocol Label Switching MPLS label .

A packet that indicates a request for a piece of data and includes a name or a name prefix for the piece of data. A data consumer can disseminate a request or Interest across an information centric network which CCN routers can propagate toward a storage device e.g. a cache server or a data producer that can provide the requested data to satisfy the request or Interest.

The methods disclosed herein are not limited to CCN networks and are applicable to other architectures as well. A description of a CCN architecture is described in U.S. patent application Ser. No. 12 338 175.

Content producer can produce content objects that include a name a payload and a hash message authentication code HMAC . Content producer can be a simple device with limited resources e.g. a sensor that lacks the resources to generate a digital signature for the content that it produces. Rather than digitally sign content objects content producer can create an HMAC for content objects e.g. each of content objects . . based on a hash function and the secret key shared with content publisher . Content producer can include the HMAC as part of content objects .

Content publisher can monitor content objects via network . Content publisher can verify the integrity and authenticity of content objects by calculating an HMAC for each content object based on the hash function and the secret key and subsequently comparing the calculated HMAC to the included HMAC. Upon verifying the content based on the HMAC content publisher can create a manifest with a name . Manifest can indicate each of content objects . .by their name and content object hash COH value. Content publisher can produce a digital signature for manifest and include signature in manifest . Thus the system allows an entity that wishes to obtain content objects e.g. content consumer to retrieve an authenticated verified manifest e.g. manifest which is digitally signed by content publisher and which contains content objects that have been authenticated based on an HMAC and the shared key without requiring simple content producing device to create its own digital signature.

Content processing system can include instructions which when executed by computer and communication system can cause computer and communication system to perform methods and or processes described in this disclosure. Specifically content processing system may include instructions for monitoring content objects monitoring mechanism . Content processing system can also include instructions for retrieving content objects and making content objects available in a CCN communication mechanism . Content processing system can further include instructions for determining whether the content objects contain a message authentication code and subsequently authenticating the content objects based on the message authentication code or a physical topology authentication mechanism .

In addition content processing system can create a manifest indicates the content objects and their corresponding content object hash COH values manifest creation mechanism . Content processing system can also include instructions for producing a digital signature for the manifest based on a private key of the producer of the catalog signature production mechanism . Content processing system can include instructions for verifying a digital signature for a secure content catalog based on a public key of the producer of the catalog signature verification mechanism .

Furthermore content processing system can include instructions for generating content objects that indicate a message authentication code based on a shared key content creation mechanism . Content processing system can include instructions for delegating signature production to a content publishing device signature production mechanism .

Data can include any data that is required as input or that is generated as output by the methods and or processes described in this disclosure. Specifically data can store at least a content object with a payload a name for a content object that is a hierarchically structured variable length identifier HSVLI which comprises contiguous name components ordered from a most general level to a most specific level a message authentication code a hash based message authentication code based on a hash function and a secret key a manifest that indicates a set of content objects content object hash COH values information regarding a network topology or location of a device a manifest name a digital signature of a content publisher and a set of content objects indicated by their name or COH.

The data structures and code described in this detailed description are typically stored on a computer readable storage medium which may be any device or medium that can store code and or data for use by a computer system. The computer readable storage medium includes but is not limited to volatile memory non volatile memory magnetic and optical storage devices such as disk drives magnetic tape CDs compact discs DVDs digital versatile discs or digital video discs or other media capable of storing computer readable media now known or later developed.

The methods and processes described in the detailed description section can be embodied as code and or data which can be stored in a computer readable storage medium as described above. When a computer system reads and executes the code and or data stored on the computer readable storage medium the computer system performs the methods and processes embodied as data structures and code and stored within the computer readable storage medium.

Furthermore the methods and processes described above can be included in hardware modules or apparatus. The hardware modules or apparatus can include but are not limited to application specific integrated circuit ASIC chips field programmable gate arrays FPGAs dedicated or shared processors that execute a particular software module or a piece of code at a particular time and other programmable logic devices now known or later developed. When the hardware modules or apparatus are activated they perform the methods and processes included within them.

The foregoing descriptions of embodiments of the present invention have been presented for purposes of illustration and description only. They are not intended to be exhaustive or to limit the present invention to the forms disclosed. Accordingly many modifications and variations will be apparent to practitioners skilled in the art. Additionally the above disclosure is not intended to limit the present invention. The scope of the present invention is defined by the appended claims.

