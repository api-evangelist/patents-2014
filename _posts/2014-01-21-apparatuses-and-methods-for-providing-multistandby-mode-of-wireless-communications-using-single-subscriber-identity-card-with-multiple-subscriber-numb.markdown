---

title: Apparatuses and methods for providing multi-standby mode of wireless communications using single subscriber identity card with multiple subscriber numbers
abstract: A communication device is provided with a processing unit. The processing unit determines whether at least one elementary file in a single subscriber identity card is required to be read out. If so, the processing unit activates one subscriber identity module instance in the subscriber identity card for the elementary file, and reads the elementary file from the subscriber identity card.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08954114&OS=08954114&RS=08954114
owner: MediaTek Inc
number: 08954114
owner_city: Hsin-Chu
owner_country: TW
publication_date: 20140121
---
This application is a divisional application of pending U.S. patent application Ser. No. 13 182 313 filed Jul. 13 2011 and entitled APPARATUSES AND METHODS FOR PROVIDING MULTI STANDBY MODE OF WIRELESS COMMUNICATIONS USING SINGLE SUBSCRIBER IDENTITY CARD WITH MULTIPLE SUBSCRIBER NUMBERS the entirety of which are incorporated by reference herein.

The invention generally relates to management of multiple subscriber numbers in a single subscriber identity card and more particularly to apparatuses and methods for providing a multi standby mode of wireless communications using a single subscriber identity card with multiple subscriber numbers.

With growing demand for ubiquitous computing and networking various wireless communication technologies have been developed such as the Global System for Mobile communications GSM technology General Packet Radio Service GPRS technology Enhanced Data rates for Global Evolution EDGE technology Wideband Code Division Multiple Access WCDMA technology Code Division Multiple Access 2000 CDMA 2000 technology Time Division Synchronous Code Division Multiple Access TD SCDMA technology Worldwide Interoperability for Microwave Access WiMAX technology Long Term Evolution LTE technology Time Division LTE TD LTE technology and others. Generally a cellular phone only supports one wireless communication technology and provides the user the flexibility of mobile communications at all times via the supported wireless communication technology regardless of his her geographic location. Especially in today s business world a cellular phone is becoming a necessary business tool for conducting business conveniently. For business people having an additional cellular phone exclusive for business matters is a common choice since they need to conduct business while out of the office or even out of the city country. Others may find having an additional cellular phone is a good way to save control the budget for wireless service charges including phone services and or data services . However having two or more than two cellular phones may be troublesome when one has to switch frequently between the cellular phones and carry around all the cellular phones with himself herself.

In order to provide a convenient way of having multiple subscriber numbers dual card cellular phones have been developed which generally have two wireless communication modules for respectively performing wireless transmission and reception with an individual subscriber number. Alternatively the design of a single subscriber identity card having a plurality of subscriber numbers has also been developed for a single card cellular phones to retrieve the subscriber numbers in the single subscriber identity card and to be able to perform the wireless transmission and reception using different subscriber numbers. Note that a single card cellular phone which supports a single subscriber identity card having a plurality of subscriber numbers may only activate one subscriber number at a time via the Subscriber Identity Module SIM Application Toolkit SAT . That is only a single standby mode of wireless communications may be provided in the single card cellular phone with the activated subscriber number. If the user decides to use wireless services with another subscriber number he she may have to manually switch the activated subscriber number to the desired one via the SAT. As a result Mobile Terminated MT calls associated with the inactivated subscriber numbers will be missed and inconveniences may occur.

Accordingly embodiments of the invention provide apparatuses and methods for providing a multi standby mode of wireless communications using a single subscriber identity card with multiple subscriber numbers. In one aspect of the invention a communication device comprising a processing unit is provided. The processing unit reads a plurality of elementary files from a single subscriber identity card for each of a plurality of subscriber numbers when power on and registers to a network for each of the subscriber numbers according to the read elementary files. Also the processing unit enables a multi standby mode of wireless communications in response to successful registration to the network for at least two of the subscriber numbers.

In another aspect of the invention a method for providing a multi standby mode executed by a micro processing unit MPU of a Baseband chip is provided. The method comprises the steps of reading a plurality of elementary files from a single subscriber identity card for each of a plurality of subscriber numbers when power on registering to a network for each of the subscriber numbers according to the read elementary files and enabling a multi standby mode of wireless communications in response to successful registration to the network for at least two of the subscriber numbers.

In one aspect of the invention a communication device comprising a processing unit is provided. The processing unit enables a multi standby mode of wireless communications with a single subscriber identity card comprising a plurality of subscriber numbers and polls a plurality of SIM instances in the subscriber identity card respectively corresponding to the subscriber numbers. Also the processing unit determines whether there is any command waiting to be processed for each of the polled SIM instances and if so processes at least one determined command from the polled SIM instances.

In another aspect of the invention a method for polling a single subscriber identity card comprising a plurality of subscriber numbers executed by an MPU of a Baseband chip is provided. The method comprises the steps of enabling a multi standby mode of wireless communications with a subscriber identity card comprising a plurality of subscriber numbers polling a plurality of SIM instances in the subscriber identity card respectively corresponding to the subscriber numbers determining whether there is any command waiting to be processed corresponding to each of the polled SIM instances and if so processing at least one determined command from the polled SIM instances.

In one aspect of the invention a communication device comprising a processing unit is provided. The processing unit enables a connected mode of wireless communications with one of a plurality of subscriber numbers in a single subscriber identity card and polls a plurality of SIM instances in the subscriber identity card respectively corresponding to the subscriber numbers. Also the processing unit determines whether the subscriber identity card remains detected and whether there is any command waiting to be processed for each of the polled SIM instances and if so processes at least one determined command from the polled SIM instances.

In another aspect of the invention a method for polling a single subscriber identity card executed by an MPU of a Baseband chip is provided. The method comprises the steps of enabling a connected mode of wireless communications with one of a plurality of subscriber numbers polling a plurality of SIM instances in the subscriber identity card respectively corresponding to the subscriber numbers determining whether the subscriber identity card remains detected and whether there is any command waiting to be processed for each of the polled SIM instances and if so processing at least one determined command from the polled SIM instances.

In one aspect of the invention a communication device comprising a processing unit is provided. The processing unit determines whether at least one elementary file in a single subscriber identity card is required to be read out. If so the processing unit further activates one SIM instance in the subscriber identity card for the elementary file and reads the elementary file from the subscriber identity card.

In another aspect of the invention a method for accessing data in a single subscriber identity card executed by an MPU of a Baseband chip is provided. The method comprises the steps of determining whether at least one elementary file in the subscriber identity card is required to be read out and if so activating one SIM instance in the subscriber identity card for the elementary file and reading the elementary file from the subscriber identity card.

Other aspects and features of the present invention will become apparent to those with ordinarily skill in the art upon review of the following descriptions of specific embodiments of the apparatus and methods for providing a multi standby mode of wireless communications using a single subscriber identity card with multiple subscriber numbers.

The following description is of the best contemplated mode of carrying out the invention. This description is made for the purpose of illustrating the general principles of the invention and should not be taken in a limiting sense. It should be understood that the embodiments may be realized in software hardware firmware or any combination thereof.

A Subscriber Identity Module SIM card typically contains user account information an International Mobile Subscriber Identity IMSI and a set of SIM Application Toolkit SAT commands and provides storage space for phone book contacts. A Micro Controlling Unit MCU or Micro Processing Unit MPU of the Baseband chip referred to as a Baseband MPU hereinafter may interact with a MPU of a SIM card referred to as a SIM MPU hereinafter to fetch data or SAT commands from the plugged in SIM card. A communication device is immediately programmed after plugging in the SIM card. SIM cards may also be programmed to display custom menus for personalized services.

A Universal SIM USIM card is plugged into a communication device for Universal Mobile Telecommunications System UMTS also called 3G telephony communications. The USIM card stores user account information an IMSI authentication information and a set of USIM Application Toolkit USAT commands and provides space for storing text messages and phone book contacts. A Baseband MPU may interact with an MCU of the USIM card each referred to as a USIM MCU hereinafter to fetch data or SAT commands from the plugged in USIM cards. The phone book on the USIM card is greatly enhanced when compared to the SIM card. For authentication purposes the USIM card may store a long term preshared secret key K which is shared with the Authentication Center AuC in the network. The USIM MCU may verify a sequence number that must be within a range using a window mechanism to avoid replay attacks and is in charge of generating the session keys CK and IK to be used in the confidentiality and integrity algorithms of the KASUMI also termed A5 3 block cipher in the UMTS systems. A communication device is immediately programmed after plugging in the USIM card.

A Removable User Identity Module R UIM or a Code Division Multiple Access CDMA Subscriber Identity Module CSIM card has been developed for a CDMA communication device and is equivalent to the GSM SIM and 3G USIM except that it is capable of working in CDMA networks. The R UIM or the CSIM card is physically compatible with the GSM SIM card and provides similar security mechanisms for the CDMA system.

A SIM Application Toolkit SAT is a standard of the GSM which enables an SIM MCU to initiate actions which can be used for various value added services. The SAT consists of a set of commands programmed into a SIM card which define how the SIM MCU interacts directly with the outside world and initiates commands independently of the communication device and the network. The SAT enables the SIM MCU to build up an interactive exchange between a network application and an end user and to access or control access to the network. The SIM MCU also provides SAT commands to the Baseband MPU to display a menu ask for user input or the similar. An SAT has been deployed by many network operators for many applications often where a menu based approach is required such as mobile banking content browsing and switching between multiple subscriber numbers in a single subscriber identity card etc. Designed as a single application environment an SAT can be started at the initial power up of the SIM card and is especially suited to low level applications with simple user interfaces.

A USIM Application Toolkit USAT is the equivalent of an SAT for 3G networks. A USAT enables the USIM MCU to initiate actions which can be used for various value added services delivered over the communication device. The USAT is employed in a multi application environment of 3G devices and is not activated until a specific application has been selected unlike SAT which is activated at startup. Particularly certain functions are card related rather than application related.

SAT and USAT proactive commands may be grouped into two categories RF dependent and RF independent. RF dependent SAT USAT proactive commands when executed by the Baseband MPU request for RF resources i.e. an RF module while RF independent SAT USAT proactive commands do not request for RF resources.

The SAT USAT provides mechanisms which allow applications that are presented in a subscriber identity card to interact and operate with a communication device which supports the specific mechanism s required by the applications. Specifically referring to applications in a form of an SAT USAT applet when executed by a MCU of a subscriber identity card requests the communication device i.e. Baseband MPU processor to perform a particular task such as playing a tone displaying text or menu on a screen getting a user input setting up a call or others by employing SAT USAT application programming interfaces API also referred to as the mentioned SAT USAT proactive commands. The subscriber identity card may be the mentioned SIM USIM R UIM or CSIM card.

Referring to the Baseband MPU operates as a master and initiates commands to the MPU of the subscriber identity card. Note that SIM USIM procedures may end in 90 00 indicating normal ending to the initiated command or may end in 91 XX indicating response data available from a subscriber identity card . The response code 91 XX may also inform the Baseband MPU that the previous command has been successfully executed by the MPU of the subscriber identity card in the same way as 90 00 i.e. OK as well as indicate response data which contains an SAT USAT proactive command from the MPU of the subscriber identity card for a particular procedure. The value XX indicates the length of the response data. After that the Baseband MPU uses the FETCH command to obtain the response data indicating a particular SAT USAT proactive command. If the indicated command has been successfully executed the Baseband MPU informs the MPU of the subscriber identity card with TERMINAL RESPONSE . If the indicated command is not successfully executed the Baseband MPU informs the MPU of the subscriber identity card with TERMINAL RESPONSE with an error condition.

For a subscriber identity card having multiple subscriber numbers a data format of a SIM instance may be deployed for independently storing the data concerning a respective subscriber number as shown in or a shared data format for all SIM instances may be deployed for jointly storing the data concerning the multiple subscriber numbers as shown in . Alternatively a partly independent data format of one SIM instance may be deployed for storing the data concerning a respective subscriber number in which most EFs are jointly used for storing the data concerning the subscriber numbers and only some other EFs are independently used for storing the data concerning respective subscriber numbers as shown in . Taking a single subscriber identity card having 4 subscriber numbers for example if the data format as shown in is employed independent SIM instances are presented as four trees for storing the data concerning the 4 subscriber numbers respectively or if the data format as shown in is employed only a macro SIM instance is presented as one tree for storing the data concerning the 4 subscriber numbers and data for 4 subscriber numbers is integrated into relevant nodes or if the data format as shown in is employed 4 partly independent SIM instances are presented for storing the unique data concerning the 4 subscriber numbers such as data branching from the DFbeing distinct from one SIM instance to another and the EFs within the dotted rectangle are shared by all 4 SIM instances. In one embodiment the amount of subscriber numbers in a subscriber identity card may be determined via a service menu provided by a SAT USAT applet in the subscriber identity card as shown in . In another embodiment with the data formats in the amount of subscriber numbers in a subscriber identity card may be determined according to the quantity of SIM instances therein or in the data format in a proprietary EF may be used for storing the information of the amount of subscriber numbers in the subscriber identity card as follows 

For the refresh procedure described in some exemplary EFs to be read from a SIM card are listed below.

For the refresh procedure described in some exemplary EFs to be read from a USIM card are listed below.

After that the MPU of the Baseband chip in the communication device transmits to the subscriber identity card an AUTHENTICATION CHALLENGE message containing the random part RAND and the authentication part AUTN step S . With the random part RAND and the authentication part AUTN the MPU of the subscriber identity card runs the authentication algorithm associated with the first SIM instance and generates an authentication vector which includes authentication parameters such as XMAC RES CK and IK step S . Specifically the authentication algorithm is a combination of the f f f f and f algorithm defined in the release 10 of the 3GPP TS 35.205 and 35.206 specifications v.10.0.0 referred to herein as the TS 35.205 and 35.206 specifications . The subscriber identity card then replies to the communication device with an AUTHENTICATION RESPONSE message containing the generated authentication vector step S . Then the communication device transmits to the network another AUTHENTICATION RESPONSE message containing the authentication parameter RES step S . When receiving the AUTHENTICATION RESPONSE message the network further transmits a SECURITY MODE COMMAND message to the communication device step S to start the integrity protection of the subsequent messages. Upon receiving the SECURITY MODE COMMAND message the MPU of the Baseband chip in the communication device runs the integrity algorithm f defined in the release 10 of the 3GPP TS 35.201 and 35.202 specifications v.10.0.0 referred to herein as the TS 35.201 and 35.202 specifications to calculate a 32 bit message authentication code MAC I step S . After the calculation of the message authentication code MAC I the communication device replies to the network with a SECURITY MODE COMPLETE message containing the message authentication code MAC I step S . The network determines whether the message authentication code MAC I is authenticated and decides to accept the registration of the communication device when the MAC I is successfully authenticated. Upon accepting the registration of the communication device the network further transmits a TMSI REALLOCATION COMMAND message to re allocate the TMSI to the communication device step S and transmits a LOCATION UPDATE ACCEPT message to the communication device step S . The communication device replies to the network with a TMSI REALLOCATION ACKNOWLEDGE message for acknowledging the reception of the TMSI REALLOCATION COMMAND message step S . The registration to the network according to the first SIM instance ends with the communication device receiving the LOCATION UPDATE ACCEPT message and the network selection procedure may be repeated for the next SIM instance in the subscriber identity card until registrations to the networks according to each of the SIM instances in the subscriber identity card have been completed. Thus the communication device simultaneously camps on multiple cells provided by the same or different networks i.e. the communication device operates in a multi standby mode using the multiple subscriber numbers in the subscriber identity card. Note that the steps S to S may be omitted for the cases where the authentication algorithms respectively associated with the SIM instances in the subscriber identity card are the same or the authentication algorithms associated with the last activated SIM instance and the currently activated SIM instance are the same. Other detailed descriptions of the network selection procedure are omitted herein since they are beyond the scope of the invention and references may be made to the release 10 of the 3GPP TS 23.122 specification v.10.3.0 referred to herein as the TS 23.122 specification release 10 of the 3GPP TS 43.022 specification v.10.0.0 referred to herein as the TS 43.022 specification release 10 of the 3GPP TS 25.304 specification v.10.0.0 referred to herein as the TS 25.304 specification and release 10 of the 3GPP TS 36.304 specification v.10.1.0 referred to herein as the TS 36.304 specification .

After that the MPU of the Baseband chip in the communication device transmits to the subscriber identity card an AUTHENTICATION CHALLENGE message containing the random part RAND step S . With the random part RAND the MPU of the subscriber identity card runs the authentication algorithm associated with the first SIM instance and generates an authentication vector which includes authentication parameters such as Kc and SRES step S . Specifically the authentication algorithm is a combination of the A3 and A8 algorithm defined in the release 10 of the 3GPP TS 55.205 specification v.10.0.0 referred to herein as the TS 55.205 specification . The subscriber identity card then replies to the communication device with an AUTHENTICATION RESPONSE message containing the generated authentication vector step S . Then the communication device transmits to the network another AUTHENTICATION RESPONSE message containing the authentication parameter SRES step S . When receiving the AUTHENTICATION RESPONSE message the network further transmits a CIPHERING MODE COMMAND message to the communication device step S to start the ciphering for subsequent messages. Upon receiving the CIPHERING MODE COMMAND message the MPU of the Baseband chip in the communication device runs the ciphering algorithm A5 defined in the release 10 of the 3GPP TS 55.216 specifications v.10.0.0 referred to herein as the TS 55.216 specification to cipher the CIPHERING MODE COMMAND message and generate a ciphered message Kc M step S . After the generation of the ciphered message Kc M the communication device replies to the network with a CIPHERING MODE COMPLETE message containing the ciphered message Kc M step S . The network determines whether the ciphered message Kc M is authenticated and decides to accept the registration of the communication device when the Kc M is successfully authenticated. Upon accepting the registration of the communication device the network further transmits a TMSI REALLOCATION COMMAND message to re allocate the TMSI to the communication device step S and transmits a LOCATION UPDATE ACCEPT message to the communication device step S . The communication device replies to the network with a TMSI REALLOCATION ACKNOWLEDGE message for acknowledging the reception of the TMSI REALLOCATION COMMAND message step S . The registration to the network according to the first SIM instance ends with the communication device receiving the LOCATION UPDATE ACCEPT message and the network selection procedure may be repeated for the next SIM instance in the subscriber identity card until registrations to the networks according to each of the SIM instances in the subscriber identity card have been completed. Thus the communication device simultaneously camps on multiple cells provided by the same or different networks i.e. the communication device operates in a multi standby mode using the multiple subscriber numbers in the subscriber identity card. Note that the steps S to S may be omitted for the cases where the authentication algorithms respectively associated with the SIM instances in the subscriber identity card are the same or the authentication algorithms associated with the last activated SIM instance and the currently activated SIM instance are the same. Other detailed descriptions of the network selection procedure are omitted herein since they are beyond the scope of the invention and references may be made to TS 23.122 43.022 25.304 and 36.304 specifications.

In response to receiving the response data the MPU of the Baseband chip in the communication device retrieves the updated EFs from the local storage unit step S and then requests to write one of the updated EFs to the subscriber identity card step S . Subsequently the MPU of the Baseband chip in the communication device receives a response corresponding to the write request from the subscriber identity card step S . Next the steps S to S are repeated until all of the updated EFs are written back to the subscriber identity card. Note that in another embodiment the MPU of the Baseband chip may directly write the updated EFs back to the subscriber identity card.

After all SIM instances in the subscriber identity card have been polled the MPU of the Baseband chip in the communication device fetches the SAT command s to be processed for the currently activated SIM instance according to the stored information and then processes the SAT command s step S . Specifically the MPU of the Baseband chip in the communication device may transmit a FETCH command to obtain the response data indicating a particular SAT USAT command. Next the MPU of the Baseband chip in the communication device switches the activated SIM instance to the next SIM instance in the subscriber identity card step S and repeats the steps S to S until the SAT command s of all SIM instances in the subscriber identity card are processed.

After all SIM instances in the subscriber identity card have been polled the MPU of the Baseband chip in the communication device fetches the SAT command s to be processed for the currently activated SIM instance denoted as SIM instance i in according to the stored information and then processes the SAT command s step S . Specifically the MPU of the Baseband chip in the communication device may transmit a FETCH command to obtain the response data indicating a particular SAT USAT command. When the processing of the SAT command s of the currently activated SIM instance is completed the MPU of the Baseband chip in the communication device switches the activated SIM instance to the next SIM instance denoted as SIM instance 1 1 in in the subscriber identity card step S and repeats the steps S and S until the SAT command s of relevant SIM instances in the subscriber identity card are fetched and processed.

Note that although most of the EFs of all SIM instances may be read from the subscriber identity card and stored in the local storage unit at power on of the communication device as described in some of the remaining EF s may be later read from the subscriber identity card when required. is a message sequence chart illustrating a SIM instance update procedure for reading a particular EF from a subscriber identity card comprising a plurality of subscriber numbers according to an embodiment of the invention. In this embodiment the SIM instance update procedure is triggered during a network selection procedure in which the EFis required. As shown in the SIM instance update procedure starts by the MPU of the Baseband chip in the communication device to transmit a SAT USAT proactive command to request the subscriber identity card to switch the activated SIM instance to the first SIM instance step S . When receiving the SAT USAT proactive command the MPU of the subscriber identity card replies to the communication device with a response code 91 XX which indicates availability of a response data to be fetched step S . Next the MPU of the Baseband chip in the communication device transmits a FETCH command to obtain the response data step S . When receiving the response data the MPU of the Baseband chip in the communication device determines that the response data indicates a REFRESH command step S . After that the MPU of the Baseband chip in the communication device requests to read the EFfrom the subscriber identity card step S and then receives the EFfrom the subscriber identity card step S . The MPU of the Baseband chip in the communication device then stores the read EF in a local storage unit step S . Alternatively the EFs of one or more SIM instances may be read from the subscriber identity card and stored in the local storage unit at power on of the communication device and the EFs of other SIM instances may be read later from the subscriber identity card when required and the invention is not limited thereto.

While the invention has been described by way of example and in terms of preferred embodiment it is to be understood that the invention is not limited thereto. Those who are skilled in this technology can still make various alterations and modifications without departing from the scope and spirit of this invention. Therefore the scope of the present invention shall be defined and protected by the following claims and their equivalents.

