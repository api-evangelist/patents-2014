---

title: Quantum key distribution protocol process
abstract: A communication process is provided for sending a qubit message between Alice and Bob using a quantum channel for obviating a faked-state attack by Eve. The qubit message is composed of ensemble bits and transmitted as a plurality of photons into the quantum channel. Each photon has a corresponding bit value. The process includes: Alice preparing three uniformly random bit strings each of length 4N to produce strings R (raw key), P (bit basis) and U (unitary operation), and Bob preparing two uniformly random bit strings of the same length to produce strings M (bit basis) and V (unitary operation). Alice broadcasts P, applies her unitary operation and records a first weak measurement to the photons for transmission. Meanwhile Bob broadcasts M, applies his unitary operation and records both a second weak measurement and a strong measurement to the photons. Alice segregates her key and weak measurement strings to produce corresponding truncated strings from differing bases in P and M, and broadcasts the truncated key string. Bob segregates his weak and strong measurement strings from the differing bases to produce corresponding truncated strings, broadcasting the truncated strong measurement string. Bob then compares an average of his truncated weak measurement string to a security threshold as a first condition. Alice compares an average of her truncated weak measurement string to the security threshold as a second condition. If both conditions are satisfactory, Alice segregates a new truncated key string from R by selecting same bases in P and M for sending to Bob.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09306739&OS=09306739&RS=09306739
owner: The United States of America as Represented by the Secretary of the Navy
number: 09306739
owner_city: Washington
owner_country: US
publication_date: 20141119
---
The invention described was made in the performance of official duties by one or more employees of the Department of the Navy and thus the invention herein may be manufactured used or licensed by or for the Government of the United States of America for governmental purposes without the payment of any royalties thereon or therefor.

The invention relates generally to quantum key distribution QKD . In particular the invention relates to a QKD protocol that employs weak measurements to inhibit eavesdropping.

Secure key distribution constitutes an important element in reliable communication and remains the focus of technological innovation as represented by U.S. Pat. No. 8 391 486. Communication scenarios involve three participants transmitter Alice recipient Bob and eavesdropper Eve. Alice desires to send a secure message to Bob using cryptography while Eve attempts to intercept Alice s message. C. H. Bennett and G. Brassard described their BB84 protocol in Quantum Cryptography Public Key Distribution and Coin Tossing Proceedings of the IEEE International Conference 1984 available at http www.cs.ucsb.edu chong 290N W06 BB84.pdf. A video description can be viewed at http www.youtube.com watch v UVzRbU6y7Ks. Subsequent protocols include E91 by A. Ekert Quantum cryptography based on Bell s theorem 67 6 667 1991 and BBM92 by C. H. Bennett G. Brassard and N. D. Mermin Quantum Cryptography without Bell s Theorem 68 5 557 1992 . BB84 represents a widely accepted conventional process to attempt secure communication.

Conventional quantum key distribution protocols yield disadvantages addressed by various exemplary embodiments of the present invention. In particular exemplary embodiments provide a communication process is provided for sending a qubit message between Alice and Bob using a quantum channel for obviating a faked state attack by Eve. The qubit message is composed of ensemble bits and transmitted as a plurality of photons into the quantum channel. Each photon has a corresponding bit value. The process includes Alice preparing three uniformly random bit strings each of length 4N to produce strings R raw key P bit basis and U unitary operation and Bob preparing two uniformly random bit strings of the same length to produce strings M bit basis and V unitary operation . Alice broadcasts P applies her unitary operation and records a first weak measurement to the photons for transmission. Meanwhile Bob broadcasts M applies his unitary operation and records both a second weak measurement and a strong measurement to the photons. Alice segregates her key and weak measurement strings to produce corresponding truncated strings from differing bases in P and M and broadcasts the truncated key string.

In these embodiments Bob segregates his weak and strong measurement strings from the differing bases to produce corresponding truncated strings broadcasting the truncated strong measurement string. Bob then compares an average of his truncated weak measurement string to a security threshold as a first condition. Alice compares an average of her truncated weak measurement string to the security threshold as a second condition. If both conditions are satisfactory Alice segregates a new truncated key string from R by selecting same bases in P and M for sending to Bob.

In the following detailed description of exemplary embodiments of the invention reference is made to the accompanying drawings that form a part hereof and in which is shown by way of illustration specific exemplary embodiments in which the invention may be practiced. These embodiments are described in sufficient detail to enable those skilled in the art to practice the invention. Other embodiments may be utilized and logical mechanical and other changes may be made without departing from the spirit or scope of the present invention. The following detailed description is therefore not to be taken in a limiting sense and the scope of the present invention is defined only by the appended claims.

In accordance with a presently preferred embodiment of the present invention the components process steps and or data structures may be implemented using various types of operating systems computing platforms computer programs and or general purpose machines. In addition those of ordinary skill in the art will readily recognize that devices of a less general purpose nature such as hardwired devices or the like may also be used without departing from the scope and spirit of the inventive concepts disclosed herewith. General purpose machines include devices that execute instruction code. A hardwired device may constitute an application specific integrated circuit ASIC or a field programmable gate array FPGA or other related component.

A Quantum Key Distribution Protocol Robust Against Side Channel Attacks That Rely on Manipulation of Bit Error Rate Estimation Reduce the effectiveness of large classes of side channel attacks on practical quantum key distribution QKD systems while maintaining high secure key rates. To be disclosed in a peer reviewed article that will soon be submitted for public release. A practical QKD system with robust security against known side channel attacks would be used to refresh secure keys in a secure communication network without relying on a public key infrastructure PKI .

All conventional PKI systems are known to be vulnerable to any future adversary that may possess a large scale quantum computer. However practical QKD systems have been compromised using a variety of exploits that utilize the behavior of crucial components of the systems. A very active area of research is exploring ways to design exemplary QKD protocols and devices that reduce the effectiveness of such attacks. The exemplary QKD protocol is an improvement over existing QKD protocols in use both academically and commercially. The protocol can be physically implemented in several different ways depending on the particular application e.g. optical communication via fiber or free space channels.

Exemplary embodiments provide a variation of the BB84 quantum key distribution protocol that utilizes the properties of weak values to insure the validity of the raw key bit error estimates in the protocol. The protocol is shown to be secure against recently demonstrated attacks utilizing detector blinding control and attacks in which Eve uses Unambiguous State Discrimination. The proposed protocol can achieve this additional security with an increase in secure key generation rate as compared to that originally promised by the standard BB84 scheme. In addition the exemplary protocol does not require an entangled photon source.

I. Introduction The ability to distribute secret keys for symmetric encryption without the need for a trusted courier is a fundamentally new capability promised by the most mature of quantum information technologies quantum key distribution. Evidence of the growing maturity of this field is the commercial availability and presumably use of QKD based crypto systems. Further evidence is provided by the emergence of the field of quantum hacking the investigation and identification of the types of weakness and flaws present in practical QKD systems.

As pointed out by R. Hughes et al. in Refining Quantum Cryptography 333 1584 2011 the development of quantum hacking is an expected and positive development in the QKD field. As QKD concepts become tangible systems the inevitable gaps that separate the theoretical protocols and the actual behavior of system components are exposed by the creative determined efforts of scientists and engineers in the hacker community. The first goal of hacking a prospective QKD system is simply to identify and correct improperly implemented protocols. The longer term goal is to imagine and test possible avenues of attack against QKD systems whose implementations are basically sound while using the specifics of the systems physical implementations to compromise the security.

 1 hacks based on Trojan horse components e.g. an implanted memory device that records and reuses previously generated keys or compromised random number generators 

 2 active attacks that inject photons into the system interrogating system components that may yield information about Alice s bit and or basis choices 

 4 faked state attacks that hide the eavesdropper s interception by exploiting behavior of the QKD system components e.g. of the detection method used particularly that of single photon detector technology.

All four categories of attacks are viable and must be defended against. In the case of 1 Trojan horse components it seems very unlikely that a QKD protocol of any type will be able to guard against such attacks. The only effective strategy for dealing with such possibilities is to thoroughly understand and verify the origin function construction and behavior of all QKD system components. For category 2 careful system design and characterization are the first line of defense with consideration of the trade off between implementation choices and the protocol requirements.

Significant ongoing research into improving methods of deterministic single photon generation will address 3 which includes beam splitter attacks. In the case of 4 faked state attacks FS attacks the essentially unavoidable access Eve has to Bob s detectors combined with the very non trivial complexity and behavior of any detector system which can accurately detect single photons leads to the existence of many attack vectors. That such FS attacks are viable and plentiful is proven by the success of numerous QKD hacking strategies based on FS attacks. While it might be said that many of these attacks rely on the specifics of the ubiquitous Geiger mode avalanche photodiode APD two points should be made. First because APDs are ubiquitous such attacks have importance. Second this general attack strategy is open against any detector technology only the specifics of the detector behavior modification are likely to change.

This second point is underscored by recent success in applying the same blinding techniques to newly developed single photon detectors based on superconducting nanowires. This is described by L. Lydersen et al. Controlling a superconducting nanowire single photon detector using tailored bright illumination 13 113042 2011 available at http www.vad1.com publications NewJPhys 13 113042.pdf and by M. Tanner et al. Optimized quantum hacking of superconducting nanowire single photon detectors 22 6 6734 2014 available at http www.vad1.com publications tanner2014.OptExpress 22 6734.pdf.

The foundation of a successful FS attack is the ability of Eve to hide her presence by sufficiently biasing the estimated quantum bit error rate QBER that Alice and Bob calculate using part of the sifted key. In the case of detector blinding attacks Eve accomplishes this by forcing Bob s choice of basis to match hers with a probability greater than chance. Instead of manipulating Bob s detectors another subclass of FS attacks utilize Eve s ability to perform Unambiguous State Discrimination USD on the qubits coming from Alice. Eve performs a generalized positive operator valued measurement POVM on the incoming photons so she can probabilistically discriminate between the various non orthogonal photon states. This process must be probabilistic given the non orthogonality of the cross basis pairs of states.

However Eve can hide the resulting disturbance in the cases where state discrimination fails by only resending signals in the cases when discrimination has succeeded. Just as in the detector blinding attacks Eve then utilizes the significant loss in the quantum channel to hide her filtering of Alice s transmitted signals. Due to the filtering Eve will then know the state of all or at least some of the signals transmitted to Bob and in addition Eve s presence will not be revealed by the QBER of the sifted key extracted from these signals.

This disclosure describes a novel process for defending against the general class of FS attacks by introducing an exemplary protocol that utilizes a feature of quantum mechanics that has remained unexploited in BB84 and other QKD protocols the behavior of pre and post selected weak measurement results. The exemplary QKD protocol has four appealing features 

 2 it has a secure key generation rate at least as large as that promised by the original BB84 protocol 

 3 its security is guaranteed even if Eve is assumed to have control all of the measurement devices used in the protocol and

 4 it should be straightforward to implement the exemplary protocol using current quantum optical technology.

The principle idea is that the weak values of each photon s state are equally determined by both the state prepared by Alice and Bob s measurement outcome. Weak measurements enable Alice and Bob to directly detect any intervening disturbance by Eve by looking for changes in the measurement results of each pre and post selected ensemble of qubits. In effect the exemplary embodiments generalize the usual method of detecting Eve through estimation of the bit error rate to include the cases when Alice and Bob are using different bases. Such a generalization renders much more difficult attempts by Eve to avoid detection by using FS attacks.

II. Faked State Attacks Quantum key distribution promises to provide security for the distribution of a shared key between two parties Alice and Bob using specially prepared and measured quantum bits. The security of the key rests on the inability of an eavesdropper Eve to obtain information about the unknown state of the qubits without disturbing their states. Popular phrases are that QKD promises security that is guaranteed by the laws of physics and provides unconditional security . While the unbreakable security of QKD protocols themselves are indeed founded on the laws of physics in practice there remains an inevitable mismatch between the behavior of idealized QKD schemes and those of real QKD systems. Therefore any promise of unconditional security must be looked at with an extremely large degree of skepticism.

The security analysis of real QKD systems must always be based on some assumptions about the specifics of the devices used to implement them. Of course obvious non ideal components such as noisy or lossy channels detector inefficiencies and detector dark counts are recognized and treated in practical QKD security analysis. In these analyses Eve is assumed to have complete control of the losses in the channel and the dark counts in the detectors. It is further assumed that all observed signatures of noise e.g. raw key bit errors are due to Eve s interference. Using these assumptions one can model the performance of the QKD system against a particular eavesdropping strategy by Eve.

For example the maximum distance over which a secure key can be distributed may be calculated. The central part of such security analyses is to estimate the maximum amount of information about the raw key Eve may possess given the system parameters and the laws of physics. In the BB84 protocol and variants Eve s information is bounded by estimating the bit error rate for the quantum channel. In order estimate the true QBER Alice and Bob must use a randomly selected subset of the distributed raw key of sufficient length that the QBER of this subset is very likely to be close to the true QBER of the remaining raw key. An important assumption made in most BB84 and variants as well as entanglement based E91 and BBM92 QKD protocols is that such a random subset is available to Alice and Bob i.e. the particular subset chosen is truly randomly selected.

However ensuring validity of this assumption in real systems has been demonstrated to be very difficult. For example Eve can manipulate the behavior of Bob s detectors in order to bias the estimated QBER calculated by Alice and Bob such that Eve s disturbance of the qubits is not detected. Alternatively Eve can attack Alice by using USD to probabilistically identify the photon state sent by Alice.

In the cases where Eve s discrimination is unsuccessful Eve does not send a faked state on to Bob while in the other cases Eve resends the same state as Alice. Eve increases the probability of Bob s detection of these faked state signals by manipulating the channel losses or sending multiple copies in the same time window. Because significant losses are unavoidable in any practical QKD system Eve is able to mask the losses she induces into the channel as normal system loss.

In both types of FS attacks Eve is able to selectively filter out the photons which would give away her presence while preserving the signals for which she has information about either the transmitted or detected quantum state. With either the detector or USD attacks Eve can then extract the secure key without detection by Alice and Bob because the estimated QBER will be unchanged by Eve s presence.

While addressing a specific known method of FS attack e.g. Eve s control of Bob s detectors may be possible with very careful engineering one should note that the QBER fair sampling assumption necessary in conventional QKD protocols constitutes a fundamental weakness. Therefore exemplary QKD protocols that eliminate the fair sampling assumption are desirable in principle thereby removing a large class of attack vectors currently present in practical QKD systems.

Because the weak value of a quantum system is equally defined by both the initial and final state of an individual system the weak value is a useful attribute to use for detecting the presence of Eve. Access to a system s weak value is provided statistically by the mean value of sufficiently weak measurements that have been conditioned on particular initial and final states. Any interaction between Eve and the qubit transmitted between Alice and Bob will necessarily have an effect on the correlations between the initial and final states due to state disturbance and change the observed weak measurement statistics. Of particular interest for detecting an FS attack such disturbances are present and observable even in the cases when Alice and Bob measure in different bases. This enables them to monitor for the presence of Eve using the half of the signals that are usually discarded at the beginning of the protocol.

For the QKD protocol introduced in this disclosure the following assumptions about the power of Eve are listed Eve controls the quantum channel losses all observed bit errors are due to Eve she can control Bob s single photon detectors completely e.g. Eve can make a detector click or not click as she wishes or she can alter the contents of any data stored there. Crucially Eve is not permitted the ability to alter or know the basis choice or bit values that Alice uses to prepare each qubit. Thus exemplary embodiments do not address attacks of types 1 2 or 3 discussed above. In particular this means omitting vulnerabilities due to imperfect state preparation such as multiple photons per pulse.

Future efforts will address the impact that imperfect states have on the security of the exemplary protocol. One can assume as is usually the case that Alice and Bob have access to a properly authenticated classical channel that Eve will be able to passively monitor. One can further assume that both Alice and Bob each locally have devices that produce the multiple independent and sufficiently random strings of binary numbers needed for the protocol.

In attacks on BB84 Eve can only get information about the raw key bit when she correlates her measurement system with the qubit at Alice and or Bob s location. In the specific case of detector attacks this means Eve s strategy is most successful when she forces Bob s measurements to match her own choice of basis. Because of the need for Bob and Eve s bases to match Alice and Bob can detect Eve by the following method. For each photon Bob s detection apparatus is set so that just prior to performing the strong measurement in a particular basis assumed chosen by Eve Bob weakly measures in the opposite basis. The result of this weak measurement is then recorded by Bob.

For photons in which Bob s choice of measurement does not match Alice s which must occur 50 of the time Bob announces the bit values and the associated weak measurement results. Using this information Alice is able to calculate the weak value of the observable given the pre and post selected states. These weak values are 1 in the case where Eve has not performed a measurement i.e. intercept resend attack while the expectation values of Bob s weak measurement results conditioned on the pre and post selected states will all equal 0 when Eve has performed a strong measurement on all the photons.

Because Eve does not know the basis Alice prepared the photons in she has no way to avoid detection by selectively measuring or not measuring photons. Also Eve does not know the bit value of the photons that Alice prepared in the opposite basis. Therefore Eve has no way of knowing how to modify Bob s weak measurement results so that the correct conditional averages will be observed by Alice when she checks them against the values required by the associated weak values.

The exemplary protocol addresses the weakness in QKD due to the assumption that the true bit error rate can be accurately estimated by selecting a random and hence representative subsample of the distributed raw key. The issue is that the assumption of randomness cannot in general be ensured by the BB84 protocol and the laws of physics the engineering design of a practical QKD system must attempt to enforce the validity of this assumption. This exemplary extension of the BB84 protocol utilizes the properties of post selected weak measurements to remove the vulnerability of BB84 to these violations of fair sampling.

III. Weak Measurement and Weak Values A cursory review is presented of the concepts of weak measurement and weak values and the general formulation of Time Symmetric Quantum Mechanics TSQM . The weak value of a quantum mechanical observable was introduced over two decades ago by Y. Aharonov et al. Time Symmetry in the Quantum Process of Measurement 134 B1410 1964 available at http www.tau.ac.il yakir yahp yh150. The weak value is experimentally obtained from the result of measurements performed upon a pre selected and post selected PPS ensemble of quantum systems when the interaction between the measurement apparatus and each system is sufficiently weak.

Unlike the standard strong measurement of a quantum mechanical observable which disturbs the measured system and collapses its state into an eigenstate of the observable a weak measurement does not appreciably disturb the quantum system and yields the weak value as the measured value of the observable. This is possible because very little information about the observable is extracted in a single weak measurement. Experimentally determining the weak value requires performing weak measurements on each member of a large ensemble of identical PPS systems and averaging the resulting values.

The standard formulation of quantum mechanics describes a quantum system at a time tby a state that evolves in time from the past until t. TSQM also uses a second state which can be thought of as a state evolving backward in time from the future to t as reported by Y. Aharonov and D. Rohrlich in their textbook Quantum Paradoxes 2005 especially chapter 10 available at http bookfi.org book 1163947. The weak values measured at time tare equally influenced by both of these states. Many experiments have verified the surprising and counter intuitive aspects of weak values. In particular they can lie far outside the associated observable s eigenvalue spectrum and can be complex valued.

The von Neumann model of quantum measurement describe weak measurements as reported by Y. Aharonov et al. Properties of a quantum system during the time interval between two measurements 41 1 11 1990 available at http www.tau.ac.il yakir yahp yh66 and by J. Tollaksen Pre and post selection weak values and contextuality 40 9033 2007 preprint available at http arxiv.org pdf quant ph 0602226v3.pdf.

Consider an observable A pertaining to a quantum system pre selected to be in the state . The Hamiltonian describing the interaction between the system and measuring device MD is expressed as 1 where circumflex over Q is the position operator for the MD and g t is the interaction s coupling strength defined by 2 is integrated over the interaction time interval from time t to t . The measurement interaction is weakened by minimizing g Q. Let the MD s initial pointer state be a real Gaussian pointer with unit variance in momentum.

The evolution operator for the system and MD is then given by exp exp 4 where the Dirac constant can be set to 1 and the interaction is non zero from t to t . The measurement interaction is weakened by minimizing g Q where g g t dt is a constant defining the coupling strength and Qis the uncertainty in the position observable for the MD. The final state of the measuring device can be seen to be a superposition of Gaussians in momentum space each of which is shifted by gawhere the aare eigenvalues of . Thus the MD is a Gaussian with mean shifted by gA where is as usual the expectation value of . This expression for the effect of the weak measurement interaction on the MD is true for the case of a real valued MD. This equation for the secure key length has been modified to reflect the raw key length in our variation of the BB84 protocol i.e. the leading factor of two.

Let b be the non degenerate eigenstates of a final observable circumflex over B . Then using the closure relation 5 the expectation value of observable can be rewritten as 

Thus the expectation value of any observable can be interpreted as an average of weak values A taken over all of the different PPS ensembles as reported by Y. Aharonov et al. Quantum averages of weak values 72 052111 2005 available at http www.tau.ac.il yakir yahp yh161.pdf. The weighting factor b is the probability that any single system belongs to the particular PPS defined by the outcome b.

The wave function of the measuring device in momentum space after the weak measurement interaction and the post selection is given by 

To experimentally access the weak value A the weak measurement is performed on a large ensemble of identically prepared systems each in the state . In order to perform a post selection an observable circumflex over B is strongly measured on each of these systems yielding a final state that is one of the eigenstates b. For each b the ensemble can be divided into a distinct PPS ensemble. Every MD can then be associated with a particular PPS ensemble so that the results of projective measurements of each MD are placed into distinct PPS ensembles. By taking the mean of all such pointer values for each PPS ensemble one can determine the weak value A with an uncertainty proportional to

IV. Weak Value Augmented BB84 Protocol The central difference between the proposed protocol and BB84 and its variants is that the detection of Eve s presence does not rely on the estimated QBER of the sifted key. Alice and Bob independently probe the behavior of the quantum channel by means of weak measurements of particular observables conditional on the results of the outcomes of Bob s measurements and the states prepared by Alice when the two bases disagree. Thus the protocol uses the outcome results when Alice s and Bob s choices of basis disagree regarding the detection of Eve. This detection strategy is strictly more powerful than the sifted key QBER because any form of measurement by Eve must necessarily disturb either the incoming state from Alice or the time reversed state back propagated from Bob s measurement outcome.

This time symmetric view of weak values highlights the structure of the exemplary protocol. As later described in Section V on protocol security the eavesdropping strategy that Eve employs can have different signatures in the observed conditional weak measurement results thus giving Alice and Bob a higher degree of situational awareness regarding the quantum channel s security while the system is in operation. For instance a detector blinding attack will be revealed in changes to the weak measurement results obtained by Bob only whereas a straightforward incept resent attack Eve measuring all of the photons in a random basis would show up equally in both Alice and Bob s weak measurement statistics. Finally an attack utilizing unambiguous state discrimination would change Alice s weak measurement results but not alter Bob s.

 1 Alice starts with three uniformly random binary value strings of bits each of length 4N. These consist of the list R representing the raw key bit values to be sent to Bob the string P representing the basis in which each bit will be prepared and the string U that determines the unitary operator that Alice will apply to each photon before she sends it on to Bob. Bob starts with two uniformly random bit strings each of length 4N. These consist of the list M representing the basis in which each bit will be strongly measured and the list V which determines the unitary operator applied by Bob to each incoming photon. Basis 0 will be the eigenstates of circumflex over circumflex over and Basis 1 will be circumflex over circumflex over . The raw key bit value 0 is encoded as r 0 0 or and the raw key bit value 1 is encoded as r 1 1 or .

 2 One at a time Alice prepares 4N single photons in the state given by the corresponding pair of bits from R and P.

 3 For each photon Alice performs a weak measurement of the polarization in the basis opposite to the one in which it was prepared.

Alice locally records the weak measurement results in a time ordered list and sends each photon to Bob. Before the weak measurement has been implemented Alice applies the unitary operation to the iphoton s path in the location just after the weak measurement interaction. This unitary is selected so that if the ibit of U is 0 then the identity operation is applied while if the bit is 1 a plane flip with respect to the encoding basis is applied.

 4 Bob performs a weak measurement of each incoming photon in the basis opposite to that given by the associated bit value in his uniformly random list M and then records the resulting pointer value in an ordered list .

Additionally Bob has randomly chosen to apply a unitary operation and applied it to the iphoton s path in a location just before his weak measurement interaction. If the associated bit value in V is 0 this unitary is chosen to be the identity operation if the bit is 1 a phase flip with respect to the basis defined by the associated bit value in M is applied.

 5 Bob strongly measures each photon in the basis given by the associated bit value in the list M and records the bit value resulting from the measurement in a new list D. If no photon is detected in the given detection time window this is noted.

 6 Bob broadcasts to Alice which photons did not arrive. Alice and Bob remove the elements associated with these photons from lists R P M U and V.

 7 Bob broadcasts the list M revealing his detector basis choices while simultaneously Alice broadcasts her list P revealing her encoding basis choices . Alice separates each of her lists R P and U into two distinct lists corresponding to data associated with qubits prepared and measured in the same basis and those that were not. For example R is split into the lists Fr same basis R different basis etc. with the time ordering preserved. Bob does the same for his lists D M and V.

 9 Bob calculates the average of his weak measurement results for which Alice s and Bob s bases disagree conditional on the associated bit values in R that Alice used to encode the photons.

Bob checks that these averages are close enough those specified by the weak values of the observables measured with the particular pre selected states determined by R and the local unitary transformations defined by V. Bob also calculates the overall mean and variance of his weak measurement results and the variance conditional on the preparation states.

 10 Bob announces to Alice whether or not the statistics of his weak measurements have passed the security tests. If they did not pass Alice and Bob abort the protocol otherwise they proceed.

 12 Alice calculates the average of her weak measurement results conditional on the associated values for Bob s measurement outcomes D.

If no Eve is present these conditional averages will be consistent with the associated weak values of the weakly measured observables given by Bob s measurement outcomes and Alice s local unitary transformations defined by U. Alice also calculates the overall mean and variance of her weak measurement results a and the variance conditional on the final measurement outcomes.

 13 If the conditional and marginal statistics of Alice s weak measurement results are close enough to those that are expected Alice will announce that the channel is secure otherwise Alice and Bob abort the protocol.

 14 Alice and Bob perform key reconciliation and privacy amplification on the raw key contained in the list R the subset of R where P and M agree to produce a shorter error free and secure key.

An eavesdropper identified as Eve has access to select portions of Alice s and Bob s equipment. In particular the eavesdropper controls a first link to access the first weak measurement and its resultant value a second link to access the second weak measurement and its resultant value and a third link to access the beam splitter receivers and detector . Alice and Bob communicate over an authenticated classical channel without effective security from interception and a quantum channel . A bit message over the classical channel from Alice can be intercepted by Eve and reproduced to be forwarded to Bob. Eve also has access to the quantum channel . However for conventional protocols a qubit message over the quantum channel cannot be so readily intercepted without revealing the intrusion. The exemplary protocol further reduces interception vulnerability from an FS attack.

The first list generator produces lists R and P. The second list generator produces lists P and U. The third list generator produces lists M and V. The fourth list generator reproduces list M. The first weak measurement is denoted as . The second weak measurement is denoted as . The detector produces the strong measurement list D.

One can detail the weak values and thus conditional weak measurement results expected by Alice and Bob when Eve is not present. For simplicity all of Alice and Bob s unitaries can be set to the identity and one can assume that the detectors have no dark counts. Both of these assumptions will be rescinded while proceeding.

As noted earlier the basis 0 1 can be referred to as Basis 0 and the basis as Basis 1 . The weak measurement conditional averages divided by the coupling strength parameter are the weak values of the observables. In the case that Bob strongly measures the photon in Basis 0 he will first weakly measure in Basis 1. If Bob has measured in the opposite basis from Alice s preparation Bob s resulting weak values as defined by Alice s preselected states are 

In the dual cases where Bob strongly measures in Basis 1 weakly measuring in Basis 0 and Alice has prepared the state in Basis 0 Bob s resulting weak values are 

More generally written in terms of the corresponding elements r p and din the lists R P and D Bob s weak values are 

The weak values revealed by Alice s weak measurements a conditional on Bob s measurement outcomes are given by 

In order to secure the protocol against Eve altering or faking Alice and or Bob s weak measurement results the protocol implements randomly selected unitaries just after Alice s weak measurement and just before Bob s. The effect of these unitaries is to scramble the relationship between the pre selected and post selected states and the associated weak value. Therefore in order for Eve to correctly fake the weak measurement results for all of the photons she must already know both of the lists elements U and V.

The sign of Alice s Bob s weak values are flipped depending on the local unitary . Therefore the weak value of Alice s measurement for each photon is given by 

For concreteness one can assume that both Alice and Bob s weak measurement pointer states are real valued Gaussians in momentum space with unit uncertainty and zero initial mean value. The general problem Alice and Bob have is to estimate the number of errors that have occurred in the transmitted qubits in the cases where Alice and Bob have measured in opposite bases. This estimate is a fair estimate of the total QBER for the all of the qubits because Eve has no way of biasing the statistics without knowing Alice s choices of bit values i.e. the raw key itself the final measurement results from Bob s detector and the particular unitaries applied by Alice and Bob to each qubit.

For two Gaussian probability distributions with means and both with variance with Z samples taken from the distribution the probability of correctly distinguishing between them is 

In order to predict the observed conditional weak measurement result in the presence of Eve one uses the generalized weak value of J. Dressel et al. Contextual value approach to the generalized measurement of observables 85 022123 2012 preprint available at http arxiv.org pdf 1110.0418v2.pdf that applies to cases with mixed initial state and or final measurement result the post selection specified by the POVM . In the case of pure pre selected and post selected states with unitary evolution in between the generalized weak values and the weak value of Aharonov et al. 2005 coincide.

When the occurrences of bit errors are independent of the basis and bit value the channel is known as a depolarizing channel . In the case when Eve interacts with each photon in the same manner e.g. a simple intercept resend strategy measuring in a random basis and resending the outcome to Bob the quantum channel between Alice and Bob is a depolarizing channel. The precise probability of a bit flip for each photon depends on the measurement strategy Eve employs e.g. projective or POVM. In general Eve s interference will not always produce a depolarizing channel. Such is the case in both USD and detector blinding attacks. Subsequently one can examine the effect of each type of interference on Alice and Bob s conditional weak measurement results.

The particular effect on Alice and Bob s weak measurement averages will depend on the strategy Eve chooses to eavesdrop on the quantum channel. Both USD and detector blinding attacks are examined further in the disclosure as well as the effect of a straightforward intercept resend attack. For concreteness one imagines that Eve s interaction with the qubit channel causes the pre selected state to flip to the orthogonal state with probability p. Further the observed conditional results of Bob s weak measurements can be calculated. The effect of Eve s presence is to turn the pure state encoded by Alice for a given bit value into a mixed state. Thus the initial state at the time of Bob s weak measurement is given by 1 32 where is the original pure pre selected state before the noise channel has been applied and is the state orthogonal to it. For the purpose of this calculation the pre selected state can be set by the unitary . 33 

Thus post interception state can be expressed as 1 34 where the second equality comes from the fact that Alice s unitary is either the identity or a phase flip in the encoded basis. Using Dressel s equation for the real part of the generalized weak value for Bob s measurement of circumflex over one obtains 

Calculating the numerator for v 0 one obtains 00 circumflex over 00 1 2 1 36 while if 1 one obtains 00 circumflex over 00 1 2 1 37 Therefore in general 

Thus as expected the weak value is attenuated by a factor dependent on the channel error probability p 1 2 1 1 2 0 . 40 If Eve performs an intercept resend attack on the channel using projective measurements the probability of a bit flip in the channel is 0.25 yielding an observed weak value magnitude of 0.5. The lowest error rate possibility for Eve is known to be a QBER of about 0.11. Thus the most powerful possible eavesdropping attack on the proposed protocol yields an observed weak value of 0.78. Because the probability of a bit flip is independent of the initial or final state the attenuation of the weak value is the same for all combinations of initial and final states for both Alice and Bob s weak measurements.

One can now analyze the weak value signature for attacks that exploit Eve s ability to control Bob s detector outcomes in order to hide her presence e.g. detector blinding attacks. For a certain fraction of the photons say Eve will perform a blinding attack so that she may perform an intercept resend attack with a projective measurement without being detected by the estimated BER of the raw key used in the usual BB84 protocol.

Eve does not interact with the remaining photons and so they remain unchanged. For the photons that Eve chooses to measure Bob will only detect those for which Eve s choice of basis matches his due to Eve s blinding of his detectors. Only on photons for which Alice and Bob have measured in different bases does the state of these photons before Bob s weak measurement and after Eve s measurement for which Eve must have measured in a different basis from Alice correspond to 

Because the protocol tests the weak values in the cases where Alice and Bob have used different bases detector based attacks necessarily force Alice and Eve to be in different bases. From this one can calculate the weak value of Bob s measurement of circumflex over 

The same attenuation factor occurs for all of the subensembles defined by the four possible initial states for Bob s weak values. Therefore Bob will observe an attenuation that is directly proportional to the fraction of photons for which Eve applies the blinding attack. In the usual case that Eve performs blinding on all of the photons one can observe that Bob will observe that all of the subensembles will have means equal to zero. This means that the detector blinding attack is actually easier to detect than the straightforward intercept resend attack would have been by itself because in that case the weak value has a magnitude no less than 0.50 

In the case of detector blinding Alice will observe no change in her weak measurement results conditional on Bob s final state. This is because Eve has succeeded in correlating Bob s final state with her own intervening measurement outcomes. However the price Eve must pay for this correlation is the complete de correlation between Bob s weak measurement results and Alice s initial state. In this FS attack Eve intercepts a fraction K of the photons and performs a probabilistic determination of the state. In the cases where the determination is inconclusive Eve discards the photons. When the state is successfully identified Eve transmits a qubit prepared in this state to Bob.

By focusing only on cases for which Eve permits a signal to reach Bob and as per the protocol for which Bob measures in opposite basis the final state measurement by Bob becomes 

For example explicitly calculating the weak value of Alice s weak measurement Bob s post selected state is taken as and 00 and therefore circumflex over for definiteness 

From this one can observe that Alice s weak measurement of circumflex over will yield mean values conditional on Bob s final measurement outcomes that are attenuated by the fraction of signals arriving at Bob s detector on which Eve has performed state discrimination. This is true for all four of the subensembles of Alice s weak measurement results as defined by Bob s final state. Note that just as in the detector blinding attack the amount of attenuation is larger than in the straightforward intercept resend strategy. The weak value becomes zero if Eve attacks all of the qubits sent by Alice. Also Bob s weak measurement results conditional on Alice s preselected state are unchanged by the USD attack.

Dark counts will also de correlate the pre selected state and the observed outcome of the detectors. This means that dark counts will also reduce the observed weak values. Assuming that each of the four possible states has a unique detector with possible different dark count rates then the largest of these will impose a secure distance limit. This limit is due to the fact that the fraction of detection events that are dark counts increases with distance in a lossy channel. In order to detect Eve and hence ensure security of the key one must be able to distinguish between operational secure weak values and those due to Eve s attack. In the case of Eve s optimal coherent attack on the QKD system the weak values would be attenuated to a maximum value of 0.78 therefore the dark count fraction of detected events must be strictly less than 0.22.

If Eve is only permitted optimal cloning attacks then the QBER due to Eve s interference is 16.7 as reported by K. Bartkiewicz et al. Experimental Eavesdropping Based on Optimal Cloning 110 173601 2013 preprint available at http arxiv.org pdf 1206.0144v3.pdf. Therefore the maximum allowable dark count fraction is 0.334. Of course the closer the operational i.e. due to system noise weak value attenuation is to that due to Eve s attack strategy the larger the raw key block that must be in order to distinguish the weak value signatures of the secure channel and one altered by Eve s presence with a specified probability. These bounds are the most conservative possible for each attack strategy because of the assumption that Eve can control and therefore turn off the detector dark counts or any other system noise whenever she is performing an attack on the QKD system.

V. Security of the Protocol The security of the protocol rests on the ability of Alice and Bob to accurately detect Eve s presence and accurately estimate the maximum amount of information she may possess. In the usual QKD protocols the QBER of the sifted key is estimated in order to bound Eve s information. In the weak value WV QKD protocol one can estimate the QBER of the sifted key by directly measuring the strength of the correlations between the measurement outcomes and initial states using weak measurements. Any means by which Eve interacts with the photon between Alice and Bob will reduce these correlations and thereby attenuate the conditional averages of Alice and or Bob s weak measurement results.

An intercept resend attack is more powerful more key bits are extracted for a given probability of detection than when either the detector or USD attacks are performed individually as commented earlier. Notice that this condition also applies to the case where Eve simultaneously uses USD and detector blinding in order to attempt faking Alice and Bob s weak measurement results. This is because the local unitaries and that have been applied to each photon are never publicly revealed.

Therefore Eve does not know the correct conditional averages in order to successfully fake Alice s or Bob s conditional weak measurement results. Assuming that Eve does not have control or influence over the unitaries or one can recognize that the conditional statistics of Alice and Bob yields a fair representation of the quantum channel. Thus the most conservative approach in estimating Eve s access to the raw key is by assuming that the attenuation of the statistics are due to disturbance by Eve. In this manner one has replaced the fair sampling assumption required by the original BB84 protocol with the assumption that the two local unitary operations applied by Alice and Bob are unknown and uninfluenced by Eve.

Assuming that Eve s attack strategy is independent of the basis in which the qubits are encoded then the quantum channel from Alice to Bob is a depolarizing channel with probability of error p. One can also know from the calculation above that for a depolarizing channel the generalized weak values of the observables for Alice and Bob in the cases where the pre and post selection are in different bases are given by 1 2 0 . 52 Therefore the shift in the conditional mean values of Alice and Bob s associated weak measurements is 1 2 0 . 53 To estimate the probability of error due to Eve s presence i.e. the channel s QBER one can use the magnitude of the observed conditional weak measurements as compared to the case with no errors 

From this estimate of the channel s bit error rate one can then utilize recent results generalizing entropic uncertainty relations to smooth entropies to estimate the maximum length of extractable secure key available to Alice and Bob via privacy amplification and error correction as reported by M. Tomamichel et al. Uncertainty Relation for Smooth Entropies 106 110506 2011 preprint at http arxiv.org pdf 1009.2015v3.pdf further concluding that for the BB84 protocol the secure key length is given by 21 2 57 where h is the Shannon entropy of the channel and is the maximum fraction of raw key bits of the sifted key for which Alice and Bob s bases disagree.

The value of can be determined directly from the observed values for the various pre and post selected ensemble as calculated by Alice and Bob. Defining the minimum of the pointer shifts over the various preand post selected ensembles of both Alice and Bob to be and assuming that the state of the weak measurement pointers are Gaussian wavefunctions with unit variance one can calculate by specifying a tolerance for the pointer shift estimate. This tolerance in turn determines the maximum fraction of errors in the raw key transmitted via the quantum channel 

More generally if Eve should use an attack strategy that does depend on the qubit basis Alice and Bob would observe different attenuation factors for their various pre and post selected ensembles. This is because there would be different error probabilities depending on the pre selection or post selection bases. The analysis above should then be applied to all pre and post selection subensembles individually with the protocol aborting if any of them indicate an error rate above the security threshold.

One should recognize that the analysis above applies not only to the usual eavesdropping on the quantum channel but also to attacks where Eve performs detector blinding control and or state discrimination based hacking. In the case when Eve performs both USD and detector attacks Eve could know to which pre and post selection ensemble each photon belongs only if she also knows the correct unitary operator applied to each photon by Alice and Bob. Without knowledge of the sequence of unitaries Eve cannot separate the photons into the correct pre and post selected ensembles and thus she will not know how to correctly bias each weak measurement result. Therefore even if Eve could reliably control the weak measurement pointer results of both Alice and Bob she would be not able to avoid detection and break the protocol s security.

Finally the effect of the weak measurements themselves on the quantum channel can be further annotated. Because the key length is necessarily finite and the weak coupling will be non zero there will be a small amount of quantum channel noise due solely to the weak measurements. This noise will manifest itself as a depolarizing channel with error probability pgiven in general by 

With the spin observables used in the protocol and Gaussian weak measurement pointers with unit variance this error probability simplifies to 

VI. Summary This disclosure describes a version of BB84 that has been augmented with a procedure to test for the presence of Eve that for a sufficiently long raw key block length is secure even when Eve has complete control of Bob s detectors and control of the required weak measurements. Therefore the exemplary protocol closes the fair sampling assumption inherent in BB84 as well as similar QKD protocols as implemented in practical QKD systems.

The ability to protect against all faked state attacks without regard to the particular methods that Eve might use is a particularly desirable feature of the protocol. In addition the exemplary protocol requires relatively minimal changes to existing BB84 systems. Implementation of the necessary weak measurements can be accomplished by weakly coupling another observable of each photon to the particular observable used to encode the key in the BB84 protocol. For example for phase encoded implementations the photon s polarization can be used as a pointer for the weak measurement and vice versa for a polarization encoded protocol.

The process can also be generalized to the complete Mutually Unbiased Basis MUB six state protocol. The main difference for the six state protocol is that in the case where the observable being weakly measured is not diagonal in either Alice s or Bob s bases the weak value is purely imaginary. In order to observe the imaginary weak value the weak measurement pointer must be measured in the conjugate basis. To provide experimental access to both the real and imaginary parts of the weak value for all qubits Alice and Bob could weakly measure the required observable with two independent pointer systems and then projectively measure each in conjugate momentum and position bases. Further details are available in the dissertation Quantum Weak Values and Time Symmetry Foundations and Applications as publication NSWCDD MP 140035 incorporated by reference in its entirety.

From these pairs of weak measurement results both the real and imaginary components of the weak values could be used to detect an eavesdropper. This weak measurement strategy could also be used to generalize the qubit protocols to higher dimensional qudit two basis and complete MUB QKD protocols. A complete MUB qudit protocol could be especially interesting due to the very large as compared to qubits amount of channel information extracted per physical signal received and the increased sensitivity of that channel information to an eavesdropper s intervention. A full characterization and security analysis of the qudit versions of the weak value protocol will be the subject of a forthcoming article.

The use of weak measurements to characterize the properties of quantum channels and quantum states in situ is an emerging area of research in quantum foundations and quantum information science. Utilizing weak measurements to directly measure and monitor the characteristics of the quantum channel in quantum communication systems is a natural and potentially important application of this exemplary technique. This work was supported by a grant from the Naval Surface Warfare Center Dahlgren Division In house Laboratory Independent Research Program and the Naval Innovative Science and Engineering program.

While certain features of the embodiments of the invention have been illustrated as described herein many modifications substitutions changes and equivalents will now occur to those skilled in the art. It is therefore to be understood that the appended claims are intended to cover all such modifications and changes as fall within the true spirit of the embodiments.

