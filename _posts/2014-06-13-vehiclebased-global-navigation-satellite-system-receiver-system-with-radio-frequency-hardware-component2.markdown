---

title: Vehicle-based global navigation satellite system receiver system with radio frequency hardware component
abstract: A vehicle-based radio frequency (RF) hardware component comprises first and second antennas, a digitizer, a serializer, and a serial output. The first antenna receives, over-the-air, a first analog Global Navigation Satellite System (GNSS) signal in a first frequency band. The second antenna receives, over-the-air, at least a second analog GNSS signal in a second frequency band, wherein the first frequency band and the second frequency band are separate and distinct. The digitizer digitizes the first analog GNSS signal into a first digitalized GNSS signal and digitizes the second analog GNSS signal into a second digitized GNSS signal. The serializer serializes the digitized GNSS signals into a serialized output signal. The serial output communicatively couples the digitized GNSS signals, as the serialized output signal, directly from a location in a vehicle of the radio frequency hardware component to a separate communication device that is also coupled with the vehicle.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09645248&OS=09645248&RS=09645248
owner: Trimble Inc.
number: 09645248
owner_city: Sunnyvale
owner_country: US
publication_date: 20140613
---
This application claims priority and is a continuation in part application of co pending U.S. patent application Ser. No. 14 134 437 filed on Dec. 19 2013 entitled GNSS RECEIVER POSITIONING SYSTEM by Rudow et al. and assigned to the assignee of the present application.

Application Ser. No. 14 134 437 filed on Dec. 19 2013 claims priority and is a continuation in part application of U.S. patent application Ser. No. 14 035 884 filed on Sep. 24 2013 now U.S. Pat. No. 9 369 843 entitled EXTRACTING PSEUDORANGE INFORMATION USING A CELLULAR DEVICE by Rudow et al. and assigned to the assignee of the present application and to the extent not repeated herein.

Application Ser. No. 14 134 437 filed on Dec. 19 2013 also claims priority to and benefit of U.S. Provisional Patent Application No. 61 746 916 filed on Dec. 28 2012 entitled IMPROVED GPS GNSS ACCURACY FOR A CELL PHONE by Rudow et al.

Application Ser. No. 14 035 884 filed on Sep. 24 2013 now U.S. Pat. No. 9 369 843 claims priority to and is a continuation in part to patent application Ser. No. 13 842 447 filed on Mar. 15 2013 now U.S. Pat. No. 9 429 640 entitled OBTAINING PSEUDORANGE INFORMATION USING A CELLULAR DEVICE by Richard Rudow et al. and assigned to the assignee of the present application.

This application is related to U.S. patent application Ser. No. 14 304 822 filed on Jun. 13 2014 entitled GLOBAL NAVIGATION SATELLITE SYSTEM RECEIVER SYSTEM WITH RADIO FREQUENCY HARDWARE COMPONENT by Gregory C. Wallace et al. assigned to the assignee of the present application.

The Global Positioning System GPS and its extensions in the Global Navigation Satellite Systems GNSS have become thoroughly pervasive in all parts of human society worldwide. GPS and GNSS receivers in the form of chipsets have become widely incorporated into cell phones and other types of cellular devices with cellular based communications equipment.

Typically many communication devices such as cellular devices tablet computers and two way radios include highly integrated GNSS chipsets. In some instances these integrated GNSS chipsets are designed to work with the E 911 service primarily. In most instances these integrated GNSS chipsets are not designed to provide anywhere near a full range of features and outputs that may be available in special purpose GNSS receiver. Furthermore when communication devices implementing integrated GNSS capabilities are used they can exhibit reduced performance in positioning accuracy for a variety of reasons.

Reference will now be made in detail to various embodiments of the subject matter examples of which are illustrated in the accompanying drawings. While various embodiments are discussed herein it will be understood that they are not intended to limit to these embodiments. On the contrary the presented embodiments are intended to cover alternatives modifications and equivalents which may be included within the spirit and scope the various embodiments as defined by the appended claims. Furthermore in the following Description of Embodiments numerous specific details are set forth in order to provide a thorough understanding of embodiments of the present subject matter. However embodiments may be practiced without these specific details. In other instances well known methods procedures components and circuits have not been described in detail as not to unnecessarily obscure aspects of the described embodiments.

Unless specifically stated otherwise as apparent from the following discussions it is appreciated that throughout the description of embodiments discussions utilizing terms such as accessing transmitting extracting using smoothing correcting creating storing determining disposing and coupling to transform the state of a computer system using a software defined GNSS receiver operating on a processor decoding performing carrier phase interferometry or the like refer to the actions and processes of a computer system data storage system storage system controller microcontroller hardware processor or similar electronic computing device or combination of such electronic computing devices. The computer system or similar electronic computing device manipulates and transforms data represented as physical electronic quantities within the computer system s device s registers and memories into other data similarly represented as physical quantities within the computer system s device s memories or registers or other such information storage transmission or display devices.

Communication devices include electronic devices such as cellular devices tablet computers and two way radios. They may be vehicle based hand holdable by a human or in some instances may be wearable such as embedded all or partially in human headwear clothing or accessories eyewear rings jewelry or the like . Many of these communications devices have imbedded GNSS receivers which have inherent limitations on their performance due to being very low end receivers being capable of receiving only a limited set of signals over the air and or being unable to process corrections to the signals that are received. Some of these communication devices do not have imbedded GNSS receivers. These communications devices have other processors such as central host processors microprocessors digital signal processors and or graphics processors for running other functions and none of these are not involved in the internal operations of the GNSS chipset if present . Herein a radio frequency hardware component is described. In various embodiments the radio frequency hardware component may be integrated with a communication device or may be a stand alone radio frequency hardware component that can be removably communicatively coupled with communication device. For example the coupling may be via a universal serial bus or other protocol suitable for coupling digitized information over an extremely short distance of that is less that approximately 7 meters and often less than three centimeters. The radio frequency hardware component includes a plurality of antennas that are used to receive at least an L1 and an L2C GNSS signal and then transmit them to a communications device. The communication device is configured with a software defined GNSS receiver Soft GNSS receiver that runs as software on a processor which is not a part of a GNSS chipset. The Soft GNSS running on the processor decodes the GNSS signals and employs carrier phase interferometry to correct for ionospheric perturbations to the GNSS signals while determining a position fix associates with the GNSS antennas. A variety of techniques may be used by the Soft GNSS receiver to smooth or correct pseudoranges that are extracted from these GNSS signals. Many such techniques are described herein and may be employed.

As depicted in the cellular device includes a GNSS chipset a GNSS receiver a processor that is part of the GNSS receiver a chipset accessor logic a pseudorange information extractor logic an improved accuracy Secure User Platform Location SUPL client a pseudorange information bridger logic a pseudorange information processing logic an operating system a location manager logic a location displayer logic hardware that is outside of the GNSS receiver . According to one embodiment the chipset accessor logic the pseudorange information extractor logic the pseudorange information processing logic and the pseudorange information bridger logic are a part of the improved accuracy SUPL client .

According to one embodiment the hardware includes a hardware processor and memory . An example of a hardware processor is a central processing unit. An example of hardware memory is computer readable storage such as but not limited to a disk a compact disk CD a digital versatile device DVD random access memory RAM or read only memory ROM . The hardware memory is physical and therefore tangible according to one embodiment. The hardware memory according to another embodiment is non transitory.

According to one embodiment the processor and the GNSS receiver are a part of the GNSS chipset . According to one embodiment the chipset accessor logic pseudorange information extractor logic the pseudorange information bridger logic the improved accuracy SUPL client the operating system and the processor are located in a portion of the cellular device that is outside of the GNSS chipset . The location manager logic can be a part of the operating system and external to the GNSS chipset . According to one embodiment the location displayer logic is a part of the location manager logic . According to one embodiment the chipset accessor logic pseudorange information extractor logic the pseudorange information processing logic pseudorange information bridger logic and improved accuracy SUPL client are application programming interfaces API function applications that reside in memory of the cellular device and are executed by a processor of the cellular device .

According to one embodiment the GNSS receiver is capable of receiving signals from GPS satellites GLONASS satellites or from a combination of satellites from different constellations. The GNSS receiver can perform GPS measurements to derive raw measurement data for a position of the cellular device . The raw measurement data can provide an instant location of the cellular device . According to one embodiment the raw measurement data is the pseudorange information that is extracted also referred to as extracted pseudorange information . Examples of the extracted pseudorange information are uncorrected pseudorange information observed pseudorange information or unsmoothed pseudorange information or a combination thereof. Conventionally the raw measurement data is only for use by the GNSS chipset and the GNSS chipset calculates pseudorange information that is only for use by the GNSS chipset . Examples of pseudorange information are uncorrected pseudorange information smoothed pseudoranges and corrected pseudoranges. Examples of corrections used to improve accuracy of a position fix include differential GNSS corrections DGPS high precision GNSS satellite orbital data GNSS satellite broadcast ephemeris data and ionospheric and tropospheric error corrections and error projections based on location.

The GNSS chipset has a processor and therefore is capable of processing information such as pseudorange information itself. However according to various embodiments information that the GNSS chipset has can be extracted from the GNSS chipset and processed outside of the GNSS chipset instead of by the GNSS chipset using its own processor in order to provide an improved accuracy position fix.

The chipset accessor logic is configured for accessing the GNSS chipset . The pseudorange information extractor logic is configured for extracting the pseudorange information from the accessed GNSS chipset . The extracted pseudorange information can be received and stored continuously. The pseudorange information bridger logic is configured for bridging the pseudorange information from the GNSS chipset to the location manager logic that resides in the operating system of the cellular device .

According to one embodiment the chipset accessor logic the pseudorange information extractor logic the pseudorange information processing logic and pseudorange information bridger logic are a part of an improved accuracy SUPL client . For example The SUPL client can interface between the GNSS chipset and the location manager logic which resides in the operating system .

The pseudorange information can be obtained from the processor of the GNSS receiver . The GNSS chipset may be designed for example by the manufacturer of the GNSS chipset to provide requested information such as pseudorange information in response to receiving the command. The pseudorange information may be extracted from the GNSS chipset using the command that the manufacturer has designed the GNSS chipset with. For example according to one embodiment the GNSS chipset is accessed using an operation that is a session started with a message that is an improved accuracy Secure User Platform Location SUPL start message or a high precision SUPL INIT message. According to one embodiment the message is a custom command that is specific to the GNSS chipset also referred to as a GNSS chipset custom command and by which the improved accuracy SUPL client can gain access to the raw measurements of the GNSS chipset . Access may be controlled by the chipset manufacturer and a suitable key made available for use in the SUPL for obtaining access to the pseudoranges. A suitable key is an example of a custom command. 

A worker thread associated with the SUPL client can monitor the raw measurements delivered by the GNSS chipset into the GNSS chipset s memory buffers cache the raw measurements and use the raw measurements to determine a position fix. The pseudorange information extractor logic and the pseudorange information processing logic can be associated with the worker thread. For example the pseudorange information extractor logic can cache the raw measurements and the pseudorange information processing logic can determine the location.

According to one embodiment a worker thread is a light weight process that executes a specific sequence of tasks in the background. The tasks can be of long term and or at times periodic in nature. The worker thread can assist in helping the main thread which may also be referred to as the main program or main task with specific functions. Worker threads can be started when these functions of the sequence of tasks are to be executed. A worker thread can remain in the active state as long as its respective functions are being executed. A worker thread may terminate itself when it completes its functions or when it reaches a point where it can no longer continue to function for example due to an irrecoverable error. A worker thread can post its status to the main thread when it ends. Examples of posted status are completion or termination. A worker thread may also post to the main thread the level of progress of its functions periodically. At a given point in time there may be many such worker threads in progress at the same time. Worker threads may maintain some sort of synchronization amongst themselves depending upon the tasks they are intended for. The main thread may terminate a worker thread for example when the functions of that worker thread are no longer needed or due to other execution changes in the system.

According to one embodiment the cellular device can improve the accuracy of the extracted pseudorange information. For example the pseudorange information processing logic can improve the accuracy of the extracted pseudorange information as will become more evident.

The output of the pseudorange information processing logic can be used for determining the location of the cellular device . For example a latitude longitude and altitude can be determined based on the output of the pseudorange information processing logic which can be displayed by the location displayer logic .

According to one embodiment the pseudorange information bridger logic communicates the output from the pseudorange information processing logic to the location manager logic in the operating system . According to one embodiment the output of the pseudorange information processing logic is a location that is defined in terms of latitude longitude and altitude. The methods are well known in the GPS arts. The pseudoranges are used to first determine a location the WGS 84 coordinate system of the Global Positioning System and then converted into latitude longitude and elevation.

The location displayer logic can display the location with respect to a digital representation of a map available for example from third parties via download to the cellular device.

Some non limiting examples of satellite based augmentation system SBAS are Indian GPS aided Geo Augmented Navigation System GAGAN European Geostationary Navigation Overlay Service EGNOS Japanese Multi functional Satellite Augmentation System MSAS StarFire a trademark of John Deere Company for GNSS receivers WAAS and OmniSTAR a trademark of Trimble Navigation Limited for subscription services of differential GNSS solutions and the like.

As depicted in the pseudorange information processing logic includes pseudorange correction logic pseudorange carrier phase smoothing logic position accuracy improvement determination logic B and determining position fix logic B. Examples of improving are smoothing or correcting or a combination thereof. The pseudorange correction logic includes WAAS logic A DGPS logic B Precise Point Positioning PPP logic C RTK logic D VRS Virtual Reference Station logic E and RTX logic F. The pseudorange carrier phase smoothing logic includes real carrier phase logic A and reconstructed carrier phase logic B. According to one embodiment the accessing logic B and the processing logic reside in the improved accuracy SUPL client .

Examples of pseudorange information are extracted pseudoranges corrected pseudoranges smoothed pseudoranges or a combination thereof among other things. Examples of pseudorange corrections include Wide Area Augmentation System WAAS corrections Differential Global Positioning System DGPS corrections Precise Point Positioning PPP corrections Real Time Kinematic RTK corrections and Virtual Reference Station VRS corrections. Examples of carrier phase information include real carrier phase and reconstructed carrier phase information.

The extracting logic B can extract various types of information from the GNSS chipset as discussed herein. For example the extracting logic B includes pseudorange information extracting logic WAAS extracting logic B Doppler extracting logic B and carrier phase measurement extracting logic B . According to one embodiment the extracting logic B can be used to extract these various types of information from the GNSS chipset in a similar manner that the pseudorange information extractor logic extracts pseudorange information from the GNSS chipset for example using an SUPL Client that employs a command designed or provided by the manufacturer of the GNSS chipset as described herein. More specifically the WAAS extracting logic B the Doppler extracting logic B and carrier phase measurement extracting logic B can employ commands designed or provided by the manufacturer of the GNSS chipset to extract respectively WAAS Doppler information and carrier phase measurements for real carrier phase information.

The receiving logic B receives other types of information that are not extracted from the GNSS chipset . The receiving logic B can receive the information in response to a request also commonly known as pulling or receive the information without the information being requested also commonly known as pushing . Obtaining and accessing can be used interchangeably according to various embodiments.

Table 1 depicts the types of information that are extracted from the GNSS chipset or received without extraction as discussed herein according to various embodiments.

The information depicted in the extracted column can be extracted from the GNSS chipset using the SUPL client in a manner similar to extracting pseudorange information as discussed herein. WAAS may be extracted or received for example over the Internet. When this Doppler shift information is available but real carrier phase information is not the extracted Doppler shift information can be integrated by processor for example to reconstruct carrier phase information. Techniques for reconstructing carrier phase information from Doppler shift information are well known in the art. Any one or more of the information depicted in Table 1 can be processed by the cellular device for example using the processor that is outside of the GNSS chipset .

The pseudorange carrier phase smoothing logic can smooth pseudorange information by applying carrier phase information to the pseudorange information.

The pseudorange carrier phase smoothing logic receives raw pseudorange information from the accessing logic B. The carrier phase information may be reconstructed carrier phase information or real carrier phase information.

The pseudorange correction logic can correct pseudorange information. For example the pseudorange correction logic can receive pseudorange information and apply pseudorange corrections to the pseudorange information. Examples of the pseudorange information received by the pseudorange correction logic include extracted pseudorange information DGPS corrected pseudoranges and smoothed pseudoranges that were smoothed for example using either real carrier phase information or reconstructed carrier phase information. Examples of pseudorange corrections that can be applied to the received pseudorange information are WAAS corrections DGPS corrections PPP corrections RTK corrections and VRS corrections. The PPP logic C performs Precise Point Positioning PPP processing on pseudorange information. According to one embodiment RTX a trademark of Trimble Navigation Limited for satellite delivered correction services is proprietary form of PPP developed by Trimble Navigation Limited. It should be appreciated that there are other forms of Precise Point Positioning which may operate using similar principles.

The pseudorange information processing logic may also include a determining position fix logic B that performs for example a least squares solution B can be performed after the extracted pseudorange information is improved by the pseudorange correction logic or the pseudorange carrier phase smoothing logic or a combination thereof and prior to transmitting the output to the pseudorange information bridger logic . According to one embodiment the determining position fix logic B resides in the processing logic . Least squares solution methods are well known in the position determination arts.

According to one embodiment extracted pseudorange information is passed from the pseudorange information extractor logic to the smoothing logic where it is smoothed at either real carrier phase logic A or reconstructed carrier phase logic B. According to one embodiment the smoothed pseudorange information is communicated from the smoothing logic to the correcting logic for further correction where one or more corrections may be performed. If a plurality of corrections is performed they can be performed in various combinations. If carrier phase smoothing is not possible the extracted pseudorange information can be communicated from pseudorange information extractor logic to correction logic . One or more of the logics A B A E F in the processing logic can communicate with any one or more of the logics A B A E F in various orders and combinations. Various embodiments are not limited to just the combinations and orders that are described herein. According to one embodiment extracted pseudorange information may not be smoothed or corrected. In this case unsmoothed uncorrected pseudorange information can be communicated from logic to logic B.

The cellular device may also include a position accuracy improvement determination logic B for determining whether to apply any improvements and if so the one or more position accuracy improvements to apply to the extracted pseudorange information. For example the cellular device may be preconfigured based on the signals that are available to the cellular device or a user of the cellular device may manually configure the cellular device . For example the cellular device can display the signals that are available to the user and the user can select which signals they desire from the displayed list of signals. The configuration information whether preconfigured or manually configured by the user can be stored for example in a look up table in the cellular device . Examples of position improvements that can be determined by the position accuracy improvement determination logic B are real carrier phase information reconstructed carrier phase information WAAS DGPS PPP RTX RTK and VRS. The position accuracy improvement determination logic B can be used to determine to reconstruct carrier phase information based on Doppler shift if real carrier phase information is not available for example. The position accuracy improvement determination logic B according to one embodiment is a part of the SUPL client .

Extracted pseudorange information without any additional improvements provides 4 5 meters of accuracy. Various combinations of position accuracy improvements can be applied to extracted pseudorange information EPI according to various embodiments where examples of position accuracy improvements include but are not limited to Wide Area Augmentation System WAAS pseudorange corrections Differential GPS DGPS pseudorange corrections Precise Point Positioning PPP processing RTX Real Time Kinematic RTK Virtual Reference Station VRS corrections real carrier phase information real CPI smoothing and reconstructed carrier phase information reconstructed CPI smoothing.

One or more of the logics B B B B B B A B Aj F B B can be executed for example by the processor of the cellular device that is located outside of the GNSS chipset .

Table 2 depicts combinations of information that result in a position fix B according to various embodiments. However various embodiments are not limited to the combinations depicted in Table 2.

According to one embodiment a first position is determined by an available means. For example the first position may be based on uncorrected unsmoothed extracted pseudorange information cellular tower triangulation Wi Fi Wireless Fidelity triangulation or other means. A level of precision may be selected for example by a user or preconfigured into the cellular device where DGPS or one or more of SBAS WAAS RTX PPP would be used to achieve that level of precision. The decision logic H can access the level of precision and receive two or more reference station locations by sending a message to a database enquiring about nearby reference stations for DGPS. The decision logic H can determine the distance between the cellular device and the nearest reference station. If the distance is greater than some selected distance threshold the decision logic H can use PPP RTX SBAS or WAAS instead of DGPS. If the distance is less than the selected distance threshold the decision logic H can use DGPS instead of PPP RTX SBAS or WAAS. According to one embodiment a range for a distance threshold is approximately 20 to 60 miles. According to one embodiment the distance threshold is approximately 60 miles.

If the decision logic H determines to apply DGPS corrections at DGPS logic B resulting in DGPS corrected smoothed pseudoranges further corrections can be made using the orbit clock information contained in the PPP corrections. For example a position fix can be determined based on the DGPS corrected smoothed pseudoranges and the PPP corrections. The position fix can be determined external to the GNSS chipset for example at the processing logic .

The cellular device may be configured with the distance threshold for example by the manufacturer of the cellular device or by a user of the cellular device . The cellular device may be configured with the distance threshold through service that is remote with respect to the cellular device or may be configured locally. The distance threshold can be selected based on a degree of position accuracy that is desired.

As described herein various information can be extracted from the GNSS receiver such as pseudorange information Doppler Shift Information Real Carrier Phase Measurement WAAS and SBAS. Other types of processing information output by the GNSS receiver can be ignored.

A Cell device D s hardware architecture includes discreet physical layout and interconnection of multiple chipsets for processing and for special purposes such as a GNSS chipset . In addition newer architectures involve further integration of chipsets in the system on a chip SoC configuration. In this configuration the GNSS chipset can still be a complete element capable of delivering a PVT position velocity and time solution. However in an embodiment the pseudorange information carrier phase and or Doppler measurements along with WAAS corrections if available are extracted prior to further signal processing in the GNSS chipset and are processed using different algorithms and corrections data for developing an improved accuracy PVT solution. In so doing the deleterious effects of multipath and other error sources may be minimized. Further the GNSS chipset outputs are ignored and not displayed when the external processing is employed and the higher accuracy PVT data is available.

The cellular device includes a bus a satellite receiver a GNSS receiver an FM radio receiver a processor memory a cellular transceiver a display audio Wi Fi transceiver IMU image capturing device and operating system . Components and are all connected with the buss .

In a plurality of broadcast sources is used to convey data and media to a cellular device . As an example cellular device can receive broadcast signals from communication satellites e.g. two way radio satellite based cellular such as the Inmarsat or Iridium communication networks etc. global navigation satellites which provide radio navigation signals e.g. the GPS GNSS GLONASS GALILEO BeiDou Compass etc. and terrestrial radio broadcast e.g. FM radio AM radio shortwave radio etc. .

A cellular device can be configured with a satellite radio receiver coupled with a communication bus for receiving signals from communication satellites a GNSS receiver coupled with bus for receiving radio navigation signals from global navigation satellites and for deriving a position of cellular device based thereon. Cellular device further comprises an FM radio receiver coupled with bus for receiving broadcast signals from terrestrial radio broadcast . Other components of cellular device comprise a processor coupled with bus for processing information and instructions a memory coupled with bus for storing information and instructions for processor . It is noted that memory can comprise volatile memory and non volatile memory as well as removable data storage media in accordance with various embodiments. Cellular device further comprises a cellular transceiver coupled with bus for communicating via cellular network . Examples of cellular networks used by cellular device include but are not limited to GSM cellular networks GPRS cellular networks GDMA cellular networks and EDGE cellular networks. Cellular device further comprises a display coupled with bus . Examples of devices which can be used as display include but are not limited to liquid crystal displays LED based displays and the like. It is noted that display can be configured as a touch screen device e.g. a capacitive touch screen display for receiving inputs from a user as well as displaying data. Cellular device further comprises an audio output coupled with bus for conveying audio information to a user. Cellular device further comprises a Wi Fi transceiver and an inertial measurement unit IMU coupled with bus . Wi Fi transceiver may be configured to operate on in compliance with any suitable wireless communication protocol including but not limited to Wi Fi WiMAX implementations of the IEEE 802.11 specification implementations of the IEEE 802.15.4 specification for personal area networks and a short range wireless connection operating in the Instrument Scientific and Medical ISM band of the radio frequency spectrum in the 2400 2484 MHz range e.g. implementations of the Bluetooth standard a trademark of Bluetooth Special Interest Group SIG for short range wireless connectivity standard .

Improvements in GNSS GPS positioning may be obtained by using reference stations with a fixed receiver system to calculate corrections to the measured pseudoranges in a given geographical region. Since the reference station is located in a fixed environment and its location can be determined very precisely via ordinary survey methods a processor associated with the Reference Station GNSS GPS receivers can determine more precisely what the true pseudoranges should be to each satellite in view based on geometrical considerations. Knowing the orbital positions via the GPS almanac as a function of time enables this process first proposed in 1983 and widely adopted ever since. The difference between the observed pseudorange and the calculated pseudorange for a given Reference station is called the pseudorange correction. A set of corrections for all the global navigation satellites in view is created second by second and stored and made available as a service utilizing GPS GNSS reference stations and correction services . The pseudoranges at both the cellular device GPS receiver and those at the reference stations are time tagged so the corrections for each and every pseudorange measurement can be matched to the local cell phone pseudoranges. The overall service is often referred to as Differential GPS or DGPS. Without any corrections GNSS GPS receivers produce position fixes with absolute errors in position on the order of 4.5 to 5.5 m per the GPS SPS Performance Standard 4Ed. 2008. In one or more correction services convey these corrections via a cellular network or the Internet . Internet is in turn coupled with a local Wi Fi network which can convey the corrections to cellular device via Wi Fi transceiver . Alternatively cellular network can convey the corrections to cellular device via cellular transceiver . In some embodiments correction services are also coupled with a distribution service which conveys the corrections to an FM radio distributor . FM radio distributor can broadcast corrections as a terrestrial radio broadcast . It should be appreciated that an FM signal is being described as a subset of possible terrestrial radio broadcasts which may be in a variety of bands and modulated in a variety of manners. In some embodiments cellular device includes one or more integral terrestrial radio antennas associated with integrated terrestrial receivers FM radio receiver is one example of such a terrestrial receiver which would employ an integrated antenna designed to operate in the correct frequency band for receiving a terrestrial radio broadcast . In this manner in some embodiments cellular device can receive the corrections via FM radio receiver or other applicable type of integrated terrestrial radio receiver . In some embodiments correction services are also coupled with a distribution service which conveys the corrections to a satellite radio distributor . Satellite radio distributor can broadcast corrections as a broadcast from one or more communications satellites . In some embodiments cellular device includes one or more integral satellite radio antennas associated with integrated satellite radio receivers . Satellite radio receiver is one example of such a satellite receiver which would employ an integrated antenna designed to operate in the correct frequency band for receiving a corrections or other information broadcast from communication satellites . In this manner in some embodiments cellular device can receive the corrections via satellite radio receiver .

Examples of a correction source that provides pseudorange corrections are at least correction service FM radio distribution or satellite radio distributor or a combination thereof. According to one embodiment a correction source is located outside of the cellular device .

Examples of image capturing device are a camera a video camera a digital camera a digital video camera a digital camcorder a stereo digital camera a stereo video camera a motion picture camera and a television camera. The image capturing device may use a lens or be a pinhole type device.

The blocks that represent features in can be arranged differently than as illustrated and can implement additional or fewer features than what are described herein. Further the features represented by the blocks in can be combined in various ways. A cellular device can be implemented using software hardware hardware and software hardware and firmware or a combination thereof. Further unless specified otherwise various embodiments that are described as being a part of the cellular device whether depicted as a part of the cellular device or not can be implemented using software hardware hardware and software hardware and firmware software and firmware or a combination thereof. Various blocks in refer to features that are logic such as but not limited to B A B A G B which can be implemented using software hardware hardware and software hardware and firmware software and firmware or a combination thereof.

The cellular device according to one embodiment includes hardware such as the processor memory and the GNSS chipset . An example of hardware memory is a physically tangible computer readable storage medium such as but not limited to a disk a compact disk CD a digital versatile device DVD random access memory RAM or read only memory ROM for storing instructions. An example of a hardware processor for executing instructions is a central processing unit. Examples of instructions are computer readable instructions for implementing at least the SUPL Client that can be stored on a hardware memory and that can be executed for example by the hardware processor . The SUPL client may be implemented as computer readable instructions firmware or hardware such as circuitry or a combination thereof.

A GNSS receiver also referred to as a receiver according to various embodiments makes a basic measurement that is the apparent transit time of the signal from a satellite to the receiver which can be defined as the difference between signal reception time as determined by the receiver s clock and the transmission time at the satellite as marked in the signal. This basic measurement can be measured as the amount of time shift required to align the C A code replica generated at the receiver with the signal received from the satellite. This measurement may be biased due to a lack of synchronization between the satellite and receiver clock because each keeps time independently. Each satellite generates a respective signal in accordance using a clock on board. The receiver generates a replica of each signal using its own clock. The corresponding biased range also known as a pseudorange can be defined as the transit time so measured multiplied by the speed of light in a vacuum.

There are three time scales according to one embodiment. Two of the time scales are the times kept by the satellite and receiver clocks. A third time scale is a common time reference GPS Time GPST also known as a composite time scale that can be derived from the times kept by clocks at GPS monitor stations and aboard the satellites.

Let be the transit time associated with a specific code transition of the signal from a satellite received at time t per GPST. The measured apparent range r called pseudorange can be determined from the apparent transmit time using equation 1 as follows measured pseudorange at arrival time at emission time at . Eq. 1 Both t and are unknown and can be estimated. In this discussion of pseudoranges measurements from a GPS satellite are dealt with in a generic way to make the notation simple making no reference to the satellite ID or carrier frequency L1 or L2 .

Equations 2 and 3 depict how to relate the time scales of the receiver and the satellite clocks with GPST arrival time at receiver clock at eq. 2 arrival time at satellite clock error at eq. 3

where receiver clock error represents the receiver s clock bias and satellite clock error represents the bias in the satellite s clock and both the receiver clock and the satellite clock are measured relative to GPST as shown in . Receiver clock error and satellite clock error represent the amounts by which the satellite and receiver clocks are advanced in relation to GPST. The satellite clock error is estimated by the Control Segment and specified in terms of the coefficients of a quadratic polynomial in time. The values of these coefficients can be broadcast in the navigation message.

Accounting for the clock biases the measured pseudorange eq. 1 can be written as indicated in equation 4 receiver clock error at satellite clock error at miscellaneous errors at receiver clock errors at satellite clock error at miscellaneous errors at eq. 4 where miscellaneous errors represent unmodeled effects modeling error and measurement error. The transmit time multiplied by the speed of light in a vacuum can be modeled as satellite position at t . Ionosphere error and troposphere error reflect the delays associated with the transmission of the signal respectively through the ionosphere and the troposphere. Both ionosphere error and troposphere error are positive.

For simplicity explicitly reference to the measurement epoch t has been dropped and the model has been rewritten for the measured pseudorange as indicated in equation 5. receiver clock error satellite clock error ionosphere error troposphere error miscellaneous errors eq. 5 where PR is the measured pseudorange r is the true range from the receiver to the satellite receiver clock error is the difference between the receiver clock and the GPSTIME satellite clock error is the difference between the satellite clock and GPSTIME GPSTIME is ultimately determined at the receiver as part of the least squared solution determined by the least squares solution B so that all clock errors can be resolved to some level of accuracy as part of the position determination process and miscellaneous errors include receiver noise multipath and the like.

At least one source of error is associated with satellite positions in space. The navigation message in the GPS signal contains Keplerian parameters which define orbital mechanics mathematics and thus the positions of the satellites as a function of time. One component of WAAS and RTX contains adjustments to these parameters which form part of the constants used in solving for the position fix at a given time. Taking account of the corrections is well known in the GPS position determining arts.

Ideally the true range r to the satellite is measured. Instead what is available is PR the pseudorange which is a biased and noisy measurement of r. The accuracy of an estimated position velocity or time which is obtained from these measurements depends upon the ability to compensate for or eliminate the biases and errors.

The range to a satellite is approximately 20 000 kilometers km when the satellite is overhead and approximately 26 000 km when the satellite is rising or setting. The signal transit time varies between about 70 millisecond ms and 90 ms. The C A code repeats each millisecond and the code correlation process essentially provides a measurement of pseudo transmit time modulo 1 ms. The measurement can be ambiguous in whole milliseconds. This ambiguity however is easily resolved if the user has a rough idea of his location within hundreds of kilometers. The week long P Y code provides unambiguous pseudoranges.

The receiver clocks are generally basic quartz crystal oscillators and tend to drift. The receiver manufacturers attempt to limit the deviation of the receiver clock from GPST and schedule the typical once per second measurements at epochs that are within plus or minus 1 millisecond ms of the GPST seconds. One approach to maintaining the receiver clock within a certain range of GPST is to steer the receiver clock continuously. The steering can be implemented with software. The second approach is to let the clock drift until it reaches a certain threshold typically 1 ms and then reset it with a jump to return the bias to zero.

An example of pseudorange measurements with a receiver using the second approach shall now be described in more detail. Assume that there are pseudorange measurements from three satellites which rose about the same time but were in different orbits. Assume that one comes overhead and stays in view for almost seven hours. Assume that the other two stay lower in the sky and could be seen for shorter periods. There are discontinuities common to all three sets of measurements due to the resetting of the receiver clock. A determination can be made as to whether the receiver clock is running fast or slow and its frequency offset from the nominal value of 10.23 megahertz MHz can be estimated.

For more information on pseudorange information refer to Global Positioning Systems by Pratap Misra and Per Enge Ganga Jamuna Press 2001 ISBN 0 9709544 0 9.

The pseudorange information processing logic can include various types of logic for improving the position accuracy of the extracted pseudorange information as described herein. Table 2 as described herein depicts various combinations of position accuracy improvements for improving extracted pseudorange information according to various embodiments. Table 3 also depicts various combinations of position accuracy improvements for improving extracted pseudorange information according to various embodiments.

Table 3 includes columns for combination identifier operation description and accuracy. The combination identifier column indicates an identifier for each combination of improvements. The operation column specifies operations of various flowcharts in for the corresponding combination. The description column specifies various combinations of position accuracy improvements that can be applied to extracted pseudorange information EPI according to various embodiments where examples of position accuracy improvements include but are not limited to Wide Area Augmentation System WAAS pseudorange corrections real carrier phase smoothing real CPI information reconstructed carrier phase smoothing information reconstructed CPI Differential GPS DGPS pseudorange corrections and Precise Point Positioning PPP processing. The accuracy column specifies levels of accuracy provided by the corresponding combination.

Combination 1 is extracted pseudorange information without any additional improvements which provides 4 5 meters of accuracy. Combination 1 is described in Table 3 to provide a comparison with the other combinations 2 13.

According to one embodiment the SUPL client can also include a position accuracy improvement determination logic B for determining the one or more position accuracy improvements to apply to the extracted pseudorange information based on one or more factors such as cost quality of service and one or more characteristics of the cellular device. For example different costs are associated with different position accuracy improvements. More specifically extracted pseudorange information WAAS and Doppler information are typically free. There is a low cost typically associated with DGPS and real carrier phase information. There is typically a higher cost associated with PPP. Therefore referring to Table 3 according to one embodiment combinations 1 2 and 3 are typically free combinations 4 7 typically are low cost and combinations 8 12 are typically higher cost.

Various cellular devices have different characteristics that make them capable of providing different types of position accuracy improvements. For example one type of cellular device may be capable of providing WAAS but not be capable of providing Doppler information. In another example some types of cellular devices may be capable of providing DGPS but not capable of providing PPP. In yet another example different activities may require different levels of improvement. For example some activities and or people may be satisfied with 4 5 meters others may be satisfied with 1.7 meters. Yet others may be satisfied with less than 1 meter and still others may only be satisfied with 2 centimeters. Therefore different users may request different levels of accuracy.

Table 4 depicts sources of the various position accuracy improvements according to various embodiments.

The first column of Table 4 provides the name of the position accuracy improvement. The second column of Table 4 specifies the source for the corresponding position accuracy improvement.

According to various embodiments a cellular device can initially provide a position that is within 4 5 meters using for example unimproved extracted pseudorange information and the position can continually be improved using various position accuracy improvements as described herein as long as the antennas of the cellular device is clear of obstructions to receive various position accuracy improvements.

A Global Navigation Satellite System GNSS is a navigation system that makes use of a constellation of satellites orbiting the earth to provide signals to a receiver such as GNSS receiver which estimates its position relative to the earth from those signals. Examples of such satellite systems are the NAVSTAR Global Positioning System GPS deployed and maintained by the United States the GLObal NAvigation Satellite System GLONASS deployed by the Soviet Union and maintained by the Russian Federation and the GALILEO system currently being deployed by the European Union EU .

Each GPS satellite transmits continuously using two radio frequencies in the L band referred to as L1 and L2 at respective frequencies of 1575.41 MHz and 1227.60 MHz. Two signals are transmitted on L1 one for civil users and the other for users authorized by the Unites States Department of Defense DoD . One signal is transmitted on L2 intended only for DoD authorized users. Each GPS signal has a carrier at the L1 and L2 frequencies a pseudo random number PRN code and satellite navigation data.

Two different PRN codes are transmitted by each satellite A coarse acquisition C A code and a precision P Y code which is encrypted for use by authorized users. A receiver such as GNSS receiver designed for precision positioning contains multiple channels each of which can track the signals on both L1 and L2 frequencies from a GPS satellite in view above the horizon at the receiver antenna and from these computes the observables for that satellite comprising the L1 pseudorange possibly the L2 pseudorange and the coherent L1 and L2 carrier phases. Coherent phase tracking implies that the carrier phases from two channels assigned to the same satellite and frequency will differ only by an integer number of cycles.

Each GLONASS satellite conventionally transmits continuously using two radio frequency bands in the L band also referred to as L1 and L2. Each satellite transmits on one of multiple frequencies within the L1 and L2 bands respectively centered at frequencies of 1602.0 MHz and 1246.0 MHz respectively. The code and carrier signal structure is similar to that of NAVSTAR. A GNSS receiver designed for precision positioning contains multiple channels each of which can track the signals from both GPS and GLONASS satellites on their respective L1 and L2 frequencies and generate pseudorange and carrier phase observables from these. Future generations of GNSS receivers will include the ability to track signals from all deployed GNSSs. It should be noted that in the near future a modernized L1 Glonass signal will be added that is centered at 1575.42 MHz the same center frequency as L1 GPS. Additionally this modernized Glonass signal will be in a code division multiple access CDMA format rather than in a frequency division multiple access FDMA like its conventional counterpart that is centered at 1602.0 MHz.

Differential GPS DGPS utilizes a reference station which is located at a surveyed position to gather data and deduce corrections for the various error contributions which reduce the precision of determining a position fix. For example as the GPS signals pass through the ionosphere and troposphere propagation delays may occur. Other factors which may reduce the precision of determining a position fix may include satellite clock errors GPS receiver clock errors and satellite position errors ephemerides . The reference station receives essentially the same GPS signals as cellular devices which may also be operating in the area. However instead of using the timing signals from the GPS satellites to calculate its position it uses its known position to calculate timing. In other words the reference station determines what the timing signals from the GPS satellites should be in order to calculate the position at which the reference station is known to be. The difference in timing can be expressed in terms of pseudorange lengths in meters. The difference between the received GPS signals and what they optimally should be is used as an error correction factor for other GPS receivers in the area. Typically the reference station broadcasts the error correction to for example a cellular device which uses this data to determine its position more precisely. Alternatively the error corrections may be stored for later retrieval and correction via post processing techniques.

DGPS corrections cover errors caused by satellite clocks ephemeris and the atmosphere in the form of ionosphere errors and troposphere errors. The nearer a DGPS reference station is to the receiver the more useful the DGPS corrections from that reference station will be.

The system is called DGPS when GPS is the only constellation used for Differential GNSS. DGPS provides an accuracy on the order of 1 meter or 1 sigma for users in a range that is approximately in a few tens of kilometers kms from the reference station and growing at the rate of 1 m per 150 km of separation. DGPS is one type of Differential GNSS DGNSS technique. There are other types of DGNSS techniques such as RTK and Wide Area RTK WARTK that can be used by high precision applications for navigation or surveying that can be based on using carrier phase measurements. It should be appreciated that other DGNSS which may utilize signals from other constellations besides the GPS constellation or from combinations of constellations. Embodiments described herein may be employed with other DGNSS techniques besides DGPS.

A variety of different techniques may be used to deliver differential corrections that are used for DGNSS techniques. In one example DGNSS corrections are broadcast over an FM subcarrier. U.S. Pat. No. 5 477 228 by Tiwari et al. describes a system for delivering differential corrections via FM subcarrier broadcast method.

An improvement to DGPS methods is referred to as Real time Kinematic RTK . As in the DGPS method the RTK method utilizes a reference station located at determined or surveyed point. The reference station collects data from the same set of satellites in view by the cellular device in the area. Measurements of GPS signal errors taken at the reference station e.g. dual frequency code and carrier phase signal errors and broadcast to one or more cellular devices working in the area. The one or more cellular devices combine the reference station data with locally collected position measurements to estimate local carrier phase ambiguities thus allowing a more precise determination of the cellular device s position. The RTK method is different from DGPS methods in that the vector from a reference station to a cellular device is determined e.g. using the double differences method . In DGPS methods reference stations are used to calculate the changes needed in each pseudorange for a given satellite in view of the reference station and the cellular device to correct for the various error contributions. Thus DGPS systems broadcast pseudorange correction numbers second by second for each satellite in view or store the data for later retrieval as described above.

RTK allows surveyors to determine a true surveyed data point in real time while taking the data. However the range of useful corrections with a single reference station is typically limited to about 70 km because the variable in propagation delay increase in apparent path length from satellite to a receiver of the cellular device or pseudo range changes significantly for separation distances beyond 70 km. This is because the ionosphere is typically not homogeneous in its density of electrons and because the electron density may change based on for example the sun s position and therefore time of day.

Thus for surveying or other positioning systems which must work over larger regions the surveyor must either place additional base stations in the regions of interest or move his base stations from place to place. This range limitation has led to the development of more complex enhancements that have superseded the normal RTK operations described above and in some cases eliminated the need for a base station GPS receiver altogether. This enhancement is referred to as the Network RTK or Virtual Reference Station VRS system and method.

Network RTK typically uses three or more GPS reference stations to collect GPS data and extract information about the atmospheric and satellite ephemeris errors affecting signals within the network coverage region. Data from all the various reference stations is transmitted to a central processing facility or control center for Network RTK. Suitable software at the control center processes the reference station data to infer how atmospheric and or satellite ephemeris errors vary over the region covered by the network.

The control center computer processor then applies a process which interpolates the atmospheric and or satellite ephemeris errors at any given point within the network coverage area and generates a pseudo range correction comprising the actual pseudo ranges that can be used to create a virtual reference station. The control center then performs a series of calculations and creates a set of correction models that provide the cellular device with the means to estimate the ionospheric path delay from each satellite in view from the cellular device and to take account other error contributions for those same satellites at the current instant in time for the cellular device s location.

The cellular device is configured to couple a data capable cellular telephone to its internal signal processing system. The user operating the cellular device determines that he needs to activate the VRS process and initiates a call to the control center to make a connection with the processing computer.

The cellular device sends its approximate position based on raw GPS data from the satellites in view without any corrections to the control center. Typically this approximate position is accurate to approximately 4 7 meters. The user then requests a set of modeled observables for the specific location of the cellular device . The control center performs a series of calculations and creates a set of correction models that provide the cellular device with the means to estimate the ionospheric path delay from each satellite in view from the cellular device and to take into account other error contributions for those same satellites at the current instant in time for the cellular device s location. In other words the corrections for a specific cellular device at a specific location are determined on command by the central processor at the control center and a corrected data stream is sent from the control center to the cellular device . Alternatively the control center may instead send atmospheric and ephemeris corrections to the cellular device which then uses that information to determine its position more precisely.

These corrections are now sufficiently precise that the high performance position accuracy standard of 2 3 cm may be determined in real time for any arbitrary cellular device s position. Thus a GPS enabled cellular device s raw GPS data fix can be corrected to a degree that makes it behave as if it were a surveyed reference location hence the terminology virtual reference station. 

An example of a network RTK system is described in U.S. Pat. No. 5 899 957 entitled Carrier Phase Differential GPS Corrections Network by Peter Loomis assigned to the assignee of the present application.

The Virtual Reference Station method extends the allowable distance from any reference station to the cellular devices . Reference stations may now be located hundreds of miles apart and corrections can be generated for any point within an area surrounded by reference stations. However there are many construction projects where cellular coverage is not available over the entire physical area under construction and survey.

To achieve very accurate positioning to several centimeters or less of a terrestrial mobile platform of a cellular device relative or differential positioning methods are commonly employed. These methods use a GNSS reference receiver located at a known position in addition to the data from a GNSS receiver on the mobile platform to compute the estimated position of the mobile platform relative to the reference receiver.

The most accurate known method uses relative GNSS carrier phase interferometry between the GNSS cellular device s receiver and GNSS reference receiver antennas plus resolution of integer wavelength ambiguities in the differential phases to achieve centimeter level positioning accuracies. These differential GNSS methods are predicated on the near exact correlation of several common errors in the cellular device and reference observables. They include ionosphere and troposphere signal delay errors satellite orbit and clock errors and receiver clock errors.

When the baseline length between the mobile platform and the reference receiver does not exceed 10 kilometers which is normally considered a short baseline condition the ionosphere and troposphere signal delay errors in the observables from the cellular device and reference receivers are almost exactly the same. These atmospheric delay errors therefore cancel in the cellular device s reference differential GNSS observables and the carrier phase ambiguity resolution process required for achieving centimeter level relative positioning accuracy is not perturbed by them. If the baseline length increases beyond 10 kilometers considered a long baseline condition these errors at the cellular device and reference receiver antennas become increasingly different so that their presence in the cellular device s reference differential GNSS observables and their influence on the ambiguity resolution process increases. Ambiguity resolution on single cellular device s reference receiver baselines beyond 10 kilometers becomes increasingly unreliable. This attribute limits the precise resolution of a mobile platform with respect to a single reference receiver and essentially makes it unusable on a mobile mapping platform that covers large distances as part of its mission such as an aircraft.

A network GNSS method computes the estimated position of a cellular device s receiver using reference observables from three or more reference receivers that approximately surround the cellular device s receiver trajectory. This implies that the cellular device s receiver trajectory is mostly contained by a closed polygon whose vertices are the reference receiver antennas. The cellular device s receiver can move a few kilometers outside this polygon without significant loss of positioning accuracy. A network GNSS algorithm calibrates the ionosphere and troposphere signal delays at each reference receiver position and then interpolates and possibly extrapolates these to the cellular device s position to achieve better signal delay cancellation on long baselines than could be had with a single reference receiver. Various methods of signal processing can be used however they all yield essentially the same performance improvement on long baselines.

Kinematic ambiguity resolution KAR satellite navigation is a technique used in numerous applications requiring high position accuracy. KAR is based on the use of carrier phase measurements of satellite positioning system signals where a single reference station provides the real time corrections with high accuracy. KAR combines the L1 and L2 carrier phases from the cellular device and reference receivers so as to establish a relative phase interferometry position of the cellular device s antenna with respect to the reference antenna. A coherent L1 or L2 carrier phase observable can be represented as a precise pseudorange scaled by the carrier wavelength and biased by an integer number of unknown cycles known as cycle ambiguities. Differential combinations of carrier phases from the cellular device and reference receivers result in the cancellation of all common mode range errors except the integer ambiguities. An ambiguity resolution algorithm uses redundant carrier phase observables from the cellular device and reference receivers and the known reference antenna position to estimate and thereby resolve these ambiguities.

Once the integer cycle ambiguities are known the cellular device s receiver can compute its antenna position with accuracies generally on the order of a few centimeters provided that the cellular device and reference antennas are not separated by more than 10 kilometers. This method of precise positioning performed in real time is commonly referred to as real time kinematic RTK positioning. The separation between a cellular device and reference antennas shall be referred to as cellular device reference separation. 

The reason for the cellular device reference separation constraint is that KAR positioning relies on near exact correlation of atmospheric signal delay errors between the cellular device and reference receiver observables so that they cancel in the cellular device s reference observables combinations for example differences between cellular device and reference observables per satellite . The largest error in carrier phase positioning solutions is introduced by the ionosphere a layer of charged gases surrounding the earth. When the signals radiated from the satellites penetrate the ionosphere on their way to the ground based receivers they experience delays in their signal travel times and shifts in their carrier phases. A second significant source of error is the troposphere delay. When the signals radiated from the satellites penetrate the troposphere on their way to the ground based receivers they experience delays in their signal travel times that are dependent on the temperature pressure and humidity of the atmosphere along the signal paths. Fast and reliable positioning requires good models of the spatio temporal correlations of the ionosphere and troposphere to correct for these non geometric influences.

When the cellular device reference separation exceeds 10 kilometers as maybe the case when the cellular device has a GNSS receiver that is a LEO satellite receiver the atmospheric delay errors become de correlated and do not cancel exactly. The residual errors can now interfere with the ambiguity resolution process and thereby make correct ambiguity resolution and precise positioning less reliable.

The cellular device s reference separation constraint has made KAR positioning with a single reference receiver unsuitable for certain mobile positioning applications where the mission of the mobile platform of the cellular device will typically exceed this constraint. One solution is to set up multiple reference receivers along the mobile platform s path so that at least one reference receiver falls within a 10 km radius of the mobile platform s estimated position.

Network GNSS methods using multiple reference stations of known location allow correction terms to be extracted from the signal measurements. Those corrections can be interpolated to all locations within the network. Network KAR is a technique that can achieve centimeter level positioning accuracy on large project areas using a network of reference GNSS receivers. This technique operated in real time is commonly referred to as network RTK. The network KAR algorithm combines the pseudorange and carrier phase observables from the reference receivers as well as their known positions to compute calibrated spatial and temporal models of the ionosphere and troposphere signal delays over the project area. These calibrated models provide corrections to the observables from the cellular device s receiver so that the cellular device s receiver can perform reliable ambiguity resolution on combinations of carrier phase observables from the cellular device and some or all reference receivers. The number of reference receivers required to instrument a large project area is significantly less than what would be required to compute reliable single baseline KAR solutions at any point in the project area. See for example U.S. Pat. No. 5 477 458 Network for Carrier Phase Differential GPS Corrections and U.S. Pat. No. 5 899 957 Carrier Phase Differential GPS Corrections Network . See also Liwen Dai et al. Comparison of Interpolation Algorithms in Network Based GPS Techniques Journal of the Institute of Navigation Vol. 50 No. 4 Winter 1003 1004 for a comparison of different network GNSS implementations and comparisons of their respective performances.

A virtual reference station VRS network method is a particular implementation of a network GNSS method that is characterized by the method by which it computes corrective data for the purpose of cellular device s position accuracy improvement. A VRS network method comprises a VRS corrections generator and a single baseline differential GNSS position generator such as a GNSS receiver with differential GNSS capability. The VRS corrections generator has as input data the pseudorange and carrier phase observables on two or more frequencies from N reference receivers each tracking signals from M GNSS satellites. The VRS corrections generator outputs a single set of M pseudorange and carrier phase observables that appear to originate from a virtual reference receiver at a specified position hereafter called the VRS position within the boundaries of the network defined by a polygon or projected polygon having all or some of the N reference receivers as vertices. The dominant observables errors comprising a receiver clock error satellite clock errors ionosphere and troposphere signal delay errors and noise all appear to be consistent with the VRS position. The single baseline differential GNSS position generator implements a single baseline differential GNSS position algorithm of which numerous examples have been described in the literature. B. Hofmann Wellenhof et al. Global Positioning System Theory and Practice 5th Edition 1001 hereinafter Hofmann Wellenhof 1001 gives comprehensive descriptions of different methods of differential GNSS position computation ranging in accuracies from one meter to a few centimeters. The single baseline differential GNSS position algorithm typically computes differences between the cellular device and reference receiver observables to cancel atmospheric delay errors and other common mode errors such as orbital and satellite clock errors. The VRS position is usually specified to be close to or the same as the roving receiver s estimated position so that the actual atmospheric errors in the cellular device receiver s observables approximately cancel the estimated atmospheric errors in the VRS observables in the cellular device s reference observables differences.

The VRS corrections generator computes the synthetic observables at each sampling epoch typically once per second from the geometric ranges between the VRS position and the M satellite positions as computed using well known algorithms such as those given in IS GPS 200G interface specification tilted Naystar GPS Space Segment Navigation User Interfaces and dated 5 Sep. 2012. It estimates the typical pseudorange and phase errors comprising receiver clock error satellite clock errors ionospheric and tropospheric signal delay errors and noise applicable at the VRS position from the N sets of M observables generated by the reference receivers and adds these to the synthetic observables.

A network RTK system operated in real time requires each GNSS reference receiver to transmit its observables to a network server computer that computes and transmits the corrections and other relevant data to the GNSS cellular device s receiver . The GNSS reference receivers plus hardware to assemble and broadcast observables are typically designed for this purpose and are installed specifically for the purpose of implementing the network. Consequently those receivers are called dedicated network reference receivers.

An example of a VRS network is designed and manufactured by Trimble Navigation Limited of Sunnyvale Calif. The VRS network as delivered by Trimble includes a number of dedicated reference stations a VRS server multiple server reference receiver bi directional communication channels and multiple server cellular device bi directional data communication channels. Each server cellular device bi directional communication channel serves one cellular device . The reference stations provide their observables to the VRS server via the server reference receiver bi directional communication channels. These channels can be implemented by a public network such as the Internet. The bi directional server cellular device communication channels can be radio modems or cellular telephone links depending on the location of the server with respect to the cellular device .

The VRS server combines the observables from the dedicated reference receivers to compute a set of synthetic observables at the VRS position and broadcasts these plus the VRS position in a standard differential GNSS DGNSS message format such as one of the RTCM Radio Technical Commission for Maritime Services formats an RTCA Radio Technical Commission for Aeronautics format or a proprietary format such as the CMR Compact Measurement Report or CMR format which are messaging system communication formats employed by Trimble Navigation Limited. Descriptions for numerous of such formats are widely available. For example RTCM Standard 10403.1 for DGNSS Services Version 3 published Oct. 26 2006 and Amendment 2 to the same published Aug. 31 2007 is available from the Radio Technical Commission for Maritime Services 1800 N. Kent St. Suite 1060 Arlington Va. 22209. The synthetic observables are the observables that a reference receiver located at the VRS position would measure. The VRS position is selected to be close to the cellular device s estimated position so that the cellular device s VRS separation is less than a maximum separation considered acceptable for the application. Consequently the cellular device receiver must periodically transmit its approximate position to the VRS server. The main reason for this particular implementation of a real time network RTK system is compatibility with RTK survey GNSS receivers that are designed to operate with a single reference receiver.

Descriptions of the VRS technique are provided in U.S. Pat. No. 6 324 473 of hereinafter Eschenbach see particularly col. 7 line 21 et seq. and U.S. Patent application publication no. 2005 0064878 of B. O Meagher hereinafter O Meagher which are assigned to Trimble Navigation Limited and in H. Landau et al. Virtual Reference Stations versus Broadcast Solutions in Network RTK GNSS 2003 Proceedings Graz Austria 2003 .

The term VRS as used henceforth in this document is used as shorthand to refer to any system or technique which has the characteristics and functionality of VRS described or referenced herein and is not necessarily limited to a system from Trimble Navigation Ltd. Hence the term VRS is used in this document merely to facilitate description and is used without derogation to any trademark rights of Trimble Navigation Ltd. or any subsidiary thereof or other related entity.

Descriptions of a Precise Point Positioning PPP technique are provided in U.S. Patent application publication 20110187590 of Leandro which is assigned to Trimble Navigation Limited. Trimble Navigation Limited has commercialized a version of PPP corrections which it calls RTX . PPP corrections can be any collection of data that provides corrections from a satellite in space clock errors ionosphere or troposphere or a combination thereof. According to one embodiment PPP corrections can be used in instead of WAAS or RTX .

The term Precise Point Positioning PPP as used henceforth in this document is used as shorthand to refer to any system or technique which has the characteristics and functionality of PPP described or referenced herein and is not necessarily limited to a system from Trimble Navigation Ltd. Hence the term PPP is used in this document merely to facilitate description and is used without derogation to any trademark rights of Trimble Navigation Ltd. or any subsidiary thereof or other related entity. Techniques for generating PPP corrections are well known in the art. In general a PPP system utilizes a network which may be global of GNSS reference receivers tracking navigation satellites such as GPS and GLONASS satellites and feeding data back to a centralized location for processing. At the centralized location the precise orbits and precise clocks of all of the tracked navigation satellites are generated and updated in real time. A correction stream is produced by the central location the correction stream contains the orbit and clock information. This correction stream is broadcast or otherwise provided to GNSS receivers such as a GNSS receiver in the field conventionally by satellite service or cellular link . Corrections processors in the GNSS receivers utilize the corrections to produce centimeter level positions after a short convergence time e.g. less than 30 minutes . A main difference between PPP and VRS is that PPP networks of reference receivers are typically global while VRS networks may be regional or localized with shorter spacing between the reference stations in a VRS network.

Wide Area Augmentation System WAAS corrections are corrections of satellite position and their behavior. WAAS was developed by the Federal Aviation Administration FAA . WAAS includes a network of reference stations that are on the ground located in North America and Hawaii. The reference stations transmit their respective measurements to master stations which queue their respective received measurements. The master stations transmit WAAS corrections to geostationary WAAS satellites which in turn broadcast the WAAS corrections back to earth where cellular devices that include WAAS enabled GPS receivers can receive the broadcasted WAAS corrections. According to one embodiment the GNSS receiver is a WAAS enabled GPS receiver. The WAAS corrections can be used to improve the accuracy of the respective cellular devices positions for example by applying the WAAS corrections to extracted pseudoranges. WAAS operation and implementation is well known in the art.

According to one embodiment a GNSS chipset provides real carrier phase information also referred to as actual carrier phase information . The cellular device can extract real carrier phase information from the GNSS chipset in a manner similar to extracting pseudorange information from the GNSS chipset where the extracted carrier phase information is for use elsewhere in the cellular device outside of the GNSS chipset as described herein for example with flowchart of .

The filtering processing described herein lies in the family of errors in pseudorange processing that affect code and carrier measurements in the same way. In various embodiments the code phase pseudorange measurements are disciplined by subtracting out a more constant equivalent pseudorange like distance measurement derived from the carrier phase. Next a filtering on the net subtracted signal is performed which allows various embodiments to eliminate multipath induced errors in the raw and corrected pseudorange data. This method does not deal with ionospheric effects according to one embodiment.

In operation A of extracted pseudorange information and carrier phases for a first epoch are collected. In one embodiment these extracted pseudorange information and carrier phases are received at carrier phase smoothing logic from the GNSS receiver .

In operation A of pseudorange corrections are collected and applied to the first set of extracted pseudoranges collected in operation A. In one embodiment these corrections themselves may be smoothed at the reference receiver e.g. at GPS GNSS reference stations so that the delivered pseudorange corrections themselves are less noisy. Smoothing the pseudorange corrections derived at the GPS GNSS reference stations using the same carrier phase method of flowchart A can vastly improve the quality of the delivered pseudorange corrections delivered to cellular device for use by a position determination processor e.g. GNSS receiver or pseudorange information processing logic . Such corrected pseudoranges that are also smoothed may be used by the cellular device and fetched if available.

In operation A of delta carrier phase measurements for the same epoch are created using real carrier phase information. In accordance with various embodiments this replicates creating a second distance measurement similar to the reconstructed carrier phase information based on integrated Doppler Shift.

In operation A of the delta carrier phase measurements are subtracted from the corrected extracted pseudoranges. In accordance with various embodiments this provides a fairly constant signal for that epoch and is equivalent to the corrected extracted pseudorange at the start of the integration interval. In accordance with various embodiments this is referred to as a disciplining step that smoothes out the corrected extracted pseudorange signal and therefore reduces the instant errors in the later computed position fixes.

In operation A of the signal is filtered after the subtraction of operation A to reduce noise. In accordance with one embodiment this is performed by averaging the carrier phase yardsticks over a series of epochs.

In operation A of the delta carrier phase measurements from the real carrier phase processing operation is added back into the filtered signal of operation A.

In operation A of the new filtered and corrected extracted pseudorange signal is processed for example at the pseudorange information processing logic to derive a position fix B.

Carrier Phase Information can be reconstructed referred to herein as reconstructed carrier phase based on Doppler Shift. Doppler Shift is the change in frequency of a periodic event also known as a wave perceived by an observer that is moving relative to a source of the periodic event. For example Doppler shift refers to the change in apparent received satellite signal frequency caused by the relative motion of the satellites as they either approach the cellular device or recede from it. Thus any measurement of Doppler frequency change is similar to differentiating carrier phase. It is therefore possible to reconstruct the carrier phase by integrating the Doppler shift data. In an embodiment the GNSS chipset of GNSS receiver may provide Doppler information it determines through other means. This Doppler frequency shift information or Doppler may be collected at each GPS timing epoch e.g. one second and integrated over a sequence of the one second epochs to produce a model of carrier phase. This Doppler derived carrier phase model may be substituted for the real carrier phase data and used in the same manner as shown in the flow chart for carrier phase smoothing of . Doppler Shift signal processing is well known in the art.

In operation B of Doppler information from a GNSS receiver of a GNSS chipset is received by pseudorange carrier phase smoothing logic .

In operation B of a series of Doppler information is integrated. As described above Doppler frequency shift information may be collected at each GPS timing epoch e.g. one second and stored for use in producing a model of carrier phase.

In operation B of a model of carrier phase is created based on integrated Doppler information. As discussed above with reference to operation B a series of Doppler information for a plurality of timing epochs is integrated. In one embodiment this Doppler information is integrated over a sequence of the one second epochs to produce a model of carrier phase. The sequence may include 10 100 epochs or seconds. The model of carrier phase smoothing is used as the reconstructed carrier phase information.

In operation B of the modeled carrier phase which is also referred to as reconstructed carrier phase information is supplied to pseudorange carrier phase smoothing logic . As described above method of flowchart B can be implemented at GPS GNSS reference stations and the reconstructed carrier phase information can then be broadcast to cellular device .

At the cellular device accesses the GNSS chipset embedded within the cellular device where the GNSS chipset calculates pseudorange information for use by the GNSS chipset . For example the GNSS receiver can perform GPS measurements to derive raw measurement data for a position of the cellular device . The raw measurement data provides an instant location of the cellular device . The GNSS chipset calculates pseudorange information that is for use by the GNSS chipset . According to one embodiment the raw measurement data is the pseudorange information that will be extracted. Examples of pseudorange information are uncorrected pseudorange information differential GNSS corrections high precision GNSS satellite orbital data GNSS satellite broadcast ephemeris data and ionospheric projections.

A chipset accessor logic according to one embodiment is configured for accessing the GNSS chipset . According to one embodiment the chipset accessor logic is a part of an SUPL client .

The pseudorange information can be obtained from the processor of the GNSS receiver using a command. The GNSS chipset may be designed for example by the manufacturer of the GNSS chipset to provide requested information such as pseudorange information in response to receiving the command. The pseudorange information may be extracted from the GNSS chipset using the command that the manufacturer has designed the GNSS chipset with. For example according to one embodiment the GNSS chipset is accessed using an operation that is a session started with a message that is an improved accuracy Secure User Platform Location SUPL start message or a high precision SUPL INIT message. According to one embodiment the message is a custom command that is specific to the GNSS chipset also referred to as a GNSS chipset custom command and the improved accuracy SUPL client can access to the raw measurements of the GNSS chipset .

Examples of chipset manufacturers include Qualcomm Inc. Texas Instruments Inc. CCI Thermal Technologies Inc. Marvell Technology Group Limited SiRF Technology Inc. Trimble Navigation Limited SONY Corporation Furuno Electric Co. Ltd. Koninklijke Phillips N.V. and SEMTECH Corporation to name a few.

At the cellular device extracts the pseudorange information from the GNSS chipset for use elsewhere in the cellular device outside of the GNSS chipset . For example pseudorange information extractor logic may be associated with a worker thread of the SUPL client . The worker thread associated with the SUPL client can monitor the raw measurements delivered by the GNSS chipset into the GNSS chipset s memory buffers cache the raw measurements and use the raw measurements to determine a position fix. The pseudorange information extractor logic and the pseudorange information processing logic can be associated with the worker thread. For example the pseudorange information extractor logic can cache the raw measurements and the pseudorange information processing logic can determine the location.

According to one embodiment the raw measurement data is the pseudorange information that is extracted. According to one embodiment the raw measurement data is pseudorange information that is calculated by the GNSS chipset and is only for use by the GNSS chipset .

According to one embodiment a determining position fix logic B may perform a least squares solution B on the extracted pseudorange information prior to transmitting the output to the pseudorange information bridger logic . According to another embodiment the extracted pseudorange information is improved using various embodiments described in prior to performing a least squares solution B as will be described herein.

The extracted pseudorange information without further improvements can be used to provide an instant location as described herein. The extracted pseudorange information can be improved by applying position accuracy improvements that include but are not limited to those depicted in Tables 2 and 3. The instant location or the improved location can be communicated to location manager logic as discussed herein that displays the instant location or the improved location with respect to a map.

At A the pseudorange correction logic provides Wide Area Augmentation System WAAS corrected pseudoranges by applying WAAS corrections to the extracted pseudorange information. For example the pseudorange correction logic receives the extracted pseudorange information that was extracted from the GNSS chipset at of . The cellular device receives the WAAS corrections as described herein and provides the WAAS corrections to the pseudorange correction logic . The pseudorange correction logic provides Wide Area Augmentation System WAAS corrected pseudoranges by applying the received WAAS corrections to the extracted pseudorange information.

At B the pseudorange carrier phase smoothing logic provides smoothed pseudorange information by performing pseudorange smoothing on the extracted pseudorange information based on carrier phase information. For example if real carrier phase information is available the cellular device can extract it as discussed herein. Otherwise the cellular device can derive reconstructed carrier phase information as described herein and provide the reconstructed carrier phase information to the pseudorange carrier phase smoothing logic . The pseudorange carrier phase smoothing logic can receive the extracted pseudorange information that was extracted from the GNSS chipset at of . The pseudorange carrier phase smoothing logic can apply either the real carrier phase information or the real carrier phase information to the extracted pseudorange information to provide smoothed pseudorange information.

At B a position fix is determined based on the smoothed pseudorange information and WAAS pseudorange corrections. For example the pseudorange correction logic receives the smoothed pseudorange information and receives WAAS pseudorange corrections and determines a position fix based on the smoothed pseudorange information and the WAAS pseudorange corrections.

According to one embodiment a determining position fix logic B may perform a least squares solution B on the output of flowchart A and B prior to transmitting the output to the pseudorange information bridger logic .

At A the pseudorange correction logic provides Differential Global Positioning System DGPS corrected pseudoranges by applying DGPS corrections to the extracted pseudorange information.

For example the pseudorange correction logic receives the extracted pseudorange information that was extracted from the GNSS chipset at of . The cellular device receives the DGPS corrections as described herein and provides the DGPS corrections to the pseudorange correction logic . The pseudorange correction logic provides Differential Global Positioning System DGPS corrected pseudoranges by applying the received DGPS corrections to the extracted pseudorange information.

At A the pseudorange correction logic provides WAAS DGPS corrected pseudoranges by applying Wide Area Augmentation System WAAS to the DGPS corrected pseudoranges.

For example the pseudorange correction logic accesses the DGPS corrected pseudoranges determined at A of . The cellular device receives the WAAS corrections as described herein and provides the WAAS corrections to the pseudorange correction logic . The pseudorange correction logic provides WAAS DGPS corrected pseudoranges by applying Wide Area Augmentation System WAAS to the DGPS corrected pseudoranges.

At B a position determination decision is made as to whether to proceed to B or B. For example at operation B the position accuracy improvement determination logic B can determine whether to proceed to B or B as discussed herein.

At B DGPS corrected smoothed pseudoranges are provided by applying corrections to the smoothed pseudorange information. For example the pseudorange correction logic can provide DGPS corrected smoothed pseudoranges by applying DGPS corrections to the smoothed pseudoranges determined at either B or B.

At B WAAS DGPS corrected smoothed pseudoranges are provided by applying WAAS to the DGPS corrected smoothed pseudoranges. For example the pseudorange correction logic can provide WAAS DGPS corrected smoothed pseudoranges by applying WAAS corrections to the DGPS corrected smoothed pseudoranges.

According to one embodiment a determining position fix logic B may perform a least squares solution B on the output of flowcharts A or B prior to transmitting the output to the pseudorange information bridger logic .

At A DGPS corrected pseudoranges are determined by applying DGPS pseudorange corrections to extracted pseudorange information. For example the pseudorange correction logic receives extracted pseudorange information from the pseudorange information extractor logic and applies the DGPS pseudorange corrections to the extracted pseudorange information.

At A the pseudorange correction logic can determine a position fix based on the DGPS corrected pseudoranges and PPP corrections.

At B smoothed pseudorange information is provided by performing pseudorange smoothing on the extracted pseudorange information using carrier phase information. For example the pseudorange carrier phase smoothing logic provides smoothed pseudorange information by performing pseudorange smoothing on the extracted pseudorange information which can be obtained as discussed herein based on carrier phase information. If real carrier phase information is available the cellular device can extract the real carrier phase information as discussed herein. Otherwise the cellular device can derive reconstructed carrier phase information as described herein and provide the reconstructed carrier phase information to the pseudorange carrier phase smoothing logic .

At B DGPS corrected smoothed pseudoranges are provided by applying DGPS pseudorange corrections to the smoothed pseudorange information. For example the pseudorange correction logic can receive the smoothed pseudorange information from the pseudorange carrier phase smoothing logic . The pseudorange correction logic can determine the corrected smoothed pseudoranges by applying DGPS pseudorange corrections to the smoothed pseudorange information.

At B a position fix can be determined based on the DGPS corrected smoothed pseudoranges and PPP corrections. For example the pseudorange correction logic can determine a position fix based on the DGPS corrected smoothed pseudoranges and PPP corrections.

According to one embodiment a determining position fix logic B may perform a least squares solution B on the output of flowcharts A and B prior to transmitting the output to the pseudorange information bridger logic .

At the pseudorange carrier phase smoothing logic smoothes the extracted pseudorange information based on carrier phase smoothing. For example the pseudorange carrier phase smoothing logic receives extracted pseudorange information from the pseudorange information extractor logic and receives carrier phase information which may be either real carrier phase information or reconstructed carrier phase information as described herein. The pseudorange carrier phase smoothing logic smoothes the extracted pseudorange information based on carrier phase smoothing.

At the PPP logic C provides a smoothed improved accuracy position fix by performing Precise Point Positioning PPP processing on the smoothed extracted pseudorange information. For example the PPP logic C receives the smoothed extracted pseudorange information provided by the pseudorange carrier phase smoothing logic at . The PPP logic C provides a smoothed improved accuracy position fix by performing Precise Point Positioning PPP processing on the smoothed extracted pseudorange information

At the pseudorange correction logic can optionally correct the smoothed improved accuracy position fix by applying Differential Global Positioning System DGPS corrections to the smoothed improved accuracy position fix. For example pseudorange correction logic receives the smoothed improved accuracy position fix provided by the PPP logic C at . The pseudorange correction logic receives DGPS corrections as described herein. The pseudorange correction logic corrects the smoothed improved accuracy position fix by applying Differential Global Positioning System DGPS corrections to the smoothed improved accuracy position fix thus providing a corrected smoothed improved accuracy position fix. Operation is optional according to one embodiment.

According to one embodiment a determining position fix logic B may perform a least squares solution B on the output of flowchart prior to transmitting the output to the pseudorange information bridger logic .

At various types of information can be accessed. Examples of accessing are extracting information and receiving information. Unsmoothed uncorrected pseudorange information can be extracted at A WAAS corrections can be extracted at B SBAS corrections can be extracted at E Doppler shift can be extracted at C and carrier phase measurements can be extracted at D. Accessing and obtaining can be used interchangeably. Table 1 depicts types of information that can be extracted at operation from the GNSS chipset and types of information that are received at operation instead of being extracted. However various embodiments are not limited to the types of information that can be extracted or received depicted in Table 1.

What or whether to apply position accuracy improvements can be determined at for example by the position accuracy improvement determination logic B. Examples of position accuracy improvements are real carrier phase information reconstructed carrier phase information WAAS SBAS DGPS PPP RTK VRS and RTX corrections. The determination logic B can determine whether one or more and in what order logics A B A F are performed according to one embodiment. Tables 2 and 3 are examples of carrier phase information or corrections or a combination thereof that the position accuracy improvement determination logic B may determine as discussed herein.

The information can be smoothed at . Examples of smoothing are real carrier phase smoothing and reconstructed carrier phase smoothing .

Either unsmoothed information or smoothed information can be corrected at . For example unsmoothed information from or smoothed information from can be corrected at . Examples of correcting are SBAS correcting G WAAS correcting A DGPS correcting B PPP correcting C RTK correcting D VRS correcting E and RTX correcting F. The smoothed information or unsmoothed information can be corrected using one or more of operations A G. According to one embodiment WAAS correcting A is an example of SBAS correcting G.

Unsmoothed information from smoothed information from corrected unsmoothed information from or corrected smoothed information from can be used to determine a position fix B at for example by performing a least squares solution B at . The output of flowchart is a position fix B. Table 2 and Table 3 depict combinations of information that result in a position fix B according to various embodiments.

According to one embodiment accessing extracting extracting pseudorange information A extracting SBAS E extracting WAAS B extracting Doppler C extracting carrier phase measurement D receiving smoothing correcting determining a position fix and performing a least squares solution can be performed respectively by logic B B B B B B and B. Real carrier phase smoothing reconstructed carrier phase smoothing correcting A G can be performed respectively by logic A B A E F G.

Any one or more of A E A G can be performed. Further any one or more of A E B C E A G can be performed in various orders. Various embodiments are not limited to just the combinations that are described herein.

According to one embodiment a Global Navigation Satellite System GNSS chipset embedded within the cellular device is accessed at where the GNSS chipset calculates pseudorange information for use by the GNSS chipset. The pseudorange information is extracted at from the GNSS chipset for use elsewhere in the cellular device outside of the GNSS chipset. The accessing and the extracting A can be performed by the cellular device that includes hardware .

The extracted pseudorange information can be smoothed at . The smoothing can be based on reconstructed carrier phase information or real carrier phase information. The smoothed pseudorange information can be corrected at . Examples of the types of corrected pseudoranges are Wide Area Augmentation System WAAS Differential Global Positioning System DGPS Precise Point Positioning PPP and Real Time Kinematic RTK . Pseudorange corrections can be accessed . The corrected pseudorange information can be derived for example at by applying the pseudorange corrections to the extracted pseudorange information.

The operations depicted in transform data or modify data to transform the state of a cellular device . For example by extracting pseudorange information from a GNSS chipset for use elsewhere the state of the cellular device is transformed from a cellular device that is not capable of determining a position fix itself into a cellular device that is capable of determining a position fix itself. In another example operations depicted in flowcharts transform the state of a cellular device from not being capable of providing an improved accuracy position fix to be capable of providing an improved accuracy position fix.

The above illustration is only provided by way of example and not by way of limitation. There are other ways of performing the method described by flowcharts .

The operations depicted in can be implemented as computer readable instructions hardware or firmware. According to one embodiment hardware associated with a cellular device can perform one or more of the operations depicted in .

With reference now to a block diagram is shown of an embodiment of an example GNSS receiver which may be used in accordance with various embodiments described herein. In particular illustrates a block diagram of a GNSS receiver in the form of a GPS receiver capable of demodulation of the L1 and or L2 signal s received from one or more GPS satellites. A more detailed discussion of the function of a receiver such as GPS receiver can be found in U.S. Pat. No. 5 621 416 by Gary R. Lennen is titled Optimized processing of signals for enhanced cross correlation in a satellite positioning system receiver and includes a GPS receiver very similar to GPS receiver of .

In received L1 and L2 signals are generated by at least one GPS satellite. Each GPS satellite generates different signal L1 and L2 signals and they are processed by different digital channel processors which operate in the same way as one another. shows GPS signals L1 1575.42 MHz L2 1227.60 MHz entering GPS receiver through a dual frequency antenna . Antenna may be a magnetically mountable model commercially available from Trimble Navigation of Sunnyvale Calif. Master oscillator provides the reference oscillator which drives all other clocks in the system. Frequency synthesizer takes the output of master oscillator and generates important clock and local oscillator frequencies used throughout the system. For example in one embodiment frequency synthesizer generates several timing signals such as a 1st local oscillator signal LO at 1400 MHz a 2nd local oscillator signal LO at 175 MHz an SCLK sampling clock signal at 25 MHz and a MSEC millisecond signal used by the system as a measurement of local reference time.

A filter LNA Low Noise Amplifier performs filtering and low noise amplification of both L1 and L2 signals. The noise figure of GPS receiver is dictated by the performance of the filter LNA combination. The downconvertor mixes both L1 and L2 signals in frequency down to approximately 175 MHz and outputs the analog L1 and L2 signals into an IF intermediate frequency processor . IF processor takes the analog L1 and L2 signals at approximately 175 MHz and converts them into digitally sampled L1 and L2 inphase L1 I and L2 I and quadrature signals L1 Q and L2 Q at carrier frequencies 420 KHz for L1 and at 2.6 MHz for L2 signals respectively.

At least one digital channel processor inputs the digitally sampled L1 and L2 inphase and quadrature signals. All digital channel processors are typically are identical by design and typically operate on identical input samples. Each digital channel processor is designed to digitally track the L1 and L2 signals produced by one satellite by tracking code and carrier signals and to from code and carrier phase measurements in conjunction with the GNSS microprocessor system . One digital channel processor is capable of tracking one satellite in both L1 and L2 channels. Microprocessor system is a computing device such as computer system of which facilitates tracking and measurements processes providing pseudorange and carrier phase measurements for a determining position fix logic . In one embodiment microprocessor system provides signals to control the operation of one or more digital channel processors . According to one embodiment the GNSS microprocessor system provides one or more of pseudorange information Doppler Shift information and real Carrier Phase Information to the determining position fix logic . One or more of pseudorange information Doppler Shift information and real Carrier Phase Information can also be obtained from storage . One or more of the signals can be conveyed to the cellular device s processor such as processor that is external to the GNSS chipset . Determining position fix logic performs the higher level function of combining measurements in such a way as to produce position velocity and time information for the differential and surveying functions for example in the form of a position fix . Storage is coupled with determining position fix logic and microprocessor system . It is appreciated that storage may comprise a volatile or non volatile storage such as a RAM or ROM or some other computer readable memory device or media. In some embodiments determining position fix logic performs one or more of the methods of position correction described herein.

In some embodiments microprocessor and or determining position fix logic receive additional inputs for use in receiving corrections information. According to one embodiment an example of the corrections information is WAAS corrections. According to one embodiment examples of corrections information are differential GPS corrections RTK corrections signals used by the previously referenced Enge Talbot method and wide area augmentation system WAAS corrections among others.

Although depicts a GNSS receiver with navigation signals L1I L1Q L2I L2Q various embodiments are well suited different combinations of navigational signals. For example according to one embodiment the GNSS receiver may only have an L1I navigational signal. According to one embodiment the GNSS receiver may only have L1I L1Q and L2I.

Various embodiments are also well suited for future navigational signals. For example various embodiments are well suited for the navigational signal L2C that is not currently generally available. However there are plans to make it available for non military receivers.

According to one embodiment either or both of the accessing logic B and the processing logic reside at either or both of the storage and GNSS microprocessor system .

According to one embodiment the GNSS receiver is an example of a GNSS receiver see e.g. and . According to one embodiment the determining position fix logic is an example of determining position fix logic B . According to one embodiment position fix is an example of a position fix B .

A basic Kalman filter implemented using Kalman filtering process typically has at least two major components states and covariances . States represent variables that are used to describe a system being modeled at a particular moment in time. Covariances are represented in a covariance matrix that describes uncertainty or lack of confidence of states with respect to each other at that same moment in time. Kalman filtering process also handles noise or unpredictable variability in the model. There are two principle types of noise observation noise and process noise . A Kalman filter may handle additional noise types in some embodiments. Process noise describes noise of the states as a function of time. Observation noise is noise that relates to the actual observation s e.g. observed measurements that are used as an input update to Kalman filtering process .

A prediction phase is the first phase of Kalman filtering process . Prediction phase uses predictive models to propagate states to the time of an actual observation s . Prediction phase also uses process noise and predictive models to propagate the covariances to time of the actual observation s as well. The propagated states are used to make predicted observation s for the time of actual observation s .

A correction phase is the second phase in the Kalman filtering process . During correction phase Kalman filtering process uses the difference between the predicted observation s and the actual observation s to create an observation measurement residual which may commonly be called the measurement residual. Observation noise can be noise in actual observation s and or noise that occurs in the process of taking the actual observation s . A Kalman gain is calculated using both the covariances and the observation noise . The states are then updated using the Kalman Gain multiplied by the observation measurement residual . The covariances are also updated using a function related to the Kalman gain for example in one embodiment where Kalman gain is limited to a value between 0 and 1 this function may be 1 minus the Kalman gain. This updating is sometimes referred to as the covariance update. In some embodiments if no actual observation is available Kalman filtering process can simply skip correction phase and update the states and covariances using only the information from prediction phase and then begin again. Using the new definitions of the states and covariances Kalman filtering process is ready to begin again and or to be iteratively accomplished.

Unless otherwise specified any one or more of the embodiments described herein can be implemented using non transitory computer readable storage medium and computer readable instructions which reside for example in computer readable storage medium of a computer system or like device. The non transitory computer readable storage medium can be any kind of physical memory that instructions can be stored on. Examples of the non transitory computer readable storage medium include but are not limited to a disk a compact disk CD a digital versatile device DVD read only memory ROM flash and so on. As described above certain processes and operations of various embodiments described herein are realized in some instances as a series of computer readable instructions e.g. software program that reside within non transitory computer readable storage memory of a cellular device and are executed by a hardware processor of the cellular device . When executed the instructions cause a computer system to implement the functionality of various embodiments described herein. For example the instructions can be executed by a central processing unit associated with the cellular device . According to one embodiment the non transitory computer readable storage medium is tangible.

Unless otherwise specified one or more of the various embodiments described herein can be implemented as hardware such as circuitry firmware or computer readable instructions that are stored on non transitory computer readable storage medium. The computer readable instructions of the various embodiments described herein can be executed by a hardware processor such as central processing unit to cause the cellular device to implement the functionality of various embodiments. For example according to one embodiment the SUPL client and the operations of the flowcharts depicted in are implemented with computer readable instructions that are stored on computer readable storage medium which can be tangible or non transitory or a combination thereof and can be executed by a hardware processor of a cellular device . According to one embodiment the non transitory computer readable storage medium is tangible.

The GNSS chipset normally processes the GNSS signals from space to determine a number of signal observables referred to a raw GNSS observables which include pseudoranges for up to 12 satellites that may be in view Doppler shift information for each satellite signal or signals in the case of dual frequency L1 and L2 tracking and carrier phase information for each signal being tracked. These observables may be processed locally in the chipset via stored program algorithms or in an embodiment transferred from the chipset to a nearby cellular phone for enhanced processing via the services available in the cellphone.

Wireless communication component comprises a wireless radio transmitter or transceiver configured to transmit GNSS data including but not limited to raw GNSS observables from GNSS chipset to cellular device . In accordance with various embodiments wireless communication component may operate on in compliance with any suitable wireless communication protocol including but not limited to mesh networking implementations of the IEEE 802.15.4 specification for personal area networks and implementations of the Bluetooth standard. Personal area networks refer to short range and often low data rate wireless communications networks. In accordance with embodiments of the present technology components of a wireless personal area network are configured for automatic detection of other components and for automatically establishing wireless communications. In another embodiment receiving component may also include another wireless communication component not shown which is capable of communicating across longer distances. This second wireless communication component of receiving component when included may operate on any suitable wireless communication protocol including but not limited to Wi Fi WiMAX WWAN implementations of the IEEE 802.11 specification cellular two way radio and satellite based cellular e.g. via the Inmarsat PLC s or Iridium Communications Inc. s communication networks . The discussion above and the depiction in indicates that all of the sub components of receiving component are disposed proximate to each other or within a single unit however in various embodiments the components of receiving component can be distributed but are not components of cellular device itself.

It is noted that in accordance with various embodiments GNSS chipset and wireless communication component are integrated as components of a larger chipset such as a cellular telephone chipset having cellular communication GNSS processing and Bluetooth wireless personal area network capabilities integrated into a single product. Additionally various embodiments can utilize GNSS chipsets of varying quality as GNSS chipset . For example there is a wide range of capabilities and prices of GNSS chipsets on the market today ranging from a few dollars to a hundred dollars or more depending in part upon what features are supported by the chipset. Cellular device GNSS chipsets are typically configured to deliver an abbreviated feature set. In an embodiment GNSS chipset may be configured and accessed to obtain raw GNSS observables data by other devices within the network in manners described herein for further processing. This additional further processing is due to processing limitations of the chipset. Thus while it may be possible for receiving component to derive its own position in one or more embodiments or be capable of more advanced operations it instead is used to derive data such as raw pseudorange information and carrier phase information which is then wirelessly transmitted to cellular device for further processing. In at least one embodiment receiving component also wirelessly transmits other data to cellular device such as but not limited to Doppler frequency shift data. In receiving component further comprises a battery a power line conditioner and a power connection . Battery is for providing power to receiving component . Power line conditioner is for converting and or conditioning power received via power connection to a proper voltage and or characteristics suitable for re charging battery or for directly powering receiving component . In accordance with various embodiments circularly polarized GNSS antenna GNSS chipset wireless communication component battery power line conditioner and power connection are disposed within a housing . In accordance with one or more embodiments power connection comprises a power socket configured to receive a power plug. In accordance with at least one embodiment power connection comprises a wireless power connection such as for example an inductive power charger or a capacitive power charger. In accordance with various embodiments power line conditioner may be an optional component in the event that the power connection is configured to provide voltage in accordance with the requirements of receiving component .

In accordance with various embodiments cellular device comprises a cellular telephone a dedicated GNSS data collector or another portable electronic device configured to communicate via a cellular network. For example cellular device can be implemented as cellular device of SOCS of cellular device of etc. Furthermore it is noted that all of the functionality described above with reference to improved accuracy SUPL client as well as all components thereof and operating system and its sub components are operable upon cellular device . In cellular device comprises second wireless communication component processor and cellular communication component . In various embodiments second wireless communication component is configured to wirelessly communicate with wireless communication component of receiving component . Thus second wireless communication component may also operate on in compliance with any suitable wireless communication protocol including but not limited to mesh networking implementations of the IEEE 802.15.4 specification for personal area networks and implementations of the Bluetooth standard as appropriate to communicate with wireless communication component . Processor is configured to process data conveyed from receiving component via second wireless communication component to determine the location of GNSS antenna . It is noted that processor is analogous with processor described above with reference to and . Cellular communication component may operate on any suitable wireless communication protocol including but not limited to Wi Fi WiMAX WWAN implementations of the IEEE 802.11 specification cellular two way radio FM radio and satellite based cellular e.g. via the Inmarsat or Iridium communication networks and is operable for receiving pseudorange correction data from various sources including but not limited to WAAS pseudorange corrections DGPS pseudorange corrections and PPP pseudorange corrections.

In operation GNSS antenna receives GNSS signals from GNSS satellites in view. As will discussed in greater detail below due to its disposition apart from cellular device receiving component is better located to receive GNSS signals than may be the case using a cellular telephone or other portable electronic device alone. As stated above in at least one embodiment GNSS chipset comprises a GNSS chipset operable for processing the respective GNSS signals received by GNSS antenna . In one embodiment GNSS chipset provides one or more of pseudorange information Doppler shift information and real carrier phase information to wireless communication component which in turn forwards that data to cellular device via second wireless communication component . In one embodiment this can be performed automatically and this automatic forwarding of data from receiving component can be initiated when a cellular device is detected in the vicinity. This can further comprise a login handshake procedure. In another embodiment chipset accessor logic is configured to access the GNSS chipset comprising GNSS chipset . Thus chipset accessor logic will generate a message which initiates the sending of pseudorange data from receiving component . Furthermore accessing logic B can initiate accessing carrier phase data from receiving component . In response to requests for this data GNSS chipset can process the signals from the GNSS satellites in view and send the pseudorange and carrier phase data to cellular device via wireless communication component . Processor of cellular device can then use this data to derive the position of GNSS antenna . Additionally using pseudorange corrections received via cellular communication component cellular device can further refine the processing of received GNSS signals as described above.

Unless otherwise specified one or more of the various embodiments described herein can be implemented as hardware such as circuitry firmware or computer readable instructions that are stored on non transitory computer readable storage medium. The computer readable instructions of the various embodiments described herein can be executed by a hardware processor such as central processing unit to cause the cellular device to implement the functionality of various embodiments. For example according to one embodiment the SUPL client and the operations of the flowcharts depicted in are implemented with computer readable instructions that are stored on computer readable storage medium which can be tangible or non transitory or a combination thereof and can be executed by a hardware processor of a cellular device receiving component and cellular device .

In accordance with various embodiments the receiving component shown in receives GNSS satellite radio signals and derives respective carrier phase and pseudorange information derived from each GNSS satellite radio signal it receives. It is noted that additional GNSS information such as Doppler shift information can also be derived by receiving component . Receiving component then wirelessly transmits the carrier phase and pseudorange information to a cellular device . Typically the cellular device is carried by the user wearing hard hat and or . Then the primary processor e.g. processor of derives the position of receiving component using the respective pseudorange and carrier phase information as well as any GNSS corrections received from a corrections source. Typically the GNSS corrections received by cellular device are received via a cellular network and or local Wi Fi . It is noted that processor comprises the primary processor of cellular device rather than a dedicated GNSS processor. Thus various embodiments are able to leverage the greater processing power that is being integrated into cellular devices to improve the performance in determining the position of receiving component or more specifically circularly polarized GNSS antenna .

If both L1 and L2 signals are to be processed the antenna must be capable of receiving both frequencies. This has been found to be extremely difficult if not impossible because of the separation frequency between L1 and L2 and the narrow bandwidths of patch antennas. Therefore most dual frequency systems employ two patch antennas one mounted atop the other as is found in the professional grade GNSS positioning systems. Other physical configurations are possible such as mounting the two patch antennas side by side. A new L2 frequency will become available in the future known as L2C GNSS signal and which can be used in accordance with various embodiments. It will enable direct reception via the same kind of code acquisition and processing as is now used on L1. For many applications a single frequency L1 receiver provides adequate position fix accuracy especially when the various corrections systems recited in previous portions of this application are utilized.

A filter LNA Low Noise Amplifier performs filtering and low noise amplification of both L1 and L2 signals. In some embodiments the downconvertor mixes both L1 and L2 signals in frequency down to approximately 175 MHz and outputs the analog L1 and L2 signals into an IF intermediate frequency processor . In other embodiments such as those shown in and where no L2 component is utilized by the partial GNSS receiver downconvertor may only mix and output the analog L1 signal to the IF processor . IF processor takes the analog L1 and or L2 signals at approximately 175 MHz and converts them into digitally sampled L1 and L2 inphase L1 I and L2 I and quadrature signals L1 Q and L2 Q at carrier frequencies 420 KHz for L1 and at 2.6 MHz for L2 signals respectively.

At least one digital channel processor inputs the digitally sampled L1 and L2 inphase and quadrature signals. All digital channel processors are typically are identical by design and typically operate on identical input samples. Each digital channel processor is designed to digitally track the L1 and L2 signals produced by one satellite by tracking code and carrier signals from code and carrier phase measurements in conjunction with the GNSS microprocessor system . One digital channel processor is capable of tracking one satellite in both L1 and L2 channels. GNSS microprocessor system facilitates tracking and measurements processes providing pseudorange and carrier phase measurements for a determining position fix logic e.g. navigation processor . In one embodiment microprocessor system provides signals e.g. to control the operation of one or more digital channel processors .

In the embodiment shown in the components of partial GNSS chipset A discussed above are the same with the exception that IF processor outputs an L1 signal only. In another embodiment shown in IF processor outputs an L1 signal and an L2C signal only. The L2C GNSS signal is a new GNSS signal being phased in which permits ionospheric correction faster signal acquisition and enhanced reliability. Alternatively as shown in in one embodiment IF processor outputs and L11 and L1Q signal only. Many receivers do not provide L1Q as L1I may be adequate for most applications that do not require professional grade high precision.

According to one embodiment the microprocessor system receives the pseudorange information Doppler Shift information and real Carrier Phase Information from second wireless communication component and provides them to the determining position fix logic e.g. navigation processor and or processes running thereon . Determining position fix logic performs the higher level function of combining measurements in such a way as to produce position velocity and time information for the differential and surveying functions for example in the form of a position fix . Storage is coupled with determining position fix logic and microprocessor system . It is appreciated that storage may comprise a volatile or non volatile storage such as a RAM or ROM or some other computer readable memory device or media. In some embodiments determining position fix logic performs one or more of the methods of position correction described herein.

In some embodiments microprocessor system and or determining position fix logic receive additional inputs for use in receiving corrections information via cellular communication component . According to one embodiment an example of the corrections information is WAAS corrections. According to one embodiment examples of corrections information are differential GPS corrections RTK corrections signals used by the previously referenced Enge Talbot method wide area augmentation system WAAS corrections and PPP corrections among others

In operation the raw GNSS observables information is wirelessly transmitted from the GNSS chipset to the cellular device. As described above in various embodiments wireless communication component is used to wirelessly transmit respective pseudorange information respective carrier phase information derived from each of the GNSS satellite radio signals received via circularly polarized GNSS antenna to a cellular device e.g. of which is separate from receiving component . As described above receiving component can be coupled with various articles of clothing helmets support poles for surveying operations moveable traffic management devices and barriers etc.

In operation the raw GNSS observables information is extracted by a processor of the cellular device. As described above processor is utilized as the primary processor of cellular device .

In operation the raw GNSS observables information is used by the processor in addition to GNSS corrections from at least one correction source to determine a position of the circularly polarized GNSS antenna. As described above in accordance with various embodiments a determination is made whether to apply any improvements including improvements to the pseudorange information using position accuracy improvement determination logic e.g. B of resident upon cellular device . If it is determined that improvements are to be applied by position accuracy improvement determination logic B can determine one or more improvements from a variety of GNSS corrections sources including real carrier phase information reconstructed carrier phase information WAAS DGPS PPP RTX RTK and VRS corrections. In accordance with various embodiments the pseudorange information received by cellular device is smoothed to create smoothed pseudorange information using smoothing logic e.g. of resident upon cellular device . In accordance with various embodiments this smoothing can be based upon real carrier phase information that is derived based on the carrier phase information received from receiving component using real carrier phase logic e.g. A of resident upon cellular device . In accordance with various embodiments the smoothed pseudorange information is corrected using correcting logic e.g. of resident upon cellular device to create corrected pseudoranges. In accordance with various embodiments the GNSS corrections are not contained in a GNSS signal but are received via for example cellular network and or local Wi Fi of . In accordance with various embodiments accessing logic of cellular device e.g. B of is used to access Wide Area Augmentation System WAAS pseudorange corrections. The WAAS pseudorange corrections are stored in a memory device e.g. of . The smoothed pseudorange information described above is accessed as well as the WAAS pseudorange corrections using pseudorange information processing logic e.g. of of cellular device . Cellular device then determines a position fix of circularly polarized GNSS antenna using pseudorange information processing logic based on the smoothed pseudorange information and the WAAS pseudorange corrections using processor of cellular device . In accordance with various embodiments corrected pseudoranges can be created based on one or more types of pseudorange corrections received by cellular device selected from a group consisting of Differential Global Positioning System DGPS Precise Point Positioning PPP Real Time Kinematic RTK and RTX corrections.

In some stand alone embodiments a stand alone radio frequency hardware component A is disposed inside of a housing as depicted. In some embodiments RF hardware component A includes a first antenna a second antenna a digitizer a serializer and an input output I O . In some embodiments where RF hardware component A and communication device A are more highly integrated allowing serializer I O bus and I O to be omitted from the communication path between RF hardware component A and communication device A. Thus in various embodiments RF hardware component A and communication device A may be stand alone physical entities that are removably communicatively coupled by wireline or else wirelessly communicatively coupled one or both may not have a housing or may they may be integrated with one another.

Housing may take any form but in some embodiments is designed to act as a sleeve which includes a receiving cavity into which a portion of particular communication device A snugly fits. In this manner housing is paired in a convenient form factor with a communication device A to which it provides GNSS signals and also serves a dual purpose of providing an external protective covering for some portions of the communication device A. In other embodiments housing may take on the form factor of headwear e.g. disposed in or as part of a helmet cap hardhat or other head wear in the manner previously depicted herein . In yet other embodiments housing may take on other form factors.

First antenna is a narrow band antenna and may take any suitable form such including that of a patch antenna or a helical antenna. First antenna is configured in one embodiment for receiving over the air analog L2C Global Positioning System GPS signals in the 1217 1237 MHz frequency range. Second antenna is a narrow band antenna and may take any suitable form including that of a patch antenna or a helical antenna. Second antenna is configured for receiving over the air analog L1 GNSS signals in the 1525 1614 MHz frequency range. In various embodiments the L1 signals may be analog L1 GPS signals or analog L1 GPS signals and one or more of analog L1 Galileo signals and analog pseudolite transmitted GNSS signals in the L1 band. Any received pseudolite signals will be in code division multiple access CDMA format like the GPS and Galileo L1 signals and like the modernized BeiDou and Glonass L1 signals which will be centered 1575.42 MHz . In some embodiments the first antenna is configured to be able to receive either or both of these modernized BeiDou and Glonass signals when they are available. In some embodiments first antenna and second antenna may share a common phase center with one another. In other embodiments first antenna and second antenna may be separated by a known distance between their respective phase centers which is compensated for during position determination.

Digitizer A operates to amplify and down convert the L2C and L1 signals received respectively from antennas and and then perform an analog to digital conversion by digitally sampling the down converted L1 and L2C signals. The outputs of digitizer A are a digitized version of the down converted L1 signals and a digitized version of the down converted L2C signals that have been received.

Serializer operates to form the digitized L1 signals and the digitized L2C signals into a serialized output signal which is then output from a stand alone embodiment of RF hardware component A. For example as illustrated the serialized output signal can be output via input output which may be a USB port or some other type of port.

Bus e.g. a USB cable coupled to I O communicatively couples the serialized output signal to an I O of communication device A. Bus illustrates a serial bus which may comply with a Universal Serial Bus e.g. USB 2.0 standard or other communication protocol. In some embodiments bus is a separate component that is not a part of either RF hardware component A or communication device A. It is appreciated that other wireline or wireless means for exchanging data over a short distance less that approximately 7 meters besides bus may be employed in various embodiments. In some embodiments bus provides power from communication device A to components of an RF hardware component while in other embodiments the RF hardware component uses other internal or external sources of power.

Communication device A is disposed inside a housing and in some embodiments includes one or more processors a software defined GNSS soft GNSS receiver as an application running on at least one processor storage e.g. one or more of random access memory read only memory optical storage and magnetic storage a display an I O and a transceiver e.g. a cellular transceiver Wi Fi transceiver digital two way radio transceiver an L band satellite receiver or other RF transceiver . In some embodiments communication device A further includes an internal GNSS receiver chipset . Storage may hold computer executable instructions that can be executed by processor to implement the soft GNSS receiver application. In some embodiment where RF hardware component A and communication device A are integrated they may share a single housing and input output may be omitted from the communications path between RF hardware component A and communication device A and may also be omitted from communication device A in some embodiments . In some embodiments one or more of storage display transceiver and internal GNSS receiver chipset when included are communicatively coupled with processor s such as via bus .

Processor is external to any GNSS chipset of communication device A. In some embodiments processor is a central or host processor of communication device A. In other embodiments processor is a graphics processing unit GPU a digital signal processor or other microprocessor of a communications device A.

Communication device A is a device that is capable of two way RF communication and may be a device such as but not limited to a cellular telephone a tablet computer a two way non cellular radio a dedicated short range communication DSRC radio or a software defined radio. In one embodiment the DSRC radio complies with Institute of Electrical and Electronics Engineers IEEE 802.11p standards. In one embodiment the DSRC radio may be implemented as a software defined radio compliant with IEEE 802.11p standard and running on one or more processors.

Housing may take many sizes shapes and forms many of which are hand holdable by a human or wearable by a human. Some forms include the form factor of a cellular telephone the form factor of a tablet computer the form factor of a phablet computer an in between size between that of a smart phone and a tablet computer the form factor of headwear e.g. disposed in or as part of a helmet cap hardhat or other head wear and the form of eyewear e.g. Google Glass or similar head up eyewear communication devices .

Software defined GNSS receiver utilizes L1 and L2C signals received via I O to perform position determination. For example software defined GNSS receiver decodes first information e.g. L2C signals from the first digitized GNSS signal that is included in the serialized output signal from RF hardware component A. Software defined GNSS receiver also decodes second information e.g. L1 I and L1 Q signals from the second digitized GNSS signal that has been serialized into the serialized output signal from RF hardware component A. A combination of the first information and the second information e.g. L2C GPS signals and L1 GPS signals is used to perform carrier phase interferometry to correct the carrier phase of the L1 signals for perturbations caused by ionospheric interference. The corrected L1 GPS signals are then used by software defined GNSS receiver to perform position determination. They can be used alone or in combination with other L1 signals that have been decoded from the second digitalized GNSS signal that has been serialized into the serialized output signal from RF hardware component A. These other L1 signals include one or more of L1 Galileo signals L1 BeiDou signals L1 Glonass signals and L1 pseudolite signals. In some embodiments the software defined GNSS receiver also receives over its own communication means e.g. transceiver one or more of WAAS DGPS PPP RTX RTK SBAS and VRS corrections that can be applied while performing the position determination.

Digitizer B operates similarly to digitizer A to amplify and down convert the L2C and L1 signals received respectively from antennas and and then perform an analog to digital conversion by digitally sampling the down converted L1 and L2C signals. Digitizer B additionally operates to amplify and down convert the GNSS signals received from antenna and then perform an analog to digital conversion by digitally sampling the down converted GNSS signals. The outputs of digitizer B are digitized versions of the down converted L1 signals a digitized version of the down converted L2C signals and a digitized version of the down converted signals from antenna .

Serializer when included operates to form the digitized versions of the signals received via antennas and into a serialized output signal which is then output from RF hardware component B. For example as illustrated the serialized output signal can be output via input output which may be a USB port or some other type of port. A bus e.g. a USB cable coupled to I O communicatively couples the serialized output signal to an I O of communication device A.

Software defined GNSS receiver utilizes L1 and L2C signals received via I O to perform position determination in the manner previously described above except that software defined GNSS receiver may additionally utilize L1 or L5 signals received via antenna to assist in performing position determination. As previously described in some embodiments the software defined GNSS receiver also receives over its own communication means e.g. transceiver one or more of WAAS DGPS PPP RTX RTK SBAS and VRS corrections that can be applied while performing the position determination.

In operation in one embodiment antenna receives L2C GNSS signals over the air. Band pass filter operates to pass the band of the L2C signals. In some embodiments band pass filter is configurable to a particular frequency band and width of frequency passed. In many embodiments band pass filter is configured to have a frequency width that is similar to or the same as the same sampling rate used for analog to digital conversion by RFIC A. For example since the chipping rate of an L2C signal is 1.023 MHz it may be sampled for analog to digital conversion at approximately 2 MHz or twice the chipping rate. In one embodiment band pass filter may thus be configured to pass a 2 MHz band with 1 MHz being on each side of the L2C center frequency of 1 227.60 MHz. Band pass filter outputs a first analog GNSS signal A e.g. a filtered L2C signal that has been received over the air to RFIC A. RFIC A utilizes a reference frequency A supplied by signal source e.g. a fixed frequency or configurable temperature controlled crystal oscillator to down convert first analog GNSS signal A. The down converted version of first analog GNSS signal A is then sampled digitized and output to serializer as a first digitized GNSS signal A.

In operation in one embodiment antenna receives L1 GNSS signals over the air. Band pass filter operates to pass the band of the L1 signals. In some embodiments band pass filter is configurable to a particular frequency band and width of frequency passed. In many embodiments band pass filter is configured to have a frequency width that is similar to or the same as the same sampling rate used for analog to digital conversion by RFIC B. For example since the chipping rate of an L1 GPS signal is 1.023 MHz it may be sampled for analog to digital conversion at approximately 2 MHz or twice the chipping rate. In one embodiment band pass filter may thus be configured to pass a 2 MHz band with 1 MHz being on each side of the L1 GPS center frequency of 1 575.42 MHz. Band pass filter outputs a second analog GNSS signal B e.g. a filtered L1 GPS signal that has been received over the air to RFIC B. RFIC B utilizes a reference frequency B supplied by signal source to down convert second analog GNSS signal B. The down converted version of second analog GNSS signal B is then sampled digitized and output to serializer as a second digitized GNSS signal B.

Serializer operates to serialize the second digitized GNSS signal B i.e. digitized L1 GPS signals and the first digitized GNSS signal A i.e. digitized L2C signals into a serialized output signal which is then output from RF hardware component A.

I O and serializer also operate as a serial periphery interface SPI in some embodiments to receive configuration commands from processor of communication device A. SPIs includes SPI which provides configuration to RFIC A SPI which provides configuration instruction to signal source and SPI which provides configuration to RFIC B. In integrated embodiments where I O and serializer are not utilized SPIs may be replaced by other communication paths with processor .

At of flowchart a first analog Global Navigation Satellite System GNSS signal in a first frequency band is received over the air with a first antenna of a radio frequency hardware component. For example this may comprise an antenna of an RF hardware component receiving an analog L2C GPS signal that is in the L2 frequency band.

At of flowchart at least a second analog GNSS signal in a second frequency band is received over the air with a second antenna of the radio frequency hardware component where the first frequency band and the second frequency band are separate and distinct. For example this may comprise antenna of an RF hardware component receiving an L1 GPS signal that is in the L1 frequency band. In some embodiments this may additionally include antenna receiving one or more of an analog L1 Galileo signal a modernized analog L1 BeiDou signal a modernized analog Compass signal and an analog L1 pseudolite signal. In some embodiments antenna may also receive analog L1 GNSS signals from one or more of BeiDou satellites i.e. conventional L1 BeiDou Glonass satellites i.e. conventional L1 Glonass or from terrestrial pseudolite s that are in a frequency division multiple access format.

At of flowchart the first analog GNSS signal is digitized into a first digitalized GNSS signal A with a digitizer of the radio frequency hardware component. For example in one embodiment this comprises using a digitizer of an RF hardware component to digitize the L2C GPS signal.

At of flowchart the second analog GNSS signal is digitized into a second digitalized GNSS signal B with a digitizer of the radio frequency hardware component. For example in one embodiment this comprises using the digitizer of an RF hardware component to digitize the L1 GPS signal. In some embodiments additional L1 GNSS signals received by antenna are from a disparate GNSS system that uses the same channel access method e.g. CDMA is also digitized into additional digitized GNSS signals C. For example in one embodiment digitizer also digitizes received L1 Galileo signals received L1 BeiDou CDMA signals i.e. modernized L1 BeiDou received L1 Glonass CDMA signals i.e. modernized L1 Glonass and or received L1 pseudolite signals. In some embodiments additional L1 GNSS signals received by antenna are from a disparate GNSS system that uses a different channel access method e.g. FDMA is also digitized into additional digitized GNSS signals C. For example in one embodiment digitizer also digitizes received L1 Galileo signals received L1 BeiDou CDMA signals i.e. modernized L1 BeiDou received L1 Glonass CDMA signals i.e. modernized L1 Glonass and or received L1 pseudolite signals. It is appreciated that FDMA and CDMA signals received by a signal antenna are processed with different RFICs from one another and sometimes with different filters from one another.

In some embodiments the RF hardware component may include an additional antenna such as antenna that receives yet another analog GNSS signal over the air. For example in one embodiment an analog L5 GNSS signal may be received in the L5 frequency band. This received L5 signal is digitized into yet another digitized GNSS signal C by digitizer . In one example embodiment where an analog L5 GPS signal is received over the air via antenna the L5 GPS signal is digitized by digitizer . Similarly analog pseudolite transmitted signals may be received in the L5 band by antenna . In another embodiment antenna receives analog L1 GNSS signals from one or more of BeiDou satellites i.e. conventional L1 BeiDou Glonass satellites i.e. conventional L1 Glonass or from terrestrial pseudolite s that are in a frequency division multiple access format. The received analog L1 Glonass signals analog L1 BeiDou signals or analog L1 pseudolite signals are digitized into digitized GNSS signals C by digitizer . In another embodiment antenna receives analog SBAS signals from one or more satellites that provide GNSS corrections services e.g. Indian GPS aided Geo Augmented Navigation System GAGAN European Geostationary Navigation Overlay Service EGNOS Japanese Multi functional Satellite Augmentation System MSAS John Deere s StarFire WAAS and Trimble s OmniSTAR to name several . The received analog SBAS signals are digitized into digitized signals by digitizer B of RF hardware component in a similar manner to digitized GNSS signals .

In some embodiments the digitized GNSS signals and digitized SBAS signals if received are serialized for transmission to a separately implemented communication device . In some embodiments where the RF hardware component and the communication device are more integrated the digitized GNSS signals are directly provided without being serialized as an interim step to a processor of the communication device .

At of flowchart the digitized GNSS signals and SBAS signals if received and digitized are received at a communication device located proximate to the radio frequency hardware component where the communication device comprises an internal GNSS receiver chipset . In some embodiments the digitized GNSS signals are received as a serial transmission at a communication device located proximate to and removably coupled with the radio frequency hardware component . The digitized GNSS signals are serialized into the serialized transmission by a serializer of the radio frequency hardware component . In one embodiment proximate means that communication device is located no more than 7 meters from radio frequency hardware component . In one embodiment proximate means that communication device is located no more than three centimeters from radio frequency hardware component . In one embodiment proximate means that an external housing of communication device physically touches an external housing of radio frequency hardware component .

At of flowchart a software defined GNSS receiver operating on a processor of the communication device is used to determine first information from the first digitized GNSS signal and to determine second information from the second digitized GNSS signal. The processor is located outside of any imbedded GNSS receiver chipset of the communication device . In general a combination of at least the first information and the second information is used by the soft GNSS receiver to determine a position. In some embodiments the first and second information are used to determine a two code position solution e.g. L2C code and L1 code . In some embodiments the first and second information are used to perform carrier phase interferometry to reduce ionospheric distortions of signals received from a particular GNSS satellite from which signals on two different frequencies have been provided as the first and second digitized GNSS signals. For example this can comprise soft GNSS receiver receiving the digitized GNSS signals and decoding at least L2C pseudoranges from the digitized L2C GPS signals as the first information and decoding at least L1 pseudoranges from the digitized L1 GPS signals. The decoded information from signals in separate frequency bands from a single satellite is used to perform carrier phase interferometry to produce an ionosphere free L1 signal that has ionospheric perturbations cancelled out. Techniques for production of such an ionosphere free L1 signal are well known in the art. The position determination is carried out by soft GNSS receiver using code of the ionosphere free L1 signal and the code of the L2C signal. In some embodiments L1 signals received from additional GNSS systems that are disparate from the GPS system may be included with L1 GPS signal when carrying out the position determination.

In some embodiments corrections information received by transceiver may also be supplied to and used by soft GNSS receiver to further refine a position that is determined. In some embodiments SBAS signals that are received by RF hardware component are supplied to soft GNSS receiver and used to further refine a position that is determined.

At of flowchart a first analog Global Navigation Satellite System GNSS signal in a first frequency band is received over the air with a first antenna of a radio frequency hardware component that is coupled with a vehicle. For example as depicted in this may comprise an antenna of an RF hardware component receiving an analog L2C GPS signal that is in the L2 frequency band.

At of flowchart at least a second analog GNSS signal in a second frequency band is received over the air with a second antenna of the radio frequency hardware component where the first frequency band and the second frequency band are separate and distinct. For example as depicted in this may comprise antenna of an RF hardware component receiving an L1 GPS signal that is in the L1 frequency band. In some embodiments this may additionally include antenna receiving one or more of an analog L1 Galileo signal a modernized analog L1 BeiDou signal a modernized analog Compass signal and an analog L1 pseudolite signal. In some embodiments antenna may also receive analog L1 GNSS signals from one or more of BeiDou satellites i.e. conventional L1 BeiDou Glonass satellites i.e. conventional L1 Glonass or from terrestrial pseudolite s that are in a frequency division multiple access format.

At of flowchart the first analog GNSS signal is digitized into a first digitalized GNSS signal A with a digitizer of the radio frequency hardware component. For example in one embodiment this comprises using a digitizer of an RF hardware component to digitize the L2C GPS signal.

At of flowchart the second analog GNSS signal is digitized into a second digitalized GNSS signal B with a digitizer of the radio frequency hardware component. For example in one embodiment this comprises using the digitizer of an RF hardware component to digitize the L1 GPS signal. In some embodiments additional L1 GNSS signals received by antenna are from a disparate GNSS system that uses the same channel access method e.g. CDMA is also digitized into additional digitized GNSS signals C. For example in one embodiment digitizer also digitizes received L1 Galileo signals received L1 BeiDou CDMA signals i.e. modernized L1 BeiDou received L1 Glonass CDMA signals i.e. modernized L1 Glonass and or received L1 pseudolite signals. In some embodiments additional L1 GNSS signals received by antenna are from a disparate GNSS system that uses a different channel access method e.g. FDMA is also digitized into additional digitized GNSS signals C. For example in one embodiment digitizer also digitizes received L1 Galileo signals received L1 BeiDou CDMA signals i.e. modernized L1 BeiDou received L1 Glonass CDMA signals i.e. modernized L1 Glonass and or received L1 pseudolite signals. It is appreciated that FDMA and CDMA signals received by a signal antenna are processed with different RFICs from one another and sometimes with different filters from one another.

In some embodiments the RF hardware component may include an additional antenna such as antenna that receives yet another analog GNSS signal over the air. One such embodiment is illustrated in . For example in one embodiment an analog L5 GNSS signal may be received in the L5 frequency band. This received L5 signal is digitized into yet another digitized GNSS signal C by digitizer . In one example embodiment where an analog L5 GPS signal is received over the air via antenna the L5 GPS signal is digitized by digitizer B. Similarly analog pseudolite transmitted signals may be received in the L5 band by antenna . In another embodiment antenna receives analog L1 GNSS signals from one or more of BeiDou satellites i.e. conventional L1 BeiDou Glonass satellites i.e. conventional L1 Glonass or from terrestrial pseudolite s that are in a frequency division multiple access format. The received analog L1 Glonass signals analog L1 BeiDou signals or analog L1 pseudolite signals are digitized into digitized GNSS signals C by digitizer B of RF hardware component . In another embodiment antenna receives analog SBAS signals from one or more satellites that provide GNSS corrections services e.g. Indian GPS aided Geo Augmented Navigation System GAGAN European Geostationary Navigation Overlay Service EGNOS Japanese Multi functional Satellite Augmentation System MSAS John Deere s StarFire WAAS and Trimble s OmniSTAR to name several . The received analog SBAS signals are digitized into digitized signals by digitizer B of RF hardware component in a similar manner to digitized GNSS signals .

In some embodiments the digitized GNSS signals and digitized SBAS signals if received are serialized for transmission to a separately implemented communication device . In some embodiments where the RF hardware component and the communication device B are more integrated the digitized GNSS signals are directly provided without being serialized as an interim step to a processor of the communication device .

At of flowchart the digitized GNSS signals and SBAS signals if received and digitized are received at a communication device B of the vehicle. In some embodiments the digitized GNSS signals are received as a serial transmission at communication device B. For example the digitized GNSS signals are serialized into the serialized transmission by a serializer of the radio frequency hardware component or . In one embodiment communication device B is located in the same vehicle and no more than 7 meters from radio frequency hardware component .

At of flowchart a software defined GNSS receiver operating on a processor of the communication device B is used to determine first information from the first digitized GNSS signal and to determine second information from the second digitized GNSS signal. In general a combination of at least the first information and the second information is used by the soft GNSS receiver to determine a position. In some embodiments the first and second information are used to determine a two code position solution e.g. L2C code and L1 code . In some embodiments the first and second information are used to perform carrier phase interferometry to reduce ionospheric distortions of signals received from a particular GNSS satellite from which signals on two different frequencies have been provided as the first and second digitized GNSS signals. For example this can comprise soft GNSS receiver receiving the digitized GNSS signals and decoding at least L2C pseudoranges from the digitized L2C GPS signals as the first information and decoding at least L1 pseudoranges from the digitized L1 GPS signals. The decoded information from signals in separate frequency bands from a single satellite is used to perform carrier phase interferometry to produce an ionosphere free L1 signal that has ionospheric perturbations cancelled out. Techniques for production of such an ionosphere free L1 signal are well known in the art. The position determination is carried out by soft GNSS receiver using code of the ionosphere free L1 signal and the code of the L2C signal. In some embodiments L1 signals received from additional GNSS systems that are disparate from the GPS system may be included with L1 GPS signal when carrying out the position determination.

In some embodiments corrections information received by transceiver may also be supplied to and used by soft GNSS receiver to further refine a position that is determined. In some embodiments SBAS signals that are received by RF hardware component are supplied to soft GNSS receiver and used to further refine a position that is determined.

Example embodiments of the subject matter are thus described. Although the subject matter has been described in a language specific to structural features and or methodological acts it is to be understood that the subject matter defined in the appended claims is not necessarily limited to the specific features or acts described above. Rather the specific features and acts described above are disclosed as example forms of implementing the claims.

Various embodiments have been described in various combinations and illustrations. However any two or more embodiments or features may be combined. Further any embodiment or feature may be used separately from any other embodiment or feature. Phrases such as an embodiment one embodiment among others used herein are not necessarily referring to the same embodiment. Features structures or characteristics of any embodiment may be combined in any suitable manner with one or more other features structures or characteristics.

