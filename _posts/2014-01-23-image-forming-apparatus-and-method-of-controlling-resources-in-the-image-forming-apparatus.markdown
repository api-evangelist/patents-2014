---

title: Image forming apparatus and method of controlling resources in the image forming apparatus
abstract: An image forming apparatus includes a resource management part that manages, as a plurality of resources, image data to be used by a plurality of processes concerning a module in the image forming apparatus or a storage area that stores the image data, and one or more units of hardware; and an exclusive control part that, in a case where at least one resource of the plurality of resources is used, carries out exclusive control of the at least one resource, and stops or finishes exclusive control of the module.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09036193&OS=09036193&RS=09036193
owner: RICOH COMPANY, LTD.
number: 09036193
owner_city: Tokyo
owner_country: JP
publication_date: 20140123
---
In the related art a MultiFunction Peripheral MFP is known which includes respective functions as a facsimile machine a printer a copying machine a scanner and so forth. In such a MFP a processing speed is increased and also a time required for transferring image data is increased due to implementation of high resolution and implementation of high gradation. Therefore it is important to handle and process information in a management area at high speed. Japanese Laid Open Patent Application No. 2005 202890 Patent Document No. 1 discloses an image forming apparatus and a hard disk management method for preventing inconsistency in data otherwise occurring due to power discontinuity or the like and maintaining consistency in data stored in a hard disk.

According to one aspect of the present invention an image forming apparatus includes a resource management part that manages as a plurality of resources image data to be used by a plurality of processes concerning a module in the image forming apparatus or a storage area that stores the image data and one or more units of hardware and an exclusive control part that in a case where at least one resource of the plurality of resources is used carries out exclusive control of the at least one resource and stops or finishes exclusive control of the module.

Other objects features and advantages of the present invention will become more apparent from the following detailed description when read in conjunction with the accompanying drawings.

First for the sake of convenience of explanation a problem to be solved by the embodiments will be described.

In the above mentioned art disclosed by Patent Document No. 1 exclusive control is carried out while attaching importance to consistency in data and it is not possible to interrupt a process concerning exclusive control for another process.

The embodiments according to the present invention have been devised in consideration of the above mentioned problem and an objective is to provide an image forming apparatus in which it is possible to reduce a delay occurring due to exclusive control.

In the embodiments of the present invention it is possible to provide image forming apparatuses in which it is possible to reduce a delay occurring due to exclusive control.

Below the embodiments of the present invention will be described with reference to the accompanying drawings.

The MFP starting part is first started up when the power is supplied in the MFP and starts up an application layer and a platform layer in the software group . For example the MFP starting part reads out from a hard disk drive described later or the like programs included in the application layer and the platform layer transfers the thus read out programs to a memory area and thus starts up the programs.

The software group includes the application layer and the platform layer started up on an Operating System OS such as UNIX registered trademark . The application layer includes programs for carrying out processes unique to user services concerning image formation such as a printer service a copy service a facsimile service and a scanner service.

The application layer includes a printer application a copy application a facsimile application a scanner application and so forth. The printer application is an application for a printer. The copy application is an application for copying. The facsimile application is an application for facsimile. The scanner application is an application for a scanner.

The platform layer includes a control service layer a System Resource Manager SRM and a handler layer . The control service layer interprets process requests sent from the application layer and generates acquisition requests for obtaining the hardware resources . The SRM manages the one or more hardware resources and carries out arbitration of the acquisition requests sent from the control service layer . The handler layer manages the hardware resources in response to the acquisition requests sent from the SRM .

The control service layer includes one or more service modules such as a Network Control Service NCS a Delivery Control Service DCS an Operation Control Service OCS a Facsimile Control Service FCS an Engine Control Service ECS a Memory Control Service MCS a User information Control Service UCS a System Control Service SCS and so forth.

Note that the platform layer has an Application Programming Interface API for making it possible to receive the process requests from the application layer through a previously defined function s . The OS executes as processes respective units of software in the application layer and the platform layer in parallel.

A process of the NCS provides a service that can be used in common by applications that require inputting to and outputting from a network. The NCS carries out intermediate transmission of data such as distribution of data obtained through each protocol from a network to applications and transmission of data from applications to a network. For example the NCS controls data communication with a network device connected via a network using Hyper Text Transfer Protocol Daemon httpd in Hyper Text Transfer Protocol HTTP .

A process of the DCS carries out control of delivery of a stored document and so forth. A process of the OCS carries out control of an operation panel that is used as an information transmission device between a human operator and main control. A process of the FCS provides an API for carrying out facsimile transmission and reception using PSTN or the like requested by the application layer registration and or citation of various sorts of facsimile data managed in a memory prepared for backup reading data for facsimile transmission receiving and printing facsimile data and so forth.

A process of the ECS controls engine parts such as the scanner the monochrome LP the color LP and the other resources . A process of the MCS carries out memory control for obtaining and releasing a memory and using the hard disk drive. A process of the UCS manages user information.

A process of the SCS carries out processes of managing the applications controlling an operation part displaying a system screen page displaying information using a LED managing the hardware resources carrying out interrupt control for an application and so forth.

A process of the SRM carries out arbitration in response to an acquisition request sent from a host layer that uses resources including the hardware resources such as the scanner the monochrome LP the color LP and controls execution thereof. Specifically a process of the SRM determines whether a resource is available whether the resource is used by another acquisition request and notifies the host layer that the resource concerning the acquisition request is available if it is available. A process of the SRM carries out scheduling for using a resource s in response to an acquisition request from the host layer and directly executes the required contents for example conveying paper and forming an image in the printer engine securing a memory generating a file and so forth .

The handler layer includes a FaCsimile Unit Handler FCUH that manages a Facsimile Control Unit FCU described later and an Image Memory Handler IMH that allocates a memory to a process and manages the allocated memory. The SRM and the FCUH send process requests to the hardware resources using an Engine Interface engine I F by which it is possible to send the process requests to the hardware resources using a previously defined function s .

Further the IMH manages as resources the hardware resources and image data or a storage area that stores image data. Further the IMH carries out exclusive control of these resources using a mechanism of exclusive control provided by the OS and thus prevents collision of information and or hardware.

The MFP can execute in an integrated manner processes necessary for respective applications in common in the platform layer .

In the above described configuration in a case of reading an image a request occurs from the copy application the facsimile application the scanner application or the like. In response to the request data of the image read by the scanner is written into a storage area in a memory or the like via the platform layer . The image data written into the storage area can be for example printed using the monochrome LP the color LP or the like via the engine I F .

The operation panel is connected with the ASIC in the controller board . Further the SB the NIC the USB device the IEEE 1394 device and the centronics device are connected with the NB via a PCI bus. Further the FCU and the engine part are connected with the ASIC on the controller board via a PCI bus.

Note that in the controller board the local memory the HDD and so forth are connected with the ASIC and also the CPU and the ASIC are connected together via the NB in a CPU chip set. As a result of the CPU and the ASIC being connected together via the NB proper operations can be carried out even in a case where an interface of the CPU is not open.

Further the ASIC and the NB are connected not via a PCI bus but via an Accelerated Graphic Port AGP . By thus connecting the ASIC and the NB not via a low speed PCI bus but via the AGC for the purpose of controlling execution of one or more processes included in the application layer or the platform degradation in performance is avoided.

The CPU controls the entirety of the MFP . The CPU starts up the NCS the DCS the OCS the FCS the ECS the MCS the UCS the SCS the SRM the FCUH and the IMH on the OS to cause them to function as respective processes and implements them respectively. Further the CPU also starts up and implements the printer application the copy application the facsimile application and the scanner application included in the application layer in the same way.

The NB is a bridge for connecting the system memory the SB and the ASIC . The system memory is a memory for drawing an image prepared for the MFP or the like. The SB is a bridge for connecting the NB the PCI bus and peripheral devices. The local memory is a memory to be used as a buffer for an image to be copied and a buffer for storing code. The system memory or the local memory may be simply referred to as a memory or a storage area hereinafter.

The ASIC is an IC for the purpose of image processing and has hardware elements prepared for image processing. The HDD is a storage to be used for storing images programs font data forms and so forth. The operation panel is an operation part that receives a user s input and also carries out displaying information for a user.

The modules and are actually a program s for causing the CPU or the like to implement predetermined functions and for example are an application s included in the application layer and or a service s included in the control service layer . The resource management part manages as the resources the hardware resource image data storage areas that store image data and so forth. The exclusive control part carries out exclusive control of the resources and the modules and and so forth. Note that the resource management part and the exclusive control part are implemented by for example a program s executed by the CPU . The program s can be stored in for example the storage device such as the HDD and or the recording medium such as a USB memory or the like connected with the USB device or the like.

Next relationships between the modules and the resources will be described. shows relationships between the modules and the resources in one example according to any one of the embodiments. The module uses in its process the hardware resources and and image data . The resource management part manages as the resources these hardware resources image data and so forth. Note that in a case where a plurality of the identical hardware units are installed as in the hardware resource the plurality of hardware units can be managed as a single resource.

Depending on a process that the module executes necessary resources are predetermined and unnecessary resources are not accessed. Therefore the exclusive control part carries out exclusive control depending on the resources necessary for a process.

The exclusive control part carries out exclusive control of the resource for example in a case where the resource is used by a process of the module and stops or finishes the exclusive control of the resource when the use of the resource has been finished. However a deadlock may occur when the rights for the respective resources are obtained at random. Therefore exclusive control of the module is carried out before each resource is used and a process of the module obtains the right for each resource via the module .

In a case where a process 1 1 that is a process corresponding to the resource in the process 1 uses the resource the exclusive control part carries out exclusive control of the module at a time T1 and after that the exclusive control part starts exclusive control of the resource at a time T3. Note that according to the first embodiment description is made assuming that at the time T3 at which the exclusive control part starts the exclusive control of the resource or before that the exclusive control part stops or finishes the exclusive control of the module . However such a manner does not limit the scope of the present invention. For example it is also possible that after the exclusive control part starts the exclusive control of the resource the exclusive control part stops or finishes the exclusive control of the module . After the use of the resource by the process 1 1 has been finished at a time T5 the resource management part finishes the exclusive control of the resource .

When the process 1 1 has been finished at the time T5 a process 1 2 that is a process concerning the next resource is started. The exclusive control part carries out exclusive control of the module at the time T5 and after that starts exclusive control of the resource at a time T7. Note that the exclusive control part finishes the exclusive control of the module at the time T7 of starting the exclusive control of the resource or before that. Also as for a process 1 3 and a process 1 4 the processes are carried out in the same way in sequence. Finally a process 1 5 is executed and the process 1 is completed at a time T19. Thus the exclusive control part subdivides the exclusive control concerning the process 1 into the plurality of process units to correspond to the respective resources to be used. Further the exclusive control part stops or finishes the exclusive control of the module during carrying out the process concerning each resource.

Next operations for a case of two processes will be described. shows a flow of a process in the related art in a case where the first embodiment is not applied. In a process 1 is a process using the resources and . Further a process 2 is a process using the resources and . In exclusive control concerning the process 1 is not subdivided into a plurality of process units to correspond to the respective resources whereas the process is subdivided into the plurality of process units to correspond to the respective resources in the case of described above. Therefore exclusive control of the module is continuously carried out on the module from a time T1 of starting the process 1 until a time T9 of finishing the process 1. Therefore the process 2 cannot be started until the time T9 and thus a large delay may occur.

Next shows a flow of exclusive control according to the first embodiment for a case of two processes. In at a time T1 a process 1 1 included in a process 1 concerning the resource is started. In response the exclusive control part carries out exclusive control of the module . During a period of time of the exclusive control being carried out the module is not available to be used for any process other than the process 1 1. Next the exclusive control part finishes the exclusive control of the module at a time T3 and carries out exclusive control of the resource . Thereby the process 1 1 can use the resource . On the other hand the resource is not available to be used by any process other than the process 1 1.

When the exclusive control of the module has been thus stopped or finished at the time T3 a process 2 1 in the process 2 concerning the resource is started. In response to the start of the process 2 1 the exclusive control part starts exclusive control of the module at the time T3 and the module is not available to be used for any process other than the process 2 1.

At a time T5 the exclusive control part finishes the exclusive control of the module concerning the process 2 1 and starts exclusive control of the resource . On the other hand when the process concerning the resource for the process 1 1 has been finished the exclusive control part finishes the exclusive control of the resource . At the time T5 the process 1 1 is finished and thus the module is available. Therefore a process 1 2 concerning the resource that is a next resource in the process 1 is started. The exclusive control part starts exclusive control of the module in response to the start of the process 1 2.

At a time T7 the exclusive control part finishes the exclusive control of the module concerning the process 1 2 and starts exclusive control of the resource . On the other hand when the process 2 1 has been finished at the time T7 the exclusive control part finishes the exclusive control of the resource . Further at the time T7 a process 2 2 concerning the resource that is a next resource in the process 2 is started. In response to the start of the process 2 2 the exclusive control part starts exclusive control of the module at the time T7.

At a time T9 the exclusive control part finishes the exclusive control of the module concerning the process 2 2 and starts exclusive control of the resource . Further in the process 1 at the time T9 the process 1 2 is finished and the process 1 3 is proceeded with. Next in the process 2 at a time T11 the process 2 2 is finished and the process 2 3 is proceeded with.

Thus the exclusive control concerning the respective processes is subdivided into a plurality of process units corresponding to the plurality of resources. Thereby it is possible to carry out exclusive control of the minimum necessary resource s or module s . Therefore it is possible to reduce a delay caused by exclusive control in a case where a plurality of processes operate in parallel.

Explanation will be made using a specific example concerning correspondence between the resources and and the respective hardware resources in . For example in it is assumed that the resource is a temporary storage area for data the resource is the color LP and the resource is the scanner . Further the process 1 is assumed to be a process of printing data in the temporary storage area using the color LP . The process 2 is assumed to be a process of storing data that is input through the scanner in the temporary storage area.

In this case in a manner of operations as that shown in until a process of printing data in the temporary storage area using the color LP is finished a process of inputting data through the scanner cannot be carried out. In contrast thereto according to the first embodiment shown in between a period of time T3 T5 of reading data from the temporary storage area and a period of time T7 T9 of printing the data using the color LP it is possible to input data through the scanner .

Note that in and for the purpose of simplifying explanation the period of time of exclusive control for each process is assumed to be equal. However the scope of the present invention is not limited in this manner. For example at a time T5 in the exclusive control of the module for the process 2 1 is finished and the exclusive control of the resource is started. However for example if the process 2 1 executed by the module has been completed at the time T4 the exclusive control of the module can be finished and also the exclusive control of the resource can be started at the time T4. The same manner of carrying out exclusive control of only a necessary module or resource only during a necessary period of time can also be applied to the periods of time of carrying out the exclusive control for the other processes.

Next operations in a case where a collision occurs among a plurality of processes for a resource will be described. shows a flow of exclusive control in a case of three processes. Note that since a basic flow of exclusive control is the same as description will be made in a manner of focusing at points different from .

Processes 1 2 and 3 to be carried out by the module use the resource and the resource the resource and the resource and the resource and the resource respectively. Therefore every one of the processes 1 2 and 3 uses the resource .

At a time T1 in the exclusive control part carries out exclusive control of the module for the process 1 1. Next at a time T4 the exclusive control of the module for the process 1 1 is finished and exclusive control of the resource is started. When the module is thus available at the time T4 the exclusive control part carries out exclusive control of the module for the process 2 1. Thereafter at a time T5 the exclusive control of the module for the process 2 1 is finished and exclusive control of the resource is started. Since the exclusive control of the module for the process 2 1 is finished at the time T5 the module is available to be used for another process. However since the processes 1 and 2 are using the other resources the module cannot be used for any one of the processes 1 and 2. At this time the module is available to be used for a process 3 that is a new process.

At the time T5 the exclusive control part carries out exclusive control of the module for the process 3 1 and finishes the exclusive control of the module at a time T6. However at the time T6 the resource that the process 3 1 is to use is already used by the process 2 1. Therefore the process 3 1 cannot obtain the use right for the resource .

When the process 2 1 has been finished and the exclusive control of the resource has been finished at a time T7 the resource is available. However at the time T7 the exclusive control of the module for the process 1 2 is also finished. Therefore at the time T7 use requests for the resource occur from both the process 1 2 and the process 3 1. It is assumed that the exclusive control part allocates the resource preferentially to the process 1 2 concerning the process 1 the execution of which has been started prior to the execution of the process 3. In this case the exclusive control part starts exclusive control of the resource for the process 3 1 at the time T9 at which the process 1 2 has been completed and the exclusive control of the resource has been finished.

Similarly at a time T11 collision of requests occurs between the process 2 3 and the process 3 2 for the module . In this case the exclusive control part allocates the resource preferentially to the process 2 3 concerning the process 2 the execution of which has been started prior to the execution of the process 3.

Note that the above mentioned operations are merely one example according to the first embodiment and do not limit the scope of the present invention. For example at the time T7 in the process 1 2 concerning the process 1 the execution of which has been started earlier is executed earlier than the process 3 1 to use the resource . However depending on a request of the system or the like it is also possible that the process 3 1 finished earlier concerning the module is executed earlier to use the resource than the process 1 2.

Thus according to the first embodiment it is possible to provide the image forming apparatus in which a delay occurring due to exclusive control is reduced.

Note that the first embodiment does not limit the scope of the present invention. The present invention can be used in various ways depending on a system a user and or the like. Below several variations will be described as examples.

Using the description has been made that the resource management part manages the hardware resources and the image data as the respective resources and . However instead of the image data a temporary storage area storing the image data can be managed as the resource . Further as a more preferable example as shown in it is advantageous to manage image data in such a manner that a temporary storage area storing the image data is divided into a plurality of resources.

In the resource management part manages the hardware resources and a plurality of temporary storage areas provided in a memory as respective resources and .

In the above mentioned configuration even in a case where the temporary storage area has been used by a process 1 for example another process can use the other storage area or . Thus it is possible to reduce a delay occurring due to exclusive control of the temporary storage area .

Using a flow of a process will be described. In this example the process 1 uses the sub resource and the process 2 uses the sub resource . At a time T1 the exclusive control part carries out exclusive control of the module for the process 1. At a time T3 the exclusive control part stops or finishes the exclusive control of the module for the process 1 and carries out exclusive control of the resource for the process 1. Further at a time T5 the exclusive control part stops or finishes the exclusive control of the resource for the process 1 and starts exclusive control of the sub resource for the process 1. When the use of the sub resource has been finish at a time T9 for the process 1 the exclusive control part finishes the exclusive control of the sub resource for the process 1 and carries out exclusive control of the resource for the process 1. Next at a time T11 the exclusive control part finishes the exclusive control of the resource for the process 1 and starts exclusive control of the module for the process 1. Also the process 2 is executed in the same way.

In the above mentioned operations at the time T5 at which the exclusive control of the sub resource is started for the process 1 the exclusive control of the resource is stopped or finished for the process 1. Therefore the process 2 can use the sub resource in parallel at the time T7.

In the above mentioned configuration it is possible to subdivide a resource into a plurality of sub resources and manage them. Further it is possible to reduce a delay occurring due to exclusive control of a resource and a sub resource.

For example the resource management part manages an image compression library and an image decompression library shown in as resources and respectively.

In the above mentioned configuration it is possible to reduce a delay due to exclusive control also when a process of the module uses the image compression library and the image decompression library .

For example in a case where it is required to carry out copying operations preferentially over other processes it is possible to avoid a delay due to exclusive control by collecting the scanner and the monochrome LP and managing them as a single resource.

In the first embodiment described above the examples have been described for the cases of subdividing exclusive control concerning a plurality of processes of a module in the image forming apparatus to correspond to resources. In the second embodiment examples will be described for cases where exclusive control is subdivided into a plurality of process units based on processing speeds of a plurality of resources as a preferable example of subdividing exclusive control concerning a plurality of processes of a module.

The output part is for example a printer engine such as the monochrome LP or the color LP shown in . The input part is for example an image input part such as the scanner shown in . The plurality of storage areas and are for example storage areas provided in the system memory the local memory and or the like shown in . The HDD is for example a storage device such as the HDD shown in .

The process 1 is for example an input process of storing image data read through the input part in the storage area and storing the image data once stored in the storage area then in the HDD . Further the process 1 uses the input part the storage area and the HDD that are a plurality of resources and the processing speed of the storage area is sufficiently higher than the processing speeds of the input part and the HDD for example.

In such a case it is preferable that exclusive control concerning the process 1 is not divided into three to correspond to these three resources but is divided into two paying attention to a process concerning the input part and a process concerning the HDD that are the resources having relatively low processing speeds. For example as shown in the input part and the storage area are included in a process unit and the storage area and the HDD are included in a process unit . Thereby exclusive control can be prevented from being carried out on the two resources simultaneously that have the low processing speeds. Note that the processing speed of the storage area is sufficiently higher than the processing speeds of the input part and the HDD and therefore the influence on the delay time is a little even when exclusive control is carried out on the storage area together with the input part or the HDD .

Note that in description has been made for the case where the number of resources having the relatively low processing speeds is two. However in a case where the number of resources having relatively low processing speeds is three or more the resources can be advantageously divided for the number of process units corresponding to the number of the resources having relatively low processing speeds.

Further it possible to determine whether each resource has a low processing speed by for example storing a table in which information concerning the respective processing speeds of a plurality of resources for example required processing times flags indicating that processing speed is low or the like is recorded in the HDD shown in .

During a time T2 T8 a predetermined input process in the process 1 is executed using the input part the storage area and the HDD . When the input process in the process 1 has been finished at a time T8 the exclusive control part finishes the exclusive control of the input part the storage area and the HDD . Then an end process in the process 1 is executed including for example a process of releasing the access rights for the resources which have been already used and so forth. At a time T9 the exclusive control part finishes the exclusive control of the module concerning the process 1 and the process 1 is finished.

Since the exclusive control is carried out on the module during the period of time T1 T9 the module is not available to be used to start the process 2. Further during the period of time T2 T8 the exclusive control is carried out on the input part the storage area and the HDD . Therefore these resources cannot be accessed not only by the process 2 but also another process or the like.

Further when the exclusive control of the module concerning the process 1 has been finished at the time T9 execution of the process 2 is started. When the process 2 is executed at the time T9 the exclusive control part carries out exclusive control of the module . At this time a start process in the process 2 is executed including a process of obtaining access rights for resources to be used and so forth for example. Then at a time T10 the exclusive control part carries out exclusive control of the input part the storage area for example the storage area and the HDD for which the process 2 has obtained the access rights.

During a time T10 T16 a predetermined input process in the process 2 is executed using the input part the storage area and the HDD . When the input process in the process 2 has been finished at a time T16 the exclusive control part finishes the exclusive control of the input part the storage area and the HDD . Then an end process in the process 2 is executed including for example a process of releasing the access rights for the resources which have been already used and so forth. At a time T17 the exclusive control part finishes the exclusive control of the module concerning the process 2 and the process 2 is finished.

Thus in the exclusive control method according to the related art the exclusive control is carried out on the input part and the HDD that have for example the relatively low processing speeds and the module together. Therefore the delay time due to the exclusive control may be longer.

However in the related art the processing time transfer time in the HDD is shorter than the processing time input time of the input part . Therefore the problem has not become apparent even in the exclusive control method of . However recently due to improvement in the processing speed of the input part and so forth the processing time of the input part is reduced. Also due to an increase in image quality the transfer time of the HDD is increased. Due to the influence thereof the influence of the exclusive control carried out on the input part and the HDD simultaneously on the delay time for example may become not able to be ignored.

Improvement in the processing speed of the input part and an increase in image quality may be continuously carried out and thereby for example the processing time of the HDD may become longer than the processing time of the input part . Thereby the processing time of the HDD may become a bottleneck and it may be difficult to satisfy the required specification that requires improvement of the processing speed. Exclusive control according to the second embodiment reduces such a problem.

At a time T1 in execution of the process 1 is started. Then the exclusive control part carries out exclusive control of the module . At this time a start process in the process 1 is executed including a process of obtaining access rights for the input part and the storage area that are the resources to be used in the process unit . Note that according to the second embodiment exclusive control of the module is carried out before exclusive control of the resources themselves and the module on which the exclusive control is carried out manages the access rights and so forth in order to avoid a deadlock.

Next at a time T2 the exclusive control part carries out exclusive control of the input part and the storage area for which the process 1 has the access rights and finishes or stops the exclusive control of the module .

Note that to carry out exclusive control means to control lock a resource or a module as a target s of the exclusive control so that it is not to finish or stop exclusive control means to control remove a lock of a resource or a module once controlled locked so as not to be able to be used for another process so as to be able to be used for another process.

Further an exclusive control period in shows a period of time in which exclusive control is carried out for the process 1 or the process 2. Therefore for example in during a period of time T3 T5 exclusive control is not carried out on the module for the process 1 or the process 2. That is shows that for example during the period of time T3 T5 the process 1 or 2 can access the module and does not show that the module does not execute the process 1 or 2. Therefore when the exclusive control part has finished the exclusive control for example before a time T3 in the module is available to be used for any process at the time T3 for example.

Note that a timing at which the exclusive control part finishes the exclusive control of the module may be a time before exclusive control of a resource is started i.e. for example before a time T2 at the time or after the time T2.

For example even in a case where the exclusive control of the module is continued through a hatched period further after the time T2 the module is available to be used for another process from for example the time T3. Therefore an advantageous effect of reducing the delay time generated due to exclusive control is expected. That is the timing at which the exclusive control part finishes the exclusive control of the module is preferably before finishing the exclusive control of the resources such as the input part the storage area and so forth for example before the time T5 shown in . Thereby it is possible to start the process 2 before finishing the exclusive control of the resources concerning the process 1. The same manner can be applied also for the subsequent processes.

Note that in the example of the process 2 first uses the input part . Therefore the process 2 waits until the process 1 releases the input part . However execution of a process not using the input part such as a process of outputting image data in the HDD to the output part can be started at for example the time T3.

When the processes in the process unit for the process 1 have been finished at the time T5 the exclusive control part finishes the exclusive control of the input part and the storage area and carries out exclusive control of the module . Next a process in the process 1 is executed for example a process of releasing the access right for the input part obtaining the access right for the HDD to be used in the next process unit and so forth. Further the process 1 keeps the access right for the storage area to be continuously used also in the next process unit . Alternatively it is also possible that the process 1 newly obtains the access right for the storage area .

Next at a time T6 the exclusive control part carries out exclusive control of the storage area and the HDD resources for which the process 1 has the access rights and finishes the exclusive control of the module .

At the time T6 the module and the input part become available and thus execution of the process 2 is started. When execution of the process 2 has been thus started at the time T6 the exclusive control part carries out exclusive control of the module . At this time a start process in the process 2 is executed including a process of obtaining access rights for the input part and the storage area to be used in the process unit . Next at a time T7 the exclusive control part carries out exclusive control on the input part and the storage area resources for which the process 2 has the access rights and finishes the exclusive control of the module .

Next when the processes in the process unit for the process 1 have been finished at a time T9 the exclusive control part finishes the exclusive control of the storage area and the HDD and starts exclusive control of the module . At this time an end process in the process 1 is executed including for example a process of releasing the access rights for the storage area and the HDD and so forth. At a time T10 the process 1 is finished and the exclusive control part finishes the exclusive control of the module concerning the process 1.

On the other hand at the time T10 the processes in the process unit for the process 2 are finished and therefore the exclusive control part finishes the exclusive control of the input part and the storage area and carries out exclusive control of the module . At this time a process in the process 2 is executed for example a process of releasing the access right for the input part and obtaining the access right for the HDD to be used in the next process unit . Further the process 2 for example keeps the access right for the storage area to be continuously used also in the next process unit .

Next at a time T11 the exclusive control part carries out exclusive control of the storage area and the HDD for which the process 2 has the access rights and finishes the exclusive control of the module .

When the processes in the process unit for the process 2 have been finished at the time T14 the exclusive control part finishes the exclusive control of the storage area and the HDD and carries out exclusive control of the module . At this time an end process in the process 2 is executed including for example a process of releasing the access rights for the storage area and the HDD and so forth. At a time T15 the processes concerning the process 2 are finished and the exclusive control part finishes the exclusive control of the module concerning the process 2.

Thus according to the second embodiment exclusive control is divided subdivided into a plurality of process units based on the processing speeds of a plurality of resources. Thereby exclusive control can be prevented from being carried out on two resources simultaneously having relatively low processing speeds. Further it is possible to effectively reduce a delay in a process caused by exclusive control without unnecessarily subdividing exclusive control.

According to the third embodiment a plurality of resources include two or more predetermined processes that are in linkage with each other and the predetermined processes are included in a single process unit of exclusive control.

Thereamong the output part the input part the plurality of the storage areas and and the HDD are the same as those in the second embodiment shown in . The rotator is an image processing part for rotating image data by rearranging the data or the like for example rotation by 90 degrees by 270 degrees or the like and is implemented by a digital circuit included in the ASIC prepared for image processing shown in or the like for example. The compressor is an image processing part for compressing image data and is implemented by a digital circuit included in the ASIC prepared for image processing shown in or the like for example.

According to the third embodiment it is assumed that the rotator and compressor are in linkage with the HDD and are capable of carrying out processes of rotating and compressing image data and storing the image data in the HDD . In such a case for example when exclusive control of the rotator the compressor and the HDD that are capable of carrying out such processes in linkage with each other is subdivided the processing efficiency speed may be degraded. In such a case it is advantageous to include the rotator the compressor and the HDD that are capable of carrying out processes in linkage with each other in a single process unit of exclusive control.

For example in it is assumed that the process 1 is an input process of storing image data read through the input part in the storage area rotating and compressing the image data stored in the storage area and storing the image data in the HDD . According to the third embodiment exclusive control concerning the process 1 is divided into two process units i.e. a process unit concerning the input part and a process unit concerning the rotator the compressor and the HDD and the exclusive control is carried out in this manner.

Thus in such a case where a plurality of resources include two or more predetermined processes that can be carried out in linkage with each other it is possible to improve the processing efficiency by including the two or more predetermined processes that can be carried out in linkage with each other in a single process unit of exclusive control. For example it is preferable to carry out exclusive control of hardware resources implemented in an ASIC in appropriate process units according to the specification of the ASIC.

Further by carrying out exclusive control in such a manner it is possible to effectively reduce a delay in a process caused by exclusive control without unnecessarily subdividing exclusive control into process units.

According to a fourth embodiment a case will be described where a plurality of resources for example an input part an output part a rotator a compressor a HDD and so forth have a plurality of execution units.

The output parts and are four execution units of an output section. The input parts and are four execution units of an input section. The input section and the output section can process in parallel respective sets of image data in four colors included in a color image in a Cyan Magenta Yellow Key plate color model CMYK form i.e. Cyan C Magenta M Yellow Y and Black K using the four execution units in the input section and the four execution units in the output section.

Also as to the rotators and the compressors it is preferable that each has four execution units from a viewpoint of the processing speed. However according to the fourth embodiment for the reason of for example the cost implementation and or the like a rotator section has the two execution units rotators and and a compressor section has two execution units compressors and for example.

According to the fourth embodiment the input parts and the storage areas and the rotators and the compressors and and the HDD are managed as respective resources. Further the exclusive control part subdivides exclusive control into process units based on the number of resources that can execute respective processes simultaneously.

At a time T1 in the exclusive control part carries out exclusive control of the input parts and the storage areas . In such a case where the resources required for a process can be obtained at once it is preferable that the number of process units of exclusive control is one accordingly.

The input part obtains the data of the C component of the CMYK image and stores it in the storage area in an input process. Similarly the input parts and store respective sets of the M component the Y component and the K component of the CMYK image in the storage areas and . When the input process is thus finished at a time T3 the exclusive control part finishes the exclusive control of the input parts and the storage areas .

Next a process of rotating compressing and storing the respective sets of data of the C M Y and K components thus stored in the storage areas and in the HDD is executed respectively after the time T3. However the image forming apparatus according to the fourth embodiment has only the two execution units in the rotator section the two execution units in the compressor section and the single HDD . Therefore it is not possible to process the four sets of data of the C M Y and K components simultaneously.

Therefore for example in a case where the storage area the rotator the compressor and the HDD execute respective processes in linkage with each other as in the third embodiment the process of rotating compressing and storing the four sets of data of the C M Y and K components is executed in four separate times based on the number 1 of the HDD that is the smallest number of the execution units. In this case also exclusive control thereof is preferably divided into four process units to correspond to the four separate times in which the process of rotating compressing and storing the four sets of data of the C M Y and K components is executed.

Further if the number of resources each having the function of a HDD is two it is possible to carry out the process of rotating compressing and storing the four sets of data of the C M Y and K components in two separate times two colors each. In this case it is advantageous to similarly divide exclusive control thereof into two process units.

Note that even if the number of resources each having the function of a HDD is four the number of resources each having the function of each of a rotator and a compressor is only two. Therefore in such a case the process of rotating compressing and storing the four sets of data of the C M Y and K components is carried out in two separate times two colors each. In this case exclusive control thereof is similarly divided into two process units.

In such a case where it is not possible to obtain resources required for a process at once and the process is executed in a plurality of separate times according to the number of execution units it is preferable that exclusive control thereof is similarly divided to correspond to the number of separate times in which the process is executed.

Returning to explanation of the example of the process will now be proceeded with. The exclusive control part carries out exclusive control of the storage areas the rotator the compressor and the HDD at a period of time T3 T5. During the period the image forming apparatus carries out a process of rotating compressing and storing the data of the C component. Note that at this time it is preferable to carry out exclusive control of also the storage areas and storing the respective sets of data of the M Y and K components waiting to be processed and thus protect these sets of data.

When the process of rotating compressing and storing the data of the C component has been finished at the time T5 the exclusive control part finishes the exclusive control of the storage area the rotator the compressor and the HDD .

Next in a period of time T5 T7 the exclusive control part carries out exclusive control of the storage areas the rotator the compressor and the HDD . During the period the image forming apparatus carries out a process of rotating compressing and storing the data of the M component. At this time it is preferable to carry out exclusive control of also the storage areas and storing the respective sets of data of the Y and K components waiting to be processed and thus protect these sets of data.

When the process of rotating compressing and storing the data of the M component has been finished at the time T7 the exclusive control part finishes the exclusive control of the storage area the rotator the compressor and the HDD .

Note that by thus subdividing the exclusive control into the process units to correspond to the processes concerning the respective colors it is possible to start another process for example an input process of inputting a monochrome image B at the time T4 for example. In this case it is assumed that the input process of inputting the monochrome image B includes for example a process of storing monochrome image data that is input through the input part in the storage area rotating the stored monochrome image data using the rotator that is not used at the time T6 and storing the image data in the storage area .

Next in a period of time T7 T9 in the exclusive control part carries out exclusive control of the storage areas the rotator the compressor and the HDD . During the period the image forming apparatus carries out a process of rotating compressing and storing the data of the Y component. At this time it is preferable to carry out exclusive control of also the storage area storing the data of the K component waiting to be processed and thus protect the data.

When the process of rotating compressing and storing the data of the Y component has been finished at the time T9 the exclusive control part finishes the exclusive control of the storage area the rotator the compressor and the HDD .

Similarly in a period of time T9 111 in the exclusive control part carries out exclusive control of the storage area the rotator the compressor and the HDD . During the period the image forming apparatus carries out a process of rotating compressing and storing the data of the K component.

When the process of rotating compressing and storing the data of the K component has been finished at the time T11 the exclusive control part finishes the exclusive control of the storage area the rotator the compressor and the HDD .

When the processes of rotating compressing and storing the respective sets of the C M Y K components have been finished at the time T11 it becomes possible to store the image data obtained from rotating the monochrome image B and stored in the storage area in the input process started at the time T4 then in the HDD for example.

Also in the example of the input part and the storage areas and the rotators and and the output parts and are managed as respective resources and exclusive control for the process is subdivided into process units based on the number of resources that can be used simultaneously to execute the process.

At a time T1 in the exclusive control part carries out exclusive control of the input parts and the storage areas . Thus it is preferable not to divide exclusive control for a process for which the necessary resources can be obtained at once.

The input part in an input process obtains the data of the C component of the CMYK image and stores it in the storage area . Similarly the input parts and obtain the respective sets of data of the M component the Y component and the K component of the CMYK image and store them in the storage areas and respectively. When the input process has been finished at a time T3 the exclusive control part finishes the exclusive control of the input parts .

Next at a time of a time T3 or later a process of rotating the respective sets of data of the C M Y and K components stored in the storage areas and respectively and outputting the thus processed sets of data to the output parts respectively is executed. However since the image forming apparatus according to the fourth embodiment has only the two execution units of the rotators and it is not possible to process the four sets of data of the C M Y and K components at once.

Therefore according to the fourth embodiment the process of rotating the respective sets of data of the C M Y and K components is executed in two separate times according to the smallest number 2 of the execution units i.e. the rotators and . In this case it is preferable to also divide exclusive control into two process units to correspond to the two separate times in which the process of rotating the respective sets of data of the C M Y and K components is executed.

Note that according to the fourth embodiment the number of execution units in the output section is four and it is possible to output the respective sets of data of the C M Y and K components at once. Therefore it is preferable to divide exclusive control into respective process units for the output section and the rotation process.

Returning to the explanation of the example of the process will be continued. In a period of time T3 T5 the exclusive control part carries out exclusive control of the storage areas and and the rotators and . The rotator carries out a rotation process on the data of the C component of the CMYK image stored in the storage area and stores the processed data in the storage area . Similarly the rotator carries out a rotation process on the data of the M component of the CMYK image stored in the storage area and stores the processed data in the storage area . Note that at this time it is preferable to carry out exclusive control of the storage areas and storing the respective sets of data of the Y and K components waiting for being processed and protect these sets of data.

When the rotation processes on the respective sets of data of the C and M components have been finished at the time T5 the exclusive control part finishes the exclusive control of the storage areas and and the rotators and . Note that by thus finishing the exclusive control it becomes possible to again use the storage areas and .

Next in a period of time T5 T7 the exclusive control part carries out exclusive control of the storage areas and and the rotators and . The rotator carries out a rotation process on the data of the Y component of the CMYK image stored in the storage area and stores the processed data in the storage area . Similarly the rotator carries out a rotation process on the data of the K component of the CMYK image stored in the storage area and stores the processed data in the storage area .

When the rotation processes on the respective sets of data of the Y and K components have been finished at the time T7 the exclusive control part finishes the exclusive control of the storage areas and and the rotators and .

Next in a period of time T7 T9 the exclusive control part carries out exclusive control of the storage areas and and the output part and . The output parts and carry out output processes for example color printing on the respective sets of data of the CMYK image stored in the storage areas and .

When the output processes have been finished at the time T9 the exclusive control part finishes the exclusive control of the storage areas and and the output parts and .

Thus according to the fourth embodiment in a case where a plurality of resources includes a plurality of execution units that can carry out equivalent functions in parallel exclusive control is subdivided into process units based on the number of the plurality of execution units in the plurality of resources. Thereby some of the plurality of execution units that cannot be used simultaneously are available to be used by another process. Further it is possible to effectively reduce a delay in a process caused by exclusive control without unnecessarily subdividing exclusive control.

Thus according to the embodiments the image forming apparatus manages as a plurality of resources image data used by a plurality of processes concerning a module of the image forming apparatus or a storage area s storing the image data and one or more units of hardware. Further in a case where at least one resource of the plurality of resources is used exclusive control is carried out on the at least one resource to be used and exclusive control of the module is finished.

By the above mentioned operations while a process concerning the module uses a resource s the module is available to be used for starting another process. As a result it is possible to reduce a delay caused by exclusive control.

Further in a case where at least one of a plurality of resources is used the exclusive control part carries out exclusive control of a module before exclusive control of the resource s . Since exclusive control is carried out on the module that manages an access right for the resource s or the like before exclusive control of the resource s it is possible to avoid a deadlock.

Further the exclusive control part finishes exclusive control of a module before finishing exclusive control of a resource s . Thereby it is possible to start another process before the exclusive control of the resource s is finished.

Further in the image forming apparatus exclusive control concerning a plurality of processes of a module is subdivided into a plurality of process units based a plurality of resources. By thus subdividing exclusive control into a plurality of process units it is possible to finish exclusive control of a resource s release the resource s not being used.

As one preferred example it is advantageous to subdivide exclusive control concerning a plurality of processes of a module into a plurality of process units based on the processing speeds of a plurality of resources. Thereby it is possible to prevent exclusive control from being carried out on a plurality of resources simultaneously that have low processing speeds. Further it is possible to effectively reduce a delay in a process caused by exclusive control without unnecessarily subdividing exclusive control.

Further in a case where a plurality of resources include two or more resources that carry out predetermined processes in linkage with each other it is advantageous to include the predetermined processes in a single process unit of exclusive control. Thereby it is possible that the two or more resources that operate in linkage with each other can operate efficiently. Further it is possible to effectively reduce a delay in a process caused by exclusive control without unnecessarily subdividing exclusive control.

As another preferred example in a case where the above mentioned plurality of resources include a plurality of execution units that can execute equivalent processes in parallel it is advantageous to subdivide exclusive control concerning processes of the module based on the number of the execution units. Thereby some of the plurality of execution units that cannot be used simultaneously for one process can be effectively used for another process. Further it is possible to effectively reduce a delay in a process caused by exclusive control without unnecessarily subdividing the exclusive control.

The image forming apparatuses and the methods of controlling the same have been described in the embodiments. However the present invention is not limited to the specifically disclosed embodiments and variations and modifications may be made without departing from the scope of the present invention.

The present application is based on and claims the benefit of priority of Japanese Priority Application No. 2013 042264 dated Mar. 4 2013 and Japanese Priority Application No. 2013 245561 dated Nov. 28 2013 the entire contents of which are hereby incorporated herein by reference.

