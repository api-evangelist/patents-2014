---

title: System and method for pixel data compression
abstract: A system for, and method of, pixel data compression and a smartphone incorporating the system or the method. In one embodiment, the system includes: (1) a differential pulse code modulation encoder operable differentially to compress the two pixel values losslessly to yield two losslessly compressed pixel values and (2) an entropy encoder coupled to the differential pulse code modulation encoder and configured to receive and entropy-encode the losslessly compressed pixel values using a tiered technique to yield entropy-encoded, losslessly compressed pixel values. values using a tiered technique to yield Huffman-encoded, losslessly compressed pixel values.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09232238&OS=09232238&RS=09232238
owner: Nvidia Corporation
number: 09232238
owner_city: Santa Clara
owner_country: US
publication_date: 20140116
---
This application is directed in general to a data compression and more specifically to a system and method for compressing pixel data.

Digital photography has become commonplace. Whether the photography is done with a dedicated still camera a videocamera or a smartphone having a camera or video function the high level procedure is the same. Optics are employed to focus an image of a scene being photographed on a rectangular photodetector array. On command the photodetector array captures the image as an array of picture elements or pixels. The pixels are transferred over a bus to a processor and eventually gets written to memory. Additional images may then be captured using the array.

As consumers are aware today s cameras and smartphones are offering ever increasing image resolution expressed in terms of millions of pixels or megapixels ever increasing contrast e.g. color depths and ever increasing rates at which these high resolution images can be taken. Increasing resolutions contrast depths and image rates tax the bandwidth of the bus that is responsible for moving the images to the memory. However compounding these demands are less apparent advances in image processing in which multiple images are captured in rapid succession processed and reassembled to allow images to be taken under low light conditions increase image depth of field allow the image plane to be changed after the fact or reduce the blurring often called shutter shake that results from camera movement. These image processing techniques further tax the bus which must now convey the pixels of each of the multiple images to the memory. Fortunately buses have so far been able to accommodate the ever increasing bandwidth requirements.

One aspect provides a system for pixel data compression. In one embodiment the system includes 1 a differential pulse code modulation DPCM encoder operable differentially to compress the two pixel values losslessly to yield two losslessly compressed pixel values and 2 an entropy encoder coupled to the DPCM encoder and configured to receive and entropy encode the losslessly compressed pixel values using a tiered technique to yield entropy encoded losslessly compressed pixel values.

Another aspect provides a method of pixel data compression. In one embodiment the method includes 1 differentially compressing the two pixel values losslessly to yield two losslessly compressed pixel values and 2 Huffman encoding the losslessly compressed pixel values using a tiered technique based on magnitudes of differences between the two pixel values to yield entropy encoded losslessly compressed pixel values.

Yet another aspect provides a smartphone. In one embodiment the smartphone includes 1 a processor 2 memory 3 a bus coupling the processor and the memory and 4 a system for compressing pixel data for transmission over the bus. In one embodiment the system includes 4a a DPCM operable to receive two pixel values and differentially compress the two pixel values losslessly to yield two losslessly compressed pixel values and 4b a Huffman encoder coupled to the DPCM encoder and configured to receive and Huffman encode the losslessly compressed pixel values using a tiered technique to yield Huffman encoded losslessly compressed pixel values.

As stated above camera and smartphone buses have been able so far to accommodate the ever increasing bandwidth requirements presented by the above described increases in resolution images rates and image processing sophistication. It is realized herein that buses are about to reach their limits and further that while buses can be made wider and faster to provide greater bandwidth such buses also require more area and increase the camera and smartphone cost.

It has been realized that pixel data can be compressed for communication over a bus and that compression extends the design life of current camera and smartphone buses. The well known Camera Serial Interface CSI promulgated by the MIPI Alliance http www.mipi.org employs compression to communicate pixel data. However CSI employs lossy compression which intuitively seems superior because it yields greater compression than does lossless compression.

However while some loss can be tolerated in image compression it is counterintuitively realized herein that it is unnecessary to tolerate loss. It is realized herein that lossy compression s advantage over lossless compression in terms of degree of compression is tolerably small. More importantly it is realized herein that lossy compression requires feedback to manage error and that feedback requires data dependency making it less amenable to parallel processing.

It is still further realized that the pixels of typical images have characteristics that make them it attractive for encoding using DPCM. It is still yet further realized that DPCM encoded pixels have statistical characteristics that make them attractive for subsequent entropy coding. It is still yet further realized that DPCM encoding may be employed for transmitting an image between a processor and a memory even if another compression technique such as CSI is employed to transmit an image to the processor.

It is yet still further realized that the coding dictionary required by entropy encoding could be unmanageably large given those same statistical characteristics. However it is realized herein that differences between adjacent pixels of the same filter color tend to be small and that a tiered technique for entropy coding has the potential to reduce dictionary size.

It is still yet further realized that restart intervals may advantageously be provided in the compressed data to make it more selectively decodable. Further it is realized that because that lossless entropy encoding produces compressed data at a variable rate and while the length of the compressed data should be communicated along with the compressed data the two need not be packed in memory in order.

Accordingly introduced herein are various embodiments of a system and method for performing lossless pixel data compression in which compression of adjacent pixels of the same filter color is based on a predicted value. Certain embodiments employ a tiered technique in which smaller differences between pixels are entropy encoded differently than are larger differences. Surprisingly the tiered technique yields a substantially smaller dictionary with only a small loss of compression. Some embodiments also employ wraparound coding in which pixel differences are allowed to encompass the extremes of a range when they result in smaller differences. In related embodiments restart intervals are provided and in certain embodiments memory is packed out of order to allow lengths to be extracted first.

The smartphone has a lens operable to focus an image of a scene being photographed on a rectangular photodetector array . On command the photodetector array then captures the image as an array of pixels. As those skilled in the pertinent art understand the photodetector array which may be for example metal oxide semiconductor MOS charge coupled devices CCDs or complementary semiconductor CMOS photosensors produce analog signals that are quantized to a particular precision. For example in the illustrated embodiment the precision is such that each pixel can assume a value between 1024 and 1023 representing a brightness. For color images a color filter e.g. a red green and blue Bayer filter may be placed over the photodetector array . Thus each pixel represents a brightness of the color overlying that pixel. As will be described below pixels of the same filter color are subjected to DPCM so pixel value differences arising from color differences do not adversely impact compression.

Following capture a processor causes the pixels to be transferred from the photodetector array to the processor over a bus . The pixels are then transferred from the processor to a memory over a bus . Additional images may then be captured using the photodetector array . As stated above the system and method introduced herein can reduce the bandwidth required for the transfer over the bus .

Of course these are not the only possible ranges and not the only way range detection circuit can work. Many other ranges are possible depending on the characteristics of the images being compressed. For example higher resolution images might benefit from different ranges. The example ranges set forth above happen to be based on characteristics of example images.

If the pixel value lies in the first range the range detection circuits are operable to produce a zero. If the pixel value lies in the second range the range detection circuits are operable to produce a one. The outputs of the range detection circuits are provided to a maximum detection circuit which is operable to produce an output that represents the maximum of its inputs. Thus if its inputs are zero and zero its output is zero if its inputs are zero and one its output is one and so forth.

The output of the maximum detection circuit and the outputs of the differential circuits are provided to an entropy encoder . In the embodiment of the entropy encoder is a Huffman encoder. The Huffman encoder compresses the values of Pand P taking the output of the maximum detection circuit into account and provides the compressed output to a shift register which ultimately produces a stream of compressed data for transmission over a bus.

As stated above memory may be packed out of order. Accordingly the illustrated embodiment employs a novel memory packing technique. No matter what the decoder needs to know how much data to read. Since a standard memory transfer unit called an atom is used some mechanism should be put in place to delineate the number of atoms encompassing the restart interval. A na ve approach involves packing the length with the first data atom. Compressing to memory therefore requires n l atom writes n for each datum and l for the length and decompressing from memory requires n reads one for each datum . Such approach is acceptable when memory reads predominate writes. However it is likely that writes will occur more than reads. It is thus desirable to optimize for writes. According to the novel memory packing technique the length is packed in the last atom typically in the initial position. While reading requires n l reads i.e. the last data atom is read once to obtain the length and again to obtain the last data writing only requires n writes. The novel out of order technique is superior when memory writes predominate reads.

Also as stated above restart intervals may be provided. Accordingly the illustrated embodiment employs restart intervals. It is realized herein that it may be desirable to have breaks in places other than where large discontinuities are located. For instance a big discontinuity typically occurs at the end of a line so it makes sense to have restart interval boundaries to occur at the ends of lines. However boundaries of restart intervals may be located in other places e.g. in the middle of a line if it is desirable to process only part of a line.

The two compressed bits are provided to respective summing circuits which add the compressed bits to respective prior bits fed back through differential circuits to yield uncompressed bits designated in as outand out.

Those skilled in the art to which this application relates will appreciate that other and further additions deletions substitutions and modifications may be made to the described embodiments.

