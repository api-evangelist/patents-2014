---

title: Methods and computer program products for quantitative three-dimensional image correction and clinical parameter computation in optical coherence tomography
abstract: Methods and computer program products for quantitative three-dimensional (“3D”) image correction in optical coherence tomography. Using the methods and computer program products, index interface (refracting) surfaces from the raw optical coherence tomography (“OCT”) dataset from an OCT system can be segmented. Normal vectors or partial derivatives of the curvature at a refracting surface can be calculated to obtain a refracted image voxel. A new position of each desired refracted image voxel can be iteratively computed. New refracted corrected voxel positions to an even sampling grid can be interpolated to provide corrected image data. In some embodiments, clinical outputs from the corrected image data can be computed.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09384582&OS=09384582&RS=09384582
owner: Duke University
number: 09384582
owner_city: Durham
owner_country: US
publication_date: 20140307
---
The presently disclosed subject matter is a continuation of U.S. patent application Ser. No. 12 799 890 filed May 4 2010 the disclosure of which is incorporated herein by reference in its entirety.

This invention was made with government support under Grant Nos. R21 EY017393 and K12 EY01633305 awarded by the National Institutes of Health. The government has certain rights in the invention.

The present subject matter generally relates to optical coherence tomography OCT . More particularly the present subject matter relates to OCT for use in analysis of ocular optical elements and surfaces such as the cornea and lens of the eye.

Multiple modalities currently exist to image the ocular anterior segment of an eye. These imaging devices aid in the clinical diagnosis and care of ocular disease. Optical coherence tomography OCT is one such technique used to image in vivo the ocular anterior segment of an eye in a non invasive fashion. Specific implementations can comprise time domain OCT systems such as those sold under the name of VISANTE by Carl Zeiss Meditec Inc. and Fourier domain OCT systems including both swept source and spectrometer based spectral domain SDOCT implementations. Many previously disclosed anterior segment OCT systems have utilized illumination light in the 1310 nm region. Recently several SD OCT systems have been developed that utilize an 840 nm light source and are designed for imaging the retina but that can also be modified with an adapter or a separate patient interface to image the ocular anterior segment of an eye. These SD OCT systems offer the advantage of higher axial resolutions and faster scanning over prior systems.

All OCT imaging systems are subject to the effects of refraction at surfaces corresponding to interfaces between regions of differing refractive index within a sample including between the air and the surface of the sample as well as internal sample interface surfaces. For a sample such as the anterior segment of an eye important refractive index interfaces comprise the outer herein referred to as epithelial and inner herein referred to as endothelial surfaces of the cornea as well as the outer and inner surfaces of the crystalline lens. Additionally for samples containing regions of different refractive index it can be important for images acquired of the sample to reflect the true physical dimensions of the sample rather than to be distorted by the varying speed of light in different sample regions. Both of these potential pitfalls can be particularly important in applications such as corneal biometry where accurate measurements of various clinically significant parameters must be computed from the image data. Such computations are very sensitive to even small image errors due to refraction or distortion. Most current OCT systems do not correct the raw image data for refraction at sample interfaces or for the effects of different sample regions having differing refractive indices. Most current OCT systems instead assume that the light incident on the sample continues in a straight line through the sample and thus plot the raw image A scan data corresponding to a depth resolved reflectivity map of the sample on this assumed undeviated path. These systems also do not correct for the effects of different refractive indices in different regions of the sample. At best these systems may divide the observed A scan data by some assumed average index of refraction of the entire sample. As such raw OCT data in current generation OCT systems does not accurately represent the true position of internal sample structures and are thus not able to support calculation of clinically significant parameters which depend on accurate image data. In particular to produce accurate quantitative measurements of structures of the ocular anterior segment accounting for the effects of refraction of the sample arm light and for the effects of differing indices of refraction in different sample regions is required.

Prior methods to correct for refraction in OCT images have been developed. They do not however account accurately or completely for correction of volumetric three dimensional 3D OCT datasets. One method is limited to two dimensional 2D processing which assumes that refraction occurs only within the plane of individual acquired B scans defined as sets of A scans acquired along a straight line comprising a cross sectional image of the sample . For a curved 3D structure such as the cornea 2D refraction correction is correct only if the sample is rotationally conically symmetric about some axis passing through the apex of the sample and if the acquired B scan data passed exactly through the apex point. The first condition is rarely true for realistic samples such as the human cornea especially if they have been modified surgically. The second condition is true only for idealized radial scan patterns which may not be optimal because they oversample the central region and undersample the outer region and in any case are difficult to obtain correctly due to unavoidable patient motion or operator misalignment of the OCT system.

In accordance with this disclosure methods and tools for providing quantitative three dimensional 3D image correcting clinical parameter computations for optical coherence tomography are provided. It is therefore an object of the present disclosure to provide 3D imaging correction tools that can be used with any optical or ultrasonic imaging tools when curved surfaces are presented along the imaging path. Another object of the present disclosure is to provide methods for improving the 3D imaging of the eye to more accurately portray the refracting surfaces of the eye for diagnosis and treatment purposes.

This and other objects of the present disclosure as can become apparent from the present disclosure are achieved at least in whole or in part by the subject matter described herein.

Reference will now be made in detail to possible embodiments of the present subject matter one or more examples of which are shown in the figures. Each example is provided to explain the subject matter and not as a limitation. In fact features illustrated or described as part of one embodiment can be used in another embodiment to yield still a further embodiment. It is intended that the subject matter disclosed and envisioned herein covers such modifications and variations.

For meaningful analysis of the cornea of an eye from spectral domain optical coherence tomography SD OCT data effects of refraction at the epithelial and endothelial surfaces should be accounted for. A method for three dimensional 3D refraction correction based on a vector representation which accounts for refraction of optical coherence tomography OCT light in the cornea is present herein below. This method can be used to dewarp raw SD OCT volumes. The method can also be used to reconstruct the true position of the corneal endothelial surface.

In addition the raw volumetric image dataset may require correction of image artifacts or interpolation of non sampled or under sampled areas of the sample prior to further processing. Image artifacts can be caused by mis calibrations or non linearities of the image acquisition hardware as well as patient induced artifacts such as axial or lateral patient motion loss of patient fixation or patient blinking during data acquisition.

Following 3D refraction correction of volumetric corneal datasets an estimate of the corneal thickness and the individual wavefront aberrations of the epithelial and the refraction corrected endothelial surfaces can be made. To measure the corneal thickness along the episurface normal vector a numerical method or solution called recursive half searching algorithm RHSA can be used to compute the corneal thickness with fine convergence. The different wavefront aberrations of the anterior and posterior surfaces can be retrieved using Zernike spectrum analysis. To enhance the scattering OCT signal at wide scanning range the illumination light can be customized to a special polarization state to increase the scatting sensitivity. P polarization states are suggested to improve the imaging depth and reduce the corneal surface scattering. Different scanning patterns can also be explored to optimize the OCT image quality and reduce bulk motion. Asphericity and best spherical fitting can be utilized to retrieve the corneal asphericity curvature and flow image of both surfaces of ocular anterior segment which is very useful for clinical applications. The 3D refraction correction algorithms can be used with any optical or ultrasonic imaging tools when some curved surfaces are presented along the imaging path.

Thus a method is provided for three dimensional 3D correction of refraction and index variations within arbitrary samples. The method can be particularly useful for correction of human ocular anterior segment images obtained in vivo using SDOCT systems including extraction of quantitative clinical parameters from 3D OCT datasets acquired in the cornea. A mathematical model and analytical equations for correction of refraction and index variations can also be provided. Though this method has been reduced to practice for correcting OCT images of the ocular anterior segment and cornea it can be applied generally to the correction of all imaging modalities whereby the source radiation encounters an interface and structure which alters its path refraction of electromagnetic or sound waves .

Following correction of refraction and index variations the corrected data can then be used to generate multiple quantitative clinically significant displays. These can comprise corneal thickness mapping corneal surface curvature mapping corneal surface deviation from best fit sphere float mapping corneal iris angle mapping and surface wave front aberration analysis among others. Without 3D refraction correction of the raw anatomic images it would not be possible to generate accurate and hence clinically useful versions of these data maps. These displays may be useful for evaluation of pathologies of the cornea or anterior segment or planning of surgeries such as refractive surgery e.g. LASIK or intraocular lens surgery.

The subject matter described herein for quantitative 3D image correction and clinical parameter computation in optical coherence tomography can be implemented using a computer readable medium having stored thereon executable instructions that when executed by the processor of a computer control the processor to perform steps. Exemplary computer readable media suitable for implementing the subject matter described herein includes disk memory devices programmable logic devices and application specific integrated circuits. In one implementation the computer readable medium may comprise a memory accessible by a processor. The memory may comprise instructions executable by the processor for implementing any of the methods for quantitative 3D image correction and clinical parameter computation in optical coherence tomography described herein. In addition a computer readable medium that implements the subject matter described herein may be distributed across multiple physical devices and or computing platforms.

The following provides a description for correction of refraction and index variations at one or more index interfaces in OCT images by application of Snell s law generalized to three dimensions. illustrates a flowchart of an algorithm generally designated used for correction of refraction and index variations at one or more index interfaces in OCT images. To begin a raw OCT dataset can be provided. A step in the method can comprise segmentation of index interface refracting surfaces from the raw OCT dataset . First the external and internal sample surfaces at which refraction occurs can be identified. For anterior segment imaging these correspond to the anterior and posterior surfaces of the cornea and optionally of the crystalline lens. Additionally the locations within the sample at which it is desired to correct the raw OCT image data for refraction and index variations is identified. These locations can correspond to all positions below the first refracting surface or between all segmented refracting surfaces or alternatively to only selected sample positions at which it is known a priori that corrected data must be obtained in order to calculate important derived clinical parameters.

For the case of anterior segment imaging correction of refraction and index variations for all image voxels or volumetric pixels can generate a complete de warped 3D image suitable for viewing and analysis with 3D visualization software tools such as those used in common practice in radiology for analysis of image data from computed tomography CT or magnetic resonance MR imaging. Alternatively for anterior segment imaging correction of refraction and index variations can be limited to structures such as the location of the endothelial surface of the cornea if all that is needed is computation of parameters related solely to the anterior and posterior corneal surfaces such as the corneal thickness corneal curvature and corneal wavefront aberrations.

Methods for segmentation of the refracting surfaces can comprise manual techniques requiring human interaction such as marking several points on the refracting surface followed by fitting of a polynomial or other smooth function to the user generated points. Various methods and software algorithms for automatic segmentation of tissue internal structures can also be used for segmenting of the refracting surfaces including methods utilizing operations and or mathematical techniques such as data thresholding and use of image gradients snakes and graph cuts. Thus in the first step a raw OCT dataset comprising image brightness as a function of x y and z coordinates can be generated received and a segmented image dataset of the refractive index interface surfaces comprising sets of the x y and z coordinates of the interface surface can be produced.

Another step of the method and method can be to calculate normal vectors or partial derivatives of the curvature at a first refracting surface or next refracting surface if iterating . To apply Snell s law in 3D using the theoretical model disclosed herein the normal vector at each point on the segmented refracting surface where the OCT sample arm light strikes the sample can be calculated. If this is the first iteration through the method or refraction correction is only needed at the first refracting surface then this step can be applied to the first refracting surface i.e. for anterior segment imaging the epithelial corneal surface . If this has already been done for the first refracting surface then it can be done for the next refracting surface.

The method for calculating the surface normal can depend upon the scan pattern utilized to obtain the raw 3D OCT dataset and upon the coordinate system desired for conducting further computations. In the following examples a Cartesian coordinate system is used although the present subject matter can be generalized to any other coordinate system such as a polar coordinate system. For computations using the Cartesian coordinate system the partial derivatives of the surface curvature in the x and y directions are needed as they relate to the surface normal which can be calculated either from the surface normals or directly. If the data was acquired using a raster scan pattern oriented in the x or y direction these derivatives can conveniently be calculated from one dimensional polynomial functions fit using the well known least squares fitting method and algorithm to each raster line in both orthogonal directions. Alternatively if the data was obtained using any other non raster scan pattern such as a radial scan pattern the surface points can first be fit to a 3D Zernike polynomial model following which the surface derivatives at every point may subsequently be calculated analytically or computationally.

Thus in step a segmented image dataset of the refractive index interface surfaces comprising sets of the x y and z coordinates of the interface surface can be generated received and a set of surface normal vectors or partial derivatives of the curvature of a refractive surface can be produced. The refracting surface from which the normal vectors or partial derivatives of its respective curvature are derived can be a first refractive surface or subsequent refractive surfaces if an iteration is being performed.

After the step of calculating normal vectors or partial derivatives of the curvature at a refracting surface the method can comprise a step of iteratively computing the new position of each desired refracted image voxel or volumetric pixel. With knowledge of the direction vector of the incident light at each position on the refracting surface and also of the surface normal at each point the new corrected position of every desired image voxel beneath that surface down to the level of the next refracting surface if there is one can be computed. For example the new corrected position of each desired image voxel beneath that surface can be computed using Equations 10 disclosed hereinbelow. The direction vector of the incident light at each position can be known from either a for the first refracting surface the direction from which the sample arm light is incident on each position of this first refracting surface which is a property of the OCT system which must be well known and characterized or b for subsequent refracting surfaces the direction at which the light was refracted from the previous refracting surface.

The equations defined for this step can correct for both the effects of refraction at the sample interface and also for the new index of refraction of the medium following the interface. Thus in step a raw OCT dataset comprising image brightness as a function of x y and z coordinates a segmented image dataset of the refractive index interface surfaces comprising sets of the x y and z coordinates of the interface surface a set of surface normal vectors or partial derivatives of the curvature of the first next if iterating refractive surface and a set of incident light direction vectors can be generated received and a set of corrected x y and z coordinates of the new corrected position of each desired image voxel beneath that surface can be produced.

After step of iteratively computing the new position of each desired refracted image voxel the method can comprise step of interpolating new refracted corrected voxel positions to an even sampling grid. The computation of the new position of each refracted image voxel of the previous step can result in new position locations not located on the original raw image data sampled grid and may thus be difficult to store and to use in making further computations. To correct this the refraction corrected voxel reflectivity data can be re sampled back to the original Cartesian sampling grid. This re sampling can be accomplished using a number of well known re sampling algorithms including Gaussian curves 3D Zernike curves and wavelets. In one embodiment step can be performed by fitting the corrected voxel data to a 3D Zernike polynomial model which can then be re sampled at any desired grid locations. Thus in the step a set of corrected x y and z coordinates of the new corrected position of every desired image voxel beneath that surface can be generated received and a set of interpolated corrected image brightness values as a function of x y and z coordinates of an even sampling grid can be produced.

In step it can be determined whether more refracting surfaces are needed. If so the respective steps of the method of calculating normal vectors or partial derivatives of the curvature at the first or next if iterating refracting surface iteratively computing the new position of each desired refracted image voxel and interpolation of new refracted corrected voxel positions to an even sampling grid can be repeated until all desired refracting surfaces have been evaluated enabling computation and resampling of all desired image voxels. If no more refracting surfaces are needed then at this point a correct 3D dataset can be considered to have been provided.

The next step in the method can comprise computing clinical outputs from corrected image data. From the three dimensional refraction and index variation corrected voxels and surfaces various clinical outputs can then be computed. Thus in this step a set of interpolated corrected image brightness values as a function of x y and z coordinates of an even sampling grid can be generated received and a set of clinical output measures or parameters comprising numerical values tables graphs images and maps can be produced.

In this section the theoretical and computational details that can be used for implementation of the general method described in the previous section are provided. The example application used for illustration of the method is a quantitative image correction and clinical parameter computation for OCT analysis of the human cornea and anterior chamber although it should be understood that the same inventive steps and procedures can be applied to many other biological and industrial sample types.

The sample data and images used in this section to illustrate reduction to practice of the present subject matter were acquired using one of two Fourier domain OCT systems. The first system is a research prototype swept source OCT system operating at 1310 nm wavelength. The second system is a commercial high speed SDOCT system operating at 840 nm with a corneal adapter manufactured by Bioptigen Inc. of Durham N.C. The commercial system can collect repeated A scans from a 2048 pixel line scan camera at a readout rate of to 17 kHz. Imaging speed is not a limitation factor for any of the methods described. The axial resolution can be approximately 5 micrometers. For comparison this is 10 fold greater than the 50 micrometer resolution of a rotating Scheimpflug photography system currently in clinical usage.

The goal of the system is a mathematical model of the human cornea and to use this system to generate equations that can accurately reposition refracted pixels in an ocular anterior segment volumetric dataset.

One method can be to merely use 2D refraction correction via the well known Snell s law. However such a method requires an assumption that the corneal surface is rotationally conically symmetric which can be mathematically expressed as 

In the above expression x y z represents the vertex of the rotational conic x y z is any point on the rotational conic R is the apex radius of curvature of the surface K is the conic parameter which represents the asphericity of a surface. K 1 for a sphere and K 0 for a parabolic surface.

If this equation were true for the corneal surface the cornea would be exactly rotationally symmetric and 2D refraction correction would be sufficient by carefully scanning each B scan exactly through the axis of rotation apex . Unfortunately for clinical application the cornea is generally not exactly rotationally symmetric. Therefore the above assumption cannot be used. This is especially the case in pathologic corneas with gross asymmetry and in surgically altered corneas LASIK corneal transplantation and these corneas are the ones that can benefit most from quantitative imaging.

To reflect physical reality a general 3D vector implementation of Snell s law can be applied to correct for refraction of any surface shape. The epithelium of the cornea can be mathematically implicitly described as z 0. In the equation the function x y can be expressed in terms of numerical partial derivatives of the measured epithelium.

The derivation of Snell s law for use in three dimensional applications can be done via Maxwell s equations or more intuitively. In the Maxwell s equations approach the SDOCT instrument can be designed to telecentrically illuminate the cornea within an fixed diameter area centered on the apex of the cornea thus constraining the incident light direction across any scan pattern to the z direction. In any realistic biological or industrial sample the magnetic current densities right arrow over M are zero. The right arrow over n can be the unit surface normal vector of an arbitrary incident point C on the epithelium surface. According to Maxwell s equations the electric magnetic field boundary condition can be represented 0 2 

Here right arrow over E and right arrow over E are the incident and refracted electric fields individually. The above equation indicates that the incident and refracted electric fields can be continuous on the tangential surface of the incident epithelium interface. In other words the refracted light still propagates within the same incident plane and only bends in that plane. This is true for both p and s polarized incident light. In this regard it can be useful to point out that Brewster s angle for the cornea is Arc tan n n 54 where nis the refractive index of cornea 1.385 and nis the refractive index of air 1.0 . When the diameter of the scanning range is bigger than about 6 mm the majority of the incident light can be obliquely reflected by the epithelial surface and thus lost if the incident polarization state is random. Thus OCT images of the cornea in that region can be very weak. However the incident angle can be quite close to Brewster s angle when the scanning range is bigger than 8 mm. As a result part of the s polarized light perpendicular to the incident plane will generally be reflected but all the p polarized light within the incident plane will generally be transmitted with no loss. To enhance brightness of OCT images of the cornea for large scan widths p polarized light can be thus desirable although the cornea has strong birefringence effects which will change the polarization states of the transmitted p polarization light into elliptical states.

As illustrated in the unit normal vector on the epithelial corneal surface at point C can be expressed as 

The incident light right arrow over MC has direction vector a b c and the unit vector of the refracted ray right arrow over CC is square root over . 4 Now z z can be obtained using directional vector projection and it is 

In Eq. 5 square root over x x y y z z can be directly retrieved from the optical path length OPL as the distance from the refracting surface to the desired x y z image voxel in the raw OCT B scan image. If the Eq. 2 is satisfied the relationship between the incident light and the refracted light can be represented by the following 3D generalization of Snell s law . 6 

Here represents the vector cross product. In actual implementation in a Cartesian coordinate system equation 6 actually can consist of three separate equations one for each Cartesian axis.

For a more intuitive derivation of Eq. 6 Snell s law serves as the starting point which describes the relationship between an incident ray of light and its refracted ray after encountering a refracting surface in this case the cornea sin sin . 7 

Here nis the refractive index of air is the angle between the incident ray of light and the surface normal nis the refractive index of the cornea and is the angle between the refracted ray of light and the continuation of the surface normal through the cornea.

The refraction occurs within the same plane. That is the incident ray and the surface normal the incident plane exist in the same plane as the refracted ray and the surface normal the refracted plane . The problem with OCT is that this particular plane may not be shared with the plane of the B scan as is normally assumed with prior 2D refraction correction methods. Because the incident plane and refracted plane share the same larger plane they also share the same normal vector to this larger plane particularly at the point of refraction. This shared normal vector passing through the point of refraction can be termed as N. Both sides of Snell s law can be multiplied by this shared normal vector sin sin . 8 

By definition for a vector and another vector the cross product is a b a b sin ab N where a is the magnitude of vector right arrow over a and is the magnitude of vector is the angle between the two vectors and is the vector normal to the plane created by the two vectors. If the two vectors are unit vectors each of magnitude 1 then the cross product of two vectors is simply the product of the sine of the angle between the two vectors times the normal to the two vectors. Substituting this definition into equation 8 a vector 3D form of Snell s law is created . 9 

Where is the unit vector describing the incident ray is the unit vector describing the refracted ray and is the surface normal to the cornea for that particular incident ray. This is the same as equation 6 where is an alternative designation for and is an alternative designation for .

Conversion of each vector to its Cartesian x y z form and solving the cross product in equation 6 assuming n 1.0 gives the following equations for the refraction corrected positions in the x and y axes z is given in equation 5 as derived by projection 

If the incident light is telecentrically scanned then incident light vector right arrow over MC becomes 0 0 1 and equation 10 is further simplified as 

The 3D refraction corrected volume can then be generated by applying Equations 10 11 to each desired voxel subsequent to the refracting surface in a 3D volumetric dataset. Equations 10 11 can enable practical 3D refraction and index of refraction variation correction of volumetric OCT datasets.

Many scanning patterns can be employed in ophthalmic imaging. One common scanning pattern can be raster scanning a stack of sequential B scans is used to form a box of images and another common scanning pattern can be radial scanning each B scan is centered around a rotational axis . The advantage of the raster scanning is that it provides complete and evenly sampled x y and z data throughout the volume. For example each B scan exists in the x axis the stacking of B scans creates the y axis and the individual points in an A scan define the z axis. This is ideal for Cartesian implementation of the 3D refraction correction. While the radial scanning pattern has the advantage of high SNR for all B scan frames the data is generally asymmetrically sampled with denser sampling centrally and less peripherally. For a Cartesian implementation as in equation 10 this requires that the data first be interpolated and then resampled evenly. One such implementation is via Zernike fitting as described below. Alternatively a polar implementation of equation 6 can be created.

Examples of these two different scanning patterns are illustrated in . In particular illustrates a radial scanning pattern with each B scan passing through the apex. illustrates a raster scanning pattern.

Although these are two of the more common scanning patterns it should be understood that scanning can comprise other patterns of B scans designed for optimal coverage of the area of interest in the anterior segment. Alternatively the dataset may comprise multiple individual A scans distributed around the eye s surface in such a way as to maximize the concentration of image data in regions of particular clinical interest or in such a way as to minimize image artifacts such as caused by motion of the patient during data acquisition. Such patterns of individual A scans can place them in radial circular raster or random patterns or patterns that contain repeated or nearly repeated sequences of sub patterns designed to minimize the effects of patient motion.

One issue with the newly generated 3D refraction corrected volumetric data can be that the pixels are no longer evenly sampled. As such a means to evenly resample such data for further analysis and visualization can be devised. For example the complete endothelial surface can be reconstructed to obtain a corneal thickness map each epithelial normal may no longer intersect a physical endothelial pixel or to generate wavefront aberration analyses of the endothelium. To reconstruct even sampled epithelium and the endothelium surfaces a Zernike polynomial 3D interpolation can be employed to obtain the even grid epithelial uncorrected endothelial and refraction corrected endothelial surfaces. By using Zernike interpolation to reconstruct the surfaces image re segmentation from the newly generated refraction corrected volumetric dataset can be avoided.

Zernike polynomials are a set of complete orthogonal polynomials defined on a unit circle. These polynomials are represented in polar coordinates by 

Where the indices n and m are the radial degree and the azimuthal frequency respectively i is a mode ordering number R is used to normalize the measurement data to a unit circle and cis Zernike elevation interpolation coefficients.

Since OCT can employ a very dense scanning pattern containing more than ten thousand points the 3D Zernike interpolation can provide a good interpolation of the corneal surface without loss of accuracy. For instance using a 16 order Zernike polynomial fit the mean fitting residual error can be 0.9 micrometers within a 4 millimeter diameter and 2.8 micrometers for a 7 millimeter diameter. show the Zernike 3D interpolation errors. In the mean Zernike 3D interpolation errors are less than 0.9 micrometers within a diameter 4 millimeter. In the mean interpolation errors are less than 2.8 micrometers for 7 millimeter diameter. Both interpolation errors are within the range of the light source coherence length of 6.4 micrometers.

Since these errors are much less than the coherence length of 6.4 micrometer the Zernike 3D interpolation is acceptable for clinical applications. By using Zernike coefficients in representing corneal surfaces also can provide the following advantages.

It is not necessary to do the 3D interpolation for the epithelial surface in the raster scanning pattern as it is already evenly sampled.

Similarly Zernike 3D interpolation can be performed for all surfaces in non raster scan patterns such as radial scan patterns . In a radial scan pattern the central area of the scan can be sampled more densely than that in the periphery. illustrate the sampling density in radial scanning cases. shows a radial scanning pattern. As can be seen the sampling density is different between central and peripheral points. Specifically the sampling points are much sparser in the outer circles than in the inner circles.

Instrument mis calibrations and non linearities can be rectified by careful calibration of the instrument on a calibration target of known dimensions prior to patient imaging including calculation of correction factors to be applied to the resulting image data. Correction for patient motion or loss of fixation can be rectified by employing methods to estimate the actual patient head or eye motion which occurred during image acquisition and then using this information to correct the resulting image data. Methods to estimate the actual patient motion can comprise external instrumentation such as an iris camera or eye tracker both used to estimate lateral or rotational eye motion or can comprise image processing methods such as image registration to estimate axial or lateral motion in OCT A scans B scans or volume scans.

For example patient axial or lateral motion between B scans can be estimated from the peak of the normalized cross correlation between sequential A scans for axial motion B scans for axial and lateral motion in the direction of the B scan or volume scans for axial and lateral motion assuming the volume scans are acquired quickly compared to the patient motion . Many other image registration and motion estimation algorithms are well known in the art of image processing and can be used for this purpose. Once estimates of axial or lateral motion are obtained they can be used to correct the volumetric image dataset by re positioning image data within the dataset to its true position. Also if the image dataset contains missing image data e.g. because the patient blinked or because lateral motion resulted in some areas of the sample not being undersampled such data can be filled in by image interpolation algorithms. Other bulk motion methods can include analyzing the natural motion frequency of the patient. Then the sampling frequency can be adjusted to any high order harmonic frequency of the patient motion. In this way it is possible to statistically reduce the patient motion.

Correction of image artifacts can be done as just described upon the raw A scan B scan or volumetric image datasets creating corrected image datasets before further segmentation and image processing. Alternatively rather than creating entirely new corrected image datasets it can be possible and computationally simpler to perform some artifact correction operations upon partially processed data such as segmented data.

Correction of some image artifacts such as those resulting from axial or lateral patient motion or missing data can be accomplished at this point when the entire image dataset has been reduced to a mathematical surfaces model. For example a simple but effective method for correction of axial patient motion during sequential radial B scan acquisition comprises registering the segmented corneal anterior surface of each radial B scan to that of a selected reference B scan e.g. the first one in the set at a selected lateral location within each B scan e.g. its center pixel . This axial motion estimate can then be applied to correct the entire mathematical surface model such that the center of each radial B scan is at the same axial location. This method is expected to work well when the axial component dominates patient motion during data acquisition.

4. Clinical Parameter Computation Corneal Thickness Mapping Wave Aberration Analysis Asphericity Analysis Refractive Curvature Maps Float Maps and Others

A corneal thickness map can be created by determining the normal distance between the epithelial and endothelial corneal surfaces in the volumetric surface model via an analytical or numerical approach. As used herein the term normal can be defined as normal to the epithelial surface. There can be a thickness value for each pixel representing the epithelial surface. The thickness value for each pixel can be mapped to a color scale to produce a two dimensional pachymetry thickness map.

The corneal thickness is measured along the epithelial surface normal vector. The surface normal equation of the epithelium is obtained by 

Where x y z stands for the coordinate of point C and x y z stands for the coordinate of an arbitrary point on the normal equation line .

It can be difficult to derive an analytical solution between equation 17 provided above and equation 18 provided below. A numerical solution called the recursive half searching algorithm RHSA and method can be used here to solve for x y z that exists within a defined distance e.g. an error tolerance to the endothelial surface. RHSA starts with an estimate of where the endothelial pixel should be along the normal line that was calculated as part of the 3D refraction correction. If that estimate does not exist on the prior Zernike interpolation of the endothelial surface it will be off by some amount in the z direction. That amount is halved and used as the next estimate of the endothelial pixel. The process is repeated until the difference between the estimate and the surface is less than the desired error.

For instance if the error tolerance is 0 then x y z will be coincident with the endothelial surface. An appropriate error tolerance is chosen to balance clinical needs and computation time. The principle is illustrated in of searching intersection points between the surface normal equation of epithelial and refraction corrected endothelial surface. In the top surface is epithelium and the second is endothelium. The syllables illustrated in are as follows 

Thus RHSA permits searching for the normal perpendicular distance between two surfaces given known spatial coordinates of the first surface and given a representation of the second surface in a basis space. In this particular implementation the basis functions are Zernike polynomials and the RHSA permits searching for the intersection between the epithelial surface on the normal equation and the endothelium.

The starting guess point can be the refraction uncorrected endothelium x y z . The new coordinates of x y z of the first step can be estimated by manipulating equation 17 

 F x y z xand F x y z ycan be the constant partial derivatives of the epithelial surface at point C and they do not need to be calculate again. In step 2 it can be determined if the new point x y z is located at the Zernike interpolated endothelial surface.

 is the stop condition i.e. the error tolerance which can be defined as 1 micrometer in some examples. Step 3 will be followed if it does not reach the convergent accuracy.

The above search method can be used to recursively halve the difference of the search distance. Hence it can converge very fast and only needs 6 steps to define the intersection point.

Once each epithelial point in the modeled surface has a thickness value calculated for it the values can be fit to a color scale. A typical color scale can represent average corneal values around 500 600 m as green with thinner values trending warmer red and thicker values trending cooler blue .

The data can then be plotted as a two dimensional map providing an en face looking coincident with the direction of the visual axis view corneal map. This concept of thickness mapping can be applied to any two desired surfaces for instance the thickness of the human lens can be measured between the front and posterior lens surfaces as imaged by SDOCT. This could also be applied to the magnitude of spaces between two surfaces. For instance the anterior chamber depth can be defined as the distance between the corneal endothelial surface and the anterior lens surface or iris in the periphery or an anterior chamber lens if present .

Another method for determining the normal distance between the epithelial and endothelial corneal surfaces can be to use ray tracing and Newton s algorithm to find the intersection point along the Newton search direction.

G x y z 0 is the implicit form of the endothelium and the direction cosines of the epithelial surface normal equation is represented in l.m.n which is related to the epithelial surface derivatives. This method requires iterative calculation of all the partial derivatives 

Still other methods which are well known in the art may be applied for determining the normal distance between the epithelial and endothelial corneal surfaces following 3D refraction correction.

After 3D refraction correction the individual wavefront aberration of the epithelium and endothelium layers can be estimated. Similar to the method employed in professional optical design software Zemax the optical path differences also called wavefront aberrations W between the off axis and on axis for the all meridians are calculated within 7 millimeters. Equation 22 gives the computing method.

Cdescribes the wavefront aberration coefficients. For example C with mode index 1 is called spherical aberration error. The wavefront aberration analysis using Zernike spectrum analysis and ray tracing is illustrated in . In the anterior surface corneal height is labeled Z f is the distance of the focus point F to the apex of the surface VA and d is the distance of this focus point to an arbitrary point on the surface. shows the Zernike aberration analysis of the cornea. Red is for anterior surface and green is for posterior surface. Overall the anterior surface contributes much more aberration errors than that of posterior surface. The spherical aberration error of the epithelium is around 1.1 micrometers and 0.6 micromeres for the endothelium.

Asphericity and best sphere fitting can be used to estimate the asphericity surface curvature and to create float maps.

Asphericity K and the radius of curvature for a surface R can be obtained using 3D fitting with Equation 1 . Using a phantom contact lens the measurement error of the base curvature from that reported for the phantom was less than 2.9 . The radius of curvature can be used to describe the refractive power of the cornea either over an optical region for instance refractive power within the central 3 mm optical zone or locally over the entire cornea to produce a local refractive curvature map.

Best sphere fitting can be retrieved using 3D fitting by simply letting K 1 in equation 1 . Examples of the results are demonstrated in . Float images of different 3D fitting of a phantom contact lens are shown therein. shows a float image of the anterior surface of a contact lens with asphericity fitting. In the asphericity is 0.8 and radius is 10.03 mm. shows a float image of the posterior surface of a contact lens with best sphere fitting. shows a float image of the posterior surface of a contact lens with asphericity fitting. In the asphericity is 0.59 and radius is 9.32 mm. shows a float image of the posterior surface of a contact lens with best sphere fitting. The residuals demonstrate the amount of deviation of the corneal surface from that of the best fit sphere. This can be a clinically important indicator of ecstatic corneal conditions.

Elevation float maps can represent the distance between the modeled surface and a reference surface. For example a sphere can serve as the reference surface although any surface could be used e.g. ellipsoids other toric surfaces defined planes . In the case of a reference sphere the sphere can be chosen to best fit the modeled surface within a defined area of that surface. Corneal elevation maps can be created by first designating a reference surface. The reference shape can be chosen as a standard shape e.g. a planar or spherical surface or other surface shape chosen to fit the modeled corneal surface. The deviation in the z axis nominally the same direction as the visual axis of each pixel in the modeled corneal surface from the reference surface can be designated as the elevation value. The pixel elevation values can again be mapped to a color scale to produce this two dimensional map.

Returning again to Equation 1 by setting K to 1 the surface is modeled as spherical. Other values deform this surface into various ellipsoids. For this particular implementation x y can be assigned to either the center of the dataset or allowed to float such that there are no constraints on the location of this apex. The x y z values of the modeled surface within the area of desired fitting can then be used to solve for R and x y zif unconstrained using a curve fitting algorithm e.g. least squares .

With K set to 1 this solution represents the best fitting sphere for the modeled surface within the desired area and the residuals from the fitting represent the deviation in the z axis of the modeled surface at each x y z from the best fitting sphere. These residuals can be fit to a color scale and plotted to provide a two dimensional en face view of the elevation data such as is shown in . This type of referenced elevation map can be created for any desired surface derived from OCT images corneal epithelial surface endothelial surface lenticular surfaces etc. .

Regarding curvature and power maps previous methods for calculating curvature values were based on estimates of radii of curvature of the corneal epithelial surface using reflection based imaging technologies. With OCT however curvature values of any surface or combination of surfaces can be produced. For instance a corneal curvature map can be created by determining the radii of curvature at each local point defined by some local radius typically 0.1 1 mm on the modeled surfaces. Radii of curvature of the modeled corneal epithelial surface can be determined from the best fitting sphere as in elevation mapping for small discrete defined regions on the surface e.g. regions that are 1 mm in diameter . The radii of curvature can then be converted into dioptric power by convention using the following equation 

There are multiple alternative ways to constrain the local surface fitting. The tangential curvature method can allow for the best fitting sphere curve for the sampled surface area. The axial curvature method can constrain the origin of the radius of curvature of the best fitting sphere curve to the visual axis. In this case for equation 1 the radius of curvature would be explicitly stated to always originate at x y .

With an evenly spaced sampling of the radii of curvature across the epithelial surface the values can be fit to a color scale and plotted to provide a two dimensional en face representation of curvature with interpolation as required if the sampling is insufficiently dense. Multiple color scales are available in the literature including those created by standards bodies.

The radii of curvature may then be converted to ophthalmic diopter powers which can be inversely related to the radii according to the formulas in . This can be done using curvature data from each of the two corneal surfaces. Alternatively the so called keratometric dioptric power of the cornea can be estimated from the radius of curvature of the epithelial surface only by assumption of a so called keratometric index of refraction n. As shown in Rand Rare the radii of the corneal anterior and posterior surfaces which are often assumed to be spherical. The relevant refractive indices are n 1.0 air n 1.376 corneal stroma n 1.336 aqueous humor and n 1.3375 keratometric index . The curvatures and ophthalmic refractive powers thus calculated for each pixel or local region on the cornea can then be mapped to a color scale to produce two dimensional representations of curvature and power respectively.

For the specific case in which the surface area of the cornea to be fitted is centered on the visual axis this power can provide a summary estimate of corneal optical power through the thin lens equation. This area can typically be around 3 4 mm in diameter as this is the region of the cornea which is most spherical and thus most amenable to the spherical model described by radii of curvature. This calculation requires derivation of the radius of curvature of both the anterior and posterior surfaces.

The above analyses thickness elevations and curvatures estimated optical power can also be performed for OCT images of the human lens. Because OCT provides a full volumetric rendering of both surfaces of the cornea independent radii of curvature of both the anterior and posterior surfaces centered on any arbitrary axis can be calculated. If these axes are sampled evenly across the cornea a full map of physical in contrast to keratometric power of defined sampled areas could be created similar to the maps described above fit to color scale and display en face .

Further OCT images that contain both the cornea and lens either registered or in whole can be used to create power maps describing the two refractive components of the human eye. These can be summed with appropriate optical treatment via ray tracing to determine the power contributions of the cornea and lens in the visual axis or any arbitrary desired axis. Unique novel parameters such as percentage contribution of the corneal power i.e. lenticular power to the total power i.e. cornea power plus lens power can be calculated and fit to a color scale such that 50 is centered on green with warmer colors representing greater contribution of that component versus cooler colors representing lesser contribution of that component. This analysis can provide information for surgeons planning selective refractive procedures e.g. cornea or lens based .

As the cornea and lens comprise the main refractive components of the eye analysis of both components from OCT images singly and in combination as in power maps centered on designated axes as in the visual axis can provide valuable information regarding the refractive status of the eye. For volumetric OCT images of the anterior segment that comprise the irido corneal angle a similar map can be created of the magnitude of the angle or any numerical parameter derived from images of the irido corneal angle such as a specific defined 2 D area of the angle within the image distance of the iris to the cornea at a specified distance from the apex of the angle .

Given an anatomically accurate 3D refraction corrected representation of the eye other analyses can be carried out.

For instance the angle between the iris and the adjacent corneal endothelial surface can be an important parameter in glaucoma care. An accurate volumetric dataset can be used to create an en face map of the magnitude of these angles. Multiple radial samplings of the intersection of the iris and adjacent corneal endothelial surfaces can be used to derive vectors from which the angle between them can be calculated. Similarly the angle could also be described as any numerical quantity which describes the relevant clinical concept such as the distance between the iris and cornea in this region and thus the gross physical availability of the trabecular meshwork. For instance the triangular area with its apex at the apex of the angle and its base defined as the line normal to a fixed reference such as Schwalbe s line or simply the length of the base of this triangle. These samplings can then be mapped to their enface position. In contrast to current isolated local angle measurements such an angle map can show regions of narrow angles or angle closure which could be important to glaucoma management. The only current comparable clinical view would be direct manual visualization of the angle structures using a mirror and mentally via drawing recreating the observed degree of regional angle magnitudes. This type of en face angle magnitude map display from tomographic image data has not been previously described.

3D displays of the anterior chamber space can also be created. These dimensions can be useful in planning for artificial lens placements both in the anterior chamber and posterior chamber.

If the OCT dataset includes data from the lens the lenticular surfaces can also be serially refraction corrected using equation 9 at different locations. For example the lenticular surfaces can be serially refraction corrected first at the corneal epithelium then at the corneal endothelium and then at the anterior lenticular surface. From the corrected data wavefront aberration analyses of the lenticular surfaces as described above can be undertaken.

As provided above methods and algorithms are provided for quantitative image correction and clinical parameter computation which is generally applicable for any OCT sample containing refracting interfaces and regions of different refractive indices. The methods and algorithms are particularly suitable for quantitative correction of 3D OCT images of the cornea and anterior segment of the eye. Two specific implementations for two different scanning patterns can be introduced for corneal imaging. Zernike 3D interpolation can be used to represent the corneal surfaces epithelium uncorrected endothelium and refraction corrected surfaces . This interpolation method can make it possible for the implementation of a recursive half searching algorithm RHSA and method to measure the corneal thicknesses and map them in an en face clinical view. 3D corneal volumetric refraction correction can provide the foundation for generating further clinical parameters. These comprise known clinical ones such as wavefront analysis asphericity refractive curvature maps and best fit sphere float maps as well as novel ones such as angle magnitude maps. 3D refraction correction and the accurate representation of ocular structures it creates provide an important tool in the visualization and management of ocular disease.

Embodiments of the present disclosure shown in the drawings and described above are exemplary of numerous embodiments that can be made within the scope of the appended claims. It is contemplated that the configurations of methods for quantitative three dimensional image correction and clinical parameter computation in optical coherence tomography can comprise numerous configurations other than those specifically disclosed.

